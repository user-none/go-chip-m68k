package m68k

import "testing"

func TestBcc(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 Bcc -80 6db0",
			init: cpuState{
				D:   [8]uint32{4187024648, 62555484, 1022058849, 215382112, 2686217827, 2345266576, 1716992870, 3408817317},
				A:   [7]uint32{1006772389, 235843841, 2081029407, 3448030389, 1930618072, 3421174642, 1087767110},
				PC:  9316410,
				SR:  9481,
				USP: 12438560,
				SSP: 14980430,
				RAM: [][2]uint32{{9316406, 109}, {9316407, 176}, {9316408, 248}, {9316409, 173}, {9316328, 145}, {9316329, 127}, {9316330, 210}, {9316331, 60}},
			},
			want: cpuState{
				D:   [8]uint32{4187024648, 62555484, 1022058849, 215382112, 2686217827, 2345266576, 1716992870, 3408817317},
				A:   [7]uint32{1006772389, 235843841, 2081029407, 3448030389, 1930618072, 3421174642, 1087767110},
				PC:  9316332,
				SR:  9481,
				USP: 12438560,
				SSP: 14980430,
				RAM: [][2]uint32{{9316406, 109}, {9316407, 176}, {9316408, 248}, {9316409, 173}, {9316328, 145}, {9316329, 127}, {9316330, 210}, {9316331, 60}},
				Cycles: 10,
			},
		},
		{
			name: "500 Bcc -25 66e7",
			init: cpuState{
				D:   [8]uint32{946910288, 1149199056, 2243949998, 762037226, 3660233864, 3279667752, 211456927, 1288790653},
				A:   [7]uint32{331766020, 1234250103, 3945669382, 1747682109, 3213995765, 2044992904, 206250018},
				PC:  12199514,
				SR:  42242,
				USP: 13415392,
				SSP: 11506512,
				RAM: [][2]uint32{{12199510, 102}, {12199511, 231}, {12199512, 48}, {12199513, 18}, {12, 118}, {13, 32}, {14, 252}, {15, 20}, {2161684, 45}, {2161685, 123}, {2161686, 158}, {2161687, 196}},
			},
			want: cpuState{
				D:      [8]uint32{946910288, 1149199056, 2243949998, 762037226, 3660233864, 3279667752, 211456927, 1288790653},
				A:      [7]uint32{331766020, 1234250103, 3945669382, 1747682109, 3213995765, 2044992904, 206250018},
				PC:     1981873176,
				SR:     9474,
				USP:    13415392,
				SSP:    11506498,
				RAM:    [][2]uint32{{12199510, 102}, {12199511, 231}, {12199512, 48}, {12199513, 18}, {11506510, 38}, {11506511, 88}, {11506506, 165}, {11506507, 2}, {11506508, 0}, {11506509, 186}, {11506504, 102}, {11506505, 231}, {11506502, 38}, {11506503, 63}, {11506498, 102}, {11506499, 246}, {11506500, 0}, {11506501, 186}, {12, 118}, {13, 32}, {14, 252}, {15, 20}, {2161684, 45}, {2161685, 123}, {2161686, 158}, {2161687, 196}},
				Halted: true,
			},
		},
		{
			name: "1000 Bcc -8 6bf8",
			init: cpuState{
				D:   [8]uint32{3723674433, 1521102939, 4050976276, 2751836167, 2283804069, 2662701467, 3164523502, 2459363185},
				A:   [7]uint32{627539118, 269339213, 3776729705, 2285550687, 2829062498, 2447324423, 1596934858},
				PC:  1156788,
				SR:  34318,
				USP: 1217426,
				SSP: 478508,
				RAM: [][2]uint32{{1156784, 107}, {1156785, 248}, {1156786, 198}, {1156787, 62}, {1156778, 15}, {1156779, 227}, {1156780, 233}, {1156781, 227}},
			},
			want: cpuState{
				D:   [8]uint32{3723674433, 1521102939, 4050976276, 2751836167, 2283804069, 2662701467, 3164523502, 2459363185},
				A:   [7]uint32{627539118, 269339213, 3776729705, 2285550687, 2829062498, 2447324423, 1596934858},
				PC:  1156782,
				SR:  34318,
				USP: 1217426,
				SSP: 478508,
				RAM: [][2]uint32{{1156784, 107}, {1156785, 248}, {1156786, 198}, {1156787, 62}, {1156778, 15}, {1156779, 227}, {1156780, 233}, {1156781, 227}},
				Cycles: 10,
			},
		},
		{
			name: "1500 Bcc 125 6d7d",
			init: cpuState{
				D:   [8]uint32{1334265018, 2406764584, 1396111089, 4198729912, 2751986744, 1056578558, 1345792454, 501024912},
				A:   [7]uint32{4293212581, 3397045342, 3786352084, 1844000818, 482154803, 183418349, 621448310},
				PC:  15955510,
				SR:  42000,
				USP: 13366732,
				SSP: 5120436,
				RAM: [][2]uint32{{15955506, 109}, {15955507, 125}, {15955508, 253}, {15955509, 30}, {15955510, 143}, {15955511, 218}},
			},
			want: cpuState{
				D:   [8]uint32{1334265018, 2406764584, 1396111089, 4198729912, 2751986744, 1056578558, 1345792454, 501024912},
				A:   [7]uint32{4293212581, 3397045342, 3786352084, 1844000818, 482154803, 183418349, 621448310},
				PC:  15955512,
				SR:  42000,
				USP: 13366732,
				SSP: 5120436,
				RAM: [][2]uint32{{15955506, 109}, {15955507, 125}, {15955508, 253}, {15955509, 30}, {15955510, 143}, {15955511, 218}},
				Cycles: 8,
			},
		},
		{
			name: "2000 Bcc -16 66f0",
			init: cpuState{
				D:   [8]uint32{3543292952, 3436214379, 2125969800, 3227155865, 1962353159, 1321805480, 3349587513, 1692349050},
				A:   [7]uint32{3122347684, 3119164496, 3247917102, 1786881534, 4112948791, 458839725, 3934356523},
				PC:  7359356,
				SR:  42011,
				USP: 5143550,
				SSP: 3381716,
				RAM: [][2]uint32{{7359352, 102}, {7359353, 240}, {7359354, 84}, {7359355, 174}, {7359338, 165}, {7359339, 95}, {7359340, 177}, {7359341, 10}},
			},
			want: cpuState{
				D:   [8]uint32{3543292952, 3436214379, 2125969800, 3227155865, 1962353159, 1321805480, 3349587513, 1692349050},
				A:   [7]uint32{3122347684, 3119164496, 3247917102, 1786881534, 4112948791, 458839725, 3934356523},
				PC:  7359342,
				SR:  42011,
				USP: 5143550,
				SSP: 3381716,
				RAM: [][2]uint32{{7359352, 102}, {7359353, 240}, {7359354, 84}, {7359355, 174}, {7359338, 165}, {7359339, 95}, {7359340, 177}, {7359341, 10}},
				Cycles: 10,
			},
		},
		{
			name: "008 Bcc -83 68ad",
			init: 			cpuState{
				D:   [8]uint32{4289249623, 865824909, 4082918359, 1999947057, 1934977849, 2797399429, 3834708480, 1453247713},
				A:   [7]uint32{1787828061, 2344326333, 999785151, 3668196833, 224816353, 1818779946, 2154343042},
				PC:  12622228,
				SR:  6,
				USP: 10102058,
				SSP: 16293316,
				RAM: [][2]uint32{{12622224, 104}, {12622225, 173}, {12622226, 74}, {12622227, 29}, {12622228, 212}, {12622229, 243}},
			},
			want: 			cpuState{
				D:   [8]uint32{4289249623, 865824909, 4082918359, 1999947057, 1934977849, 2797399429, 3834708480, 1453247713},
				A:   [7]uint32{1787828061, 2344326333, 999785151, 3668196833, 224816353, 1818779946, 2154343042},
				PC:  12622230,
				SR:  6,
				USP: 10102058,
				SSP: 16293316,
				RAM: [][2]uint32{{12622224, 104}, {12622225, 173}, {12622226, 74}, {12622227, 29}, {12622228, 212}, {12622229, 243}},
				Cycles: 8,
			},
		},
		{
			name: "334 Bcc 38 6c26",
			init: 			cpuState{
				D:   [8]uint32{1159223324, 3749944984, 1283918736, 3598243459, 661790164, 2905541638, 2945186467, 3687920907},
				A:   [7]uint32{480881268, 425319062, 264271837, 2334925353, 3414177677, 1909616955, 1514358362},
				PC:  12353250,
				SR:  8987,
				USP: 10838538,
				SSP: 15976106,
				RAM: [][2]uint32{{12353246, 108}, {12353247, 38}, {12353248, 201}, {12353249, 161}, {12353286, 85}, {12353287, 95}, {12353288, 217}, {12353289, 93}},
			},
			want: 			cpuState{
				D:   [8]uint32{1159223324, 3749944984, 1283918736, 3598243459, 661790164, 2905541638, 2945186467, 3687920907},
				A:   [7]uint32{480881268, 425319062, 264271837, 2334925353, 3414177677, 1909616955, 1514358362},
				PC:  12353290,
				SR:  8987,
				USP: 10838538,
				SSP: 15976106,
				RAM: [][2]uint32{{12353246, 108}, {12353247, 38}, {12353248, 201}, {12353249, 161}, {12353286, 85}, {12353287, 95}, {12353288, 217}, {12353289, 93}},
				Cycles: 10,
			},
		},
		{
			name: "588 Bcc -105 6c97",
			init: 			cpuState{
				D:   [8]uint32{2504929275, 3722871800, 2261957264, 1728838781, 2503942433, 3291411561, 2449421598, 762323438},
				A:   [7]uint32{457694873, 2692141436, 2245385561, 3232247745, 1332313477, 398876363, 3445433852},
				PC:  12819684,
				SR:  1795,
				USP: 15490046,
				SSP: 16586316,
				RAM: [][2]uint32{{12819680, 108}, {12819681, 151}, {12819682, 164}, {12819683, 253}, {12819684, 143}, {12819685, 213}},
			},
			want: 			cpuState{
				D:   [8]uint32{2504929275, 3722871800, 2261957264, 1728838781, 2503942433, 3291411561, 2449421598, 762323438},
				A:   [7]uint32{457694873, 2692141436, 2245385561, 3232247745, 1332313477, 398876363, 3445433852},
				PC:  12819686,
				SR:  1795,
				USP: 15490046,
				SSP: 16586316,
				RAM: [][2]uint32{{12819680, 108}, {12819681, 151}, {12819682, 164}, {12819683, 253}, {12819684, 143}, {12819685, 213}},
				Cycles: 8,
			},
		},
		{
			name: "869 Bcc 5 6805",
			init: 			cpuState{
				D:   [8]uint32{3325669075, 3601157394, 973730668, 105945454, 2964685720, 3790115182, 1541996008, 2032431379},
				A:   [7]uint32{3217741482, 2979982916, 3993940996, 1406016201, 866440044, 2928977381, 287284917},
				PC:  11095778,
				SR:  8719,
				USP: 5594222,
				SSP: 12304342,
				RAM: [][2]uint32{{11095774, 104}, {11095775, 5}, {11095776, 56}, {11095777, 210}, {11095778, 127}, {11095779, 231}},
			},
			want: 			cpuState{
				D:   [8]uint32{3325669075, 3601157394, 973730668, 105945454, 2964685720, 3790115182, 1541996008, 2032431379},
				A:   [7]uint32{3217741482, 2979982916, 3993940996, 1406016201, 866440044, 2928977381, 287284917},
				PC:  11095780,
				SR:  8719,
				USP: 5594222,
				SSP: 12304342,
				RAM: [][2]uint32{{11095774, 104}, {11095775, 5}, {11095776, 56}, {11095777, 210}, {11095778, 127}, {11095779, 231}},
				Cycles: 8,
			},
		},
		{
			name: "1120 Bcc -76 65b4",
			init: 			cpuState{
				D:   [8]uint32{3720238418, 2589614845, 346322969, 2496886122, 4275745641, 3959385749, 979048548, 1341213357},
				A:   [7]uint32{851070041, 1549270981, 3360095118, 4200069778, 2539753390, 1509496847, 3299850915},
				PC:  1342912,
				SR:  528,
				USP: 14556280,
				SSP: 13578986,
				RAM: [][2]uint32{{1342908, 101}, {1342909, 180}, {1342910, 117}, {1342911, 103}, {1342912, 108}, {1342913, 160}},
			},
			want: 			cpuState{
				D:   [8]uint32{3720238418, 2589614845, 346322969, 2496886122, 4275745641, 3959385749, 979048548, 1341213357},
				A:   [7]uint32{851070041, 1549270981, 3360095118, 4200069778, 2539753390, 1509496847, 3299850915},
				PC:  1342914,
				SR:  528,
				USP: 14556280,
				SSP: 13578986,
				RAM: [][2]uint32{{1342908, 101}, {1342909, 180}, {1342910, 117}, {1342911, 103}, {1342912, 108}, {1342913, 160}},
				Cycles: 8,
			},
		},
		{
			name: "1389 Bcc -118 628a",
			init: 			cpuState{
				D:   [8]uint32{1295705559, 883618430, 2413104773, 1874967390, 404401746, 2636655778, 152562656, 4019815929},
				A:   [7]uint32{1051229563, 3729773311, 608773026, 1720644158, 1422174898, 1257609506, 3755116773},
				PC:  1440352,
				SR:  9242,
				USP: 2906764,
				SSP: 1804838,
				RAM: [][2]uint32{{1440348, 98}, {1440349, 138}, {1440350, 174}, {1440351, 46}, {1440232, 20}, {1440233, 79}, {1440234, 54}, {1440235, 2}},
			},
			want: 			cpuState{
				D:   [8]uint32{1295705559, 883618430, 2413104773, 1874967390, 404401746, 2636655778, 152562656, 4019815929},
				A:   [7]uint32{1051229563, 3729773311, 608773026, 1720644158, 1422174898, 1257609506, 3755116773},
				PC:  1440236,
				SR:  9242,
				USP: 2906764,
				SSP: 1804838,
				RAM: [][2]uint32{{1440348, 98}, {1440349, 138}, {1440350, 174}, {1440351, 46}, {1440232, 20}, {1440233, 79}, {1440234, 54}, {1440235, 2}},
				Cycles: 10,
			},
		},
		{
			name: "1692 Bcc -20 64ec",
			init: 			cpuState{
				D:   [8]uint32{778060446, 3629726089, 4015463025, 633000254, 3422810082, 1160673046, 1026679316, 3871296355},
				A:   [7]uint32{1850298231, 2843710668, 1833493295, 2693108254, 1948414341, 3868607994, 4090017129},
				PC:  9394162,
				SR:  8722,
				USP: 1820830,
				SSP: 12389714,
				RAM: [][2]uint32{{9394158, 100}, {9394159, 236}, {9394160, 255}, {9394161, 46}, {9394140, 40}, {9394141, 173}, {9394142, 24}, {9394143, 10}},
			},
			want: 			cpuState{
				D:   [8]uint32{778060446, 3629726089, 4015463025, 633000254, 3422810082, 1160673046, 1026679316, 3871296355},
				A:   [7]uint32{1850298231, 2843710668, 1833493295, 2693108254, 1948414341, 3868607994, 4090017129},
				PC:  9394144,
				SR:  8722,
				USP: 1820830,
				SSP: 12389714,
				RAM: [][2]uint32{{9394158, 100}, {9394159, 236}, {9394160, 255}, {9394161, 46}, {9394140, 40}, {9394141, 173}, {9394142, 24}, {9394143, 10}},
				Cycles: 10,
			},
		},
		{
			name: "1986 Bcc -34 6fde",
			init: 			cpuState{
				D:   [8]uint32{4212878705, 421568824, 2605557629, 3739189206, 1804653192, 2975477991, 1447662294, 3949455006},
				A:   [7]uint32{3350725760, 1966146305, 1862928811, 2012871907, 3763467803, 1685535552, 2775981042},
				PC:  9341936,
				SR:  8709,
				USP: 15316592,
				SSP: 4039160,
				RAM: [][2]uint32{{9341932, 111}, {9341933, 222}, {9341934, 65}, {9341935, 18}, {9341900, 82}, {9341901, 203}, {9341902, 120}, {9341903, 98}},
			},
			want: 			cpuState{
				D:   [8]uint32{4212878705, 421568824, 2605557629, 3739189206, 1804653192, 2975477991, 1447662294, 3949455006},
				A:   [7]uint32{3350725760, 1966146305, 1862928811, 2012871907, 3763467803, 1685535552, 2775981042},
				PC:  9341904,
				SR:  8709,
				USP: 15316592,
				SSP: 4039160,
				RAM: [][2]uint32{{9341932, 111}, {9341933, 222}, {9341934, 65}, {9341935, 18}, {9341900, 82}, {9341901, 203}, {9341902, 120}, {9341903, 98}},
				Cycles: 10,
			},
		},
		{
			name: "2233 Bcc -10 6ef6",
			init: 			cpuState{
				D:   [8]uint32{2143927079, 2088690534, 2530709100, 2355612859, 2244985657, 2699943322, 3638817138, 117424549},
				A:   [7]uint32{2094795748, 869014446, 2629610994, 3500726937, 2870720326, 2487806645, 3675505858},
				PC:  4273704,
				SR:  8720,
				USP: 3516368,
				SSP: 6948830,
				RAM: [][2]uint32{{4273700, 110}, {4273701, 246}, {4273702, 35}, {4273703, 177}, {4273692, 105}, {4273693, 216}, {4273694, 184}, {4273695, 160}},
			},
			want: 			cpuState{
				D:   [8]uint32{2143927079, 2088690534, 2530709100, 2355612859, 2244985657, 2699943322, 3638817138, 117424549},
				A:   [7]uint32{2094795748, 869014446, 2629610994, 3500726937, 2870720326, 2487806645, 3675505858},
				PC:  4273696,
				SR:  8720,
				USP: 3516368,
				SSP: 6948830,
				RAM: [][2]uint32{{4273700, 110}, {4273701, 246}, {4273702, 35}, {4273703, 177}, {4273692, 105}, {4273693, 216}, {4273694, 184}, {4273695, 160}},
				Cycles: 10,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestBSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 BSR -20 61ec",
			init: cpuState{
				D:   [8]uint32{282065017, 450776920, 4155908866, 846884965, 61560607, 2160627461, 2290516079, 3350402472},
				A:   [7]uint32{609322689, 1107540203, 1702551578, 2455661732, 994947294, 1134626817, 1803885892},
				PC:  5074288,
				SR:  40988,
				USP: 13118394,
				SSP: 7423392,
				RAM: [][2]uint32{{5074284, 97}, {5074285, 236}, {5074286, 139}, {5074287, 162}, {5074266, 201}, {5074267, 45}, {5074268, 101}, {5074269, 168}},
			},
			want: cpuState{
				D:   [8]uint32{282065017, 450776920, 4155908866, 846884965, 61560607, 2160627461, 2290516079, 3350402472},
				A:   [7]uint32{609322689, 1107540203, 1702551578, 2455661732, 994947294, 1134626817, 1803885892},
				PC:  5074270,
				SR:  40988,
				USP: 13118394,
				SSP: 7423388,
				RAM: [][2]uint32{{5074284, 97}, {5074285, 236}, {5074286, 139}, {5074287, 162}, {7423388, 0}, {7423389, 77}, {7423390, 109}, {7423391, 110}, {5074266, 201}, {5074267, 45}, {5074268, 101}, {5074269, 168}},
				Cycles: 18,
			},
		},
		{
			name: "500 BSR -106 6196",
			init: cpuState{
				D:   [8]uint32{1877854762, 3434415810, 1260049976, 239366656, 2579800176, 96212638, 694958620, 1041556033},
				A:   [7]uint32{1358712227, 3780186112, 850184818, 988076609, 559431923, 3496645377, 1850818023},
				PC:  13124450,
				SR:  542,
				USP: 3579692,
				SSP: 2740244,
				RAM: [][2]uint32{{13124446, 97}, {13124447, 150}, {13124448, 87}, {13124449, 238}, {13124342, 225}, {13124343, 17}, {13124344, 31}, {13124345, 148}},
			},
			want: cpuState{
				D:   [8]uint32{1877854762, 3434415810, 1260049976, 239366656, 2579800176, 96212638, 694958620, 1041556033},
				A:   [7]uint32{1358712227, 3780186112, 850184818, 988076609, 559431923, 3496645377, 1850818023},
				PC:  13124346,
				SR:  542,
				USP: 3579688,
				SSP: 2740244,
				RAM: [][2]uint32{{13124446, 97}, {13124447, 150}, {13124448, 87}, {13124449, 238}, {3579688, 0}, {3579689, 200}, {3579690, 67}, {3579691, 96}, {13124342, 225}, {13124343, 17}, {13124344, 31}, {13124345, 148}},
				Cycles: 18,
			},
		},
		{
			name: "1000 BSR 31 611f",
			init: cpuState{
				D:   [8]uint32{1109380244, 1522467750, 4026450329, 260704155, 1958536903, 4092963074, 3578845900, 4235999725},
				A:   [7]uint32{1124561082, 849824773, 119010643, 40899830, 248388312, 2695529245, 409442983},
				PC:  9120614,
				SR:  9497,
				USP: 12022808,
				SSP: 7095424,
				RAM: [][2]uint32{{9120610, 97}, {9120611, 31}, {9120612, 9}, {9120613, 129}, {12, 21}, {13, 178}, {14, 207}, {15, 140}, {11718540, 90}, {11718541, 178}, {11718542, 28}, {11718543, 115}},
			},
			want: cpuState{
				D:      [8]uint32{1109380244, 1522467750, 4026450329, 260704155, 1958536903, 4092963074, 3578845900, 4235999725},
				A:      [7]uint32{1124561082, 849824773, 119010643, 40899830, 248388312, 2695529245, 409442983},
				PC:     364040080,
				SR:     9497,
				USP:    12022808,
				SSP:    7095406,
				RAM:    [][2]uint32{{9120610, 97}, {9120611, 31}, {9120612, 9}, {9120613, 129}, {7095420, 0}, {7095421, 139}, {7095422, 43}, {7095423, 100}, {7095418, 43}, {7095419, 131}, {7095414, 37}, {7095415, 25}, {7095416, 0}, {7095417, 139}, {7095412, 97}, {7095413, 31}, {7095410, 43}, {7095411, 131}, {7095406, 97}, {7095407, 22}, {7095408, 0}, {7095409, 139}, {12, 21}, {13, 178}, {14, 207}, {15, 140}, {11718540, 90}, {11718541, 178}, {11718542, 28}, {11718543, 115}},
				Halted: true,
			},
		},
		{
			name: "1500 BSR 45 612d",
			init: cpuState{
				D:   [8]uint32{53481911, 677601385, 2631769522, 4095665240, 4225311380, 1658776787, 1179989423, 1588662221},
				A:   [7]uint32{1636470783, 3831338466, 3652180990, 3696933587, 1563135856, 1029852308, 3225059393},
				PC:  11384068,
				SR:  33038,
				USP: 6214238,
				SSP: 16513836,
				RAM: [][2]uint32{{11384064, 97}, {11384065, 45}, {11384066, 228}, {11384067, 234}, {12, 105}, {13, 86}, {14, 247}, {15, 178}, {5699506, 218}, {5699507, 123}, {5699508, 24}, {5699509, 213}},
			},
			want: cpuState{
				D:      [8]uint32{53481911, 677601385, 2631769522, 4095665240, 4225311380, 1658776787, 1179989423, 1588662221},
				A:      [7]uint32{1636470783, 3831338466, 3652180990, 3696933587, 1563135856, 1029852308, 3225059393},
				PC:     1767307190,
				SR:     8462,
				USP:    6214234,
				SSP:    16513822,
				RAM:    [][2]uint32{{11384064, 97}, {11384065, 45}, {11384066, 228}, {11384067, 234}, {6214234, 0}, {6214235, 173}, {6214236, 181}, {6214237, 2}, {16513834, 181}, {16513835, 47}, {16513830, 129}, {16513831, 14}, {16513832, 0}, {16513833, 173}, {16513828, 97}, {16513829, 45}, {16513826, 181}, {16513827, 47}, {16513822, 97}, {16513823, 50}, {16513824, 0}, {16513825, 173}, {12, 105}, {13, 86}, {14, 247}, {15, 178}, {5699506, 218}, {5699507, 123}, {5699508, 24}, {5699509, 213}},
				Halted: true,
			},
		},
		{
			name: "2000 BSR 82 6152",
			init: cpuState{
				D:   [8]uint32{2227477461, 3311121812, 216051618, 3557750288, 238013731, 659853091, 1340984986, 228057643},
				A:   [7]uint32{213300034, 177849925, 802464502, 1946744831, 1687113901, 3159475630, 840520611},
				PC:  11332438,
				SR:  264,
				USP: 3849762,
				SSP: 15130976,
				RAM: [][2]uint32{{11332434, 97}, {11332435, 82}, {11332436, 234}, {11332437, 91}, {11332518, 99}, {11332519, 97}, {11332520, 11}, {11332521, 165}},
			},
			want: cpuState{
				D:   [8]uint32{2227477461, 3311121812, 216051618, 3557750288, 238013731, 659853091, 1340984986, 228057643},
				A:   [7]uint32{213300034, 177849925, 802464502, 1946744831, 1687113901, 3159475630, 840520611},
				PC:  11332522,
				SR:  264,
				USP: 3849758,
				SSP: 15130976,
				RAM: [][2]uint32{{11332434, 97}, {11332435, 82}, {11332436, 234}, {11332437, 91}, {3849758, 0}, {3849759, 172}, {3849760, 235}, {3849761, 84}, {11332518, 99}, {11332519, 97}, {11332520, 11}, {11332521, 165}},
				Cycles: 18,
			},
		},
		{
			name: "001 BSR -124 6184",
			init: 			cpuState{
				D:   [8]uint32{3147470470, 2157507377, 1913686428, 398104204, 2808528810, 1283439398, 1422596092, 2490649097},
				A:   [7]uint32{82676925, 4219364043, 3747469014, 2930060949, 3316802872, 4225707564, 1412238263},
				PC:  15054268,
				SR:  8976,
				USP: 13275104,
				SSP: 12443888,
				RAM: [][2]uint32{{15054264, 97}, {15054265, 132}, {15054266, 189}, {15054267, 168}, {15054142, 27}, {15054143, 155}, {15054144, 101}, {15054145, 172}},
			},
			want: 			cpuState{
				D:   [8]uint32{3147470470, 2157507377, 1913686428, 398104204, 2808528810, 1283439398, 1422596092, 2490649097},
				A:   [7]uint32{82676925, 4219364043, 3747469014, 2930060949, 3316802872, 4225707564, 1412238263},
				PC:  15054146,
				SR:  8976,
				USP: 13275104,
				SSP: 12443884,
				RAM: [][2]uint32{{15054264, 97}, {15054265, 132}, {15054266, 189}, {15054267, 168}, {12443884, 0}, {12443885, 229}, {12443886, 181}, {12443887, 186}, {15054142, 27}, {15054143, 155}, {15054144, 101}, {15054145, 172}},
				Cycles: 18,
			},
		},
		{
			name: "307 BSR 28 611c",
			init: 			cpuState{
				D:   [8]uint32{2416185340, 1664904927, 329825991, 1061391651, 2874839802, 2366117221, 3993537966, 2516901794},
				A:   [7]uint32{2965119646, 3755068182, 3198177224, 1957368088, 741934647, 36203726, 139807532},
				PC:  11740496,
				SR:  512,
				USP: 12526628,
				SSP: 11386342,
				RAM: [][2]uint32{{11740492, 97}, {11740493, 28}, {11740494, 238}, {11740495, 114}, {11740522, 227}, {11740523, 116}, {11740524, 35}, {11740525, 60}},
			},
			want: 			cpuState{
				D:   [8]uint32{2416185340, 1664904927, 329825991, 1061391651, 2874839802, 2366117221, 3993537966, 2516901794},
				A:   [7]uint32{2965119646, 3755068182, 3198177224, 1957368088, 741934647, 36203726, 139807532},
				PC:  11740526,
				SR:  512,
				USP: 12526624,
				SSP: 11386342,
				RAM: [][2]uint32{{11740492, 97}, {11740493, 28}, {11740494, 238}, {11740495, 114}, {12526624, 0}, {12526625, 179}, {12526626, 37}, {12526627, 78}, {11740522, 227}, {11740523, 116}, {11740524, 35}, {11740525, 60}},
				Cycles: 18,
			},
		},
		{
			name: "568 BSR 28 611c",
			init: 			cpuState{
				D:   [8]uint32{1594043272, 2629767338, 2075316796, 2483456811, 2343086016, 1274832409, 2997346093, 2793601505},
				A:   [7]uint32{1298229130, 1653617596, 1250658264, 3907778595, 3073467878, 2982732260, 245353848},
				PC:  7101848,
				SR:  1799,
				USP: 11095736,
				SSP: 15445552,
				RAM: [][2]uint32{{7101844, 97}, {7101845, 28}, {7101846, 153}, {7101847, 64}, {7101874, 107}, {7101875, 39}, {7101876, 23}, {7101877, 67}},
			},
			want: 			cpuState{
				D:   [8]uint32{1594043272, 2629767338, 2075316796, 2483456811, 2343086016, 1274832409, 2997346093, 2793601505},
				A:   [7]uint32{1298229130, 1653617596, 1250658264, 3907778595, 3073467878, 2982732260, 245353848},
				PC:  7101878,
				SR:  1799,
				USP: 11095732,
				SSP: 15445552,
				RAM: [][2]uint32{{7101844, 97}, {7101845, 28}, {7101846, 153}, {7101847, 64}, {11095732, 0}, {11095733, 108}, {11095734, 93}, {11095735, 150}, {7101874, 107}, {7101875, 39}, {7101876, 23}, {7101877, 67}},
				Cycles: 18,
			},
		},
		{
			name: "861 BSR -108 6194",
			init: 			cpuState{
				D:   [8]uint32{1748902199, 1386981107, 693589870, 3186068011, 703277450, 4013125527, 1068145317, 2297638248},
				A:   [7]uint32{3300382181, 2728091968, 4122704810, 516156342, 679216434, 288347756, 378304389},
				PC:  2632594,
				SR:  8449,
				USP: 11524408,
				SSP: 15579920,
				RAM: [][2]uint32{{2632590, 97}, {2632591, 148}, {2632592, 236}, {2632593, 39}, {2632484, 98}, {2632485, 211}, {2632486, 43}, {2632487, 17}},
			},
			want: 			cpuState{
				D:   [8]uint32{1748902199, 1386981107, 693589870, 3186068011, 703277450, 4013125527, 1068145317, 2297638248},
				A:   [7]uint32{3300382181, 2728091968, 4122704810, 516156342, 679216434, 288347756, 378304389},
				PC:  2632488,
				SR:  8449,
				USP: 11524408,
				SSP: 15579916,
				RAM: [][2]uint32{{2632590, 97}, {2632591, 148}, {2632592, 236}, {2632593, 39}, {15579916, 0}, {15579917, 40}, {15579918, 43}, {15579919, 144}, {2632484, 98}, {2632485, 211}, {2632486, 43}, {2632487, 17}},
				Cycles: 18,
			},
		},
		{
			name: "1086 BSR 96 6160",
			init: 			cpuState{
				D:   [8]uint32{2684068316, 3295475992, 2878169980, 1523960023, 1700663598, 3127983829, 3576990141, 173654214},
				A:   [7]uint32{2248457747, 2553359387, 1413727039, 2244874250, 3027662854, 2036223279, 1749446645},
				PC:  4558654,
				SR:  1055,
				USP: 7707366,
				SSP: 7392658,
				RAM: [][2]uint32{{4558650, 97}, {4558651, 96}, {4558652, 17}, {4558653, 168}, {4558748, 238}, {4558749, 197}, {4558750, 171}, {4558751, 133}},
			},
			want: 			cpuState{
				D:   [8]uint32{2684068316, 3295475992, 2878169980, 1523960023, 1700663598, 3127983829, 3576990141, 173654214},
				A:   [7]uint32{2248457747, 2553359387, 1413727039, 2244874250, 3027662854, 2036223279, 1749446645},
				PC:  4558752,
				SR:  1055,
				USP: 7707362,
				SSP: 7392658,
				RAM: [][2]uint32{{4558650, 97}, {4558651, 96}, {4558652, 17}, {4558653, 168}, {7707362, 0}, {7707363, 69}, {7707364, 143}, {7707365, 60}, {4558748, 238}, {4558749, 197}, {4558750, 171}, {4558751, 133}},
				Cycles: 18,
			},
		},
		{
			name: "1370 BSR -80 61b0",
			init: 			cpuState{
				D:   [8]uint32{654957465, 3060008864, 3683156845, 2664004649, 551308804, 2284550780, 1747572991, 4027447492},
				A:   [7]uint32{3644185871, 1352057967, 2846771596, 3244002913, 2654719544, 1630762018, 3025606634},
				PC:  13821988,
				SR:  8463,
				USP: 15396482,
				SSP: 370156,
				RAM: [][2]uint32{{13821984, 97}, {13821985, 176}, {13821986, 91}, {13821987, 178}, {13821906, 106}, {13821907, 207}, {13821908, 232}, {13821909, 33}},
			},
			want: 			cpuState{
				D:   [8]uint32{654957465, 3060008864, 3683156845, 2664004649, 551308804, 2284550780, 1747572991, 4027447492},
				A:   [7]uint32{3644185871, 1352057967, 2846771596, 3244002913, 2654719544, 1630762018, 3025606634},
				PC:  13821910,
				SR:  8463,
				USP: 15396482,
				SSP: 370152,
				RAM: [][2]uint32{{13821984, 97}, {13821985, 176}, {13821986, 91}, {13821987, 178}, {370152, 0}, {370153, 210}, {370154, 232}, {370155, 34}, {13821906, 106}, {13821907, 207}, {13821908, 232}, {13821909, 33}},
				Cycles: 18,
			},
		},
		{
			name: "1645 BSR # 6100",
			init: 			cpuState{
				D:   [8]uint32{1346959107, 2352204901, 2636061000, 878101216, 747534004, 1883076461, 1585878130, 1470234047},
				A:   [7]uint32{3116328172, 355395898, 1151893220, 480755661, 2677053335, 1428687796, 1219006786},
				PC:  6651430,
				SR:  9753,
				USP: 1456782,
				SSP: 11773102,
				RAM: [][2]uint32{{6651426, 97}, {6651427, 0}, {6651428, 154}, {6651429, 106}, {6625422, 224}, {6625423, 4}, {6625424, 46}, {6625425, 23}},
			},
			want: 			cpuState{
				D:   [8]uint32{1346959107, 2352204901, 2636061000, 878101216, 747534004, 1883076461, 1585878130, 1470234047},
				A:   [7]uint32{3116328172, 355395898, 1151893220, 480755661, 2677053335, 1428687796, 1219006786},
				PC:  6625426,
				SR:  9753,
				USP: 1456782,
				SSP: 11773098,
				RAM: [][2]uint32{{6651426, 97}, {6651427, 0}, {6651428, 154}, {6651429, 106}, {11773098, 0}, {11773099, 101}, {11773100, 126}, {11773101, 38}, {6625422, 224}, {6625423, 4}, {6625424, 46}, {6625425, 23}},
				Cycles: 18,
			},
		},
		{
			name: "1889 BSR 56 6138",
			init: 			cpuState{
				D:   [8]uint32{3959509536, 643833496, 190621414, 1814735980, 4210607531, 2452858281, 2292024280, 2480951012},
				A:   [7]uint32{191752666, 2050390556, 432793997, 3896171940, 364713943, 556202506, 4025846253},
				PC:  11336334,
				SR:  25,
				USP: 5949876,
				SSP: 7311738,
				RAM: [][2]uint32{{11336330, 97}, {11336331, 56}, {11336332, 144}, {11336333, 187}, {11336388, 121}, {11336389, 18}, {11336390, 230}, {11336391, 81}},
			},
			want: 			cpuState{
				D:   [8]uint32{3959509536, 643833496, 190621414, 1814735980, 4210607531, 2452858281, 2292024280, 2480951012},
				A:   [7]uint32{191752666, 2050390556, 432793997, 3896171940, 364713943, 556202506, 4025846253},
				PC:  11336392,
				SR:  25,
				USP: 5949872,
				SSP: 7311738,
				RAM: [][2]uint32{{11336330, 97}, {11336331, 56}, {11336332, 144}, {11336333, 187}, {5949872, 0}, {5949873, 172}, {5949874, 250}, {5949875, 140}, {11336388, 121}, {11336389, 18}, {11336390, 230}, {11336391, 81}},
				Cycles: 18,
			},
		},
		{
			name: "2168 BSR -6 61fa",
			init: 			cpuState{
				D:   [8]uint32{205223707, 2006652971, 2855550604, 2229602945, 2559482705, 3022691755, 956723532, 2622494177},
				A:   [7]uint32{2445521415, 3955053419, 3784500981, 2429037132, 1588407909, 3264711975, 1963300343},
				PC:  8310562,
				SR:  8710,
				USP: 11194298,
				SSP: 16740258,
				RAM: [][2]uint32{{8310558, 97}, {8310559, 250}, {8310560, 183}, {8310561, 37}, {8310554, 197}, {8310555, 81}, {8310556, 75}, {8310557, 208}},
			},
			want: 			cpuState{
				D:   [8]uint32{205223707, 2006652971, 2855550604, 2229602945, 2559482705, 3022691755, 956723532, 2622494177},
				A:   [7]uint32{2445521415, 3955053419, 3784500981, 2429037132, 1588407909, 3264711975, 1963300343},
				PC:  8310558,
				SR:  8710,
				USP: 11194298,
				SSP: 16740254,
				RAM: [][2]uint32{{8310558, 97}, {8310559, 250}, {8310560, 183}, {8310561, 37}, {16740254, 0}, {16740255, 126}, {16740256, 207}, {16740257, 32}, {8310554, 197}, {8310555, 81}, {8310556, 75}, {8310557, 208}},
				Cycles: 18,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestDBcc(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 DBcc D7, # 5ecf",
			init: cpuState{
				D:   [8]uint32{2995527499, 185128935, 238788573, 245135735, 1352650698, 2996237592, 2907838549, 3496842426},
				A:   [7]uint32{3531171237, 1021743264, 2324599395, 1455201896, 126441683, 1136191243, 2260655387},
				PC:  1931310,
				SR:  41218,
				USP: 12957490,
				SSP: 16025126,
				RAM: [][2]uint32{{1931306, 94}, {1931307, 207}, {1931308, 151}, {1931309, 253}, {12, 210}, {13, 156}, {14, 184}, {15, 38}, {10270758, 16}, {10270759, 109}, {10270760, 166}, {10270761, 189}},
			},
			want: cpuState{
				D:      [8]uint32{2995527499, 185128935, 238788573, 245135735, 1352650698, 2996237592, 2907838549, 3496842426},
				A:      [7]uint32{3531171237, 1021743264, 2324599395, 1455201896, 126441683, 1136191243, 2260655387},
				PC:     3533486122,
				SR:     8450,
				USP:    12957490,
				SSP:    16025112,
				RAM:    [][2]uint32{{1931306, 94}, {1931307, 207}, {1931308, 151}, {1931309, 253}, {16025124, 120}, {16025125, 46}, {16025120, 161}, {16025121, 2}, {16025122, 0}, {16025123, 29}, {16025118, 94}, {16025119, 207}, {16025116, 16}, {16025117, 41}, {16025112, 94}, {16025113, 214}, {16025114, 0}, {16025115, 29}, {12, 210}, {13, 156}, {14, 184}, {15, 38}, {10270758, 16}, {10270759, 109}, {10270760, 166}, {10270761, 189}},
				Halted: true,
			},
		},
		{
			name: "500 DBcc D3, # 58cb",
			init: cpuState{
				D:   [8]uint32{1645034692, 4168574144, 3147622305, 2099341536, 1757386005, 2038162240, 1603267217, 3885830916},
				A:   [7]uint32{3222673329, 2494480326, 720805755, 791682558, 789638103, 4106760158, 472147609},
				PC:  3598084,
				SR:  42257,
				USP: 2376884,
				SSP: 15246992,
				RAM: [][2]uint32{{3598080, 88}, {3598081, 203}, {3598082, 13}, {3598083, 164}, {3598084, 183}, {3598085, 13}, {3598086, 21}, {3598087, 173}},
			},
			want: cpuState{
				D:   [8]uint32{1645034692, 4168574144, 3147622305, 2099341536, 1757386005, 2038162240, 1603267217, 3885830916},
				A:   [7]uint32{3222673329, 2494480326, 720805755, 791682558, 789638103, 4106760158, 472147609},
				PC:  3598088,
				SR:  42257,
				USP: 2376884,
				SSP: 15246992,
				RAM: [][2]uint32{{3598080, 88}, {3598081, 203}, {3598082, 13}, {3598083, 164}, {3598084, 183}, {3598085, 13}, {3598086, 21}, {3598087, 173}},
				Cycles: 12,
			},
		},
		{
			name: "1000 DBcc D0, # 59c8",
			init: cpuState{
				D:   [8]uint32{3828964938, 467316427, 104272372, 4104947443, 3508510621, 2375457041, 1292477162, 3699257015},
				A:   [7]uint32{3255399493, 620571100, 1707133965, 306082289, 2035564272, 2396524369, 2750955643},
				PC:  2925350,
				SR:  32780,
				USP: 10386092,
				SSP: 8737614,
				RAM: [][2]uint32{{2925346, 89}, {2925347, 200}, {2925348, 76}, {2925349, 201}, {12, 151}, {13, 206}, {14, 87}, {15, 214}, {13522902, 250}, {13522903, 233}, {13522904, 3}, {13522905, 249}},
			},
			want: cpuState{
				D:      [8]uint32{3828964938, 467316427, 104272372, 4104947443, 3508510621, 2375457041, 1292477162, 3699257015},
				A:      [7]uint32{3255399493, 620571100, 1707133965, 306082289, 2035564272, 2396524369, 2750955643},
				PC:     2546882522,
				SR:     8204,
				USP:    10386092,
				SSP:    8737600,
				RAM:    [][2]uint32{{2925346, 89}, {2925347, 200}, {2925348, 76}, {2925349, 201}, {8737612, 163}, {8737613, 38}, {8737608, 128}, {8737609, 12}, {8737610, 0}, {8737611, 44}, {8737606, 89}, {8737607, 200}, {8737604, 239}, {8737605, 237}, {8737600, 89}, {8737601, 210}, {8737602, 0}, {8737603, 44}, {12, 151}, {13, 206}, {14, 87}, {15, 214}, {13522902, 250}, {13522903, 233}, {13522904, 3}, {13522905, 249}},
				Halted: true,
			},
		},
		{
			name: "1500 DBcc D5, # 5fcd",
			init: cpuState{
				D:   [8]uint32{929369192, 1646652344, 126751312, 1251774708, 2498665192, 546990681, 332622137, 4033118572},
				A:   [7]uint32{1111807569, 1542720971, 3921158509, 4121314672, 2351138183, 3713321398, 143846596},
				PC:  15681446,
				SR:  275,
				USP: 8581674,
				SSP: 9325262,
				RAM: [][2]uint32{{15681442, 95}, {15681443, 205}, {15681444, 186}, {15681445, 18}, {15681446, 52}, {15681447, 220}, {15681448, 221}, {15681449, 208}},
			},
			want: cpuState{
				D:   [8]uint32{929369192, 1646652344, 126751312, 1251774708, 2498665192, 546990681, 332622137, 4033118572},
				A:   [7]uint32{1111807569, 1542720971, 3921158509, 4121314672, 2351138183, 3713321398, 143846596},
				PC:  15681450,
				SR:  275,
				USP: 8581674,
				SSP: 9325262,
				RAM: [][2]uint32{{15681442, 95}, {15681443, 205}, {15681444, 186}, {15681445, 18}, {15681446, 52}, {15681447, 220}, {15681448, 221}, {15681449, 208}},
				Cycles: 12,
			},
		},
		{
			name: "2000 DBcc D1, # 52c9",
			init: cpuState{
				D:   [8]uint32{2880410386, 2147284519, 3868746026, 2939782942, 1509575812, 3840860719, 3909752407, 2590188555},
				A:   [7]uint32{3538370527, 3687915870, 2362378934, 3877705240, 3839976232, 1329757070, 3122372940},
				PC:  6080736,
				SR:  41735,
				USP: 6050416,
				SSP: 9111226,
				RAM: [][2]uint32{{6080732, 82}, {6080733, 201}, {6080734, 35}, {6080735, 214}, {6089908, 128}, {6089909, 95}, {6089910, 22}, {6089911, 116}},
			},
			want: cpuState{
				D:   [8]uint32{2880410386, 2147284518, 3868746026, 2939782942, 1509575812, 3840860719, 3909752407, 2590188555},
				A:   [7]uint32{3538370527, 3687915870, 2362378934, 3877705240, 3839976232, 1329757070, 3122372940},
				PC:  6089912,
				SR:  41735,
				USP: 6050416,
				SSP: 9111226,
				RAM: [][2]uint32{{6080732, 82}, {6080733, 201}, {6080734, 35}, {6080735, 214}, {6089908, 128}, {6089909, 95}, {6089910, 22}, {6089911, 116}},
				Cycles: 10,
			},
		},
		{
			name: "006 DBcc D2, # 52ca",
			init: 			cpuState{
				D:   [8]uint32{3697267973, 362318366, 1093278567, 3729544335, 1347922544, 3761009781, 914017636, 3002332157},
				A:   [7]uint32{3127800285, 323341945, 2437362959, 199973941, 3173767801, 2997150063, 53296367},
				PC:  12964274,
				SR:  8193,
				USP: 12494560,
				SSP: 16099546,
				RAM: [][2]uint32{{12964270, 82}, {12964271, 202}, {12964272, 123}, {12964273, 206}, {12995966, 195}, {12995967, 237}, {12995968, 80}, {12995969, 231}},
			},
			want: 			cpuState{
				D:   [8]uint32{3697267973, 362318366, 1093278566, 3729544335, 1347922544, 3761009781, 914017636, 3002332157},
				A:   [7]uint32{3127800285, 323341945, 2437362959, 199973941, 3173767801, 2997150063, 53296367},
				PC:  12995970,
				SR:  8193,
				USP: 12494560,
				SSP: 16099546,
				RAM: [][2]uint32{{12964270, 82}, {12964271, 202}, {12964272, 123}, {12964273, 206}, {12995966, 195}, {12995967, 237}, {12995968, 80}, {12995969, 231}},
				Cycles: 10,
			},
		},
		{
			name: "294 DBcc D6, # 5dce",
			init: 			cpuState{
				D:   [8]uint32{1525427446, 2147413429, 2617650934, 1992491751, 1860705476, 3507303253, 1017229568, 118685663},
				A:   [7]uint32{1981841393, 3756045406, 1682335604, 2671627286, 3861350084, 341555594, 924563465},
				PC:  12071472,
				SR:  9752,
				USP: 13850312,
				SSP: 3298272,
				RAM: [][2]uint32{{12071468, 93}, {12071469, 206}, {12071470, 195}, {12071471, 38}, {12071472, 187}, {12071473, 94}, {12071474, 100}, {12071475, 174}},
			},
			want: 			cpuState{
				D:   [8]uint32{1525427446, 2147413429, 2617650934, 1992491751, 1860705476, 3507303253, 1017229568, 118685663},
				A:   [7]uint32{1981841393, 3756045406, 1682335604, 2671627286, 3861350084, 341555594, 924563465},
				PC:  12071476,
				SR:  9752,
				USP: 13850312,
				SSP: 3298272,
				RAM: [][2]uint32{{12071468, 93}, {12071469, 206}, {12071470, 195}, {12071471, 38}, {12071472, 187}, {12071473, 94}, {12071474, 100}, {12071475, 174}},
				Cycles: 12,
			},
		},
		{
			name: "575 DBcc D4, # 55cc",
			init: 			cpuState{
				D:   [8]uint32{3398465277, 4046118544, 3350032113, 3006522020, 200177835, 3203422960, 1547170727, 1996912786},
				A:   [7]uint32{4278269708, 4268741705, 913522770, 2560890193, 4267568885, 2826394304, 744362832},
				PC:  11287532,
				SR:  9739,
				USP: 10771618,
				SSP: 15171856,
				RAM: [][2]uint32{{11287528, 85}, {11287529, 204}, {11287530, 146}, {11287531, 177}, {11287532, 12}, {11287533, 8}, {11287534, 223}, {11287535, 42}},
			},
			want: 			cpuState{
				D:   [8]uint32{3398465277, 4046118544, 3350032113, 3006522020, 200177835, 3203422960, 1547170727, 1996912786},
				A:   [7]uint32{4278269708, 4268741705, 913522770, 2560890193, 4267568885, 2826394304, 744362832},
				PC:  11287536,
				SR:  9739,
				USP: 10771618,
				SSP: 15171856,
				RAM: [][2]uint32{{11287528, 85}, {11287529, 204}, {11287530, 146}, {11287531, 177}, {11287532, 12}, {11287533, 8}, {11287534, 223}, {11287535, 42}},
				Cycles: 12,
			},
		},
		{
			name: "860 DBcc D0, # 5fc8",
			init: 			cpuState{
				D:   [8]uint32{43647937, 2676275847, 2799101150, 216023465, 483931305, 620374916, 2823628630, 4110159336},
				A:   [7]uint32{2653646276, 3163417911, 3143090315, 1656075252, 1748292788, 1848459548, 1983127209},
				PC:  13743048,
				SR:  1304,
				USP: 14376312,
				SSP: 14742306,
				RAM: [][2]uint32{{13743044, 95}, {13743045, 200}, {13743046, 43}, {13743047, 171}, {13743048, 72}, {13743049, 186}, {13743050, 193}, {13743051, 81}},
			},
			want: 			cpuState{
				D:   [8]uint32{43647937, 2676275847, 2799101150, 216023465, 483931305, 620374916, 2823628630, 4110159336},
				A:   [7]uint32{2653646276, 3163417911, 3143090315, 1656075252, 1748292788, 1848459548, 1983127209},
				PC:  13743052,
				SR:  1304,
				USP: 14376312,
				SSP: 14742306,
				RAM: [][2]uint32{{13743044, 95}, {13743045, 200}, {13743046, 43}, {13743047, 171}, {13743048, 72}, {13743049, 186}, {13743050, 193}, {13743051, 81}},
				Cycles: 12,
			},
		},
		{
			name: "1120 DBcc D6, # 5ace",
			init: 			cpuState{
				D:   [8]uint32{3349586119, 4190057191, 2823656414, 3615400465, 477294616, 3436627100, 275545553, 1566694537},
				A:   [7]uint32{2559066460, 3800706287, 2827414481, 2582266145, 796813037, 3191466779, 3078072052},
				PC:  8199002,
				SR:  8960,
				USP: 2472856,
				SSP: 15922030,
				RAM: [][2]uint32{{8198998, 90}, {8198999, 206}, {8199000, 23}, {8199001, 204}, {8199002, 34}, {8199003, 77}, {8199004, 134}, {8199005, 74}},
			},
			want: 			cpuState{
				D:   [8]uint32{3349586119, 4190057191, 2823656414, 3615400465, 477294616, 3436627100, 275545553, 1566694537},
				A:   [7]uint32{2559066460, 3800706287, 2827414481, 2582266145, 796813037, 3191466779, 3078072052},
				PC:  8199006,
				SR:  8960,
				USP: 2472856,
				SSP: 15922030,
				RAM: [][2]uint32{{8198998, 90}, {8198999, 206}, {8199000, 23}, {8199001, 204}, {8199002, 34}, {8199003, 77}, {8199004, 134}, {8199005, 74}},
				Cycles: 12,
			},
		},
		{
			name: "1421 DBcc D6, # 55ce",
			init: 			cpuState{
				D:   [8]uint32{3902066641, 3046638790, 2879619944, 612640710, 2364742993, 3121463941, 1936542161, 3813923963},
				A:   [7]uint32{927997157, 3898005509, 2590309944, 935656842, 199080779, 1392915423, 2655150696},
				PC:  9006300,
				SR:  8469,
				USP: 2787992,
				SSP: 1640720,
				RAM: [][2]uint32{{9006296, 85}, {9006297, 206}, {9006298, 169}, {9006299, 166}, {9006300, 64}, {9006301, 209}, {9006302, 9}, {9006303, 14}},
			},
			want: 			cpuState{
				D:   [8]uint32{3902066641, 3046638790, 2879619944, 612640710, 2364742993, 3121463941, 1936542161, 3813923963},
				A:   [7]uint32{927997157, 3898005509, 2590309944, 935656842, 199080779, 1392915423, 2655150696},
				PC:  9006304,
				SR:  8469,
				USP: 2787992,
				SSP: 1640720,
				RAM: [][2]uint32{{9006296, 85}, {9006297, 206}, {9006298, 169}, {9006299, 166}, {9006300, 64}, {9006301, 209}, {9006302, 9}, {9006303, 14}},
				Cycles: 12,
			},
		},
		{
			name: "1707 DBcc D2, # 54ca",
			init: 			cpuState{
				D:   [8]uint32{2593428400, 1832277526, 3211117475, 865124957, 3347077053, 3646540464, 842983439, 389381505},
				A:   [7]uint32{1886276495, 3776800098, 211787475, 2719188846, 3652001435, 3385733186, 375224677},
				PC:  2237292,
				SR:  8449,
				USP: 12970746,
				SSP: 10015238,
				RAM: [][2]uint32{{2237288, 84}, {2237289, 202}, {2237290, 206}, {2237291, 178}, {2224668, 34}, {2224669, 81}, {2224670, 221}, {2224671, 58}},
			},
			want: 			cpuState{
				D:   [8]uint32{2593428400, 1832277526, 3211117474, 865124957, 3347077053, 3646540464, 842983439, 389381505},
				A:   [7]uint32{1886276495, 3776800098, 211787475, 2719188846, 3652001435, 3385733186, 375224677},
				PC:  2224672,
				SR:  8449,
				USP: 12970746,
				SSP: 10015238,
				RAM: [][2]uint32{{2237288, 84}, {2237289, 202}, {2237290, 206}, {2237291, 178}, {2224668, 34}, {2224669, 81}, {2224670, 221}, {2224671, 58}},
				Cycles: 10,
			},
		},
		{
			name: "1956 DBcc D5, # 55cd",
			init: 			cpuState{
				D:   [8]uint32{1518296957, 643467897, 3126530911, 1815672830, 2111076835, 3000477958, 241921017, 3652875136},
				A:   [7]uint32{2194082446, 1065134476, 2276537903, 88790795, 3261504874, 1329615009, 691254248},
				PC:  15815640,
				SR:  29,
				USP: 12512924,
				SSP: 7977732,
				RAM: [][2]uint32{{15815636, 85}, {15815637, 205}, {15815638, 111}, {15815639, 207}, {15815640, 70}, {15815641, 202}, {15815642, 218}, {15815643, 250}},
			},
			want: 			cpuState{
				D:   [8]uint32{1518296957, 643467897, 3126530911, 1815672830, 2111076835, 3000477958, 241921017, 3652875136},
				A:   [7]uint32{2194082446, 1065134476, 2276537903, 88790795, 3261504874, 1329615009, 691254248},
				PC:  15815644,
				SR:  29,
				USP: 12512924,
				SSP: 7977732,
				RAM: [][2]uint32{{15815636, 85}, {15815637, 205}, {15815638, 111}, {15815639, 207}, {15815640, 70}, {15815641, 202}, {15815642, 218}, {15815643, 250}},
				Cycles: 12,
			},
		},
		{
			name: "2233 DBcc D0, # 5ec8",
			init: 			cpuState{
				D:   [8]uint32{2654277022, 324341859, 2619573796, 71965100, 2203773006, 1522236289, 802973925, 2921819687},
				A:   [7]uint32{517591372, 4026302922, 2368809606, 2069825476, 416784973, 354840788, 1172296038},
				PC:  8018146,
				SR:  777,
				USP: 3455620,
				SSP: 9342696,
				RAM: [][2]uint32{{8018142, 94}, {8018143, 200}, {8018144, 201}, {8018145, 118}, {8004182, 26}, {8004183, 96}, {8004184, 228}, {8004185, 90}},
			},
			want: 			cpuState{
				D:   [8]uint32{2654277021, 324341859, 2619573796, 71965100, 2203773006, 1522236289, 802973925, 2921819687},
				A:   [7]uint32{517591372, 4026302922, 2368809606, 2069825476, 416784973, 354840788, 1172296038},
				PC:  8004186,
				SR:  777,
				USP: 3455620,
				SSP: 9342696,
				RAM: [][2]uint32{{8018142, 94}, {8018143, 200}, {8018144, 201}, {8018145, 118}, {8004182, 26}, {8004183, 96}, {8004184, 228}, {8004185, 90}},
				Cycles: 10,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestJMP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 JMP (d16, A5) 4eed",
			init: cpuState{
				D:   [8]uint32{745889030, 751113020, 2468056411, 91420713, 1920717159, 183156110, 2387904918, 2689567734},
				A:   [7]uint32{942442625, 1780494319, 1538762649, 2721591091, 4025689279, 1757057227, 1932686148},
				PC:  2785168,
				SR:  9231,
				USP: 11061346,
				SSP: 12702386,
				RAM: [][2]uint32{{2785164, 78}, {2785165, 237}, {2785166, 94}, {2785167, 109}, {12250936, 182}, {12250937, 80}, {12250938, 109}, {12250939, 128}},
			},
			want: cpuState{
				D:   [8]uint32{745889030, 751113020, 2468056411, 91420713, 1920717159, 183156110, 2387904918, 2689567734},
				A:   [7]uint32{942442625, 1780494319, 1538762649, 2721591091, 4025689279, 1757057227, 1932686148},
				PC:  1757081404,
				SR:  9231,
				USP: 11061346,
				SSP: 12702386,
				RAM: [][2]uint32{{2785164, 78}, {2785165, 237}, {2785166, 94}, {2785167, 109}, {12250936, 182}, {12250937, 80}, {12250938, 109}, {12250939, 128}},
				Cycles: 10,
			},
		},
		{
			name: "500 JMP (d8, A6, Xn) 4ef6",
			init: cpuState{
				D:   [8]uint32{3272571536, 1336971600, 1189992508, 3497766230, 1202087446, 1853155348, 2432691630, 2711388394},
				A:   [7]uint32{2077230665, 62160572, 1749834634, 3286666578, 182905516, 596114910, 1839588409},
				PC:  2033070,
				SR:  32791,
				USP: 10509952,
				SSP: 8169246,
				RAM: [][2]uint32{{2033066, 78}, {2033067, 246}, {2033068, 22}, {2033069, 195}, {10843468, 217}, {10843469, 192}, {10843470, 27}, {10843471, 209}},
			},
			want: cpuState{
				D:   [8]uint32{3272571536, 1336971600, 1189992508, 3497766230, 1202087446, 1853155348, 2432691630, 2711388394},
				A:   [7]uint32{2077230665, 62160572, 1749834634, 3286666578, 182905516, 596114910, 1839588409},
				PC:  1839560016,
				SR:  32791,
				USP: 10509952,
				SSP: 8169246,
				RAM: [][2]uint32{{2033066, 78}, {2033067, 246}, {2033068, 22}, {2033069, 195}, {10843468, 217}, {10843469, 192}, {10843470, 27}, {10843471, 209}},
				Cycles: 14,
			},
		},
		{
			name: "1000 JMP (A5) 4ed5",
			init: cpuState{
				D:   [8]uint32{760543373, 3574582601, 2061523406, 3166992743, 2178936080, 3797177112, 897087586, 606564495},
				A:   [7]uint32{2926725022, 1987931151, 627560349, 3933496302, 3289922527, 223094650, 2878435780},
				PC:  8145484,
				SR:  42771,
				USP: 6107784,
				SSP: 13208250,
				RAM: [][2]uint32{{8145480, 78}, {8145481, 213}, {8145482, 226}, {8145483, 131}, {4990842, 15}, {4990843, 38}, {4990844, 17}, {4990845, 19}},
			},
			want: cpuState{
				D:   [8]uint32{760543373, 3574582601, 2061523406, 3166992743, 2178936080, 3797177112, 897087586, 606564495},
				A:   [7]uint32{2926725022, 1987931151, 627560349, 3933496302, 3289922527, 223094650, 2878435780},
				PC:  223094654,
				SR:  42771,
				USP: 6107784,
				SSP: 13208250,
				RAM: [][2]uint32{{8145480, 78}, {8145481, 213}, {8145482, 226}, {8145483, 131}, {4990842, 15}, {4990843, 38}, {4990844, 17}, {4990845, 19}},
				Cycles: 8,
			},
		},
		{
			name: "1500 JMP (A7) 4ed7",
			init: cpuState{
				D:   [8]uint32{1012461551, 843842533, 1172216144, 3266381777, 3227195030, 742001114, 2456044769, 3898212410},
				A:   [7]uint32{828055125, 4124604081, 2999074623, 945305302, 3805355977, 1254410542, 1940611252},
				PC:  5832584,
				SR:  8968,
				USP: 4477770,
				SSP: 2782500,
				RAM: [][2]uint32{{5832580, 78}, {5832581, 215}, {5832582, 84}, {5832583, 179}, {2782500, 18}, {2782501, 171}, {2782502, 1}, {2782503, 233}},
			},
			want: cpuState{
				D:   [8]uint32{1012461551, 843842533, 1172216144, 3266381777, 3227195030, 742001114, 2456044769, 3898212410},
				A:   [7]uint32{828055125, 4124604081, 2999074623, 945305302, 3805355977, 1254410542, 1940611252},
				PC:  2782504,
				SR:  8968,
				USP: 4477770,
				SSP: 2782500,
				RAM: [][2]uint32{{5832580, 78}, {5832581, 215}, {5832582, 84}, {5832583, 179}, {2782500, 18}, {2782501, 171}, {2782502, 1}, {2782503, 233}},
				Cycles: 8,
			},
		},
		{
			name: "2000 JMP (d16, A5) 4eed",
			init: cpuState{
				D:   [8]uint32{1155252600, 774649694, 3340398229, 4252194510, 971016656, 3542734191, 2337693389, 4037864046},
				A:   [7]uint32{1588553176, 2566817684, 472276968, 4009903322, 2768960548, 3341013647, 3339811079},
				PC:  14792884,
				SR:  1796,
				USP: 12915786,
				SSP: 1888142,
				RAM: [][2]uint32{{14792880, 78}, {14792881, 237}, {14792882, 140}, {14792883, 250}, {12, 57}, {13, 60}, {14, 155}, {15, 178}, {3972018, 159}, {3972019, 247}, {3972020, 144}, {3972021, 78}},
			},
			want: cpuState{
				D:      [8]uint32{1155252600, 774649694, 3340398229, 4252194510, 971016656, 3542734191, 2337693389, 4037864046},
				A:      [7]uint32{1588553176, 2566817684, 472276968, 4009903322, 2768960548, 3341013647, 3339811079},
				PC:     960273334,
				SR:     9988,
				USP:    12915786,
				SSP:    1888128,
				RAM:    [][2]uint32{{14792880, 78}, {14792881, 237}, {14792882, 140}, {14792883, 250}, {1888140, 184}, {1888141, 178}, {1888136, 7}, {1888137, 4}, {1888138, 0}, {1888139, 225}, {1888134, 78}, {1888135, 237}, {1888132, 95}, {1888133, 137}, {1888128, 78}, {1888129, 242}, {1888130, 199}, {1888131, 35}, {12, 57}, {13, 60}, {14, 155}, {15, 178}, {3972018, 159}, {3972019, 247}, {3972020, 144}, {3972021, 78}},
				Halted: true,
			},
		},
		{
			name: "002 JMP (A2) 4ed2",
			init: 			cpuState{
				D:   [8]uint32{3744390971, 310280575, 2083613810, 2869483669, 2736033861, 3855679803, 377307942, 280803634},
				A:   [7]uint32{2237884922, 362595010, 4146600978, 2084742503, 2539469226, 1920363500, 2826393125},
				PC:  11186812,
				SR:  1806,
				USP: 2247958,
				SSP: 14131648,
				RAM: [][2]uint32{{11186808, 78}, {11186809, 210}, {11186810, 171}, {11186811, 98}, {2628626, 18}, {2628627, 189}, {2628628, 169}, {2628629, 75}},
			},
			want: 			cpuState{
				D:   [8]uint32{3744390971, 310280575, 2083613810, 2869483669, 2736033861, 3855679803, 377307942, 280803634},
				A:   [7]uint32{2237884922, 362595010, 4146600978, 2084742503, 2539469226, 1920363500, 2826393125},
				PC:  4146600982,
				SR:  1806,
				USP: 2247958,
				SSP: 14131648,
				RAM: [][2]uint32{{11186808, 78}, {11186809, 210}, {11186810, 171}, {11186811, 98}, {2628626, 18}, {2628627, 189}, {2628628, 169}, {2628629, 75}},
				Cycles: 8,
			},
		},
		{
			name: "290 JMP (A7) 4ed7",
			init: 			cpuState{
				D:   [8]uint32{1818261428, 240733226, 150964732, 2398582615, 4061620953, 689231909, 1581815296, 1650544298},
				A:   [7]uint32{1497420075, 3080302874, 3064882875, 4103492788, 2822027793, 3299497040, 2901660258},
				PC:  10159306,
				SR:  1808,
				USP: 10493564,
				SSP: 10078830,
				RAM: [][2]uint32{{10159302, 78}, {10159303, 215}, {10159304, 15}, {10159305, 245}, {10493564, 37}, {10493565, 51}, {10493566, 61}, {10493567, 73}},
			},
			want: 			cpuState{
				D:   [8]uint32{1818261428, 240733226, 150964732, 2398582615, 4061620953, 689231909, 1581815296, 1650544298},
				A:   [7]uint32{1497420075, 3080302874, 3064882875, 4103492788, 2822027793, 3299497040, 2901660258},
				PC:  10493568,
				SR:  1808,
				USP: 10493564,
				SSP: 10078830,
				RAM: [][2]uint32{{10159302, 78}, {10159303, 215}, {10159304, 15}, {10159305, 245}, {10493564, 37}, {10493565, 51}, {10493566, 61}, {10493567, 73}},
				Cycles: 8,
			},
		},
		{
			name: "550 JMP (d8, A5, Xn) 4ef5",
			init: 			cpuState{
				D:   [8]uint32{3555371860, 3785108322, 942189904, 126694247, 335470999, 549742058, 4160938776, 266199334},
				A:   [7]uint32{3696286543, 1466867653, 2225968366, 585245902, 3685364595, 3405867913, 845329588},
				PC:  2518922,
				SR:  1549,
				USP: 11494754,
				SSP: 1672864,
				RAM: [][2]uint32{{2518918, 78}, {2518919, 245}, {2518920, 248}, {2518921, 231}, {11587794, 37}, {11587795, 122}, {11587796, 167}, {11587797, 158}},
			},
			want: 			cpuState{
				D:   [8]uint32{3555371860, 3785108322, 942189904, 126694247, 335470999, 549742058, 4160938776, 266199334},
				A:   [7]uint32{3696286543, 1466867653, 2225968366, 585245902, 3685364595, 3405867913, 845329588},
				PC:  3417362646,
				SR:  1549,
				USP: 11494754,
				SSP: 1672864,
				RAM: [][2]uint32{{2518918, 78}, {2518919, 245}, {2518920, 248}, {2518921, 231}, {11587794, 37}, {11587795, 122}, {11587796, 167}, {11587797, 158}},
				Cycles: 14,
			},
		},
		{
			name: "884 JMP (d8, A2, Xn) 4ef2",
			init: 			cpuState{
				D:   [8]uint32{3377022815, 2206961387, 4131239892, 3648587277, 2304988195, 1868510111, 1243635876, 3139524255},
				A:   [7]uint32{3952526551, 3586555623, 766377165, 2312209174, 1709591296, 1985709770, 6321340},
				PC:  4632982,
				SR:  9223,
				USP: 2247002,
				SSP: 1939664,
				RAM: [][2]uint32{{4632978, 78}, {4632979, 242}, {4632980, 70}, {4632981, 224}, {11423952, 19}, {11423953, 148}, {11423954, 64}, {11423955, 148}},
			},
			want: 			cpuState{
				D:   [8]uint32{3377022815, 2206961387, 4131239892, 3648587277, 2304988195, 1868510111, 1243635876, 3139524255},
				A:   [7]uint32{3952526551, 3586555623, 766377165, 2312209174, 1709591296, 1985709770, 6321340},
				PC:  766398676,
				SR:  9223,
				USP: 2247002,
				SSP: 1939664,
				RAM: [][2]uint32{{4632978, 78}, {4632979, 242}, {4632980, 70}, {4632981, 224}, {11423952, 19}, {11423953, 148}, {11423954, 64}, {11423955, 148}},
				Cycles: 14,
			},
		},
		{
			name: "1164 JMP (A3) 4ed3",
			init: 			cpuState{
				D:   [8]uint32{1416932103, 1272490069, 2291060412, 587108322, 1640828923, 2853829601, 2852436833, 3070961525},
				A:   [7]uint32{1072240562, 1830093036, 3127627101, 3003638498, 1597500401, 706000092, 1338893642},
				PC:  12257662,
				SR:  1793,
				USP: 15162546,
				SSP: 5673784,
				RAM: [][2]uint32{{12257658, 78}, {12257659, 211}, {12257660, 41}, {12257661, 93}, {516834, 222}, {516835, 40}, {516836, 89}, {516837, 231}},
			},
			want: 			cpuState{
				D:   [8]uint32{1416932103, 1272490069, 2291060412, 587108322, 1640828923, 2853829601, 2852436833, 3070961525},
				A:   [7]uint32{1072240562, 1830093036, 3127627101, 3003638498, 1597500401, 706000092, 1338893642},
				PC:  3003638502,
				SR:  1793,
				USP: 15162546,
				SSP: 5673784,
				RAM: [][2]uint32{{12257658, 78}, {12257659, 211}, {12257660, 41}, {12257661, 93}, {516834, 222}, {516835, 40}, {516836, 89}, {516837, 231}},
				Cycles: 8,
			},
		},
		{
			name: "1424 JMP (d8, A4, Xn) 4ef4",
			init: 			cpuState{
				D:   [8]uint32{623619191, 3991883439, 4188264709, 4212902648, 268090526, 3555004833, 1324926046, 2493027623},
				A:   [7]uint32{4054940064, 2202101429, 2877341222, 3382144959, 2504020517, 704006443, 2593060042},
				PC:  16022814,
				SR:  10007,
				USP: 13679480,
				SSP: 15152950,
				RAM: [][2]uint32{{16022810, 78}, {16022811, 244}, {16022812, 88}, {16022813, 162}, {2450280, 86}, {2450281, 216}, {2450282, 170}, {2450283, 37}},
			},
			want: 			cpuState{
				D:   [8]uint32{623619191, 3991883439, 4188264709, 4212902648, 268090526, 3555004833, 1324926046, 2493027623},
				A:   [7]uint32{4054940064, 2202101429, 2877341222, 3382144959, 2504020517, 704006443, 2593060042},
				PC:  1764057964,
				SR:  10007,
				USP: 13679480,
				SSP: 15152950,
				RAM: [][2]uint32{{16022810, 78}, {16022811, 244}, {16022812, 88}, {16022813, 162}, {2450280, 86}, {2450281, 216}, {2450282, 170}, {2450283, 37}},
				Cycles: 14,
			},
		},
		{
			name: "1715 JMP (A0) 4ed0",
			init: 			cpuState{
				D:   [8]uint32{1547067246, 301116217, 2056277735, 3790368636, 879508977, 2201289260, 130437978, 3487381183},
				A:   [7]uint32{2978461562, 2961813061, 3232833686, 4115420444, 3334095828, 3575547358, 2011949616},
				PC:  5213576,
				SR:  1304,
				USP: 16243498,
				SSP: 6068202,
				RAM: [][2]uint32{{5213572, 78}, {5213573, 208}, {5213574, 176}, {5213575, 148}, {8894330, 42}, {8894331, 188}, {8894332, 113}, {8894333, 145}},
			},
			want: 			cpuState{
				D:   [8]uint32{1547067246, 301116217, 2056277735, 3790368636, 879508977, 2201289260, 130437978, 3487381183},
				A:   [7]uint32{2978461562, 2961813061, 3232833686, 4115420444, 3334095828, 3575547358, 2011949616},
				PC:  2978461566,
				SR:  1304,
				USP: 16243498,
				SSP: 6068202,
				RAM: [][2]uint32{{5213572, 78}, {5213573, 208}, {5213574, 176}, {5213575, 148}, {8894330, 42}, {8894331, 188}, {8894332, 113}, {8894333, 145}},
				Cycles: 8,
			},
		},
		{
			name: "1985 JMP (d16, A6) 4eee",
			init: 			cpuState{
				D:   [8]uint32{388783237, 3145556346, 312038295, 709583471, 2709148336, 534154399, 3747343444, 1536403559},
				A:   [7]uint32{401212231, 645002434, 582726513, 1506184876, 2504046996, 1325624254, 83033475},
				PC:  13493248,
				SR:  781,
				USP: 7105898,
				SSP: 14475254,
				RAM: [][2]uint32{{13493244, 78}, {13493245, 238}, {13493246, 254}, {13493247, 139}, {15924238, 115}, {15924239, 170}, {15924240, 132}, {15924241, 93}},
			},
			want: 			cpuState{
				D:   [8]uint32{388783237, 3145556346, 312038295, 709583471, 2709148336, 534154399, 3747343444, 1536403559},
				A:   [7]uint32{401212231, 645002434, 582726513, 1506184876, 2504046996, 1325624254, 83033475},
				PC:  83033106,
				SR:  781,
				USP: 7105898,
				SSP: 14475254,
				RAM: [][2]uint32{{13493244, 78}, {13493245, 238}, {13493246, 254}, {13493247, 139}, {15924238, 115}, {15924239, 170}, {15924240, 132}, {15924241, 93}},
				Cycles: 10,
			},
		},
		{
			name: "2251 JMP (d16, A7) 4eef",
			init: 			cpuState{
				D:   [8]uint32{1720522785, 2495137690, 796552993, 3315554100, 923763456, 2323965484, 593458886, 1895237861},
				A:   [7]uint32{3187622514, 1127081772, 2079816551, 788036742, 3381893267, 3838970024, 1325940466},
				PC:  15926296,
				SR:  8473,
				USP: 5631552,
				SSP: 10675100,
				RAM: [][2]uint32{{15926292, 78}, {15926293, 239}, {15926294, 40}, {15926295, 230}, {10685570, 4}, {10685571, 184}, {10685572, 161}, {10685573, 246}},
			},
			want: 			cpuState{
				D:   [8]uint32{1720522785, 2495137690, 796552993, 3315554100, 923763456, 2323965484, 593458886, 1895237861},
				A:   [7]uint32{3187622514, 1127081772, 2079816551, 788036742, 3381893267, 3838970024, 1325940466},
				PC:  10685574,
				SR:  8473,
				USP: 5631552,
				SSP: 10675100,
				RAM: [][2]uint32{{15926292, 78}, {15926293, 239}, {15926294, 40}, {15926295, 230}, {10685570, 4}, {10685571, 184}, {10685572, 161}, {10685573, 246}},
				Cycles: 10,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestJSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 JSR (d8, A1, Xn) 4eb1",
			init: cpuState{
				D:   [8]uint32{1600294685, 3112433752, 1669031062, 34427579, 1785411382, 1773508002, 2759635301, 758111668},
				A:   [7]uint32{1754547812, 1256436806, 438165672, 2420389637, 2509340694, 1870930497, 372462759},
				PC:  7570002,
				SR:  8982,
				USP: 14355986,
				SSP: 12815352,
				RAM: [][2]uint32{{7569998, 78}, {7569999, 177}, {7570000, 140}, {7570001, 244}, {7862942, 83}, {7862943, 93}, {7862944, 87}, {7862945, 133}},
			},
			want: cpuState{
				D:   [8]uint32{1600294685, 3112433752, 1669031062, 34427579, 1785411382, 1773508002, 2759635301, 758111668},
				A:   [7]uint32{1754547812, 1256436806, 438165672, 2420389637, 2509340694, 1870930497, 372462759},
				PC:  3010984610,
				SR:  8982,
				USP: 14355986,
				SSP: 12815348,
				RAM: [][2]uint32{{7569998, 78}, {7569999, 177}, {7570000, 140}, {7570001, 244}, {7862942, 83}, {7862943, 93}, {12815348, 0}, {12815349, 115}, {12815350, 130}, {12815351, 82}, {7862944, 87}, {7862945, 133}},
				Cycles: 22,
			},
		},
		{
			name: "500 JSR (d16, A6) 4eae",
			init: cpuState{
				D:   [8]uint32{4170057760, 3048064759, 4159830885, 802967404, 2501638666, 3518291317, 258346968, 1925559210},
				A:   [7]uint32{3454652510, 4080744271, 1094589163, 1206408458, 626715477, 794874404, 2160408342},
				PC:  15845638,
				SR:  1818,
				USP: 12836776,
				SSP: 13946840,
				RAM: [][2]uint32{{15845634, 78}, {15845635, 174}, {15845636, 33}, {15845637, 48}, {12933190, 129}, {12933191, 105}, {12933192, 39}, {12933193, 165}},
			},
			want: cpuState{
				D:   [8]uint32{4170057760, 3048064759, 4159830885, 802967404, 2501638666, 3518291317, 258346968, 1925559210},
				A:   [7]uint32{3454652510, 4080744271, 1094589163, 1206408458, 626715477, 794874404, 2160408342},
				PC:  2160416842,
				SR:  1818,
				USP: 12836772,
				SSP: 13946840,
				RAM: [][2]uint32{{15845634, 78}, {15845635, 174}, {15845636, 33}, {15845637, 48}, {12933190, 129}, {12933191, 105}, {12836772, 0}, {12836773, 241}, {12836774, 201}, {12836775, 6}, {12933192, 39}, {12933193, 165}},
				Cycles: 18,
			},
		},
		{
			name: "1000 JSR (A3) 4e93",
			init: cpuState{
				D:   [8]uint32{3390383189, 3548604776, 1962784537, 626072408, 1376102999, 3141586279, 3361195775, 701006708},
				A:   [7]uint32{4251518801, 1492861572, 841385586, 2676393951, 2886469397, 3073328202, 650965347},
				PC:  16384000,
				SR:  9500,
				USP: 8655398,
				SSP: 11677748,
				RAM: [][2]uint32{{16383996, 78}, {16383997, 147}, {16383998, 255}, {16383999, 123}, {12, 99}, {13, 30}, {14, 188}, {15, 196}, {2014404, 79}, {2014405, 109}, {2014406, 41}, {2014407, 134}},
			},
			want: cpuState{
				D:      [8]uint32{3390383189, 3548604776, 1962784537, 626072408, 1376102999, 3141586279, 3361195775, 701006708},
				A:      [7]uint32{4251518801, 1492861572, 841385586, 2676393951, 2886469397, 3073328202, 650965347},
				PC:     1662958792,
				SR:     9500,
				USP:    8655398,
				SSP:    11677734,
				RAM:    [][2]uint32{{16383996, 78}, {16383997, 147}, {16383998, 255}, {16383999, 123}, {11677746, 255}, {11677747, 254}, {11677742, 37}, {11677743, 28}, {11677744, 0}, {11677745, 249}, {11677740, 78}, {11677741, 147}, {11677738, 135}, {11677739, 223}, {11677734, 78}, {11677735, 150}, {11677736, 159}, {11677737, 134}, {12, 99}, {13, 30}, {14, 188}, {15, 196}, {2014404, 79}, {2014405, 109}, {2014406, 41}, {2014407, 134}},
				Halted: true,
			},
		},
		{
			name: "1500 JSR (d8, A2, Xn) 4eb2",
			init: cpuState{
				D:   [8]uint32{409797424, 2669198804, 514792184, 2600671081, 1564663472, 1655659042, 2081094196, 3464513787},
				A:   [7]uint32{3053473403, 894802690, 108960797, 2296543056, 4272828092, 1873103683, 1748237444},
				PC:  3798614,
				SR:  8733,
				USP: 16484310,
				SSP: 6167888,
				RAM: [][2]uint32{{3798610, 78}, {3798611, 178}, {3798612, 86}, {3798613, 128}, {12, 112}, {13, 164}, {14, 147}, {15, 168}, {10785704, 55}, {10785705, 6}, {10785706, 12}, {10785707, 38}},
			},
			want: cpuState{
				D:      [8]uint32{409797424, 2669198804, 514792184, 2600671081, 1564663472, 1655659042, 2081094196, 3464513787},
				A:      [7]uint32{3053473403, 894802690, 108960797, 2296543056, 4272828092, 1873103683, 1748237444},
				PC:     1889833900,
				SR:     8733,
				USP:    16484310,
				SSP:    6167874,
				RAM:    [][2]uint32{{3798610, 78}, {3798611, 178}, {3798612, 86}, {3798613, 128}, {6167886, 246}, {6167887, 86}, {6167882, 34}, {6167883, 29}, {6167884, 0}, {6167885, 57}, {6167880, 78}, {6167881, 178}, {6167878, 245}, {6167879, 191}, {6167874, 78}, {6167875, 182}, {6167876, 6}, {6167877, 126}, {12, 112}, {13, 164}, {14, 147}, {15, 168}, {10785704, 55}, {10785705, 6}, {10785706, 12}, {10785707, 38}},
				Halted: true,
			},
		},
		{
			name: "2000 JSR (d16, A3) 4eab",
			init: cpuState{
				D:   [8]uint32{3586360724, 3879548271, 1126100928, 3364551242, 278618610, 1967958598, 4214867775, 3618881800},
				A:   [7]uint32{3905959790, 634339621, 1566442007, 2782971118, 1808052656, 1723049753, 2646940198},
				PC:  3683006,
				SR:  9501,
				USP: 4779146,
				SSP: 8945124,
				RAM: [][2]uint32{{3683002, 78}, {3683003, 171}, {3683004, 73}, {3683005, 74}, {14749240, 4}, {14749241, 206}, {14749242, 244}, {14749243, 200}},
			},
			want: cpuState{
				D:   [8]uint32{3586360724, 3879548271, 1126100928, 3364551242, 278618610, 1967958598, 4214867775, 3618881800},
				A:   [7]uint32{3905959790, 634339621, 1566442007, 2782971118, 1808052656, 1723049753, 2646940198},
				PC:  2782989884,
				SR:  9501,
				USP: 4779146,
				SSP: 8945120,
				RAM: [][2]uint32{{3683002, 78}, {3683003, 171}, {3683004, 73}, {3683005, 74}, {14749240, 4}, {14749241, 206}, {8945120, 0}, {8945121, 56}, {8945122, 50}, {8945123, 190}, {14749242, 244}, {14749243, 200}},
				Cycles: 18,
			},
		},
		{
			name: "003 JSR (xxx).l 4eb9",
			init: 			cpuState{
				D:   [8]uint32{3629459289, 505751997, 2371311158, 296642398, 660777361, 3722988078, 3290962611, 3654872057},
				A:   [7]uint32{3569888054, 3299105378, 2805553307, 3980594431, 2312660712, 4101499234, 4263061543},
				PC:  15194720,
				SR:  9746,
				USP: 4445360,
				SSP: 2752178,
				RAM: [][2]uint32{{15194716, 78}, {15194717, 185}, {15194718, 26}, {15194719, 103}, {15194720, 61}, {15194721, 180}, {6766004, 255}, {6766005, 89}, {6766006, 137}, {6766007, 221}},
			},
			want: 			cpuState{
				D:   [8]uint32{3629459289, 505751997, 2371311158, 296642398, 660777361, 3722988078, 3290962611, 3654872057},
				A:   [7]uint32{3569888054, 3299105378, 2805553307, 3980594431, 2312660712, 4101499234, 4263061543},
				PC:  442973624,
				SR:  9746,
				USP: 4445360,
				SSP: 2752174,
				RAM: [][2]uint32{{15194716, 78}, {15194717, 185}, {15194718, 26}, {15194719, 103}, {15194720, 61}, {15194721, 180}, {6766004, 255}, {6766005, 89}, {2752174, 0}, {2752175, 231}, {2752176, 218}, {2752177, 98}, {6766006, 137}, {6766007, 221}},
				Cycles: 20,
			},
		},
		{
			name: "316 JSR (d16, A4) 4eac",
			init: 			cpuState{
				D:   [8]uint32{868142738, 354466423, 284534417, 4104232055, 3466005602, 2953883887, 238828550, 3006963172},
				A:   [7]uint32{276595812, 1764759397, 3110891267, 2396824095, 2025238563, 1382332796, 4169641373},
				PC:  11443810,
				SR:  16,
				USP: 13057546,
				SSP: 3829400,
				RAM: [][2]uint32{{11443806, 78}, {11443807, 172}, {11443808, 194}, {11443809, 243}, {11957014, 32}, {11957015, 218}, {11957016, 219}, {11957017, 175}},
			},
			want: 			cpuState{
				D:   [8]uint32{868142738, 354466423, 284534417, 4104232055, 3466005602, 2953883887, 238828550, 3006963172},
				A:   [7]uint32{276595812, 1764759397, 3110891267, 2396824095, 2025238563, 1382332796, 4169641373},
				PC:  2025222938,
				SR:  16,
				USP: 13057542,
				SSP: 3829400,
				RAM: [][2]uint32{{11443806, 78}, {11443807, 172}, {11443808, 194}, {11443809, 243}, {11957014, 32}, {11957015, 218}, {13057542, 0}, {13057543, 174}, {13057544, 158}, {13057545, 98}, {11957016, 219}, {11957017, 175}},
				Cycles: 18,
			},
		},
		{
			name: "592 JSR (d8, A2, Xn) 4eb2",
			init: 			cpuState{
				D:   [8]uint32{2119582394, 3936314924, 2569700506, 1923422257, 2548035792, 1318996975, 3545879964, 3252179245},
				A:   [7]uint32{1108906742, 3294537872, 4226815256, 3391110752, 3417475375, 1178335497, 581875965},
				PC:  14894606,
				SR:  282,
				USP: 2592326,
				SSP: 9393360,
				RAM: [][2]uint32{{14894602, 78}, {14894603, 178}, {14894604, 155}, {14894605, 154}, {5160258, 133}, {5160259, 202}, {5160260, 215}, {5160261, 124}},
			},
			want: 			cpuState{
				D:   [8]uint32{2119582394, 3936314924, 2569700506, 1923422257, 2548035792, 1318996975, 3545879964, 3252179245},
				A:   [7]uint32{1108906742, 3294537872, 4226815256, 3391110752, 3417475375, 1178335497, 581875965},
				PC:  3226385734,
				SR:  282,
				USP: 2592322,
				SSP: 9393360,
				RAM: [][2]uint32{{14894602, 78}, {14894603, 178}, {14894604, 155}, {14894605, 154}, {5160258, 133}, {5160259, 202}, {2592322, 0}, {2592323, 227}, {2592324, 70}, {2592325, 14}, {5160260, 215}, {5160261, 124}},
				Cycles: 22,
			},
		},
		{
			name: "876 JSR (A6) 4e96",
			init: 			cpuState{
				D:   [8]uint32{661743764, 613412166, 751056344, 1443000290, 71722486, 2748514253, 3433184086, 215717158},
				A:   [7]uint32{623771874, 281839475, 391403221, 3855300390, 1026777726, 1819982819, 688312276},
				PC:  11738058,
				SR:  512,
				USP: 8615460,
				SSP: 16263096,
				RAM: [][2]uint32{{11738054, 78}, {11738055, 150}, {11738056, 165}, {11738057, 150}, {446420, 13}, {446421, 151}, {446422, 172}, {446423, 8}},
			},
			want: 			cpuState{
				D:   [8]uint32{661743764, 613412166, 751056344, 1443000290, 71722486, 2748514253, 3433184086, 215717158},
				A:   [7]uint32{623771874, 281839475, 391403221, 3855300390, 1026777726, 1819982819, 688312276},
				PC:  688312280,
				SR:  512,
				USP: 8615456,
				SSP: 16263096,
				RAM: [][2]uint32{{11738054, 78}, {11738055, 150}, {11738056, 165}, {11738057, 150}, {446420, 13}, {446421, 151}, {8615456, 0}, {8615457, 179}, {8615458, 27}, {8615459, 200}, {446422, 172}, {446423, 8}},
				Cycles: 16,
			},
		},
		{
			name: "1142 JSR (A1) 4e91",
			init: 			cpuState{
				D:   [8]uint32{2346473202, 2377143731, 3082241831, 2399447798, 2898673026, 1398708500, 3183151994, 3794251749},
				A:   [7]uint32{1528005866, 4204058186, 4030000943, 3743585374, 469260928, 1121878523, 3614196917},
				PC:  14517274,
				SR:  265,
				USP: 15922350,
				SSP: 940944,
				RAM: [][2]uint32{{14517270, 78}, {14517271, 145}, {14517272, 152}, {14517273, 110}, {9754186, 123}, {9754187, 145}, {9754188, 15}, {9754189, 157}},
			},
			want: 			cpuState{
				D:   [8]uint32{2346473202, 2377143731, 3082241831, 2399447798, 2898673026, 1398708500, 3183151994, 3794251749},
				A:   [7]uint32{1528005866, 4204058186, 4030000943, 3743585374, 469260928, 1121878523, 3614196917},
				PC:  4204058190,
				SR:  265,
				USP: 15922346,
				SSP: 940944,
				RAM: [][2]uint32{{14517270, 78}, {14517271, 145}, {14517272, 152}, {14517273, 110}, {9754186, 123}, {9754187, 145}, {15922346, 0}, {15922347, 221}, {15922348, 132}, {15922349, 24}, {9754188, 15}, {9754189, 157}},
				Cycles: 16,
			},
		},
		{
			name: "1414 JSR (A7) 4e97",
			init: 			cpuState{
				D:   [8]uint32{2945836143, 1009560261, 155140764, 1587394894, 393549435, 2384288700, 811971260, 4120810789},
				A:   [7]uint32{1766611108, 2747968798, 602798690, 1003874403, 3564783413, 4157724165, 925923431},
				PC:  16113542,
				SR:  1806,
				USP: 4519666,
				SSP: 993698,
				RAM: [][2]uint32{{16113538, 78}, {16113539, 151}, {16113540, 96}, {16113541, 7}, {4519666, 157}, {4519667, 88}, {4519668, 207}, {4519669, 128}},
			},
			want: 			cpuState{
				D:   [8]uint32{2945836143, 1009560261, 155140764, 1587394894, 393549435, 2384288700, 811971260, 4120810789},
				A:   [7]uint32{1766611108, 2747968798, 602798690, 1003874403, 3564783413, 4157724165, 925923431},
				PC:  4519670,
				SR:  1806,
				USP: 4519662,
				SSP: 993698,
				RAM: [][2]uint32{{16113538, 78}, {16113539, 151}, {16113540, 96}, {16113541, 7}, {4519666, 157}, {4519667, 88}, {4519662, 0}, {4519663, 245}, {4519664, 223}, {4519665, 132}, {4519668, 207}, {4519669, 128}},
				Cycles: 16,
			},
		},
		{
			name: "1715 JSR (d16, A0) 4ea8",
			init: 			cpuState{
				D:   [8]uint32{469279478, 2552739937, 2856533797, 1725406948, 688609795, 3035116537, 3037974048, 1081189811},
				A:   [7]uint32{4100861811, 4164995928, 2857825774, 2932911455, 900953644, 1213938565, 157687326},
				PC:  16012636,
				SR:  273,
				USP: 6746062,
				SSP: 7387072,
				RAM: [][2]uint32{{16012632, 78}, {16012633, 168}, {16012634, 200}, {16012635, 121}, {7206892, 160}, {7206893, 181}, {7206894, 207}, {7206895, 182}},
			},
			want: 			cpuState{
				D:   [8]uint32{469279478, 2552739937, 2856533797, 1725406948, 688609795, 3035116537, 3037974048, 1081189811},
				A:   [7]uint32{4100861811, 4164995928, 2857825774, 2932911455, 900953644, 1213938565, 157687326},
				PC:  4100847600,
				SR:  273,
				USP: 6746058,
				SSP: 7387072,
				RAM: [][2]uint32{{16012632, 78}, {16012633, 168}, {16012634, 200}, {16012635, 121}, {7206892, 160}, {7206893, 181}, {6746058, 0}, {6746059, 244}, {6746060, 85}, {6746061, 92}, {7206894, 207}, {7206895, 182}},
				Cycles: 18,
			},
		},
		{
			name: "1956 JSR (d8, A4, Xn) 4eb4",
			init: 			cpuState{
				D:   [8]uint32{3025691546, 1420890446, 196451958, 1543645855, 4198525482, 4059080247, 3714373175, 909116154},
				A:   [7]uint32{2091959268, 3741881994, 111889556, 4160949409, 202707189, 970164951, 3560080301},
				PC:  11566038,
				SR:  8962,
				USP: 5930382,
				SSP: 16302120,
				RAM: [][2]uint32{{11566034, 78}, {11566035, 180}, {11566036, 65}, {11566037, 211}, {1407730, 6}, {1407731, 119}, {1407732, 212}, {1407733, 209}},
			},
			want: 			cpuState{
				D:   [8]uint32{3025691546, 1420890446, 196451958, 1543645855, 4198525482, 4059080247, 3714373175, 909116154},
				A:   [7]uint32{2091959268, 3741881994, 111889556, 4160949409, 202707189, 970164951, 3560080301},
				PC:  202734326,
				SR:  8962,
				USP: 5930382,
				SSP: 16302116,
				RAM: [][2]uint32{{11566034, 78}, {11566035, 180}, {11566036, 65}, {11566037, 211}, {1407730, 6}, {1407731, 119}, {16302116, 0}, {16302117, 176}, {16302118, 123}, {16302119, 214}, {1407732, 212}, {1407733, 209}},
				Cycles: 22,
			},
		},
		{
			name: "2211 JSR (A4) 4e94",
			init: 			cpuState{
				D:   [8]uint32{240981700, 4166470293, 577781084, 2372576107, 2050713276, 1156514216, 16333686, 2668272969},
				A:   [7]uint32{789675105, 574500639, 3751838861, 2022592004, 3840506154, 3475538531, 3035044234},
				PC:  10863868,
				SR:  285,
				USP: 677770,
				SSP: 8465238,
				RAM: [][2]uint32{{10863864, 78}, {10863865, 148}, {10863866, 11}, {10863867, 88}, {15300906, 51}, {15300907, 234}, {15300908, 79}, {15300909, 240}},
			},
			want: 			cpuState{
				D:   [8]uint32{240981700, 4166470293, 577781084, 2372576107, 2050713276, 1156514216, 16333686, 2668272969},
				A:   [7]uint32{789675105, 574500639, 3751838861, 2022592004, 3840506154, 3475538531, 3035044234},
				PC:  3840506158,
				SR:  285,
				USP: 677766,
				SSP: 8465238,
				RAM: [][2]uint32{{10863864, 78}, {10863865, 148}, {10863866, 11}, {10863867, 88}, {15300906, 51}, {15300907, 234}, {677766, 0}, {677767, 165}, {677768, 196}, {677769, 250}, {15300908, 79}, {15300909, 240}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestRTS(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 RTS 4e75",
			init: cpuState{
				D:   [8]uint32{1695586892, 2581458317, 3573081930, 3842343658, 3273788867, 3861101892, 497534621, 1062265147},
				A:   [7]uint32{680415265, 3338935803, 612009649, 3170529000, 1229391163, 1605743300, 3812752736},
				PC:  16646948,
				SR:  42001,
				USP: 2170122,
				SSP: 2454062,
				RAM: [][2]uint32{{16646944, 78}, {16646945, 117}, {16646946, 198}, {16646947, 249}, {2454062, 77}, {2454063, 34}, {2454064, 244}, {2454065, 132}, {2290820, 102}, {2290821, 59}, {2290822, 0}, {2290823, 183}},
			},
			want: cpuState{
				D:   [8]uint32{1695586892, 2581458317, 3573081930, 3842343658, 3273788867, 3861101892, 497534621, 1062265147},
				A:   [7]uint32{680415265, 3338935803, 612009649, 3170529000, 1229391163, 1605743300, 3812752736},
				PC:  1294136456,
				SR:  42001,
				USP: 2170122,
				SSP: 2454066,
				RAM: [][2]uint32{{16646944, 78}, {16646945, 117}, {16646946, 198}, {16646947, 249}, {2454062, 77}, {2454063, 34}, {2454064, 244}, {2454065, 132}, {2290820, 102}, {2290821, 59}, {2290822, 0}, {2290823, 183}},
				Cycles: 16,
			},
		},
		{
			name: "500 RTS 4e75",
			init: cpuState{
				D:   [8]uint32{629022600, 663757219, 2316567015, 61143864, 3665773000, 2914065297, 1948540536, 1775383208},
				A:   [7]uint32{1493197715, 857111238, 1016204030, 675911558, 2695398306, 3168255150, 3566256598},
				PC:  5335628,
				SR:  34309,
				USP: 9377998,
				SSP: 7581754,
				RAM: [][2]uint32{{5335624, 78}, {5335625, 117}, {5335626, 173}, {5335627, 62}, {9377998, 147}, {9377999, 166}, {9378000, 223}, {9378001, 184}, {10936248, 68}, {10936249, 8}, {10936250, 176}, {10936251, 210}},
			},
			want: cpuState{
				D:   [8]uint32{629022600, 663757219, 2316567015, 61143864, 3665773000, 2914065297, 1948540536, 1775383208},
				A:   [7]uint32{1493197715, 857111238, 1016204030, 675911558, 2695398306, 3168255150, 3566256598},
				PC:  2477187004,
				SR:  34309,
				USP: 9378002,
				SSP: 7581754,
				RAM: [][2]uint32{{5335624, 78}, {5335625, 117}, {5335626, 173}, {5335627, 62}, {9377998, 147}, {9377999, 166}, {9378000, 223}, {9378001, 184}, {10936248, 68}, {10936249, 8}, {10936250, 176}, {10936251, 210}},
				Cycles: 16,
			},
		},
		{
			name: "1000 RTS 4e75",
			init: cpuState{
				D:   [8]uint32{1136298507, 2309943268, 2479884004, 1433412065, 3481035468, 989636940, 2244900975, 1463489540},
				A:   [7]uint32{747737787, 1124982305, 1238221132, 1287989246, 2034727518, 1826599331, 681943309},
				PC:  11803834,
				SR:  33285,
				USP: 1134946,
				SSP: 4934874,
				RAM: [][2]uint32{{11803830, 78}, {11803831, 117}, {11803832, 11}, {11803833, 82}, {1134946, 219}, {1134947, 21}, {1134948, 183}, {1134949, 48}, {1423152, 91}, {1423153, 178}, {1423154, 174}, {1423155, 129}},
			},
			want: cpuState{
				D:   [8]uint32{1136298507, 2309943268, 2479884004, 1433412065, 3481035468, 989636940, 2244900975, 1463489540},
				A:   [7]uint32{747737787, 1124982305, 1238221132, 1287989246, 2034727518, 1826599331, 681943309},
				PC:  3675633460,
				SR:  33285,
				USP: 1134950,
				SSP: 4934874,
				RAM: [][2]uint32{{11803830, 78}, {11803831, 117}, {11803832, 11}, {11803833, 82}, {1134946, 219}, {1134947, 21}, {1134948, 183}, {1134949, 48}, {1423152, 91}, {1423153, 178}, {1423154, 174}, {1423155, 129}},
				Cycles: 16,
			},
		},
		{
			name: "1500 RTS 4e75",
			init: cpuState{
				D:   [8]uint32{1733660104, 3063328298, 1422780063, 261130745, 3760094743, 222816045, 3986566305, 2545228888},
				A:   [7]uint32{1026467905, 2337815119, 402480534, 4069753170, 1474969818, 2480941049, 2661582173},
				PC:  15553060,
				SR:  41745,
				USP: 11392022,
				SSP: 2861738,
				RAM: [][2]uint32{{15553056, 78}, {15553057, 117}, {15553058, 195}, {15553059, 145}, {2861738, 5}, {2861739, 212}, {2861740, 73}, {2861741, 23}, {12, 116}, {13, 188}, {14, 107}, {15, 86}, {12348246, 79}, {12348247, 29}, {12348248, 146}, {12348249, 154}},
			},
			want: cpuState{
				D:      [8]uint32{1733660104, 3063328298, 1422780063, 261130745, 3760094743, 222816045, 3986566305, 2545228888},
				A:      [7]uint32{1026467905, 2337815119, 402480534, 4069753170, 1474969818, 2480941049, 2661582173},
				PC:     1958505306,
				SR:     8977,
				USP:    11392022,
				SSP:    2861728,
				RAM:    [][2]uint32{{15553056, 78}, {15553057, 117}, {15553058, 195}, {15553059, 145}, {2861738, 0}, {2861739, 237}, {2861740, 82}, {2861741, 34}, {2861736, 163}, {2861737, 17}, {2861734, 78}, {2861735, 117}, {2861732, 73}, {2861733, 23}, {2861728, 78}, {2861729, 118}, {2861730, 5}, {2861731, 212}, {12, 116}, {13, 188}, {14, 107}, {15, 86}, {12348246, 79}, {12348247, 29}, {12348248, 146}, {12348249, 154}},
				Halted: true,
			},
		},
		{
			name: "2000 RTS 4e75",
			init: cpuState{
				D:   [8]uint32{1484962938, 734951143, 1685375636, 3933067055, 1797407892, 2550938166, 3138527250, 1604251153},
				A:   [7]uint32{155407640, 1576724980, 1064857638, 205689168, 3544357790, 3385808559, 3402424142},
				PC:  14952584,
				SR:  42001,
				USP: 11386566,
				SSP: 5246450,
				RAM: [][2]uint32{{14952580, 78}, {14952581, 117}, {14952582, 66}, {14952583, 149}, {5246450, 31}, {5246451, 111}, {5246452, 203}, {5246453, 39}, {12, 54}, {13, 0}, {14, 42}, {15, 142}, {10894, 41}, {10895, 243}, {10896, 87}, {10897, 229}},
			},
			want: cpuState{
				D:      [8]uint32{1484962938, 734951143, 1685375636, 3933067055, 1797407892, 2550938166, 3138527250, 1604251153},
				A:      [7]uint32{155407640, 1576724980, 1064857638, 205689168, 3544357790, 3385808559, 3402424142},
				PC:     905980562,
				SR:     9233,
				USP:    11386566,
				SSP:    5246440,
				RAM:    [][2]uint32{{14952580, 78}, {14952581, 117}, {14952582, 66}, {14952583, 149}, {5246450, 0}, {5246451, 228}, {5246452, 40}, {5246453, 134}, {5246448, 164}, {5246449, 17}, {5246446, 78}, {5246447, 117}, {5246444, 203}, {5246445, 39}, {5246440, 78}, {5246441, 118}, {5246442, 31}, {5246443, 111}, {12, 54}, {13, 0}, {14, 42}, {15, 142}, {10894, 41}, {10895, 243}, {10896, 87}, {10897, 229}},
				Halted: true,
			},
		},
		{
			name: "007 RTS 4e75",
			init: 			cpuState{
				D:   [8]uint32{1703315640, 91163345, 3844220892, 1501042910, 2887028684, 2244550317, 3198360916, 753517783},
				A:   [7]uint32{3061160128, 2259894446, 1182338404, 3465441038, 1592396424, 3857304447, 2434830880},
				PC:  2376518,
				SR:  259,
				USP: 13127740,
				SSP: 799548,
				RAM: [][2]uint32{{2376514, 78}, {2376515, 117}, {2376516, 125}, {2376517, 13}, {13127740, 203}, {13127741, 70}, {13127742, 244}, {13127743, 224}, {4650208, 252}, {4650209, 67}, {4650210, 183}, {4650211, 157}},
			},
			want: 			cpuState{
				D:   [8]uint32{1703315640, 91163345, 3844220892, 1501042910, 2887028684, 2244550317, 3198360916, 753517783},
				A:   [7]uint32{3061160128, 2259894446, 1182338404, 3465441038, 1592396424, 3857304447, 2434830880},
				PC:  3410425060,
				SR:  259,
				USP: 13127744,
				SSP: 799548,
				RAM: [][2]uint32{{2376514, 78}, {2376515, 117}, {2376516, 125}, {2376517, 13}, {13127740, 203}, {13127741, 70}, {13127742, 244}, {13127743, 224}, {4650208, 252}, {4650209, 67}, {4650210, 183}, {4650211, 157}},
				Cycles: 16,
			},
		},
		{
			name: "328 RTS 4e75",
			init: 			cpuState{
				D:   [8]uint32{1607197557, 3811224781, 1102215870, 4199888075, 3209100952, 2348551288, 3250600121, 2739459544},
				A:   [7]uint32{3477916243, 1794208434, 2249800312, 1575481609, 481301103, 4117478329, 714706814},
				PC:  1863892,
				SR:  8196,
				USP: 7227282,
				SSP: 12911482,
				RAM: [][2]uint32{{1863888, 78}, {1863889, 117}, {1863890, 56}, {1863891, 238}, {12911482, 242}, {12911483, 87}, {12911484, 121}, {12911485, 74}, {5732682, 83}, {5732683, 231}, {5732684, 132}, {5732685, 138}},
			},
			want: 			cpuState{
				D:   [8]uint32{1607197557, 3811224781, 1102215870, 4199888075, 3209100952, 2348551288, 3250600121, 2739459544},
				A:   [7]uint32{3477916243, 1794208434, 2249800312, 1575481609, 481301103, 4117478329, 714706814},
				PC:  4065818958,
				SR:  8196,
				USP: 7227282,
				SSP: 12911486,
				RAM: [][2]uint32{{1863888, 78}, {1863889, 117}, {1863890, 56}, {1863891, 238}, {12911482, 242}, {12911483, 87}, {12911484, 121}, {12911485, 74}, {5732682, 83}, {5732683, 231}, {5732684, 132}, {5732685, 138}},
				Cycles: 16,
			},
		},
		{
			name: "620 RTS 4e75",
			init: 			cpuState{
				D:   [8]uint32{3412718931, 632507318, 598824480, 2363723929, 2368622157, 239515446, 3895817747, 1916972109},
				A:   [7]uint32{143782934, 2299626476, 2598069286, 1970770044, 2600599437, 842798649, 1911343551},
				PC:  14954830,
				SR:  1810,
				USP: 14846834,
				SSP: 276528,
				RAM: [][2]uint32{{14954826, 78}, {14954827, 117}, {14954828, 69}, {14954829, 102}, {14846834, 62}, {14846835, 142}, {14846836, 229}, {14846837, 204}, {9364940, 132}, {9364941, 61}, {9364942, 226}, {9364943, 88}},
			},
			want: 			cpuState{
				D:   [8]uint32{3412718931, 632507318, 598824480, 2363723929, 2368622157, 239515446, 3895817747, 1916972109},
				A:   [7]uint32{143782934, 2299626476, 2598069286, 1970770044, 2600599437, 842798649, 1911343551},
				PC:  1049552336,
				SR:  1810,
				USP: 14846838,
				SSP: 276528,
				RAM: [][2]uint32{{14954826, 78}, {14954827, 117}, {14954828, 69}, {14954829, 102}, {14846834, 62}, {14846835, 142}, {14846836, 229}, {14846837, 204}, {9364940, 132}, {9364941, 61}, {9364942, 226}, {9364943, 88}},
				Cycles: 16,
			},
		},
		{
			name: "884 RTS 4e75",
			init: 			cpuState{
				D:   [8]uint32{207529417, 686694467, 3074008627, 1351752980, 622349835, 3390261717, 1309228887, 3508979570},
				A:   [7]uint32{1693005172, 978631358, 4124809569, 551833469, 359856625, 536449170, 168330166},
				PC:  12658248,
				SR:  516,
				USP: 16618468,
				SSP: 14017132,
				RAM: [][2]uint32{{12658244, 78}, {12658245, 117}, {12658246, 78}, {12658247, 77}, {16618468, 58}, {16618469, 254}, {16618470, 101}, {16618471, 224}, {16672224, 54}, {16672225, 93}, {16672226, 183}, {16672227, 85}},
			},
			want: 			cpuState{
				D:   [8]uint32{207529417, 686694467, 3074008627, 1351752980, 622349835, 3390261717, 1309228887, 3508979570},
				A:   [7]uint32{1693005172, 978631358, 4124809569, 551833469, 359856625, 536449170, 168330166},
				PC:  989750756,
				SR:  516,
				USP: 16618472,
				SSP: 14017132,
				RAM: [][2]uint32{{12658244, 78}, {12658245, 117}, {12658246, 78}, {12658247, 77}, {16618468, 58}, {16618469, 254}, {16618470, 101}, {16618471, 224}, {16672224, 54}, {16672225, 93}, {16672226, 183}, {16672227, 85}},
				Cycles: 16,
			},
		},
		{
			name: "1173 RTS 4e75",
			init: 			cpuState{
				D:   [8]uint32{2580601693, 2038515568, 1323453910, 567845997, 212860524, 60888647, 3063719250, 679896056},
				A:   [7]uint32{4294471165, 54817344, 3124217142, 2002635860, 4146864771, 3251443114, 1426912955},
				PC:  5884516,
				SR:  8448,
				USP: 6563092,
				SSP: 1124028,
				RAM: [][2]uint32{{5884512, 78}, {5884513, 117}, {5884514, 91}, {5884515, 169}, {1124028, 195}, {1124029, 204}, {1124030, 110}, {1124031, 234}, {13397738, 180}, {13397739, 245}, {13397740, 161}, {13397741, 231}},
			},
			want: 			cpuState{
				D:   [8]uint32{2580601693, 2038515568, 1323453910, 567845997, 212860524, 60888647, 3063719250, 679896056},
				A:   [7]uint32{4294471165, 54817344, 3124217142, 2002635860, 4146864771, 3251443114, 1426912955},
				PC:  3284954862,
				SR:  8448,
				USP: 6563092,
				SSP: 1124032,
				RAM: [][2]uint32{{5884512, 78}, {5884513, 117}, {5884514, 91}, {5884515, 169}, {1124028, 195}, {1124029, 204}, {1124030, 110}, {1124031, 234}, {13397738, 180}, {13397739, 245}, {13397740, 161}, {13397741, 231}},
				Cycles: 16,
			},
		},
		{
			name: "1406 RTS 4e75",
			init: 			cpuState{
				D:   [8]uint32{3000136672, 394632047, 2005118131, 2088016797, 2311247506, 3263797724, 3601803310, 2909645766},
				A:   [7]uint32{1205338975, 1420943698, 1812378751, 1647502445, 154559265, 783852868, 3617462916},
				PC:  10924370,
				SR:  8213,
				USP: 11139400,
				SSP: 3958324,
				RAM: [][2]uint32{{10924366, 78}, {10924367, 117}, {10924368, 199}, {10924369, 77}, {3958324, 53}, {3958325, 224}, {3958326, 196}, {3958327, 78}, {14730318, 14}, {14730319, 90}, {14730320, 134}, {14730321, 107}},
			},
			want: 			cpuState{
				D:   [8]uint32{3000136672, 394632047, 2005118131, 2088016797, 2311247506, 3263797724, 3601803310, 2909645766},
				A:   [7]uint32{1205338975, 1420943698, 1812378751, 1647502445, 154559265, 783852868, 3617462916},
				PC:  903922770,
				SR:  8213,
				USP: 11139400,
				SSP: 3958328,
				RAM: [][2]uint32{{10924366, 78}, {10924367, 117}, {10924368, 199}, {10924369, 77}, {3958324, 53}, {3958325, 224}, {3958326, 196}, {3958327, 78}, {14730318, 14}, {14730319, 90}, {14730320, 134}, {14730321, 107}},
				Cycles: 16,
			},
		},
		{
			name: "1626 RTS 4e75",
			init: 			cpuState{
				D:   [8]uint32{3730708063, 4017496960, 646882259, 913203577, 1120692805, 1984672646, 456289406, 3180989253},
				A:   [7]uint32{1564987679, 1483293056, 1258326551, 3136749117, 3967214842, 938438884, 751788206},
				PC:  11383774,
				SR:  1310,
				USP: 9655910,
				SSP: 16256654,
				RAM: [][2]uint32{{11383770, 78}, {11383771, 117}, {11383772, 157}, {11383773, 192}, {9655910, 253}, {9655911, 26}, {9655912, 241}, {9655913, 28}, {1765660, 53}, {1765661, 99}, {1765662, 129}, {1765663, 25}},
			},
			want: 			cpuState{
				D:   [8]uint32{3730708063, 4017496960, 646882259, 913203577, 1120692805, 1984672646, 456289406, 3180989253},
				A:   [7]uint32{1564987679, 1483293056, 1258326551, 3136749117, 3967214842, 938438884, 751788206},
				PC:  4246401312,
				SR:  1310,
				USP: 9655914,
				SSP: 16256654,
				RAM: [][2]uint32{{11383770, 78}, {11383771, 117}, {11383772, 157}, {11383773, 192}, {9655910, 253}, {9655911, 26}, {9655912, 241}, {9655913, 28}, {1765660, 53}, {1765661, 99}, {1765662, 129}, {1765663, 25}},
				Cycles: 16,
			},
		},
		{
			name: "1966 RTS 4e75",
			init: 			cpuState{
				D:   [8]uint32{3731408631, 3370747259, 3608432569, 775301054, 3245838699, 2933766001, 3154642759, 3094962313},
				A:   [7]uint32{1953917619, 528016440, 2068188965, 313339134, 2474594556, 3930153897, 1894476541},
				PC:  7526880,
				SR:  1283,
				USP: 11211128,
				SSP: 1022972,
				RAM: [][2]uint32{{7526876, 78}, {7526877, 117}, {7526878, 96}, {7526879, 207}, {11211128, 123}, {11211129, 10}, {11211130, 242}, {11211131, 98}, {717410, 129}, {717411, 9}, {717412, 229}, {717413, 102}},
			},
			want: 			cpuState{
				D:   [8]uint32{3731408631, 3370747259, 3608432569, 775301054, 3245838699, 2933766001, 3154642759, 3094962313},
				A:   [7]uint32{1953917619, 528016440, 2068188965, 313339134, 2474594556, 3930153897, 1894476541},
				PC:  2064314982,
				SR:  1283,
				USP: 11211132,
				SSP: 1022972,
				RAM: [][2]uint32{{7526876, 78}, {7526877, 117}, {7526878, 96}, {7526879, 207}, {11211128, 123}, {11211129, 10}, {11211130, 242}, {11211131, 98}, {717410, 129}, {717411, 9}, {717412, 229}, {717413, 102}},
				Cycles: 16,
			},
		},
		{
			name: "2235 RTS 4e75",
			init: 			cpuState{
				D:   [8]uint32{1637458035, 3086401278, 3545906611, 3593529504, 1080634586, 660024499, 2821200883, 407000396},
				A:   [7]uint32{1768766504, 1514553101, 2676816004, 466932596, 2164509645, 1987959304, 2896575865},
				PC:  15608460,
				SR:  543,
				USP: 13999142,
				SSP: 5393630,
				RAM: [][2]uint32{{15608456, 78}, {15608457, 117}, {15608458, 24}, {15608459, 47}, {13999142, 216}, {13999143, 210}, {13999144, 186}, {13999145, 190}, {13810366, 243}, {13810367, 200}, {13810368, 171}, {13810369, 143}},
			},
			want: 			cpuState{
				D:   [8]uint32{1637458035, 3086401278, 3545906611, 3593529504, 1080634586, 660024499, 2821200883, 407000396},
				A:   [7]uint32{1768766504, 1514553101, 2676816004, 466932596, 2164509645, 1987959304, 2896575865},
				PC:  3637689026,
				SR:  543,
				USP: 13999146,
				SSP: 5393630,
				RAM: [][2]uint32{{15608456, 78}, {15608457, 117}, {15608458, 24}, {15608459, 47}, {13999142, 216}, {13999143, 210}, {13999144, 186}, {13999145, 190}, {13810366, 243}, {13810367, 200}, {13810368, 171}, {13810369, 143}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestRTE(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 RTE 4e73",
			init: cpuState{
				D:   [8]uint32{2007613906, 3706720267, 1617529897, 1478009187, 377458258, 3442747953, 961913447, 3748574403},
				A:   [7]uint32{764235716, 3367791794, 2831329522, 575282664, 1029867960, 2013620114, 1419658330},
				PC:  15605432,
				SR:  778,
				USP: 4721610,
				SSP: 10621156,
				RAM: [][2]uint32{{15605428, 78}, {15605429, 115}, {15605430, 36}, {15605431, 157}, {32, 219}, {33, 226}, {34, 207}, {35, 28}, {14864156, 152}, {14864157, 203}, {14864158, 51}, {14864159, 135}},
			},
			want: cpuState{
				D:   [8]uint32{2007613906, 3706720267, 1617529897, 1478009187, 377458258, 3442747953, 961913447, 3748574403},
				A:   [7]uint32{764235716, 3367791794, 2831329522, 575282664, 1029867960, 2013620114, 1419658330},
				PC:  3689074464,
				SR:  8970,
				USP: 4721610,
				SSP: 10621150,
				RAM: [][2]uint32{{15605428, 78}, {15605429, 115}, {15605430, 36}, {15605431, 157}, {10621154, 30}, {10621155, 180}, {10621150, 3}, {10621151, 10}, {10621152, 0}, {10621153, 238}, {32, 219}, {33, 226}, {34, 207}, {35, 28}, {14864156, 152}, {14864157, 203}, {14864158, 51}, {14864159, 135}},
				Cycles: 34,
			},
		},
		{
			name: "500 RTE 4e73",
			init: cpuState{
				D:   [8]uint32{2221414571, 3956737362, 208546185, 1935250726, 2195464630, 1600184883, 3076862501, 2256691781},
				A:   [7]uint32{3359723529, 2485194935, 3152046800, 1310161809, 140537743, 2777150788, 3816163366},
				PC:  5342352,
				SR:  1537,
				USP: 4548948,
				SSP: 7149932,
				RAM: [][2]uint32{{5342348, 78}, {5342349, 115}, {5342350, 99}, {5342351, 217}, {32, 237}, {33, 230}, {34, 24}, {35, 42}, {15079466, 38}, {15079467, 50}, {15079468, 166}, {15079469, 187}},
			},
			want: cpuState{
				D:   [8]uint32{2221414571, 3956737362, 208546185, 1935250726, 2195464630, 1600184883, 3076862501, 2256691781},
				A:   [7]uint32{3359723529, 2485194935, 3152046800, 1310161809, 140537743, 2777150788, 3816163366},
				PC:  3991279662,
				SR:  9729,
				USP: 4548948,
				SSP: 7149926,
				RAM: [][2]uint32{{5342348, 78}, {5342349, 115}, {5342350, 99}, {5342351, 217}, {7149930, 132}, {7149931, 140}, {7149926, 6}, {7149927, 1}, {7149928, 0}, {7149929, 81}, {32, 237}, {33, 230}, {34, 24}, {35, 42}, {15079466, 38}, {15079467, 50}, {15079468, 166}, {15079469, 187}},
				Cycles: 34,
			},
		},
		{
			name: "1000 RTE 4e73",
			init: cpuState{
				D:   [8]uint32{3125306166, 3663182540, 3909088783, 3439064563, 3393840139, 1841608469, 1729574606, 2144366555},
				A:   [7]uint32{1031113320, 3529800621, 1726419362, 854766565, 103190725, 2236147592, 251468944},
				PC:  14897532,
				SR:  34055,
				USP: 7371654,
				SSP: 6134854,
				RAM: [][2]uint32{{14897528, 78}, {14897529, 115}, {14897530, 248}, {14897531, 193}, {32, 70}, {33, 142}, {34, 157}, {35, 222}, {9346526, 126}, {9346527, 247}, {9346528, 77}, {9346529, 170}},
			},
			want: cpuState{
				D:   [8]uint32{3125306166, 3663182540, 3909088783, 3439064563, 3393840139, 1841608469, 1729574606, 2144366555},
				A:   [7]uint32{1031113320, 3529800621, 1726419362, 854766565, 103190725, 2236147592, 251468944},
				PC:  1183751650,
				SR:  9479,
				USP: 7371654,
				SSP: 6134848,
				RAM: [][2]uint32{{14897528, 78}, {14897529, 115}, {14897530, 248}, {14897531, 193}, {6134852, 81}, {6134853, 120}, {6134848, 133}, {6134849, 7}, {6134850, 0}, {6134851, 227}, {32, 70}, {33, 142}, {34, 157}, {35, 222}, {9346526, 126}, {9346527, 247}, {9346528, 77}, {9346529, 170}},
				Cycles: 34,
			},
		},
		{
			name: "1500 RTE 4e73",
			init: cpuState{
				D:   [8]uint32{3607803679, 3055269627, 1964017250, 1053076135, 975355677, 2124515498, 2742135060, 1551329094},
				A:   [7]uint32{2519875778, 1597478461, 2776226350, 1381059176, 1071457636, 3904205493, 749588320},
				PC:  6376388,
				SR:  33812,
				USP: 8689902,
				SSP: 1081272,
				RAM: [][2]uint32{{6376384, 78}, {6376385, 115}, {6376386, 95}, {6376387, 231}, {32, 39}, {33, 236}, {34, 64}, {35, 34}, {15482914, 88}, {15482915, 90}, {15482916, 134}, {15482917, 206}},
			},
			want: cpuState{
				D:   [8]uint32{3607803679, 3055269627, 1964017250, 1053076135, 975355677, 2124515498, 2742135060, 1551329094},
				A:   [7]uint32{2519875778, 1597478461, 2776226350, 1381059176, 1071457636, 3904205493, 749588320},
				PC:  669794342,
				SR:  9236,
				USP: 8689902,
				SSP: 1081266,
				RAM: [][2]uint32{{6376384, 78}, {6376385, 115}, {6376386, 95}, {6376387, 231}, {1081270, 75}, {1081271, 192}, {1081266, 132}, {1081267, 20}, {1081268, 0}, {1081269, 97}, {32, 39}, {33, 236}, {34, 64}, {35, 34}, {15482914, 88}, {15482915, 90}, {15482916, 134}, {15482917, 206}},
				Cycles: 34,
			},
		},
		{
			name: "2000 RTE 4e73",
			init: cpuState{
				D:   [8]uint32{4030082485, 1969029020, 1327468247, 3708766939, 2662732343, 1790579801, 184152359, 2051792554},
				A:   [7]uint32{859156867, 2798190248, 3218804450, 3993992914, 3820347400, 726703149, 1086380784},
				PC:  10007566,
				SR:  42000,
				USP: 14222822,
				SSP: 9022358,
				RAM: [][2]uint32{{10007562, 78}, {10007563, 115}, {10007564, 221}, {10007565, 59}, {9022358, 49}, {9022359, 65}, {9022360, 99}, {9022361, 24}, {9022362, 76}, {9022363, 85}, {12, 165}, {13, 216}, {14, 211}, {15, 162}, {14209954, 145}, {14209955, 193}, {14209956, 23}, {14209957, 116}},
			},
			want: cpuState{
				D:      [8]uint32{4030082485, 1969029020, 1327468247, 3708766939, 2662732343, 1790579801, 184152359, 2051792554},
				A:      [7]uint32{859156867, 2798190248, 3218804450, 3993992914, 3820347400, 726703149, 1086380784},
				PC:     2782450598,
				SR:     8449,
				USP:    14222822,
				SSP:    9022350,
				RAM:    [][2]uint32{{10007562, 78}, {10007563, 115}, {10007564, 221}, {10007565, 59}, {9022358, 33}, {9022359, 1}, {9022360, 0}, {9022361, 152}, {9022362, 180}, {9022363, 12}, {9022356, 78}, {9022357, 115}, {9022354, 76}, {9022355, 85}, {9022350, 78}, {9022351, 118}, {9022352, 99}, {9022353, 24}, {12, 165}, {13, 216}, {14, 211}, {15, 162}, {14209954, 145}, {14209955, 193}, {14209956, 23}, {14209957, 116}},
				Halted: true,
			},
		},
		{
			name: "002 RTE 4e73",
			init: 			cpuState{
				D:   [8]uint32{2355569500, 375477428, 3453393552, 1316034171, 3309616410, 324891696, 810249802, 2046051050},
				A:   [7]uint32{1873776239, 2860897493, 4006167705, 3728266336, 2459151575, 985720719, 2999779519},
				PC:  5946288,
				SR:  287,
				USP: 8127750,
				SSP: 15125488,
				RAM: [][2]uint32{{5946284, 78}, {5946285, 115}, {5946286, 50}, {5946287, 125}, {32, 12}, {33, 212}, {34, 168}, {35, 138}, {13936778, 58}, {13936779, 63}, {13936780, 123}, {13936781, 252}},
			},
			want: 			cpuState{
				D:   [8]uint32{2355569500, 375477428, 3453393552, 1316034171, 3309616410, 324891696, 810249802, 2046051050},
				A:   [7]uint32{1873776239, 2860897493, 4006167705, 3728266336, 2459151575, 985720719, 2999779519},
				PC:  215263374,
				SR:  8479,
				USP: 8127750,
				SSP: 15125482,
				RAM: [][2]uint32{{5946284, 78}, {5946285, 115}, {5946286, 50}, {5946287, 125}, {15125486, 187}, {15125487, 172}, {15125482, 1}, {15125483, 31}, {15125484, 0}, {15125485, 90}, {32, 12}, {33, 212}, {34, 168}, {35, 138}, {13936778, 58}, {13936779, 63}, {13936780, 123}, {13936781, 252}},
				Cycles: 34,
			},
		},
		{
			name: "263 RTE 4e73",
			init: 			cpuState{
				D:   [8]uint32{1536462911, 3413337389, 2305013483, 501897363, 1905414115, 101166254, 4038226898, 3825414323},
				A:   [7]uint32{3915053534, 359225933, 2622562842, 1147927374, 3024691313, 2289204953, 222784870},
				PC:  8770676,
				SR:  1539,
				USP: 10573238,
				SSP: 14963026,
				RAM: [][2]uint32{{8770672, 78}, {8770673, 115}, {8770674, 160}, {8770675, 131}, {32, 177}, {33, 144}, {34, 214}, {35, 198}, {9492166, 222}, {9492167, 171}, {9492168, 20}, {9492169, 92}},
			},
			want: 			cpuState{
				D:   [8]uint32{1536462911, 3413337389, 2305013483, 501897363, 1905414115, 101166254, 4038226898, 3825414323},
				A:   [7]uint32{3915053534, 359225933, 2622562842, 1147927374, 3024691313, 2289204953, 222784870},
				PC:  2979059402,
				SR:  9731,
				USP: 10573238,
				SSP: 14963020,
				RAM: [][2]uint32{{8770672, 78}, {8770673, 115}, {8770674, 160}, {8770675, 131}, {14963024, 212}, {14963025, 112}, {14963020, 6}, {14963021, 3}, {14963022, 0}, {14963023, 133}, {32, 177}, {33, 144}, {34, 214}, {35, 198}, {9492166, 222}, {9492167, 171}, {9492168, 20}, {9492169, 92}},
				Cycles: 34,
			},
		},
		{
			name: "580 RTE 4e73",
			init: 			cpuState{
				D:   [8]uint32{1271797792, 2819487231, 2626366241, 276006019, 2823134206, 2056341369, 284093391, 792832010},
				A:   [7]uint32{3646604921, 472573906, 1733378130, 2470088145, 3255168132, 1169960750, 1899927085},
				PC:  14738158,
				SR:  787,
				USP: 13260052,
				SSP: 4691700,
				RAM: [][2]uint32{{14738154, 78}, {14738155, 115}, {14738156, 167}, {14738157, 199}, {32, 159}, {33, 64}, {34, 183}, {35, 250}, {4241402, 84}, {4241403, 94}, {4241404, 1}, {4241405, 120}},
			},
			want: 			cpuState{
				D:   [8]uint32{1271797792, 2819487231, 2626366241, 276006019, 2823134206, 2056341369, 284093391, 792832010},
				A:   [7]uint32{3646604921, 472573906, 1733378130, 2470088145, 3255168132, 1169960750, 1899927085},
				PC:  2671818750,
				SR:  8979,
				USP: 13260052,
				SSP: 4691694,
				RAM: [][2]uint32{{14738154, 78}, {14738155, 115}, {14738156, 167}, {14738157, 199}, {4691698, 226}, {4691699, 234}, {4691694, 3}, {4691695, 19}, {4691696, 0}, {4691697, 224}, {32, 159}, {33, 64}, {34, 183}, {35, 250}, {4241402, 84}, {4241403, 94}, {4241404, 1}, {4241405, 120}},
				Cycles: 34,
			},
		},
		{
			name: "817 RTE 4e73",
			init: 			cpuState{
				D:   [8]uint32{3527549680, 1906123345, 2474656830, 3166183437, 3672234306, 1273677633, 3135915679, 4284247897},
				A:   [7]uint32{232336689, 2669079342, 3004179323, 4222737915, 2190278205, 2001188204, 3182131587},
				PC:  6331642,
				SR:  1816,
				USP: 1527654,
				SSP: 15064528,
				RAM: [][2]uint32{{6331638, 78}, {6331639, 115}, {6331640, 0}, {6331641, 159}, {32, 228}, {33, 200}, {34, 175}, {35, 14}, {13152014, 22}, {13152015, 220}, {13152016, 206}, {13152017, 81}},
			},
			want: 			cpuState{
				D:   [8]uint32{3527549680, 1906123345, 2474656830, 3166183437, 3672234306, 1273677633, 3135915679, 4284247897},
				A:   [7]uint32{232336689, 2669079342, 3004179323, 4222737915, 2190278205, 2001188204, 3182131587},
				PC:  3838357266,
				SR:  10008,
				USP: 1527654,
				SSP: 15064522,
				RAM: [][2]uint32{{6331638, 78}, {6331639, 115}, {6331640, 0}, {6331641, 159}, {15064526, 156}, {15064527, 246}, {15064522, 7}, {15064523, 24}, {15064524, 0}, {15064525, 96}, {32, 228}, {33, 200}, {34, 175}, {35, 14}, {13152014, 22}, {13152015, 220}, {13152016, 206}, {13152017, 81}},
				Cycles: 34,
			},
		},
		{
			name: "1069 RTE 4e73",
			init: 			cpuState{
				D:   [8]uint32{3862684337, 265858706, 1215122699, 558566884, 1290093995, 2788352961, 3830734610, 2639989271},
				A:   [7]uint32{887911059, 4193919947, 2183992855, 1938312430, 3079075831, 4185151308, 3585515103},
				PC:  10621458,
				SR:  1285,
				USP: 6152012,
				SSP: 4618186,
				RAM: [][2]uint32{{10621454, 78}, {10621455, 115}, {10621456, 74}, {10621457, 196}, {32, 28}, {33, 226}, {34, 160}, {35, 50}, {14852146, 136}, {14852147, 83}, {14852148, 212}, {14852149, 131}},
			},
			want: 			cpuState{
				D:   [8]uint32{3862684337, 265858706, 1215122699, 558566884, 1290093995, 2788352961, 3830734610, 2639989271},
				A:   [7]uint32{887911059, 4193919947, 2183992855, 1938312430, 3079075831, 4185151308, 3585515103},
				PC:  484614198,
				SR:  9477,
				USP: 6152012,
				SSP: 4618180,
				RAM: [][2]uint32{{10621454, 78}, {10621455, 115}, {10621456, 74}, {10621457, 196}, {4618184, 18}, {4618185, 14}, {4618180, 5}, {4618181, 5}, {4618182, 0}, {4618183, 162}, {32, 28}, {33, 226}, {34, 160}, {35, 50}, {14852146, 136}, {14852147, 83}, {14852148, 212}, {14852149, 131}},
				Cycles: 34,
			},
		},
		{
			name: "1388 RTE 4e73",
			init: 			cpuState{
				D:   [8]uint32{3970173640, 3761229572, 1577588135, 2206299609, 2563185804, 1208700520, 519811718, 1035272059},
				A:   [7]uint32{1345081762, 2539787691, 2474870714, 4009254054, 209253373, 2093685379, 4036552357},
				PC:  14500892,
				SR:  772,
				USP: 3776186,
				SSP: 10601860,
				RAM: [][2]uint32{{14500888, 78}, {14500889, 115}, {14500890, 26}, {14500891, 174}, {32, 133}, {33, 180}, {34, 107}, {35, 252}, {11824124, 128}, {11824125, 22}, {11824126, 109}, {11824127, 89}},
			},
			want: 			cpuState{
				D:   [8]uint32{3970173640, 3761229572, 1577588135, 2206299609, 2563185804, 1208700520, 519811718, 1035272059},
				A:   [7]uint32{1345081762, 2539787691, 2474870714, 4009254054, 209253373, 2093685379, 4036552357},
				PC:  2243193856,
				SR:  8964,
				USP: 3776186,
				SSP: 10601854,
				RAM: [][2]uint32{{14500888, 78}, {14500889, 115}, {14500890, 26}, {14500891, 174}, {10601858, 68}, {10601859, 24}, {10601854, 3}, {10601855, 4}, {10601856, 0}, {10601857, 221}, {32, 133}, {33, 180}, {34, 107}, {35, 252}, {11824124, 128}, {11824125, 22}, {11824126, 109}, {11824127, 89}},
				Cycles: 34,
			},
		},
		{
			name: "1675 RTE 4e73",
			init: 			cpuState{
				D:   [8]uint32{4259457071, 2665691992, 741334102, 2805956744, 1372369403, 1075638579, 233585266, 713035557},
				A:   [7]uint32{3250524104, 790330689, 2853064704, 205159226, 1154718247, 121352722, 2710877249},
				PC:  15181980,
				SR:  1050,
				USP: 3607326,
				SSP: 3018282,
				RAM: [][2]uint32{{15181976, 78}, {15181977, 115}, {15181978, 151}, {15181979, 231}, {32, 205}, {33, 30}, {34, 52}, {35, 122}, {1979514, 56}, {1979515, 216}, {1979516, 84}, {1979517, 124}},
			},
			want: 			cpuState{
				D:   [8]uint32{4259457071, 2665691992, 741334102, 2805956744, 1372369403, 1075638579, 233585266, 713035557},
				A:   [7]uint32{3250524104, 790330689, 2853064704, 205159226, 1154718247, 121352722, 2710877249},
				PC:  3441308798,
				SR:  9242,
				USP: 3607326,
				SSP: 3018276,
				RAM: [][2]uint32{{15181976, 78}, {15181977, 115}, {15181978, 151}, {15181979, 231}, {3018280, 168}, {3018281, 152}, {3018276, 4}, {3018277, 26}, {3018278, 0}, {3018279, 231}, {32, 205}, {33, 30}, {34, 52}, {35, 122}, {1979514, 56}, {1979515, 216}, {1979516, 84}, {1979517, 124}},
				Cycles: 34,
			},
		},
		{
			name: "1945 RTE 4e73",
			init: 			cpuState{
				D:   [8]uint32{233878383, 2419923801, 1307576353, 2555435980, 66778732, 2524194660, 2739144303, 2559762432},
				A:   [7]uint32{3668482280, 4226960936, 1500292594, 459613619, 3791118949, 3709893321, 2466138879},
				PC:  1679504,
				SR:  1311,
				USP: 900410,
				SSP: 475318,
				RAM: [][2]uint32{{1679500, 78}, {1679501, 115}, {1679502, 23}, {1679503, 54}, {32, 110}, {33, 206}, {34, 214}, {35, 4}, {13555204, 138}, {13555205, 18}, {13555206, 21}, {13555207, 50}},
			},
			want: 			cpuState{
				D:   [8]uint32{233878383, 2419923801, 1307576353, 2555435980, 66778732, 2524194660, 2739144303, 2559762432},
				A:   [7]uint32{3668482280, 4226960936, 1500292594, 459613619, 3791118949, 3709893321, 2466138879},
				PC:  1859048968,
				SR:  9503,
				USP: 900410,
				SSP: 475312,
				RAM: [][2]uint32{{1679500, 78}, {1679501, 115}, {1679502, 23}, {1679503, 54}, {475316, 160}, {475317, 140}, {475312, 5}, {475313, 31}, {475314, 0}, {475315, 25}, {32, 110}, {33, 206}, {34, 214}, {35, 4}, {13555204, 138}, {13555205, 18}, {13555206, 21}, {13555207, 50}},
				Cycles: 34,
			},
		},
		{
			name: "2225 RTE 4e73",
			init: 			cpuState{
				D:   [8]uint32{2577279805, 790504683, 959985850, 2574738058, 3832917121, 667454788, 2931868821, 1135251930},
				A:   [7]uint32{2925244548, 811889537, 422085050, 2815866078, 703996503, 3283944904, 3395017225},
				PC:  10925314,
				SR:  8712,
				USP: 8780938,
				SSP: 9781830,
				RAM: [][2]uint32{{10925310, 78}, {10925311, 115}, {10925312, 62}, {10925313, 88}, {9781830, 183}, {9781831, 38}, {9781832, 201}, {9781833, 163}, {9781834, 126}, {9781835, 44}, {10714668, 84}, {10714669, 179}, {10714670, 195}, {10714671, 7}},
			},
			want: 			cpuState{
				D:   [8]uint32{2577279805, 790504683, 959985850, 2574738058, 3832917121, 667454788, 2931868821, 1135251930},
				A:   [7]uint32{2925244548, 811889537, 422085050, 2815866078, 703996503, 3283944904, 3395017225},
				PC:  3382935088,
				SR:  42758,
				USP: 8780938,
				SSP: 9781836,
				RAM: [][2]uint32{{10925310, 78}, {10925311, 115}, {10925312, 62}, {10925313, 88}, {9781830, 183}, {9781831, 38}, {9781832, 201}, {9781833, 163}, {9781834, 126}, {9781835, 44}, {10714668, 84}, {10714669, 179}, {10714670, 195}, {10714671, 7}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestRTR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 RTR 4e77",
			init: cpuState{
				D:   [8]uint32{887876628, 1649616181, 754186551, 1707996084, 3973797659, 2884949253, 3514544028, 4187563914},
				A:   [7]uint32{1766300949, 3299178609, 1105265473, 4189530864, 603131126, 273063191, 577203404},
				PC:  8390996,
				SR:  8469,
				USP: 10700098,
				SSP: 16670482,
				RAM: [][2]uint32{{8390992, 78}, {8390993, 119}, {8390994, 130}, {8390995, 52}, {16670482, 139}, {16670483, 123}, {16670484, 54}, {16670485, 195}, {16670486, 164}, {16670487, 202}, {12821706, 223}, {12821707, 101}, {12821708, 90}, {12821709, 61}},
			},
			want: cpuState{
				D:   [8]uint32{887876628, 1649616181, 754186551, 1707996084, 3973797659, 2884949253, 3514544028, 4187563914},
				A:   [7]uint32{1766300949, 3299178609, 1105265473, 4189530864, 603131126, 273063191, 577203404},
				PC:  918791374,
				SR:  8475,
				USP: 10700098,
				SSP: 16670488,
				RAM: [][2]uint32{{8390992, 78}, {8390993, 119}, {8390994, 130}, {8390995, 52}, {16670482, 139}, {16670483, 123}, {16670484, 54}, {16670485, 195}, {16670486, 164}, {16670487, 202}, {12821706, 223}, {12821707, 101}, {12821708, 90}, {12821709, 61}},
				Cycles: 20,
			},
		},
		{
			name: "500 RTR 4e77",
			init: cpuState{
				D:   [8]uint32{144575082, 3448157917, 3797288922, 2145681870, 1080874620, 657098350, 1343422443, 3314277674},
				A:   [7]uint32{2962757053, 3819692722, 1704417714, 680954669, 1046809227, 3333281498, 4193455201},
				PC:  7718938,
				SR:  531,
				USP: 6770832,
				SSP: 8647386,
				RAM: [][2]uint32{{7718934, 78}, {7718935, 119}, {7718936, 52}, {7718937, 28}, {6770832, 183}, {6770833, 51}, {6770834, 138}, {6770835, 143}, {6770836, 133}, {6770837, 114}, {9405810, 193}, {9405811, 57}, {9405812, 11}, {9405813, 27}},
			},
			want: cpuState{
				D:   [8]uint32{144575082, 3448157917, 3797288922, 2145681870, 1080874620, 657098350, 1343422443, 3314277674},
				A:   [7]uint32{2962757053, 3819692722, 1704417714, 680954669, 1046809227, 3333281498, 4193455201},
				PC:  2324661622,
				SR:  531,
				USP: 6770838,
				SSP: 8647386,
				RAM: [][2]uint32{{7718934, 78}, {7718935, 119}, {7718936, 52}, {7718937, 28}, {6770832, 183}, {6770833, 51}, {6770834, 138}, {6770835, 143}, {6770836, 133}, {6770837, 114}, {9405810, 193}, {9405811, 57}, {9405812, 11}, {9405813, 27}},
				Cycles: 20,
			},
		},
		{
			name: "1000 RTR 4e77",
			init: cpuState{
				D:   [8]uint32{1859631930, 3407559207, 3105071367, 1127178465, 2654869987, 223799096, 124335202, 875488641},
				A:   [7]uint32{2788112476, 2446366214, 285833550, 2051845484, 137069292, 1695483379, 1277784082},
				PC:  13793844,
				SR:  9993,
				USP: 2689244,
				SSP: 9850802,
				RAM: [][2]uint32{{13793840, 78}, {13793841, 119}, {13793842, 1}, {13793843, 226}, {9850802, 37}, {9850803, 212}, {9850804, 5}, {9850805, 254}, {9850806, 166}, {9850807, 81}, {12, 244}, {13, 186}, {14, 172}, {15, 24}, {12233752, 129}, {12233753, 189}, {12233754, 63}, {12233755, 209}},
			},
			want: cpuState{
				D:      [8]uint32{1859631930, 3407559207, 3105071367, 1127178465, 2654869987, 223799096, 124335202, 875488641},
				A:      [7]uint32{2788112476, 2446366214, 285833550, 2051845484, 137069292, 1695483379, 1277784082},
				PC:     4105874460,
				SR:     10004,
				USP:    2689244,
				SSP:    9850794,
				RAM:    [][2]uint32{{13793840, 78}, {13793841, 119}, {13793842, 1}, {13793843, 226}, {9850802, 39}, {9850803, 20}, {9850804, 0}, {9850805, 210}, {9850806, 122}, {9850807, 50}, {9850800, 78}, {9850801, 119}, {9850798, 166}, {9850799, 81}, {9850794, 78}, {9850795, 118}, {9850796, 5}, {9850797, 254}, {12, 244}, {13, 186}, {14, 172}, {15, 24}, {12233752, 129}, {12233753, 189}, {12233754, 63}, {12233755, 209}},
				Halted: true,
			},
		},
		{
			name: "1500 RTR 4e77",
			init: cpuState{
				D:   [8]uint32{1410329757, 1256322782, 2550808965, 1893424744, 3494168045, 315530377, 3520185035, 1030474678},
				A:   [7]uint32{2530038319, 2865297077, 489194764, 2372496306, 1409331026, 1108599352, 1432542654},
				PC:  883066,
				SR:  41989,
				USP: 4329160,
				SSP: 642558,
				RAM: [][2]uint32{{883062, 78}, {883063, 119}, {883064, 225}, {883065, 69}, {642558, 46}, {642559, 213}, {642560, 67}, {642561, 221}, {642562, 117}, {642563, 206}, {14513614, 131}, {14513615, 137}, {14513616, 125}, {14513617, 35}},
			},
			want: cpuState{
				D:   [8]uint32{1410329757, 1256322782, 2550808965, 1893424744, 3494168045, 315530377, 3520185035, 1030474678},
				A:   [7]uint32{2530038319, 2865297077, 489194764, 2372496306, 1409331026, 1108599352, 1432542654},
				PC:  1138587090,
				SR:  42005,
				USP: 4329160,
				SSP: 642564,
				RAM: [][2]uint32{{883062, 78}, {883063, 119}, {883064, 225}, {883065, 69}, {642558, 46}, {642559, 213}, {642560, 67}, {642561, 221}, {642562, 117}, {642563, 206}, {14513614, 131}, {14513615, 137}, {14513616, 125}, {14513617, 35}},
				Cycles: 20,
			},
		},
		{
			name: "2000 RTR 4e77",
			init: cpuState{
				D:   [8]uint32{517082379, 2043251229, 3181018212, 684885461, 118794459, 4077114755, 2793195966, 2895234059},
				A:   [7]uint32{2351101974, 3218097533, 2387558499, 2376605782, 98888236, 3651385614, 2559747564},
				PC:  4886308,
				SR:  33024,
				USP: 6164490,
				SSP: 12121582,
				RAM: [][2]uint32{{4886304, 78}, {4886305, 119}, {4886306, 214}, {4886307, 229}, {6164490, 232}, {6164491, 158}, {6164492, 231}, {6164493, 8}, {6164494, 235}, {6164495, 165}, {12, 234}, {13, 88}, {14, 180}, {15, 144}, {5813392, 246}, {5813393, 152}, {5813394, 8}, {5813395, 26}},
			},
			want: cpuState{
				D:      [8]uint32{517082379, 2043251229, 3181018212, 684885461, 118794459, 4077114755, 2793195966, 2895234059},
				A:      [7]uint32{2351101974, 3218097533, 2387558499, 2376605782, 98888236, 3651385614, 2559747564},
				PC:     3931681940,
				SR:     8478,
				USP:    6164496,
				SSP:    12121568,
				RAM:    [][2]uint32{{4886304, 78}, {4886305, 119}, {4886306, 214}, {4886307, 229}, {6164490, 232}, {6164491, 158}, {6164492, 231}, {6164493, 8}, {6164494, 235}, {6164495, 165}, {12121580, 143}, {12121581, 34}, {12121576, 129}, {12121577, 30}, {12121578, 0}, {12121579, 74}, {12121574, 78}, {12121575, 119}, {12121572, 235}, {12121573, 165}, {12121568, 78}, {12121569, 114}, {12121570, 231}, {12121571, 8}, {12, 234}, {13, 88}, {14, 180}, {15, 144}, {5813392, 246}, {5813393, 152}, {5813394, 8}, {5813395, 26}},
				Halted: true,
			},
		},
		{
			name: "008 RTR 4e77",
			init: 			cpuState{
				D:   [8]uint32{3830786693, 2786551899, 2921194822, 3851545684, 3713375452, 2178233308, 2416833894, 3612329301},
				A:   [7]uint32{2152369372, 3078370111, 2870153360, 1757905267, 2527794646, 2021868994, 1872036884},
				PC:  322726,
				SR:  8720,
				USP: 10907346,
				SSP: 1311786,
				RAM: [][2]uint32{{322722, 78}, {322723, 119}, {322724, 185}, {322725, 129}, {1311786, 5}, {1311787, 174}, {1311788, 195}, {1311789, 136}, {1311790, 185}, {1311791, 222}, {8960478, 65}, {8960479, 110}, {8960480, 42}, {8960481, 121}},
			},
			want: 			cpuState{
				D:   [8]uint32{3830786693, 2786551899, 2921194822, 3851545684, 3713375452, 2178233308, 2416833894, 3612329301},
				A:   [7]uint32{2152369372, 3078370111, 2870153360, 1757905267, 2527794646, 2021868994, 1872036884},
				PC:  3280517602,
				SR:  8718,
				USP: 10907346,
				SSP: 1311792,
				RAM: [][2]uint32{{322722, 78}, {322723, 119}, {322724, 185}, {322725, 129}, {1311786, 5}, {1311787, 174}, {1311788, 195}, {1311789, 136}, {1311790, 185}, {1311791, 222}, {8960478, 65}, {8960479, 110}, {8960480, 42}, {8960481, 121}},
				Cycles: 20,
			},
		},
		{
			name: "294 RTR 4e77",
			init: 			cpuState{
				D:   [8]uint32{1803092662, 514591490, 1835107895, 2602726051, 3072609652, 359143908, 239135290, 1730836130},
				A:   [7]uint32{3480766760, 2911467239, 1986771218, 3448296586, 490300199, 2099156787, 2808651430},
				PC:  559194,
				SR:  273,
				USP: 8747168,
				SSP: 13933896,
				RAM: [][2]uint32{{559190, 78}, {559191, 119}, {559192, 74}, {559193, 242}, {8747168, 118}, {8747169, 1}, {8747170, 19}, {8747171, 155}, {8747172, 150}, {8747173, 134}, {10196614, 58}, {10196615, 190}, {10196616, 190}, {10196617, 91}},
			},
			want: 			cpuState{
				D:   [8]uint32{1803092662, 514591490, 1835107895, 2602726051, 3072609652, 359143908, 239135290, 1730836130},
				A:   [7]uint32{3480766760, 2911467239, 1986771218, 3448296586, 490300199, 2099156787, 2808651430},
				PC:  328963722,
				SR:  257,
				USP: 8747174,
				SSP: 13933896,
				RAM: [][2]uint32{{559190, 78}, {559191, 119}, {559192, 74}, {559193, 242}, {8747168, 118}, {8747169, 1}, {8747170, 19}, {8747171, 155}, {8747172, 150}, {8747173, 134}, {10196614, 58}, {10196615, 190}, {10196616, 190}, {10196617, 91}},
				Cycles: 20,
			},
		},
		{
			name: "583 RTR 4e77",
			init: 			cpuState{
				D:   [8]uint32{2528060859, 3098374669, 1796195382, 4039379153, 3482794468, 984580358, 2135870485, 23758479},
				A:   [7]uint32{1473548569, 4039652079, 464890756, 2934184766, 1738341893, 203303282, 1769579714},
				PC:  11135128,
				SR:  8472,
				USP: 15253616,
				SSP: 14361788,
				RAM: [][2]uint32{{11135124, 78}, {11135125, 119}, {11135126, 208}, {11135127, 81}, {14361788, 197}, {14361789, 75}, {14361790, 176}, {14361791, 73}, {14361792, 189}, {14361793, 232}, {4832744, 124}, {4832745, 54}, {4832746, 245}, {4832747, 229}},
			},
			want: 			cpuState{
				D:   [8]uint32{2528060859, 3098374669, 1796195382, 4039379153, 3482794468, 984580358, 2135870485, 23758479},
				A:   [7]uint32{1473548569, 4039652079, 464890756, 2934184766, 1738341893, 203303282, 1769579714},
				PC:  2957622764,
				SR:  8459,
				USP: 15253616,
				SSP: 14361794,
				RAM: [][2]uint32{{11135124, 78}, {11135125, 119}, {11135126, 208}, {11135127, 81}, {14361788, 197}, {14361789, 75}, {14361790, 176}, {14361791, 73}, {14361792, 189}, {14361793, 232}, {4832744, 124}, {4832745, 54}, {4832746, 245}, {4832747, 229}},
				Cycles: 20,
			},
		},
		{
			name: "889 RTR 4e77",
			init: 			cpuState{
				D:   [8]uint32{637444404, 2674720772, 845809127, 2679426557, 309046979, 160948990, 2236446321, 3870086632},
				A:   [7]uint32{3430496485, 127577282, 1555619575, 3203044745, 233978483, 3076235349, 1007349596},
				PC:  508362,
				SR:  9495,
				USP: 15779130,
				SSP: 10794534,
				RAM: [][2]uint32{{508358, 78}, {508359, 119}, {508360, 140}, {508361, 18}, {10794534, 128}, {10794535, 110}, {10794536, 87}, {10794537, 43}, {10794538, 223}, {10794539, 126}, {2875262, 96}, {2875263, 71}, {2875264, 126}, {2875265, 108}},
			},
			want: 			cpuState{
				D:   [8]uint32{637444404, 2674720772, 845809127, 2679426557, 309046979, 160948990, 2236446321, 3870086632},
				A:   [7]uint32{3430496485, 127577282, 1555619575, 3203044745, 233978483, 3076235349, 1007349596},
				PC:  1462493058,
				SR:  9486,
				USP: 15779130,
				SSP: 10794540,
				RAM: [][2]uint32{{508358, 78}, {508359, 119}, {508360, 140}, {508361, 18}, {10794534, 128}, {10794535, 110}, {10794536, 87}, {10794537, 43}, {10794538, 223}, {10794539, 126}, {2875262, 96}, {2875263, 71}, {2875264, 126}, {2875265, 108}},
				Cycles: 20,
			},
		},
		{
			name: "1206 RTR 4e77",
			init: 			cpuState{
				D:   [8]uint32{1255759652, 1782274478, 811817317, 1698687398, 1642390075, 395612471, 298725950, 2377444018},
				A:   [7]uint32{3516333142, 1059202545, 2088342987, 851915400, 4208153952, 2732155012, 1210086837},
				PC:  2232904,
				SR:  1049,
				USP: 15249972,
				SSP: 6452324,
				RAM: [][2]uint32{{2232900, 78}, {2232901, 119}, {2232902, 108}, {2232903, 43}, {15249972, 78}, {15249973, 123}, {15249974, 68}, {15249975, 137}, {15249976, 237}, {15249977, 254}, {9039358, 81}, {9039359, 75}, {9039360, 95}, {9039361, 115}},
			},
			want: 			cpuState{
				D:   [8]uint32{1255759652, 1782274478, 811817317, 1698687398, 1642390075, 395612471, 298725950, 2377444018},
				A:   [7]uint32{3516333142, 1059202545, 2088342987, 851915400, 4208153952, 2732155012, 1210086837},
				PC:  1149890050,
				SR:  1051,
				USP: 15249978,
				SSP: 6452324,
				RAM: [][2]uint32{{2232900, 78}, {2232901, 119}, {2232902, 108}, {2232903, 43}, {15249972, 78}, {15249973, 123}, {15249974, 68}, {15249975, 137}, {15249976, 237}, {15249977, 254}, {9039358, 81}, {9039359, 75}, {9039360, 95}, {9039361, 115}},
				Cycles: 20,
			},
		},
		{
			name: "1469 RTR 4e77",
			init: 			cpuState{
				D:   [8]uint32{1070412993, 612631841, 1061590825, 1334123351, 3978993702, 1297665935, 90168478, 3629641303},
				A:   [7]uint32{2042816265, 3385691615, 3726325516, 750849995, 1615132749, 4281730692, 1658702709},
				PC:  496052,
				SR:  9220,
				USP: 11608228,
				SSP: 2857420,
				RAM: [][2]uint32{{496048, 78}, {496049, 119}, {496050, 215}, {496051, 217}, {2857420, 171}, {2857421, 211}, {2857422, 222}, {2857423, 59}, {2857424, 202}, {2857425, 162}, {3918498, 100}, {3918499, 135}, {3918500, 237}, {3918501, 161}},
			},
			want: 			cpuState{
				D:   [8]uint32{1070412993, 612631841, 1061590825, 1334123351, 3978993702, 1297665935, 90168478, 3629641303},
				A:   [7]uint32{2042816265, 3385691615, 3726325516, 750849995, 1615132749, 4281730692, 1658702709},
				PC:  3728460454,
				SR:  9235,
				USP: 11608228,
				SSP: 2857426,
				RAM: [][2]uint32{{496048, 78}, {496049, 119}, {496050, 215}, {496051, 217}, {2857420, 171}, {2857421, 211}, {2857422, 222}, {2857423, 59}, {2857424, 202}, {2857425, 162}, {3918498, 100}, {3918499, 135}, {3918500, 237}, {3918501, 161}},
				Cycles: 20,
			},
		},
		{
			name: "1684 RTR 4e77",
			init: 			cpuState{
				D:   [8]uint32{3993743365, 1647647245, 4202027395, 1081969292, 4103882994, 285405738, 1509611605, 30129089},
				A:   [7]uint32{658114449, 2283745263, 200539154, 1941529550, 3281174158, 3397358464, 1750653351},
				PC:  7831684,
				SR:  9733,
				USP: 1498786,
				SSP: 2890214,
				RAM: [][2]uint32{{7831680, 78}, {7831681, 119}, {7831682, 152}, {7831683, 242}, {2890214, 54}, {2890215, 232}, {2890216, 230}, {2890217, 240}, {2890218, 135}, {2890219, 22}, {15763222, 149}, {15763223, 17}, {15763224, 247}, {15763225, 207}},
			},
			want: 			cpuState{
				D:   [8]uint32{3993743365, 1647647245, 4202027395, 1081969292, 4103882994, 285405738, 1509611605, 30129089},
				A:   [7]uint32{658114449, 2283745263, 200539154, 1941529550, 3281174158, 3397358464, 1750653351},
				PC:  3874522906,
				SR:  9736,
				USP: 1498786,
				SSP: 2890220,
				RAM: [][2]uint32{{7831680, 78}, {7831681, 119}, {7831682, 152}, {7831683, 242}, {2890214, 54}, {2890215, 232}, {2890216, 230}, {2890217, 240}, {2890218, 135}, {2890219, 22}, {15763222, 149}, {15763223, 17}, {15763224, 247}, {15763225, 207}},
				Cycles: 20,
			},
		},
		{
			name: "1988 RTR 4e77",
			init: 			cpuState{
				D:   [8]uint32{1180986623, 572942785, 3607120831, 3893757712, 3092275828, 3991137529, 1310049624, 312932966},
				A:   [7]uint32{2528004332, 3820693911, 1481910859, 3325509286, 1658648816, 3912315578, 3159390312},
				PC:  1695358,
				SR:  9224,
				USP: 2593902,
				SSP: 14794396,
				RAM: [][2]uint32{{1695354, 78}, {1695355, 119}, {1695356, 64}, {1695357, 233}, {14794396, 249}, {14794397, 68}, {14794398, 191}, {14794399, 242}, {14794400, 112}, {14794401, 22}, {15888406, 90}, {15888407, 167}, {15888408, 8}, {15888409, 228}},
			},
			want: 			cpuState{
				D:   [8]uint32{1180986623, 572942785, 3607120831, 3893757712, 3092275828, 3991137529, 1310049624, 312932966},
				A:   [7]uint32{2528004332, 3820693911, 1481910859, 3325509286, 1658648816, 3912315578, 3159390312},
				PC:  3220336666,
				SR:  9220,
				USP: 2593902,
				SSP: 14794402,
				RAM: [][2]uint32{{1695354, 78}, {1695355, 119}, {1695356, 64}, {1695357, 233}, {14794396, 249}, {14794397, 68}, {14794398, 191}, {14794399, 242}, {14794400, 112}, {14794401, 22}, {15888406, 90}, {15888407, 167}, {15888408, 8}, {15888409, 228}},
				Cycles: 20,
			},
		},
		{
			name: "2238 RTR 4e77",
			init: 			cpuState{
				D:   [8]uint32{1747298798, 1217997947, 3978883167, 4137811423, 3880437960, 4175218555, 2369287689, 1764220085},
				A:   [7]uint32{2018430692, 3797810894, 2398830171, 3294037513, 4194380689, 2325000361, 4098497785},
				PC:  4375996,
				SR:  8711,
				USP: 3055538,
				SSP: 13039516,
				RAM: [][2]uint32{{4375992, 78}, {4375993, 119}, {4375994, 18}, {4375995, 105}, {13039516, 184}, {13039517, 10}, {13039518, 1}, {13039519, 254}, {13039520, 181}, {13039521, 248}, {16692728, 161}, {16692729, 230}, {16692730, 101}, {16692731, 252}},
			},
			want: 			cpuState{
				D:   [8]uint32{1747298798, 1217997947, 3978883167, 4137811423, 3880437960, 4175218555, 2369287689, 1764220085},
				A:   [7]uint32{2018430692, 3797810894, 2398830171, 3294037513, 4194380689, 2325000361, 4098497785},
				PC:  33469948,
				SR:  8714,
				USP: 3055538,
				SSP: 13039522,
				RAM: [][2]uint32{{4375992, 78}, {4375993, 119}, {4375994, 18}, {4375995, 105}, {13039516, 184}, {13039517, 10}, {13039518, 1}, {13039519, 254}, {13039520, 181}, {13039521, 248}, {16692728, 161}, {16692729, 230}, {16692730, 101}, {16692731, 252}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestScc(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 Scc (d8, A1, Xn) 58f1",
			init: cpuState{
				D:   [8]uint32{2355410420, 4032925383, 1116994587, 452526939, 3750177789, 3265598523, 4284137692, 4249560757},
				A:   [7]uint32{2312394867, 2995638878, 1947851535, 3663692246, 3369873501, 3516882026, 3661281778},
				PC:  15971444,
				SR:  33805,
				USP: 678102,
				SSP: 6517542,
				RAM: [][2]uint32{{15971440, 88}, {15971441, 241}, {15971442, 249}, {15971443, 242}, {15971444, 52}, {15971445, 150}, {9972518, 162}, {9972519, 48}, {15971446, 97}, {15971447, 219}},
			},
			want: cpuState{
				D:   [8]uint32{2355410420, 4032925383, 1116994587, 452526939, 3750177789, 3265598523, 4284137692, 4249560757},
				A:   [7]uint32{2312394867, 2995638878, 1947851535, 3663692246, 3369873501, 3516882026, 3661281778},
				PC:  15971448,
				SR:  33805,
				USP: 678102,
				SSP: 6517542,
				RAM: [][2]uint32{{15971440, 88}, {15971441, 241}, {15971442, 249}, {15971443, 242}, {15971444, 52}, {15971445, 150}, {9972518, 255}, {9972519, 48}, {15971446, 97}, {15971447, 219}},
				Cycles: 18,
			},
		},
		{
			name: "500 Scc (A2)+ 53da",
			init: cpuState{
				D:   [8]uint32{756830727, 3474189924, 27870880, 4087934069, 1642956519, 2849526014, 1770610631, 583771518},
				A:   [7]uint32{4090549674, 1201571667, 4187244547, 660748505, 4137055656, 3328310769, 703678363},
				PC:  6567738,
				SR:  8979,
				USP: 12566382,
				SSP: 12587668,
				RAM: [][2]uint32{{6567734, 83}, {6567735, 218}, {6567736, 47}, {6567737, 103}, {9717762, 48}, {9717763, 100}, {6567738, 238}, {6567739, 106}},
			},
			want: cpuState{
				D:   [8]uint32{756830727, 3474189924, 27870880, 4087934069, 1642956519, 2849526014, 1770610631, 583771518},
				A:   [7]uint32{4090549674, 1201571667, 4187244548, 660748505, 4137055656, 3328310769, 703678363},
				PC:  6567740,
				SR:  8979,
				USP: 12566382,
				SSP: 12587668,
				RAM: [][2]uint32{{6567734, 83}, {6567735, 218}, {6567736, 47}, {6567737, 103}, {9717762, 48}, {9717763, 255}, {6567738, 238}, {6567739, 106}},
				Cycles: 12,
			},
		},
		{
			name: "1000 Scc D6 56c6",
			init: cpuState{
				D:   [8]uint32{859578878, 2609283649, 4109253489, 60381320, 1176919218, 3321657270, 1824658855, 736797058},
				A:   [7]uint32{3312185744, 1332514506, 495929451, 2890869657, 3527724635, 4257440176, 4143243589},
				PC:  7494810,
				SR:  526,
				USP: 6119358,
				SSP: 3665150,
				RAM: [][2]uint32{{7494806, 86}, {7494807, 198}, {7494808, 62}, {7494809, 218}, {7494810, 29}, {7494811, 191}},
			},
			want: cpuState{
				D:   [8]uint32{859578878, 2609283649, 4109253489, 60381320, 1176919218, 3321657270, 1824658688, 736797058},
				A:   [7]uint32{3312185744, 1332514506, 495929451, 2890869657, 3527724635, 4257440176, 4143243589},
				PC:  7494812,
				SR:  526,
				USP: 6119358,
				SSP: 3665150,
				RAM: [][2]uint32{{7494806, 86}, {7494807, 198}, {7494808, 62}, {7494809, 218}, {7494810, 29}, {7494811, 191}},
				Cycles: 4,
			},
		},
		{
			name: "1500 Scc (d8, A2, Xn) 57f2",
			init: cpuState{
				D:   [8]uint32{2695333102, 1039551154, 4149839335, 90698407, 606538325, 2073707135, 3769311755, 1101127661},
				A:   [7]uint32{3671173924, 105719026, 3654381435, 161518047, 1700732425, 2781694436, 3858224045},
				PC:  12312746,
				SR:  42773,
				USP: 13817546,
				SSP: 11774450,
				RAM: [][2]uint32{{12312742, 87}, {12312743, 242}, {12312744, 50}, {12312745, 15}, {12312746, 74}, {12312747, 0}, {13722160, 143}, {13722161, 75}, {12312748, 11}, {12312749, 239}},
			},
			want: cpuState{
				D:   [8]uint32{2695333102, 1039551154, 4149839335, 90698407, 606538325, 2073707135, 3769311755, 1101127661},
				A:   [7]uint32{3671173924, 105719026, 3654381435, 161518047, 1700732425, 2781694436, 3858224045},
				PC:  12312750,
				SR:  42773,
				USP: 13817546,
				SSP: 11774450,
				RAM: [][2]uint32{{12312742, 87}, {12312743, 242}, {12312744, 50}, {12312745, 15}, {12312746, 74}, {12312747, 0}, {13722160, 143}, {13722161, 255}, {12312748, 11}, {12312749, 239}},
				Cycles: 18,
			},
		},
		{
			name: "2000 Scc (A4)+ 58dc",
			init: cpuState{
				D:   [8]uint32{607168389, 2311596014, 1791809683, 669057654, 3333444563, 3654210747, 1344819866, 4190951188},
				A:   [7]uint32{3563534161, 3449412941, 2708121637, 442514785, 4042190009, 2190154832, 2334373654},
				PC:  11523162,
				SR:  8206,
				USP: 9113786,
				SSP: 6850744,
				RAM: [][2]uint32{{11523158, 88}, {11523159, 220}, {11523160, 106}, {11523161, 213}, {15658168, 166}, {15658169, 168}, {11523162, 229}, {11523163, 78}},
			},
			want: cpuState{
				D:   [8]uint32{607168389, 2311596014, 1791809683, 669057654, 3333444563, 3654210747, 1344819866, 4190951188},
				A:   [7]uint32{3563534161, 3449412941, 2708121637, 442514785, 4042190010, 2190154832, 2334373654},
				PC:  11523164,
				SR:  8206,
				USP: 9113786,
				SSP: 6850744,
				RAM: [][2]uint32{{11523158, 88}, {11523159, 220}, {11523160, 106}, {11523161, 213}, {15658168, 166}, {15658169, 0}, {11523162, 229}, {11523163, 78}},
				Cycles: 12,
			},
		},
		{
			name: "001 Scc (d8, A3, Xn) 57f3",
			init: 			cpuState{
				D:   [8]uint32{2117415206, 139468385, 1523350770, 1057806482, 3009751746, 2393962322, 2244415526, 2341074254},
				A:   [7]uint32{4005626288, 1712760140, 1675010676, 1654718100, 1400368828, 815315467, 4212492155},
				PC:  15452052,
				SR:  797,
				USP: 13323496,
				SSP: 5122030,
				RAM: [][2]uint32{{15452048, 87}, {15452049, 243}, {15452050, 8}, {15452051, 16}, {15452052, 241}, {15452053, 8}, {14036938, 33}, {14036939, 180}, {15452054, 30}, {15452055, 1}},
			},
			want: 			cpuState{
				D:   [8]uint32{2117415206, 139468385, 1523350770, 1057806482, 3009751746, 2393962322, 2244415526, 2341074254},
				A:   [7]uint32{4005626288, 1712760140, 1675010676, 1654718100, 1400368828, 815315467, 4212492155},
				PC:  15452056,
				SR:  797,
				USP: 13323496,
				SSP: 5122030,
				RAM: [][2]uint32{{15452048, 87}, {15452049, 243}, {15452050, 8}, {15452051, 16}, {15452052, 241}, {15452053, 8}, {14036938, 255}, {14036939, 180}, {15452054, 30}, {15452055, 1}},
				Cycles: 18,
			},
		},
		{
			name: "281 Scc (d16, A0) 52e8",
			init: 			cpuState{
				D:   [8]uint32{3051451042, 2796474908, 3810804460, 769084831, 2121843226, 1540657305, 1190815922, 419941993},
				A:   [7]uint32{2636039479, 2080606646, 2888978265, 3796046261, 2226585021, 4090299646, 2347156406},
				PC:  9632450,
				SR:  9737,
				USP: 14449494,
				SSP: 967562,
				RAM: [][2]uint32{{9632446, 82}, {9632447, 232}, {9632448, 5}, {9632449, 87}, {9632450, 22}, {9632451, 253}, {2017934, 248}, {2017935, 187}, {9632452, 170}, {9632453, 211}},
			},
			want: 			cpuState{
				D:   [8]uint32{3051451042, 2796474908, 3810804460, 769084831, 2121843226, 1540657305, 1190815922, 419941993},
				A:   [7]uint32{2636039479, 2080606646, 2888978265, 3796046261, 2226585021, 4090299646, 2347156406},
				PC:  9632454,
				SR:  9737,
				USP: 14449494,
				SSP: 967562,
				RAM: [][2]uint32{{9632446, 82}, {9632447, 232}, {9632448, 5}, {9632449, 87}, {9632450, 22}, {9632451, 253}, {2017934, 0}, {2017935, 187}, {9632452, 170}, {9632453, 211}},
				Cycles: 16,
			},
		},
		{
			name: "554 Scc (d8, A3, Xn) 5bf3",
			init: 			cpuState{
				D:   [8]uint32{2218771522, 1493626186, 2003611559, 3677843488, 3184814992, 1723471267, 1082191970, 3589379624},
				A:   [7]uint32{2100133491, 1645734283, 1925176484, 2539059993, 2405409339, 2434795185, 3870739789},
				PC:  12170924,
				SR:  779,
				USP: 15065268,
				SSP: 2177862,
				RAM: [][2]uint32{{12170920, 91}, {12170921, 243}, {12170922, 26}, {12170923, 188}, {12170924, 4}, {12170925, 11}, {6154270, 94}, {6154271, 165}, {12170926, 108}, {12170927, 159}},
			},
			want: 			cpuState{
				D:   [8]uint32{2218771522, 1493626186, 2003611559, 3677843488, 3184814992, 1723471267, 1082191970, 3589379624},
				A:   [7]uint32{2100133491, 1645734283, 1925176484, 2539059993, 2405409339, 2434795185, 3870739789},
				PC:  12170928,
				SR:  779,
				USP: 15065268,
				SSP: 2177862,
				RAM: [][2]uint32{{12170920, 91}, {12170921, 243}, {12170922, 26}, {12170923, 188}, {12170924, 4}, {12170925, 11}, {6154270, 94}, {6154271, 255}, {12170926, 108}, {12170927, 159}},
				Cycles: 18,
			},
		},
		{
			name: "831 Scc -(A5) 58e5",
			init: 			cpuState{
				D:   [8]uint32{451228837, 828640218, 3011641914, 905589412, 2135265735, 1206619140, 2834834403, 4288005847},
				A:   [7]uint32{1971530157, 483107815, 3759071453, 3802339506, 1755854229, 3153420072, 3300278545},
				PC:  2253704,
				SR:  1553,
				USP: 14052988,
				SSP: 4094254,
				RAM: [][2]uint32{{2253700, 88}, {2253701, 229}, {2253702, 219}, {2253703, 104}, {16080678, 140}, {16080679, 129}, {2253704, 90}, {2253705, 45}},
			},
			want: 			cpuState{
				D:   [8]uint32{451228837, 828640218, 3011641914, 905589412, 2135265735, 1206619140, 2834834403, 4288005847},
				A:   [7]uint32{1971530157, 483107815, 3759071453, 3802339506, 1755854229, 3153420071, 3300278545},
				PC:  2253706,
				SR:  1553,
				USP: 14052988,
				SSP: 4094254,
				RAM: [][2]uint32{{2253700, 88}, {2253701, 229}, {2253702, 219}, {2253703, 104}, {16080678, 140}, {16080679, 255}, {2253704, 90}, {2253705, 45}},
				Cycles: 14,
			},
		},
		{
			name: "1111 Scc (d16, A3) 57eb",
			init: 			cpuState{
				D:   [8]uint32{29929218, 1946583303, 3533808562, 3171559833, 1142764150, 114851589, 1338944858, 620331633},
				A:   [7]uint32{621817732, 1666887315, 2227584114, 3877118700, 560820016, 4274807129, 320869653},
				PC:  6180536,
				SR:  1294,
				USP: 127302,
				SSP: 9315048,
				RAM: [][2]uint32{{6180532, 87}, {6180533, 235}, {6180534, 199}, {6180535, 61}, {6180536, 235}, {6180537, 97}, {1567272, 215}, {1567273, 69}, {6180538, 245}, {6180539, 150}},
			},
			want: 			cpuState{
				D:   [8]uint32{29929218, 1946583303, 3533808562, 3171559833, 1142764150, 114851589, 1338944858, 620331633},
				A:   [7]uint32{621817732, 1666887315, 2227584114, 3877118700, 560820016, 4274807129, 320869653},
				PC:  6180540,
				SR:  1294,
				USP: 127302,
				SSP: 9315048,
				RAM: [][2]uint32{{6180532, 87}, {6180533, 235}, {6180534, 199}, {6180535, 61}, {6180536, 235}, {6180537, 97}, {1567272, 215}, {1567273, 255}, {6180538, 245}, {6180539, 150}},
				Cycles: 16,
			},
		},
		{
			name: "1372 Scc (A0) 5dd0",
			init: 			cpuState{
				D:   [8]uint32{1445305754, 1283426959, 2047185810, 2427179259, 1865722709, 459371631, 1442516881, 2232989628},
				A:   [7]uint32{3296188936, 1823420003, 3881969760, 164731165, 2012630699, 3719240023, 4028369961},
				PC:  8012336,
				SR:  772,
				USP: 16399472,
				SSP: 16367426,
				RAM: [][2]uint32{{8012332, 93}, {8012333, 208}, {8012334, 74}, {8012335, 79}, {7854600, 93}, {7854601, 25}, {8012336, 123}, {8012337, 121}},
			},
			want: 			cpuState{
				D:   [8]uint32{1445305754, 1283426959, 2047185810, 2427179259, 1865722709, 459371631, 1442516881, 2232989628},
				A:   [7]uint32{3296188936, 1823420003, 3881969760, 164731165, 2012630699, 3719240023, 4028369961},
				PC:  8012338,
				SR:  772,
				USP: 16399472,
				SSP: 16367426,
				RAM: [][2]uint32{{8012332, 93}, {8012333, 208}, {8012334, 74}, {8012335, 79}, {7854600, 0}, {7854601, 25}, {8012336, 123}, {8012337, 121}},
				Cycles: 12,
			},
		},
		{
			name: "1633 Scc D4 57c4",
			init: 			cpuState{
				D:   [8]uint32{2994195535, 3877061700, 2508494933, 2350724127, 2717959836, 794511931, 4156428602, 1820024967},
				A:   [7]uint32{3602465606, 412785144, 314711015, 1574498325, 3086639778, 1908864064, 853470252},
				PC:  9152886,
				SR:  263,
				USP: 13413452,
				SSP: 16231582,
				RAM: [][2]uint32{{9152882, 87}, {9152883, 196}, {9152884, 23}, {9152885, 3}, {9152886, 39}, {9152887, 165}},
			},
			want: 			cpuState{
				D:   [8]uint32{2994195535, 3877061700, 2508494933, 2350724127, 2717959935, 794511931, 4156428602, 1820024967},
				A:   [7]uint32{3602465606, 412785144, 314711015, 1574498325, 3086639778, 1908864064, 853470252},
				PC:  9152888,
				SR:  263,
				USP: 13413452,
				SSP: 16231582,
				RAM: [][2]uint32{{9152882, 87}, {9152883, 196}, {9152884, 23}, {9152885, 3}, {9152886, 39}, {9152887, 165}},
				Cycles: 6,
			},
		},
		{
			name: "1948 Scc (d8, A0, Xn) 54f0",
			init: 			cpuState{
				D:   [8]uint32{2629646605, 3165767992, 3683329472, 2873349299, 236778169, 761148617, 1160056646, 3053781250},
				A:   [7]uint32{1452679688, 1881089054, 3637197713, 845314402, 843486165, 3863670740, 3254439363},
				PC:  13765306,
				SR:  769,
				USP: 4748852,
				SSP: 5347680,
				RAM: [][2]uint32{{13765302, 84}, {13765303, 240}, {13765304, 127}, {13765305, 48}, {13765306, 111}, {13765307, 196}, {10167098, 39}, {10167099, 160}, {13765308, 16}, {13765309, 239}},
			},
			want: 			cpuState{
				D:   [8]uint32{2629646605, 3165767992, 3683329472, 2873349299, 236778169, 761148617, 1160056646, 3053781250},
				A:   [7]uint32{1452679688, 1881089054, 3637197713, 845314402, 843486165, 3863670740, 3254439363},
				PC:  13765310,
				SR:  769,
				USP: 4748852,
				SSP: 5347680,
				RAM: [][2]uint32{{13765302, 84}, {13765303, 240}, {13765304, 127}, {13765305, 48}, {13765306, 111}, {13765307, 196}, {10167098, 0}, {10167099, 160}, {13765308, 16}, {13765309, 239}},
				Cycles: 18,
			},
		},
		{
			name: "2227 Scc (A6)+ 55de",
			init: 			cpuState{
				D:   [8]uint32{3807439643, 2656921106, 2633743170, 1263939664, 1751905052, 1871334285, 1537548987, 2389128285},
				A:   [7]uint32{3241981313, 2835199495, 861100482, 1397954115, 3411207647, 2612158683, 426975479},
				PC:  12838110,
				SR:  8733,
				USP: 4664656,
				SSP: 1784412,
				RAM: [][2]uint32{{12838106, 85}, {12838107, 222}, {12838108, 72}, {12838109, 171}, {7545078, 182}, {7545079, 51}, {12838110, 169}, {12838111, 48}},
			},
			want: 			cpuState{
				D:   [8]uint32{3807439643, 2656921106, 2633743170, 1263939664, 1751905052, 1871334285, 1537548987, 2389128285},
				A:   [7]uint32{3241981313, 2835199495, 861100482, 1397954115, 3411207647, 2612158683, 426975480},
				PC:  12838112,
				SR:  8733,
				USP: 4664656,
				SSP: 1784412,
				RAM: [][2]uint32{{12838106, 85}, {12838107, 222}, {12838108, 72}, {12838109, 171}, {7545078, 182}, {7545079, 255}, {12838110, 169}, {12838111, 48}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}
