package m68k

import "testing"

func TestMOVE_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVE.b (d8, A7, Xn), (A5)+ 1af7",
			init: cpuState{
				D:   [8]uint32{2070124316, 234003073, 1521695988, 3135339855, 578666471, 3465828453, 2145999343, 2461079043},
				A:   [7]uint32{2211998792, 3183097597, 2638671310, 247559878, 3934967095, 4190314979, 2197685891},
				PC:  10201890,
				SR:  34305,
				USP: 4298878,
				SSP: 13553080,
				RAM: [][2]uint32{{10201886, 26}, {10201887, 247}, {10201888, 244}, {10201889, 108}, {10201890, 36}, {10201891, 185}, {4272488, 179}, {4272489, 28}, {10201892, 151}, {10201893, 129}},
			},
			want: cpuState{
				D:   [8]uint32{2070124316, 234003073, 1521695988, 3135339855, 578666471, 3465828453, 2145999343, 2461079043},
				A:   [7]uint32{2211998792, 3183097597, 2638671310, 247559878, 3934967095, 4190314980, 2197685891},
				PC:  10201894,
				SR:  34312,
				USP: 4298878,
				SSP: 13553080,
				RAM: [][2]uint32{{10201886, 26}, {10201887, 247}, {10201888, 244}, {10201889, 108}, {10201890, 36}, {10201891, 185}, {4272488, 179}, {4272489, 28}, {12788194, 0}, {12788195, 179}, {10201892, 151}, {10201893, 129}},
				Cycles: 18,
			},
		},
		{
			name: "500 MOVE.b -(A7), (A7)+ 1ee7",
			init: cpuState{
				D:   [8]uint32{79605547, 1732324779, 160891053, 3585794686, 3659053941, 1081974772, 499563445, 269157102},
				A:   [7]uint32{474390832, 3667974165, 1496134184, 2293736989, 966256255, 1224196697, 4202128802},
				PC:  13422958,
				SR:  8719,
				USP: 7939604,
				SSP: 455146,
				RAM: [][2]uint32{{13422954, 30}, {13422955, 231}, {13422956, 68}, {13422957, 121}, {455144, 123}, {455145, 20}, {13422958, 88}, {13422959, 50}},
			},
			want: cpuState{
				D:   [8]uint32{79605547, 1732324779, 160891053, 3585794686, 3659053941, 1081974772, 499563445, 269157102},
				A:   [7]uint32{474390832, 3667974165, 1496134184, 2293736989, 966256255, 1224196697, 4202128802},
				PC:  13422960,
				SR:  8704,
				USP: 7939604,
				SSP: 455146,
				RAM: [][2]uint32{{13422954, 30}, {13422955, 231}, {13422956, 68}, {13422957, 121}, {455144, 123}, {455145, 20}, {13422958, 88}, {13422959, 50}},
				Cycles: 14,
			},
		},
		{
			name: "1000 MOVE.b (xxx).l, (A2)+ 14f9",
			init: cpuState{
				D:   [8]uint32{2013684687, 1194193982, 1799070497, 811095408, 2341184346, 612250126, 3941604888, 1956162679},
				A:   [7]uint32{2102688, 3316745906, 1168877170, 1657469866, 2914970285, 2545639485, 2835124270},
				PC:  411518,
				SR:  40966,
				USP: 16684710,
				SSP: 16597514,
				RAM: [][2]uint32{{411514, 20}, {411515, 249}, {411516, 37}, {411517, 163}, {411518, 173}, {411519, 20}, {411520, 163}, {411521, 185}, {10726676, 183}, {10726677, 29}, {411522, 226}, {411523, 99}},
			},
			want: cpuState{
				D:   [8]uint32{2013684687, 1194193982, 1799070497, 811095408, 2341184346, 612250126, 3941604888, 1956162679},
				A:   [7]uint32{2102688, 3316745906, 1168877171, 1657469866, 2914970285, 2545639485, 2835124270},
				PC:  411524,
				SR:  40968,
				USP: 16684710,
				SSP: 16597514,
				RAM: [][2]uint32{{411514, 20}, {411515, 249}, {411516, 37}, {411517, 163}, {411518, 173}, {411519, 20}, {411520, 163}, {411521, 185}, {10726676, 183}, {10726677, 29}, {11249266, 183}, {11249267, 0}, {411522, 226}, {411523, 99}},
				Cycles: 20,
			},
		},
		{
			name: "1500 MOVE.b (A3)+, (A4)+ 18db",
			init: cpuState{
				D:   [8]uint32{4024585824, 3242946488, 13733619, 3307178649, 1413867839, 4186009755, 3198856664, 3635417336},
				A:   [7]uint32{744551197, 3580785785, 1065647876, 1991876151, 3346842381, 3240550237, 4199785351},
				PC:  14879242,
				SR:  9744,
				USP: 8159036,
				SSP: 12595764,
				RAM: [][2]uint32{{14879238, 24}, {14879239, 219}, {14879240, 63}, {14879241, 85}, {12164662, 244}, {12164663, 248}, {14879242, 70}, {14879243, 168}},
			},
			want: cpuState{
				D:   [8]uint32{4024585824, 3242946488, 13733619, 3307178649, 1413867839, 4186009755, 3198856664, 3635417336},
				A:   [7]uint32{744551197, 3580785785, 1065647876, 1991876152, 3346842382, 3240550237, 4199785351},
				PC:  14879244,
				SR:  9752,
				USP: 8159036,
				SSP: 12595764,
				RAM: [][2]uint32{{14879238, 24}, {14879239, 219}, {14879240, 63}, {14879241, 85}, {12164662, 244}, {12164663, 248}, {8176396, 0}, {8176397, 248}, {14879242, 70}, {14879243, 168}},
				Cycles: 12,
			},
		},
		{
			name: "2000 MOVE.b (d16, A4), (A5) 1aac",
			init: cpuState{
				D:   [8]uint32{3635665856, 3437810394, 3268591727, 2662518563, 2578629456, 3177247432, 1434671464, 1190196822},
				A:   [7]uint32{1964622311, 2517750663, 3641275502, 3428346052, 4191152582, 1797169006, 3141544000},
				PC:  7242746,
				SR:  41485,
				USP: 3214510,
				SSP: 542030,
				RAM: [][2]uint32{{7242742, 26}, {7242743, 172}, {7242744, 98}, {7242745, 50}, {7242746, 46}, {7242747, 192}, {13650936, 1}, {13650937, 51}, {7242748, 73}, {7242749, 79}},
			},
			want: cpuState{
				D:   [8]uint32{3635665856, 3437810394, 3268591727, 2662518563, 2578629456, 3177247432, 1434671464, 1190196822},
				A:   [7]uint32{1964622311, 2517750663, 3641275502, 3428346052, 4191152582, 1797169006, 3141544000},
				PC:  7242750,
				SR:  41472,
				USP: 3214510,
				SSP: 542030,
				RAM: [][2]uint32{{7242742, 26}, {7242743, 172}, {7242744, 98}, {7242745, 50}, {7242746, 46}, {7242747, 192}, {13650936, 1}, {13650937, 51}, {2006894, 1}, {2006895, 0}, {7242748, 73}, {7242749, 79}},
				Cycles: 16,
			},
		},
		{
			name: "002 MOVE.b (A1)+, (d8, A4, Xn) 1999",
			init: 			cpuState{
				D:   [8]uint32{860177062, 2256315216, 3551211388, 2046776821, 425230752, 2766901683, 4283774151, 4177950114},
				A:   [7]uint32{3749202064, 2122145104, 1068141869, 3488056930, 1967284240, 990178717, 433503906},
				PC:  11651422,
				SR:  8722,
				USP: 14792526,
				SSP: 3703302,
				RAM: [][2]uint32{{11651418, 25}, {11651419, 153}, {11651420, 172}, {11651421, 96}, {8215888, 188}, {8215889, 57}, {11651422, 82}, {11651423, 100}, {11651424, 106}, {11651425, 209}},
			},
			want: 			cpuState{
				D:   [8]uint32{860177062, 2256315216, 3551211388, 2046776821, 425230752, 2766901683, 4283774151, 4177950114},
				A:   [7]uint32{3749202064, 2122145105, 1068141869, 3488056930, 1967284240, 990178717, 433503906},
				PC:  11651426,
				SR:  8728,
				USP: 14792526,
				SSP: 3703302,
				RAM: [][2]uint32{{11651418, 25}, {11651419, 153}, {11651420, 172}, {11651421, 96}, {8215888, 188}, {8215889, 57}, {11651422, 82}, {11651423, 100}, {15527324, 0}, {15527325, 188}, {11651424, 106}, {11651425, 209}},
				Cycles: 18,
			},
		},
		{
			name: "263 MOVE.b (d8, A3, Xn), D3 1633",
			init: 			cpuState{
				D:   [8]uint32{2707921923, 372104138, 2937821118, 1551997135, 1136570757, 3249745401, 499144581, 374606066},
				A:   [7]uint32{2625183733, 317776938, 3034157671, 2212161399, 1436449348, 1927203427, 2796708727},
				PC:  15586228,
				SR:  1053,
				USP: 2251816,
				SSP: 2453690,
				RAM: [][2]uint32{{15586224, 22}, {15586225, 51}, {15586226, 214}, {15586227, 59}, {15586228, 188}, {15586229, 23}, {14332436, 170}, {14332437, 70}, {15586230, 106}, {15586231, 72}},
			},
			want: 			cpuState{
				D:   [8]uint32{2707921923, 372104138, 2937821118, 1551996998, 1136570757, 3249745401, 499144581, 374606066},
				A:   [7]uint32{2625183733, 317776938, 3034157671, 2212161399, 1436449348, 1927203427, 2796708727},
				PC:  15586232,
				SR:  1040,
				USP: 2251816,
				SSP: 2453690,
				RAM: [][2]uint32{{15586224, 22}, {15586225, 51}, {15586226, 214}, {15586227, 59}, {15586228, 188}, {15586229, 23}, {14332436, 170}, {14332437, 70}, {15586230, 106}, {15586231, 72}},
				Cycles: 14,
			},
		},
		{
			name: "549 MOVE.b (A2), (d16, A6) 1d52",
			init: 			cpuState{
				D:   [8]uint32{2340742918, 3857292279, 431884700, 677336637, 2411882625, 3566246461, 1055605968, 2936457952},
				A:   [7]uint32{2922495630, 525911580, 1543041098, 1952768313, 2376101170, 3066438156, 2337932935},
				PC:  4721592,
				SR:  3,
				USP: 4345386,
				SSP: 12621280,
				RAM: [][2]uint32{{4721588, 29}, {4721589, 82}, {4721590, 109}, {4721591, 222}, {16314442, 62}, {16314443, 31}, {4721592, 108}, {4721593, 229}, {4721594, 230}, {4721595, 232}},
			},
			want: 			cpuState{
				D:   [8]uint32{2340742918, 3857292279, 431884700, 677336637, 2411882625, 3566246461, 1055605968, 2936457952},
				A:   [7]uint32{2922495630, 525911580, 1543041098, 1952768313, 2376101170, 3066438156, 2337932935},
				PC:  4721596,
				SR:  0,
				USP: 4345386,
				SSP: 12621280,
				RAM: [][2]uint32{{4721588, 29}, {4721589, 82}, {4721590, 109}, {4721591, 222}, {16314442, 62}, {16314443, 31}, {4721592, 108}, {4721593, 229}, {5928036, 0}, {5928037, 62}, {4721594, 230}, {4721595, 232}},
				Cycles: 16,
			},
		},
		{
			name: "827 MOVE.b (A6), (d8, A1, Xn) 1396",
			init: 			cpuState{
				D:   [8]uint32{4241285044, 528903162, 4074854162, 1097218854, 833889052, 3454287442, 1120155176, 1699360861},
				A:   [7]uint32{980131408, 1432722217, 1819569937, 3953813319, 1456424299, 1816749414, 255601210},
				PC:  11930,
				SR:  528,
				USP: 13119386,
				SSP: 4296774,
				RAM: [][2]uint32{{11926, 19}, {11927, 150}, {11928, 41}, {11929, 21}, {3942970, 211}, {3942971, 162}, {11930, 136}, {11931, 75}, {11932, 74}, {11933, 94}},
			},
			want: 			cpuState{
				D:   [8]uint32{4241285044, 528903162, 4074854162, 1097218854, 833889052, 3454287442, 1120155176, 1699360861},
				A:   [7]uint32{980131408, 1432722217, 1819569937, 3953813319, 1456424299, 1816749414, 255601210},
				PC:  11934,
				SR:  536,
				USP: 13119386,
				SSP: 4296774,
				RAM: [][2]uint32{{11926, 19}, {11927, 150}, {11928, 41}, {11929, 21}, {3942970, 211}, {3942971, 162}, {11930, 136}, {11931, 75}, {4649552, 211}, {4649553, 0}, {11932, 74}, {11933, 94}},
				Cycles: 18,
			},
		},
		{
			name: "1102 MOVE.b (A7), (d16, A6) 1d57",
			init: 			cpuState{
				D:   [8]uint32{4165231874, 2256162740, 2250692089, 2201296736, 2133316477, 3146665178, 2705897654, 2493917395},
				A:   [7]uint32{3414062809, 1320838633, 125623129, 2120115483, 3325061990, 1220915688, 3388857372},
				PC:  9917640,
				SR:  4,
				USP: 3028556,
				SSP: 1399534,
				RAM: [][2]uint32{{9917636, 29}, {9917637, 87}, {9917638, 143}, {9917639, 235}, {3028556, 208}, {3028557, 139}, {9917640, 227}, {9917641, 143}, {9917642, 145}, {9917643, 217}},
			},
			want: 			cpuState{
				D:   [8]uint32{4165231874, 2256162740, 2250692089, 2201296736, 2133316477, 3146665178, 2705897654, 2493917395},
				A:   [7]uint32{3414062809, 1320838633, 125623129, 2120115483, 3325061990, 1220915688, 3388857372},
				PC:  9917644,
				SR:  8,
				USP: 3028556,
				SSP: 1399534,
				RAM: [][2]uint32{{9917636, 29}, {9917637, 87}, {9917638, 143}, {9917639, 235}, {3028556, 208}, {3028557, 139}, {9917640, 227}, {9917641, 143}, {16608262, 0}, {16608263, 208}, {9917642, 145}, {9917643, 217}},
				Cycles: 16,
			},
		},
		{
			name: "1375 MOVE.b (d16, PC), (d8, A4, Xn) 19ba",
			init: 			cpuState{
				D:   [8]uint32{3306782142, 166054049, 1076555769, 1401757531, 4096967247, 1618259718, 2247615609, 3593727500},
				A:   [7]uint32{3221808061, 4242306755, 1251422776, 845826172, 2400233206, 3765375947, 2284939419},
				PC:  14858168,
				SR:  1794,
				USP: 4368234,
				SSP: 385880,
				RAM: [][2]uint32{{14858164, 25}, {14858165, 186}, {14858166, 181}, {14858167, 70}, {14858168, 32}, {14858169, 109}, {14839036, 229}, {14839037, 11}, {14858170, 148}, {14858171, 241}, {14858172, 32}, {14858173, 20}},
			},
			want: 			cpuState{
				D:   [8]uint32{3306782142, 166054049, 1076555769, 1401757531, 4096967247, 1618259718, 2247615609, 3593727500},
				A:   [7]uint32{3221808061, 4242306755, 1251422776, 845826172, 2400233206, 3765375947, 2284939419},
				PC:  14858174,
				SR:  1800,
				USP: 4368234,
				SSP: 385880,
				RAM: [][2]uint32{{14858164, 25}, {14858165, 186}, {14858166, 181}, {14858167, 70}, {14858168, 32}, {14858169, 109}, {14839036, 229}, {14839037, 11}, {14858170, 148}, {14858171, 241}, {1087324, 229}, {1087325, 0}, {14858172, 32}, {14858173, 20}},
				Cycles: 22,
			},
		},
		{
			name: "1648 MOVE.b (xxx).l, (A5) 1ab9",
			init: 			cpuState{
				D:   [8]uint32{3402354741, 2743451588, 1197858853, 1515296660, 548493137, 3434361513, 1977071711, 736783216},
				A:   [7]uint32{293789130, 3615118773, 1530853662, 3151086602, 4223250246, 2091825580, 2173363352},
				PC:  7939972,
				SR:  1539,
				USP: 13940990,
				SSP: 4301744,
				RAM: [][2]uint32{{7939968, 26}, {7939969, 185}, {7939970, 89}, {7939971, 138}, {7939972, 171}, {7939973, 140}, {7939974, 51}, {7939975, 152}, {9087884, 220}, {9087885, 78}, {7939976, 192}, {7939977, 185}},
			},
			want: 			cpuState{
				D:   [8]uint32{3402354741, 2743451588, 1197858853, 1515296660, 548493137, 3434361513, 1977071711, 736783216},
				A:   [7]uint32{293789130, 3615118773, 1530853662, 3151086602, 4223250246, 2091825580, 2173363352},
				PC:  7939978,
				SR:  1544,
				USP: 13940990,
				SSP: 4301744,
				RAM: [][2]uint32{{7939968, 26}, {7939969, 185}, {7939970, 89}, {7939971, 138}, {7939972, 171}, {7939973, 140}, {7939974, 51}, {7939975, 152}, {9087884, 220}, {9087885, 78}, {11450796, 220}, {11450797, 0}, {7939976, 192}, {7939977, 185}},
				Cycles: 20,
			},
		},
		{
			name: "1918 MOVE.b (A6), D4 1816",
			init: 			cpuState{
				D:   [8]uint32{1937880201, 3984856267, 131746311, 3210968850, 1411346148, 1709892373, 3345878903, 375610900},
				A:   [7]uint32{772511390, 2581889314, 1147570759, 1365964933, 2489700592, 1898250497, 3699049623},
				PC:  12545642,
				SR:  8448,
				USP: 14058242,
				SSP: 7322560,
				RAM: [][2]uint32{{12545638, 24}, {12545639, 22}, {12545640, 42}, {12545641, 133}, {8062102, 216}, {8062103, 8}, {12545642, 57}, {12545643, 167}},
			},
			want: 			cpuState{
				D:   [8]uint32{1937880201, 3984856267, 131746311, 3210968850, 1411345928, 1709892373, 3345878903, 375610900},
				A:   [7]uint32{772511390, 2581889314, 1147570759, 1365964933, 2489700592, 1898250497, 3699049623},
				PC:  12545644,
				SR:  8448,
				USP: 14058242,
				SSP: 7322560,
				RAM: [][2]uint32{{12545638, 24}, {12545639, 22}, {12545640, 42}, {12545641, 133}, {8062102, 216}, {8062103, 8}, {12545642, 57}, {12545643, 167}},
				Cycles: 8,
			},
		},
		{
			name: "2200 MOVE.b (d16, A7), (A6) 1caf",
			init: 			cpuState{
				D:   [8]uint32{4211928899, 10804403, 3456093353, 321229661, 2958056423, 803637767, 787692231, 2121523063},
				A:   [7]uint32{2760246927, 30702365, 2766895637, 3097586855, 924525394, 3211679172, 3598792783},
				PC:  16451286,
				SR:  8455,
				USP: 169498,
				SSP: 3181926,
				RAM: [][2]uint32{{16451282, 28}, {16451283, 175}, {16451284, 215}, {16451285, 172}, {16451286, 136}, {16451287, 107}, {3171602, 254}, {3171603, 193}, {16451288, 210}, {16451289, 146}},
			},
			want: 			cpuState{
				D:   [8]uint32{4211928899, 10804403, 3456093353, 321229661, 2958056423, 803637767, 787692231, 2121523063},
				A:   [7]uint32{2760246927, 30702365, 2766895637, 3097586855, 924525394, 3211679172, 3598792783},
				PC:  16451290,
				SR:  8456,
				USP: 169498,
				SSP: 3181926,
				RAM: [][2]uint32{{16451282, 28}, {16451283, 175}, {16451284, 215}, {16451285, 172}, {16451286, 136}, {16451287, 107}, {3171602, 254}, {3171603, 193}, {8468558, 0}, {8468559, 254}, {16451288, 210}, {16451289, 146}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVE_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVE.w A1, (A2)+ 34c9",
			init: cpuState{
				D:   [8]uint32{2530484584, 1196838788, 1081950822, 3801932641, 2878138451, 3686490039, 1277231700, 2281846656},
				A:   [7]uint32{4128152544, 1087582781, 35290954, 3940833032, 2199530306, 2003700646, 70651068},
				PC:  2587182,
				SR:  775,
				USP: 2822166,
				SSP: 11411026,
				RAM: [][2]uint32{{2587178, 52}, {2587179, 201}, {2587180, 37}, {2587181, 1}, {2587182, 249}, {2587183, 15}},
			},
			want: cpuState{
				D:   [8]uint32{2530484584, 1196838788, 1081950822, 3801932641, 2878138451, 3686490039, 1277231700, 2281846656},
				A:   [7]uint32{4128152544, 1087582781, 35290956, 3940833032, 2199530306, 2003700646, 70651068},
				PC:  2587184,
				SR:  768,
				USP: 2822166,
				SSP: 11411026,
				RAM: [][2]uint32{{2587178, 52}, {2587179, 201}, {2587180, 37}, {2587181, 1}, {1736522, 50}, {1736523, 61}, {2587182, 249}, {2587183, 15}},
				Cycles: 8,
			},
		},
		{
			name: "500 MOVE.w (A7)+, (d8, A0, Xn) 319f",
			init: cpuState{
				D:   [8]uint32{856399019, 1569404969, 1773670123, 2018965409, 129972502, 2064310731, 3749490678, 2023162347},
				A:   [7]uint32{1314148112, 2017600262, 3013841239, 173807186, 4253967818, 902877358, 3739492209},
				PC:  8285322,
				SR:  42264,
				USP: 11438124,
				SSP: 7341152,
				RAM: [][2]uint32{{8285318, 49}, {8285319, 159}, {8285320, 182}, {8285321, 14}, {7341152, 55}, {7341153, 119}, {8285322, 150}, {8285323, 5}, {8285324, 56}, {8285325, 171}},
			},
			want: cpuState{
				D:   [8]uint32{856399019, 1569404969, 1773670123, 2018965409, 129972502, 2064310731, 3749490678, 2023162347},
				A:   [7]uint32{1314148112, 2017600262, 3013841239, 173807186, 4253967818, 902877358, 3739492209},
				PC:  8285326,
				SR:  42256,
				USP: 11438124,
				SSP: 7341154,
				RAM: [][2]uint32{{8285318, 49}, {8285319, 159}, {8285320, 182}, {8285321, 14}, {7341152, 55}, {7341153, 119}, {8285322, 150}, {8285323, 5}, {5530992, 55}, {5530993, 119}, {8285324, 56}, {8285325, 171}},
				Cycles: 18,
			},
		},
		{
			name: "1000 MOVE.w -(A3), D7 3e23",
			init: cpuState{
				D:   [8]uint32{696051969, 1854751692, 213349985, 1805050501, 4056672009, 1656096433, 2280222579, 561961943},
				A:   [7]uint32{3810802989, 663015860, 2830421226, 1854736187, 601145369, 703294689, 3541894700},
				PC:  4390836,
				SR:  1030,
				USP: 9082000,
				SSP: 2479692,
				RAM: [][2]uint32{{4390832, 62}, {4390833, 35}, {4390834, 182}, {4390835, 124}, {12, 36}, {13, 20}, {14, 89}, {15, 46}, {1333550, 31}, {1333551, 75}, {1333552, 148}, {1333553, 42}},
			},
			want: cpuState{
				D:      [8]uint32{696051969, 1854751692, 213349985, 1805050501, 4056672009, 1656096433, 2280222579, 561961943},
				A:      [7]uint32{3810802989, 663015860, 2830421226, 1854736185, 601145369, 703294689, 3541894700},
				PC:     605313330,
				SR:     9222,
				USP:    9082000,
				SSP:    2479678,
				RAM:    [][2]uint32{{4390832, 62}, {4390833, 35}, {4390834, 182}, {4390835, 124}, {2479690, 255}, {2479691, 180}, {2479686, 4}, {2479687, 6}, {2479688, 0}, {2479689, 66}, {2479684, 62}, {2479685, 35}, {2479682, 7}, {2479683, 57}, {2479678, 62}, {2479679, 49}, {2479680, 110}, {2479681, 141}, {12, 36}, {13, 20}, {14, 89}, {15, 46}, {1333550, 31}, {1333551, 75}, {1333552, 148}, {1333553, 42}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVE.w (d8, A6, Xn), (d8, A0, Xn) 31b6",
			init: cpuState{
				D:   [8]uint32{970642547, 42024927, 2408930079, 707397645, 3339450817, 2308389420, 1208726658, 3783339692},
				A:   [7]uint32{1641272459, 1356141785, 2036218255, 4276021322, 3576453530, 2163200603, 188834721},
				PC:  6937610,
				SR:  34317,
				USP: 3097706,
				SSP: 13071066,
				RAM: [][2]uint32{{6937606, 49}, {6937607, 182}, {6937608, 161}, {6937609, 193}, {6937610, 176}, {6937611, 145}, {12, 253}, {13, 164}, {14, 247}, {15, 228}, {10811364, 57}, {10811365, 62}, {10811366, 121}, {10811367, 39}},
			},
			want: cpuState{
				D:      [8]uint32{970642547, 42024927, 2408930079, 707397645, 3339450817, 2308389420, 1208726658, 3783339692},
				A:      [7]uint32{1641272459, 1356141785, 2036218255, 4276021322, 3576453530, 2163200603, 188834721},
				PC:     4255447016,
				SR:     9741,
				USP:    3097706,
				SSP:    13071052,
				RAM:    [][2]uint32{{6937606, 49}, {6937607, 182}, {6937608, 161}, {6937609, 193}, {6937610, 176}, {6937611, 145}, {13071064, 220}, {13071065, 8}, {13071060, 134}, {13071061, 13}, {13071062, 0}, {13071063, 105}, {13071058, 49}, {13071059, 182}, {13071056, 156}, {13071057, 241}, {13071052, 49}, {13071053, 177}, {13071054, 11}, {13071055, 65}, {12, 253}, {13, 164}, {14, 247}, {15, 228}, {10811364, 57}, {10811365, 62}, {10811366, 121}, {10811367, 39}},
				Halted: true,
			},
		},
		{
			name: "2000 MOVE.w (A6)+, (d8, A7, Xn) 3f9e",
			init: cpuState{
				D:   [8]uint32{3725713055, 3387138312, 89827935, 2663343400, 926777393, 1643429908, 2118670654, 2042655081},
				A:   [7]uint32{472803763, 3211475504, 397298379, 1699832085, 3550588545, 3202916405, 1982187347},
				PC:  9548406,
				SR:  266,
				USP: 11358164,
				SSP: 13181066,
				RAM: [][2]uint32{{9548402, 63}, {9548403, 158}, {9548404, 30}, {9548405, 143}, {12, 242}, {13, 242}, {14, 223}, {15, 154}, {15916954, 109}, {15916955, 50}, {15916956, 47}, {15916957, 107}},
			},
			want: cpuState{
				D:      [8]uint32{3725713055, 3387138312, 89827935, 2663343400, 926777393, 1643429908, 2118670654, 2042655081},
				A:      [7]uint32{472803763, 3211475504, 397298379, 1699832085, 3550588545, 3202916405, 1982187349},
				PC:     4076003230,
				SR:     8458,
				USP:    11358164,
				SSP:    13181052,
				RAM:    [][2]uint32{{9548402, 63}, {9548403, 158}, {9548404, 30}, {9548405, 143}, {13181064, 178}, {13181065, 116}, {13181060, 1}, {13181061, 10}, {13181062, 0}, {13181063, 145}, {13181058, 63}, {13181059, 158}, {13181056, 199}, {13181057, 83}, {13181052, 63}, {13181053, 145}, {13181054, 118}, {13181055, 37}, {12, 242}, {13, 242}, {14, 223}, {15, 154}, {15916954, 109}, {15916955, 50}, {15916956, 47}, {15916957, 107}},
				Halted: true,
			},
		},
		{
			name: "002 MOVE.w (A5)+, (A5) 3a9d",
			init: 			cpuState{
				D:   [8]uint32{460373915, 3858662613, 1676535225, 1584500603, 1006669584, 2398681836, 3831882683, 3835196215},
				A:   [7]uint32{3845371999, 2251110891, 399653394, 1576592065, 262703772, 1733225936, 1254528325},
				PC:  10913670,
				SR:  8732,
				USP: 7497948,
				SSP: 9390866,
				RAM: [][2]uint32{{10913666, 58}, {10913667, 157}, {10913668, 104}, {10913669, 144}, {5172688, 37}, {5172689, 152}, {10913670, 82}, {10913671, 253}},
			},
			want: 			cpuState{
				D:   [8]uint32{460373915, 3858662613, 1676535225, 1584500603, 1006669584, 2398681836, 3831882683, 3835196215},
				A:   [7]uint32{3845371999, 2251110891, 399653394, 1576592065, 262703772, 1733225938, 1254528325},
				PC:  10913672,
				SR:  8720,
				USP: 7497948,
				SSP: 9390866,
				RAM: [][2]uint32{{10913666, 58}, {10913667, 157}, {10913668, 104}, {10913669, 144}, {5172688, 37}, {5172689, 152}, {5172690, 37}, {5172691, 152}, {10913670, 82}, {10913671, 253}},
				Cycles: 12,
			},
		},
		{
			name: "284 MOVE.w (A3)+, (A3)+ 36db",
			init: 			cpuState{
				D:   [8]uint32{3882187502, 2611615153, 2428881343, 2354457486, 625580726, 2039077796, 529821655, 3414103293},
				A:   [7]uint32{4180024329, 3453085356, 1535012007, 1449616876, 3421816951, 3643077118, 2916865563},
				PC:  7303384,
				SR:  1555,
				USP: 6445360,
				SSP: 7232474,
				RAM: [][2]uint32{{7303380, 54}, {7303381, 219}, {7303382, 88}, {7303383, 226}, {6776300, 138}, {6776301, 243}, {7303384, 20}, {7303385, 237}},
			},
			want: 			cpuState{
				D:   [8]uint32{3882187502, 2611615153, 2428881343, 2354457486, 625580726, 2039077796, 529821655, 3414103293},
				A:   [7]uint32{4180024329, 3453085356, 1535012007, 1449616880, 3421816951, 3643077118, 2916865563},
				PC:  7303386,
				SR:  1560,
				USP: 6445360,
				SSP: 7232474,
				RAM: [][2]uint32{{7303380, 54}, {7303381, 219}, {7303382, 88}, {7303383, 226}, {6776300, 138}, {6776301, 243}, {6776302, 138}, {6776303, 243}, {7303384, 20}, {7303385, 237}},
				Cycles: 12,
			},
		},
		{
			name: "526 MOVE.w #, (A6) 3cbc",
			init: 			cpuState{
				D:   [8]uint32{923779541, 120840928, 2740571936, 1404815215, 219999104, 2091639971, 2871137725, 3002216541},
				A:   [7]uint32{1904929800, 2445867842, 2361323303, 956718378, 345888550, 3249184408, 3002362102},
				PC:  7079334,
				SR:  8709,
				USP: 8773232,
				SSP: 2308836,
				RAM: [][2]uint32{{7079330, 60}, {7079331, 188}, {7079332, 188}, {7079333, 178}, {7079334, 53}, {7079335, 138}, {7079336, 133}, {7079337, 114}},
			},
			want: 			cpuState{
				D:   [8]uint32{923779541, 120840928, 2740571936, 1404815215, 219999104, 2091639971, 2871137725, 3002216541},
				A:   [7]uint32{1904929800, 2445867842, 2361323303, 956718378, 345888550, 3249184408, 3002362102},
				PC:  7079338,
				SR:  8712,
				USP: 8773232,
				SSP: 2308836,
				RAM: [][2]uint32{{7079330, 60}, {7079331, 188}, {7079332, 188}, {7079333, 178}, {7079334, 53}, {7079335, 138}, {16017654, 188}, {16017655, 178}, {7079336, 133}, {7079337, 114}},
				Cycles: 12,
			},
		},
		{
			name: "813 MOVE.w A2, (A7)+ 3eca",
			init: 			cpuState{
				D:   [8]uint32{1517016535, 3728085616, 3199022104, 2813379812, 1431464405, 2266003844, 3726333071, 1690202916},
				A:   [7]uint32{3930446286, 1722247923, 2499243177, 1851470693, 37718575, 3533705606, 2210861640},
				PC:  14057744,
				SR:  9479,
				USP: 8694116,
				SSP: 7609536,
				RAM: [][2]uint32{{14057740, 62}, {14057741, 202}, {14057742, 24}, {14057743, 235}, {14057744, 214}, {14057745, 72}},
			},
			want: 			cpuState{
				D:   [8]uint32{1517016535, 3728085616, 3199022104, 2813379812, 1431464405, 2266003844, 3726333071, 1690202916},
				A:   [7]uint32{3930446286, 1722247923, 2499243177, 1851470693, 37718575, 3533705606, 2210861640},
				PC:  14057746,
				SR:  9472,
				USP: 8694116,
				SSP: 7609538,
				RAM: [][2]uint32{{14057740, 62}, {14057741, 202}, {14057742, 24}, {14057743, 235}, {7609536, 108}, {7609537, 169}, {14057744, 214}, {14057745, 72}},
				Cycles: 8,
			},
		},
		{
			name: "1043 MOVE.w (A7)+, (A3)+ 36df",
			init: 			cpuState{
				D:   [8]uint32{1948635233, 3041325944, 1287257376, 2637577031, 754274507, 4271444329, 3983984942, 1804321592},
				A:   [7]uint32{1574363015, 1188174823, 3547465579, 2479464542, 3027460318, 2008728379, 552186856},
				PC:  3468958,
				SR:  9733,
				USP: 3563478,
				SSP: 7336632,
				RAM: [][2]uint32{{3468954, 54}, {3468955, 223}, {3468956, 151}, {3468957, 16}, {7336632, 156}, {7336633, 201}, {3468958, 142}, {3468959, 34}},
			},
			want: 			cpuState{
				D:   [8]uint32{1948635233, 3041325944, 1287257376, 2637577031, 754274507, 4271444329, 3983984942, 1804321592},
				A:   [7]uint32{1574363015, 1188174823, 3547465579, 2479464544, 3027460318, 2008728379, 552186856},
				PC:  3468960,
				SR:  9736,
				USP: 3563478,
				SSP: 7336634,
				RAM: [][2]uint32{{3468954, 54}, {3468955, 223}, {3468956, 151}, {3468957, 16}, {7336632, 156}, {7336633, 201}, {13213790, 156}, {13213791, 201}, {3468958, 142}, {3468959, 34}},
				Cycles: 12,
			},
		},
		{
			name: "1367 MOVE.w D7, (d8, A1, Xn) 3387",
			init: 			cpuState{
				D:   [8]uint32{303444925, 2685930322, 2992213281, 4293248005, 774002774, 2692416627, 2438857806, 168848465},
				A:   [7]uint32{2703402803, 1066839645, 4038865381, 3652734740, 739271544, 3193714980, 3280473660},
				PC:  5438692,
				SR:  23,
				USP: 1264842,
				SSP: 8645972,
				RAM: [][2]uint32{{5438688, 51}, {5438689, 135}, {5438690, 0}, {5438691, 198}, {5438692, 88}, {5438693, 196}, {5438694, 16}, {5438695, 11}},
			},
			want: 			cpuState{
				D:   [8]uint32{303444925, 2685930322, 2992213281, 4293248005, 774002774, 2692416627, 2438857806, 168848465},
				A:   [7]uint32{2703402803, 1066839645, 4038865381, 3652734740, 739271544, 3193714980, 3280473660},
				PC:  5438696,
				SR:  16,
				USP: 1264842,
				SSP: 8645972,
				RAM: [][2]uint32{{5438688, 51}, {5438689, 135}, {5438690, 0}, {5438691, 198}, {5438692, 88}, {5438693, 196}, {9888224, 108}, {9888225, 81}, {5438694, 16}, {5438695, 11}},
				Cycles: 14,
			},
		},
		{
			name: "1685 MOVE.w (d16, A1), D3 3629",
			init: 			cpuState{
				D:   [8]uint32{3693223266, 1858350512, 1472313824, 2756564570, 1186536373, 1213161923, 2153816009, 1360629979},
				A:   [7]uint32{2020998143, 162161209, 2904253715, 2842596800, 461043234, 3462287781, 3201009886},
				PC:  868034,
				SR:  1295,
				USP: 10713346,
				SSP: 7123720,
				RAM: [][2]uint32{{868030, 54}, {868031, 41}, {868032, 235}, {868033, 109}, {868034, 194}, {868035, 192}, {11160998, 127}, {11160999, 51}, {868036, 117}, {868037, 83}},
			},
			want: 			cpuState{
				D:   [8]uint32{3693223266, 1858350512, 1472313824, 2756542259, 1186536373, 1213161923, 2153816009, 1360629979},
				A:   [7]uint32{2020998143, 162161209, 2904253715, 2842596800, 461043234, 3462287781, 3201009886},
				PC:  868038,
				SR:  1280,
				USP: 10713346,
				SSP: 7123720,
				RAM: [][2]uint32{{868030, 54}, {868031, 41}, {868032, 235}, {868033, 109}, {868034, 194}, {868035, 192}, {11160998, 127}, {11160999, 51}, {868036, 117}, {868037, 83}},
				Cycles: 12,
			},
		},
		{
			name: "1959 MOVE.w (A3), (d8, A4, Xn) 3993",
			init: 			cpuState{
				D:   [8]uint32{2608073169, 2015764457, 853886940, 608198791, 3169371905, 3181574792, 643875865, 2235710011},
				A:   [7]uint32{2067037968, 2123588424, 625044592, 4056397242, 2449507089, 4230919724, 3525753805},
				PC:  14790286,
				SR:  1561,
				USP: 13388054,
				SSP: 5828112,
				RAM: [][2]uint32{{14790282, 57}, {14790283, 147}, {14790284, 23}, {14790285, 166}, {13088186, 95}, {13088187, 135}, {14790286, 40}, {14790287, 227}, {14790288, 38}, {14790289, 172}},
			},
			want: 			cpuState{
				D:   [8]uint32{2608073169, 2015764457, 853886940, 608198791, 3169371905, 3181574792, 643875865, 2235710011},
				A:   [7]uint32{2067037968, 2123588424, 625044592, 4056397242, 2449507089, 4230919724, 3525753805},
				PC:  14790290,
				SR:  1552,
				USP: 13388054,
				SSP: 5828112,
				RAM: [][2]uint32{{14790282, 57}, {14790283, 147}, {14790284, 23}, {14790285, 166}, {13088186, 95}, {13088187, 135}, {14790286, 40}, {14790287, 227}, {41632, 95}, {41633, 135}, {14790288, 38}, {14790289, 172}},
				Cycles: 18,
			},
		},
		{
			name: "2252 MOVE.w A4, -(A2) 350c",
			init: 			cpuState{
				D:   [8]uint32{117203218, 3175154767, 1947368971, 1088548639, 3450917700, 414747962, 4198616959, 1510735080},
				A:   [7]uint32{3173490140, 2494655799, 3622878996, 86756575, 3219245301, 1823817295, 3563893702},
				PC:  12068892,
				SR:  8460,
				USP: 1057778,
				SSP: 13295080,
				RAM: [][2]uint32{{12068888, 53}, {12068889, 12}, {12068890, 65}, {12068891, 204}, {12068892, 155}, {12068893, 144}},
			},
			want: 			cpuState{
				D:   [8]uint32{117203218, 3175154767, 1947368971, 1088548639, 3450917700, 414747962, 4198616959, 1510735080},
				A:   [7]uint32{3173490140, 2494655799, 3622878994, 86756575, 3219245301, 1823817295, 3563893702},
				PC:  12068894,
				SR:  8456,
				USP: 1057778,
				SSP: 13295080,
				RAM: [][2]uint32{{12068888, 53}, {12068889, 12}, {12068890, 65}, {12068891, 204}, {12068892, 155}, {12068893, 144}, {15777554, 200}, {15777555, 245}},
				Cycles: 8,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVE_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVE.l A6, D3 260e",
			init: cpuState{
				D:   [8]uint32{2779654795, 879651737, 3747849768, 371410818, 733505073, 2153566449, 1534803634, 4126857533},
				A:   [7]uint32{1367930284, 2255304597, 4024009226, 484857825, 3467196709, 1244927156, 1581769544},
				PC:  1303768,
				SR:  1544,
				USP: 12022830,
				SSP: 3289112,
				RAM: [][2]uint32{{1303764, 38}, {1303765, 14}, {1303766, 235}, {1303767, 236}, {1303768, 218}, {1303769, 12}},
			},
			want: cpuState{
				D:   [8]uint32{2779654795, 879651737, 3747849768, 1581769544, 733505073, 2153566449, 1534803634, 4126857533},
				A:   [7]uint32{1367930284, 2255304597, 4024009226, 484857825, 3467196709, 1244927156, 1581769544},
				PC:  1303770,
				SR:  1536,
				USP: 12022830,
				SSP: 3289112,
				RAM: [][2]uint32{{1303764, 38}, {1303765, 14}, {1303766, 235}, {1303767, 236}, {1303768, 218}, {1303769, 12}},
				Cycles: 4,
			},
		},
		{
			name: "500 MOVE.l (A6), (A3) 2696",
			init: cpuState{
				D:   [8]uint32{1906962636, 544351852, 835379764, 615842027, 1267734345, 1916177819, 1949004110, 629334693},
				A:   [7]uint32{2238162024, 1403173603, 2182794003, 591293865, 1366987338, 2837198190, 1213243669},
				PC:  11821392,
				SR:  9482,
				USP: 4621904,
				SSP: 15218502,
				RAM: [][2]uint32{{11821388, 38}, {11821389, 150}, {11821390, 242}, {11821391, 126}, {12, 17}, {13, 14}, {14, 230}, {15, 160}, {976544, 230}, {976545, 100}, {976546, 197}, {976547, 2}},
			},
			want: cpuState{
				D:      [8]uint32{1906962636, 544351852, 835379764, 615842027, 1267734345, 1916177819, 1949004110, 629334693},
				A:      [7]uint32{2238162024, 1403173603, 2182794003, 591293865, 1366987338, 2837198190, 1213243669},
				PC:     286189220,
				SR:     9482,
				USP:    4621904,
				SSP:    15218488,
				RAM:    [][2]uint32{{11821388, 38}, {11821389, 150}, {11821390, 242}, {11821391, 126}, {15218500, 97}, {15218501, 78}, {15218496, 37}, {15218497, 10}, {15218498, 0}, {15218499, 180}, {15218494, 38}, {15218495, 150}, {15218492, 161}, {15218493, 21}, {15218488, 38}, {15218489, 149}, {15218490, 72}, {15218491, 80}, {12, 17}, {13, 14}, {14, 230}, {15, 160}, {976544, 230}, {976545, 100}, {976546, 197}, {976547, 2}},
				Halted: true,
			},
		},
		{
			name: "1000 MOVE.l (A5), -(A4) 2915",
			init: cpuState{
				D:   [8]uint32{2259011799, 3381715566, 3566753135, 1740003861, 1863968740, 897217987, 3402300250, 3363457043},
				A:   [7]uint32{4138688317, 1412687503, 416703343, 4141906543, 2745180922, 1410956282, 2689104359},
				PC:  9053130,
				SR:  9747,
				USP: 14434082,
				SSP: 4336484,
				RAM: [][2]uint32{{9053126, 41}, {9053127, 21}, {9053128, 7}, {9053129, 66}, {1670138, 100}, {1670139, 211}, {1670140, 8}, {1670141, 184}, {9053130, 14}, {9053131, 243}},
			},
			want: cpuState{
				D:   [8]uint32{2259011799, 3381715566, 3566753135, 1740003861, 1863968740, 897217987, 3402300250, 3363457043},
				A:   [7]uint32{4138688317, 1412687503, 416703343, 4141906543, 2745180918, 1410956282, 2689104359},
				PC:  9053132,
				SR:  9744,
				USP: 14434082,
				SSP: 4336484,
				RAM: [][2]uint32{{9053126, 41}, {9053127, 21}, {9053128, 7}, {9053129, 66}, {1670138, 100}, {1670139, 211}, {1670140, 8}, {1670141, 184}, {9053130, 14}, {9053131, 243}, {10494712, 8}, {10494713, 184}, {10494710, 100}, {10494711, 211}},
				Cycles: 20,
			},
		},
		{
			name: "1500 MOVE.l (A0)+, (d16, A5) 2b58",
			init: cpuState{
				D:   [8]uint32{2243211884, 2835599725, 994373749, 1247880749, 407550755, 1646233360, 2240256088, 2313172021},
				A:   [7]uint32{2497839615, 1054997022, 2036715351, 2265210345, 4123845927, 2902601904, 3555366105},
				PC:  9252066,
				SR:  1538,
				USP: 2634082,
				SSP: 5705800,
				RAM: [][2]uint32{{9252062, 43}, {9252063, 88}, {9252064, 73}, {9252065, 187}, {12, 137}, {13, 110}, {14, 114}, {15, 52}, {7238196, 36}, {7238197, 192}, {7238198, 148}, {7238199, 89}},
			},
			want: cpuState{
				D:      [8]uint32{2243211884, 2835599725, 994373749, 1247880749, 407550755, 1646233360, 2240256088, 2313172021},
				A:      [7]uint32{2497839615, 1054997022, 2036715351, 2265210345, 4123845927, 2902601904, 3555366105},
				PC:     2305716792,
				SR:     9730,
				USP:    2634082,
				SSP:    5705786,
				RAM:    [][2]uint32{{9252062, 43}, {9252063, 88}, {9252064, 73}, {9252065, 187}, {5705798, 44}, {5705799, 224}, {5705794, 6}, {5705795, 2}, {5705796, 0}, {5705797, 141}, {5705792, 43}, {5705793, 88}, {5705790, 1}, {5705791, 255}, {5705786, 43}, {5705787, 81}, {5705788, 148}, {5705789, 226}, {12, 137}, {13, 110}, {14, 114}, {15, 52}, {7238196, 36}, {7238197, 192}, {7238198, 148}, {7238199, 89}},
				Halted: true,
			},
		},
		{
			name: "2000 MOVE.l A7, (d8, A6, Xn) 2d8f",
			init: cpuState{
				D:   [8]uint32{769094282, 820142349, 522189760, 2120923073, 659149166, 694750001, 779492637, 1556090862},
				A:   [7]uint32{2891211662, 1114190426, 1960547781, 3133619532, 3086594567, 217168943, 2110140184},
				PC:  11144946,
				SR:  34582,
				USP: 4923410,
				SSP: 16334636,
				RAM: [][2]uint32{{11144942, 45}, {11144943, 143}, {11144944, 230}, {11144945, 154}, {11144946, 137}, {11144947, 86}, {11144948, 199}, {11144949, 152}},
			},
			want: cpuState{
				D:   [8]uint32{769094282, 820142349, 522189760, 2120923073, 659149166, 694750001, 779492637, 1556090862},
				A:   [7]uint32{2891211662, 1114190426, 1960547781, 3133619532, 3086594567, 217168943, 2110140184},
				PC:  11144950,
				SR:  34576,
				USP: 4923410,
				SSP: 16334636,
				RAM: [][2]uint32{{11144942, 45}, {11144943, 143}, {11144944, 230}, {11144945, 154}, {11144946, 137}, {11144947, 86}, {13000138, 0}, {13000139, 75}, {13000140, 32}, {13000141, 18}, {11144948, 199}, {11144949, 152}},
				Cycles: 18,
			},
		},
		{
			name: "004 MOVE.l (d16, A4), D3 262c",
			init: 			cpuState{
				D:   [8]uint32{2059526042, 3583097350, 3945259846, 3045823338, 2341247459, 588133992, 1029541034, 2820127837},
				A:   [7]uint32{285825730, 2763776439, 539793295, 963493228, 3982312004, 3282597733, 2809304414},
				PC:  13202990,
				SR:  9238,
				USP: 437908,
				SSP: 3948310,
				RAM: [][2]uint32{{13202986, 38}, {13202987, 44}, {13202988, 131}, {13202989, 96}, {13202990, 94}, {13202991, 138}, {6079908, 187}, {6079909, 176}, {6079910, 95}, {6079911, 33}, {13202992, 217}, {13202993, 178}},
			},
			want: 			cpuState{
				D:   [8]uint32{2059526042, 3583097350, 3945259846, 3148898081, 2341247459, 588133992, 1029541034, 2820127837},
				A:   [7]uint32{285825730, 2763776439, 539793295, 963493228, 3982312004, 3282597733, 2809304414},
				PC:  13202994,
				SR:  9240,
				USP: 437908,
				SSP: 3948310,
				RAM: [][2]uint32{{13202986, 38}, {13202987, 44}, {13202988, 131}, {13202989, 96}, {13202990, 94}, {13202991, 138}, {6079908, 187}, {6079909, 176}, {6079910, 95}, {6079911, 33}, {13202992, 217}, {13202993, 178}},
				Cycles: 16,
			},
		},
		{
			name: "252 MOVE.l (d8, A1, Xn), D4 2831",
			init: 			cpuState{
				D:   [8]uint32{2731623989, 2608793884, 3320143365, 1049401080, 3325740223, 4243918337, 1160875806, 3900107420},
				A:   [7]uint32{2280456725, 1773920185, 475626025, 2434421414, 79542475, 2517048681, 3084862914},
				PC:  13271508,
				SR:  540,
				USP: 1615214,
				SSP: 12416612,
				RAM: [][2]uint32{{13271504, 40}, {13271505, 49}, {13271506, 155}, {13271507, 72}, {13271508, 148}, {13271509, 11}, {7847866, 161}, {7847867, 141}, {7847868, 75}, {7847869, 253}, {13271510, 7}, {13271511, 32}},
			},
			want: 			cpuState{
				D:   [8]uint32{2731623989, 2608793884, 3320143365, 1049401080, 2710391805, 4243918337, 1160875806, 3900107420},
				A:   [7]uint32{2280456725, 1773920185, 475626025, 2434421414, 79542475, 2517048681, 3084862914},
				PC:  13271512,
				SR:  536,
				USP: 1615214,
				SSP: 12416612,
				RAM: [][2]uint32{{13271504, 40}, {13271505, 49}, {13271506, 155}, {13271507, 72}, {13271508, 148}, {13271509, 11}, {7847866, 161}, {7847867, 141}, {7847868, 75}, {7847869, 253}, {13271510, 7}, {13271511, 32}},
				Cycles: 18,
			},
		},
		{
			name: "535 MOVE.l (A4)+, (d8, A6, Xn) 2d9c",
			init: 			cpuState{
				D:   [8]uint32{3156899019, 2700757931, 840001928, 1517433068, 3197399915, 1917281411, 2177383833, 4280522286},
				A:   [7]uint32{3408989425, 824211044, 2141613701, 2536427828, 196077724, 1351539154, 661558858},
				PC:  923650,
				SR:  8222,
				USP: 7087586,
				SSP: 10561704,
				RAM: [][2]uint32{{923646, 45}, {923647, 156}, {923648, 141}, {923649, 123}, {11528348, 4}, {11528349, 115}, {11528350, 79}, {11528351, 232}, {923650, 109}, {923651, 10}, {923652, 201}, {923653, 239}},
			},
			want: 			cpuState{
				D:   [8]uint32{3156899019, 2700757931, 840001928, 1517433068, 3197399915, 1917281411, 2177383833, 4280522286},
				A:   [7]uint32{3408989425, 824211044, 2141613701, 2536427828, 196077728, 1351539154, 661558858},
				PC:  923654,
				SR:  8208,
				USP: 7087586,
				SSP: 10561704,
				RAM: [][2]uint32{{923646, 45}, {923647, 156}, {923648, 141}, {923649, 123}, {11528348, 4}, {11528349, 115}, {11528350, 79}, {11528351, 232}, {923650, 109}, {923651, 10}, {10462134, 4}, {10462135, 115}, {10462136, 79}, {10462137, 232}, {923652, 201}, {923653, 239}},
				Cycles: 26,
			},
		},
		{
			name: "852 MOVE.l D2, -(A2) 2502",
			init: 			cpuState{
				D:   [8]uint32{1376854311, 4065304881, 4231967169, 2289315839, 1304202365, 146671863, 1820638266, 745645145},
				A:   [7]uint32{3114090780, 1796813969, 1647790382, 3948613004, 2606424223, 2551283641, 680419109},
				PC:  15601198,
				SR:  8973,
				USP: 2794474,
				SSP: 14171652,
				RAM: [][2]uint32{{15601194, 37}, {15601195, 2}, {15601196, 79}, {15601197, 20}, {15601198, 206}, {15601199, 225}},
			},
			want: 			cpuState{
				D:   [8]uint32{1376854311, 4065304881, 4231967169, 2289315839, 1304202365, 146671863, 1820638266, 745645145},
				A:   [7]uint32{3114090780, 1796813969, 1647790378, 3948613004, 2606424223, 2551283641, 680419109},
				PC:  15601200,
				SR:  8968,
				USP: 2794474,
				SSP: 14171652,
				RAM: [][2]uint32{{15601194, 37}, {15601195, 2}, {15601196, 79}, {15601197, 20}, {15601198, 206}, {15601199, 225}, {3623212, 177}, {3623213, 193}, {3623210, 252}, {3623211, 62}},
				Cycles: 12,
			},
		},
		{
			name: "1095 MOVE.l (d16, A4), -(A4) 292c",
			init: 			cpuState{
				D:   [8]uint32{2441476134, 47704813, 1986163175, 3351132140, 520334424, 4293285794, 3891969107, 1282768184},
				A:   [7]uint32{2593578087, 2823082484, 1921460396, 2132711828, 1520997938, 3441114575, 3503344037},
				PC:  4181654,
				SR:  528,
				USP: 10623830,
				SSP: 16422502,
				RAM: [][2]uint32{{4181650, 41}, {4181651, 44}, {4181652, 69}, {4181653, 186}, {4181654, 174}, {4181655, 148}, {11066348, 89}, {11066349, 37}, {11066350, 129}, {11066351, 146}, {4181656, 155}, {4181657, 15}},
			},
			want: 			cpuState{
				D:   [8]uint32{2441476134, 47704813, 1986163175, 3351132140, 520334424, 4293285794, 3891969107, 1282768184},
				A:   [7]uint32{2593578087, 2823082484, 1921460396, 2132711828, 1520997934, 3441114575, 3503344037},
				PC:  4181658,
				SR:  528,
				USP: 10623830,
				SSP: 16422502,
				RAM: [][2]uint32{{4181650, 41}, {4181651, 44}, {4181652, 69}, {4181653, 186}, {4181654, 174}, {4181655, 148}, {11066348, 89}, {11066349, 37}, {11066350, 129}, {11066351, 146}, {4181656, 155}, {4181657, 15}, {11048496, 129}, {11048497, 146}, {11048494, 89}, {11048495, 37}},
				Cycles: 24,
			},
		},
		{
			name: "1330 MOVE.l -(A0), -(A6) 2d20",
			init: 			cpuState{
				D:   [8]uint32{2264545514, 1374771985, 1001287361, 532185128, 613093391, 3287415038, 1215793485, 3909125043},
				A:   [7]uint32{2660590302, 729307542, 3181014722, 3595398513, 1752996088, 2850167106, 2736777392},
				PC:  8017206,
				SR:  795,
				USP: 8009078,
				SSP: 5667624,
				RAM: [][2]uint32{{8017202, 45}, {8017203, 32}, {8017204, 167}, {8017205, 5}, {9790170, 128}, {9790171, 112}, {9790172, 8}, {9790173, 227}, {8017206, 13}, {8017207, 180}},
			},
			want: 			cpuState{
				D:   [8]uint32{2264545514, 1374771985, 1001287361, 532185128, 613093391, 3287415038, 1215793485, 3909125043},
				A:   [7]uint32{2660590298, 729307542, 3181014722, 3595398513, 1752996088, 2850167106, 2736777388},
				PC:  8017208,
				SR:  792,
				USP: 8009078,
				SSP: 5667624,
				RAM: [][2]uint32{{8017202, 45}, {8017203, 32}, {8017204, 167}, {8017205, 5}, {9790170, 128}, {9790171, 112}, {9790172, 8}, {9790173, 227}, {8017206, 13}, {8017207, 180}, {2091182, 8}, {2091183, 227}, {2091180, 128}, {2091181, 112}},
				Cycles: 22,
			},
		},
		{
			name: "1661 MOVE.l D1, -(A2) 2501",
			init: 			cpuState{
				D:   [8]uint32{4240270096, 2015596559, 4138735890, 1413630443, 1616940895, 1192063388, 3636379130, 4282279013},
				A:   [7]uint32{3173286180, 2256667902, 4205589722, 1122182579, 703295439, 2504947715, 891427486},
				PC:  11507956,
				SR:  9739,
				USP: 13741560,
				SSP: 3663920,
				RAM: [][2]uint32{{11507952, 37}, {11507953, 1}, {11507954, 49}, {11507955, 95}, {11507956, 70}, {11507957, 106}},
			},
			want: 			cpuState{
				D:   [8]uint32{4240270096, 2015596559, 4138735890, 1413630443, 1616940895, 1192063388, 3636379130, 4282279013},
				A:   [7]uint32{3173286180, 2256667902, 4205589718, 1122182579, 703295439, 2504947715, 891427486},
				PC:  11507958,
				SR:  9728,
				USP: 13741560,
				SSP: 3663920,
				RAM: [][2]uint32{{11507952, 37}, {11507953, 1}, {11507954, 49}, {11507955, 95}, {11507956, 70}, {11507957, 106}, {11285720, 144}, {11285721, 15}, {11285718, 120}, {11285719, 35}},
				Cycles: 12,
			},
		},
		{
			name: "1926 MOVE.l (A6), (d16, A0) 2156",
			init: 			cpuState{
				D:   [8]uint32{610482485, 3157151598, 2600224624, 3505640956, 1108099130, 632745117, 25120751, 4124205684},
				A:   [7]uint32{371491033, 3799183, 216694862, 389034220, 610068222, 2171938238, 3941032052},
				PC:  835668,
				SR:  9753,
				USP: 270064,
				SSP: 15453926,
				RAM: [][2]uint32{{835664, 33}, {835665, 86}, {835666, 46}, {835667, 227}, {15163508, 57}, {15163509, 176}, {15163510, 179}, {15163511, 160}, {835668, 67}, {835669, 106}, {835670, 117}, {835671, 199}},
			},
			want: 			cpuState{
				D:   [8]uint32{610482485, 3157151598, 2600224624, 3505640956, 1108099130, 632745117, 25120751, 4124205684},
				A:   [7]uint32{371491033, 3799183, 216694862, 389034220, 610068222, 2171938238, 3941032052},
				PC:  835672,
				SR:  9744,
				USP: 270064,
				SSP: 15453926,
				RAM: [][2]uint32{{835664, 33}, {835665, 86}, {835666, 46}, {835667, 227}, {15163508, 57}, {15163509, 176}, {15163510, 179}, {15163511, 160}, {835668, 67}, {835669, 106}, {2404284, 57}, {2404285, 176}, {2404286, 179}, {2404287, 160}, {835670, 117}, {835671, 199}},
				Cycles: 24,
			},
		},
		{
			name: "2189 MOVE.l A5, -(A7) 2f0d",
			init: 			cpuState{
				D:   [8]uint32{2007646580, 892709915, 1838174271, 3630675504, 3315413600, 509700251, 2756857783, 1694324262},
				A:   [7]uint32{2216906308, 1428226512, 2594032577, 2331221010, 544212821, 3661766420, 1881836650},
				PC:  7708602,
				SR:  9747,
				USP: 3651238,
				SSP: 9772344,
				RAM: [][2]uint32{{7708598, 47}, {7708599, 13}, {7708600, 254}, {7708601, 224}, {7708602, 194}, {7708603, 243}},
			},
			want: 			cpuState{
				D:   [8]uint32{2007646580, 892709915, 1838174271, 3630675504, 3315413600, 509700251, 2756857783, 1694324262},
				A:   [7]uint32{2216906308, 1428226512, 2594032577, 2331221010, 544212821, 3661766420, 1881836650},
				PC:  7708604,
				SR:  9752,
				USP: 3651238,
				SSP: 9772340,
				RAM: [][2]uint32{{7708598, 47}, {7708599, 13}, {7708600, 254}, {7708601, 224}, {7708602, 194}, {7708603, 243}, {9772342, 31}, {9772343, 20}, {9772340, 218}, {9772341, 66}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEA_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEA.w (d16, A5), A2 346d",
			init: cpuState{
				D:   [8]uint32{2633737401, 881409296, 938630714, 350777443, 1246386968, 4128130004, 773338312, 3810805693},
				A:   [7]uint32{3643743800, 2737871102, 460026691, 3399621626, 3889092532, 2548963630, 2799262639},
				PC:  2366570,
				SR:  33298,
				USP: 9629732,
				SSP: 9702902,
				RAM: [][2]uint32{{2366566, 52}, {2366567, 109}, {2366568, 168}, {2366569, 8}, {2366570, 230}, {2366571, 149}, {15581494, 71}, {15581495, 31}, {2366572, 173}, {2366573, 91}},
			},
			want: cpuState{
				D:   [8]uint32{2633737401, 881409296, 938630714, 350777443, 1246386968, 4128130004, 773338312, 3810805693},
				A:   [7]uint32{3643743800, 2737871102, 18207, 3399621626, 3889092532, 2548963630, 2799262639},
				PC:  2366574,
				SR:  33298,
				USP: 9629732,
				SSP: 9702902,
				RAM: [][2]uint32{{2366566, 52}, {2366567, 109}, {2366568, 168}, {2366569, 8}, {2366570, 230}, {2366571, 149}, {15581494, 71}, {15581495, 31}, {2366572, 173}, {2366573, 91}},
				Cycles: 12,
			},
		},
		{
			name: "500 MOVEA.w D0, A2 3440",
			init: cpuState{
				D:   [8]uint32{4132436609, 1700069792, 1947766642, 1233203667, 4068705777, 1646861605, 96064372, 144201063},
				A:   [7]uint32{1771938927, 3970136038, 1838383541, 55271316, 2965380833, 3192637829, 2808054900},
				PC:  11208608,
				SR:  42013,
				USP: 3435976,
				SSP: 965830,
				RAM: [][2]uint32{{11208604, 52}, {11208605, 64}, {11208606, 10}, {11208607, 42}, {11208608, 60}, {11208609, 246}},
			},
			want: cpuState{
				D:   [8]uint32{4132436609, 1700069792, 1947766642, 1233203667, 4068705777, 1646861605, 96064372, 144201063},
				A:   [7]uint32{1771938927, 3970136038, 4294965889, 55271316, 2965380833, 3192637829, 2808054900},
				PC:  11208610,
				SR:  42013,
				USP: 3435976,
				SSP: 965830,
				RAM: [][2]uint32{{11208604, 52}, {11208605, 64}, {11208606, 10}, {11208607, 42}, {11208608, 60}, {11208609, 246}},
				Cycles: 4,
			},
		},
		{
			name: "1000 MOVEA.w (d8, A0, Xn), A0 3070",
			init: cpuState{
				D:   [8]uint32{1389797193, 4162590642, 114793799, 3993037372, 1339774546, 3174000549, 3456537320, 1806466680},
				A:   [7]uint32{2664872460, 1989940790, 198392215, 2899354035, 3795768192, 3990845804, 2384483721},
				PC:  195706,
				SR:  8212,
				USP: 16476494,
				SSP: 9341842,
				RAM: [][2]uint32{{195702, 48}, {195703, 112}, {195704, 207}, {195705, 72}, {195706, 219}, {195707, 34}, {1412564, 197}, {1412565, 174}, {195708, 0}, {195709, 144}},
			},
			want: cpuState{
				D:   [8]uint32{1389797193, 4162590642, 114793799, 3993037372, 1339774546, 3174000549, 3456537320, 1806466680},
				A:   [7]uint32{4294952366, 1989940790, 198392215, 2899354035, 3795768192, 3990845804, 2384483721},
				PC:  195710,
				SR:  8212,
				USP: 16476494,
				SSP: 9341842,
				RAM: [][2]uint32{{195702, 48}, {195703, 112}, {195704, 207}, {195705, 72}, {195706, 219}, {195707, 34}, {1412564, 197}, {1412565, 174}, {195708, 0}, {195709, 144}},
				Cycles: 14,
			},
		},
		{
			name: "1500 MOVEA.w (d8, A3, Xn), A4 3873",
			init: cpuState{
				D:   [8]uint32{2234733666, 291275165, 2952499797, 1883980557, 2471670141, 3120043754, 216107469, 1263155448},
				A:   [7]uint32{1656944752, 3100719148, 3143950131, 3062858622, 44585201, 2418165233, 152911640},
				PC:  5837178,
				SR:  8452,
				USP: 13146320,
				SSP: 9491448,
				RAM: [][2]uint32{{5837174, 56}, {5837175, 115}, {5837176, 181}, {5837177, 40}, {5837178, 194}, {5837179, 70}, {9373476, 26}, {9373477, 184}, {5837180, 32}, {5837181, 187}},
			},
			want: cpuState{
				D:   [8]uint32{2234733666, 291275165, 2952499797, 1883980557, 2471670141, 3120043754, 216107469, 1263155448},
				A:   [7]uint32{1656944752, 3100719148, 3143950131, 3062858622, 6840, 2418165233, 152911640},
				PC:  5837182,
				SR:  8452,
				USP: 13146320,
				SSP: 9491448,
				RAM: [][2]uint32{{5837174, 56}, {5837175, 115}, {5837176, 181}, {5837177, 40}, {5837178, 194}, {5837179, 70}, {9373476, 26}, {9373477, 184}, {5837180, 32}, {5837181, 187}},
				Cycles: 14,
			},
		},
		{
			name: "2000 MOVEA.w -(A6), A6 3c66",
			init: cpuState{
				D:   [8]uint32{2144636058, 1785863322, 119615365, 3185098495, 2648751119, 6974025, 112613251, 111329591},
				A:   [7]uint32{368441009, 4144009678, 1203869270, 3572133479, 3386634153, 1434543674, 3679905064},
				PC:  6309770,
				SR:  1806,
				USP: 9528720,
				SSP: 13734672,
				RAM: [][2]uint32{{6309766, 60}, {6309767, 102}, {6309768, 81}, {6309769, 233}, {5694758, 29}, {5694759, 216}, {6309770, 91}, {6309771, 249}},
			},
			want: cpuState{
				D:   [8]uint32{2144636058, 1785863322, 119615365, 3185098495, 2648751119, 6974025, 112613251, 111329591},
				A:   [7]uint32{368441009, 4144009678, 1203869270, 3572133479, 3386634153, 1434543674, 7640},
				PC:  6309772,
				SR:  1806,
				USP: 9528720,
				SSP: 13734672,
				RAM: [][2]uint32{{6309766, 60}, {6309767, 102}, {6309768, 81}, {6309769, 233}, {5694758, 29}, {5694759, 216}, {6309770, 91}, {6309771, 249}},
				Cycles: 10,
			},
		},
		{
			name: "001 MOVEA.w D4, A2 3444",
			init: 			cpuState{
				D:   [8]uint32{3569710835, 2389875046, 3450703328, 458964072, 1374752335, 2682468420, 2842841321, 1837080605},
				A:   [7]uint32{3334746194, 4117890097, 1409355951, 745122549, 2178999144, 3452493134, 2876202106},
				PC:  9793746,
				SR:  8472,
				USP: 6908740,
				SSP: 15649442,
				RAM: [][2]uint32{{9793742, 52}, {9793743, 68}, {9793744, 191}, {9793745, 219}, {9793746, 49}, {9793747, 174}},
			},
			want: 			cpuState{
				D:   [8]uint32{3569710835, 2389875046, 3450703328, 458964072, 1374752335, 2682468420, 2842841321, 1837080605},
				A:   [7]uint32{3334746194, 4117890097, 3663, 745122549, 2178999144, 3452493134, 2876202106},
				PC:  9793748,
				SR:  8472,
				USP: 6908740,
				SSP: 15649442,
				RAM: [][2]uint32{{9793742, 52}, {9793743, 68}, {9793744, 191}, {9793745, 219}, {9793746, 49}, {9793747, 174}},
				Cycles: 4,
			},
		},
		{
			name: "272 MOVEA.w -(A1), A6 3c61",
			init: 			cpuState{
				D:   [8]uint32{2921283331, 1881829376, 3848053823, 704755184, 3262916392, 2074637194, 1314823120, 603562513},
				A:   [7]uint32{2551777367, 4284274866, 2501932685, 3522661963, 1489618555, 2499182364, 96132516},
				PC:  4103662,
				SR:  1053,
				USP: 3830336,
				SSP: 2622138,
				RAM: [][2]uint32{{4103658, 60}, {4103659, 97}, {4103660, 84}, {4103661, 208}, {6084784, 103}, {6084785, 151}, {4103662, 19}, {4103663, 181}},
			},
			want: 			cpuState{
				D:   [8]uint32{2921283331, 1881829376, 3848053823, 704755184, 3262916392, 2074637194, 1314823120, 603562513},
				A:   [7]uint32{2551777367, 4284274864, 2501932685, 3522661963, 1489618555, 2499182364, 26519},
				PC:  4103664,
				SR:  1053,
				USP: 3830336,
				SSP: 2622138,
				RAM: [][2]uint32{{4103658, 60}, {4103659, 97}, {4103660, 84}, {4103661, 208}, {6084784, 103}, {6084785, 151}, {4103662, 19}, {4103663, 181}},
				Cycles: 10,
			},
		},
		{
			name: "550 MOVEA.w D4, A5 3a44",
			init: 			cpuState{
				D:   [8]uint32{963787805, 1983857377, 2455617059, 3315834023, 3466178224, 123214435, 1716642202, 1563302894},
				A:   [7]uint32{2268845923, 2803671673, 1415062323, 381598732, 3667390154, 1239659141, 2148172073},
				PC:  8364728,
				SR:  8731,
				USP: 1181226,
				SSP: 3887126,
				RAM: [][2]uint32{{8364724, 58}, {8364725, 68}, {8364726, 181}, {8364727, 163}, {8364728, 177}, {8364729, 238}},
			},
			want: 			cpuState{
				D:   [8]uint32{963787805, 1983857377, 2455617059, 3315834023, 3466178224, 123214435, 1716642202, 1563302894},
				A:   [7]uint32{2268845923, 2803671673, 1415062323, 381598732, 3667390154, 4294946480, 2148172073},
				PC:  8364730,
				SR:  8731,
				USP: 1181226,
				SSP: 3887126,
				RAM: [][2]uint32{{8364724, 58}, {8364725, 68}, {8364726, 181}, {8364727, 163}, {8364728, 177}, {8364729, 238}},
				Cycles: 4,
			},
		},
		{
			name: "867 MOVEA.w (d8, A6, Xn), A5 3a76",
			init: 			cpuState{
				D:   [8]uint32{3397444689, 333541415, 2733024350, 1659845555, 3752038033, 2212205177, 1222814076, 2995836991},
				A:   [7]uint32{1742348979, 909597571, 3044990946, 1900407623, 4140252640, 3094349793, 4258851369},
				PC:  2535576,
				SR:  276,
				USP: 1993108,
				SSP: 9509568,
				RAM: [][2]uint32{{2535572, 58}, {2535573, 118}, {2535574, 148}, {2535575, 92}, {2535576, 49}, {2535577, 232}, {14239240, 15}, {14239241, 237}, {2535578, 67}, {2535579, 33}},
			},
			want: 			cpuState{
				D:   [8]uint32{3397444689, 333541415, 2733024350, 1659845555, 3752038033, 2212205177, 1222814076, 2995836991},
				A:   [7]uint32{1742348979, 909597571, 3044990946, 1900407623, 4140252640, 4077, 4258851369},
				PC:  2535580,
				SR:  276,
				USP: 1993108,
				SSP: 9509568,
				RAM: [][2]uint32{{2535572, 58}, {2535573, 118}, {2535574, 148}, {2535575, 92}, {2535576, 49}, {2535577, 232}, {14239240, 15}, {14239241, 237}, {2535578, 67}, {2535579, 33}},
				Cycles: 14,
			},
		},
		{
			name: "1118 MOVEA.w D1, A1 3241",
			init: 			cpuState{
				D:   [8]uint32{2129071456, 2875596577, 1652321010, 2147775181, 1772979750, 2860106645, 70936383, 1620195030},
				A:   [7]uint32{397761081, 2180290838, 2140144194, 2681725365, 1415876548, 1032764712, 2014452193},
				PC:  13895164,
				SR:  1027,
				USP: 14367910,
				SSP: 5579930,
				RAM: [][2]uint32{{13895160, 50}, {13895161, 65}, {13895162, 243}, {13895163, 238}, {13895164, 38}, {13895165, 214}},
			},
			want: 			cpuState{
				D:   [8]uint32{2129071456, 2875596577, 1652321010, 2147775181, 1772979750, 2860106645, 70936383, 1620195030},
				A:   [7]uint32{397761081, 7969, 2140144194, 2681725365, 1415876548, 1032764712, 2014452193},
				PC:  13895166,
				SR:  1027,
				USP: 14367910,
				SSP: 5579930,
				RAM: [][2]uint32{{13895160, 50}, {13895161, 65}, {13895162, 243}, {13895163, 238}, {13895164, 38}, {13895165, 214}},
				Cycles: 4,
			},
		},
		{
			name: "1379 MOVEA.w (d16, A7), A3 366f",
			init: 			cpuState{
				D:   [8]uint32{383883270, 475735379, 2910235784, 1247055759, 470291159, 3653091166, 4032656960, 466970446},
				A:   [7]uint32{1430990431, 3979914525, 3688509465, 1700740395, 2246456229, 4103184025, 20959514},
				PC:  12309216,
				SR:  8731,
				USP: 4123212,
				SSP: 11654698,
				RAM: [][2]uint32{{12309212, 54}, {12309213, 111}, {12309214, 45}, {12309215, 52}, {12309216, 198}, {12309217, 120}, {11666270, 101}, {11666271, 44}, {12309218, 74}, {12309219, 41}},
			},
			want: 			cpuState{
				D:   [8]uint32{383883270, 475735379, 2910235784, 1247055759, 470291159, 3653091166, 4032656960, 466970446},
				A:   [7]uint32{1430990431, 3979914525, 3688509465, 25900, 2246456229, 4103184025, 20959514},
				PC:  12309220,
				SR:  8731,
				USP: 4123212,
				SSP: 11654698,
				RAM: [][2]uint32{{12309212, 54}, {12309213, 111}, {12309214, 45}, {12309215, 52}, {12309216, 198}, {12309217, 120}, {11666270, 101}, {11666271, 44}, {12309218, 74}, {12309219, 41}},
				Cycles: 12,
			},
		},
		{
			name: "1662 MOVEA.w A3, A0 304b",
			init: 			cpuState{
				D:   [8]uint32{2893096072, 2954011976, 2365871866, 3944621957, 284776453, 1725870854, 3423979007, 3058747078},
				A:   [7]uint32{269898073, 3365777554, 2517229314, 896695641, 3833747122, 3372616220, 1048249310},
				PC:  5346248,
				SR:  8203,
				USP: 5229340,
				SSP: 6252640,
				RAM: [][2]uint32{{5346244, 48}, {5346245, 75}, {5346246, 44}, {5346247, 143}, {5346248, 196}, {5346249, 189}},
			},
			want: 			cpuState{
				D:   [8]uint32{2893096072, 2954011976, 2365871866, 3944621957, 284776453, 1725870854, 3423979007, 3058747078},
				A:   [7]uint32{32089, 3365777554, 2517229314, 896695641, 3833747122, 3372616220, 1048249310},
				PC:  5346250,
				SR:  8203,
				USP: 5229340,
				SSP: 6252640,
				RAM: [][2]uint32{{5346244, 48}, {5346245, 75}, {5346246, 44}, {5346247, 143}, {5346248, 196}, {5346249, 189}},
				Cycles: 4,
			},
		},
		{
			name: "1908 MOVEA.w (d8, A6, Xn), A0 3076",
			init: 			cpuState{
				D:   [8]uint32{3476439667, 3569396690, 2008060185, 112669420, 1523329820, 1422524540, 2061882387, 4220096115},
				A:   [7]uint32{3526142579, 482045795, 1545489795, 3956820207, 4055770048, 1990902950, 2878055978},
				PC:  6442764,
				SR:  267,
				USP: 16526704,
				SSP: 9872872,
				RAM: [][2]uint32{{6442760, 48}, {6442761, 118}, {6442762, 192}, {6442763, 130}, {6442764, 157}, {6442765, 233}, {9161068, 58}, {9161069, 216}, {6442766, 135}, {6442767, 188}},
			},
			want: 			cpuState{
				D:   [8]uint32{3476439667, 3569396690, 2008060185, 112669420, 1523329820, 1422524540, 2061882387, 4220096115},
				A:   [7]uint32{15064, 482045795, 1545489795, 3956820207, 4055770048, 1990902950, 2878055978},
				PC:  6442768,
				SR:  267,
				USP: 16526704,
				SSP: 9872872,
				RAM: [][2]uint32{{6442760, 48}, {6442761, 118}, {6442762, 192}, {6442763, 130}, {6442764, 157}, {6442765, 233}, {9161068, 58}, {9161069, 216}, {6442766, 135}, {6442767, 188}},
				Cycles: 14,
			},
		},
		{
			name: "2188 MOVEA.w A2, A5 3a4a",
			init: 			cpuState{
				D:   [8]uint32{3029376546, 2796560615, 608824335, 2278640478, 299826107, 1212753033, 1529981149, 1641628667},
				A:   [7]uint32{2736399521, 2445055464, 2169949156, 1755375580, 1974391838, 407477222, 4012606466},
				PC:  1131112,
				SR:  1551,
				USP: 13460610,
				SSP: 10275826,
				RAM: [][2]uint32{{1131108, 58}, {1131109, 74}, {1131110, 247}, {1131111, 69}, {1131112, 152}, {1131113, 70}},
			},
			want: 			cpuState{
				D:   [8]uint32{3029376546, 2796560615, 608824335, 2278640478, 299826107, 1212753033, 1529981149, 1641628667},
				A:   [7]uint32{2736399521, 2445055464, 2169949156, 1755375580, 1974391838, 4294953956, 4012606466},
				PC:  1131114,
				SR:  1551,
				USP: 13460610,
				SSP: 10275826,
				RAM: [][2]uint32{{1131108, 58}, {1131109, 74}, {1131110, 247}, {1131111, 69}, {1131112, 152}, {1131113, 70}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEA_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEA.l (d16, A6), A0 206e",
			init: cpuState{
				D:   [8]uint32{3169999053, 3469235951, 2271338676, 2511997186, 2512246480, 1951198345, 182753002, 1861824547},
				A:   [7]uint32{3981850156, 3212903014, 1011064591, 828776136, 4262926462, 538596608, 3377535161},
				PC:  5315798,
				SR:  34326,
				USP: 13214434,
				SSP: 9236656,
				RAM: [][2]uint32{{5315794, 32}, {5315795, 110}, {5315796, 219}, {5315797, 121}, {5315798, 31}, {5315799, 84}, {5305394, 6}, {5305395, 161}, {5305396, 245}, {5305397, 39}, {5315800, 70}, {5315801, 89}},
			},
			want: cpuState{
				D:   [8]uint32{3169999053, 3469235951, 2271338676, 2511997186, 2512246480, 1951198345, 182753002, 1861824547},
				A:   [7]uint32{111277351, 3212903014, 1011064591, 828776136, 4262926462, 538596608, 3377535161},
				PC:  5315802,
				SR:  34326,
				USP: 13214434,
				SSP: 9236656,
				RAM: [][2]uint32{{5315794, 32}, {5315795, 110}, {5315796, 219}, {5315797, 121}, {5315798, 31}, {5315799, 84}, {5305394, 6}, {5305395, 161}, {5305396, 245}, {5305397, 39}, {5315800, 70}, {5315801, 89}},
				Cycles: 16,
			},
		},
		{
			name: "500 MOVEA.l -(A4), A5 2a64",
			init: cpuState{
				D:   [8]uint32{2877479198, 2590065528, 2389775311, 1986702321, 2144261999, 2104095943, 4172402348, 2964225903},
				A:   [7]uint32{132481090, 3224410927, 4048291003, 1258365565, 865876212, 3207635035, 3004754001},
				PC:  5183674,
				SR:  8205,
				USP: 3708158,
				SSP: 16293776,
				RAM: [][2]uint32{{5183670, 42}, {5183671, 100}, {5183672, 29}, {5183673, 54}, {10238192, 144}, {10238193, 49}, {10238194, 164}, {10238195, 15}, {5183674, 12}, {5183675, 86}},
			},
			want: cpuState{
				D:   [8]uint32{2877479198, 2590065528, 2389775311, 1986702321, 2144261999, 2104095943, 4172402348, 2964225903},
				A:   [7]uint32{132481090, 3224410927, 4048291003, 1258365565, 865876208, 2419172367, 3004754001},
				PC:  5183676,
				SR:  8205,
				USP: 3708158,
				SSP: 16293776,
				RAM: [][2]uint32{{5183670, 42}, {5183671, 100}, {5183672, 29}, {5183673, 54}, {10238192, 144}, {10238193, 49}, {10238194, 164}, {10238195, 15}, {5183674, 12}, {5183675, 86}},
				Cycles: 14,
			},
		},
		{
			name: "1000 MOVEA.l A1, A7 2e49",
			init: cpuState{
				D:   [8]uint32{1091934947, 1626835711, 688110276, 3339143088, 1288320308, 1331170284, 680636825, 1485806582},
				A:   [7]uint32{1547983385, 3775234729, 1608843719, 3501801170, 2857974928, 2492487691, 578007681},
				PC:  4699910,
				SR:  9994,
				USP: 12246906,
				SSP: 8818602,
				RAM: [][2]uint32{{4699906, 46}, {4699907, 73}, {4699908, 237}, {4699909, 181}, {4699910, 198}, {4699911, 238}},
			},
			want: cpuState{
				D:   [8]uint32{1091934947, 1626835711, 688110276, 3339143088, 1288320308, 1331170284, 680636825, 1485806582},
				A:   [7]uint32{1547983385, 3775234729, 1608843719, 3501801170, 2857974928, 2492487691, 578007681},
				PC:  4699912,
				SR:  9994,
				USP: 12246906,
				SSP: 3775234729,
				RAM: [][2]uint32{{4699906, 46}, {4699907, 73}, {4699908, 237}, {4699909, 181}, {4699910, 198}, {4699911, 238}},
				Cycles: 4,
			},
		},
		{
			name: "1500 MOVEA.l D0, A0 2040",
			init: cpuState{
				D:   [8]uint32{3078108578, 2338095899, 3163000260, 646909649, 1182213857, 3898719858, 213639519, 3059320633},
				A:   [7]uint32{3021398294, 673177316, 3916825224, 864685514, 655834753, 2927496933, 1829025197},
				PC:  8051022,
				SR:  32778,
				USP: 15450696,
				SSP: 4726688,
				RAM: [][2]uint32{{8051018, 32}, {8051019, 64}, {8051020, 195}, {8051021, 125}, {8051022, 190}, {8051023, 199}},
			},
			want: cpuState{
				D:   [8]uint32{3078108578, 2338095899, 3163000260, 646909649, 1182213857, 3898719858, 213639519, 3059320633},
				A:   [7]uint32{3078108578, 673177316, 3916825224, 864685514, 655834753, 2927496933, 1829025197},
				PC:  8051024,
				SR:  32778,
				USP: 15450696,
				SSP: 4726688,
				RAM: [][2]uint32{{8051018, 32}, {8051019, 64}, {8051020, 195}, {8051021, 125}, {8051022, 190}, {8051023, 199}},
				Cycles: 4,
			},
		},
		{
			name: "2000 MOVEA.l (d16, PC), A0 207a",
			init: cpuState{
				D:   [8]uint32{3162276674, 2048924862, 3470990145, 3547869820, 2428934887, 2913378524, 984001236, 853692517},
				A:   [7]uint32{1399720575, 3249995876, 426971079, 951637663, 723793535, 2721366118, 3118872329},
				PC:  2321426,
				SR:  41492,
				USP: 5040616,
				SSP: 4299208,
				RAM: [][2]uint32{{2321422, 32}, {2321423, 122}, {2321424, 225}, {2321425, 174}, {2321426, 232}, {2321427, 213}, {2313662, 46}, {2313663, 63}, {2313664, 155}, {2313665, 22}, {2321428, 27}, {2321429, 188}},
			},
			want: cpuState{
				D:   [8]uint32{3162276674, 2048924862, 3470990145, 3547869820, 2428934887, 2913378524, 984001236, 853692517},
				A:   [7]uint32{775920406, 3249995876, 426971079, 951637663, 723793535, 2721366118, 3118872329},
				PC:  2321430,
				SR:  41492,
				USP: 5040616,
				SSP: 4299208,
				RAM: [][2]uint32{{2321422, 32}, {2321423, 122}, {2321424, 225}, {2321425, 174}, {2321426, 232}, {2321427, 213}, {2313662, 46}, {2313663, 63}, {2313664, 155}, {2313665, 22}, {2321428, 27}, {2321429, 188}},
				Cycles: 16,
			},
		},
		{
			name: "003 MOVEA.l (A7)+, A6 2c5f",
			init: 			cpuState{
				D:   [8]uint32{2954708876, 611640861, 1891139462, 3168968914, 2456124558, 3495777741, 3962307988, 3612209411},
				A:   [7]uint32{810019363, 2832092208, 3383957492, 2007567138, 614188134, 1684865287, 161810590},
				PC:  13040808,
				SR:  9242,
				USP: 8373886,
				SSP: 9024386,
				RAM: [][2]uint32{{13040804, 44}, {13040805, 95}, {13040806, 133}, {13040807, 128}, {9024386, 27}, {9024387, 57}, {9024388, 199}, {9024389, 63}, {13040808, 54}, {13040809, 184}},
			},
			want: 			cpuState{
				D:   [8]uint32{2954708876, 611640861, 1891139462, 3168968914, 2456124558, 3495777741, 3962307988, 3612209411},
				A:   [7]uint32{810019363, 2832092208, 3383957492, 2007567138, 614188134, 1684865287, 456771391},
				PC:  13040810,
				SR:  9242,
				USP: 8373886,
				SSP: 9024390,
				RAM: [][2]uint32{{13040804, 44}, {13040805, 95}, {13040806, 133}, {13040807, 128}, {9024386, 27}, {9024387, 57}, {9024388, 199}, {9024389, 63}, {13040808, 54}, {13040809, 184}},
				Cycles: 12,
			},
		},
		{
			name: "281 MOVEA.l D0, A2 2440",
			init: 			cpuState{
				D:   [8]uint32{159868924, 1079202851, 2003996942, 1364648563, 2050778003, 4023010623, 4231862673, 514978386},
				A:   [7]uint32{796078490, 1604184478, 2262306489, 2108665981, 2359624119, 1473326519, 4279620170},
				PC:  3003052,
				SR:  23,
				USP: 14480504,
				SSP: 5132212,
				RAM: [][2]uint32{{3003048, 36}, {3003049, 64}, {3003050, 48}, {3003051, 209}, {3003052, 55}, {3003053, 137}},
			},
			want: 			cpuState{
				D:   [8]uint32{159868924, 1079202851, 2003996942, 1364648563, 2050778003, 4023010623, 4231862673, 514978386},
				A:   [7]uint32{796078490, 1604184478, 159868924, 2108665981, 2359624119, 1473326519, 4279620170},
				PC:  3003054,
				SR:  23,
				USP: 14480504,
				SSP: 5132212,
				RAM: [][2]uint32{{3003048, 36}, {3003049, 64}, {3003050, 48}, {3003051, 209}, {3003052, 55}, {3003053, 137}},
				Cycles: 4,
			},
		},
		{
			name: "529 MOVEA.l (A2), A4 2852",
			init: 			cpuState{
				D:   [8]uint32{2014340133, 2427142079, 2607794852, 275109942, 935611885, 817276860, 2638376749, 1528725732},
				A:   [7]uint32{4033896145, 3068715040, 2816171848, 3360493897, 2816614377, 4239740483, 2398807766},
				PC:  13333242,
				SR:  1026,
				USP: 5828894,
				SSP: 15484258,
				RAM: [][2]uint32{{13333238, 40}, {13333239, 82}, {13333240, 236}, {13333241, 60}, {14376776, 81}, {14376777, 44}, {14376778, 159}, {14376779, 207}, {13333242, 252}, {13333243, 116}},
			},
			want: 			cpuState{
				D:   [8]uint32{2014340133, 2427142079, 2607794852, 275109942, 935611885, 817276860, 2638376749, 1528725732},
				A:   [7]uint32{4033896145, 3068715040, 2816171848, 3360493897, 1361878991, 4239740483, 2398807766},
				PC:  13333244,
				SR:  1026,
				USP: 5828894,
				SSP: 15484258,
				RAM: [][2]uint32{{13333238, 40}, {13333239, 82}, {13333240, 236}, {13333241, 60}, {14376776, 81}, {14376777, 44}, {14376778, 159}, {14376779, 207}, {13333242, 252}, {13333243, 116}},
				Cycles: 12,
			},
		},
		{
			name: "820 MOVEA.l (d16, A1), A1 2269",
			init: 			cpuState{
				D:   [8]uint32{1139244458, 12366813, 2713149310, 2588455553, 3241232130, 63886111, 2933089, 2249527169},
				A:   [7]uint32{1964230503, 1455620162, 3891411950, 1717879739, 4204735026, 1191765788, 1091666956},
				PC:  381616,
				SR:  266,
				USP: 13139312,
				SSP: 9937634,
				RAM: [][2]uint32{{381612, 34}, {381613, 105}, {381614, 143}, {381615, 44}, {381616, 82}, {381617, 124}, {12750702, 35}, {12750703, 13}, {12750704, 224}, {12750705, 24}, {381618, 70}, {381619, 25}},
			},
			want: 			cpuState{
				D:   [8]uint32{1139244458, 12366813, 2713149310, 2588455553, 3241232130, 63886111, 2933089, 2249527169},
				A:   [7]uint32{1964230503, 588111896, 3891411950, 1717879739, 4204735026, 1191765788, 1091666956},
				PC:  381620,
				SR:  266,
				USP: 13139312,
				SSP: 9937634,
				RAM: [][2]uint32{{381612, 34}, {381613, 105}, {381614, 143}, {381615, 44}, {381616, 82}, {381617, 124}, {12750702, 35}, {12750703, 13}, {12750704, 224}, {12750705, 24}, {381618, 70}, {381619, 25}},
				Cycles: 16,
			},
		},
		{
			name: "1101 MOVEA.l (xxx).w, A1 2278",
			init: 			cpuState{
				D:   [8]uint32{3999090022, 760586182, 3855165909, 46497355, 319787126, 3443132881, 2170508667, 1667160819},
				A:   [7]uint32{3497077597, 944226737, 1291164531, 2264796231, 737075312, 1981153481, 65041717},
				PC:  1344062,
				SR:  8988,
				USP: 13130100,
				SSP: 7863198,
				RAM: [][2]uint32{{1344058, 34}, {1344059, 120}, {1344060, 99}, {1344061, 100}, {1344062, 92}, {1344063, 179}, {25444, 246}, {25445, 124}, {25446, 229}, {25447, 45}, {1344064, 244}, {1344065, 79}},
			},
			want: 			cpuState{
				D:   [8]uint32{3999090022, 760586182, 3855165909, 46497355, 319787126, 3443132881, 2170508667, 1667160819},
				A:   [7]uint32{3497077597, 4135380269, 1291164531, 2264796231, 737075312, 1981153481, 65041717},
				PC:  1344066,
				SR:  8988,
				USP: 13130100,
				SSP: 7863198,
				RAM: [][2]uint32{{1344058, 34}, {1344059, 120}, {1344060, 99}, {1344061, 100}, {1344062, 92}, {1344063, 179}, {25444, 246}, {25445, 124}, {25446, 229}, {25447, 45}, {1344064, 244}, {1344065, 79}},
				Cycles: 16,
			},
		},
		{
			name: "1388 MOVEA.l (A5)+, A5 2a5d",
			init: 			cpuState{
				D:   [8]uint32{2172993451, 2518799495, 1629113679, 51126712, 80105694, 2483164656, 3899920750, 3195011636},
				A:   [7]uint32{1902000444, 3625076577, 755033222, 2707476159, 506437734, 711255390, 3474345922},
				PC:  731884,
				SR:  26,
				USP: 6064832,
				SSP: 4252560,
				RAM: [][2]uint32{{731880, 42}, {731881, 93}, {731882, 194}, {731883, 169}, {6612318, 117}, {6612319, 168}, {6612320, 185}, {6612321, 29}, {731884, 174}, {731885, 207}},
			},
			want: 			cpuState{
				D:   [8]uint32{2172993451, 2518799495, 1629113679, 51126712, 80105694, 2483164656, 3899920750, 3195011636},
				A:   [7]uint32{1902000444, 3625076577, 755033222, 2707476159, 506437734, 1973991709, 3474345922},
				PC:  731886,
				SR:  26,
				USP: 6064832,
				SSP: 4252560,
				RAM: [][2]uint32{{731880, 42}, {731881, 93}, {731882, 194}, {731883, 169}, {6612318, 117}, {6612319, 168}, {6612320, 185}, {6612321, 29}, {731884, 174}, {731885, 207}},
				Cycles: 12,
			},
		},
		{
			name: "1677 MOVEA.l #, A0 207c",
			init: 			cpuState{
				D:   [8]uint32{419879600, 2436741338, 3901001568, 794469128, 717645033, 3534104856, 1792739185, 830876244},
				A:   [7]uint32{789187106, 1899771533, 2158266632, 2380650377, 1193993508, 2847433843, 1140323946},
				PC:  11339720,
				SR:  272,
				USP: 6667310,
				SSP: 13738240,
				RAM: [][2]uint32{{11339716, 32}, {11339717, 124}, {11339718, 194}, {11339719, 183}, {11339720, 214}, {11339721, 37}, {11339722, 156}, {11339723, 183}, {11339724, 10}, {11339725, 99}},
			},
			want: 			cpuState{
				D:   [8]uint32{419879600, 2436741338, 3901001568, 794469128, 717645033, 3534104856, 1792739185, 830876244},
				A:   [7]uint32{3266827813, 1899771533, 2158266632, 2380650377, 1193993508, 2847433843, 1140323946},
				PC:  11339726,
				SR:  272,
				USP: 6667310,
				SSP: 13738240,
				RAM: [][2]uint32{{11339716, 32}, {11339717, 124}, {11339718, 194}, {11339719, 183}, {11339720, 214}, {11339721, 37}, {11339722, 156}, {11339723, 183}, {11339724, 10}, {11339725, 99}},
				Cycles: 12,
			},
		},
		{
			name: "1926 MOVEA.l (A4), A1 2254",
			init: 			cpuState{
				D:   [8]uint32{600257083, 3382332860, 267832945, 2530653580, 470075529, 2963580954, 1614777544, 731818674},
				A:   [7]uint32{4216844278, 3432731746, 1811722898, 3156498136, 3008968004, 2013311998, 738462907},
				PC:  3433226,
				SR:  19,
				USP: 6869560,
				SSP: 3267588,
				RAM: [][2]uint32{{3433222, 34}, {3433223, 84}, {3433224, 144}, {3433225, 225}, {5846340, 22}, {5846341, 175}, {5846342, 78}, {5846343, 30}, {3433226, 172}, {3433227, 243}},
			},
			want: 			cpuState{
				D:   [8]uint32{600257083, 3382332860, 267832945, 2530653580, 470075529, 2963580954, 1614777544, 731818674},
				A:   [7]uint32{4216844278, 380587550, 1811722898, 3156498136, 3008968004, 2013311998, 738462907},
				PC:  3433228,
				SR:  19,
				USP: 6869560,
				SSP: 3267588,
				RAM: [][2]uint32{{3433222, 34}, {3433223, 84}, {3433224, 144}, {3433225, 225}, {5846340, 22}, {5846341, 175}, {5846342, 78}, {5846343, 30}, {3433226, 172}, {3433227, 243}},
				Cycles: 12,
			},
		},
		{
			name: "2203 MOVEA.l -(A4), A7 2e64",
			init: 			cpuState{
				D:   [8]uint32{3785324964, 2718323939, 621552398, 2842590757, 2209098617, 1451420693, 927631083, 2962348851},
				A:   [7]uint32{1892202156, 2069185763, 3439768948, 1836334292, 609590782, 2636117148, 3421166332},
				PC:  319152,
				SR:  3,
				USP: 12044884,
				SSP: 6207662,
				RAM: [][2]uint32{{319148, 46}, {319149, 100}, {319150, 243}, {319151, 78}, {5611002, 23}, {5611003, 230}, {5611004, 235}, {5611005, 57}, {319152, 122}, {319153, 238}},
			},
			want: 			cpuState{
				D:   [8]uint32{3785324964, 2718323939, 621552398, 2842590757, 2209098617, 1451420693, 927631083, 2962348851},
				A:   [7]uint32{1892202156, 2069185763, 3439768948, 1836334292, 609590778, 2636117148, 3421166332},
				PC:  319154,
				SR:  3,
				USP: 401009465,
				SSP: 6207662,
				RAM: [][2]uint32{{319148, 46}, {319149, 100}, {319150, 243}, {319151, 78}, {5611002, 23}, {5611003, 230}, {5611004, 235}, {5611005, 57}, {319152, 122}, {319153, 238}},
				Cycles: 14,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVE_Q(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVE.q -93, D4 78a3",
			init: cpuState{
				D:   [8]uint32{1368507428, 2882228128, 1632881270, 1081181017, 871178762, 3940334615, 891671545, 1052984192},
				A:   [7]uint32{735332410, 3884043659, 3218654234, 432162589, 4181445395, 3141584995, 1571061528},
				PC:  12501994,
				SR:  42497,
				USP: 18276,
				SSP: 15051064,
				RAM: [][2]uint32{{12501990, 120}, {12501991, 163}, {12501992, 170}, {12501993, 38}, {12501994, 184}, {12501995, 23}},
			},
			want: cpuState{
				D:   [8]uint32{1368507428, 2882228128, 1632881270, 1081181017, 4294967203, 3940334615, 891671545, 1052984192},
				A:   [7]uint32{735332410, 3884043659, 3218654234, 432162589, 4181445395, 3141584995, 1571061528},
				PC:  12501996,
				SR:  42504,
				USP: 18276,
				SSP: 15051064,
				RAM: [][2]uint32{{12501990, 120}, {12501991, 163}, {12501992, 170}, {12501993, 38}, {12501994, 184}, {12501995, 23}},
				Cycles: 4,
			},
		},
		{
			name: "500 MOVE.q 119, D4 7877",
			init: cpuState{
				D:   [8]uint32{458313327, 3780534870, 3170911138, 1563741514, 218997239, 3524066120, 2604764071, 1723996091},
				A:   [7]uint32{420463870, 208527311, 3841066439, 3183619664, 850233369, 3277272206, 810198522},
				PC:  4372406,
				SR:  33818,
				USP: 2126350,
				SSP: 3568646,
				RAM: [][2]uint32{{4372402, 120}, {4372403, 119}, {4372404, 18}, {4372405, 38}, {4372406, 227}, {4372407, 4}},
			},
			want: cpuState{
				D:   [8]uint32{458313327, 3780534870, 3170911138, 1563741514, 119, 3524066120, 2604764071, 1723996091},
				A:   [7]uint32{420463870, 208527311, 3841066439, 3183619664, 850233369, 3277272206, 810198522},
				PC:  4372408,
				SR:  33808,
				USP: 2126350,
				SSP: 3568646,
				RAM: [][2]uint32{{4372402, 120}, {4372403, 119}, {4372404, 18}, {4372405, 38}, {4372406, 227}, {4372407, 4}},
				Cycles: 4,
			},
		},
		{
			name: "1000 MOVE.q -52, D5 7acc",
			init: cpuState{
				D:   [8]uint32{1868207989, 3766932103, 3294517578, 2952822451, 3708992836, 1042142864, 3115669019, 3660739159},
				A:   [7]uint32{2487367538, 4243622812, 3988772480, 11777684, 624548449, 394735097, 1088227876},
				PC:  12961374,
				SR:  34059,
				USP: 12436056,
				SSP: 9978614,
				RAM: [][2]uint32{{12961370, 122}, {12961371, 204}, {12961372, 233}, {12961373, 95}, {12961374, 222}, {12961375, 157}},
			},
			want: cpuState{
				D:   [8]uint32{1868207989, 3766932103, 3294517578, 2952822451, 3708992836, 4294967244, 3115669019, 3660739159},
				A:   [7]uint32{2487367538, 4243622812, 3988772480, 11777684, 624548449, 394735097, 1088227876},
				PC:  12961376,
				SR:  34056,
				USP: 12436056,
				SSP: 9978614,
				RAM: [][2]uint32{{12961370, 122}, {12961371, 204}, {12961372, 233}, {12961373, 95}, {12961374, 222}, {12961375, 157}},
				Cycles: 4,
			},
		},
		{
			name: "1500 MOVE.q -31, D6 7ce1",
			init: cpuState{
				D:   [8]uint32{1521990852, 4179550600, 1089337311, 1028264849, 3584439129, 2850961317, 230696653, 2863892606},
				A:   [7]uint32{1427755310, 4293016860, 2642974985, 1432945498, 4137723842, 2431878191, 3270739455},
				PC:  4874586,
				SR:  9222,
				USP: 7645828,
				SSP: 9930624,
				RAM: [][2]uint32{{4874582, 124}, {4874583, 225}, {4874584, 187}, {4874585, 203}, {4874586, 140}, {4874587, 170}},
			},
			want: cpuState{
				D:   [8]uint32{1521990852, 4179550600, 1089337311, 1028264849, 3584439129, 2850961317, 4294967265, 2863892606},
				A:   [7]uint32{1427755310, 4293016860, 2642974985, 1432945498, 4137723842, 2431878191, 3270739455},
				PC:  4874588,
				SR:  9224,
				USP: 7645828,
				SSP: 9930624,
				RAM: [][2]uint32{{4874582, 124}, {4874583, 225}, {4874584, 187}, {4874585, 203}, {4874586, 140}, {4874587, 170}},
				Cycles: 4,
			},
		},
		{
			name: "2000 MOVE.q -78, D3 76b2",
			init: cpuState{
				D:   [8]uint32{196024424, 1524372816, 1403710452, 3706075262, 3137803408, 2514497733, 2714373213, 3371962843},
				A:   [7]uint32{1538551958, 1556695366, 3512362196, 839860817, 3058185247, 52968155, 441013148},
				PC:  3267998,
				SR:  8704,
				USP: 10474830,
				SSP: 11969948,
				RAM: [][2]uint32{{3267994, 118}, {3267995, 178}, {3267996, 192}, {3267997, 10}, {3267998, 225}, {3267999, 201}},
			},
			want: cpuState{
				D:   [8]uint32{196024424, 1524372816, 1403710452, 4294967218, 3137803408, 2514497733, 2714373213, 3371962843},
				A:   [7]uint32{1538551958, 1556695366, 3512362196, 839860817, 3058185247, 52968155, 441013148},
				PC:  3268000,
				SR:  8712,
				USP: 10474830,
				SSP: 11969948,
				RAM: [][2]uint32{{3267994, 118}, {3267995, 178}, {3267996, 192}, {3267997, 10}, {3267998, 225}, {3267999, 201}},
				Cycles: 4,
			},
		},
		{
			name: "001 MOVE.q 79, D4 784f",
			init: 			cpuState{
				D:   [8]uint32{1896867670, 1551827733, 1535735577, 2848427633, 645518335, 4256521667, 3752437885, 1203224285},
				A:   [7]uint32{2678977727, 2501037656, 147728148, 1765878413, 2542336385, 2864645642, 4031900532},
				PC:  8833644,
				SR:  10009,
				USP: 8454454,
				SSP: 15723100,
				RAM: [][2]uint32{{8833640, 120}, {8833641, 79}, {8833642, 170}, {8833643, 217}, {8833644, 69}, {8833645, 130}},
			},
			want: 			cpuState{
				D:   [8]uint32{1896867670, 1551827733, 1535735577, 2848427633, 79, 4256521667, 3752437885, 1203224285},
				A:   [7]uint32{2678977727, 2501037656, 147728148, 1765878413, 2542336385, 2864645642, 4031900532},
				PC:  8833646,
				SR:  10000,
				USP: 8454454,
				SSP: 15723100,
				RAM: [][2]uint32{{8833640, 120}, {8833641, 79}, {8833642, 170}, {8833643, 217}, {8833644, 69}, {8833645, 130}},
				Cycles: 4,
			},
		},
		{
			name: "274 MOVE.q 89, D1 7259",
			init: 			cpuState{
				D:   [8]uint32{4073322462, 3827146830, 1897794331, 892800486, 2579181137, 3355822470, 1777264478, 1322219385},
				A:   [7]uint32{259729150, 2018987982, 2360981826, 2495918359, 480614004, 764344104, 3240603891},
				PC:  11257500,
				SR:  10010,
				USP: 3766314,
				SSP: 8176724,
				RAM: [][2]uint32{{11257496, 114}, {11257497, 89}, {11257498, 157}, {11257499, 208}, {11257500, 7}, {11257501, 219}},
			},
			want: 			cpuState{
				D:   [8]uint32{4073322462, 89, 1897794331, 892800486, 2579181137, 3355822470, 1777264478, 1322219385},
				A:   [7]uint32{259729150, 2018987982, 2360981826, 2495918359, 480614004, 764344104, 3240603891},
				PC:  11257502,
				SR:  10000,
				USP: 3766314,
				SSP: 8176724,
				RAM: [][2]uint32{{11257496, 114}, {11257497, 89}, {11257498, 157}, {11257499, 208}, {11257500, 7}, {11257501, 219}},
				Cycles: 4,
			},
		},
		{
			name: "540 MOVE.q -114, D6 7c8e",
			init: 			cpuState{
				D:   [8]uint32{1673775839, 1790977265, 518704391, 480121529, 3589180981, 2727831419, 1506079006, 422933654},
				A:   [7]uint32{1404536429, 501272824, 2337305256, 720813930, 1463010115, 3948484994, 2812142720},
				PC:  8546964,
				SR:  9230,
				USP: 10225332,
				SSP: 7634282,
				RAM: [][2]uint32{{8546960, 124}, {8546961, 142}, {8546962, 203}, {8546963, 91}, {8546964, 194}, {8546965, 162}},
			},
			want: 			cpuState{
				D:   [8]uint32{1673775839, 1790977265, 518704391, 480121529, 3589180981, 2727831419, 4294967182, 422933654},
				A:   [7]uint32{1404536429, 501272824, 2337305256, 720813930, 1463010115, 3948484994, 2812142720},
				PC:  8546966,
				SR:  9224,
				USP: 10225332,
				SSP: 7634282,
				RAM: [][2]uint32{{8546960, 124}, {8546961, 142}, {8546962, 203}, {8546963, 91}, {8546964, 194}, {8546965, 162}},
				Cycles: 4,
			},
		},
		{
			name: "825 MOVE.q -21, D5 7aeb",
			init: 			cpuState{
				D:   [8]uint32{2620946682, 1448063611, 3179171521, 1050653538, 886013394, 39372781, 4131753263, 1710637670},
				A:   [7]uint32{4234738830, 2897489084, 1866271765, 3071601123, 1300524837, 175545510, 881000334},
				PC:  11577540,
				SR:  1813,
				USP: 5156698,
				SSP: 7259326,
				RAM: [][2]uint32{{11577536, 122}, {11577537, 235}, {11577538, 125}, {11577539, 167}, {11577540, 80}, {11577541, 4}},
			},
			want: 			cpuState{
				D:   [8]uint32{2620946682, 1448063611, 3179171521, 1050653538, 886013394, 4294967275, 4131753263, 1710637670},
				A:   [7]uint32{4234738830, 2897489084, 1866271765, 3071601123, 1300524837, 175545510, 881000334},
				PC:  11577542,
				SR:  1816,
				USP: 5156698,
				SSP: 7259326,
				RAM: [][2]uint32{{11577536, 122}, {11577537, 235}, {11577538, 125}, {11577539, 167}, {11577540, 80}, {11577541, 4}},
				Cycles: 4,
			},
		},
		{
			name: "1119 MOVE.q -102, D7 7e9a",
			init: 			cpuState{
				D:   [8]uint32{2065075976, 1756734214, 2492950333, 1209263364, 808725426, 1909855401, 302821676, 1554050983},
				A:   [7]uint32{2938547907, 3504600486, 785562324, 3334486297, 989869213, 1992482895, 1078952372},
				PC:  1443532,
				SR:  1546,
				USP: 12820296,
				SSP: 4564766,
				RAM: [][2]uint32{{1443528, 126}, {1443529, 154}, {1443530, 9}, {1443531, 67}, {1443532, 228}, {1443533, 41}},
			},
			want: 			cpuState{
				D:   [8]uint32{2065075976, 1756734214, 2492950333, 1209263364, 808725426, 1909855401, 302821676, 4294967194},
				A:   [7]uint32{2938547907, 3504600486, 785562324, 3334486297, 989869213, 1992482895, 1078952372},
				PC:  1443534,
				SR:  1544,
				USP: 12820296,
				SSP: 4564766,
				RAM: [][2]uint32{{1443528, 126}, {1443529, 154}, {1443530, 9}, {1443531, 67}, {1443532, 228}, {1443533, 41}},
				Cycles: 4,
			},
		},
		{
			name: "1407 MOVE.q 36, D4 7824",
			init: 			cpuState{
				D:   [8]uint32{677144588, 3816700583, 4002336079, 3299324691, 27618815, 3950474389, 3032939782, 3013110446},
				A:   [7]uint32{1015036801, 145613314, 649739575, 3358905713, 1754797789, 864279075, 983504746},
				PC:  10389936,
				SR:  9492,
				USP: 5427048,
				SSP: 5884144,
				RAM: [][2]uint32{{10389932, 120}, {10389933, 36}, {10389934, 39}, {10389935, 157}, {10389936, 24}, {10389937, 136}},
			},
			want: 			cpuState{
				D:   [8]uint32{677144588, 3816700583, 4002336079, 3299324691, 36, 3950474389, 3032939782, 3013110446},
				A:   [7]uint32{1015036801, 145613314, 649739575, 3358905713, 1754797789, 864279075, 983504746},
				PC:  10389938,
				SR:  9488,
				USP: 5427048,
				SSP: 5884144,
				RAM: [][2]uint32{{10389932, 120}, {10389933, 36}, {10389934, 39}, {10389935, 157}, {10389936, 24}, {10389937, 136}},
				Cycles: 4,
			},
		},
		{
			name: "1682 MOVE.q 113, D7 7e71",
			init: 			cpuState{
				D:   [8]uint32{1473155565, 956522615, 3502298333, 1065130898, 3426051033, 2059882058, 4041363523, 742137342},
				A:   [7]uint32{841439441, 2976465675, 323001982, 2067775596, 995692016, 3379166660, 1566482690},
				PC:  15827996,
				SR:  259,
				USP: 7732920,
				SSP: 4026648,
				RAM: [][2]uint32{{15827992, 126}, {15827993, 113}, {15827994, 42}, {15827995, 35}, {15827996, 186}, {15827997, 218}},
			},
			want: 			cpuState{
				D:   [8]uint32{1473155565, 956522615, 3502298333, 1065130898, 3426051033, 2059882058, 4041363523, 113},
				A:   [7]uint32{841439441, 2976465675, 323001982, 2067775596, 995692016, 3379166660, 1566482690},
				PC:  15827998,
				SR:  256,
				USP: 7732920,
				SSP: 4026648,
				RAM: [][2]uint32{{15827992, 126}, {15827993, 113}, {15827994, 42}, {15827995, 35}, {15827996, 186}, {15827997, 218}},
				Cycles: 4,
			},
		},
		{
			name: "1933 MOVE.q 10, D4 780a",
			init: 			cpuState{
				D:   [8]uint32{2203215498, 2392860454, 1709017659, 535730110, 2395105990, 3515167040, 2585057452, 2011935505},
				A:   [7]uint32{2824032518, 2630323040, 491034904, 2046466978, 604532705, 2795314691, 4112647764},
				PC:  15393218,
				SR:  5,
				USP: 7835870,
				SSP: 9903094,
				RAM: [][2]uint32{{15393214, 120}, {15393215, 10}, {15393216, 140}, {15393217, 63}, {15393218, 172}, {15393219, 190}},
			},
			want: 			cpuState{
				D:   [8]uint32{2203215498, 2392860454, 1709017659, 535730110, 10, 3515167040, 2585057452, 2011935505},
				A:   [7]uint32{2824032518, 2630323040, 491034904, 2046466978, 604532705, 2795314691, 4112647764},
				PC:  15393220,
				SR:  0,
				USP: 7835870,
				SSP: 9903094,
				RAM: [][2]uint32{{15393214, 120}, {15393215, 10}, {15393216, 140}, {15393217, 63}, {15393218, 172}, {15393219, 190}},
				Cycles: 4,
			},
		},
		{
			name: "2208 MOVE.q 86, D6 7c56",
			init: 			cpuState{
				D:   [8]uint32{1858968495, 278080407, 1252790052, 1135223449, 1068450769, 4046287996, 1496016217, 363322234},
				A:   [7]uint32{1438793655, 1851026576, 2549795197, 2239567399, 2721678089, 54938797, 2999831784},
				PC:  3960232,
				SR:  9233,
				USP: 405928,
				SSP: 4390450,
				RAM: [][2]uint32{{3960228, 124}, {3960229, 86}, {3960230, 68}, {3960231, 13}, {3960232, 20}, {3960233, 204}},
			},
			want: 			cpuState{
				D:   [8]uint32{1858968495, 278080407, 1252790052, 1135223449, 1068450769, 4046287996, 86, 363322234},
				A:   [7]uint32{1438793655, 1851026576, 2549795197, 2239567399, 2721678089, 54938797, 2999831784},
				PC:  3960234,
				SR:  9232,
				USP: 405928,
				SSP: 4390450,
				RAM: [][2]uint32{{3960228, 124}, {3960229, 86}, {3960230, 68}, {3960231, 13}, {3960232, 20}, {3960233, 204}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEM_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEM.w #, (d16, A7) 48af",
			init: cpuState{
				D:   [8]uint32{2516854248, 1224448443, 2738172433, 749428807, 51877730, 1992372080, 3018445573, 714955254},
				A:   [7]uint32{415175827, 788158023, 3093381556, 2582546957, 143558775, 2086406636, 1268185199},
				PC:  6601746,
				SR:  2,
				USP: 15833890,
				SSP: 7443558,
				RAM: [][2]uint32{{6601742, 72}, {6601743, 175}, {6601744, 138}, {6601745, 120}, {6601746, 7}, {6601747, 15}, {6601748, 247}, {6601749, 213}, {12, 80}, {13, 172}, {14, 165}, {15, 230}, {11314662, 112}, {11314663, 32}, {11314664, 169}, {11314665, 217}},
			},
			want: cpuState{
				D:      [8]uint32{2516854248, 1224448443, 2738172433, 749428807, 51877730, 1992372080, 3018445573, 714955254},
				A:      [7]uint32{415175827, 788158023, 3093381556, 2582546957, 143558775, 2086406636, 1268185199},
				PC:     1353491946,
				SR:     8194,
				USP:    15833890,
				SSP:    7443544,
				RAM:    [][2]uint32{{6601742, 72}, {6601743, 175}, {6601744, 138}, {6601745, 120}, {6601746, 7}, {6601747, 15}, {6601748, 247}, {6601749, 213}, {7443556, 188}, {7443557, 22}, {7443552, 0}, {7443553, 2}, {7443554, 0}, {7443555, 100}, {7443550, 72}, {7443551, 175}, {7443548, 162}, {7443549, 49}, {7443544, 72}, {7443545, 161}, {7443546, 0}, {7443547, 241}, {12, 80}, {13, 172}, {14, 165}, {15, 230}, {11314662, 112}, {11314663, 32}, {11314664, 169}, {11314665, 217}},
				Halted: true,
			},
		},
		{
			name: "500 MOVEM.w (A7)+, # 4c9f",
			init: cpuState{
				D:   [8]uint32{1053240831, 4005744155, 1176679930, 2512127795, 662228390, 285919194, 3995030301, 4164488118},
				A:   [7]uint32{2066354854, 536296495, 4005657645, 3300326240, 520434363, 969476914, 3795560664},
				PC:  8883564,
				SR:  1811,
				USP: 3106998,
				SSP: 14098252,
				RAM: [][2]uint32{{8883560, 76}, {8883561, 159}, {8883562, 179}, {8883563, 125}, {8883564, 62}, {8883565, 76}, {3106998, 226}, {3106999, 78}, {3107000, 211}, {3107001, 226}, {3107002, 59}, {3107003, 43}, {3107004, 212}, {3107005, 115}, {3107006, 144}, {3107007, 13}, {3107008, 125}, {3107009, 249}, {3107010, 1}, {3107011, 58}, {3107012, 8}, {3107013, 102}, {3107014, 96}, {3107015, 30}, {3107016, 181}, {3107017, 115}, {3107018, 130}, {3107019, 186}, {3107020, 252}, {3107021, 138}, {8883566, 213}, {8883567, 77}},
			},
			want: cpuState{
				D:   [8]uint32{4294959694, 4005744155, 4294956002, 15147, 4294956147, 4294938637, 32249, 4164488118},
				A:   [7]uint32{314, 2150, 4005657645, 3300326240, 24606, 4294948211, 3795560664},
				PC:  8883568,
				SR:  1811,
				USP: 3107020,
				SSP: 14098252,
				RAM: [][2]uint32{{8883560, 76}, {8883561, 159}, {8883562, 179}, {8883563, 125}, {8883564, 62}, {8883565, 76}, {3106998, 226}, {3106999, 78}, {3107000, 211}, {3107001, 226}, {3107002, 59}, {3107003, 43}, {3107004, 212}, {3107005, 115}, {3107006, 144}, {3107007, 13}, {3107008, 125}, {3107009, 249}, {3107010, 1}, {3107011, 58}, {3107012, 8}, {3107013, 102}, {3107014, 96}, {3107015, 30}, {3107016, 181}, {3107017, 115}, {3107018, 130}, {3107019, 186}, {3107020, 252}, {3107021, 138}, {8883566, 213}, {8883567, 77}},
				Cycles: 56,
			},
		},
		{
			name: "1000 MOVEM.w (A6)+, # 4c9e",
			init: cpuState{
				D:   [8]uint32{4105608420, 696610705, 3042460131, 1016764949, 882012821, 2337095667, 615150736, 2948104108},
				A:   [7]uint32{122976785, 2173134499, 1008674440, 1823559609, 171019523, 1610608308, 2178653353},
				PC:  5074020,
				SR:  9736,
				USP: 11435678,
				SSP: 3800184,
				RAM: [][2]uint32{{5074016, 76}, {5074017, 158}, {5074018, 222}, {5074019, 123}, {5074020, 42}, {5074021, 108}, {12, 205}, {13, 128}, {14, 130}, {15, 210}, {8422098, 17}, {8422099, 176}, {8422100, 66}, {8422101, 25}},
			},
			want: cpuState{
				D:      [8]uint32{4105608420, 696610705, 3042460131, 1016764949, 882012821, 2337095667, 615150736, 2948104108},
				A:      [7]uint32{122976785, 2173134499, 1008674440, 1823559609, 171019523, 1610608308, 2178653353},
				PC:     3447751382,
				SR:     9736,
				USP:    11435678,
				SSP:    3800170,
				RAM:    [][2]uint32{{5074016, 76}, {5074017, 158}, {5074018, 222}, {5074019, 123}, {5074020, 42}, {5074021, 108}, {3800182, 108}, {3800183, 102}, {3800178, 38}, {3800179, 8}, {3800180, 0}, {3800181, 77}, {3800176, 76}, {3800177, 158}, {3800174, 156}, {3800175, 169}, {3800170, 76}, {3800171, 149}, {3800172, 129}, {3800173, 219}, {12, 205}, {13, 128}, {14, 130}, {15, 210}, {8422098, 17}, {8422099, 176}, {8422100, 66}, {8422101, 25}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVEM.w #, (d16, A4) 48ac",
			init: cpuState{
				D:   [8]uint32{1314060798, 2950439225, 183557897, 477034068, 650946571, 4230825535, 560573871, 3945766741},
				A:   [7]uint32{1048182785, 2301989440, 1563872275, 3666447312, 188801213, 3510649371, 3610024883},
				PC:  7571286,
				SR:  41752,
				USP: 8415520,
				SSP: 892146,
				RAM: [][2]uint32{{7571282, 72}, {7571283, 172}, {7571284, 84}, {7571285, 39}, {7571286, 226}, {7571287, 93}, {7571288, 99}, {7571289, 166}, {7571290, 165}, {7571291, 197}},
			},
			want: cpuState{
				D:   [8]uint32{1314060798, 2950439225, 183557897, 477034068, 650946571, 4230825535, 560573871, 3945766741},
				A:   [7]uint32{1048182785, 2301989440, 1563872275, 3666447312, 188801213, 3510649371, 3610024883},
				PC:  7571292,
				SR:  41752,
				USP: 8415520,
				SSP: 892146,
				RAM: [][2]uint32{{7571282, 72}, {7571283, 172}, {7571284, 84}, {7571285, 39}, {7571286, 226}, {7571287, 93}, {7571288, 99}, {7571289, 166}, {4244250, 249}, {4244251, 254}, {4244252, 33}, {4244253, 57}, {4244254, 223}, {4244255, 9}, {4244256, 70}, {4244257, 63}, {4244258, 204}, {4244259, 19}, {4244260, 224}, {4244261, 189}, {4244262, 155}, {4244263, 179}, {7571290, 165}, {7571291, 197}},
				Cycles: 40,
			},
		},
		{
			name: "2000 MOVEM.w #, (d16, A3) 48ab",
			init: cpuState{
				D:   [8]uint32{2671031741, 1971874210, 402214233, 2823559196, 2151519561, 1787822396, 610795617, 1380132743},
				A:   [7]uint32{3627486763, 2278475029, 4168261540, 777262106, 1355993625, 2460508507, 3486221675},
				PC:  8114078,
				SR:  272,
				USP: 16051408,
				SSP: 9970790,
				RAM: [][2]uint32{{8114074, 72}, {8114075, 171}, {8114076, 86}, {8114077, 29}, {8114078, 142}, {8114079, 246}, {8114080, 246}, {8114081, 142}, {8114082, 233}, {8114083, 38}},
			},
			want: cpuState{
				D:   [8]uint32{2671031741, 1971874210, 402214233, 2823559196, 2151519561, 1787822396, 610795617, 1380132743},
				A:   [7]uint32{3627486763, 2278475029, 4168261540, 777262106, 1355993625, 2460508507, 3486221675},
				PC:  8114084,
				SR:  272,
				USP: 16051408,
				SSP: 9970790,
				RAM: [][2]uint32{{8114074, 72}, {8114075, 171}, {8114076, 86}, {8114077, 29}, {8114078, 142}, {8114079, 246}, {8114080, 246}, {8114081, 142}, {5481232, 181}, {5481233, 189}, {5481234, 77}, {5481235, 89}, {5481236, 24}, {5481237, 28}, {5481238, 149}, {5481239, 73}, {5481240, 197}, {5481241, 21}, {5481242, 159}, {5481243, 164}, {5481244, 210}, {5481245, 25}, {5481246, 133}, {5481247, 107}, {8114082, 233}, {8114083, 38}},
				Cycles: 44,
			},
		},
		{
			name: "002 MOVEM.w (d8, A2, Xn), # 4cb2",
			init: 			cpuState{
				D:   [8]uint32{2106205061, 3995260757, 1530310365, 4114391960, 2360575518, 4123367915, 1339779050, 3000074271},
				A:   [7]uint32{2961113596, 646028355, 3319538101, 3160422352, 623104686, 4242173278, 937983776},
				PC:  13736378,
				SR:  8715,
				USP: 4220130,
				SSP: 15955762,
				RAM: [][2]uint32{{13736374, 76}, {13736375, 178}, {13736376, 154}, {13736377, 173}, {13736378, 148}, {13736379, 234}, {13736380, 229}, {13736381, 2}, {14400994, 136}, {14400995, 124}, {14400996, 24}, {14400997, 94}, {14400998, 27}, {14400999, 97}, {14401000, 185}, {14401001, 87}, {14401002, 120}, {14401003, 228}, {14401004, 255}, {14401005, 237}, {14401006, 139}, {14401007, 8}, {14401008, 68}, {14401009, 138}, {14401010, 238}, {14401011, 18}, {14401012, 205}, {14401013, 47}, {13736382, 110}, {13736383, 104}},
			},
			want: 			cpuState{
				D:   [8]uint32{4294936700, 3995260757, 6238, 7009, 2360575518, 4294949207, 1339779050, 30948},
				A:   [7]uint32{2961113596, 4294967277, 3319538101, 4294937352, 17546, 4242173278, 937983776},
				PC:  13736384,
				SR:  8715,
				USP: 4220130,
				SSP: 4294962706,
				RAM: [][2]uint32{{13736374, 76}, {13736375, 178}, {13736376, 154}, {13736377, 173}, {13736378, 148}, {13736379, 234}, {13736380, 229}, {13736381, 2}, {14400994, 136}, {14400995, 124}, {14400996, 24}, {14400997, 94}, {14400998, 27}, {14400999, 97}, {14401000, 185}, {14401001, 87}, {14401002, 120}, {14401003, 228}, {14401004, 255}, {14401005, 237}, {14401006, 139}, {14401007, 8}, {14401008, 68}, {14401009, 138}, {14401010, 238}, {14401011, 18}, {14401012, 205}, {14401013, 47}, {13736382, 110}, {13736383, 104}},
				Cycles: 54,
			},
		},
		{
			name: "301 MOVEM.w (xxx).l, # 4cb9",
			init: 			cpuState{
				D:   [8]uint32{392121632, 2236473549, 34841448, 424655477, 1383174576, 2509105577, 4180661378, 2718288877},
				A:   [7]uint32{3220826092, 2305022166, 2951721794, 3563171117, 482138105, 3325297021, 3900112378},
				PC:  8822684,
				SR:  8734,
				USP: 13997780,
				SSP: 7936514,
				RAM: [][2]uint32{{8822680, 76}, {8822681, 185}, {8822682, 216}, {8822683, 196}, {8822684, 138}, {8822685, 220}, {8822686, 194}, {8822687, 216}, {8822688, 143}, {8822689, 250}, {14467800, 133}, {14467801, 85}, {14467802, 215}, {14467803, 167}, {14467804, 102}, {14467805, 19}, {14467806, 217}, {14467807, 98}, {14467808, 107}, {14467809, 40}, {14467810, 52}, {14467811, 13}, {14467812, 227}, {14467813, 59}, {14467814, 116}, {14467815, 87}, {8822690, 50}, {8822691, 84}},
			},
			want: 			cpuState{
				D:   [8]uint32{392121632, 2236473549, 4294935893, 424655477, 1383174576, 2509105577, 4294956967, 26131},
				A:   [7]uint32{3220826092, 2305022166, 2951721794, 4294957410, 27432, 3325297021, 13325},
				PC:  8822692,
				SR:  8734,
				USP: 13997780,
				SSP: 4294959931,
				RAM: [][2]uint32{{8822680, 76}, {8822681, 185}, {8822682, 216}, {8822683, 196}, {8822684, 138}, {8822685, 220}, {8822686, 194}, {8822687, 216}, {8822688, 143}, {8822689, 250}, {14467800, 133}, {14467801, 85}, {14467802, 215}, {14467803, 167}, {14467804, 102}, {14467805, 19}, {14467806, 217}, {14467807, 98}, {14467808, 107}, {14467809, 40}, {14467810, 52}, {14467811, 13}, {14467812, 227}, {14467813, 59}, {14467814, 116}, {14467815, 87}, {8822690, 50}, {8822691, 84}},
				Cycles: 48,
			},
		},
		{
			name: "559 MOVEM.w #, (A4) 4894",
			init: 			cpuState{
				D:   [8]uint32{2662374215, 815032120, 1818247405, 3109924802, 3183311498, 2541438921, 1901280263, 2472227864},
				A:   [7]uint32{218308369, 568821824, 2194879299, 1896626940, 2366122254, 343069145, 4137014938},
				PC:  5009474,
				SR:  8473,
				USP: 12689340,
				SSP: 15032024,
				RAM: [][2]uint32{{5009470, 72}, {5009471, 148}, {5009472, 174}, {5009473, 141}, {5009474, 60}, {5009475, 133}, {5009476, 110}, {5009477, 7}},
			},
			want: 			cpuState{
				D:   [8]uint32{2662374215, 815032120, 1818247405, 3109924802, 3183311498, 2541438921, 1901280263, 2472227864},
				A:   [7]uint32{218308369, 568821824, 2194879299, 1896626940, 2366122254, 343069145, 4137014938},
				PC:  5009478,
				SR:  8473,
				USP: 12689340,
				SSP: 15032024,
				RAM: [][2]uint32{{5009470, 72}, {5009471, 148}, {5009472, 174}, {5009473, 141}, {5009474, 60}, {5009475, 133}, {534798, 155}, {534799, 71}, {534800, 64}, {534801, 237}, {534802, 175}, {534803, 194}, {534804, 52}, {534805, 24}, {534806, 136}, {534807, 64}, {534808, 51}, {534809, 67}, {534810, 58}, {534811, 252}, {534812, 209}, {534813, 217}, {534814, 94}, {534815, 216}, {5009476, 110}, {5009477, 7}},
				Cycles: 44,
			},
		},
		{
			name: "840 MOVEM.w #, -(A2) 48a2",
			init: 			cpuState{
				D:   [8]uint32{885410069, 49336781, 646637885, 2130198016, 382868986, 2798022177, 3628341798, 1639254552},
				A:   [7]uint32{716626712, 2653758231, 30795654, 1240179477, 2253788426, 913077224, 350226272},
				PC:  1216252,
				SR:  9738,
				USP: 16275668,
				SSP: 619260,
				RAM: [][2]uint32{{1216248, 72}, {1216249, 162}, {1216250, 158}, {1216251, 161}, {1216252, 122}, {1216253, 193}, {1216254, 156}, {1216255, 40}},
			},
			want: 			cpuState{
				D:   [8]uint32{885410069, 49336781, 646637885, 2130198016, 382868986, 2798022177, 3628341798, 1639254552},
				A:   [7]uint32{716626712, 2653758231, 30795638, 1240179477, 2253788426, 913077224, 350226272},
				PC:  1216256,
				SR:  9738,
				USP: 16275668,
				SSP: 619260,
				RAM: [][2]uint32{{1216248, 72}, {1216249, 162}, {1216250, 158}, {1216251, 161}, {1216252, 122}, {1216253, 193}, {14018436, 114}, {14018437, 252}, {14018434, 231}, {14018435, 134}, {14018432, 219}, {14018433, 24}, {14018430, 26}, {14018431, 38}, {14018428, 110}, {14018429, 33}, {14018426, 29}, {14018427, 250}, {14018424, 62}, {14018425, 0}, {14018422, 73}, {14018423, 21}, {1216254, 156}, {1216255, 40}},
				Cycles: 40,
			},
		},
		{
			name: "1155 MOVEM.w (d8, A5, Xn), # 4cb5",
			init: 			cpuState{
				D:   [8]uint32{3913987338, 4202411620, 124452611, 617707867, 3627645040, 908216892, 3070228709, 376670759},
				A:   [7]uint32{594296165, 69810860, 387655603, 2483953312, 1238266429, 909886190, 3985610628},
				PC:  3137306,
				SR:  789,
				USP: 14940270,
				SSP: 13985594,
				RAM: [][2]uint32{{3137302, 76}, {3137303, 181}, {3137304, 124}, {3137305, 237}, {3137306, 150}, {3137307, 180}, {3137308, 189}, {3137309, 100}, {3931470, 213}, {3931471, 196}, {3931472, 51}, {3931473, 245}, {3931474, 12}, {3931475, 17}, {3931476, 241}, {3931477, 126}, {3931478, 117}, {3931479, 152}, {3931480, 18}, {3931481, 130}, {3931482, 17}, {3931483, 95}, {3931484, 27}, {3931485, 9}, {3931486, 255}, {3931487, 9}, {3931488, 38}, {3931489, 121}, {3931490, 169}, {3931491, 121}, {3931492, 210}, {3931493, 187}, {3137310, 115}, {3137311, 116}},
			},
			want: 			cpuState{
				D:   [8]uint32{4294956484, 4202411620, 13301, 3089, 3627645040, 4294963582, 30104, 4738},
				A:   [7]uint32{594296165, 69810860, 4447, 6921, 4294967049, 9849, 4294945145},
				PC:  3137312,
				SR:  789,
				USP: 14940270,
				SSP: 13985594,
				RAM: [][2]uint32{{3137302, 76}, {3137303, 181}, {3137304, 124}, {3137305, 237}, {3137306, 150}, {3137307, 180}, {3137308, 189}, {3137309, 100}, {3931470, 213}, {3931471, 196}, {3931472, 51}, {3931473, 245}, {3931474, 12}, {3931475, 17}, {3931476, 241}, {3931477, 126}, {3931478, 117}, {3931479, 152}, {3931480, 18}, {3931481, 130}, {3931482, 17}, {3931483, 95}, {3931484, 27}, {3931485, 9}, {3931486, 255}, {3931487, 9}, {3931488, 38}, {3931489, 121}, {3931490, 169}, {3931491, 121}, {3931492, 210}, {3931493, 187}, {3137310, 115}, {3137311, 116}},
				Cycles: 62,
			},
		},
		{
			name: "1413 MOVEM.w (A7)+, # 4c9f",
			init: 			cpuState{
				D:   [8]uint32{3680610576, 263238348, 356999662, 3128212879, 2859976202, 1095367483, 467094637, 383685987},
				A:   [7]uint32{2457729855, 3963617398, 2625173120, 952180959, 2364266546, 3120169554, 3133736209},
				PC:  15413764,
				SR:  8459,
				USP: 9813786,
				SSP: 13464830,
				RAM: [][2]uint32{{15413760, 76}, {15413761, 159}, {15413762, 86}, {15413763, 248}, {15413764, 32}, {15413765, 69}, {13464830, 108}, {13464831, 169}, {13464832, 132}, {13464833, 189}, {13464834, 176}, {13464835, 131}, {13464836, 25}, {13464837, 221}, {13464838, 140}, {13464839, 39}, {13464840, 190}, {13464841, 218}, {13464842, 127}, {13464843, 58}, {13464844, 18}, {13464845, 17}, {13464846, 188}, {13464847, 5}, {13464848, 100}, {13464849, 242}, {15413766, 231}, {15413767, 239}},
			},
			want: 			cpuState{
				D:   [8]uint32{3680610576, 263238348, 356999662, 27817, 4294935741, 4294946947, 6621, 4294937639},
				A:   [7]uint32{2457729855, 4294950618, 32570, 952180959, 4625, 3120169554, 4294949893},
				PC:  15413768,
				SR:  8459,
				USP: 9813786,
				SSP: 13464848,
				RAM: [][2]uint32{{15413760, 76}, {15413761, 159}, {15413762, 86}, {15413763, 248}, {15413764, 32}, {15413765, 69}, {13464830, 108}, {13464831, 169}, {13464832, 132}, {13464833, 189}, {13464834, 176}, {13464835, 131}, {13464836, 25}, {13464837, 221}, {13464838, 140}, {13464839, 39}, {13464840, 190}, {13464841, 218}, {13464842, 127}, {13464843, 58}, {13464844, 18}, {13464845, 17}, {13464846, 188}, {13464847, 5}, {13464848, 100}, {13464849, 242}, {15413766, 231}, {15413767, 239}},
				Cycles: 48,
			},
		},
		{
			name: "1700 MOVEM.w (A4), # 4c94",
			init: 			cpuState{
				D:   [8]uint32{1028749955, 3665657872, 493044810, 1234563590, 1208263415, 1016634244, 1211371804, 794315784},
				A:   [7]uint32{1805402562, 1662576752, 3737240184, 2054118047, 3751977324, 1430719942, 1987857080},
				PC:  16261078,
				SR:  8973,
				USP: 15385222,
				SSP: 15644762,
				RAM: [][2]uint32{{16261074, 76}, {16261075, 148}, {16261076, 178}, {16261077, 136}, {16261078, 195}, {16261079, 188}, {10658156, 131}, {10658157, 201}, {10658158, 206}, {10658159, 240}, {10658160, 42}, {10658161, 96}, {10658162, 17}, {10658163, 16}, {10658164, 95}, {10658165, 206}, {10658166, 171}, {10658167, 166}, {10658168, 173}, {10658169, 160}, {16261080, 197}, {16261081, 135}},
			},
			want: 			cpuState{
				D:   [8]uint32{1028749955, 3665657872, 493044810, 4294935497, 1208263415, 1016634244, 1211371804, 4294954736},
				A:   [7]uint32{1805402562, 10848, 3737240184, 2054118047, 4368, 24526, 1987857080},
				PC:  16261082,
				SR:  8973,
				USP: 15385222,
				SSP: 4294945702,
				RAM: [][2]uint32{{16261074, 76}, {16261075, 148}, {16261076, 178}, {16261077, 136}, {16261078, 195}, {16261079, 188}, {10658156, 131}, {10658157, 201}, {10658158, 206}, {10658159, 240}, {10658160, 42}, {10658161, 96}, {10658162, 17}, {10658163, 16}, {10658164, 95}, {10658165, 206}, {10658166, 171}, {10658167, 166}, {10658168, 173}, {10658169, 160}, {16261080, 197}, {16261081, 135}},
				Cycles: 36,
			},
		},
		{
			name: "1958 MOVEM.w (A7)+, # 4c9f",
			init: 			cpuState{
				D:   [8]uint32{528923634, 1451343483, 4209621857, 3585947900, 4247563304, 2447569205, 2544100085, 3695479155},
				A:   [7]uint32{3205202914, 3295026705, 292423114, 2875293022, 1329289393, 2258349983, 2458074358},
				PC:  8849136,
				SR:  9225,
				USP: 11609762,
				SSP: 3810678,
				RAM: [][2]uint32{{8849132, 76}, {8849133, 159}, {8849134, 51}, {8849135, 41}, {8849136, 135}, {8849137, 31}, {3810678, 238}, {3810679, 216}, {3810680, 81}, {3810681, 176}, {3810682, 14}, {3810683, 22}, {3810684, 60}, {3810685, 190}, {3810686, 219}, {3810687, 204}, {3810688, 50}, {3810689, 240}, {3810690, 227}, {3810691, 117}, {3810692, 96}, {3810693, 144}, {8849138, 246}, {8849139, 46}},
			},
			want: 			cpuState{
				D:   [8]uint32{4294962904, 1451343483, 4209621857, 20912, 4247563304, 3606, 2544100085, 3695479155},
				A:   [7]uint32{15550, 4294958028, 292423114, 2875293022, 13040, 4294959989, 2458074358},
				PC:  8849140,
				SR:  9225,
				USP: 11609762,
				SSP: 3810692,
				RAM: [][2]uint32{{8849132, 76}, {8849133, 159}, {8849134, 51}, {8849135, 41}, {8849136, 135}, {8849137, 31}, {3810678, 238}, {3810679, 216}, {3810680, 81}, {3810681, 176}, {3810682, 14}, {3810683, 22}, {3810684, 60}, {3810685, 190}, {3810686, 219}, {3810687, 204}, {3810688, 50}, {3810689, 240}, {3810690, 227}, {3810691, 117}, {3810692, 96}, {3810693, 144}, {8849138, 246}, {8849139, 46}},
				Cycles: 40,
			},
		},
		{
			name: "2236 MOVEM.w #, (d8, A3, Xn) 48b3",
			init: 			cpuState{
				D:   [8]uint32{338324564, 3522105830, 2326355312, 1859689364, 1390740344, 3653347515, 2245992049, 3290813975},
				A:   [7]uint32{4169561702, 2927344319, 1109881433, 2899378346, 1252389002, 997555585, 1322396611},
				PC:  11922860,
				SR:  1290,
				USP: 4979118,
				SSP: 6113982,
				RAM: [][2]uint32{{11922856, 72}, {11922857, 179}, {11922858, 24}, {11922859, 12}, {11922860, 132}, {11922861, 64}, {11922862, 218}, {11922863, 210}, {11922864, 243}, {11922865, 106}},
			},
			want: 			cpuState{
				D:   [8]uint32{338324564, 3522105830, 2326355312, 1859689364, 1390740344, 3653347515, 2245992049, 3290813975},
				A:   [7]uint32{4169561702, 2927344319, 1109881433, 2899378346, 1252389002, 997555585, 1322396611},
				PC:  11922866,
				SR:  1290,
				USP: 4979118,
				SSP: 6113982,
				RAM: [][2]uint32{{11922856, 72}, {11922857, 179}, {11922858, 24}, {11922859, 12}, {11922860, 132}, {11922861, 64}, {11922862, 218}, {11922863, 210}, {13727568, 93}, {13727569, 112}, {13727570, 155}, {13727571, 148}, {13727572, 0}, {13727573, 170}, {13727574, 240}, {13727575, 138}, {11922864, 243}, {11922865, 106}},
				Cycles: 30,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEM_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEM.l (A0), # 4cd0",
			init: cpuState{
				D:   [8]uint32{4145974960, 98666609, 4134305615, 2306122646, 3759942418, 2261160881, 4192929536, 495306415},
				A:   [7]uint32{1291678793, 1674217383, 3287716855, 1614216120, 530989899, 1794898052, 3703973272},
				PC:  14353542,
				SR:  8991,
				USP: 590824,
				SSP: 3242804,
				RAM: [][2]uint32{{14353538, 76}, {14353539, 208}, {14353540, 56}, {14353541, 19}, {14353542, 196}, {14353543, 217}, {12, 145}, {13, 154}, {14, 217}, {15, 18}, {10148114, 103}, {10148115, 195}, {10148116, 113}, {10148117, 94}},
			},
			want: cpuState{
				D:      [8]uint32{4145974960, 98666609, 4134305615, 2306122646, 3759942418, 2261160881, 4192929536, 495306415},
				A:      [7]uint32{1291678793, 1674217383, 3287716855, 1614216120, 530989899, 1794898052, 3703973272},
				PC:     2442844438,
				SR:     8991,
				USP:    590824,
				SSP:    3242790,
				RAM:    [][2]uint32{{14353538, 76}, {14353539, 208}, {14353540, 56}, {14353541, 19}, {14353542, 196}, {14353543, 217}, {3242802, 4}, {3242803, 136}, {3242798, 35}, {3242799, 31}, {3242800, 0}, {3242801, 219}, {3242796, 76}, {3242797, 208}, {3242794, 116}, {3242795, 73}, {3242790, 76}, {3242791, 213}, {3242792, 76}, {3242793, 253}, {12, 145}, {13, 154}, {14, 217}, {15, 18}, {10148114, 103}, {10148115, 195}, {10148116, 113}, {10148117, 94}},
				Halted: true,
			},
		},
		{
			name: "500 MOVEM.l (A3)+, # 4cdb",
			init: cpuState{
				D:   [8]uint32{4070833938, 3709473564, 3700992492, 2313386347, 2039239174, 1372578966, 342403102, 997113164},
				A:   [7]uint32{35192696, 4255498477, 4108394088, 4074843058, 350655141, 3324762830, 2991829527},
				PC:  8154406,
				SR:  33285,
				USP: 833468,
				SSP: 183544,
				RAM: [][2]uint32{{8154402, 76}, {8154403, 219}, {8154404, 32}, {8154405, 127}, {8154406, 217}, {8154407, 136}, {14756786, 68}, {14756787, 171}, {14756788, 80}, {14756789, 32}, {14756790, 24}, {14756791, 224}, {14756792, 49}, {14756793, 163}, {14756794, 170}, {14756795, 65}, {14756796, 241}, {14756797, 16}, {14756798, 83}, {14756799, 101}, {14756800, 43}, {14756801, 144}, {14756802, 174}, {14756803, 7}, {14756804, 26}, {14756805, 140}, {14756806, 119}, {14756807, 36}, {14756808, 29}, {14756809, 72}, {14756810, 124}, {14756811, 177}, {14756812, 159}, {14756813, 19}, {14756814, 224}, {14756815, 43}, {14756816, 80}, {14756817, 119}, {14756818, 190}, {14756819, 222}, {8154408, 15}, {8154409, 47}},
			},
			want: cpuState{
				D:   [8]uint32{1152077856, 417345955, 2856448272, 1399139216, 2919701132, 1998855496, 2092015379, 997113164},
				A:   [7]uint32{35192696, 4255498477, 4108394088, 4074843090, 350655141, 3760935031, 2991829527},
				PC:  8154410,
				SR:  33285,
				USP: 833468,
				SSP: 183544,
				RAM: [][2]uint32{{8154402, 76}, {8154403, 219}, {8154404, 32}, {8154405, 127}, {8154406, 217}, {8154407, 136}, {14756786, 68}, {14756787, 171}, {14756788, 80}, {14756789, 32}, {14756790, 24}, {14756791, 224}, {14756792, 49}, {14756793, 163}, {14756794, 170}, {14756795, 65}, {14756796, 241}, {14756797, 16}, {14756798, 83}, {14756799, 101}, {14756800, 43}, {14756801, 144}, {14756802, 174}, {14756803, 7}, {14756804, 26}, {14756805, 140}, {14756806, 119}, {14756807, 36}, {14756808, 29}, {14756809, 72}, {14756810, 124}, {14756811, 177}, {14756812, 159}, {14756813, 19}, {14756814, 224}, {14756815, 43}, {14756816, 80}, {14756817, 119}, {14756818, 190}, {14756819, 222}, {8154408, 15}, {8154409, 47}},
				Cycles: 76,
			},
		},
		{
			name: "1000 MOVEM.l (d8, A4, Xn), # 4cf4",
			init: cpuState{
				D:   [8]uint32{2281808026, 1606278836, 2174335579, 3089282453, 3363370756, 377098347, 369340366, 210301945},
				A:   [7]uint32{792693173, 2816978871, 613038058, 3365325113, 680158747, 2687155925, 3510585527},
				PC:  2006196,
				SR:  268,
				USP: 8304062,
				SSP: 3747552,
				RAM: [][2]uint32{{2006192, 76}, {2006193, 244}, {2006194, 1}, {2006195, 173}, {2006196, 30}, {2006197, 32}, {2006198, 46}, {2006199, 167}, {12, 152}, {13, 174}, {14, 95}, {15, 204}, {11427788, 131}, {11427789, 29}, {11427790, 163}, {11427791, 2}},
			},
			want: cpuState{
				D:      [8]uint32{2281808026, 1606278836, 2174335579, 3089282453, 3363370756, 377098347, 369340366, 210301945},
				A:      [7]uint32{792693173, 2816978871, 613038058, 3365325113, 680158747, 2687155925, 3510585527},
				PC:     2561564624,
				SR:     8460,
				USP:    8304062,
				SSP:    3747538,
				RAM:    [][2]uint32{{2006192, 76}, {2006193, 244}, {2006194, 1}, {2006195, 173}, {2006196, 30}, {2006197, 32}, {2006198, 46}, {2006199, 167}, {3747550, 156}, {3747551, 184}, {3747546, 1}, {3747547, 12}, {3747548, 0}, {3747549, 30}, {3747544, 76}, {3747545, 244}, {3747542, 68}, {3747543, 239}, {3747538, 76}, {3747539, 241}, {3747540, 136}, {3747541, 72}, {12, 152}, {13, 174}, {14, 95}, {15, 204}, {11427788, 131}, {11427789, 29}, {11427790, 163}, {11427791, 2}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVEM.l (A6), # 4cd6",
			init: cpuState{
				D:   [8]uint32{2190334619, 1458758065, 506639552, 346537831, 2825890699, 2533066215, 2402309286, 1989339886},
				A:   [7]uint32{3142083142, 2368339472, 3457690161, 1073553760, 3819079062, 2457336872, 2772183950},
				PC:  16729070,
				SR:  34329,
				USP: 1309746,
				SSP: 10868980,
				RAM: [][2]uint32{{16729066, 76}, {16729067, 214}, {16729068, 18}, {16729069, 110}, {16729070, 192}, {16729071, 30}, {3943310, 215}, {3943311, 253}, {3943312, 149}, {3943313, 243}, {3943314, 141}, {3943315, 27}, {3943316, 82}, {3943317, 233}, {3943318, 150}, {3943319, 25}, {3943320, 97}, {3943321, 53}, {3943322, 66}, {3943323, 57}, {3943324, 109}, {3943325, 0}, {3943326, 66}, {3943327, 140}, {3943328, 38}, {3943329, 228}, {3943330, 247}, {3943331, 73}, {3943332, 215}, {3943333, 1}, {3943334, 83}, {3943335, 2}, {3943336, 184}, {3943337, 68}, {3943338, 184}, {3943339, 182}, {16729072, 15}, {16729073, 127}},
			},
			want: cpuState{
				D:   [8]uint32{2190334619, 3623720435, 2367378153, 2518245685, 2825890699, 1111059712, 1116481252, 1989339886},
				A:   [7]uint32{3142083142, 4148811521, 3457690161, 1073553760, 1392687172, 2457336872, 2772183950},
				PC:  16729074,
				SR:  34329,
				USP: 1309746,
				SSP: 10868980,
				RAM: [][2]uint32{{16729066, 76}, {16729067, 214}, {16729068, 18}, {16729069, 110}, {16729070, 192}, {16729071, 30}, {3943310, 215}, {3943311, 253}, {3943312, 149}, {3943313, 243}, {3943314, 141}, {3943315, 27}, {3943316, 82}, {3943317, 233}, {3943318, 150}, {3943319, 25}, {3943320, 97}, {3943321, 53}, {3943322, 66}, {3943323, 57}, {3943324, 109}, {3943325, 0}, {3943326, 66}, {3943327, 140}, {3943328, 38}, {3943329, 228}, {3943330, 247}, {3943331, 73}, {3943332, 215}, {3943333, 1}, {3943334, 83}, {3943335, 2}, {3943336, 184}, {3943337, 68}, {3943338, 184}, {3943339, 182}, {16729072, 15}, {16729073, 127}},
				Cycles: 68,
			},
		},
		{
			name: "2000 MOVEM.l (A2)+, # 4cda",
			init: cpuState{
				D:   [8]uint32{1799497197, 2248024927, 3745444050, 613628228, 1759951819, 1502084221, 2029516742, 4178324760},
				A:   [7]uint32{3555992778, 4140131038, 1330774695, 1904381096, 1340934943, 1213874391, 1151662581},
				PC:  11866664,
				SR:  33560,
				USP: 13903986,
				SSP: 9962054,
				RAM: [][2]uint32{{11866660, 76}, {11866661, 218}, {11866662, 87}, {11866663, 13}, {11866664, 41}, {11866665, 186}, {12, 240}, {13, 200}, {14, 249}, {15, 214}, {13171158, 150}, {13171159, 172}, {13171160, 222}, {13171161, 82}},
			},
			want: cpuState{
				D:      [8]uint32{1799497197, 2248024927, 3745444050, 613628228, 1759951819, 1502084221, 2029516742, 4178324760},
				A:      [7]uint32{3555992778, 4140131038, 1330774695, 1904381096, 1340934943, 1213874391, 1151662581},
				PC:     4039703002,
				SR:     8984,
				USP:    13903986,
				SSP:    9962040,
				RAM:    [][2]uint32{{11866660, 76}, {11866661, 218}, {11866662, 87}, {11866663, 13}, {11866664, 41}, {11866665, 186}, {9962052, 18}, {9962053, 42}, {9962048, 131}, {9962049, 24}, {9962050, 0}, {9962051, 181}, {9962046, 76}, {9962047, 218}, {9962044, 2}, {9962045, 167}, {9962040, 76}, {9962041, 209}, {9962042, 79}, {9962043, 82}, {12, 240}, {13, 200}, {14, 249}, {15, 214}, {13171158, 150}, {13171159, 172}, {13171160, 222}, {13171161, 82}},
				Halted: true,
			},
		},
		{
			name: "001 MOVEM.l (d8, A4, Xn), # 4cf4",
			init: 			cpuState{
				D:   [8]uint32{1956007451, 1240403900, 1967257468, 531937664, 40152686, 3972398928, 874828324, 2739302825},
				A:   [7]uint32{1133087284, 1326278158, 1151074100, 2567562883, 1609629347, 528531591, 1979878998},
				PC:  15087552,
				SR:  1548,
				USP: 13990974,
				SSP: 12221174,
				RAM: [][2]uint32{{15087548, 76}, {15087549, 244}, {15087550, 45}, {15087551, 156}, {15087552, 90}, {15087553, 243}, {15087554, 85}, {15087555, 242}, {11992550, 115}, {11992551, 207}, {11992552, 250}, {11992553, 225}, {11992554, 4}, {11992555, 45}, {11992556, 154}, {11992557, 138}, {11992558, 147}, {11992559, 58}, {11992560, 192}, {11992561, 185}, {11992562, 82}, {11992563, 144}, {11992564, 88}, {11992565, 122}, {11992566, 5}, {11992567, 29}, {11992568, 50}, {11992569, 115}, {11992570, 96}, {11992571, 143}, {11992572, 171}, {11992573, 15}, {11992574, 194}, {11992575, 221}, {11992576, 67}, {11992577, 83}, {11992578, 201}, {11992579, 5}, {11992580, 158}, {11992581, 38}, {11992582, 57}, {11992583, 56}, {15087556, 136}, {15087557, 30}},
			},
			want: 			cpuState{
				D:   [8]uint32{1956007451, 1240403900, 1943010017, 70097546, 2470101177, 3972398928, 874828324, 1385191546},
				A:   [7]uint32{85799539, 1326278158, 1620028175, 3269280595, 1609629347, 3372588582, 1979878998},
				PC:  15087558,
				SR:  1548,
				USP: 13990974,
				SSP: 12221174,
				RAM: [][2]uint32{{15087548, 76}, {15087549, 244}, {15087550, 45}, {15087551, 156}, {15087552, 90}, {15087553, 243}, {15087554, 85}, {15087555, 242}, {11992550, 115}, {11992551, 207}, {11992552, 250}, {11992553, 225}, {11992554, 4}, {11992555, 45}, {11992556, 154}, {11992557, 138}, {11992558, 147}, {11992559, 58}, {11992560, 192}, {11992561, 185}, {11992562, 82}, {11992563, 144}, {11992564, 88}, {11992565, 122}, {11992566, 5}, {11992567, 29}, {11992568, 50}, {11992569, 115}, {11992570, 96}, {11992571, 143}, {11992572, 171}, {11992573, 15}, {11992574, 194}, {11992575, 221}, {11992576, 67}, {11992577, 83}, {11992578, 201}, {11992579, 5}, {11992580, 158}, {11992581, 38}, {11992582, 57}, {11992583, 56}, {15087556, 136}, {15087557, 30}},
				Cycles: 82,
			},
		},
		{
			name: "261 MOVEM.l #, (A0) 48d0",
			init: 			cpuState{
				D:   [8]uint32{3219250392, 3165751273, 1966502890, 2772442697, 1149792130, 3222244045, 3754530805, 484820597},
				A:   [7]uint32{2794657080, 3298583923, 1244088170, 1954172735, 1873355414, 2102975692, 4256689492},
				PC:  9187304,
				SR:  8706,
				USP: 15631326,
				SSP: 155714,
				RAM: [][2]uint32{{9187300, 72}, {9187301, 208}, {9187302, 162}, {9187303, 128}, {9187304, 131}, {9187305, 42}, {9187306, 68}, {9187307, 251}},
			},
			want: 			cpuState{
				D:   [8]uint32{3219250392, 3165751273, 1966502890, 2772442697, 1149792130, 3222244045, 3754530805, 484820597},
				A:   [7]uint32{2794657080, 3298583923, 1244088170, 1954172735, 1873355414, 2102975692, 4256689492},
				PC:  9187308,
				SR:  8706,
				USP: 15631326,
				SSP: 155714,
				RAM: [][2]uint32{{9187300, 72}, {9187301, 208}, {9187302, 162}, {9187303, 128}, {9187304, 131}, {9187305, 42}, {9639224, 28}, {9639225, 229}, {9639226, 198}, {9639227, 117}, {9639228, 196}, {9639229, 156}, {9639230, 101}, {9639231, 115}, {9639232, 125}, {9639233, 88}, {9639234, 220}, {9639235, 204}, {9639236, 0}, {9639237, 2}, {9639238, 96}, {9639239, 66}, {9187306, 68}, {9187307, 251}},
				Cycles: 40,
			},
		},
		{
			name: "583 MOVEM.l (d16, A5), # 4ced",
			init: 			cpuState{
				D:   [8]uint32{2735004565, 1784438287, 3281224697, 3919183830, 4119912887, 750494144, 3799520526, 3732132302},
				A:   [7]uint32{677718428, 1233071960, 3400070317, 3228905154, 1233590463, 3619942674, 4133110815},
				PC:  3045824,
				SR:  1297,
				USP: 10898886,
				SSP: 2265888,
				RAM: [][2]uint32{{3045820, 76}, {3045821, 237}, {3045822, 241}, {3045823, 14}, {3045824, 165}, {3045825, 240}, {3045826, 155}, {3045827, 155}, {12818178, 226}, {12818179, 130}, {12818180, 133}, {12818181, 24}, {12818182, 152}, {12818183, 83}, {12818184, 218}, {12818185, 197}, {12818186, 172}, {12818187, 203}, {12818188, 241}, {12818189, 80}, {12818190, 201}, {12818191, 30}, {12818192, 105}, {12818193, 5}, {12818194, 153}, {12818195, 83}, {12818196, 35}, {12818197, 179}, {12818198, 123}, {12818199, 56}, {12818200, 6}, {12818201, 24}, {12818202, 251}, {12818203, 116}, {12818204, 242}, {12818205, 146}, {12818206, 168}, {12818207, 102}, {12818208, 66}, {12818209, 55}, {12818210, 221}, {12818211, 75}, {3045828, 163}, {3045829, 164}},
			},
			want: 			cpuState{
				D:   [8]uint32{2735004565, 3800204568, 2555632325, 2899046736, 4119912887, 750494144, 3799520526, 3732132302},
				A:   [7]uint32{3374213381, 1233071960, 3400070317, 3228905154, 2572362675, 2067269144, 4218745490},
				PC:  3045830,
				SR:  1297,
				USP: 2825273911,
				SSP: 2265888,
				RAM: [][2]uint32{{3045820, 76}, {3045821, 237}, {3045822, 241}, {3045823, 14}, {3045824, 165}, {3045825, 240}, {3045826, 155}, {3045827, 155}, {12818178, 226}, {12818179, 130}, {12818180, 133}, {12818181, 24}, {12818182, 152}, {12818183, 83}, {12818184, 218}, {12818185, 197}, {12818186, 172}, {12818187, 203}, {12818188, 241}, {12818189, 80}, {12818190, 201}, {12818191, 30}, {12818192, 105}, {12818193, 5}, {12818194, 153}, {12818195, 83}, {12818196, 35}, {12818197, 179}, {12818198, 123}, {12818199, 56}, {12818200, 6}, {12818201, 24}, {12818202, 251}, {12818203, 116}, {12818204, 242}, {12818205, 146}, {12818206, 168}, {12818207, 102}, {12818208, 66}, {12818209, 55}, {12818210, 221}, {12818211, 75}, {3045828, 163}, {3045829, 164}},
				Cycles: 80,
			},
		},
		{
			name: "884 MOVEM.l #, (A2) 48d2",
			init: 			cpuState{
				D:   [8]uint32{3073042301, 1815440713, 915350251, 343385740, 250238095, 2737841495, 593879887, 1788715367},
				A:   [7]uint32{3422860252, 2038922779, 1116979104, 2728298022, 2086154318, 2087945932, 1550367792},
				PC:  9054142,
				SR:  9473,
				USP: 15219494,
				SSP: 16070874,
				RAM: [][2]uint32{{9054138, 72}, {9054139, 210}, {9054140, 183}, {9054141, 178}, {9054142, 53}, {9054143, 175}, {9054144, 53}, {9054145, 55}},
			},
			want: 			cpuState{
				D:   [8]uint32{3073042301, 1815440713, 915350251, 343385740, 250238095, 2737841495, 593879887, 1788715367},
				A:   [7]uint32{3422860252, 2038922779, 1116979104, 2728298022, 2086154318, 2087945932, 1550367792},
				PC:  9054146,
				SR:  9473,
				USP: 15219494,
				SSP: 16070874,
				RAM: [][2]uint32{{9054138, 72}, {9054139, 210}, {9054140, 183}, {9054141, 178}, {9054142, 53}, {9054143, 175}, {9682848, 108}, {9682849, 53}, {9682850, 109}, {9682851, 73}, {9682852, 14}, {9682853, 234}, {9682854, 84}, {9682855, 143}, {9682856, 163}, {9682857, 48}, {9682858, 37}, {9682859, 87}, {9682860, 106}, {9682861, 157}, {9682862, 161}, {9682863, 103}, {9682864, 204}, {9682865, 4}, {9682866, 179}, {9682867, 220}, {9682868, 121}, {9682869, 135}, {9682870, 126}, {9682871, 27}, {9682872, 66}, {9682873, 147}, {9682874, 191}, {9682875, 160}, {9682876, 124}, {9682877, 88}, {9682878, 48}, {9682879, 78}, {9682880, 124}, {9682881, 115}, {9682882, 134}, {9682883, 204}, {9682884, 0}, {9682885, 245}, {9682886, 56}, {9682887, 218}, {9054144, 53}, {9054145, 55}},
				Cycles: 88,
			},
		},
		{
			name: "1164 MOVEM.l (A4), # 4cd4",
			init: 			cpuState{
				D:   [8]uint32{2987913997, 2892499032, 935129699, 3621253110, 3412062344, 3495026023, 1553891123, 3683059510},
				A:   [7]uint32{94289921, 4264013268, 3805962562, 3448388564, 2650657032, 448750323, 1838122561},
				PC:  8618190,
				SR:  9999,
				USP: 10932462,
				SSP: 8539874,
				RAM: [][2]uint32{{8618186, 76}, {8618187, 212}, {8618188, 206}, {8618189, 132}, {8618190, 132}, {8618191, 22}, {16634120, 32}, {16634121, 179}, {16634122, 137}, {16634123, 191}, {16634124, 100}, {16634125, 17}, {16634126, 246}, {16634127, 187}, {16634128, 188}, {16634129, 128}, {16634130, 90}, {16634131, 104}, {16634132, 85}, {16634133, 247}, {16634134, 15}, {16634135, 249}, {16634136, 17}, {16634137, 37}, {16634138, 18}, {16634139, 43}, {16634140, 239}, {16634141, 253}, {16634142, 49}, {16634143, 219}, {16634144, 39}, {16634145, 166}, {16634146, 170}, {16634147, 8}, {16634148, 213}, {16634149, 246}, {8618192, 38}, {8618193, 122}},
			},
			want: 			cpuState{
				D:   [8]uint32{2987913997, 2892499032, 548637119, 3621253110, 3412062344, 3495026023, 1553891123, 1678898875},
				A:   [7]uint32{94289921, 3162528360, 1442254841, 287642155, 2650657032, 448750323, 4026347995},
				PC:  8618194,
				SR:  9999,
				USP: 10932462,
				SSP: 665233928,
				RAM: [][2]uint32{{8618186, 76}, {8618187, 212}, {8618188, 206}, {8618189, 132}, {8618190, 132}, {8618191, 22}, {16634120, 32}, {16634121, 179}, {16634122, 137}, {16634123, 191}, {16634124, 100}, {16634125, 17}, {16634126, 246}, {16634127, 187}, {16634128, 188}, {16634129, 128}, {16634130, 90}, {16634131, 104}, {16634132, 85}, {16634133, 247}, {16634134, 15}, {16634135, 249}, {16634136, 17}, {16634137, 37}, {16634138, 18}, {16634139, 43}, {16634140, 239}, {16634141, 253}, {16634142, 49}, {16634143, 219}, {16634144, 39}, {16634145, 166}, {16634146, 170}, {16634147, 8}, {16634148, 213}, {16634149, 246}, {8618192, 38}, {8618193, 122}},
				Cycles: 68,
			},
		},
		{
			name: "1411 MOVEM.l #, -(A5) 48e5",
			init: 			cpuState{
				D:   [8]uint32{620730671, 769667669, 197037895, 1066526618, 120525241, 262191718, 1996878325, 4224138913},
				A:   [7]uint32{3757263957, 3693289301, 1015272094, 1050640631, 536458906, 3541592050, 3523771928},
				PC:  909906,
				SR:  9498,
				USP: 8821246,
				SSP: 14976644,
				RAM: [][2]uint32{{909902, 72}, {909903, 229}, {909904, 224}, {909905, 146}, {909906, 156}, {909907, 9}, {909908, 244}, {909909, 151}},
			},
			want: 			cpuState{
				D:   [8]uint32{620730671, 769667669, 197037895, 1066526618, 120525241, 262191718, 1996878325, 4224138913},
				A:   [7]uint32{3757263957, 3693289301, 1015272094, 1050640631, 536458906, 3541592026, 3523771928},
				PC:  909910,
				SR:  9498,
				USP: 8821246,
				SSP: 14976644,
				RAM: [][2]uint32{{909902, 72}, {909903, 229}, {909904, 224}, {909905, 146}, {909906, 156}, {909907, 9}, {1599472, 126}, {1599473, 24}, {1599470, 210}, {1599471, 8}, {1599468, 128}, {1599469, 247}, {1599466, 62}, {1599467, 159}, {1599464, 76}, {1599465, 85}, {1599462, 223}, {1599463, 243}, {1599460, 143}, {1599461, 71}, {1599458, 11}, {1599459, 190}, {1599456, 50}, {1599457, 85}, {1599454, 45}, {1599455, 224}, {1599452, 153}, {1599453, 47}, {1599450, 36}, {1599451, 255}, {909908, 244}, {909909, 151}},
				Cycles: 56,
			},
		},
		{
			name: "1721 MOVEM.l #, (d8, A7, Xn) 48f7",
			init: 			cpuState{
				D:   [8]uint32{3602229032, 1559791497, 2266947664, 3702032157, 681525548, 2558129318, 33687918, 3913958401},
				A:   [7]uint32{3331915397, 2870263984, 3422499995, 4153753429, 1588991328, 292204719, 1874885179},
				PC:  16171966,
				SR:  8730,
				USP: 4420036,
				SSP: 2950028,
				RAM: [][2]uint32{{16171962, 72}, {16171963, 247}, {16171964, 180}, {16171965, 16}, {16171966, 199}, {16171967, 192}, {16171968, 199}, {16171969, 171}, {16171970, 214}, {16171971, 35}},
			},
			want: 			cpuState{
				D:   [8]uint32{3602229032, 1559791497, 2266947664, 3702032157, 681525548, 2558129318, 33687918, 3913958401},
				A:   [7]uint32{3331915397, 2870263984, 3422499995, 4153753429, 1588991328, 292204719, 1874885179},
				PC:  16171972,
				SR:  8730,
				USP: 4420036,
				SSP: 2950028,
				RAM: [][2]uint32{{16171962, 72}, {16171963, 247}, {16171964, 180}, {16171965, 16}, {16171966, 199}, {16171967, 192}, {16171968, 199}, {16171969, 171}, {2955436, 40}, {2955437, 159}, {2955438, 65}, {2955439, 44}, {2955440, 203}, {2955441, 255}, {2955442, 52}, {2955443, 155}, {2955444, 94}, {2955445, 182}, {2955446, 21}, {2955447, 96}, {2955448, 17}, {2955449, 106}, {2955450, 176}, {2955451, 175}, {2955452, 0}, {2955453, 45}, {2955454, 3}, {2955455, 140}, {16171970, 214}, {16171971, 35}},
				Cycles: 54,
			},
		},
		{
			name: "2008 MOVEM.l (d16, A2), # 4cea",
			init: 			cpuState{
				D:   [8]uint32{2745411693, 2836598022, 1105514936, 845056148, 2223745479, 3687803461, 864207246, 2383447942},
				A:   [7]uint32{3741362347, 830397937, 2361612420, 2552943510, 4004018162, 4108712408, 3392643809},
				PC:  12255008,
				SR:  8211,
				USP: 4223986,
				SSP: 14730406,
				RAM: [][2]uint32{{12255004, 76}, {12255005, 234}, {12255006, 97}, {12255007, 127}, {12255008, 80}, {12255009, 76}, {12255010, 11}, {12255011, 192}, {12822736, 167}, {12822737, 241}, {12822738, 192}, {12822739, 2}, {12822740, 242}, {12822741, 168}, {12822742, 165}, {12822743, 30}, {12822744, 8}, {12822745, 25}, {12822746, 141}, {12822747, 156}, {12822748, 85}, {12822749, 53}, {12822750, 224}, {12822751, 187}, {12822752, 125}, {12822753, 183}, {12822754, 89}, {12822755, 54}, {12822756, 4}, {12822757, 67}, {12822758, 18}, {12822759, 106}, {12822760, 107}, {12822761, 233}, {12822762, 65}, {12822763, 252}, {12822764, 228}, {12822765, 102}, {12822766, 131}, {12822767, 227}, {12822768, 74}, {12822769, 169}, {12822770, 144}, {12822771, 107}, {12822772, 123}, {12822773, 1}, {12822774, 198}, {12822775, 36}, {12822776, 50}, {12822777, 53}, {12255012, 124}, {12255013, 92}},
			},
			want: 			cpuState{
				D:   [8]uint32{2817638402, 4071138590, 135892380, 1429594299, 2109167926, 71504490, 1810448892, 2383447942},
				A:   [7]uint32{3831923683, 830397937, 2361612420, 2552943510, 4004018162, 1252626539, 2063713828},
				PC:  12255014,
				SR:  8211,
				USP: 4223986,
				SSP: 14730406,
				RAM: [][2]uint32{{12255004, 76}, {12255005, 234}, {12255006, 97}, {12255007, 127}, {12255008, 80}, {12255009, 76}, {12255010, 11}, {12255011, 192}, {12822736, 167}, {12822737, 241}, {12822738, 192}, {12822739, 2}, {12822740, 242}, {12822741, 168}, {12822742, 165}, {12822743, 30}, {12822744, 8}, {12822745, 25}, {12822746, 141}, {12822747, 156}, {12822748, 85}, {12822749, 53}, {12822750, 224}, {12822751, 187}, {12822752, 125}, {12822753, 183}, {12822754, 89}, {12822755, 54}, {12822756, 4}, {12822757, 67}, {12822758, 18}, {12822759, 106}, {12822760, 107}, {12822761, 233}, {12822762, 65}, {12822763, 252}, {12822764, 228}, {12822765, 102}, {12822766, 131}, {12822767, 227}, {12822768, 74}, {12822769, 169}, {12822770, 144}, {12822771, 107}, {12822772, 123}, {12822773, 1}, {12822774, 198}, {12822775, 36}, {12822776, 50}, {12822777, 53}, {12255012, 124}, {12255013, 92}},
				Cycles: 96,
			},
		},
		{
			name: "2264 MOVEM.l #, (A2) 48d2",
			init: 			cpuState{
				D:   [8]uint32{1137446931, 199725664, 3596659174, 2616853663, 1055741871, 3826607635, 552465419, 515790140},
				A:   [7]uint32{630388921, 3808196696, 441416676, 2281834328, 2361452766, 1998673821, 1532510865},
				PC:  13497408,
				SR:  273,
				USP: 10253396,
				SSP: 239960,
				RAM: [][2]uint32{{13497404, 72}, {13497405, 210}, {13497406, 10}, {13497407, 39}, {13497408, 205}, {13497409, 240}, {13497410, 11}, {13497411, 229}},
			},
			want: 			cpuState{
				D:   [8]uint32{1137446931, 199725664, 3596659174, 2616853663, 1055741871, 3826607635, 552465419, 515790140},
				A:   [7]uint32{630388921, 3808196696, 441416676, 2281834328, 2361452766, 1998673821, 1532510865},
				PC:  13497412,
				SR:  273,
				USP: 10253396,
				SSP: 239960,
				RAM: [][2]uint32{{13497404, 72}, {13497405, 210}, {13497406, 10}, {13497407, 39}, {13497408, 205}, {13497409, 240}, {5209060, 67}, {5209061, 204}, {5209062, 16}, {5209063, 19}, {5209064, 11}, {5209065, 231}, {5209066, 146}, {5209067, 96}, {5209068, 214}, {5209069, 96}, {5209070, 169}, {5209071, 230}, {5209072, 228}, {5209073, 21}, {5209074, 102}, {5209075, 19}, {5209076, 226}, {5209077, 252}, {5209078, 120}, {5209079, 88}, {5209080, 136}, {5209081, 2}, {5209082, 7}, {5209083, 88}, {13497410, 11}, {13497411, 229}},
				Cycles: 56,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEP_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEP.w (d16, A2), D2 050a",
			init: cpuState{
				D:   [8]uint32{3900302818, 2506507470, 3822282754, 2339417319, 1891721485, 405460408, 547950994, 3291501729},
				A:   [7]uint32{1344045938, 1036996011, 1836282350, 2517245756, 589922482, 1154093737, 3280878085},
				PC:  5570452,
				SR:  8213,
				USP: 1870710,
				SSP: 15185858,
				RAM: [][2]uint32{{5570448, 5}, {5570449, 10}, {5570450, 188}, {5570451, 90}, {5570452, 171}, {5570453, 22}, {7548488, 124}, {7548489, 136}, {7548490, 2}, {7548491, 58}, {5570454, 127}, {5570455, 159}},
			},
			want: cpuState{
				D:   [8]uint32{3900302818, 2506507470, 3822287874, 2339417319, 1891721485, 405460408, 547950994, 3291501729},
				A:   [7]uint32{1344045938, 1036996011, 1836282350, 2517245756, 589922482, 1154093737, 3280878085},
				PC:  5570456,
				SR:  8213,
				USP: 1870710,
				SSP: 15185858,
				RAM: [][2]uint32{{5570448, 5}, {5570449, 10}, {5570450, 188}, {5570451, 90}, {5570452, 171}, {5570453, 22}, {7548488, 124}, {7548489, 136}, {7548490, 2}, {7548491, 58}, {5570454, 127}, {5570455, 159}},
				Cycles: 16,
			},
		},
		{
			name: "500 MOVEP.w (d16, A3), D5 0b0b",
			init: cpuState{
				D:   [8]uint32{2432016703, 3236054546, 977745481, 267390929, 116818340, 1546028756, 128449995, 970391108},
				A:   [7]uint32{1284988150, 943727426, 2500683404, 4151629919, 1379736348, 3584057021, 2397562938},
				PC:  7504588,
				SR:  33539,
				USP: 11126482,
				SSP: 2692946,
				RAM: [][2]uint32{{7504584, 11}, {7504585, 11}, {7504586, 81}, {7504587, 232}, {7504588, 5}, {7504589, 90}, {7678534, 135}, {7678535, 110}, {7678536, 94}, {7678537, 250}, {7504590, 153}, {7504591, 43}},
			},
			want: cpuState{
				D:   [8]uint32{2432016703, 3236054546, 977745481, 267390929, 116818340, 1546022650, 128449995, 970391108},
				A:   [7]uint32{1284988150, 943727426, 2500683404, 4151629919, 1379736348, 3584057021, 2397562938},
				PC:  7504592,
				SR:  33539,
				USP: 11126482,
				SSP: 2692946,
				RAM: [][2]uint32{{7504584, 11}, {7504585, 11}, {7504586, 81}, {7504587, 232}, {7504588, 5}, {7504589, 90}, {7678534, 135}, {7678535, 110}, {7678536, 94}, {7678537, 250}, {7504590, 153}, {7504591, 43}},
				Cycles: 16,
			},
		},
		{
			name: "1000 MOVEP.w D0, (d16, A4) 018c",
			init: cpuState{
				D:   [8]uint32{2808438177, 1654932256, 2301644383, 2327506045, 1882645979, 2048820558, 1490884466, 801356440},
				A:   [7]uint32{3205839532, 1267096606, 2401789773, 3565152284, 1368254037, 1851345834, 2892625356},
				PC:  4853598,
				SR:  8458,
				USP: 15124986,
				SSP: 6370730,
				RAM: [][2]uint32{{4853594, 1}, {4853595, 140}, {4853596, 98}, {4853597, 228}, {4853598, 103}, {4853599, 34}, {4853600, 226}, {4853601, 68}},
			},
			want: cpuState{
				D:   [8]uint32{2808438177, 1654932256, 2301644383, 2327506045, 1882645979, 2048820558, 1490884466, 801356440},
				A:   [7]uint32{3205839532, 1267096606, 2401789773, 3565152284, 1368254037, 1851345834, 2892625356},
				PC:  4853602,
				SR:  8458,
				USP: 15124986,
				SSP: 6370730,
				RAM: [][2]uint32{{4853594, 1}, {4853595, 140}, {4853596, 98}, {4853597, 228}, {4853598, 103}, {4853599, 34}, {9324856, 0}, {9324857, 93}, {9324858, 0}, {9324859, 161}, {4853600, 226}, {4853601, 68}},
				Cycles: 16,
			},
		},
		{
			name: "1500 MOVEP.w (d16, A1), D1 0309",
			init: cpuState{
				D:   [8]uint32{2055612598, 350988692, 2665539920, 2498511449, 3510690654, 3936124279, 1022677455, 857133729},
				A:   [7]uint32{3981915537, 4241969987, 1674760367, 1207756126, 3320151892, 3576069123, 580710262},
				PC:  9586802,
				SR:  8983,
				USP: 13763918,
				SSP: 2291240,
				RAM: [][2]uint32{{9586798, 3}, {9586799, 9}, {9586800, 53}, {9586801, 8}, {9586802, 191}, {9586803, 42}, {14125130, 26}, {14125131, 144}, {14125132, 22}, {14125133, 205}, {9586804, 107}, {9586805, 129}},
			},
			want: cpuState{
				D:   [8]uint32{2055612598, 350982349, 2665539920, 2498511449, 3510690654, 3936124279, 1022677455, 857133729},
				A:   [7]uint32{3981915537, 4241969987, 1674760367, 1207756126, 3320151892, 3576069123, 580710262},
				PC:  9586806,
				SR:  8983,
				USP: 13763918,
				SSP: 2291240,
				RAM: [][2]uint32{{9586798, 3}, {9586799, 9}, {9586800, 53}, {9586801, 8}, {9586802, 191}, {9586803, 42}, {14125130, 26}, {14125131, 144}, {14125132, 22}, {14125133, 205}, {9586804, 107}, {9586805, 129}},
				Cycles: 16,
			},
		},
		{
			name: "2000 MOVEP.w (d16, A7), D1 030f",
			init: cpuState{
				D:   [8]uint32{3891869880, 99343349, 4173362018, 303327462, 444489645, 3378678658, 4027723404, 273019276},
				A:   [7]uint32{691398999, 1825028604, 1507855372, 3159473342, 3255636697, 636965973, 1880347524},
				PC:  10206748,
				SR:  1035,
				USP: 11788356,
				SSP: 2738350,
				RAM: [][2]uint32{{10206744, 3}, {10206745, 15}, {10206746, 216}, {10206747, 184}, {10206748, 124}, {10206749, 9}, {11778300, 120}, {11778301, 59}, {11778302, 172}, {11778303, 83}, {10206750, 56}, {10206751, 105}},
			},
			want: cpuState{
				D:   [8]uint32{3891869880, 99317932, 4173362018, 303327462, 444489645, 3378678658, 4027723404, 273019276},
				A:   [7]uint32{691398999, 1825028604, 1507855372, 3159473342, 3255636697, 636965973, 1880347524},
				PC:  10206752,
				SR:  1035,
				USP: 11788356,
				SSP: 2738350,
				RAM: [][2]uint32{{10206744, 3}, {10206745, 15}, {10206746, 216}, {10206747, 184}, {10206748, 124}, {10206749, 9}, {11778300, 120}, {11778301, 59}, {11778302, 172}, {11778303, 83}, {10206750, 56}, {10206751, 105}},
				Cycles: 16,
			},
		},
		{
			name: "002 MOVEP.w D5, (d16, A2) 0b8a",
			init: 			cpuState{
				D:   [8]uint32{33397961, 2385721820, 2385672128, 2139710471, 3566953501, 3502019916, 662583857, 3313665221},
				A:   [7]uint32{3385924233, 116427624, 1443537936, 1228986585, 1713178891, 3970061682, 3234624265},
				PC:  8029306,
				SR:  9747,
				USP: 13178466,
				SSP: 12415700,
				RAM: [][2]uint32{{8029302, 11}, {8029303, 138}, {8029304, 176}, {8029305, 130}, {8029306, 224}, {8029307, 167}, {8029308, 102}, {8029309, 171}},
			},
			want: 			cpuState{
				D:   [8]uint32{33397961, 2385721820, 2385672128, 2139710471, 3566953501, 3502019916, 662583857, 3313665221},
				A:   [7]uint32{3385924233, 116427624, 1443537936, 1228986585, 1713178891, 3970061682, 3234624265},
				PC:  8029310,
				SR:  9747,
				USP: 13178466,
				SSP: 12415700,
				RAM: [][2]uint32{{8029302, 11}, {8029303, 138}, {8029304, 176}, {8029305, 130}, {8029306, 224}, {8029307, 167}, {677010, 149}, {677011, 0}, {677012, 76}, {677013, 0}, {8029308, 102}, {8029309, 171}},
				Cycles: 16,
			},
		},
		{
			name: "288 MOVEP.w D4, (d16, A3) 098b",
			init: 			cpuState{
				D:   [8]uint32{1794780354, 3292420762, 621024708, 2350577826, 3878883004, 1014053529, 1017730455, 3903854312},
				A:   [7]uint32{1219029786, 2440891892, 2579562393, 2449180716, 83047060, 147321480, 2523245314},
				PC:  14960414,
				SR:  1817,
				USP: 6800380,
				SSP: 8579864,
				RAM: [][2]uint32{{14960410, 9}, {14960411, 139}, {14960412, 219}, {14960413, 175}, {14960414, 6}, {14960415, 240}, {14960416, 158}, {14960417, 139}},
			},
			want: 			cpuState{
				D:   [8]uint32{1794780354, 3292420762, 621024708, 2350577826, 3878883004, 1014053529, 1017730455, 3903854312},
				A:   [7]uint32{1219029786, 2440891892, 2579562393, 2449180716, 83047060, 147321480, 2523245314},
				PC:  14960418,
				SR:  1817,
				USP: 6800380,
				SSP: 8579864,
				RAM: [][2]uint32{{14960410, 9}, {14960411, 139}, {14960412, 219}, {14960413, 175}, {14960414, 6}, {14960415, 240}, {16475098, 0}, {16475099, 14}, {16475100, 0}, {16475101, 188}, {14960416, 158}, {14960417, 139}},
				Cycles: 16,
			},
		},
		{
			name: "566 MOVEP.w (d16, A4), D2 050c",
			init: 			cpuState{
				D:   [8]uint32{779623900, 3363392048, 2989747724, 1950826009, 55040529, 2152600687, 1719555261, 1922904259},
				A:   [7]uint32{3788560863, 3021031508, 2327942640, 3597670973, 163332003, 2009965538, 3007148225},
				PC:  2274232,
				SR:  9482,
				USP: 14040460,
				SSP: 7963610,
				RAM: [][2]uint32{{2274228, 5}, {2274229, 12}, {2274230, 92}, {2274231, 121}, {2274232, 92}, {2274233, 153}, {12360732, 49}, {12360733, 109}, {12360734, 13}, {12360735, 218}, {2274234, 199}, {2274235, 55}},
			},
			want: 			cpuState{
				D:   [8]uint32{779623900, 3363392048, 2989699341, 1950826009, 55040529, 2152600687, 1719555261, 1922904259},
				A:   [7]uint32{3788560863, 3021031508, 2327942640, 3597670973, 163332003, 2009965538, 3007148225},
				PC:  2274236,
				SR:  9482,
				USP: 14040460,
				SSP: 7963610,
				RAM: [][2]uint32{{2274228, 5}, {2274229, 12}, {2274230, 92}, {2274231, 121}, {2274232, 92}, {2274233, 153}, {12360732, 49}, {12360733, 109}, {12360734, 13}, {12360735, 218}, {2274234, 199}, {2274235, 55}},
				Cycles: 16,
			},
		},
		{
			name: "823 MOVEP.w D7, (d16, A7) 0f8f",
			init: 			cpuState{
				D:   [8]uint32{845077244, 3311218823, 1299209916, 1692527718, 466958062, 142923163, 3430748691, 1852455609},
				A:   [7]uint32{1098612639, 2495117255, 3987543773, 336423495, 535778229, 2894237105, 3451962261},
				PC:  6437296,
				SR:  8731,
				USP: 15760638,
				SSP: 11344914,
				RAM: [][2]uint32{{6437292, 15}, {6437293, 143}, {6437294, 59}, {6437295, 248}, {6437296, 161}, {6437297, 36}, {6437298, 138}, {6437299, 51}},
			},
			want: 			cpuState{
				D:   [8]uint32{845077244, 3311218823, 1299209916, 1692527718, 466958062, 142923163, 3430748691, 1852455609},
				A:   [7]uint32{1098612639, 2495117255, 3987543773, 336423495, 535778229, 2894237105, 3451962261},
				PC:  6437300,
				SR:  8731,
				USP: 15760638,
				SSP: 11344914,
				RAM: [][2]uint32{{6437292, 15}, {6437293, 143}, {6437294, 59}, {6437295, 248}, {6437296, 161}, {6437297, 36}, {11360266, 58}, {11360267, 0}, {11360268, 185}, {11360269, 0}, {6437298, 138}, {6437299, 51}},
				Cycles: 16,
			},
		},
		{
			name: "1102 MOVEP.w D7, (d16, A3) 0f8b",
			init: 			cpuState{
				D:   [8]uint32{907336174, 3293247007, 2909412242, 4125187306, 4186372609, 2152809493, 2306806308, 2328648168},
				A:   [7]uint32{2200346493, 3846242619, 1889900742, 3344860570, 2074024914, 173447964, 1261716403},
				PC:  7247234,
				SR:  516,
				USP: 4459278,
				SSP: 958612,
				RAM: [][2]uint32{{7247230, 15}, {7247231, 139}, {7247232, 10}, {7247233, 249}, {7247234, 57}, {7247235, 216}, {7247236, 136}, {7247237, 246}},
			},
			want: 			cpuState{
				D:   [8]uint32{907336174, 3293247007, 2909412242, 4125187306, 4186372609, 2152809493, 2306806308, 2328648168},
				A:   [7]uint32{2200346493, 3846242619, 1889900742, 3344860570, 2074024914, 173447964, 1261716403},
				PC:  7247238,
				SR:  516,
				USP: 4459278,
				SSP: 958612,
				RAM: [][2]uint32{{7247230, 15}, {7247231, 139}, {7247232, 10}, {7247233, 249}, {7247234, 57}, {7247235, 216}, {6197394, 0}, {6197395, 89}, {6197396, 0}, {6197397, 232}, {7247236, 136}, {7247237, 246}},
				Cycles: 16,
			},
		},
		{
			name: "1370 MOVEP.w D1, (d16, A5) 038d",
			init: 			cpuState{
				D:   [8]uint32{1664098950, 4104558375, 980645470, 1992864626, 2476576669, 2366993039, 998651919, 1043934134},
				A:   [7]uint32{3246198611, 2367182028, 602397264, 3774482057, 1077034670, 3565983590, 1022283086},
				PC:  11575046,
				SR:  8218,
				USP: 6405664,
				SSP: 13751294,
				RAM: [][2]uint32{{11575042, 3}, {11575043, 141}, {11575044, 22}, {11575045, 142}, {11575046, 196}, {11575047, 161}, {11575048, 88}, {11575049, 210}},
			},
			want: 			cpuState{
				D:   [8]uint32{1664098950, 4104558375, 980645470, 1992864626, 2476576669, 2366993039, 998651919, 1043934134},
				A:   [7]uint32{3246198611, 2367182028, 602397264, 3774482057, 1077034670, 3565983590, 1022283086},
				PC:  11575050,
				SR:  8218,
				USP: 6405664,
				SSP: 13751294,
				RAM: [][2]uint32{{11575042, 3}, {11575043, 141}, {11575044, 22}, {11575045, 142}, {11575046, 196}, {11575047, 161}, {9219572, 151}, {9219573, 0}, {9219574, 39}, {9219575, 0}, {11575048, 88}, {11575049, 210}},
				Cycles: 16,
			},
		},
		{
			name: "1667 MOVEP.w D5, (d16, A7) 0b8f",
			init: 			cpuState{
				D:   [8]uint32{1846233207, 1420261852, 3847153024, 1930022853, 993042630, 2680991771, 3925542380, 3071895720},
				A:   [7]uint32{127269087, 3355537241, 1560590380, 1159863333, 3194688546, 2610250323, 2750151116},
				PC:  16190508,
				SR:  1816,
				USP: 9981686,
				SSP: 5500192,
				RAM: [][2]uint32{{16190504, 11}, {16190505, 143}, {16190506, 104}, {16190507, 118}, {16190508, 95}, {16190509, 8}, {16190510, 186}, {16190511, 14}},
			},
			want: 			cpuState{
				D:   [8]uint32{1846233207, 1420261852, 3847153024, 1930022853, 993042630, 2680991771, 3925542380, 3071895720},
				A:   [7]uint32{127269087, 3355537241, 1560590380, 1159863333, 3194688546, 2610250323, 2750151116},
				PC:  16190512,
				SR:  1816,
				USP: 9981686,
				SSP: 5500192,
				RAM: [][2]uint32{{16190504, 11}, {16190505, 143}, {16190506, 104}, {16190507, 118}, {16190508, 95}, {16190509, 8}, {10008428, 176}, {10008429, 0}, {10008430, 27}, {10008431, 0}, {16190510, 186}, {16190511, 14}},
				Cycles: 16,
			},
		},
		{
			name: "1973 MOVEP.w (d16, A5), D6 0d0d",
			init: 			cpuState{
				D:   [8]uint32{3239094698, 3700940753, 2687927867, 3416861012, 2992239018, 1901162951, 1508059547, 2997010443},
				A:   [7]uint32{2898168609, 997744111, 254099654, 1018428952, 2954745671, 3674023177, 1575950750},
				PC:  11486250,
				SR:  8448,
				USP: 16137406,
				SSP: 4335800,
				RAM: [][2]uint32{{11486246, 13}, {11486247, 13}, {11486248, 59}, {11486249, 78}, {11486250, 11}, {11486251, 154}, {16605270, 61}, {16605271, 243}, {16605272, 145}, {16605273, 217}, {11486252, 74}, {11486253, 33}},
			},
			want: 			cpuState{
				D:   [8]uint32{3239094698, 3700940753, 2687927867, 3416861012, 2992239018, 1901162951, 1508111321, 2997010443},
				A:   [7]uint32{2898168609, 997744111, 254099654, 1018428952, 2954745671, 3674023177, 1575950750},
				PC:  11486254,
				SR:  8448,
				USP: 16137406,
				SSP: 4335800,
				RAM: [][2]uint32{{11486246, 13}, {11486247, 13}, {11486248, 59}, {11486249, 78}, {11486250, 11}, {11486251, 154}, {16605270, 61}, {16605271, 243}, {16605272, 145}, {16605273, 217}, {11486252, 74}, {11486253, 33}},
				Cycles: 16,
			},
		},
		{
			name: "2236 MOVEP.w (d16, A2), D7 0f0a",
			init: 			cpuState{
				D:   [8]uint32{218543203, 2481778390, 4289397013, 195016600, 3981099465, 3860265379, 1035689288, 2823592326},
				A:   [7]uint32{401939848, 2723183356, 3318960960, 2684059735, 1207650720, 3858514533, 324023448},
				PC:  14374066,
				SR:  9478,
				USP: 15821584,
				SSP: 2060384,
				RAM: [][2]uint32{{14374062, 15}, {14374063, 10}, {14374064, 204}, {14374065, 248}, {14374066, 141}, {14374067, 178}, {13836344, 45}, {13836345, 25}, {13836346, 181}, {13836347, 22}, {14374068, 112}, {14374069, 42}},
			},
			want: 			cpuState{
				D:   [8]uint32{218543203, 2481778390, 4289397013, 195016600, 3981099465, 3860265379, 1035689288, 2823564725},
				A:   [7]uint32{401939848, 2723183356, 3318960960, 2684059735, 1207650720, 3858514533, 324023448},
				PC:  14374070,
				SR:  9478,
				USP: 15821584,
				SSP: 2060384,
				RAM: [][2]uint32{{14374062, 15}, {14374063, 10}, {14374064, 204}, {14374065, 248}, {14374066, 141}, {14374067, 178}, {13836344, 45}, {13836345, 25}, {13836346, 181}, {13836347, 22}, {14374068, 112}, {14374069, 42}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEP_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEP.l (d16, A2), D0 014a",
			init: cpuState{
				D:   [8]uint32{2979505002, 209276630, 2001096722, 3408373850, 343098753, 84110221, 3624173144, 3551189731},
				A:   [7]uint32{2517387372, 1566803654, 358036465, 1400719130, 3361016488, 16268715, 66787001},
				PC:  1743766,
				SR:  8454,
				USP: 14019698,
				SSP: 238224,
				RAM: [][2]uint32{{1743762, 1}, {1743763, 74}, {1743764, 242}, {1743765, 164}, {1743766, 222}, {1743767, 53}, {5711508, 89}, {5711509, 168}, {5711510, 253}, {5711511, 79}, {5711512, 200}, {5711513, 252}, {5711514, 42}, {5711515, 188}, {1743768, 40}, {1743769, 205}},
			},
			want: cpuState{
				D:   [8]uint32{2823814332, 209276630, 2001096722, 3408373850, 343098753, 84110221, 3624173144, 3551189731},
				A:   [7]uint32{2517387372, 1566803654, 358036465, 1400719130, 3361016488, 16268715, 66787001},
				PC:  1743770,
				SR:  8454,
				USP: 14019698,
				SSP: 238224,
				RAM: [][2]uint32{{1743762, 1}, {1743763, 74}, {1743764, 242}, {1743765, 164}, {1743766, 222}, {1743767, 53}, {5711508, 89}, {5711509, 168}, {5711510, 253}, {5711511, 79}, {5711512, 200}, {5711513, 252}, {5711514, 42}, {5711515, 188}, {1743768, 40}, {1743769, 205}},
				Cycles: 24,
			},
		},
		{
			name: "500 MOVEP.l D7, (d16, A7) 0fcf",
			init: cpuState{
				D:   [8]uint32{2178325792, 3820349588, 1549174006, 22366440, 4069873815, 903000504, 3872411633, 2462528191},
				A:   [7]uint32{3829791165, 433049016, 4093462546, 3542397050, 4008168921, 2811599116, 3234984083},
				PC:  13891552,
				SR:  42760,
				USP: 2009830,
				SSP: 6357568,
				RAM: [][2]uint32{{13891548, 15}, {13891549, 207}, {13891550, 102}, {13891551, 186}, {13891552, 6}, {13891553, 148}, {13891554, 213}, {13891555, 2}},
			},
			want: cpuState{
				D:   [8]uint32{2178325792, 3820349588, 1549174006, 22366440, 4069873815, 903000504, 3872411633, 2462528191},
				A:   [7]uint32{3829791165, 433049016, 4093462546, 3542397050, 4008168921, 2811599116, 3234984083},
				PC:  13891556,
				SR:  42760,
				USP: 2009830,
				SSP: 6357568,
				RAM: [][2]uint32{{13891548, 15}, {13891549, 207}, {13891550, 102}, {13891551, 186}, {13891552, 6}, {13891553, 148}, {6383866, 146}, {6383867, 0}, {6383868, 199}, {6383869, 0}, {6383870, 50}, {6383871, 0}, {6383872, 191}, {6383873, 0}, {13891554, 213}, {13891555, 2}},
				Cycles: 24,
			},
		},
		{
			name: "1000 MOVEP.l (d16, A3), D7 0f4b",
			init: cpuState{
				D:   [8]uint32{181649706, 1556330894, 1209281153, 966176502, 3258269094, 1499178588, 2514617987, 2134843533},
				A:   [7]uint32{4022784991, 3226316060, 307662660, 3058412433, 567047742, 4126437274, 1282492117},
				PC:  8214604,
				SR:  539,
				USP: 439976,
				SSP: 14736328,
				RAM: [][2]uint32{{8214600, 15}, {8214601, 75}, {8214602, 11}, {8214603, 71}, {8214604, 141}, {8214605, 12}, {4962008, 7}, {4962009, 147}, {4962010, 83}, {4962011, 191}, {4962012, 8}, {4962013, 34}, {4962014, 126}, {4962015, 249}, {8214606, 76}, {8214607, 65}},
			},
			want: cpuState{
				D:   [8]uint32{181649706, 1556330894, 1209281153, 966176502, 3258269094, 1499178588, 2514617987, 122882174},
				A:   [7]uint32{4022784991, 3226316060, 307662660, 3058412433, 567047742, 4126437274, 1282492117},
				PC:  8214608,
				SR:  539,
				USP: 439976,
				SSP: 14736328,
				RAM: [][2]uint32{{8214600, 15}, {8214601, 75}, {8214602, 11}, {8214603, 71}, {8214604, 141}, {8214605, 12}, {4962008, 7}, {4962009, 147}, {4962010, 83}, {4962011, 191}, {4962012, 8}, {4962013, 34}, {4962014, 126}, {4962015, 249}, {8214606, 76}, {8214607, 65}},
				Cycles: 24,
			},
		},
		{
			name: "1500 MOVEP.l D1, (d16, A5) 03cd",
			init: cpuState{
				D:   [8]uint32{4235050599, 2335963197, 1162917682, 2116788043, 825373824, 2732341304, 3494177588, 1424381000},
				A:   [7]uint32{354848135, 1435205961, 2029701113, 1152094514, 1022307975, 295552045, 2974376612},
				PC:  11979286,
				SR:  1051,
				USP: 10008830,
				SSP: 12286856,
				RAM: [][2]uint32{{11979282, 3}, {11979283, 205}, {11979284, 102}, {11979285, 92}, {11979286, 88}, {11979287, 181}, {11979288, 30}, {11979289, 155}},
			},
			want: cpuState{
				D:   [8]uint32{4235050599, 2335963197, 1162917682, 2116788043, 825373824, 2732341304, 3494177588, 1424381000},
				A:   [7]uint32{354848135, 1435205961, 2029701113, 1152094514, 1022307975, 295552045, 2974376612},
				PC:  11979290,
				SR:  1051,
				USP: 10008830,
				SSP: 12286856,
				RAM: [][2]uint32{{11979282, 3}, {11979283, 205}, {11979284, 102}, {11979285, 92}, {11979286, 88}, {11979287, 181}, {10365576, 0}, {10365577, 139}, {10365578, 0}, {10365579, 59}, {10365580, 0}, {10365581, 248}, {10365582, 0}, {10365583, 61}, {11979288, 30}, {11979289, 155}},
				Cycles: 24,
			},
		},
		{
			name: "2000 MOVEP.l D4, (d16, A4) 09cc",
			init: cpuState{
				D:   [8]uint32{88835063, 3571242109, 3005440447, 787321317, 726220596, 2549276370, 2823614118, 1509090745},
				A:   [7]uint32{318435081, 3641451747, 1621266865, 2121066610, 1092268327, 991024016, 386781852},
				PC:  7453378,
				SR:  9752,
				USP: 229486,
				SSP: 8591596,
				RAM: [][2]uint32{{7453374, 9}, {7453375, 204}, {7453376, 104}, {7453377, 208}, {7453378, 183}, {7453379, 201}, {7453380, 197}, {7453381, 79}},
			},
			want: cpuState{
				D:   [8]uint32{88835063, 3571242109, 3005440447, 787321317, 726220596, 2549276370, 2823614118, 1509090745},
				A:   [7]uint32{318435081, 3641451747, 1621266865, 2121066610, 1092268327, 991024016, 386781852},
				PC:  7453382,
				SR:  9752,
				USP: 229486,
				SSP: 8591596,
				RAM: [][2]uint32{{7453374, 9}, {7453375, 204}, {7453376, 104}, {7453377, 208}, {7453378, 183}, {7453379, 201}, {1776118, 0}, {1776119, 43}, {1776120, 0}, {1776121, 73}, {1776122, 0}, {1776123, 63}, {1776124, 0}, {1776125, 52}, {7453380, 197}, {7453381, 79}},
				Cycles: 24,
			},
		},
		{
			name: "004 MOVEP.l (d16, A5), D0 014d",
			init: 			cpuState{
				D:   [8]uint32{400064063, 3936386111, 4047031823, 3969093153, 3553484658, 1200606852, 3091790400, 1702499674},
				A:   [7]uint32{2468356623, 437359343, 3711738929, 3500373125, 1924285093, 1388403896, 1600268085},
				PC:  3139552,
				SR:  8726,
				USP: 14083270,
				SSP: 11469944,
				RAM: [][2]uint32{{3139548, 1}, {3139549, 77}, {3139550, 28}, {3139551, 173}, {3139552, 46}, {3139553, 96}, {12679524, 242}, {12679525, 119}, {12679526, 166}, {12679527, 17}, {12679528, 205}, {12679529, 145}, {12679530, 160}, {12679531, 134}, {3139554, 167}, {3139555, 138}},
			},
			want: 			cpuState{
				D:   [8]uint32{1997640070, 3936386111, 4047031823, 3969093153, 3553484658, 1200606852, 3091790400, 1702499674},
				A:   [7]uint32{2468356623, 437359343, 3711738929, 3500373125, 1924285093, 1388403896, 1600268085},
				PC:  3139556,
				SR:  8726,
				USP: 14083270,
				SSP: 11469944,
				RAM: [][2]uint32{{3139548, 1}, {3139549, 77}, {3139550, 28}, {3139551, 173}, {3139552, 46}, {3139553, 96}, {12679524, 242}, {12679525, 119}, {12679526, 166}, {12679527, 17}, {12679528, 205}, {12679529, 145}, {12679530, 160}, {12679531, 134}, {3139554, 167}, {3139555, 138}},
				Cycles: 24,
			},
		},
		{
			name: "286 MOVEP.l D5, (d16, A6) 0bce",
			init: 			cpuState{
				D:   [8]uint32{1868881812, 1899571294, 3611517939, 1704843036, 3645764693, 770979724, 3809652852, 1386966627},
				A:   [7]uint32{844585516, 4187971218, 507978674, 2315196291, 4097452929, 1131897791, 950300133},
				PC:  3397242,
				SR:  8713,
				USP: 4384028,
				SSP: 8903692,
				RAM: [][2]uint32{{3397238, 11}, {3397239, 206}, {3397240, 7}, {3397241, 67}, {3397242, 15}, {3397243, 39}, {3397244, 203}, {3397245, 165}},
			},
			want: 			cpuState{
				D:   [8]uint32{1868881812, 1899571294, 3611517939, 1704843036, 3645764693, 770979724, 3809652852, 1386966627},
				A:   [7]uint32{844585516, 4187971218, 507978674, 2315196291, 4097452929, 1131897791, 950300133},
				PC:  3397246,
				SR:  8713,
				USP: 4384028,
				SSP: 8903692,
				RAM: [][2]uint32{{3397238, 11}, {3397239, 206}, {3397240, 7}, {3397241, 67}, {3397242, 15}, {3397243, 39}, {10777896, 45}, {10777897, 0}, {10777898, 244}, {10777899, 0}, {10777900, 55}, {10777901, 0}, {10777902, 140}, {10777903, 0}, {3397244, 203}, {3397245, 165}},
				Cycles: 24,
			},
		},
		{
			name: "562 MOVEP.l D1, (d16, A4) 03cc",
			init: 			cpuState{
				D:   [8]uint32{3028583969, 2984388541, 81402692, 3086613315, 1373085820, 3264959167, 3050296710, 1833780277},
				A:   [7]uint32{3678703412, 543223867, 1597361936, 2571531114, 1523157791, 2619002849, 147970379},
				PC:  13700722,
				SR:  8980,
				USP: 2172038,
				SSP: 11493320,
				RAM: [][2]uint32{{13700718, 3}, {13700719, 204}, {13700720, 132}, {13700721, 119}, {13700722, 73}, {13700723, 34}, {13700724, 40}, {13700725, 134}},
			},
			want: 			cpuState{
				D:   [8]uint32{3028583969, 2984388541, 81402692, 3086613315, 1373085820, 3264959167, 3050296710, 1833780277},
				A:   [7]uint32{3678703412, 543223867, 1597361936, 2571531114, 1523157791, 2619002849, 147970379},
				PC:  13700726,
				SR:  8980,
				USP: 2172038,
				SSP: 11493320,
				RAM: [][2]uint32{{13700718, 3}, {13700719, 204}, {13700720, 132}, {13700721, 119}, {13700722, 73}, {13700723, 34}, {13176726, 177}, {13176727, 0}, {13176728, 226}, {13176729, 0}, {13176730, 39}, {13176731, 0}, {13176732, 189}, {13176733, 0}, {13700724, 40}, {13700725, 134}},
				Cycles: 24,
			},
		},
		{
			name: "842 MOVEP.l D4, (d16, A4) 09cc",
			init: 			cpuState{
				D:   [8]uint32{3547481308, 318044874, 2584986084, 1018117923, 2002198458, 834345609, 955614193, 2979462428},
				A:   [7]uint32{1694445202, 629853888, 503847940, 637380093, 3924068691, 1160126828, 4210562945},
				PC:  11489724,
				SR:  8722,
				USP: 4644758,
				SSP: 8976178,
				RAM: [][2]uint32{{11489720, 9}, {11489721, 204}, {11489722, 109}, {11489723, 115}, {11489724, 56}, {11489725, 200}, {11489726, 37}, {11489727, 164}},
			},
			want: 			cpuState{
				D:   [8]uint32{3547481308, 318044874, 2584986084, 1018117923, 2002198458, 834345609, 955614193, 2979462428},
				A:   [7]uint32{1694445202, 629853888, 503847940, 637380093, 3924068691, 1160126828, 4210562945},
				PC:  11489728,
				SR:  8722,
				USP: 4644758,
				SSP: 8976178,
				RAM: [][2]uint32{{11489720, 9}, {11489721, 204}, {11489722, 109}, {11489723, 115}, {11489724, 56}, {11489725, 200}, {15005382, 119}, {15005383, 0}, {15005384, 87}, {15005385, 0}, {15005386, 31}, {15005387, 0}, {15005388, 186}, {15005389, 0}, {11489726, 37}, {11489727, 164}},
				Cycles: 24,
			},
		},
		{
			name: "1099 MOVEP.l (d16, A4), D0 014c",
			init: 			cpuState{
				D:   [8]uint32{539583001, 2239990549, 1632566663, 1759982637, 3211171587, 1411901498, 1134304618, 107308567},
				A:   [7]uint32{1174966666, 767545586, 3844174132, 2940438234, 2160697876, 2011320696, 2168942159},
				PC:  1500748,
				SR:  1301,
				USP: 4697020,
				SSP: 15799716,
				RAM: [][2]uint32{{1500744, 1}, {1500745, 76}, {1500746, 53}, {1500747, 2}, {1500748, 98}, {1500749, 215}, {13227798, 66}, {13227799, 210}, {13227800, 242}, {13227801, 129}, {13227802, 12}, {13227803, 76}, {13227804, 83}, {13227805, 181}, {1500750, 105}, {1500751, 48}},
			},
			want: 			cpuState{
				D:   [8]uint32{1123159123, 2239990549, 1632566663, 1759982637, 3211171587, 1411901498, 1134304618, 107308567},
				A:   [7]uint32{1174966666, 767545586, 3844174132, 2940438234, 2160697876, 2011320696, 2168942159},
				PC:  1500752,
				SR:  1301,
				USP: 4697020,
				SSP: 15799716,
				RAM: [][2]uint32{{1500744, 1}, {1500745, 76}, {1500746, 53}, {1500747, 2}, {1500748, 98}, {1500749, 215}, {13227798, 66}, {13227799, 210}, {13227800, 242}, {13227801, 129}, {13227802, 12}, {13227803, 76}, {13227804, 83}, {13227805, 181}, {1500750, 105}, {1500751, 48}},
				Cycles: 24,
			},
		},
		{
			name: "1401 MOVEP.l (d16, A3), D7 0f4b",
			init: 			cpuState{
				D:   [8]uint32{373724904, 1756056276, 3525530640, 426428351, 650425541, 1643747428, 1603386636, 4142127811},
				A:   [7]uint32{3937084510, 2572491420, 2315872551, 1597967779, 1229859785, 2666402465, 3916584234},
				PC:  15862372,
				SR:  1029,
				USP: 8385566,
				SSP: 5345084,
				RAM: [][2]uint32{{15862368, 15}, {15862369, 75}, {15862370, 251}, {15862371, 112}, {15862372, 89}, {15862373, 139}, {4131090, 166}, {4131091, 29}, {4131092, 119}, {4131093, 198}, {4131094, 87}, {4131095, 32}, {4131096, 51}, {4131097, 201}, {15862374, 147}, {15862375, 65}},
			},
			want: 			cpuState{
				D:   [8]uint32{373724904, 1756056276, 3525530640, 426428351, 650425541, 1643747428, 1603386636, 499523785},
				A:   [7]uint32{3937084510, 2572491420, 2315872551, 1597967779, 1229859785, 2666402465, 3916584234},
				PC:  15862376,
				SR:  1029,
				USP: 8385566,
				SSP: 5345084,
				RAM: [][2]uint32{{15862368, 15}, {15862369, 75}, {15862370, 251}, {15862371, 112}, {15862372, 89}, {15862373, 139}, {4131090, 166}, {4131091, 29}, {4131092, 119}, {4131093, 198}, {4131094, 87}, {4131095, 32}, {4131096, 51}, {4131097, 201}, {15862374, 147}, {15862375, 65}},
				Cycles: 24,
			},
		},
		{
			name: "1689 MOVEP.l (d16, A7), D0 014f",
			init: 			cpuState{
				D:   [8]uint32{3525940075, 1017248792, 1717608593, 29315226, 810374887, 402142941, 563663923, 3563423840},
				A:   [7]uint32{1776786469, 2950388386, 746150380, 1718935622, 2915726777, 847748905, 3089326127},
				PC:  2882050,
				SR:  1294,
				USP: 16603162,
				SSP: 5493712,
				RAM: [][2]uint32{{2882046, 1}, {2882047, 79}, {2882048, 131}, {2882049, 131}, {2882050, 100}, {2882051, 93}, {16571292, 172}, {16571293, 12}, {16571294, 13}, {16571295, 102}, {16571296, 114}, {16571297, 3}, {16571298, 77}, {16571299, 16}, {2882052, 234}, {2882053, 228}},
			},
			want: 			cpuState{
				D:   [8]uint32{208012048, 1017248792, 1717608593, 29315226, 810374887, 402142941, 563663923, 3563423840},
				A:   [7]uint32{1776786469, 2950388386, 746150380, 1718935622, 2915726777, 847748905, 3089326127},
				PC:  2882054,
				SR:  1294,
				USP: 16603162,
				SSP: 5493712,
				RAM: [][2]uint32{{2882046, 1}, {2882047, 79}, {2882048, 131}, {2882049, 131}, {2882050, 100}, {2882051, 93}, {16571292, 172}, {16571293, 12}, {16571294, 13}, {16571295, 102}, {16571296, 114}, {16571297, 3}, {16571298, 77}, {16571299, 16}, {2882052, 234}, {2882053, 228}},
				Cycles: 24,
			},
		},
		{
			name: "1943 MOVEP.l (d16, A7), D2 054f",
			init: 			cpuState{
				D:   [8]uint32{828028587, 2526701342, 2898284629, 217312962, 543403912, 2572655161, 1242716527, 1310415844},
				A:   [7]uint32{3394273258, 1966383700, 1686817125, 2365578834, 4262406502, 4260400992, 1297026471},
				PC:  4627450,
				SR:  8207,
				USP: 5704634,
				SSP: 8941236,
				RAM: [][2]uint32{{4627446, 5}, {4627447, 79}, {4627448, 153}, {4627449, 89}, {4627450, 113}, {4627451, 193}, {8914956, 246}, {8914957, 8}, {8914958, 10}, {8914959, 215}, {8914960, 236}, {8914961, 110}, {8914962, 99}, {8914963, 36}, {4627452, 28}, {4627453, 212}},
			},
			want: 			cpuState{
				D:   [8]uint32{828028587, 2526701342, 148336164, 217312962, 543403912, 2572655161, 1242716527, 1310415844},
				A:   [7]uint32{3394273258, 1966383700, 1686817125, 2365578834, 4262406502, 4260400992, 1297026471},
				PC:  4627454,
				SR:  8207,
				USP: 5704634,
				SSP: 8941236,
				RAM: [][2]uint32{{4627446, 5}, {4627447, 79}, {4627448, 153}, {4627449, 89}, {4627450, 113}, {4627451, 193}, {8914956, 246}, {8914957, 8}, {8914958, 10}, {8914959, 215}, {8914960, 236}, {8914961, 110}, {8914962, 99}, {8914963, 36}, {4627452, 28}, {4627453, 212}},
				Cycles: 24,
			},
		},
		{
			name: "2231 MOVEP.l (d16, A0), D0 0148",
			init: 			cpuState{
				D:   [8]uint32{3761529535, 1534018293, 3367550641, 676350216, 3218378196, 2257699435, 3686478107, 1791775100},
				A:   [7]uint32{1592475831, 1432237942, 18883909, 1975042637, 1415705585, 750017115, 1867093634},
				PC:  12873536,
				SR:  10013,
				USP: 1328960,
				SSP: 9438332,
				RAM: [][2]uint32{{12873532, 1}, {12873533, 72}, {12873534, 95}, {12873535, 159}, {12873536, 218}, {12873537, 106}, {15442006, 27}, {15442007, 103}, {15442008, 229}, {15442009, 8}, {15442010, 241}, {15442011, 138}, {15442012, 211}, {15442013, 181}, {12873538, 246}, {12873539, 231}},
			},
			want: 			cpuState{
				D:   [8]uint32{468054483, 1534018293, 3367550641, 676350216, 3218378196, 2257699435, 3686478107, 1791775100},
				A:   [7]uint32{1592475831, 1432237942, 18883909, 1975042637, 1415705585, 750017115, 1867093634},
				PC:  12873540,
				SR:  10013,
				USP: 1328960,
				SSP: 9438332,
				RAM: [][2]uint32{{12873532, 1}, {12873533, 72}, {12873534, 95}, {12873535, 159}, {12873536, 218}, {12873537, 106}, {15442006, 27}, {15442007, 103}, {15442008, 229}, {15442009, 8}, {15442010, 241}, {15442011, 138}, {15442012, 211}, {15442013, 181}, {12873538, 246}, {12873539, 231}},
				Cycles: 24,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEXG(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EXG D7, A7 cf8f",
			init: cpuState{
				D:   [8]uint32{1888175508, 3108803468, 219895122, 4195215335, 3449135861, 1008144086, 508757964, 3028813163},
				A:   [7]uint32{2141151280, 3533111880, 28917785, 3522979631, 556247249, 3812665290, 3243570130},
				PC:  150610,
				SR:  33821,
				USP: 1243398,
				SSP: 9177636,
				RAM: [][2]uint32{{150606, 207}, {150607, 143}, {150608, 15}, {150609, 222}, {150610, 65}, {150611, 49}},
			},
			want: cpuState{
				D:   [8]uint32{1888175508, 3108803468, 219895122, 4195215335, 3449135861, 1008144086, 508757964, 1243398},
				A:   [7]uint32{2141151280, 3533111880, 28917785, 3522979631, 556247249, 3812665290, 3243570130},
				PC:  150612,
				SR:  33821,
				USP: 3028813163,
				SSP: 9177636,
				RAM: [][2]uint32{{150606, 207}, {150607, 143}, {150608, 15}, {150609, 222}, {150610, 65}, {150611, 49}},
				Cycles: 6,
			},
		},
		{
			name: "500 EXG D1, D3 c343",
			init: cpuState{
				D:   [8]uint32{3171469755, 1177836952, 2594920178, 4037876690, 1650046882, 2278091015, 4090583427, 1030633944},
				A:   [7]uint32{1657710008, 2378969233, 1303918343, 3396689983, 231170386, 381197826, 4058117224},
				PC:  15289636,
				SR:  14,
				USP: 9820980,
				SSP: 2327980,
				RAM: [][2]uint32{{15289632, 195}, {15289633, 67}, {15289634, 160}, {15289635, 201}, {15289636, 11}, {15289637, 25}},
			},
			want: cpuState{
				D:   [8]uint32{3171469755, 4037876690, 2594920178, 1177836952, 1650046882, 2278091015, 4090583427, 1030633944},
				A:   [7]uint32{1657710008, 2378969233, 1303918343, 3396689983, 231170386, 381197826, 4058117224},
				PC:  15289638,
				SR:  14,
				USP: 9820980,
				SSP: 2327980,
				RAM: [][2]uint32{{15289632, 195}, {15289633, 67}, {15289634, 160}, {15289635, 201}, {15289636, 11}, {15289637, 25}},
				Cycles: 6,
			},
		},
		{
			name: "1000 EXG D6, D0 cd40",
			init: cpuState{
				D:   [8]uint32{1090796337, 1337748120, 2407918376, 4079234292, 2601839893, 2830070862, 1026964474, 3584828778},
				A:   [7]uint32{3490168468, 3169671599, 798452632, 362283221, 615694868, 3688066632, 107113425},
				PC:  7811920,
				SR:  34067,
				USP: 9507868,
				SSP: 15853378,
				RAM: [][2]uint32{{7811916, 205}, {7811917, 64}, {7811918, 165}, {7811919, 151}, {7811920, 113}, {7811921, 40}},
			},
			want: cpuState{
				D:   [8]uint32{1026964474, 1337748120, 2407918376, 4079234292, 2601839893, 2830070862, 1090796337, 3584828778},
				A:   [7]uint32{3490168468, 3169671599, 798452632, 362283221, 615694868, 3688066632, 107113425},
				PC:  7811922,
				SR:  34067,
				USP: 9507868,
				SSP: 15853378,
				RAM: [][2]uint32{{7811916, 205}, {7811917, 64}, {7811918, 165}, {7811919, 151}, {7811920, 113}, {7811921, 40}},
				Cycles: 6,
			},
		},
		{
			name: "1500 EXG D2, D3 c543",
			init: cpuState{
				D:   [8]uint32{2248561383, 326557272, 3661997149, 318528230, 1836663462, 3379723510, 1755324543, 643350138},
				A:   [7]uint32{4049852996, 43782880, 1734132742, 1831595101, 15492424, 850485980, 1868524802},
				PC:  8247774,
				SR:  1047,
				USP: 2947502,
				SSP: 15890074,
				RAM: [][2]uint32{{8247770, 197}, {8247771, 67}, {8247772, 101}, {8247773, 45}, {8247774, 68}, {8247775, 6}},
			},
			want: cpuState{
				D:   [8]uint32{2248561383, 326557272, 318528230, 3661997149, 1836663462, 3379723510, 1755324543, 643350138},
				A:   [7]uint32{4049852996, 43782880, 1734132742, 1831595101, 15492424, 850485980, 1868524802},
				PC:  8247776,
				SR:  1047,
				USP: 2947502,
				SSP: 15890074,
				RAM: [][2]uint32{{8247770, 197}, {8247771, 67}, {8247772, 101}, {8247773, 45}, {8247774, 68}, {8247775, 6}},
				Cycles: 6,
			},
		},
		{
			name: "2000 EXG D7, A4 cf8c",
			init: cpuState{
				D:   [8]uint32{1393951938, 2267720537, 1631248667, 32474115, 3937583195, 3578396058, 1753107487, 1652031761},
				A:   [7]uint32{2868558310, 1997460210, 1467480678, 615747392, 1096867009, 3036804865, 1674428331},
				PC:  317480,
				SR:  8193,
				USP: 20948,
				SSP: 6057004,
				RAM: [][2]uint32{{317476, 207}, {317477, 140}, {317478, 142}, {317479, 232}, {317480, 112}, {317481, 215}},
			},
			want: cpuState{
				D:   [8]uint32{1393951938, 2267720537, 1631248667, 32474115, 3937583195, 3578396058, 1753107487, 1096867009},
				A:   [7]uint32{2868558310, 1997460210, 1467480678, 615747392, 1652031761, 3036804865, 1674428331},
				PC:  317482,
				SR:  8193,
				USP: 20948,
				SSP: 6057004,
				RAM: [][2]uint32{{317476, 207}, {317477, 140}, {317478, 142}, {317479, 232}, {317480, 112}, {317481, 215}},
				Cycles: 6,
			},
		},
		{
			name: "002 EXG A0, A5 c14d",
			init: 			cpuState{
				D:   [8]uint32{1462536505, 1788280684, 1956053195, 4236830134, 1578751013, 1102285039, 2185336457, 2644005891},
				A:   [7]uint32{2207340700, 1283494763, 2009411424, 3888853451, 2208034756, 541268905, 2585948240},
				PC:  9011986,
				SR:  525,
				USP: 16076624,
				SSP: 15394292,
				RAM: [][2]uint32{{9011982, 193}, {9011983, 77}, {9011984, 235}, {9011985, 193}, {9011986, 102}, {9011987, 179}},
			},
			want: 			cpuState{
				D:   [8]uint32{1462536505, 1788280684, 1956053195, 4236830134, 1578751013, 1102285039, 2185336457, 2644005891},
				A:   [7]uint32{541268905, 1283494763, 2009411424, 3888853451, 2208034756, 2207340700, 2585948240},
				PC:  9011988,
				SR:  525,
				USP: 16076624,
				SSP: 15394292,
				RAM: [][2]uint32{{9011982, 193}, {9011983, 77}, {9011984, 235}, {9011985, 193}, {9011986, 102}, {9011987, 179}},
				Cycles: 6,
			},
		},
		{
			name: "284 EXG D7, D1 cf41",
			init: 			cpuState{
				D:   [8]uint32{2792144970, 2281015805, 753271919, 1350716923, 528234967, 916661517, 356421383, 805029192},
				A:   [7]uint32{975742245, 1592695493, 377085188, 3484474578, 4114597001, 293185736, 2793340279},
				PC:  6389604,
				SR:  9,
				USP: 14030976,
				SSP: 1349676,
				RAM: [][2]uint32{{6389600, 207}, {6389601, 65}, {6389602, 172}, {6389603, 120}, {6389604, 91}, {6389605, 124}},
			},
			want: 			cpuState{
				D:   [8]uint32{2792144970, 805029192, 753271919, 1350716923, 528234967, 916661517, 356421383, 2281015805},
				A:   [7]uint32{975742245, 1592695493, 377085188, 3484474578, 4114597001, 293185736, 2793340279},
				PC:  6389606,
				SR:  9,
				USP: 14030976,
				SSP: 1349676,
				RAM: [][2]uint32{{6389600, 207}, {6389601, 65}, {6389602, 172}, {6389603, 120}, {6389604, 91}, {6389605, 124}},
				Cycles: 6,
			},
		},
		{
			name: "567 EXG D2, A4 c58c",
			init: 			cpuState{
				D:   [8]uint32{2155772755, 3103309663, 3554434737, 1097990085, 1540879501, 3310746374, 1725061841, 889552895},
				A:   [7]uint32{3342735263, 357869070, 2158542206, 3171899251, 2462823928, 3684966631, 501633149},
				PC:  12662706,
				SR:  9487,
				USP: 7417734,
				SSP: 5869820,
				RAM: [][2]uint32{{12662702, 197}, {12662703, 140}, {12662704, 215}, {12662705, 182}, {12662706, 188}, {12662707, 86}},
			},
			want: 			cpuState{
				D:   [8]uint32{2155772755, 3103309663, 2462823928, 1097990085, 1540879501, 3310746374, 1725061841, 889552895},
				A:   [7]uint32{3342735263, 357869070, 2158542206, 3171899251, 3554434737, 3684966631, 501633149},
				PC:  12662708,
				SR:  9487,
				USP: 7417734,
				SSP: 5869820,
				RAM: [][2]uint32{{12662702, 197}, {12662703, 140}, {12662704, 215}, {12662705, 182}, {12662706, 188}, {12662707, 86}},
				Cycles: 6,
			},
		},
		{
			name: "817 EXG D5, A7 cb8f",
			init: 			cpuState{
				D:   [8]uint32{2880030501, 2851250203, 3080472709, 2153873267, 3419340120, 1342601592, 1709958532, 52692301},
				A:   [7]uint32{2472964230, 153280026, 4018519360, 2093785097, 3240933211, 2074008440, 3049196429},
				PC:  7864692,
				SR:  267,
				USP: 9679212,
				SSP: 1615744,
				RAM: [][2]uint32{{7864688, 203}, {7864689, 143}, {7864690, 154}, {7864691, 182}, {7864692, 227}, {7864693, 245}},
			},
			want: 			cpuState{
				D:   [8]uint32{2880030501, 2851250203, 3080472709, 2153873267, 3419340120, 9679212, 1709958532, 52692301},
				A:   [7]uint32{2472964230, 153280026, 4018519360, 2093785097, 3240933211, 2074008440, 3049196429},
				PC:  7864694,
				SR:  267,
				USP: 1342601592,
				SSP: 1615744,
				RAM: [][2]uint32{{7864688, 203}, {7864689, 143}, {7864690, 154}, {7864691, 182}, {7864692, 227}, {7864693, 245}},
				Cycles: 6,
			},
		},
		{
			name: "1094 EXG D5, A0 cb88",
			init: 			cpuState{
				D:   [8]uint32{1232954026, 3639806284, 3495953218, 3201220158, 4213918389, 1752504383, 710915563, 525464830},
				A:   [7]uint32{2430460924, 3341663413, 964669254, 1055751844, 2209954521, 794126021, 3797128426},
				PC:  9500530,
				SR:  8710,
				USP: 3773812,
				SSP: 9503626,
				RAM: [][2]uint32{{9500526, 203}, {9500527, 136}, {9500528, 112}, {9500529, 124}, {9500530, 240}, {9500531, 7}},
			},
			want: 			cpuState{
				D:   [8]uint32{1232954026, 3639806284, 3495953218, 3201220158, 4213918389, 2430460924, 710915563, 525464830},
				A:   [7]uint32{1752504383, 3341663413, 964669254, 1055751844, 2209954521, 794126021, 3797128426},
				PC:  9500532,
				SR:  8710,
				USP: 3773812,
				SSP: 9503626,
				RAM: [][2]uint32{{9500526, 203}, {9500527, 136}, {9500528, 112}, {9500529, 124}, {9500530, 240}, {9500531, 7}},
				Cycles: 6,
			},
		},
		{
			name: "1372 EXG D0, A1 c189",
			init: 			cpuState{
				D:   [8]uint32{618269387, 1400421604, 839001811, 1331197875, 1824036225, 3821059476, 2055270551, 2826701582},
				A:   [7]uint32{707241117, 2378778867, 208961561, 3495131688, 899602772, 412060704, 1186187578},
				PC:  3869124,
				SR:  10008,
				USP: 4771878,
				SSP: 1131862,
				RAM: [][2]uint32{{3869120, 193}, {3869121, 137}, {3869122, 187}, {3869123, 235}, {3869124, 172}, {3869125, 211}},
			},
			want: 			cpuState{
				D:   [8]uint32{2378778867, 1400421604, 839001811, 1331197875, 1824036225, 3821059476, 2055270551, 2826701582},
				A:   [7]uint32{707241117, 618269387, 208961561, 3495131688, 899602772, 412060704, 1186187578},
				PC:  3869126,
				SR:  10008,
				USP: 4771878,
				SSP: 1131862,
				RAM: [][2]uint32{{3869120, 193}, {3869121, 137}, {3869122, 187}, {3869123, 235}, {3869124, 172}, {3869125, 211}},
				Cycles: 6,
			},
		},
		{
			name: "1661 EXG D3, A2 c78a",
			init: 			cpuState{
				D:   [8]uint32{3843531420, 837910751, 3710873552, 3752710554, 503393222, 1833892670, 1133689605, 2639500528},
				A:   [7]uint32{1673532063, 156329639, 259938848, 2905561378, 1143528949, 1580261752, 2622922166},
				PC:  3650402,
				SR:  1546,
				USP: 7983978,
				SSP: 14542964,
				RAM: [][2]uint32{{3650398, 199}, {3650399, 138}, {3650400, 198}, {3650401, 152}, {3650402, 151}, {3650403, 195}},
			},
			want: 			cpuState{
				D:   [8]uint32{3843531420, 837910751, 3710873552, 259938848, 503393222, 1833892670, 1133689605, 2639500528},
				A:   [7]uint32{1673532063, 156329639, 3752710554, 2905561378, 1143528949, 1580261752, 2622922166},
				PC:  3650404,
				SR:  1546,
				USP: 7983978,
				SSP: 14542964,
				RAM: [][2]uint32{{3650398, 199}, {3650399, 138}, {3650400, 198}, {3650401, 152}, {3650402, 151}, {3650403, 195}},
				Cycles: 6,
			},
		},
		{
			name: "1919 EXG D2, D0 c540",
			init: 			cpuState{
				D:   [8]uint32{643610957, 1668494204, 1625151039, 644214996, 383699705, 827491401, 1137344292, 2551823630},
				A:   [7]uint32{3097108440, 2482583876, 176149800, 1015074753, 143542252, 3826102850, 857721682},
				PC:  5882088,
				SR:  524,
				USP: 8900928,
				SSP: 16245220,
				RAM: [][2]uint32{{5882084, 197}, {5882085, 64}, {5882086, 161}, {5882087, 155}, {5882088, 255}, {5882089, 84}},
			},
			want: 			cpuState{
				D:   [8]uint32{1625151039, 1668494204, 643610957, 644214996, 383699705, 827491401, 1137344292, 2551823630},
				A:   [7]uint32{3097108440, 2482583876, 176149800, 1015074753, 143542252, 3826102850, 857721682},
				PC:  5882090,
				SR:  524,
				USP: 8900928,
				SSP: 16245220,
				RAM: [][2]uint32{{5882084, 197}, {5882085, 64}, {5882086, 161}, {5882087, 155}, {5882088, 255}, {5882089, 84}},
				Cycles: 6,
			},
		},
		{
			name: "2184 EXG A0, A5 c14d",
			init: 			cpuState{
				D:   [8]uint32{3960482435, 1253203626, 2219915518, 1135730805, 60524087, 968257286, 3832929710, 99458046},
				A:   [7]uint32{4008519474, 919250825, 3378791192, 20078445, 2232378306, 776029672, 1578571977},
				PC:  5171372,
				SR:  1280,
				USP: 2311346,
				SSP: 1555120,
				RAM: [][2]uint32{{5171368, 193}, {5171369, 77}, {5171370, 231}, {5171371, 127}, {5171372, 24}, {5171373, 248}},
			},
			want: 			cpuState{
				D:   [8]uint32{3960482435, 1253203626, 2219915518, 1135730805, 60524087, 968257286, 3832929710, 99458046},
				A:   [7]uint32{776029672, 919250825, 3378791192, 20078445, 2232378306, 4008519474, 1578571977},
				PC:  5171374,
				SR:  1280,
				USP: 2311346,
				SSP: 1555120,
				RAM: [][2]uint32{{5171368, 193}, {5171369, 77}, {5171370, 231}, {5171371, 127}, {5171372, 24}, {5171373, 248}},
				Cycles: 6,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSWAP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SWAP D3 4843",
			init: cpuState{
				D:   [8]uint32{1510753054, 4071567957, 3839256128, 1926237086, 89012861, 2466081603, 1103358500, 3344103847},
				A:   [7]uint32{3298303314, 1066111233, 3272664423, 3745714625, 1929345019, 2064452560, 1567622384},
				PC:  1727030,
				SR:  40969,
				USP: 5955164,
				SSP: 12514624,
				RAM: [][2]uint32{{1727026, 72}, {1727027, 67}, {1727028, 65}, {1727029, 173}, {1727030, 65}, {1727031, 109}},
			},
			want: cpuState{
				D:   [8]uint32{1510753054, 4071567957, 3839256128, 194933456, 89012861, 2466081603, 1103358500, 3344103847},
				A:   [7]uint32{3298303314, 1066111233, 3272664423, 3745714625, 1929345019, 2064452560, 1567622384},
				PC:  1727032,
				SR:  40960,
				USP: 5955164,
				SSP: 12514624,
				RAM: [][2]uint32{{1727026, 72}, {1727027, 67}, {1727028, 65}, {1727029, 173}, {1727030, 65}, {1727031, 109}},
				Cycles: 4,
			},
		},
		{
			name: "500 SWAP D0 4840",
			init: cpuState{
				D:   [8]uint32{3176670268, 3264999578, 3491863735, 1281144200, 1150138852, 3056983076, 73458247, 2509658397},
				A:   [7]uint32{763593502, 3241901684, 4164478152, 3357650853, 719767983, 2530061468, 1728560548},
				PC:  585184,
				SR:  41757,
				USP: 12552852,
				SSP: 4751156,
				RAM: [][2]uint32{{585180, 72}, {585181, 64}, {585182, 251}, {585183, 247}, {585184, 43}, {585185, 70}},
			},
			want: cpuState{
				D:   [8]uint32{607960408, 3264999578, 3491863735, 1281144200, 1150138852, 3056983076, 73458247, 2509658397},
				A:   [7]uint32{763593502, 3241901684, 4164478152, 3357650853, 719767983, 2530061468, 1728560548},
				PC:  585186,
				SR:  41744,
				USP: 12552852,
				SSP: 4751156,
				RAM: [][2]uint32{{585180, 72}, {585181, 64}, {585182, 251}, {585183, 247}, {585184, 43}, {585185, 70}},
				Cycles: 4,
			},
		},
		{
			name: "1000 SWAP D4 4844",
			init: cpuState{
				D:   [8]uint32{377874047, 3212870073, 3697558136, 58389050, 2707623180, 3025811063, 797660070, 2926897917},
				A:   [7]uint32{76292194, 2594198078, 4113855672, 2480821417, 4260527888, 3535776501, 1724895864},
				PC:  15341182,
				SR:  8723,
				USP: 12890034,
				SSP: 4232464,
				RAM: [][2]uint32{{15341178, 72}, {15341179, 68}, {15341180, 185}, {15341181, 162}, {15341182, 214}, {15341183, 246}},
			},
			want: cpuState{
				D:   [8]uint32{377874047, 3212870073, 3697558136, 58389050, 218931555, 3025811063, 797660070, 2926897917},
				A:   [7]uint32{76292194, 2594198078, 4113855672, 2480821417, 4260527888, 3535776501, 1724895864},
				PC:  15341184,
				SR:  8720,
				USP: 12890034,
				SSP: 4232464,
				RAM: [][2]uint32{{15341178, 72}, {15341179, 68}, {15341180, 185}, {15341181, 162}, {15341182, 214}, {15341183, 246}},
				Cycles: 4,
			},
		},
		{
			name: "1500 SWAP D4 4844",
			init: cpuState{
				D:   [8]uint32{2024044825, 3166764157, 3131407536, 2985040659, 1756272378, 3426217085, 718366934, 4164911136},
				A:   [7]uint32{1674021232, 1629719225, 3927246817, 3171387845, 850256298, 2329110938, 4167302230},
				PC:  5541192,
				SR:  1055,
				USP: 13904520,
				SSP: 11046526,
				RAM: [][2]uint32{{5541188, 72}, {5541189, 68}, {5541190, 175}, {5541191, 245}, {5541192, 94}, {5541193, 110}},
			},
			want: cpuState{
				D:   [8]uint32{2024044825, 3166764157, 3131407536, 2985040659, 2532993198, 3426217085, 718366934, 4164911136},
				A:   [7]uint32{1674021232, 1629719225, 3927246817, 3171387845, 850256298, 2329110938, 4167302230},
				PC:  5541194,
				SR:  1048,
				USP: 13904520,
				SSP: 11046526,
				RAM: [][2]uint32{{5541188, 72}, {5541189, 68}, {5541190, 175}, {5541191, 245}, {5541192, 94}, {5541193, 110}},
				Cycles: 4,
			},
		},
		{
			name: "2000 SWAP D1 4841",
			init: cpuState{
				D:   [8]uint32{2656208468, 2512136854, 1357876383, 2920909607, 1661268483, 1201124089, 2971900572, 2546343273},
				A:   [7]uint32{4023638979, 168363960, 143360008, 2826816427, 1951383120, 1446164030, 2916916252},
				PC:  3547906,
				SR:  42515,
				USP: 7982224,
				SSP: 7714018,
				RAM: [][2]uint32{{3547902, 72}, {3547903, 65}, {3547904, 229}, {3547905, 93}, {3547906, 82}, {3547907, 39}},
			},
			want: cpuState{
				D:   [8]uint32{2656208468, 714511804, 1357876383, 2920909607, 1661268483, 1201124089, 2971900572, 2546343273},
				A:   [7]uint32{4023638979, 168363960, 143360008, 2826816427, 1951383120, 1446164030, 2916916252},
				PC:  3547908,
				SR:  42512,
				USP: 7982224,
				SSP: 7714018,
				RAM: [][2]uint32{{3547902, 72}, {3547903, 65}, {3547904, 229}, {3547905, 93}, {3547906, 82}, {3547907, 39}},
				Cycles: 4,
			},
		},
		{
			name: "001 SWAP D7 4847",
			init: 			cpuState{
				D:   [8]uint32{4115843725, 2345382708, 2631360228, 2167464651, 4213326814, 2154268161, 3918099075, 905513621},
				A:   [7]uint32{4203544091, 3876886928, 409453504, 2180760983, 870269992, 4109327655, 50613965},
				PC:  13734736,
				SR:  29,
				USP: 15591342,
				SSP: 5835316,
				RAM: [][2]uint32{{13734732, 72}, {13734733, 71}, {13734734, 113}, {13734735, 158}, {13734736, 93}, {13734737, 40}},
			},
			want: 			cpuState{
				D:   [8]uint32{4115843725, 2345382708, 2631360228, 2167464651, 4213326814, 2154268161, 3918099075, 177550841},
				A:   [7]uint32{4203544091, 3876886928, 409453504, 2180760983, 870269992, 4109327655, 50613965},
				PC:  13734738,
				SR:  16,
				USP: 15591342,
				SSP: 5835316,
				RAM: [][2]uint32{{13734732, 72}, {13734733, 71}, {13734734, 113}, {13734735, 158}, {13734736, 93}, {13734737, 40}},
				Cycles: 4,
			},
		},
		{
			name: "266 SWAP D6 4846",
			init: 			cpuState{
				D:   [8]uint32{1529350294, 2350454871, 1030809777, 3997762323, 1606893815, 3096388700, 1732596860, 3519344033},
				A:   [7]uint32{2738861992, 2226017677, 867143187, 2707323566, 2795518947, 3209720532, 847830950},
				PC:  10131666,
				SR:  8212,
				USP: 7193614,
				SSP: 12518428,
				RAM: [][2]uint32{{10131662, 72}, {10131663, 70}, {10131664, 48}, {10131665, 219}, {10131666, 133}, {10131667, 200}},
			},
			want: 			cpuState{
				D:   [8]uint32{1529350294, 2350454871, 1030809777, 3997762323, 1606893815, 3096388700, 1417439045, 3519344033},
				A:   [7]uint32{2738861992, 2226017677, 867143187, 2707323566, 2795518947, 3209720532, 847830950},
				PC:  10131668,
				SR:  8208,
				USP: 7193614,
				SSP: 12518428,
				RAM: [][2]uint32{{10131662, 72}, {10131663, 70}, {10131664, 48}, {10131665, 219}, {10131666, 133}, {10131667, 200}},
				Cycles: 4,
			},
		},
		{
			name: "547 SWAP D4 4844",
			init: 			cpuState{
				D:   [8]uint32{3356677951, 2963890978, 1647061784, 618575544, 215926433, 4258295899, 1664731656, 4278559721},
				A:   [7]uint32{4253884785, 2833570877, 672174057, 778163537, 2284848431, 3960974658, 1243658429},
				PC:  13634896,
				SR:  286,
				USP: 8036616,
				SSP: 3868804,
				RAM: [][2]uint32{{13634892, 72}, {13634893, 68}, {13634894, 182}, {13634895, 104}, {13634896, 246}, {13634897, 239}},
			},
			want: 			cpuState{
				D:   [8]uint32{3356677951, 2963890978, 1647061784, 618575544, 3332443358, 4258295899, 1664731656, 4278559721},
				A:   [7]uint32{4253884785, 2833570877, 672174057, 778163537, 2284848431, 3960974658, 1243658429},
				PC:  13634898,
				SR:  280,
				USP: 8036616,
				SSP: 3868804,
				RAM: [][2]uint32{{13634892, 72}, {13634893, 68}, {13634894, 182}, {13634895, 104}, {13634896, 246}, {13634897, 239}},
				Cycles: 4,
			},
		},
		{
			name: "824 SWAP D1 4841",
			init: 			cpuState{
				D:   [8]uint32{707080096, 3365412691, 263955558, 970602749, 2281080702, 4189266668, 2317145586, 3104486487},
				A:   [7]uint32{588303369, 913068751, 635577583, 2855593158, 2997474834, 2096058048, 276949683},
				PC:  2389694,
				SR:  9235,
				USP: 15955732,
				SSP: 84294,
				RAM: [][2]uint32{{2389690, 72}, {2389691, 65}, {2389692, 139}, {2389693, 72}, {2389694, 101}, {2389695, 217}},
			},
			want: 			cpuState{
				D:   [8]uint32{707080096, 525584536, 263955558, 970602749, 2281080702, 4189266668, 2317145586, 3104486487},
				A:   [7]uint32{588303369, 913068751, 635577583, 2855593158, 2997474834, 2096058048, 276949683},
				PC:  2389696,
				SR:  9232,
				USP: 15955732,
				SSP: 84294,
				RAM: [][2]uint32{{2389690, 72}, {2389691, 65}, {2389692, 139}, {2389693, 72}, {2389694, 101}, {2389695, 217}},
				Cycles: 4,
			},
		},
		{
			name: "1087 SWAP D3 4843",
			init: 			cpuState{
				D:   [8]uint32{4265735355, 998406311, 602911847, 1168257787, 2011456760, 2337647268, 250889951, 2789391015},
				A:   [7]uint32{3154546095, 2606115431, 52195830, 1469268916, 3383571283, 1257974582, 2963010467},
				PC:  5564024,
				SR:  9484,
				USP: 16513288,
				SSP: 2441038,
				RAM: [][2]uint32{{5564020, 72}, {5564021, 67}, {5564022, 99}, {5564023, 86}, {5564024, 222}, {5564025, 244}},
			},
			want: 			cpuState{
				D:   [8]uint32{4265735355, 998406311, 602911847, 855328162, 2011456760, 2337647268, 250889951, 2789391015},
				A:   [7]uint32{3154546095, 2606115431, 52195830, 1469268916, 3383571283, 1257974582, 2963010467},
				PC:  5564026,
				SR:  9472,
				USP: 16513288,
				SSP: 2441038,
				RAM: [][2]uint32{{5564020, 72}, {5564021, 67}, {5564022, 99}, {5564023, 86}, {5564024, 222}, {5564025, 244}},
				Cycles: 4,
			},
		},
		{
			name: "1342 SWAP D4 4844",
			init: 			cpuState{
				D:   [8]uint32{243076089, 915477907, 146370137, 3601965149, 2411946455, 617278614, 2581955693, 2580470220},
				A:   [7]uint32{2177254322, 890678842, 182278407, 1667230498, 3317948203, 2310117608, 4133261783},
				PC:  9244354,
				SR:  8457,
				USP: 4984694,
				SSP: 684234,
				RAM: [][2]uint32{{9244350, 72}, {9244351, 68}, {9244352, 93}, {9244353, 55}, {9244354, 108}, {9244355, 28}},
			},
			want: 			cpuState{
				D:   [8]uint32{243076089, 915477907, 146370137, 3601965149, 1641516995, 617278614, 2581955693, 2580470220},
				A:   [7]uint32{2177254322, 890678842, 182278407, 1667230498, 3317948203, 2310117608, 4133261783},
				PC:  9244356,
				SR:  8448,
				USP: 4984694,
				SSP: 684234,
				RAM: [][2]uint32{{9244350, 72}, {9244351, 68}, {9244352, 93}, {9244353, 55}, {9244354, 108}, {9244355, 28}},
				Cycles: 4,
			},
		},
		{
			name: "1637 SWAP D0 4840",
			init: 			cpuState{
				D:   [8]uint32{4293061034, 27771037, 1661425149, 4022484446, 3016449340, 3838253255, 3186370188, 2787208494},
				A:   [7]uint32{2387408151, 1527430686, 3268850778, 1169126863, 2506661997, 2445556678, 3099618604},
				PC:  16691280,
				SR:  275,
				USP: 3615452,
				SSP: 5990222,
				RAM: [][2]uint32{{16691276, 72}, {16691277, 64}, {16691278, 55}, {16691279, 45}, {16691280, 170}, {16691281, 143}},
			},
			want: 			cpuState{
				D:   [8]uint32{3920297954, 27771037, 1661425149, 4022484446, 3016449340, 3838253255, 3186370188, 2787208494},
				A:   [7]uint32{2387408151, 1527430686, 3268850778, 1169126863, 2506661997, 2445556678, 3099618604},
				PC:  16691282,
				SR:  280,
				USP: 3615452,
				SSP: 5990222,
				RAM: [][2]uint32{{16691276, 72}, {16691277, 64}, {16691278, 55}, {16691279, 45}, {16691280, 170}, {16691281, 143}},
				Cycles: 4,
			},
		},
		{
			name: "1922 SWAP D0 4840",
			init: 			cpuState{
				D:   [8]uint32{3836572950, 3852102257, 2677615272, 243565864, 3652090447, 3070276649, 3484846676, 3420904027},
				A:   [7]uint32{4118426059, 506656367, 4121638890, 3630529139, 2603534249, 1443419757, 4044455612},
				PC:  7146174,
				SR:  265,
				USP: 2891920,
				SSP: 9455488,
				RAM: [][2]uint32{{7146170, 72}, {7146171, 64}, {7146172, 135}, {7146173, 66}, {7146174, 184}, {7146175, 205}},
			},
			want: 			cpuState{
				D:   [8]uint32{1964434605, 3852102257, 2677615272, 243565864, 3652090447, 3070276649, 3484846676, 3420904027},
				A:   [7]uint32{4118426059, 506656367, 4121638890, 3630529139, 2603534249, 1443419757, 4044455612},
				PC:  7146176,
				SR:  256,
				USP: 2891920,
				SSP: 9455488,
				RAM: [][2]uint32{{7146170, 72}, {7146171, 64}, {7146172, 135}, {7146173, 66}, {7146174, 184}, {7146175, 205}},
				Cycles: 4,
			},
		},
		{
			name: "2209 SWAP D2 4842",
			init: 			cpuState{
				D:   [8]uint32{1113869943, 2871184444, 3547014395, 537451862, 453596074, 1982583537, 167034948, 1559938648},
				A:   [7]uint32{2903028052, 878178563, 1556546111, 4198965700, 140155975, 3835695973, 663970944},
				PC:  11307382,
				SR:  8210,
				USP: 2870668,
				SSP: 9068836,
				RAM: [][2]uint32{{11307378, 72}, {11307379, 66}, {11307380, 77}, {11307381, 209}, {11307382, 188}, {11307383, 168}},
			},
			want: 			cpuState{
				D:   [8]uint32{1113869943, 2871184444, 620483435, 537451862, 453596074, 1982583537, 167034948, 1559938648},
				A:   [7]uint32{2903028052, 878178563, 1556546111, 4198965700, 140155975, 3835695973, 663970944},
				PC:  11307384,
				SR:  8208,
				USP: 2870668,
				SSP: 9068836,
				RAM: [][2]uint32{{11307378, 72}, {11307379, 66}, {11307380, 77}, {11307381, 209}, {11307382, 188}, {11307383, 168}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLEA(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LEA (d8, A2, Xn), A0 41f2",
			init: cpuState{
				D:   [8]uint32{1505407771, 985271522, 1757726332, 4087867143, 3252742810, 1667700006, 3239705729, 3518445659},
				A:   [7]uint32{1518484231, 1680481906, 165329863, 2690427623, 198583438, 267202675, 813101571},
				PC:  1090286,
				SR:  8986,
				USP: 6804120,
				SSP: 3311304,
				RAM: [][2]uint32{{1090282, 65}, {1090283, 242}, {1090284, 160}, {1090285, 168}, {1090286, 18}, {1090287, 52}, {1090288, 246}, {1090289, 55}},
			},
			want: cpuState{
				D:   [8]uint32{1505407771, 985271522, 1757726332, 4087867143, 3252742810, 1667700006, 3239705729, 3518445659},
				A:   [7]uint32{165312310, 1680481906, 165329863, 2690427623, 198583438, 267202675, 813101571},
				PC:  1090290,
				SR:  8986,
				USP: 6804120,
				SSP: 3311304,
				RAM: [][2]uint32{{1090282, 65}, {1090283, 242}, {1090284, 160}, {1090285, 168}, {1090286, 18}, {1090287, 52}, {1090288, 246}, {1090289, 55}},
				Cycles: 12,
			},
		},
		{
			name: "500 LEA (A0), A2 45d0",
			init: cpuState{
				D:   [8]uint32{2952225772, 1071931426, 2289585532, 1182253030, 3325500121, 207530515, 3358768930, 1259671681},
				A:   [7]uint32{1710373711, 3814125148, 2883798262, 99917380, 3357188714, 935904720, 2461378631},
				PC:  7730002,
				SR:  1812,
				USP: 2342052,
				SSP: 4487792,
				RAM: [][2]uint32{{7729998, 69}, {7729999, 208}, {7730000, 205}, {7730001, 221}, {7730002, 194}, {7730003, 98}},
			},
			want: cpuState{
				D:   [8]uint32{2952225772, 1071931426, 2289585532, 1182253030, 3325500121, 207530515, 3358768930, 1259671681},
				A:   [7]uint32{1710373711, 3814125148, 1710373711, 99917380, 3357188714, 935904720, 2461378631},
				PC:  7730004,
				SR:  1812,
				USP: 2342052,
				SSP: 4487792,
				RAM: [][2]uint32{{7729998, 69}, {7729999, 208}, {7730000, 205}, {7730001, 221}, {7730002, 194}, {7730003, 98}},
				Cycles: 4,
			},
		},
		{
			name: "1000 LEA (A1), A6 4dd1",
			init: cpuState{
				D:   [8]uint32{3355968784, 1762318575, 4139819870, 2083015945, 350107125, 1548590728, 4116227354, 3431532069},
				A:   [7]uint32{2117442842, 56881225, 738109646, 3590755733, 546603999, 3974135264, 1660790552},
				PC:  10693554,
				SR:  33290,
				USP: 7396692,
				SSP: 9156232,
				RAM: [][2]uint32{{10693550, 77}, {10693551, 209}, {10693552, 247}, {10693553, 196}, {10693554, 72}, {10693555, 21}},
			},
			want: cpuState{
				D:   [8]uint32{3355968784, 1762318575, 4139819870, 2083015945, 350107125, 1548590728, 4116227354, 3431532069},
				A:   [7]uint32{2117442842, 56881225, 738109646, 3590755733, 546603999, 3974135264, 56881225},
				PC:  10693556,
				SR:  33290,
				USP: 7396692,
				SSP: 9156232,
				RAM: [][2]uint32{{10693550, 77}, {10693551, 209}, {10693552, 247}, {10693553, 196}, {10693554, 72}, {10693555, 21}},
				Cycles: 4,
			},
		},
		{
			name: "1500 LEA (d8, A2, Xn), A2 45f2",
			init: cpuState{
				D:   [8]uint32{3217801032, 1312059297, 3536825566, 2883328887, 1080090064, 1524216789, 388730624, 2273413506},
				A:   [7]uint32{996849844, 2818195364, 3336237362, 1529349971, 1934544521, 3349519099, 3948924854},
				PC:  115546,
				SR:  9237,
				USP: 2056190,
				SSP: 6928442,
				RAM: [][2]uint32{{115542, 69}, {115543, 242}, {115544, 38}, {115545, 229}, {115546, 241}, {115547, 91}, {115548, 143}, {115549, 107}},
			},
			want: cpuState{
				D:   [8]uint32{3217801032, 1312059297, 3536825566, 2883328887, 1080090064, 1524216789, 388730624, 2273413506},
				A:   [7]uint32{996849844, 2818195364, 3336216053, 1529349971, 1934544521, 3349519099, 3948924854},
				PC:  115550,
				SR:  9237,
				USP: 2056190,
				SSP: 6928442,
				RAM: [][2]uint32{{115542, 69}, {115543, 242}, {115544, 38}, {115545, 229}, {115546, 241}, {115547, 91}, {115548, 143}, {115549, 107}},
				Cycles: 12,
			},
		},
		{
			name: "2000 LEA (A6), A1 43d6",
			init: cpuState{
				D:   [8]uint32{4139147698, 2510287140, 2149168670, 1108415037, 604238296, 1669533574, 3202321748, 4126410644},
				A:   [7]uint32{2218653312, 2103169871, 2377181520, 4024258248, 4283818546, 3397836952, 2535708072},
				PC:  2973196,
				SR:  33296,
				USP: 3753584,
				SSP: 3264714,
				RAM: [][2]uint32{{2973192, 67}, {2973193, 214}, {2973194, 104}, {2973195, 224}, {2973196, 190}, {2973197, 235}},
			},
			want: cpuState{
				D:   [8]uint32{4139147698, 2510287140, 2149168670, 1108415037, 604238296, 1669533574, 3202321748, 4126410644},
				A:   [7]uint32{2218653312, 2535708072, 2377181520, 4024258248, 4283818546, 3397836952, 2535708072},
				PC:  2973198,
				SR:  33296,
				USP: 3753584,
				SSP: 3264714,
				RAM: [][2]uint32{{2973192, 67}, {2973193, 214}, {2973194, 104}, {2973195, 224}, {2973196, 190}, {2973197, 235}},
				Cycles: 4,
			},
		},
		{
			name: "001 LEA (d16, A6), A1 43ee",
			init: 			cpuState{
				D:   [8]uint32{1586388072, 1427305147, 3056315546, 152034191, 2144053540, 38269069, 287648062, 3285482563},
				A:   [7]uint32{3426249721, 3929254872, 2109147551, 1799499338, 3421169410, 3949922872, 1483790008},
				PC:  9250688,
				SR:  9224,
				USP: 2461084,
				SSP: 1584622,
				RAM: [][2]uint32{{9250684, 67}, {9250685, 238}, {9250686, 88}, {9250687, 164}, {9250688, 43}, {9250689, 45}, {9250690, 238}, {9250691, 171}},
			},
			want: 			cpuState{
				D:   [8]uint32{1586388072, 1427305147, 3056315546, 152034191, 2144053540, 38269069, 287648062, 3285482563},
				A:   [7]uint32{3426249721, 1483812700, 2109147551, 1799499338, 3421169410, 3949922872, 1483790008},
				PC:  9250692,
				SR:  9224,
				USP: 2461084,
				SSP: 1584622,
				RAM: [][2]uint32{{9250684, 67}, {9250685, 238}, {9250686, 88}, {9250687, 164}, {9250688, 43}, {9250689, 45}, {9250690, 238}, {9250691, 171}},
				Cycles: 8,
			},
		},
		{
			name: "272 LEA (A4), A3 47d4",
			init: 			cpuState{
				D:   [8]uint32{2612711841, 1619032009, 307510750, 3482868699, 4131883883, 2210406365, 3004049427, 2784047641},
				A:   [7]uint32{3191222273, 4043167500, 317870310, 2568494403, 2825631455, 1226617049, 3462072164},
				PC:  12843544,
				SR:  20,
				USP: 12342286,
				SSP: 11258984,
				RAM: [][2]uint32{{12843540, 71}, {12843541, 212}, {12843542, 13}, {12843543, 207}, {12843544, 95}, {12843545, 177}},
			},
			want: 			cpuState{
				D:   [8]uint32{2612711841, 1619032009, 307510750, 3482868699, 4131883883, 2210406365, 3004049427, 2784047641},
				A:   [7]uint32{3191222273, 4043167500, 317870310, 2825631455, 2825631455, 1226617049, 3462072164},
				PC:  12843546,
				SR:  20,
				USP: 12342286,
				SSP: 11258984,
				RAM: [][2]uint32{{12843540, 71}, {12843541, 212}, {12843542, 13}, {12843543, 207}, {12843544, 95}, {12843545, 177}},
				Cycles: 4,
			},
		},
		{
			name: "553 LEA (A6), A2 45d6",
			init: 			cpuState{
				D:   [8]uint32{2689939922, 2910997249, 3316830408, 3998618064, 1228809011, 665857054, 2463153471, 2317841675},
				A:   [7]uint32{2393151396, 1022074939, 1128327668, 3959126443, 1968011969, 2814952217, 3508450381},
				PC:  8313500,
				SR:  1553,
				USP: 5339360,
				SSP: 15713992,
				RAM: [][2]uint32{{8313496, 69}, {8313497, 214}, {8313498, 121}, {8313499, 211}, {8313500, 33}, {8313501, 167}},
			},
			want: 			cpuState{
				D:   [8]uint32{2689939922, 2910997249, 3316830408, 3998618064, 1228809011, 665857054, 2463153471, 2317841675},
				A:   [7]uint32{2393151396, 1022074939, 3508450381, 3959126443, 1968011969, 2814952217, 3508450381},
				PC:  8313502,
				SR:  1553,
				USP: 5339360,
				SSP: 15713992,
				RAM: [][2]uint32{{8313496, 69}, {8313497, 214}, {8313498, 121}, {8313499, 211}, {8313500, 33}, {8313501, 167}},
				Cycles: 4,
			},
		},
		{
			name: "845 LEA (A7), A6 4dd7",
			init: 			cpuState{
				D:   [8]uint32{168802294, 3257295199, 4270027040, 857661005, 1931545605, 3815025937, 732635640, 711534017},
				A:   [7]uint32{1576717210, 4053509232, 1143901917, 732581938, 677425103, 2695476993, 1429829350},
				PC:  10971978,
				SR:  9988,
				USP: 10619010,
				SSP: 800980,
				RAM: [][2]uint32{{10971974, 77}, {10971975, 215}, {10971976, 250}, {10971977, 212}, {10971978, 13}, {10971979, 69}},
			},
			want: 			cpuState{
				D:   [8]uint32{168802294, 3257295199, 4270027040, 857661005, 1931545605, 3815025937, 732635640, 711534017},
				A:   [7]uint32{1576717210, 4053509232, 1143901917, 732581938, 677425103, 2695476993, 800980},
				PC:  10971980,
				SR:  9988,
				USP: 10619010,
				SSP: 800980,
				RAM: [][2]uint32{{10971974, 77}, {10971975, 215}, {10971976, 250}, {10971977, 212}, {10971978, 13}, {10971979, 69}},
				Cycles: 4,
			},
		},
		{
			name: "1133 LEA (d8, PC, Xn), A6 4dfb",
			init: 			cpuState{
				D:   [8]uint32{1001656931, 1316962477, 2371204549, 137139105, 1208348215, 3183775456, 1064901049, 421902703},
				A:   [7]uint32{4233445713, 3679001083, 3531312834, 2535077309, 1219405858, 2380827695, 3624376892},
				PC:  8862466,
				SR:  794,
				USP: 11607850,
				SSP: 8868018,
				RAM: [][2]uint32{{8862462, 77}, {8862463, 251}, {8862464, 234}, {8862465, 116}, {8862466, 212}, {8862467, 164}, {8862468, 121}, {8862469, 89}},
			},
			want: 			cpuState{
				D:   [8]uint32{1001656931, 1316962477, 2371204549, 137139105, 1208348215, 3183775456, 1064901049, 421902703},
				A:   [7]uint32{4233445713, 3679001083, 3531312834, 2535077309, 1219405858, 2380827695, 3633239472},
				PC:  8862470,
				SR:  794,
				USP: 11607850,
				SSP: 8868018,
				RAM: [][2]uint32{{8862462, 77}, {8862463, 251}, {8862464, 234}, {8862465, 116}, {8862466, 212}, {8862467, 164}, {8862468, 121}, {8862469, 89}},
				Cycles: 12,
			},
		},
		{
			name: "1408 LEA (d8, A0, Xn), A0 41f0",
			init: 			cpuState{
				D:   [8]uint32{1993036778, 2753688271, 2102801670, 998301326, 2432278935, 4002314114, 3002502153, 1821473966},
				A:   [7]uint32{2357329572, 441699339, 2288066771, 960018633, 677059711, 3221263251, 2589770908},
				PC:  8240354,
				SR:  8713,
				USP: 8566812,
				SSP: 8496814,
				RAM: [][2]uint32{{8240350, 65}, {8240351, 240}, {8240352, 179}, {8240353, 63}, {8240354, 199}, {8240355, 93}, {8240356, 53}, {8240357, 175}},
			},
			want: 			cpuState{
				D:   [8]uint32{1993036778, 2753688271, 2102801670, 998301326, 2432278935, 4002314114, 3002502153, 1821473966},
				A:   [7]uint32{2357311404, 441699339, 2288066771, 960018633, 677059711, 3221263251, 2589770908},
				PC:  8240358,
				SR:  8713,
				USP: 8566812,
				SSP: 8496814,
				RAM: [][2]uint32{{8240350, 65}, {8240351, 240}, {8240352, 179}, {8240353, 63}, {8240354, 199}, {8240355, 93}, {8240356, 53}, {8240357, 175}},
				Cycles: 12,
			},
		},
		{
			name: "1668 LEA (A7), A7 4fd7",
			init: 			cpuState{
				D:   [8]uint32{1541661426, 262683908, 206648437, 821408853, 3942686398, 2555267148, 3261034190, 2177018007},
				A:   [7]uint32{610471078, 2493114225, 810500918, 3456243980, 994726183, 1498196925, 1739927721},
				PC:  12295798,
				SR:  8220,
				USP: 5980888,
				SSP: 2938442,
				RAM: [][2]uint32{{12295794, 79}, {12295795, 215}, {12295796, 235}, {12295797, 158}, {12295798, 134}, {12295799, 89}},
			},
			want: 			cpuState{
				D:   [8]uint32{1541661426, 262683908, 206648437, 821408853, 3942686398, 2555267148, 3261034190, 2177018007},
				A:   [7]uint32{610471078, 2493114225, 810500918, 3456243980, 994726183, 1498196925, 1739927721},
				PC:  12295800,
				SR:  8220,
				USP: 5980888,
				SSP: 2938442,
				RAM: [][2]uint32{{12295794, 79}, {12295795, 215}, {12295796, 235}, {12295797, 158}, {12295798, 134}, {12295799, 89}},
				Cycles: 4,
			},
		},
		{
			name: "1956 LEA (A0), A5 4bd0",
			init: 			cpuState{
				D:   [8]uint32{2197691095, 2396555619, 1209435935, 3894656452, 340368288, 2520229442, 2513932871, 939691964},
				A:   [7]uint32{3753309466, 2833391931, 2024724606, 3504416838, 509825905, 1175367547, 872700077},
				PC:  12756390,
				SR:  513,
				USP: 14578764,
				SSP: 8450190,
				RAM: [][2]uint32{{12756386, 75}, {12756387, 208}, {12756388, 185}, {12756389, 134}, {12756390, 48}, {12756391, 174}},
			},
			want: 			cpuState{
				D:   [8]uint32{2197691095, 2396555619, 1209435935, 3894656452, 340368288, 2520229442, 2513932871, 939691964},
				A:   [7]uint32{3753309466, 2833391931, 2024724606, 3504416838, 509825905, 3753309466, 872700077},
				PC:  12756392,
				SR:  513,
				USP: 14578764,
				SSP: 8450190,
				RAM: [][2]uint32{{12756386, 75}, {12756387, 208}, {12756388, 185}, {12756389, 134}, {12756390, 48}, {12756391, 174}},
				Cycles: 4,
			},
		},
		{
			name: "2232 LEA (A7), A5 4bd7",
			init: 			cpuState{
				D:   [8]uint32{905867990, 4167018530, 1351278106, 2351819628, 569941388, 3456000182, 1760947544, 3273537973},
				A:   [7]uint32{535946897, 1224692292, 715609887, 2605991395, 3857155315, 3663748203, 2010883005},
				PC:  12327252,
				SR:  8213,
				USP: 15092848,
				SSP: 12377666,
				RAM: [][2]uint32{{12327248, 75}, {12327249, 215}, {12327250, 245}, {12327251, 126}, {12327252, 77}, {12327253, 71}},
			},
			want: 			cpuState{
				D:   [8]uint32{905867990, 4167018530, 1351278106, 2351819628, 569941388, 3456000182, 1760947544, 3273537973},
				A:   [7]uint32{535946897, 1224692292, 715609887, 2605991395, 3857155315, 12377666, 2010883005},
				PC:  12327254,
				SR:  8213,
				USP: 15092848,
				SSP: 12377666,
				RAM: [][2]uint32{{12327248, 75}, {12327249, 215}, {12327250, 245}, {12327251, 126}, {12327252, 77}, {12327253, 71}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestPEA(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 PEA (d8, A5, Xn) 4875",
			init: cpuState{
				D:   [8]uint32{865422286, 968813949, 2721818445, 2141489019, 3373891870, 2202925245, 924941020, 3937274480},
				A:   [7]uint32{4011833265, 4130108710, 3872153481, 130708056, 3294091709, 1251249274, 3501493919},
				PC:  9642054,
				SR:  40976,
				USP: 59218,
				SSP: 7406244,
				RAM: [][2]uint32{{9642050, 72}, {9642051, 117}, {9642052, 94}, {9642053, 94}, {9642054, 210}, {9642055, 68}, {9642056, 44}, {9642057, 231}},
			},
			want: cpuState{
				D:   [8]uint32{865422286, 968813949, 2721818445, 2141489019, 3373891870, 2202925245, 924941020, 3937274480},
				A:   [7]uint32{4011833265, 4130108710, 3872153481, 130708056, 3294091709, 1251249274, 3501493919},
				PC:  9642058,
				SR:  40976,
				USP: 59218,
				SSP: 7406240,
				RAM: [][2]uint32{{9642050, 72}, {9642051, 117}, {9642052, 94}, {9642053, 94}, {9642054, 210}, {9642055, 68}, {9642056, 44}, {9642057, 231}, {7406240, 205}, {7406241, 226}, {7406242, 133}, {7406243, 149}},
				Cycles: 20,
			},
		},
		{
			name: "500 PEA (d16, A6) 486e",
			init: cpuState{
				D:   [8]uint32{2296569189, 2528915686, 235642819, 2290463059, 1316480169, 3724715940, 4162638519, 824586476},
				A:   [7]uint32{1559678604, 3348491145, 368545358, 3293381638, 4015104221, 711618274, 1139570139},
				PC:  12405144,
				SR:  32774,
				USP: 6216734,
				SSP: 11917798,
				RAM: [][2]uint32{{12405140, 72}, {12405141, 110}, {12405142, 56}, {12405143, 60}, {12405144, 67}, {12405145, 43}, {12405146, 25}, {12405147, 60}},
			},
			want: cpuState{
				D:   [8]uint32{2296569189, 2528915686, 235642819, 2290463059, 1316480169, 3724715940, 4162638519, 824586476},
				A:   [7]uint32{1559678604, 3348491145, 368545358, 3293381638, 4015104221, 711618274, 1139570139},
				PC:  12405148,
				SR:  32774,
				USP: 6216730,
				SSP: 11917798,
				RAM: [][2]uint32{{12405140, 72}, {12405141, 110}, {12405142, 56}, {12405143, 60}, {12405144, 67}, {12405145, 43}, {12405146, 25}, {12405147, 60}, {6216730, 67}, {6216731, 236}, {6216732, 174}, {6216733, 23}},
				Cycles: 16,
			},
		},
		{
			name: "1000 PEA (A6) 4856",
			init: cpuState{
				D:   [8]uint32{1657715744, 2138912365, 1230511755, 902563391, 3175369890, 3223255929, 3871914769, 2083501809},
				A:   [7]uint32{2388162456, 1474252684, 482040733, 3119316955, 1142549739, 1932205196, 2814763138},
				PC:  15872052,
				SR:  1052,
				USP: 2652400,
				SSP: 983380,
				RAM: [][2]uint32{{15872048, 72}, {15872049, 86}, {15872050, 181}, {15872051, 26}, {15872052, 31}, {15872053, 97}},
			},
			want: cpuState{
				D:   [8]uint32{1657715744, 2138912365, 1230511755, 902563391, 3175369890, 3223255929, 3871914769, 2083501809},
				A:   [7]uint32{2388162456, 1474252684, 482040733, 3119316955, 1142549739, 1932205196, 2814763138},
				PC:  15872054,
				SR:  1052,
				USP: 2652396,
				SSP: 983380,
				RAM: [][2]uint32{{15872048, 72}, {15872049, 86}, {15872050, 181}, {15872051, 26}, {15872052, 31}, {15872053, 97}, {2652396, 167}, {2652397, 197}, {2652398, 224}, {2652399, 130}},
				Cycles: 12,
			},
		},
		{
			name: "1500 PEA (d8, A2, Xn) 4872",
			init: cpuState{
				D:   [8]uint32{2754576608, 3333140619, 25752223, 2407048060, 1033454121, 2931619043, 1535111698, 3477477688},
				A:   [7]uint32{2111651585, 3064474738, 2272453687, 630940487, 2313838957, 3559562175, 2246036016},
				PC:  9348364,
				SR:  42509,
				USP: 14478666,
				SSP: 8867158,
				RAM: [][2]uint32{{9348360, 72}, {9348361, 114}, {9348362, 91}, {9348363, 223}, {9348364, 211}, {9348365, 171}, {9348366, 142}, {9348367, 118}},
			},
			want: cpuState{
				D:   [8]uint32{2754576608, 3333140619, 25752223, 2407048060, 1033454121, 2931619043, 1535111698, 3477477688},
				A:   [7]uint32{2111651585, 3064474738, 2272453687, 630940487, 2313838957, 3559562175, 2246036016},
				PC:  9348368,
				SR:  42509,
				USP: 14478666,
				SSP: 8867154,
				RAM: [][2]uint32{{9348360, 72}, {9348361, 114}, {9348362, 91}, {9348363, 223}, {9348364, 211}, {9348365, 171}, {9348366, 142}, {9348367, 118}, {8867154, 54}, {8867155, 47}, {8867156, 216}, {8867157, 249}},
				Cycles: 20,
			},
		},
		{
			name: "2000 PEA (d16, A2) 486a",
			init: cpuState{
				D:   [8]uint32{362449889, 3457364940, 3920594189, 2771909560, 3898788148, 3260478910, 2829587860, 1964048124},
				A:   [7]uint32{3727828338, 3184539925, 3901086640, 3502035085, 1292961376, 2109014691, 1036076106},
				PC:  12387596,
				SR:  41989,
				USP: 327194,
				SSP: 13934186,
				RAM: [][2]uint32{{12387592, 72}, {12387593, 106}, {12387594, 55}, {12387595, 120}, {12387596, 167}, {12387597, 33}, {12387598, 222}, {12387599, 143}},
			},
			want: cpuState{
				D:   [8]uint32{362449889, 3457364940, 3920594189, 2771909560, 3898788148, 3260478910, 2829587860, 1964048124},
				A:   [7]uint32{3727828338, 3184539925, 3901086640, 3502035085, 1292961376, 2109014691, 1036076106},
				PC:  12387600,
				SR:  41989,
				USP: 327194,
				SSP: 13934182,
				RAM: [][2]uint32{{12387592, 72}, {12387593, 106}, {12387594, 55}, {12387595, 120}, {12387596, 167}, {12387597, 33}, {12387598, 222}, {12387599, 143}, {13934182, 232}, {13934183, 134}, {13934184, 19}, {13934185, 40}},
				Cycles: 16,
			},
		},
		{
			name: "005 PEA (d16, A5) 486d",
			init: 			cpuState{
				D:   [8]uint32{3106458279, 2524501454, 289250422, 3409964691, 3644183757, 2910656202, 1345674, 4247573637},
				A:   [7]uint32{2978778938, 940540890, 3761752451, 3854808827, 3907781156, 1525708853, 3845502096},
				PC:  12251828,
				SR:  1310,
				USP: 5820816,
				SSP: 16367404,
				RAM: [][2]uint32{{12251824, 72}, {12251825, 109}, {12251826, 233}, {12251827, 98}, {12251828, 65}, {12251829, 123}, {12251830, 235}, {12251831, 246}},
			},
			want: 			cpuState{
				D:   [8]uint32{3106458279, 2524501454, 289250422, 3409964691, 3644183757, 2910656202, 1345674, 4247573637},
				A:   [7]uint32{2978778938, 940540890, 3761752451, 3854808827, 3907781156, 1525708853, 3845502096},
				PC:  12251832,
				SR:  1310,
				USP: 5820812,
				SSP: 16367404,
				RAM: [][2]uint32{{12251824, 72}, {12251825, 109}, {12251826, 233}, {12251827, 98}, {12251828, 65}, {12251829, 123}, {12251830, 235}, {12251831, 246}, {5820812, 90}, {5820813, 240}, {5820814, 97}, {5820815, 151}},
				Cycles: 16,
			},
		},
		{
			name: "263 PEA (d8, A6, Xn) 4876",
			init: 			cpuState{
				D:   [8]uint32{2315771404, 4154598960, 4230998609, 2830099492, 1969305177, 2350441644, 3738613230, 336858631},
				A:   [7]uint32{625962624, 869900135, 4091368965, 790910318, 795182292, 2448502082, 3577885359},
				PC:  6287124,
				SR:  8449,
				USP: 6733308,
				SSP: 1694908,
				RAM: [][2]uint32{{6287120, 72}, {6287121, 118}, {6287122, 254}, {6287123, 222}, {6287124, 36}, {6287125, 72}, {6287126, 72}, {6287127, 171}},
			},
			want: 			cpuState{
				D:   [8]uint32{2315771404, 4154598960, 4230998609, 2830099492, 1969305177, 2350441644, 3738613230, 336858631},
				A:   [7]uint32{625962624, 869900135, 4091368965, 790910318, 795182292, 2448502082, 3577885359},
				PC:  6287128,
				SR:  8449,
				USP: 6733308,
				SSP: 1694904,
				RAM: [][2]uint32{{6287120, 72}, {6287121, 118}, {6287122, 254}, {6287123, 222}, {6287124, 36}, {6287125, 72}, {6287126, 72}, {6287127, 171}, {1694904, 213}, {1694905, 92}, {1694906, 15}, {1694907, 73}},
				Cycles: 20,
			},
		},
		{
			name: "516 PEA (xxx).w 4878",
			init: 			cpuState{
				D:   [8]uint32{2554026069, 2408882226, 472995065, 4030573560, 3710924257, 1224723117, 1272412001, 2929398410},
				A:   [7]uint32{3181350582, 2939323713, 2497939007, 3605301285, 350190138, 1385115622, 996128086},
				PC:  3091706,
				SR:  8727,
				USP: 15138300,
				SSP: 5880874,
				RAM: [][2]uint32{{3091702, 72}, {3091703, 120}, {3091704, 94}, {3091705, 91}, {3091706, 162}, {3091707, 223}, {3091708, 208}, {3091709, 119}},
			},
			want: 			cpuState{
				D:   [8]uint32{2554026069, 2408882226, 472995065, 4030573560, 3710924257, 1224723117, 1272412001, 2929398410},
				A:   [7]uint32{3181350582, 2939323713, 2497939007, 3605301285, 350190138, 1385115622, 996128086},
				PC:  3091710,
				SR:  8727,
				USP: 15138300,
				SSP: 5880870,
				RAM: [][2]uint32{{3091702, 72}, {3091703, 120}, {3091704, 94}, {3091705, 91}, {3091706, 162}, {3091707, 223}, {5880870, 0}, {5880871, 0}, {5880872, 94}, {5880873, 91}, {3091708, 208}, {3091709, 119}},
				Cycles: 16,
			},
		},
		{
			name: "811 PEA (d16, A3) 486b",
			init: 			cpuState{
				D:   [8]uint32{4194929800, 1936781994, 3318334930, 3272463732, 3472421482, 1725798387, 1747444517, 2005290772},
				A:   [7]uint32{881055527, 854064410, 22901373, 3839980665, 3137629727, 1346600226, 2071963733},
				PC:  15224152,
				SR:  10009,
				USP: 4462424,
				SSP: 2773304,
				RAM: [][2]uint32{{15224148, 72}, {15224149, 107}, {15224150, 112}, {15224151, 152}, {15224152, 13}, {15224153, 60}, {15224154, 46}, {15224155, 206}},
			},
			want: 			cpuState{
				D:   [8]uint32{4194929800, 1936781994, 3318334930, 3272463732, 3472421482, 1725798387, 1747444517, 2005290772},
				A:   [7]uint32{881055527, 854064410, 22901373, 3839980665, 3137629727, 1346600226, 2071963733},
				PC:  15224156,
				SR:  10009,
				USP: 4462424,
				SSP: 2773300,
				RAM: [][2]uint32{{15224148, 72}, {15224149, 107}, {15224150, 112}, {15224151, 152}, {15224152, 13}, {15224153, 60}, {15224154, 46}, {15224155, 206}, {2773300, 228}, {2773301, 225}, {2773302, 229}, {2773303, 17}},
				Cycles: 16,
			},
		},
		{
			name: "1087 PEA (d16, PC) 487a",
			init: 			cpuState{
				D:   [8]uint32{3722600758, 3844321359, 811956019, 2974335957, 1231743531, 971844978, 2861549948, 15866605},
				A:   [7]uint32{962481217, 1200356114, 1543384058, 2546244887, 2973213563, 132448025, 656298907},
				PC:  6112802,
				SR:  8456,
				USP: 3749052,
				SSP: 3759342,
				RAM: [][2]uint32{{6112798, 72}, {6112799, 122}, {6112800, 74}, {6112801, 85}, {6112802, 90}, {6112803, 184}, {6112804, 202}, {6112805, 194}},
			},
			want: 			cpuState{
				D:   [8]uint32{3722600758, 3844321359, 811956019, 2974335957, 1231743531, 971844978, 2861549948, 15866605},
				A:   [7]uint32{962481217, 1200356114, 1543384058, 2546244887, 2973213563, 132448025, 656298907},
				PC:  6112806,
				SR:  8456,
				USP: 3749052,
				SSP: 3759338,
				RAM: [][2]uint32{{6112798, 72}, {6112799, 122}, {6112800, 74}, {6112801, 85}, {6112802, 90}, {6112803, 184}, {6112804, 202}, {6112805, 194}, {3759338, 0}, {3759339, 93}, {3759340, 144}, {3759341, 117}},
				Cycles: 16,
			},
		},
		{
			name: "1381 PEA (d8, A6, Xn) 4876",
			init: 			cpuState{
				D:   [8]uint32{2588406700, 90328846, 2834124610, 4077594420, 2372292565, 3555608943, 1229478792, 2620972534},
				A:   [7]uint32{547441132, 2324335842, 3149670027, 3597342978, 3344972528, 1981262237, 1232466501},
				PC:  8774834,
				SR:  1043,
				USP: 15258880,
				SSP: 5709828,
				RAM: [][2]uint32{{8774830, 72}, {8774831, 118}, {8774832, 216}, {8774833, 221}, {8774834, 3}, {8774835, 69}, {8774836, 133}, {8774837, 63}},
			},
			want: 			cpuState{
				D:   [8]uint32{2588406700, 90328846, 2834124610, 4077594420, 2372292565, 3555608943, 1229478792, 2620972534},
				A:   [7]uint32{547441132, 2324335842, 3149670027, 3597342978, 3344972528, 1981262237, 1232466501},
				PC:  8774838,
				SR:  1043,
				USP: 15258876,
				SSP: 5709828,
				RAM: [][2]uint32{{8774830, 72}, {8774831, 118}, {8774832, 216}, {8774833, 221}, {8774834, 3}, {8774835, 69}, {8774836, 133}, {8774837, 63}, {15258876, 191}, {15258877, 141}, {15258878, 155}, {15258879, 191}},
				Cycles: 20,
			},
		},
		{
			name: "1689 PEA (d16, A6) 486e",
			init: 			cpuState{
				D:   [8]uint32{635936974, 4069593476, 4135061879, 3911144231, 3312242876, 3476477092, 680497290, 1715994125},
				A:   [7]uint32{2503861424, 916975702, 835892216, 382018841, 1602586852, 3036796217, 970475506},
				PC:  7646796,
				SR:  8449,
				USP: 15161282,
				SSP: 7256260,
				RAM: [][2]uint32{{7646792, 72}, {7646793, 110}, {7646794, 68}, {7646795, 68}, {7646796, 152}, {7646797, 177}, {7646798, 37}, {7646799, 245}},
			},
			want: 			cpuState{
				D:   [8]uint32{635936974, 4069593476, 4135061879, 3911144231, 3312242876, 3476477092, 680497290, 1715994125},
				A:   [7]uint32{2503861424, 916975702, 835892216, 382018841, 1602586852, 3036796217, 970475506},
				PC:  7646800,
				SR:  8449,
				USP: 15161282,
				SSP: 7256256,
				RAM: [][2]uint32{{7646792, 72}, {7646793, 110}, {7646794, 68}, {7646795, 68}, {7646796, 152}, {7646797, 177}, {7646798, 37}, {7646799, 245}, {7256256, 57}, {7256257, 216}, {7256258, 140}, {7256259, 54}},
				Cycles: 16,
			},
		},
		{
			name: "1946 PEA (A0) 4850",
			init: 			cpuState{
				D:   [8]uint32{2405743251, 51199543, 1052350005, 54910399, 2223803974, 1018676774, 4090575163, 2579375598},
				A:   [7]uint32{855528056, 1466545659, 2323166601, 2075816127, 3637590743, 3374726001, 3536580194},
				PC:  2197920,
				SR:  9740,
				USP: 10958422,
				SSP: 6972742,
				RAM: [][2]uint32{{2197916, 72}, {2197917, 80}, {2197918, 166}, {2197919, 55}, {2197920, 18}, {2197921, 68}},
			},
			want: 			cpuState{
				D:   [8]uint32{2405743251, 51199543, 1052350005, 54910399, 2223803974, 1018676774, 4090575163, 2579375598},
				A:   [7]uint32{855528056, 1466545659, 2323166601, 2075816127, 3637590743, 3374726001, 3536580194},
				PC:  2197922,
				SR:  9740,
				USP: 10958422,
				SSP: 6972738,
				RAM: [][2]uint32{{2197916, 72}, {2197917, 80}, {2197918, 166}, {2197919, 55}, {2197920, 18}, {2197921, 68}, {6972738, 50}, {6972739, 254}, {6972740, 82}, {6972741, 120}},
				Cycles: 12,
			},
		},
		{
			name: "2216 PEA (A4) 4854",
			init: 			cpuState{
				D:   [8]uint32{773816063, 4230109844, 3846885329, 471435074, 1241874382, 753459784, 159365744, 3562526172},
				A:   [7]uint32{3829439013, 1597900542, 117545115, 1362706377, 807320329, 79166135, 2339007027},
				PC:  15914214,
				SR:  8710,
				USP: 10315556,
				SSP: 10123926,
				RAM: [][2]uint32{{15914210, 72}, {15914211, 84}, {15914212, 198}, {15914213, 108}, {15914214, 50}, {15914215, 41}},
			},
			want: 			cpuState{
				D:   [8]uint32{773816063, 4230109844, 3846885329, 471435074, 1241874382, 753459784, 159365744, 3562526172},
				A:   [7]uint32{3829439013, 1597900542, 117545115, 1362706377, 807320329, 79166135, 2339007027},
				PC:  15914216,
				SR:  8710,
				USP: 10315556,
				SSP: 10123922,
				RAM: [][2]uint32{{15914210, 72}, {15914211, 84}, {15914212, 198}, {15914213, 108}, {15914214, 50}, {15914215, 41}, {10123922, 48}, {10123923, 30}, {10123924, 187}, {10123925, 9}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}
