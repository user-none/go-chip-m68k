package m68k

import "testing"

func TestMOVE_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVE.b (d8, A7, Xn), (A5)+ 1af7",
			init: cpuState{
				D:   [8]uint32{2070124316, 234003073, 1521695988, 3135339855, 578666471, 3465828453, 2145999343, 2461079043},
				A:   [7]uint32{2211998792, 3183097597, 2638671310, 247559878, 3934967095, 4190314979, 2197685891},
				PC:  10201890,
				SR:  34305,
				USP: 4298878,
				SSP: 13553080,
				RAM: [][2]uint32{{10201886, 26}, {10201887, 247}, {10201888, 244}, {10201889, 108}, {10201890, 36}, {10201891, 185}, {4272488, 179}, {4272489, 28}, {10201892, 151}, {10201893, 129}},
			},
			want: cpuState{
				D:   [8]uint32{2070124316, 234003073, 1521695988, 3135339855, 578666471, 3465828453, 2145999343, 2461079043},
				A:   [7]uint32{2211998792, 3183097597, 2638671310, 247559878, 3934967095, 4190314980, 2197685891},
				PC:  10201894,
				SR:  34312,
				USP: 4298878,
				SSP: 13553080,
				RAM: [][2]uint32{{10201886, 26}, {10201887, 247}, {10201888, 244}, {10201889, 108}, {10201890, 36}, {10201891, 185}, {4272488, 179}, {4272489, 28}, {12788194, 0}, {12788195, 179}, {10201892, 151}, {10201893, 129}},
			},
		},
		{
			name: "500 MOVE.b -(A7), (A7)+ 1ee7",
			init: cpuState{
				D:   [8]uint32{79605547, 1732324779, 160891053, 3585794686, 3659053941, 1081974772, 499563445, 269157102},
				A:   [7]uint32{474390832, 3667974165, 1496134184, 2293736989, 966256255, 1224196697, 4202128802},
				PC:  13422958,
				SR:  8719,
				USP: 7939604,
				SSP: 455146,
				RAM: [][2]uint32{{13422954, 30}, {13422955, 231}, {13422956, 68}, {13422957, 121}, {455144, 123}, {455145, 20}, {13422958, 88}, {13422959, 50}},
			},
			want: cpuState{
				D:   [8]uint32{79605547, 1732324779, 160891053, 3585794686, 3659053941, 1081974772, 499563445, 269157102},
				A:   [7]uint32{474390832, 3667974165, 1496134184, 2293736989, 966256255, 1224196697, 4202128802},
				PC:  13422960,
				SR:  8704,
				USP: 7939604,
				SSP: 455146,
				RAM: [][2]uint32{{13422954, 30}, {13422955, 231}, {13422956, 68}, {13422957, 121}, {455144, 123}, {455145, 20}, {13422958, 88}, {13422959, 50}},
			},
		},
		{
			name: "1000 MOVE.b (xxx).l, (A2)+ 14f9",
			init: cpuState{
				D:   [8]uint32{2013684687, 1194193982, 1799070497, 811095408, 2341184346, 612250126, 3941604888, 1956162679},
				A:   [7]uint32{2102688, 3316745906, 1168877170, 1657469866, 2914970285, 2545639485, 2835124270},
				PC:  411518,
				SR:  40966,
				USP: 16684710,
				SSP: 16597514,
				RAM: [][2]uint32{{411514, 20}, {411515, 249}, {411516, 37}, {411517, 163}, {411518, 173}, {411519, 20}, {411520, 163}, {411521, 185}, {10726676, 183}, {10726677, 29}, {411522, 226}, {411523, 99}},
			},
			want: cpuState{
				D:   [8]uint32{2013684687, 1194193982, 1799070497, 811095408, 2341184346, 612250126, 3941604888, 1956162679},
				A:   [7]uint32{2102688, 3316745906, 1168877171, 1657469866, 2914970285, 2545639485, 2835124270},
				PC:  411524,
				SR:  40968,
				USP: 16684710,
				SSP: 16597514,
				RAM: [][2]uint32{{411514, 20}, {411515, 249}, {411516, 37}, {411517, 163}, {411518, 173}, {411519, 20}, {411520, 163}, {411521, 185}, {10726676, 183}, {10726677, 29}, {11249266, 183}, {11249267, 0}, {411522, 226}, {411523, 99}},
			},
		},
		{
			name: "1500 MOVE.b (A3)+, (A4)+ 18db",
			init: cpuState{
				D:   [8]uint32{4024585824, 3242946488, 13733619, 3307178649, 1413867839, 4186009755, 3198856664, 3635417336},
				A:   [7]uint32{744551197, 3580785785, 1065647876, 1991876151, 3346842381, 3240550237, 4199785351},
				PC:  14879242,
				SR:  9744,
				USP: 8159036,
				SSP: 12595764,
				RAM: [][2]uint32{{14879238, 24}, {14879239, 219}, {14879240, 63}, {14879241, 85}, {12164662, 244}, {12164663, 248}, {14879242, 70}, {14879243, 168}},
			},
			want: cpuState{
				D:   [8]uint32{4024585824, 3242946488, 13733619, 3307178649, 1413867839, 4186009755, 3198856664, 3635417336},
				A:   [7]uint32{744551197, 3580785785, 1065647876, 1991876152, 3346842382, 3240550237, 4199785351},
				PC:  14879244,
				SR:  9752,
				USP: 8159036,
				SSP: 12595764,
				RAM: [][2]uint32{{14879238, 24}, {14879239, 219}, {14879240, 63}, {14879241, 85}, {12164662, 244}, {12164663, 248}, {8176396, 0}, {8176397, 248}, {14879242, 70}, {14879243, 168}},
			},
		},
		{
			name: "2000 MOVE.b (d16, A4), (A5) 1aac",
			init: cpuState{
				D:   [8]uint32{3635665856, 3437810394, 3268591727, 2662518563, 2578629456, 3177247432, 1434671464, 1190196822},
				A:   [7]uint32{1964622311, 2517750663, 3641275502, 3428346052, 4191152582, 1797169006, 3141544000},
				PC:  7242746,
				SR:  41485,
				USP: 3214510,
				SSP: 542030,
				RAM: [][2]uint32{{7242742, 26}, {7242743, 172}, {7242744, 98}, {7242745, 50}, {7242746, 46}, {7242747, 192}, {13650936, 1}, {13650937, 51}, {7242748, 73}, {7242749, 79}},
			},
			want: cpuState{
				D:   [8]uint32{3635665856, 3437810394, 3268591727, 2662518563, 2578629456, 3177247432, 1434671464, 1190196822},
				A:   [7]uint32{1964622311, 2517750663, 3641275502, 3428346052, 4191152582, 1797169006, 3141544000},
				PC:  7242750,
				SR:  41472,
				USP: 3214510,
				SSP: 542030,
				RAM: [][2]uint32{{7242742, 26}, {7242743, 172}, {7242744, 98}, {7242745, 50}, {7242746, 46}, {7242747, 192}, {13650936, 1}, {13650937, 51}, {2006894, 1}, {2006895, 0}, {7242748, 73}, {7242749, 79}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVE_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVE.w A1, (A2)+ 34c9",
			init: cpuState{
				D:   [8]uint32{2530484584, 1196838788, 1081950822, 3801932641, 2878138451, 3686490039, 1277231700, 2281846656},
				A:   [7]uint32{4128152544, 1087582781, 35290954, 3940833032, 2199530306, 2003700646, 70651068},
				PC:  2587182,
				SR:  775,
				USP: 2822166,
				SSP: 11411026,
				RAM: [][2]uint32{{2587178, 52}, {2587179, 201}, {2587180, 37}, {2587181, 1}, {2587182, 249}, {2587183, 15}},
			},
			want: cpuState{
				D:   [8]uint32{2530484584, 1196838788, 1081950822, 3801932641, 2878138451, 3686490039, 1277231700, 2281846656},
				A:   [7]uint32{4128152544, 1087582781, 35290956, 3940833032, 2199530306, 2003700646, 70651068},
				PC:  2587184,
				SR:  768,
				USP: 2822166,
				SSP: 11411026,
				RAM: [][2]uint32{{2587178, 52}, {2587179, 201}, {2587180, 37}, {2587181, 1}, {1736522, 50}, {1736523, 61}, {2587182, 249}, {2587183, 15}},
			},
		},
		{
			name: "500 MOVE.w (A7)+, (d8, A0, Xn) 319f",
			init: cpuState{
				D:   [8]uint32{856399019, 1569404969, 1773670123, 2018965409, 129972502, 2064310731, 3749490678, 2023162347},
				A:   [7]uint32{1314148112, 2017600262, 3013841239, 173807186, 4253967818, 902877358, 3739492209},
				PC:  8285322,
				SR:  42264,
				USP: 11438124,
				SSP: 7341152,
				RAM: [][2]uint32{{8285318, 49}, {8285319, 159}, {8285320, 182}, {8285321, 14}, {7341152, 55}, {7341153, 119}, {8285322, 150}, {8285323, 5}, {8285324, 56}, {8285325, 171}},
			},
			want: cpuState{
				D:   [8]uint32{856399019, 1569404969, 1773670123, 2018965409, 129972502, 2064310731, 3749490678, 2023162347},
				A:   [7]uint32{1314148112, 2017600262, 3013841239, 173807186, 4253967818, 902877358, 3739492209},
				PC:  8285326,
				SR:  42256,
				USP: 11438124,
				SSP: 7341154,
				RAM: [][2]uint32{{8285318, 49}, {8285319, 159}, {8285320, 182}, {8285321, 14}, {7341152, 55}, {7341153, 119}, {8285322, 150}, {8285323, 5}, {5530992, 55}, {5530993, 119}, {8285324, 56}, {8285325, 171}},
			},
		},
		{
			name: "1000 MOVE.w -(A3), D7 3e23",
			init: cpuState{
				D:   [8]uint32{696051969, 1854751692, 213349985, 1805050501, 4056672009, 1656096433, 2280222579, 561961943},
				A:   [7]uint32{3810802989, 663015860, 2830421226, 1854736187, 601145369, 703294689, 3541894700},
				PC:  4390836,
				SR:  1030,
				USP: 9082000,
				SSP: 2479692,
				RAM: [][2]uint32{{4390832, 62}, {4390833, 35}, {4390834, 182}, {4390835, 124}, {12, 36}, {13, 20}, {14, 89}, {15, 46}, {1333550, 31}, {1333551, 75}, {1333552, 148}, {1333553, 42}},
			},
			want: cpuState{
				D:      [8]uint32{696051969, 1854751692, 213349985, 1805050501, 4056672009, 1656096433, 2280222579, 561961943},
				A:      [7]uint32{3810802989, 663015860, 2830421226, 1854736185, 601145369, 703294689, 3541894700},
				PC:     605313330,
				SR:     9222,
				USP:    9082000,
				SSP:    2479678,
				RAM:    [][2]uint32{{4390832, 62}, {4390833, 35}, {4390834, 182}, {4390835, 124}, {2479690, 255}, {2479691, 180}, {2479686, 4}, {2479687, 6}, {2479688, 0}, {2479689, 66}, {2479684, 62}, {2479685, 35}, {2479682, 7}, {2479683, 57}, {2479678, 62}, {2479679, 49}, {2479680, 110}, {2479681, 141}, {12, 36}, {13, 20}, {14, 89}, {15, 46}, {1333550, 31}, {1333551, 75}, {1333552, 148}, {1333553, 42}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVE.w (d8, A6, Xn), (d8, A0, Xn) 31b6",
			init: cpuState{
				D:   [8]uint32{970642547, 42024927, 2408930079, 707397645, 3339450817, 2308389420, 1208726658, 3783339692},
				A:   [7]uint32{1641272459, 1356141785, 2036218255, 4276021322, 3576453530, 2163200603, 188834721},
				PC:  6937610,
				SR:  34317,
				USP: 3097706,
				SSP: 13071066,
				RAM: [][2]uint32{{6937606, 49}, {6937607, 182}, {6937608, 161}, {6937609, 193}, {6937610, 176}, {6937611, 145}, {12, 253}, {13, 164}, {14, 247}, {15, 228}, {10811364, 57}, {10811365, 62}, {10811366, 121}, {10811367, 39}},
			},
			want: cpuState{
				D:      [8]uint32{970642547, 42024927, 2408930079, 707397645, 3339450817, 2308389420, 1208726658, 3783339692},
				A:      [7]uint32{1641272459, 1356141785, 2036218255, 4276021322, 3576453530, 2163200603, 188834721},
				PC:     4255447016,
				SR:     9741,
				USP:    3097706,
				SSP:    13071052,
				RAM:    [][2]uint32{{6937606, 49}, {6937607, 182}, {6937608, 161}, {6937609, 193}, {6937610, 176}, {6937611, 145}, {13071064, 220}, {13071065, 8}, {13071060, 134}, {13071061, 13}, {13071062, 0}, {13071063, 105}, {13071058, 49}, {13071059, 182}, {13071056, 156}, {13071057, 241}, {13071052, 49}, {13071053, 177}, {13071054, 11}, {13071055, 65}, {12, 253}, {13, 164}, {14, 247}, {15, 228}, {10811364, 57}, {10811365, 62}, {10811366, 121}, {10811367, 39}},
				Halted: true,
			},
		},
		{
			name: "2000 MOVE.w (A6)+, (d8, A7, Xn) 3f9e",
			init: cpuState{
				D:   [8]uint32{3725713055, 3387138312, 89827935, 2663343400, 926777393, 1643429908, 2118670654, 2042655081},
				A:   [7]uint32{472803763, 3211475504, 397298379, 1699832085, 3550588545, 3202916405, 1982187347},
				PC:  9548406,
				SR:  266,
				USP: 11358164,
				SSP: 13181066,
				RAM: [][2]uint32{{9548402, 63}, {9548403, 158}, {9548404, 30}, {9548405, 143}, {12, 242}, {13, 242}, {14, 223}, {15, 154}, {15916954, 109}, {15916955, 50}, {15916956, 47}, {15916957, 107}},
			},
			want: cpuState{
				D:      [8]uint32{3725713055, 3387138312, 89827935, 2663343400, 926777393, 1643429908, 2118670654, 2042655081},
				A:      [7]uint32{472803763, 3211475504, 397298379, 1699832085, 3550588545, 3202916405, 1982187349},
				PC:     4076003230,
				SR:     8458,
				USP:    11358164,
				SSP:    13181052,
				RAM:    [][2]uint32{{9548402, 63}, {9548403, 158}, {9548404, 30}, {9548405, 143}, {13181064, 178}, {13181065, 116}, {13181060, 1}, {13181061, 10}, {13181062, 0}, {13181063, 145}, {13181058, 63}, {13181059, 158}, {13181056, 199}, {13181057, 83}, {13181052, 63}, {13181053, 145}, {13181054, 118}, {13181055, 37}, {12, 242}, {13, 242}, {14, 223}, {15, 154}, {15916954, 109}, {15916955, 50}, {15916956, 47}, {15916957, 107}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVE_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVE.l A6, D3 260e",
			init: cpuState{
				D:   [8]uint32{2779654795, 879651737, 3747849768, 371410818, 733505073, 2153566449, 1534803634, 4126857533},
				A:   [7]uint32{1367930284, 2255304597, 4024009226, 484857825, 3467196709, 1244927156, 1581769544},
				PC:  1303768,
				SR:  1544,
				USP: 12022830,
				SSP: 3289112,
				RAM: [][2]uint32{{1303764, 38}, {1303765, 14}, {1303766, 235}, {1303767, 236}, {1303768, 218}, {1303769, 12}},
			},
			want: cpuState{
				D:   [8]uint32{2779654795, 879651737, 3747849768, 1581769544, 733505073, 2153566449, 1534803634, 4126857533},
				A:   [7]uint32{1367930284, 2255304597, 4024009226, 484857825, 3467196709, 1244927156, 1581769544},
				PC:  1303770,
				SR:  1536,
				USP: 12022830,
				SSP: 3289112,
				RAM: [][2]uint32{{1303764, 38}, {1303765, 14}, {1303766, 235}, {1303767, 236}, {1303768, 218}, {1303769, 12}},
			},
		},
		{
			name: "500 MOVE.l (A6), (A3) 2696",
			init: cpuState{
				D:   [8]uint32{1906962636, 544351852, 835379764, 615842027, 1267734345, 1916177819, 1949004110, 629334693},
				A:   [7]uint32{2238162024, 1403173603, 2182794003, 591293865, 1366987338, 2837198190, 1213243669},
				PC:  11821392,
				SR:  9482,
				USP: 4621904,
				SSP: 15218502,
				RAM: [][2]uint32{{11821388, 38}, {11821389, 150}, {11821390, 242}, {11821391, 126}, {12, 17}, {13, 14}, {14, 230}, {15, 160}, {976544, 230}, {976545, 100}, {976546, 197}, {976547, 2}},
			},
			want: cpuState{
				D:      [8]uint32{1906962636, 544351852, 835379764, 615842027, 1267734345, 1916177819, 1949004110, 629334693},
				A:      [7]uint32{2238162024, 1403173603, 2182794003, 591293865, 1366987338, 2837198190, 1213243669},
				PC:     286189220,
				SR:     9482,
				USP:    4621904,
				SSP:    15218488,
				RAM:    [][2]uint32{{11821388, 38}, {11821389, 150}, {11821390, 242}, {11821391, 126}, {15218500, 97}, {15218501, 78}, {15218496, 37}, {15218497, 10}, {15218498, 0}, {15218499, 180}, {15218494, 38}, {15218495, 150}, {15218492, 161}, {15218493, 21}, {15218488, 38}, {15218489, 149}, {15218490, 72}, {15218491, 80}, {12, 17}, {13, 14}, {14, 230}, {15, 160}, {976544, 230}, {976545, 100}, {976546, 197}, {976547, 2}},
				Halted: true,
			},
		},
		{
			name: "1000 MOVE.l (A5), -(A4) 2915",
			init: cpuState{
				D:   [8]uint32{2259011799, 3381715566, 3566753135, 1740003861, 1863968740, 897217987, 3402300250, 3363457043},
				A:   [7]uint32{4138688317, 1412687503, 416703343, 4141906543, 2745180922, 1410956282, 2689104359},
				PC:  9053130,
				SR:  9747,
				USP: 14434082,
				SSP: 4336484,
				RAM: [][2]uint32{{9053126, 41}, {9053127, 21}, {9053128, 7}, {9053129, 66}, {1670138, 100}, {1670139, 211}, {1670140, 8}, {1670141, 184}, {9053130, 14}, {9053131, 243}},
			},
			want: cpuState{
				D:   [8]uint32{2259011799, 3381715566, 3566753135, 1740003861, 1863968740, 897217987, 3402300250, 3363457043},
				A:   [7]uint32{4138688317, 1412687503, 416703343, 4141906543, 2745180918, 1410956282, 2689104359},
				PC:  9053132,
				SR:  9744,
				USP: 14434082,
				SSP: 4336484,
				RAM: [][2]uint32{{9053126, 41}, {9053127, 21}, {9053128, 7}, {9053129, 66}, {1670138, 100}, {1670139, 211}, {1670140, 8}, {1670141, 184}, {9053130, 14}, {9053131, 243}, {10494712, 8}, {10494713, 184}, {10494710, 100}, {10494711, 211}},
			},
		},
		{
			name: "1500 MOVE.l (A0)+, (d16, A5) 2b58",
			init: cpuState{
				D:   [8]uint32{2243211884, 2835599725, 994373749, 1247880749, 407550755, 1646233360, 2240256088, 2313172021},
				A:   [7]uint32{2497839615, 1054997022, 2036715351, 2265210345, 4123845927, 2902601904, 3555366105},
				PC:  9252066,
				SR:  1538,
				USP: 2634082,
				SSP: 5705800,
				RAM: [][2]uint32{{9252062, 43}, {9252063, 88}, {9252064, 73}, {9252065, 187}, {12, 137}, {13, 110}, {14, 114}, {15, 52}, {7238196, 36}, {7238197, 192}, {7238198, 148}, {7238199, 89}},
			},
			want: cpuState{
				D:      [8]uint32{2243211884, 2835599725, 994373749, 1247880749, 407550755, 1646233360, 2240256088, 2313172021},
				A:      [7]uint32{2497839615, 1054997022, 2036715351, 2265210345, 4123845927, 2902601904, 3555366105},
				PC:     2305716792,
				SR:     9730,
				USP:    2634082,
				SSP:    5705786,
				RAM:    [][2]uint32{{9252062, 43}, {9252063, 88}, {9252064, 73}, {9252065, 187}, {5705798, 44}, {5705799, 224}, {5705794, 6}, {5705795, 2}, {5705796, 0}, {5705797, 141}, {5705792, 43}, {5705793, 88}, {5705790, 1}, {5705791, 255}, {5705786, 43}, {5705787, 81}, {5705788, 148}, {5705789, 226}, {12, 137}, {13, 110}, {14, 114}, {15, 52}, {7238196, 36}, {7238197, 192}, {7238198, 148}, {7238199, 89}},
				Halted: true,
			},
		},
		{
			name: "2000 MOVE.l A7, (d8, A6, Xn) 2d8f",
			init: cpuState{
				D:   [8]uint32{769094282, 820142349, 522189760, 2120923073, 659149166, 694750001, 779492637, 1556090862},
				A:   [7]uint32{2891211662, 1114190426, 1960547781, 3133619532, 3086594567, 217168943, 2110140184},
				PC:  11144946,
				SR:  34582,
				USP: 4923410,
				SSP: 16334636,
				RAM: [][2]uint32{{11144942, 45}, {11144943, 143}, {11144944, 230}, {11144945, 154}, {11144946, 137}, {11144947, 86}, {11144948, 199}, {11144949, 152}},
			},
			want: cpuState{
				D:   [8]uint32{769094282, 820142349, 522189760, 2120923073, 659149166, 694750001, 779492637, 1556090862},
				A:   [7]uint32{2891211662, 1114190426, 1960547781, 3133619532, 3086594567, 217168943, 2110140184},
				PC:  11144950,
				SR:  34576,
				USP: 4923410,
				SSP: 16334636,
				RAM: [][2]uint32{{11144942, 45}, {11144943, 143}, {11144944, 230}, {11144945, 154}, {11144946, 137}, {11144947, 86}, {13000138, 0}, {13000139, 75}, {13000140, 32}, {13000141, 18}, {11144948, 199}, {11144949, 152}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEA_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEA.w (d16, A5), A2 346d",
			init: cpuState{
				D:   [8]uint32{2633737401, 881409296, 938630714, 350777443, 1246386968, 4128130004, 773338312, 3810805693},
				A:   [7]uint32{3643743800, 2737871102, 460026691, 3399621626, 3889092532, 2548963630, 2799262639},
				PC:  2366570,
				SR:  33298,
				USP: 9629732,
				SSP: 9702902,
				RAM: [][2]uint32{{2366566, 52}, {2366567, 109}, {2366568, 168}, {2366569, 8}, {2366570, 230}, {2366571, 149}, {15581494, 71}, {15581495, 31}, {2366572, 173}, {2366573, 91}},
			},
			want: cpuState{
				D:   [8]uint32{2633737401, 881409296, 938630714, 350777443, 1246386968, 4128130004, 773338312, 3810805693},
				A:   [7]uint32{3643743800, 2737871102, 18207, 3399621626, 3889092532, 2548963630, 2799262639},
				PC:  2366574,
				SR:  33298,
				USP: 9629732,
				SSP: 9702902,
				RAM: [][2]uint32{{2366566, 52}, {2366567, 109}, {2366568, 168}, {2366569, 8}, {2366570, 230}, {2366571, 149}, {15581494, 71}, {15581495, 31}, {2366572, 173}, {2366573, 91}},
			},
		},
		{
			name: "500 MOVEA.w D0, A2 3440",
			init: cpuState{
				D:   [8]uint32{4132436609, 1700069792, 1947766642, 1233203667, 4068705777, 1646861605, 96064372, 144201063},
				A:   [7]uint32{1771938927, 3970136038, 1838383541, 55271316, 2965380833, 3192637829, 2808054900},
				PC:  11208608,
				SR:  42013,
				USP: 3435976,
				SSP: 965830,
				RAM: [][2]uint32{{11208604, 52}, {11208605, 64}, {11208606, 10}, {11208607, 42}, {11208608, 60}, {11208609, 246}},
			},
			want: cpuState{
				D:   [8]uint32{4132436609, 1700069792, 1947766642, 1233203667, 4068705777, 1646861605, 96064372, 144201063},
				A:   [7]uint32{1771938927, 3970136038, 4294965889, 55271316, 2965380833, 3192637829, 2808054900},
				PC:  11208610,
				SR:  42013,
				USP: 3435976,
				SSP: 965830,
				RAM: [][2]uint32{{11208604, 52}, {11208605, 64}, {11208606, 10}, {11208607, 42}, {11208608, 60}, {11208609, 246}},
			},
		},
		{
			name: "1000 MOVEA.w (d8, A0, Xn), A0 3070",
			init: cpuState{
				D:   [8]uint32{1389797193, 4162590642, 114793799, 3993037372, 1339774546, 3174000549, 3456537320, 1806466680},
				A:   [7]uint32{2664872460, 1989940790, 198392215, 2899354035, 3795768192, 3990845804, 2384483721},
				PC:  195706,
				SR:  8212,
				USP: 16476494,
				SSP: 9341842,
				RAM: [][2]uint32{{195702, 48}, {195703, 112}, {195704, 207}, {195705, 72}, {195706, 219}, {195707, 34}, {1412564, 197}, {1412565, 174}, {195708, 0}, {195709, 144}},
			},
			want: cpuState{
				D:   [8]uint32{1389797193, 4162590642, 114793799, 3993037372, 1339774546, 3174000549, 3456537320, 1806466680},
				A:   [7]uint32{4294952366, 1989940790, 198392215, 2899354035, 3795768192, 3990845804, 2384483721},
				PC:  195710,
				SR:  8212,
				USP: 16476494,
				SSP: 9341842,
				RAM: [][2]uint32{{195702, 48}, {195703, 112}, {195704, 207}, {195705, 72}, {195706, 219}, {195707, 34}, {1412564, 197}, {1412565, 174}, {195708, 0}, {195709, 144}},
			},
		},
		{
			name: "1500 MOVEA.w (d8, A3, Xn), A4 3873",
			init: cpuState{
				D:   [8]uint32{2234733666, 291275165, 2952499797, 1883980557, 2471670141, 3120043754, 216107469, 1263155448},
				A:   [7]uint32{1656944752, 3100719148, 3143950131, 3062858622, 44585201, 2418165233, 152911640},
				PC:  5837178,
				SR:  8452,
				USP: 13146320,
				SSP: 9491448,
				RAM: [][2]uint32{{5837174, 56}, {5837175, 115}, {5837176, 181}, {5837177, 40}, {5837178, 194}, {5837179, 70}, {9373476, 26}, {9373477, 184}, {5837180, 32}, {5837181, 187}},
			},
			want: cpuState{
				D:   [8]uint32{2234733666, 291275165, 2952499797, 1883980557, 2471670141, 3120043754, 216107469, 1263155448},
				A:   [7]uint32{1656944752, 3100719148, 3143950131, 3062858622, 6840, 2418165233, 152911640},
				PC:  5837182,
				SR:  8452,
				USP: 13146320,
				SSP: 9491448,
				RAM: [][2]uint32{{5837174, 56}, {5837175, 115}, {5837176, 181}, {5837177, 40}, {5837178, 194}, {5837179, 70}, {9373476, 26}, {9373477, 184}, {5837180, 32}, {5837181, 187}},
			},
		},
		{
			name: "2000 MOVEA.w -(A6), A6 3c66",
			init: cpuState{
				D:   [8]uint32{2144636058, 1785863322, 119615365, 3185098495, 2648751119, 6974025, 112613251, 111329591},
				A:   [7]uint32{368441009, 4144009678, 1203869270, 3572133479, 3386634153, 1434543674, 3679905064},
				PC:  6309770,
				SR:  1806,
				USP: 9528720,
				SSP: 13734672,
				RAM: [][2]uint32{{6309766, 60}, {6309767, 102}, {6309768, 81}, {6309769, 233}, {5694758, 29}, {5694759, 216}, {6309770, 91}, {6309771, 249}},
			},
			want: cpuState{
				D:   [8]uint32{2144636058, 1785863322, 119615365, 3185098495, 2648751119, 6974025, 112613251, 111329591},
				A:   [7]uint32{368441009, 4144009678, 1203869270, 3572133479, 3386634153, 1434543674, 7640},
				PC:  6309772,
				SR:  1806,
				USP: 9528720,
				SSP: 13734672,
				RAM: [][2]uint32{{6309766, 60}, {6309767, 102}, {6309768, 81}, {6309769, 233}, {5694758, 29}, {5694759, 216}, {6309770, 91}, {6309771, 249}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEA_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEA.l (d16, A6), A0 206e",
			init: cpuState{
				D:   [8]uint32{3169999053, 3469235951, 2271338676, 2511997186, 2512246480, 1951198345, 182753002, 1861824547},
				A:   [7]uint32{3981850156, 3212903014, 1011064591, 828776136, 4262926462, 538596608, 3377535161},
				PC:  5315798,
				SR:  34326,
				USP: 13214434,
				SSP: 9236656,
				RAM: [][2]uint32{{5315794, 32}, {5315795, 110}, {5315796, 219}, {5315797, 121}, {5315798, 31}, {5315799, 84}, {5305394, 6}, {5305395, 161}, {5305396, 245}, {5305397, 39}, {5315800, 70}, {5315801, 89}},
			},
			want: cpuState{
				D:   [8]uint32{3169999053, 3469235951, 2271338676, 2511997186, 2512246480, 1951198345, 182753002, 1861824547},
				A:   [7]uint32{111277351, 3212903014, 1011064591, 828776136, 4262926462, 538596608, 3377535161},
				PC:  5315802,
				SR:  34326,
				USP: 13214434,
				SSP: 9236656,
				RAM: [][2]uint32{{5315794, 32}, {5315795, 110}, {5315796, 219}, {5315797, 121}, {5315798, 31}, {5315799, 84}, {5305394, 6}, {5305395, 161}, {5305396, 245}, {5305397, 39}, {5315800, 70}, {5315801, 89}},
			},
		},
		{
			name: "500 MOVEA.l -(A4), A5 2a64",
			init: cpuState{
				D:   [8]uint32{2877479198, 2590065528, 2389775311, 1986702321, 2144261999, 2104095943, 4172402348, 2964225903},
				A:   [7]uint32{132481090, 3224410927, 4048291003, 1258365565, 865876212, 3207635035, 3004754001},
				PC:  5183674,
				SR:  8205,
				USP: 3708158,
				SSP: 16293776,
				RAM: [][2]uint32{{5183670, 42}, {5183671, 100}, {5183672, 29}, {5183673, 54}, {10238192, 144}, {10238193, 49}, {10238194, 164}, {10238195, 15}, {5183674, 12}, {5183675, 86}},
			},
			want: cpuState{
				D:   [8]uint32{2877479198, 2590065528, 2389775311, 1986702321, 2144261999, 2104095943, 4172402348, 2964225903},
				A:   [7]uint32{132481090, 3224410927, 4048291003, 1258365565, 865876208, 2419172367, 3004754001},
				PC:  5183676,
				SR:  8205,
				USP: 3708158,
				SSP: 16293776,
				RAM: [][2]uint32{{5183670, 42}, {5183671, 100}, {5183672, 29}, {5183673, 54}, {10238192, 144}, {10238193, 49}, {10238194, 164}, {10238195, 15}, {5183674, 12}, {5183675, 86}},
			},
		},
		{
			name: "1000 MOVEA.l A1, A7 2e49",
			init: cpuState{
				D:   [8]uint32{1091934947, 1626835711, 688110276, 3339143088, 1288320308, 1331170284, 680636825, 1485806582},
				A:   [7]uint32{1547983385, 3775234729, 1608843719, 3501801170, 2857974928, 2492487691, 578007681},
				PC:  4699910,
				SR:  9994,
				USP: 12246906,
				SSP: 8818602,
				RAM: [][2]uint32{{4699906, 46}, {4699907, 73}, {4699908, 237}, {4699909, 181}, {4699910, 198}, {4699911, 238}},
			},
			want: cpuState{
				D:   [8]uint32{1091934947, 1626835711, 688110276, 3339143088, 1288320308, 1331170284, 680636825, 1485806582},
				A:   [7]uint32{1547983385, 3775234729, 1608843719, 3501801170, 2857974928, 2492487691, 578007681},
				PC:  4699912,
				SR:  9994,
				USP: 12246906,
				SSP: 3775234729,
				RAM: [][2]uint32{{4699906, 46}, {4699907, 73}, {4699908, 237}, {4699909, 181}, {4699910, 198}, {4699911, 238}},
			},
		},
		{
			name: "1500 MOVEA.l D0, A0 2040",
			init: cpuState{
				D:   [8]uint32{3078108578, 2338095899, 3163000260, 646909649, 1182213857, 3898719858, 213639519, 3059320633},
				A:   [7]uint32{3021398294, 673177316, 3916825224, 864685514, 655834753, 2927496933, 1829025197},
				PC:  8051022,
				SR:  32778,
				USP: 15450696,
				SSP: 4726688,
				RAM: [][2]uint32{{8051018, 32}, {8051019, 64}, {8051020, 195}, {8051021, 125}, {8051022, 190}, {8051023, 199}},
			},
			want: cpuState{
				D:   [8]uint32{3078108578, 2338095899, 3163000260, 646909649, 1182213857, 3898719858, 213639519, 3059320633},
				A:   [7]uint32{3078108578, 673177316, 3916825224, 864685514, 655834753, 2927496933, 1829025197},
				PC:  8051024,
				SR:  32778,
				USP: 15450696,
				SSP: 4726688,
				RAM: [][2]uint32{{8051018, 32}, {8051019, 64}, {8051020, 195}, {8051021, 125}, {8051022, 190}, {8051023, 199}},
			},
		},
		{
			name: "2000 MOVEA.l (d16, PC), A0 207a",
			init: cpuState{
				D:   [8]uint32{3162276674, 2048924862, 3470990145, 3547869820, 2428934887, 2913378524, 984001236, 853692517},
				A:   [7]uint32{1399720575, 3249995876, 426971079, 951637663, 723793535, 2721366118, 3118872329},
				PC:  2321426,
				SR:  41492,
				USP: 5040616,
				SSP: 4299208,
				RAM: [][2]uint32{{2321422, 32}, {2321423, 122}, {2321424, 225}, {2321425, 174}, {2321426, 232}, {2321427, 213}, {2313662, 46}, {2313663, 63}, {2313664, 155}, {2313665, 22}, {2321428, 27}, {2321429, 188}},
			},
			want: cpuState{
				D:   [8]uint32{3162276674, 2048924862, 3470990145, 3547869820, 2428934887, 2913378524, 984001236, 853692517},
				A:   [7]uint32{775920406, 3249995876, 426971079, 951637663, 723793535, 2721366118, 3118872329},
				PC:  2321430,
				SR:  41492,
				USP: 5040616,
				SSP: 4299208,
				RAM: [][2]uint32{{2321422, 32}, {2321423, 122}, {2321424, 225}, {2321425, 174}, {2321426, 232}, {2321427, 213}, {2313662, 46}, {2313663, 63}, {2313664, 155}, {2313665, 22}, {2321428, 27}, {2321429, 188}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVE_Q(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVE.q -93, D4 78a3",
			init: cpuState{
				D:   [8]uint32{1368507428, 2882228128, 1632881270, 1081181017, 871178762, 3940334615, 891671545, 1052984192},
				A:   [7]uint32{735332410, 3884043659, 3218654234, 432162589, 4181445395, 3141584995, 1571061528},
				PC:  12501994,
				SR:  42497,
				USP: 18276,
				SSP: 15051064,
				RAM: [][2]uint32{{12501990, 120}, {12501991, 163}, {12501992, 170}, {12501993, 38}, {12501994, 184}, {12501995, 23}},
			},
			want: cpuState{
				D:   [8]uint32{1368507428, 2882228128, 1632881270, 1081181017, 4294967203, 3940334615, 891671545, 1052984192},
				A:   [7]uint32{735332410, 3884043659, 3218654234, 432162589, 4181445395, 3141584995, 1571061528},
				PC:  12501996,
				SR:  42504,
				USP: 18276,
				SSP: 15051064,
				RAM: [][2]uint32{{12501990, 120}, {12501991, 163}, {12501992, 170}, {12501993, 38}, {12501994, 184}, {12501995, 23}},
			},
		},
		{
			name: "500 MOVE.q 119, D4 7877",
			init: cpuState{
				D:   [8]uint32{458313327, 3780534870, 3170911138, 1563741514, 218997239, 3524066120, 2604764071, 1723996091},
				A:   [7]uint32{420463870, 208527311, 3841066439, 3183619664, 850233369, 3277272206, 810198522},
				PC:  4372406,
				SR:  33818,
				USP: 2126350,
				SSP: 3568646,
				RAM: [][2]uint32{{4372402, 120}, {4372403, 119}, {4372404, 18}, {4372405, 38}, {4372406, 227}, {4372407, 4}},
			},
			want: cpuState{
				D:   [8]uint32{458313327, 3780534870, 3170911138, 1563741514, 119, 3524066120, 2604764071, 1723996091},
				A:   [7]uint32{420463870, 208527311, 3841066439, 3183619664, 850233369, 3277272206, 810198522},
				PC:  4372408,
				SR:  33808,
				USP: 2126350,
				SSP: 3568646,
				RAM: [][2]uint32{{4372402, 120}, {4372403, 119}, {4372404, 18}, {4372405, 38}, {4372406, 227}, {4372407, 4}},
			},
		},
		{
			name: "1000 MOVE.q -52, D5 7acc",
			init: cpuState{
				D:   [8]uint32{1868207989, 3766932103, 3294517578, 2952822451, 3708992836, 1042142864, 3115669019, 3660739159},
				A:   [7]uint32{2487367538, 4243622812, 3988772480, 11777684, 624548449, 394735097, 1088227876},
				PC:  12961374,
				SR:  34059,
				USP: 12436056,
				SSP: 9978614,
				RAM: [][2]uint32{{12961370, 122}, {12961371, 204}, {12961372, 233}, {12961373, 95}, {12961374, 222}, {12961375, 157}},
			},
			want: cpuState{
				D:   [8]uint32{1868207989, 3766932103, 3294517578, 2952822451, 3708992836, 4294967244, 3115669019, 3660739159},
				A:   [7]uint32{2487367538, 4243622812, 3988772480, 11777684, 624548449, 394735097, 1088227876},
				PC:  12961376,
				SR:  34056,
				USP: 12436056,
				SSP: 9978614,
				RAM: [][2]uint32{{12961370, 122}, {12961371, 204}, {12961372, 233}, {12961373, 95}, {12961374, 222}, {12961375, 157}},
			},
		},
		{
			name: "1500 MOVE.q -31, D6 7ce1",
			init: cpuState{
				D:   [8]uint32{1521990852, 4179550600, 1089337311, 1028264849, 3584439129, 2850961317, 230696653, 2863892606},
				A:   [7]uint32{1427755310, 4293016860, 2642974985, 1432945498, 4137723842, 2431878191, 3270739455},
				PC:  4874586,
				SR:  9222,
				USP: 7645828,
				SSP: 9930624,
				RAM: [][2]uint32{{4874582, 124}, {4874583, 225}, {4874584, 187}, {4874585, 203}, {4874586, 140}, {4874587, 170}},
			},
			want: cpuState{
				D:   [8]uint32{1521990852, 4179550600, 1089337311, 1028264849, 3584439129, 2850961317, 4294967265, 2863892606},
				A:   [7]uint32{1427755310, 4293016860, 2642974985, 1432945498, 4137723842, 2431878191, 3270739455},
				PC:  4874588,
				SR:  9224,
				USP: 7645828,
				SSP: 9930624,
				RAM: [][2]uint32{{4874582, 124}, {4874583, 225}, {4874584, 187}, {4874585, 203}, {4874586, 140}, {4874587, 170}},
			},
		},
		{
			name: "2000 MOVE.q -78, D3 76b2",
			init: cpuState{
				D:   [8]uint32{196024424, 1524372816, 1403710452, 3706075262, 3137803408, 2514497733, 2714373213, 3371962843},
				A:   [7]uint32{1538551958, 1556695366, 3512362196, 839860817, 3058185247, 52968155, 441013148},
				PC:  3267998,
				SR:  8704,
				USP: 10474830,
				SSP: 11969948,
				RAM: [][2]uint32{{3267994, 118}, {3267995, 178}, {3267996, 192}, {3267997, 10}, {3267998, 225}, {3267999, 201}},
			},
			want: cpuState{
				D:   [8]uint32{196024424, 1524372816, 1403710452, 4294967218, 3137803408, 2514497733, 2714373213, 3371962843},
				A:   [7]uint32{1538551958, 1556695366, 3512362196, 839860817, 3058185247, 52968155, 441013148},
				PC:  3268000,
				SR:  8712,
				USP: 10474830,
				SSP: 11969948,
				RAM: [][2]uint32{{3267994, 118}, {3267995, 178}, {3267996, 192}, {3267997, 10}, {3267998, 225}, {3267999, 201}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEM_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEM.w #, (d16, A7) 48af",
			init: cpuState{
				D:   [8]uint32{2516854248, 1224448443, 2738172433, 749428807, 51877730, 1992372080, 3018445573, 714955254},
				A:   [7]uint32{415175827, 788158023, 3093381556, 2582546957, 143558775, 2086406636, 1268185199},
				PC:  6601746,
				SR:  2,
				USP: 15833890,
				SSP: 7443558,
				RAM: [][2]uint32{{6601742, 72}, {6601743, 175}, {6601744, 138}, {6601745, 120}, {6601746, 7}, {6601747, 15}, {6601748, 247}, {6601749, 213}, {12, 80}, {13, 172}, {14, 165}, {15, 230}, {11314662, 112}, {11314663, 32}, {11314664, 169}, {11314665, 217}},
			},
			want: cpuState{
				D:      [8]uint32{2516854248, 1224448443, 2738172433, 749428807, 51877730, 1992372080, 3018445573, 714955254},
				A:      [7]uint32{415175827, 788158023, 3093381556, 2582546957, 143558775, 2086406636, 1268185199},
				PC:     1353491946,
				SR:     8194,
				USP:    15833890,
				SSP:    7443544,
				RAM:    [][2]uint32{{6601742, 72}, {6601743, 175}, {6601744, 138}, {6601745, 120}, {6601746, 7}, {6601747, 15}, {6601748, 247}, {6601749, 213}, {7443556, 188}, {7443557, 22}, {7443552, 0}, {7443553, 2}, {7443554, 0}, {7443555, 100}, {7443550, 72}, {7443551, 175}, {7443548, 162}, {7443549, 49}, {7443544, 72}, {7443545, 161}, {7443546, 0}, {7443547, 241}, {12, 80}, {13, 172}, {14, 165}, {15, 230}, {11314662, 112}, {11314663, 32}, {11314664, 169}, {11314665, 217}},
				Halted: true,
			},
		},
		{
			name: "500 MOVEM.w (A7)+, # 4c9f",
			init: cpuState{
				D:   [8]uint32{1053240831, 4005744155, 1176679930, 2512127795, 662228390, 285919194, 3995030301, 4164488118},
				A:   [7]uint32{2066354854, 536296495, 4005657645, 3300326240, 520434363, 969476914, 3795560664},
				PC:  8883564,
				SR:  1811,
				USP: 3106998,
				SSP: 14098252,
				RAM: [][2]uint32{{8883560, 76}, {8883561, 159}, {8883562, 179}, {8883563, 125}, {8883564, 62}, {8883565, 76}, {3106998, 226}, {3106999, 78}, {3107000, 211}, {3107001, 226}, {3107002, 59}, {3107003, 43}, {3107004, 212}, {3107005, 115}, {3107006, 144}, {3107007, 13}, {3107008, 125}, {3107009, 249}, {3107010, 1}, {3107011, 58}, {3107012, 8}, {3107013, 102}, {3107014, 96}, {3107015, 30}, {3107016, 181}, {3107017, 115}, {3107018, 130}, {3107019, 186}, {3107020, 252}, {3107021, 138}, {8883566, 213}, {8883567, 77}},
			},
			want: cpuState{
				D:   [8]uint32{4294959694, 4005744155, 4294956002, 15147, 4294956147, 4294938637, 32249, 4164488118},
				A:   [7]uint32{314, 2150, 4005657645, 3300326240, 24606, 4294948211, 3795560664},
				PC:  8883568,
				SR:  1811,
				USP: 3107020,
				SSP: 14098252,
				RAM: [][2]uint32{{8883560, 76}, {8883561, 159}, {8883562, 179}, {8883563, 125}, {8883564, 62}, {8883565, 76}, {3106998, 226}, {3106999, 78}, {3107000, 211}, {3107001, 226}, {3107002, 59}, {3107003, 43}, {3107004, 212}, {3107005, 115}, {3107006, 144}, {3107007, 13}, {3107008, 125}, {3107009, 249}, {3107010, 1}, {3107011, 58}, {3107012, 8}, {3107013, 102}, {3107014, 96}, {3107015, 30}, {3107016, 181}, {3107017, 115}, {3107018, 130}, {3107019, 186}, {3107020, 252}, {3107021, 138}, {8883566, 213}, {8883567, 77}},
			},
		},
		{
			name: "1000 MOVEM.w (A6)+, # 4c9e",
			init: cpuState{
				D:   [8]uint32{4105608420, 696610705, 3042460131, 1016764949, 882012821, 2337095667, 615150736, 2948104108},
				A:   [7]uint32{122976785, 2173134499, 1008674440, 1823559609, 171019523, 1610608308, 2178653353},
				PC:  5074020,
				SR:  9736,
				USP: 11435678,
				SSP: 3800184,
				RAM: [][2]uint32{{5074016, 76}, {5074017, 158}, {5074018, 222}, {5074019, 123}, {5074020, 42}, {5074021, 108}, {12, 205}, {13, 128}, {14, 130}, {15, 210}, {8422098, 17}, {8422099, 176}, {8422100, 66}, {8422101, 25}},
			},
			want: cpuState{
				D:      [8]uint32{4105608420, 696610705, 3042460131, 1016764949, 882012821, 2337095667, 615150736, 2948104108},
				A:      [7]uint32{122976785, 2173134499, 1008674440, 1823559609, 171019523, 1610608308, 2178653353},
				PC:     3447751382,
				SR:     9736,
				USP:    11435678,
				SSP:    3800170,
				RAM:    [][2]uint32{{5074016, 76}, {5074017, 158}, {5074018, 222}, {5074019, 123}, {5074020, 42}, {5074021, 108}, {3800182, 108}, {3800183, 102}, {3800178, 38}, {3800179, 8}, {3800180, 0}, {3800181, 77}, {3800176, 76}, {3800177, 158}, {3800174, 156}, {3800175, 169}, {3800170, 76}, {3800171, 149}, {3800172, 129}, {3800173, 219}, {12, 205}, {13, 128}, {14, 130}, {15, 210}, {8422098, 17}, {8422099, 176}, {8422100, 66}, {8422101, 25}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVEM.w #, (d16, A4) 48ac",
			init: cpuState{
				D:   [8]uint32{1314060798, 2950439225, 183557897, 477034068, 650946571, 4230825535, 560573871, 3945766741},
				A:   [7]uint32{1048182785, 2301989440, 1563872275, 3666447312, 188801213, 3510649371, 3610024883},
				PC:  7571286,
				SR:  41752,
				USP: 8415520,
				SSP: 892146,
				RAM: [][2]uint32{{7571282, 72}, {7571283, 172}, {7571284, 84}, {7571285, 39}, {7571286, 226}, {7571287, 93}, {7571288, 99}, {7571289, 166}, {7571290, 165}, {7571291, 197}},
			},
			want: cpuState{
				D:   [8]uint32{1314060798, 2950439225, 183557897, 477034068, 650946571, 4230825535, 560573871, 3945766741},
				A:   [7]uint32{1048182785, 2301989440, 1563872275, 3666447312, 188801213, 3510649371, 3610024883},
				PC:  7571292,
				SR:  41752,
				USP: 8415520,
				SSP: 892146,
				RAM: [][2]uint32{{7571282, 72}, {7571283, 172}, {7571284, 84}, {7571285, 39}, {7571286, 226}, {7571287, 93}, {7571288, 99}, {7571289, 166}, {4244250, 249}, {4244251, 254}, {4244252, 33}, {4244253, 57}, {4244254, 223}, {4244255, 9}, {4244256, 70}, {4244257, 63}, {4244258, 204}, {4244259, 19}, {4244260, 224}, {4244261, 189}, {4244262, 155}, {4244263, 179}, {7571290, 165}, {7571291, 197}},
			},
		},
		{
			name: "2000 MOVEM.w #, (d16, A3) 48ab",
			init: cpuState{
				D:   [8]uint32{2671031741, 1971874210, 402214233, 2823559196, 2151519561, 1787822396, 610795617, 1380132743},
				A:   [7]uint32{3627486763, 2278475029, 4168261540, 777262106, 1355993625, 2460508507, 3486221675},
				PC:  8114078,
				SR:  272,
				USP: 16051408,
				SSP: 9970790,
				RAM: [][2]uint32{{8114074, 72}, {8114075, 171}, {8114076, 86}, {8114077, 29}, {8114078, 142}, {8114079, 246}, {8114080, 246}, {8114081, 142}, {8114082, 233}, {8114083, 38}},
			},
			want: cpuState{
				D:   [8]uint32{2671031741, 1971874210, 402214233, 2823559196, 2151519561, 1787822396, 610795617, 1380132743},
				A:   [7]uint32{3627486763, 2278475029, 4168261540, 777262106, 1355993625, 2460508507, 3486221675},
				PC:  8114084,
				SR:  272,
				USP: 16051408,
				SSP: 9970790,
				RAM: [][2]uint32{{8114074, 72}, {8114075, 171}, {8114076, 86}, {8114077, 29}, {8114078, 142}, {8114079, 246}, {8114080, 246}, {8114081, 142}, {5481232, 181}, {5481233, 189}, {5481234, 77}, {5481235, 89}, {5481236, 24}, {5481237, 28}, {5481238, 149}, {5481239, 73}, {5481240, 197}, {5481241, 21}, {5481242, 159}, {5481243, 164}, {5481244, 210}, {5481245, 25}, {5481246, 133}, {5481247, 107}, {8114082, 233}, {8114083, 38}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEM_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEM.l (A0), # 4cd0",
			init: cpuState{
				D:   [8]uint32{4145974960, 98666609, 4134305615, 2306122646, 3759942418, 2261160881, 4192929536, 495306415},
				A:   [7]uint32{1291678793, 1674217383, 3287716855, 1614216120, 530989899, 1794898052, 3703973272},
				PC:  14353542,
				SR:  8991,
				USP: 590824,
				SSP: 3242804,
				RAM: [][2]uint32{{14353538, 76}, {14353539, 208}, {14353540, 56}, {14353541, 19}, {14353542, 196}, {14353543, 217}, {12, 145}, {13, 154}, {14, 217}, {15, 18}, {10148114, 103}, {10148115, 195}, {10148116, 113}, {10148117, 94}},
			},
			want: cpuState{
				D:      [8]uint32{4145974960, 98666609, 4134305615, 2306122646, 3759942418, 2261160881, 4192929536, 495306415},
				A:      [7]uint32{1291678793, 1674217383, 3287716855, 1614216120, 530989899, 1794898052, 3703973272},
				PC:     2442844438,
				SR:     8991,
				USP:    590824,
				SSP:    3242790,
				RAM:    [][2]uint32{{14353538, 76}, {14353539, 208}, {14353540, 56}, {14353541, 19}, {14353542, 196}, {14353543, 217}, {3242802, 4}, {3242803, 136}, {3242798, 35}, {3242799, 31}, {3242800, 0}, {3242801, 219}, {3242796, 76}, {3242797, 208}, {3242794, 116}, {3242795, 73}, {3242790, 76}, {3242791, 213}, {3242792, 76}, {3242793, 253}, {12, 145}, {13, 154}, {14, 217}, {15, 18}, {10148114, 103}, {10148115, 195}, {10148116, 113}, {10148117, 94}},
				Halted: true,
			},
		},
		{
			name: "500 MOVEM.l (A3)+, # 4cdb",
			init: cpuState{
				D:   [8]uint32{4070833938, 3709473564, 3700992492, 2313386347, 2039239174, 1372578966, 342403102, 997113164},
				A:   [7]uint32{35192696, 4255498477, 4108394088, 4074843058, 350655141, 3324762830, 2991829527},
				PC:  8154406,
				SR:  33285,
				USP: 833468,
				SSP: 183544,
				RAM: [][2]uint32{{8154402, 76}, {8154403, 219}, {8154404, 32}, {8154405, 127}, {8154406, 217}, {8154407, 136}, {14756786, 68}, {14756787, 171}, {14756788, 80}, {14756789, 32}, {14756790, 24}, {14756791, 224}, {14756792, 49}, {14756793, 163}, {14756794, 170}, {14756795, 65}, {14756796, 241}, {14756797, 16}, {14756798, 83}, {14756799, 101}, {14756800, 43}, {14756801, 144}, {14756802, 174}, {14756803, 7}, {14756804, 26}, {14756805, 140}, {14756806, 119}, {14756807, 36}, {14756808, 29}, {14756809, 72}, {14756810, 124}, {14756811, 177}, {14756812, 159}, {14756813, 19}, {14756814, 224}, {14756815, 43}, {14756816, 80}, {14756817, 119}, {14756818, 190}, {14756819, 222}, {8154408, 15}, {8154409, 47}},
			},
			want: cpuState{
				D:   [8]uint32{1152077856, 417345955, 2856448272, 1399139216, 2919701132, 1998855496, 2092015379, 997113164},
				A:   [7]uint32{35192696, 4255498477, 4108394088, 4074843090, 350655141, 3760935031, 2991829527},
				PC:  8154410,
				SR:  33285,
				USP: 833468,
				SSP: 183544,
				RAM: [][2]uint32{{8154402, 76}, {8154403, 219}, {8154404, 32}, {8154405, 127}, {8154406, 217}, {8154407, 136}, {14756786, 68}, {14756787, 171}, {14756788, 80}, {14756789, 32}, {14756790, 24}, {14756791, 224}, {14756792, 49}, {14756793, 163}, {14756794, 170}, {14756795, 65}, {14756796, 241}, {14756797, 16}, {14756798, 83}, {14756799, 101}, {14756800, 43}, {14756801, 144}, {14756802, 174}, {14756803, 7}, {14756804, 26}, {14756805, 140}, {14756806, 119}, {14756807, 36}, {14756808, 29}, {14756809, 72}, {14756810, 124}, {14756811, 177}, {14756812, 159}, {14756813, 19}, {14756814, 224}, {14756815, 43}, {14756816, 80}, {14756817, 119}, {14756818, 190}, {14756819, 222}, {8154408, 15}, {8154409, 47}},
			},
		},
		{
			name: "1000 MOVEM.l (d8, A4, Xn), # 4cf4",
			init: cpuState{
				D:   [8]uint32{2281808026, 1606278836, 2174335579, 3089282453, 3363370756, 377098347, 369340366, 210301945},
				A:   [7]uint32{792693173, 2816978871, 613038058, 3365325113, 680158747, 2687155925, 3510585527},
				PC:  2006196,
				SR:  268,
				USP: 8304062,
				SSP: 3747552,
				RAM: [][2]uint32{{2006192, 76}, {2006193, 244}, {2006194, 1}, {2006195, 173}, {2006196, 30}, {2006197, 32}, {2006198, 46}, {2006199, 167}, {12, 152}, {13, 174}, {14, 95}, {15, 204}, {11427788, 131}, {11427789, 29}, {11427790, 163}, {11427791, 2}},
			},
			want: cpuState{
				D:      [8]uint32{2281808026, 1606278836, 2174335579, 3089282453, 3363370756, 377098347, 369340366, 210301945},
				A:      [7]uint32{792693173, 2816978871, 613038058, 3365325113, 680158747, 2687155925, 3510585527},
				PC:     2561564624,
				SR:     8460,
				USP:    8304062,
				SSP:    3747538,
				RAM:    [][2]uint32{{2006192, 76}, {2006193, 244}, {2006194, 1}, {2006195, 173}, {2006196, 30}, {2006197, 32}, {2006198, 46}, {2006199, 167}, {3747550, 156}, {3747551, 184}, {3747546, 1}, {3747547, 12}, {3747548, 0}, {3747549, 30}, {3747544, 76}, {3747545, 244}, {3747542, 68}, {3747543, 239}, {3747538, 76}, {3747539, 241}, {3747540, 136}, {3747541, 72}, {12, 152}, {13, 174}, {14, 95}, {15, 204}, {11427788, 131}, {11427789, 29}, {11427790, 163}, {11427791, 2}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVEM.l (A6), # 4cd6",
			init: cpuState{
				D:   [8]uint32{2190334619, 1458758065, 506639552, 346537831, 2825890699, 2533066215, 2402309286, 1989339886},
				A:   [7]uint32{3142083142, 2368339472, 3457690161, 1073553760, 3819079062, 2457336872, 2772183950},
				PC:  16729070,
				SR:  34329,
				USP: 1309746,
				SSP: 10868980,
				RAM: [][2]uint32{{16729066, 76}, {16729067, 214}, {16729068, 18}, {16729069, 110}, {16729070, 192}, {16729071, 30}, {3943310, 215}, {3943311, 253}, {3943312, 149}, {3943313, 243}, {3943314, 141}, {3943315, 27}, {3943316, 82}, {3943317, 233}, {3943318, 150}, {3943319, 25}, {3943320, 97}, {3943321, 53}, {3943322, 66}, {3943323, 57}, {3943324, 109}, {3943325, 0}, {3943326, 66}, {3943327, 140}, {3943328, 38}, {3943329, 228}, {3943330, 247}, {3943331, 73}, {3943332, 215}, {3943333, 1}, {3943334, 83}, {3943335, 2}, {3943336, 184}, {3943337, 68}, {3943338, 184}, {3943339, 182}, {16729072, 15}, {16729073, 127}},
			},
			want: cpuState{
				D:   [8]uint32{2190334619, 3623720435, 2367378153, 2518245685, 2825890699, 1111059712, 1116481252, 1989339886},
				A:   [7]uint32{3142083142, 4148811521, 3457690161, 1073553760, 1392687172, 2457336872, 2772183950},
				PC:  16729074,
				SR:  34329,
				USP: 1309746,
				SSP: 10868980,
				RAM: [][2]uint32{{16729066, 76}, {16729067, 214}, {16729068, 18}, {16729069, 110}, {16729070, 192}, {16729071, 30}, {3943310, 215}, {3943311, 253}, {3943312, 149}, {3943313, 243}, {3943314, 141}, {3943315, 27}, {3943316, 82}, {3943317, 233}, {3943318, 150}, {3943319, 25}, {3943320, 97}, {3943321, 53}, {3943322, 66}, {3943323, 57}, {3943324, 109}, {3943325, 0}, {3943326, 66}, {3943327, 140}, {3943328, 38}, {3943329, 228}, {3943330, 247}, {3943331, 73}, {3943332, 215}, {3943333, 1}, {3943334, 83}, {3943335, 2}, {3943336, 184}, {3943337, 68}, {3943338, 184}, {3943339, 182}, {16729072, 15}, {16729073, 127}},
			},
		},
		{
			name: "2000 MOVEM.l (A2)+, # 4cda",
			init: cpuState{
				D:   [8]uint32{1799497197, 2248024927, 3745444050, 613628228, 1759951819, 1502084221, 2029516742, 4178324760},
				A:   [7]uint32{3555992778, 4140131038, 1330774695, 1904381096, 1340934943, 1213874391, 1151662581},
				PC:  11866664,
				SR:  33560,
				USP: 13903986,
				SSP: 9962054,
				RAM: [][2]uint32{{11866660, 76}, {11866661, 218}, {11866662, 87}, {11866663, 13}, {11866664, 41}, {11866665, 186}, {12, 240}, {13, 200}, {14, 249}, {15, 214}, {13171158, 150}, {13171159, 172}, {13171160, 222}, {13171161, 82}},
			},
			want: cpuState{
				D:      [8]uint32{1799497197, 2248024927, 3745444050, 613628228, 1759951819, 1502084221, 2029516742, 4178324760},
				A:      [7]uint32{3555992778, 4140131038, 1330774695, 1904381096, 1340934943, 1213874391, 1151662581},
				PC:     4039703002,
				SR:     8984,
				USP:    13903986,
				SSP:    9962040,
				RAM:    [][2]uint32{{11866660, 76}, {11866661, 218}, {11866662, 87}, {11866663, 13}, {11866664, 41}, {11866665, 186}, {9962052, 18}, {9962053, 42}, {9962048, 131}, {9962049, 24}, {9962050, 0}, {9962051, 181}, {9962046, 76}, {9962047, 218}, {9962044, 2}, {9962045, 167}, {9962040, 76}, {9962041, 209}, {9962042, 79}, {9962043, 82}, {12, 240}, {13, 200}, {14, 249}, {15, 214}, {13171158, 150}, {13171159, 172}, {13171160, 222}, {13171161, 82}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEP_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEP.w (d16, A2), D2 050a",
			init: cpuState{
				D:   [8]uint32{3900302818, 2506507470, 3822282754, 2339417319, 1891721485, 405460408, 547950994, 3291501729},
				A:   [7]uint32{1344045938, 1036996011, 1836282350, 2517245756, 589922482, 1154093737, 3280878085},
				PC:  5570452,
				SR:  8213,
				USP: 1870710,
				SSP: 15185858,
				RAM: [][2]uint32{{5570448, 5}, {5570449, 10}, {5570450, 188}, {5570451, 90}, {5570452, 171}, {5570453, 22}, {7548488, 124}, {7548489, 136}, {7548490, 2}, {7548491, 58}, {5570454, 127}, {5570455, 159}},
			},
			want: cpuState{
				D:   [8]uint32{3900302818, 2506507470, 3822287874, 2339417319, 1891721485, 405460408, 547950994, 3291501729},
				A:   [7]uint32{1344045938, 1036996011, 1836282350, 2517245756, 589922482, 1154093737, 3280878085},
				PC:  5570456,
				SR:  8213,
				USP: 1870710,
				SSP: 15185858,
				RAM: [][2]uint32{{5570448, 5}, {5570449, 10}, {5570450, 188}, {5570451, 90}, {5570452, 171}, {5570453, 22}, {7548488, 124}, {7548489, 136}, {7548490, 2}, {7548491, 58}, {5570454, 127}, {5570455, 159}},
			},
		},
		{
			name: "500 MOVEP.w (d16, A3), D5 0b0b",
			init: cpuState{
				D:   [8]uint32{2432016703, 3236054546, 977745481, 267390929, 116818340, 1546028756, 128449995, 970391108},
				A:   [7]uint32{1284988150, 943727426, 2500683404, 4151629919, 1379736348, 3584057021, 2397562938},
				PC:  7504588,
				SR:  33539,
				USP: 11126482,
				SSP: 2692946,
				RAM: [][2]uint32{{7504584, 11}, {7504585, 11}, {7504586, 81}, {7504587, 232}, {7504588, 5}, {7504589, 90}, {7678534, 135}, {7678535, 110}, {7678536, 94}, {7678537, 250}, {7504590, 153}, {7504591, 43}},
			},
			want: cpuState{
				D:   [8]uint32{2432016703, 3236054546, 977745481, 267390929, 116818340, 1546022650, 128449995, 970391108},
				A:   [7]uint32{1284988150, 943727426, 2500683404, 4151629919, 1379736348, 3584057021, 2397562938},
				PC:  7504592,
				SR:  33539,
				USP: 11126482,
				SSP: 2692946,
				RAM: [][2]uint32{{7504584, 11}, {7504585, 11}, {7504586, 81}, {7504587, 232}, {7504588, 5}, {7504589, 90}, {7678534, 135}, {7678535, 110}, {7678536, 94}, {7678537, 250}, {7504590, 153}, {7504591, 43}},
			},
		},
		{
			name: "1000 MOVEP.w D0, (d16, A4) 018c",
			init: cpuState{
				D:   [8]uint32{2808438177, 1654932256, 2301644383, 2327506045, 1882645979, 2048820558, 1490884466, 801356440},
				A:   [7]uint32{3205839532, 1267096606, 2401789773, 3565152284, 1368254037, 1851345834, 2892625356},
				PC:  4853598,
				SR:  8458,
				USP: 15124986,
				SSP: 6370730,
				RAM: [][2]uint32{{4853594, 1}, {4853595, 140}, {4853596, 98}, {4853597, 228}, {4853598, 103}, {4853599, 34}, {4853600, 226}, {4853601, 68}},
			},
			want: cpuState{
				D:   [8]uint32{2808438177, 1654932256, 2301644383, 2327506045, 1882645979, 2048820558, 1490884466, 801356440},
				A:   [7]uint32{3205839532, 1267096606, 2401789773, 3565152284, 1368254037, 1851345834, 2892625356},
				PC:  4853602,
				SR:  8458,
				USP: 15124986,
				SSP: 6370730,
				RAM: [][2]uint32{{4853594, 1}, {4853595, 140}, {4853596, 98}, {4853597, 228}, {4853598, 103}, {4853599, 34}, {9324856, 0}, {9324857, 93}, {9324858, 0}, {9324859, 161}, {4853600, 226}, {4853601, 68}},
			},
		},
		{
			name: "1500 MOVEP.w (d16, A1), D1 0309",
			init: cpuState{
				D:   [8]uint32{2055612598, 350988692, 2665539920, 2498511449, 3510690654, 3936124279, 1022677455, 857133729},
				A:   [7]uint32{3981915537, 4241969987, 1674760367, 1207756126, 3320151892, 3576069123, 580710262},
				PC:  9586802,
				SR:  8983,
				USP: 13763918,
				SSP: 2291240,
				RAM: [][2]uint32{{9586798, 3}, {9586799, 9}, {9586800, 53}, {9586801, 8}, {9586802, 191}, {9586803, 42}, {14125130, 26}, {14125131, 144}, {14125132, 22}, {14125133, 205}, {9586804, 107}, {9586805, 129}},
			},
			want: cpuState{
				D:   [8]uint32{2055612598, 350982349, 2665539920, 2498511449, 3510690654, 3936124279, 1022677455, 857133729},
				A:   [7]uint32{3981915537, 4241969987, 1674760367, 1207756126, 3320151892, 3576069123, 580710262},
				PC:  9586806,
				SR:  8983,
				USP: 13763918,
				SSP: 2291240,
				RAM: [][2]uint32{{9586798, 3}, {9586799, 9}, {9586800, 53}, {9586801, 8}, {9586802, 191}, {9586803, 42}, {14125130, 26}, {14125131, 144}, {14125132, 22}, {14125133, 205}, {9586804, 107}, {9586805, 129}},
			},
		},
		{
			name: "2000 MOVEP.w (d16, A7), D1 030f",
			init: cpuState{
				D:   [8]uint32{3891869880, 99343349, 4173362018, 303327462, 444489645, 3378678658, 4027723404, 273019276},
				A:   [7]uint32{691398999, 1825028604, 1507855372, 3159473342, 3255636697, 636965973, 1880347524},
				PC:  10206748,
				SR:  1035,
				USP: 11788356,
				SSP: 2738350,
				RAM: [][2]uint32{{10206744, 3}, {10206745, 15}, {10206746, 216}, {10206747, 184}, {10206748, 124}, {10206749, 9}, {11778300, 120}, {11778301, 59}, {11778302, 172}, {11778303, 83}, {10206750, 56}, {10206751, 105}},
			},
			want: cpuState{
				D:   [8]uint32{3891869880, 99317932, 4173362018, 303327462, 444489645, 3378678658, 4027723404, 273019276},
				A:   [7]uint32{691398999, 1825028604, 1507855372, 3159473342, 3255636697, 636965973, 1880347524},
				PC:  10206752,
				SR:  1035,
				USP: 11788356,
				SSP: 2738350,
				RAM: [][2]uint32{{10206744, 3}, {10206745, 15}, {10206746, 216}, {10206747, 184}, {10206748, 124}, {10206749, 9}, {11778300, 120}, {11778301, 59}, {11778302, 172}, {11778303, 83}, {10206750, 56}, {10206751, 105}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEP_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEP.l (d16, A2), D0 014a",
			init: cpuState{
				D:   [8]uint32{2979505002, 209276630, 2001096722, 3408373850, 343098753, 84110221, 3624173144, 3551189731},
				A:   [7]uint32{2517387372, 1566803654, 358036465, 1400719130, 3361016488, 16268715, 66787001},
				PC:  1743766,
				SR:  8454,
				USP: 14019698,
				SSP: 238224,
				RAM: [][2]uint32{{1743762, 1}, {1743763, 74}, {1743764, 242}, {1743765, 164}, {1743766, 222}, {1743767, 53}, {5711508, 89}, {5711509, 168}, {5711510, 253}, {5711511, 79}, {5711512, 200}, {5711513, 252}, {5711514, 42}, {5711515, 188}, {1743768, 40}, {1743769, 205}},
			},
			want: cpuState{
				D:   [8]uint32{2823814332, 209276630, 2001096722, 3408373850, 343098753, 84110221, 3624173144, 3551189731},
				A:   [7]uint32{2517387372, 1566803654, 358036465, 1400719130, 3361016488, 16268715, 66787001},
				PC:  1743770,
				SR:  8454,
				USP: 14019698,
				SSP: 238224,
				RAM: [][2]uint32{{1743762, 1}, {1743763, 74}, {1743764, 242}, {1743765, 164}, {1743766, 222}, {1743767, 53}, {5711508, 89}, {5711509, 168}, {5711510, 253}, {5711511, 79}, {5711512, 200}, {5711513, 252}, {5711514, 42}, {5711515, 188}, {1743768, 40}, {1743769, 205}},
			},
		},
		{
			name: "500 MOVEP.l D7, (d16, A7) 0fcf",
			init: cpuState{
				D:   [8]uint32{2178325792, 3820349588, 1549174006, 22366440, 4069873815, 903000504, 3872411633, 2462528191},
				A:   [7]uint32{3829791165, 433049016, 4093462546, 3542397050, 4008168921, 2811599116, 3234984083},
				PC:  13891552,
				SR:  42760,
				USP: 2009830,
				SSP: 6357568,
				RAM: [][2]uint32{{13891548, 15}, {13891549, 207}, {13891550, 102}, {13891551, 186}, {13891552, 6}, {13891553, 148}, {13891554, 213}, {13891555, 2}},
			},
			want: cpuState{
				D:   [8]uint32{2178325792, 3820349588, 1549174006, 22366440, 4069873815, 903000504, 3872411633, 2462528191},
				A:   [7]uint32{3829791165, 433049016, 4093462546, 3542397050, 4008168921, 2811599116, 3234984083},
				PC:  13891556,
				SR:  42760,
				USP: 2009830,
				SSP: 6357568,
				RAM: [][2]uint32{{13891548, 15}, {13891549, 207}, {13891550, 102}, {13891551, 186}, {13891552, 6}, {13891553, 148}, {6383866, 146}, {6383867, 0}, {6383868, 199}, {6383869, 0}, {6383870, 50}, {6383871, 0}, {6383872, 191}, {6383873, 0}, {13891554, 213}, {13891555, 2}},
			},
		},
		{
			name: "1000 MOVEP.l (d16, A3), D7 0f4b",
			init: cpuState{
				D:   [8]uint32{181649706, 1556330894, 1209281153, 966176502, 3258269094, 1499178588, 2514617987, 2134843533},
				A:   [7]uint32{4022784991, 3226316060, 307662660, 3058412433, 567047742, 4126437274, 1282492117},
				PC:  8214604,
				SR:  539,
				USP: 439976,
				SSP: 14736328,
				RAM: [][2]uint32{{8214600, 15}, {8214601, 75}, {8214602, 11}, {8214603, 71}, {8214604, 141}, {8214605, 12}, {4962008, 7}, {4962009, 147}, {4962010, 83}, {4962011, 191}, {4962012, 8}, {4962013, 34}, {4962014, 126}, {4962015, 249}, {8214606, 76}, {8214607, 65}},
			},
			want: cpuState{
				D:   [8]uint32{181649706, 1556330894, 1209281153, 966176502, 3258269094, 1499178588, 2514617987, 122882174},
				A:   [7]uint32{4022784991, 3226316060, 307662660, 3058412433, 567047742, 4126437274, 1282492117},
				PC:  8214608,
				SR:  539,
				USP: 439976,
				SSP: 14736328,
				RAM: [][2]uint32{{8214600, 15}, {8214601, 75}, {8214602, 11}, {8214603, 71}, {8214604, 141}, {8214605, 12}, {4962008, 7}, {4962009, 147}, {4962010, 83}, {4962011, 191}, {4962012, 8}, {4962013, 34}, {4962014, 126}, {4962015, 249}, {8214606, 76}, {8214607, 65}},
			},
		},
		{
			name: "1500 MOVEP.l D1, (d16, A5) 03cd",
			init: cpuState{
				D:   [8]uint32{4235050599, 2335963197, 1162917682, 2116788043, 825373824, 2732341304, 3494177588, 1424381000},
				A:   [7]uint32{354848135, 1435205961, 2029701113, 1152094514, 1022307975, 295552045, 2974376612},
				PC:  11979286,
				SR:  1051,
				USP: 10008830,
				SSP: 12286856,
				RAM: [][2]uint32{{11979282, 3}, {11979283, 205}, {11979284, 102}, {11979285, 92}, {11979286, 88}, {11979287, 181}, {11979288, 30}, {11979289, 155}},
			},
			want: cpuState{
				D:   [8]uint32{4235050599, 2335963197, 1162917682, 2116788043, 825373824, 2732341304, 3494177588, 1424381000},
				A:   [7]uint32{354848135, 1435205961, 2029701113, 1152094514, 1022307975, 295552045, 2974376612},
				PC:  11979290,
				SR:  1051,
				USP: 10008830,
				SSP: 12286856,
				RAM: [][2]uint32{{11979282, 3}, {11979283, 205}, {11979284, 102}, {11979285, 92}, {11979286, 88}, {11979287, 181}, {10365576, 0}, {10365577, 139}, {10365578, 0}, {10365579, 59}, {10365580, 0}, {10365581, 248}, {10365582, 0}, {10365583, 61}, {11979288, 30}, {11979289, 155}},
			},
		},
		{
			name: "2000 MOVEP.l D4, (d16, A4) 09cc",
			init: cpuState{
				D:   [8]uint32{88835063, 3571242109, 3005440447, 787321317, 726220596, 2549276370, 2823614118, 1509090745},
				A:   [7]uint32{318435081, 3641451747, 1621266865, 2121066610, 1092268327, 991024016, 386781852},
				PC:  7453378,
				SR:  9752,
				USP: 229486,
				SSP: 8591596,
				RAM: [][2]uint32{{7453374, 9}, {7453375, 204}, {7453376, 104}, {7453377, 208}, {7453378, 183}, {7453379, 201}, {7453380, 197}, {7453381, 79}},
			},
			want: cpuState{
				D:   [8]uint32{88835063, 3571242109, 3005440447, 787321317, 726220596, 2549276370, 2823614118, 1509090745},
				A:   [7]uint32{318435081, 3641451747, 1621266865, 2121066610, 1092268327, 991024016, 386781852},
				PC:  7453382,
				SR:  9752,
				USP: 229486,
				SSP: 8591596,
				RAM: [][2]uint32{{7453374, 9}, {7453375, 204}, {7453376, 104}, {7453377, 208}, {7453378, 183}, {7453379, 201}, {1776118, 0}, {1776119, 43}, {1776120, 0}, {1776121, 73}, {1776122, 0}, {1776123, 63}, {1776124, 0}, {1776125, 52}, {7453380, 197}, {7453381, 79}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEXG(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EXG D7, A7 cf8f",
			init: cpuState{
				D:   [8]uint32{1888175508, 3108803468, 219895122, 4195215335, 3449135861, 1008144086, 508757964, 3028813163},
				A:   [7]uint32{2141151280, 3533111880, 28917785, 3522979631, 556247249, 3812665290, 3243570130},
				PC:  150610,
				SR:  33821,
				USP: 1243398,
				SSP: 9177636,
				RAM: [][2]uint32{{150606, 207}, {150607, 143}, {150608, 15}, {150609, 222}, {150610, 65}, {150611, 49}},
			},
			want: cpuState{
				D:   [8]uint32{1888175508, 3108803468, 219895122, 4195215335, 3449135861, 1008144086, 508757964, 1243398},
				A:   [7]uint32{2141151280, 3533111880, 28917785, 3522979631, 556247249, 3812665290, 3243570130},
				PC:  150612,
				SR:  33821,
				USP: 3028813163,
				SSP: 9177636,
				RAM: [][2]uint32{{150606, 207}, {150607, 143}, {150608, 15}, {150609, 222}, {150610, 65}, {150611, 49}},
			},
		},
		{
			name: "500 EXG D1, D3 c343",
			init: cpuState{
				D:   [8]uint32{3171469755, 1177836952, 2594920178, 4037876690, 1650046882, 2278091015, 4090583427, 1030633944},
				A:   [7]uint32{1657710008, 2378969233, 1303918343, 3396689983, 231170386, 381197826, 4058117224},
				PC:  15289636,
				SR:  14,
				USP: 9820980,
				SSP: 2327980,
				RAM: [][2]uint32{{15289632, 195}, {15289633, 67}, {15289634, 160}, {15289635, 201}, {15289636, 11}, {15289637, 25}},
			},
			want: cpuState{
				D:   [8]uint32{3171469755, 4037876690, 2594920178, 1177836952, 1650046882, 2278091015, 4090583427, 1030633944},
				A:   [7]uint32{1657710008, 2378969233, 1303918343, 3396689983, 231170386, 381197826, 4058117224},
				PC:  15289638,
				SR:  14,
				USP: 9820980,
				SSP: 2327980,
				RAM: [][2]uint32{{15289632, 195}, {15289633, 67}, {15289634, 160}, {15289635, 201}, {15289636, 11}, {15289637, 25}},
			},
		},
		{
			name: "1000 EXG D6, D0 cd40",
			init: cpuState{
				D:   [8]uint32{1090796337, 1337748120, 2407918376, 4079234292, 2601839893, 2830070862, 1026964474, 3584828778},
				A:   [7]uint32{3490168468, 3169671599, 798452632, 362283221, 615694868, 3688066632, 107113425},
				PC:  7811920,
				SR:  34067,
				USP: 9507868,
				SSP: 15853378,
				RAM: [][2]uint32{{7811916, 205}, {7811917, 64}, {7811918, 165}, {7811919, 151}, {7811920, 113}, {7811921, 40}},
			},
			want: cpuState{
				D:   [8]uint32{1026964474, 1337748120, 2407918376, 4079234292, 2601839893, 2830070862, 1090796337, 3584828778},
				A:   [7]uint32{3490168468, 3169671599, 798452632, 362283221, 615694868, 3688066632, 107113425},
				PC:  7811922,
				SR:  34067,
				USP: 9507868,
				SSP: 15853378,
				RAM: [][2]uint32{{7811916, 205}, {7811917, 64}, {7811918, 165}, {7811919, 151}, {7811920, 113}, {7811921, 40}},
			},
		},
		{
			name: "1500 EXG D2, D3 c543",
			init: cpuState{
				D:   [8]uint32{2248561383, 326557272, 3661997149, 318528230, 1836663462, 3379723510, 1755324543, 643350138},
				A:   [7]uint32{4049852996, 43782880, 1734132742, 1831595101, 15492424, 850485980, 1868524802},
				PC:  8247774,
				SR:  1047,
				USP: 2947502,
				SSP: 15890074,
				RAM: [][2]uint32{{8247770, 197}, {8247771, 67}, {8247772, 101}, {8247773, 45}, {8247774, 68}, {8247775, 6}},
			},
			want: cpuState{
				D:   [8]uint32{2248561383, 326557272, 318528230, 3661997149, 1836663462, 3379723510, 1755324543, 643350138},
				A:   [7]uint32{4049852996, 43782880, 1734132742, 1831595101, 15492424, 850485980, 1868524802},
				PC:  8247776,
				SR:  1047,
				USP: 2947502,
				SSP: 15890074,
				RAM: [][2]uint32{{8247770, 197}, {8247771, 67}, {8247772, 101}, {8247773, 45}, {8247774, 68}, {8247775, 6}},
			},
		},
		{
			name: "2000 EXG D7, A4 cf8c",
			init: cpuState{
				D:   [8]uint32{1393951938, 2267720537, 1631248667, 32474115, 3937583195, 3578396058, 1753107487, 1652031761},
				A:   [7]uint32{2868558310, 1997460210, 1467480678, 615747392, 1096867009, 3036804865, 1674428331},
				PC:  317480,
				SR:  8193,
				USP: 20948,
				SSP: 6057004,
				RAM: [][2]uint32{{317476, 207}, {317477, 140}, {317478, 142}, {317479, 232}, {317480, 112}, {317481, 215}},
			},
			want: cpuState{
				D:   [8]uint32{1393951938, 2267720537, 1631248667, 32474115, 3937583195, 3578396058, 1753107487, 1096867009},
				A:   [7]uint32{2868558310, 1997460210, 1467480678, 615747392, 1652031761, 3036804865, 1674428331},
				PC:  317482,
				SR:  8193,
				USP: 20948,
				SSP: 6057004,
				RAM: [][2]uint32{{317476, 207}, {317477, 140}, {317478, 142}, {317479, 232}, {317480, 112}, {317481, 215}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSWAP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SWAP D3 4843",
			init: cpuState{
				D:   [8]uint32{1510753054, 4071567957, 3839256128, 1926237086, 89012861, 2466081603, 1103358500, 3344103847},
				A:   [7]uint32{3298303314, 1066111233, 3272664423, 3745714625, 1929345019, 2064452560, 1567622384},
				PC:  1727030,
				SR:  40969,
				USP: 5955164,
				SSP: 12514624,
				RAM: [][2]uint32{{1727026, 72}, {1727027, 67}, {1727028, 65}, {1727029, 173}, {1727030, 65}, {1727031, 109}},
			},
			want: cpuState{
				D:   [8]uint32{1510753054, 4071567957, 3839256128, 194933456, 89012861, 2466081603, 1103358500, 3344103847},
				A:   [7]uint32{3298303314, 1066111233, 3272664423, 3745714625, 1929345019, 2064452560, 1567622384},
				PC:  1727032,
				SR:  40960,
				USP: 5955164,
				SSP: 12514624,
				RAM: [][2]uint32{{1727026, 72}, {1727027, 67}, {1727028, 65}, {1727029, 173}, {1727030, 65}, {1727031, 109}},
			},
		},
		{
			name: "500 SWAP D0 4840",
			init: cpuState{
				D:   [8]uint32{3176670268, 3264999578, 3491863735, 1281144200, 1150138852, 3056983076, 73458247, 2509658397},
				A:   [7]uint32{763593502, 3241901684, 4164478152, 3357650853, 719767983, 2530061468, 1728560548},
				PC:  585184,
				SR:  41757,
				USP: 12552852,
				SSP: 4751156,
				RAM: [][2]uint32{{585180, 72}, {585181, 64}, {585182, 251}, {585183, 247}, {585184, 43}, {585185, 70}},
			},
			want: cpuState{
				D:   [8]uint32{607960408, 3264999578, 3491863735, 1281144200, 1150138852, 3056983076, 73458247, 2509658397},
				A:   [7]uint32{763593502, 3241901684, 4164478152, 3357650853, 719767983, 2530061468, 1728560548},
				PC:  585186,
				SR:  41744,
				USP: 12552852,
				SSP: 4751156,
				RAM: [][2]uint32{{585180, 72}, {585181, 64}, {585182, 251}, {585183, 247}, {585184, 43}, {585185, 70}},
			},
		},
		{
			name: "1000 SWAP D4 4844",
			init: cpuState{
				D:   [8]uint32{377874047, 3212870073, 3697558136, 58389050, 2707623180, 3025811063, 797660070, 2926897917},
				A:   [7]uint32{76292194, 2594198078, 4113855672, 2480821417, 4260527888, 3535776501, 1724895864},
				PC:  15341182,
				SR:  8723,
				USP: 12890034,
				SSP: 4232464,
				RAM: [][2]uint32{{15341178, 72}, {15341179, 68}, {15341180, 185}, {15341181, 162}, {15341182, 214}, {15341183, 246}},
			},
			want: cpuState{
				D:   [8]uint32{377874047, 3212870073, 3697558136, 58389050, 218931555, 3025811063, 797660070, 2926897917},
				A:   [7]uint32{76292194, 2594198078, 4113855672, 2480821417, 4260527888, 3535776501, 1724895864},
				PC:  15341184,
				SR:  8720,
				USP: 12890034,
				SSP: 4232464,
				RAM: [][2]uint32{{15341178, 72}, {15341179, 68}, {15341180, 185}, {15341181, 162}, {15341182, 214}, {15341183, 246}},
			},
		},
		{
			name: "1500 SWAP D4 4844",
			init: cpuState{
				D:   [8]uint32{2024044825, 3166764157, 3131407536, 2985040659, 1756272378, 3426217085, 718366934, 4164911136},
				A:   [7]uint32{1674021232, 1629719225, 3927246817, 3171387845, 850256298, 2329110938, 4167302230},
				PC:  5541192,
				SR:  1055,
				USP: 13904520,
				SSP: 11046526,
				RAM: [][2]uint32{{5541188, 72}, {5541189, 68}, {5541190, 175}, {5541191, 245}, {5541192, 94}, {5541193, 110}},
			},
			want: cpuState{
				D:   [8]uint32{2024044825, 3166764157, 3131407536, 2985040659, 2532993198, 3426217085, 718366934, 4164911136},
				A:   [7]uint32{1674021232, 1629719225, 3927246817, 3171387845, 850256298, 2329110938, 4167302230},
				PC:  5541194,
				SR:  1048,
				USP: 13904520,
				SSP: 11046526,
				RAM: [][2]uint32{{5541188, 72}, {5541189, 68}, {5541190, 175}, {5541191, 245}, {5541192, 94}, {5541193, 110}},
			},
		},
		{
			name: "2000 SWAP D1 4841",
			init: cpuState{
				D:   [8]uint32{2656208468, 2512136854, 1357876383, 2920909607, 1661268483, 1201124089, 2971900572, 2546343273},
				A:   [7]uint32{4023638979, 168363960, 143360008, 2826816427, 1951383120, 1446164030, 2916916252},
				PC:  3547906,
				SR:  42515,
				USP: 7982224,
				SSP: 7714018,
				RAM: [][2]uint32{{3547902, 72}, {3547903, 65}, {3547904, 229}, {3547905, 93}, {3547906, 82}, {3547907, 39}},
			},
			want: cpuState{
				D:   [8]uint32{2656208468, 714511804, 1357876383, 2920909607, 1661268483, 1201124089, 2971900572, 2546343273},
				A:   [7]uint32{4023638979, 168363960, 143360008, 2826816427, 1951383120, 1446164030, 2916916252},
				PC:  3547908,
				SR:  42512,
				USP: 7982224,
				SSP: 7714018,
				RAM: [][2]uint32{{3547902, 72}, {3547903, 65}, {3547904, 229}, {3547905, 93}, {3547906, 82}, {3547907, 39}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLEA(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LEA (d8, A2, Xn), A0 41f2",
			init: cpuState{
				D:   [8]uint32{1505407771, 985271522, 1757726332, 4087867143, 3252742810, 1667700006, 3239705729, 3518445659},
				A:   [7]uint32{1518484231, 1680481906, 165329863, 2690427623, 198583438, 267202675, 813101571},
				PC:  1090286,
				SR:  8986,
				USP: 6804120,
				SSP: 3311304,
				RAM: [][2]uint32{{1090282, 65}, {1090283, 242}, {1090284, 160}, {1090285, 168}, {1090286, 18}, {1090287, 52}, {1090288, 246}, {1090289, 55}},
			},
			want: cpuState{
				D:   [8]uint32{1505407771, 985271522, 1757726332, 4087867143, 3252742810, 1667700006, 3239705729, 3518445659},
				A:   [7]uint32{165312310, 1680481906, 165329863, 2690427623, 198583438, 267202675, 813101571},
				PC:  1090290,
				SR:  8986,
				USP: 6804120,
				SSP: 3311304,
				RAM: [][2]uint32{{1090282, 65}, {1090283, 242}, {1090284, 160}, {1090285, 168}, {1090286, 18}, {1090287, 52}, {1090288, 246}, {1090289, 55}},
			},
		},
		{
			name: "500 LEA (A0), A2 45d0",
			init: cpuState{
				D:   [8]uint32{2952225772, 1071931426, 2289585532, 1182253030, 3325500121, 207530515, 3358768930, 1259671681},
				A:   [7]uint32{1710373711, 3814125148, 2883798262, 99917380, 3357188714, 935904720, 2461378631},
				PC:  7730002,
				SR:  1812,
				USP: 2342052,
				SSP: 4487792,
				RAM: [][2]uint32{{7729998, 69}, {7729999, 208}, {7730000, 205}, {7730001, 221}, {7730002, 194}, {7730003, 98}},
			},
			want: cpuState{
				D:   [8]uint32{2952225772, 1071931426, 2289585532, 1182253030, 3325500121, 207530515, 3358768930, 1259671681},
				A:   [7]uint32{1710373711, 3814125148, 1710373711, 99917380, 3357188714, 935904720, 2461378631},
				PC:  7730004,
				SR:  1812,
				USP: 2342052,
				SSP: 4487792,
				RAM: [][2]uint32{{7729998, 69}, {7729999, 208}, {7730000, 205}, {7730001, 221}, {7730002, 194}, {7730003, 98}},
			},
		},
		{
			name: "1000 LEA (A1), A6 4dd1",
			init: cpuState{
				D:   [8]uint32{3355968784, 1762318575, 4139819870, 2083015945, 350107125, 1548590728, 4116227354, 3431532069},
				A:   [7]uint32{2117442842, 56881225, 738109646, 3590755733, 546603999, 3974135264, 1660790552},
				PC:  10693554,
				SR:  33290,
				USP: 7396692,
				SSP: 9156232,
				RAM: [][2]uint32{{10693550, 77}, {10693551, 209}, {10693552, 247}, {10693553, 196}, {10693554, 72}, {10693555, 21}},
			},
			want: cpuState{
				D:   [8]uint32{3355968784, 1762318575, 4139819870, 2083015945, 350107125, 1548590728, 4116227354, 3431532069},
				A:   [7]uint32{2117442842, 56881225, 738109646, 3590755733, 546603999, 3974135264, 56881225},
				PC:  10693556,
				SR:  33290,
				USP: 7396692,
				SSP: 9156232,
				RAM: [][2]uint32{{10693550, 77}, {10693551, 209}, {10693552, 247}, {10693553, 196}, {10693554, 72}, {10693555, 21}},
			},
		},
		{
			name: "1500 LEA (d8, A2, Xn), A2 45f2",
			init: cpuState{
				D:   [8]uint32{3217801032, 1312059297, 3536825566, 2883328887, 1080090064, 1524216789, 388730624, 2273413506},
				A:   [7]uint32{996849844, 2818195364, 3336237362, 1529349971, 1934544521, 3349519099, 3948924854},
				PC:  115546,
				SR:  9237,
				USP: 2056190,
				SSP: 6928442,
				RAM: [][2]uint32{{115542, 69}, {115543, 242}, {115544, 38}, {115545, 229}, {115546, 241}, {115547, 91}, {115548, 143}, {115549, 107}},
			},
			want: cpuState{
				D:   [8]uint32{3217801032, 1312059297, 3536825566, 2883328887, 1080090064, 1524216789, 388730624, 2273413506},
				A:   [7]uint32{996849844, 2818195364, 3336216053, 1529349971, 1934544521, 3349519099, 3948924854},
				PC:  115550,
				SR:  9237,
				USP: 2056190,
				SSP: 6928442,
				RAM: [][2]uint32{{115542, 69}, {115543, 242}, {115544, 38}, {115545, 229}, {115546, 241}, {115547, 91}, {115548, 143}, {115549, 107}},
			},
		},
		{
			name: "2000 LEA (A6), A1 43d6",
			init: cpuState{
				D:   [8]uint32{4139147698, 2510287140, 2149168670, 1108415037, 604238296, 1669533574, 3202321748, 4126410644},
				A:   [7]uint32{2218653312, 2103169871, 2377181520, 4024258248, 4283818546, 3397836952, 2535708072},
				PC:  2973196,
				SR:  33296,
				USP: 3753584,
				SSP: 3264714,
				RAM: [][2]uint32{{2973192, 67}, {2973193, 214}, {2973194, 104}, {2973195, 224}, {2973196, 190}, {2973197, 235}},
			},
			want: cpuState{
				D:   [8]uint32{4139147698, 2510287140, 2149168670, 1108415037, 604238296, 1669533574, 3202321748, 4126410644},
				A:   [7]uint32{2218653312, 2535708072, 2377181520, 4024258248, 4283818546, 3397836952, 2535708072},
				PC:  2973198,
				SR:  33296,
				USP: 3753584,
				SSP: 3264714,
				RAM: [][2]uint32{{2973192, 67}, {2973193, 214}, {2973194, 104}, {2973195, 224}, {2973196, 190}, {2973197, 235}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestPEA(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 PEA (d8, A5, Xn) 4875",
			init: cpuState{
				D:   [8]uint32{865422286, 968813949, 2721818445, 2141489019, 3373891870, 2202925245, 924941020, 3937274480},
				A:   [7]uint32{4011833265, 4130108710, 3872153481, 130708056, 3294091709, 1251249274, 3501493919},
				PC:  9642054,
				SR:  40976,
				USP: 59218,
				SSP: 7406244,
				RAM: [][2]uint32{{9642050, 72}, {9642051, 117}, {9642052, 94}, {9642053, 94}, {9642054, 210}, {9642055, 68}, {9642056, 44}, {9642057, 231}},
			},
			want: cpuState{
				D:   [8]uint32{865422286, 968813949, 2721818445, 2141489019, 3373891870, 2202925245, 924941020, 3937274480},
				A:   [7]uint32{4011833265, 4130108710, 3872153481, 130708056, 3294091709, 1251249274, 3501493919},
				PC:  9642058,
				SR:  40976,
				USP: 59218,
				SSP: 7406240,
				RAM: [][2]uint32{{9642050, 72}, {9642051, 117}, {9642052, 94}, {9642053, 94}, {9642054, 210}, {9642055, 68}, {9642056, 44}, {9642057, 231}, {7406240, 205}, {7406241, 226}, {7406242, 133}, {7406243, 149}},
			},
		},
		{
			name: "500 PEA (d16, A6) 486e",
			init: cpuState{
				D:   [8]uint32{2296569189, 2528915686, 235642819, 2290463059, 1316480169, 3724715940, 4162638519, 824586476},
				A:   [7]uint32{1559678604, 3348491145, 368545358, 3293381638, 4015104221, 711618274, 1139570139},
				PC:  12405144,
				SR:  32774,
				USP: 6216734,
				SSP: 11917798,
				RAM: [][2]uint32{{12405140, 72}, {12405141, 110}, {12405142, 56}, {12405143, 60}, {12405144, 67}, {12405145, 43}, {12405146, 25}, {12405147, 60}},
			},
			want: cpuState{
				D:   [8]uint32{2296569189, 2528915686, 235642819, 2290463059, 1316480169, 3724715940, 4162638519, 824586476},
				A:   [7]uint32{1559678604, 3348491145, 368545358, 3293381638, 4015104221, 711618274, 1139570139},
				PC:  12405148,
				SR:  32774,
				USP: 6216730,
				SSP: 11917798,
				RAM: [][2]uint32{{12405140, 72}, {12405141, 110}, {12405142, 56}, {12405143, 60}, {12405144, 67}, {12405145, 43}, {12405146, 25}, {12405147, 60}, {6216730, 67}, {6216731, 236}, {6216732, 174}, {6216733, 23}},
			},
		},
		{
			name: "1000 PEA (A6) 4856",
			init: cpuState{
				D:   [8]uint32{1657715744, 2138912365, 1230511755, 902563391, 3175369890, 3223255929, 3871914769, 2083501809},
				A:   [7]uint32{2388162456, 1474252684, 482040733, 3119316955, 1142549739, 1932205196, 2814763138},
				PC:  15872052,
				SR:  1052,
				USP: 2652400,
				SSP: 983380,
				RAM: [][2]uint32{{15872048, 72}, {15872049, 86}, {15872050, 181}, {15872051, 26}, {15872052, 31}, {15872053, 97}},
			},
			want: cpuState{
				D:   [8]uint32{1657715744, 2138912365, 1230511755, 902563391, 3175369890, 3223255929, 3871914769, 2083501809},
				A:   [7]uint32{2388162456, 1474252684, 482040733, 3119316955, 1142549739, 1932205196, 2814763138},
				PC:  15872054,
				SR:  1052,
				USP: 2652396,
				SSP: 983380,
				RAM: [][2]uint32{{15872048, 72}, {15872049, 86}, {15872050, 181}, {15872051, 26}, {15872052, 31}, {15872053, 97}, {2652396, 167}, {2652397, 197}, {2652398, 224}, {2652399, 130}},
			},
		},
		{
			name: "1500 PEA (d8, A2, Xn) 4872",
			init: cpuState{
				D:   [8]uint32{2754576608, 3333140619, 25752223, 2407048060, 1033454121, 2931619043, 1535111698, 3477477688},
				A:   [7]uint32{2111651585, 3064474738, 2272453687, 630940487, 2313838957, 3559562175, 2246036016},
				PC:  9348364,
				SR:  42509,
				USP: 14478666,
				SSP: 8867158,
				RAM: [][2]uint32{{9348360, 72}, {9348361, 114}, {9348362, 91}, {9348363, 223}, {9348364, 211}, {9348365, 171}, {9348366, 142}, {9348367, 118}},
			},
			want: cpuState{
				D:   [8]uint32{2754576608, 3333140619, 25752223, 2407048060, 1033454121, 2931619043, 1535111698, 3477477688},
				A:   [7]uint32{2111651585, 3064474738, 2272453687, 630940487, 2313838957, 3559562175, 2246036016},
				PC:  9348368,
				SR:  42509,
				USP: 14478666,
				SSP: 8867154,
				RAM: [][2]uint32{{9348360, 72}, {9348361, 114}, {9348362, 91}, {9348363, 223}, {9348364, 211}, {9348365, 171}, {9348366, 142}, {9348367, 118}, {8867154, 54}, {8867155, 47}, {8867156, 216}, {8867157, 249}},
			},
		},
		{
			name: "2000 PEA (d16, A2) 486a",
			init: cpuState{
				D:   [8]uint32{362449889, 3457364940, 3920594189, 2771909560, 3898788148, 3260478910, 2829587860, 1964048124},
				A:   [7]uint32{3727828338, 3184539925, 3901086640, 3502035085, 1292961376, 2109014691, 1036076106},
				PC:  12387596,
				SR:  41989,
				USP: 327194,
				SSP: 13934186,
				RAM: [][2]uint32{{12387592, 72}, {12387593, 106}, {12387594, 55}, {12387595, 120}, {12387596, 167}, {12387597, 33}, {12387598, 222}, {12387599, 143}},
			},
			want: cpuState{
				D:   [8]uint32{362449889, 3457364940, 3920594189, 2771909560, 3898788148, 3260478910, 2829587860, 1964048124},
				A:   [7]uint32{3727828338, 3184539925, 3901086640, 3502035085, 1292961376, 2109014691, 1036076106},
				PC:  12387600,
				SR:  41989,
				USP: 327194,
				SSP: 13934182,
				RAM: [][2]uint32{{12387592, 72}, {12387593, 106}, {12387594, 55}, {12387595, 120}, {12387596, 167}, {12387597, 33}, {12387598, 222}, {12387599, 143}, {13934182, 232}, {13934183, 134}, {13934184, 19}, {13934185, 40}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}
