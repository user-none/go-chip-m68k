package m68k

import "testing"

func TestADD_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ADD.b D3, (d16, A2) d72a",
			init: cpuState{
				D:   [8]uint32{3941987954, 2037397763, 1314175244, 4090795974, 2050183426, 2809892028, 3716267913, 1805417682},
				A:   [7]uint32{1266352929, 2143940923, 3504068078, 2124816477, 3083094888, 697352590, 3202848776},
				PC:  3328950,
				SR:  32786,
				USP: 11763420,
				SSP: 1362616,
				RAM: [][2]uint32{{3328946, 215}, {3328947, 42}, {3328948, 156}, {3328949, 188}, {3328950, 119}, {3328951, 179}, {14381738, 109}, {14381739, 240}, {3328952, 27}, {3328953, 10}},
			},
			want: cpuState{
				D:   [8]uint32{3941987954, 2037397763, 1314175244, 4090795974, 2050183426, 2809892028, 3716267913, 1805417682},
				A:   [7]uint32{1266352929, 2143940923, 3504068078, 2124816477, 3083094888, 697352590, 3202848776},
				PC:  3328954,
				SR:  32785,
				USP: 11763420,
				SSP: 1362616,
				RAM: [][2]uint32{{3328946, 215}, {3328947, 42}, {3328948, 156}, {3328949, 188}, {3328950, 119}, {3328951, 179}, {14381738, 51}, {14381739, 240}, {3328952, 27}, {3328953, 10}},
				Cycles: 16,
			},
		},
		{
			name: "500 ADD.b 4, (d16, A1) 5829",
			init: cpuState{
				D:   [8]uint32{4251128074, 455529726, 755189540, 2491783780, 3583604615, 2176046989, 917357912, 3352027911},
				A:   [7]uint32{1683649949, 1926168676, 457561248, 1170001361, 1233739421, 2968312619, 3732093732},
				PC:  3309678,
				SR:  41746,
				USP: 11113114,
				SSP: 4554102,
				RAM: [][2]uint32{{3309674, 88}, {3309675, 41}, {3309676, 125}, {3309677, 174}, {3309678, 169}, {3309679, 93}, {13598226, 27}, {13598227, 80}, {3309680, 38}, {3309681, 7}},
			},
			want: cpuState{
				D:   [8]uint32{4251128074, 455529726, 755189540, 2491783780, 3583604615, 2176046989, 917357912, 3352027911},
				A:   [7]uint32{1683649949, 1926168676, 457561248, 1170001361, 1233739421, 2968312619, 3732093732},
				PC:  3309682,
				SR:  41728,
				USP: 11113114,
				SSP: 4554102,
				RAM: [][2]uint32{{3309674, 88}, {3309675, 41}, {3309676, 125}, {3309677, 174}, {3309678, 169}, {3309679, 93}, {13598226, 31}, {13598227, 80}, {3309680, 38}, {3309681, 7}},
				Cycles: 16,
			},
		},
		{
			name: "1000 ADD.b -(A6), D4 d826",
			init: cpuState{
				D:   [8]uint32{2491314503, 2886725744, 1636192530, 1489192880, 1915967032, 4124964415, 468187637, 879686914},
				A:   [7]uint32{3301505292, 2852997734, 1339865613, 1811225264, 689451768, 868534933, 2880048985},
				PC:  1791162,
				SR:  42772,
				USP: 11881152,
				SSP: 3733090,
				RAM: [][2]uint32{{1791158, 216}, {1791159, 38}, {1791160, 64}, {1791161, 155}, {11145048, 79}, {11145049, 163}, {1791162, 77}, {1791163, 60}},
			},
			want: cpuState{
				D:   [8]uint32{2491314503, 2886725744, 1636192530, 1489192880, 1915967111, 4124964415, 468187637, 879686914},
				A:   [7]uint32{3301505292, 2852997734, 1339865613, 1811225264, 689451768, 868534933, 2880048984},
				PC:  1791164,
				SR:  42762,
				USP: 11881152,
				SSP: 3733090,
				RAM: [][2]uint32{{1791158, 216}, {1791159, 38}, {1791160, 64}, {1791161, 155}, {11145048, 79}, {11145049, 163}, {1791162, 77}, {1791163, 60}},
				Cycles: 10,
			},
		},
		{
			name: "1500 ADD.b D4, (d16, A5) d92d",
			init: cpuState{
				D:   [8]uint32{851131566, 852556397, 2031642083, 2745379360, 3358653554, 1551149807, 3333695399, 330177788},
				A:   [7]uint32{3755431392, 234785205, 4287286157, 2799525855, 4272636270, 1314989274, 600361140},
				PC:  5875692,
				SR:  1038,
				USP: 13776306,
				SSP: 4968940,
				RAM: [][2]uint32{{5875688, 217}, {5875689, 45}, {5875690, 29}, {5875691, 186}, {5875692, 38}, {5875693, 50}, {6374036, 162}, {6374037, 83}, {5875694, 136}, {5875695, 215}},
			},
			want: cpuState{
				D:   [8]uint32{851131566, 852556397, 2031642083, 2745379360, 3358653554, 1551149807, 3333695399, 330177788},
				A:   [7]uint32{3755431392, 234785205, 4287286157, 2799525855, 4272636270, 1314989274, 600361140},
				PC:  5875696,
				SR:  1041,
				USP: 13776306,
				SSP: 4968940,
				RAM: [][2]uint32{{5875688, 217}, {5875689, 45}, {5875690, 29}, {5875691, 186}, {5875692, 38}, {5875693, 50}, {6374036, 20}, {6374037, 83}, {5875694, 136}, {5875695, 215}},
				Cycles: 16,
			},
		},
		{
			name: "2000 ADD.b #, (A4) 0614",
			init: cpuState{
				D:   [8]uint32{1621186025, 2306956336, 2366813438, 1989103356, 3738049034, 1597603231, 1236431036, 1101930610},
				A:   [7]uint32{1061232993, 2256534653, 671275449, 4132154555, 2746374070, 2476035424, 2287647861},
				PC:  548322,
				SR:  33305,
				USP: 8705170,
				SSP: 16685368,
				RAM: [][2]uint32{{548318, 6}, {548319, 20}, {548320, 177}, {548321, 215}, {548322, 113}, {548323, 167}, {11687862, 218}, {11687863, 110}, {548324, 144}, {548325, 255}},
			},
			want: cpuState{
				D:   [8]uint32{1621186025, 2306956336, 2366813438, 1989103356, 3738049034, 1597603231, 1236431036, 1101930610},
				A:   [7]uint32{1061232993, 2256534653, 671275449, 4132154555, 2746374070, 2476035424, 2287647861},
				PC:  548326,
				SR:  33305,
				USP: 8705170,
				SSP: 16685368,
				RAM: [][2]uint32{{548318, 6}, {548319, 20}, {548320, 177}, {548321, 215}, {548322, 113}, {548323, 167}, {11687862, 177}, {11687863, 110}, {548324, 144}, {548325, 255}},
				Cycles: 16,
			},
		},
		{
			name: "001 ADD.b D1, (d8, A4, Xn) d334",
			init: 			cpuState{
				D:   [8]uint32{1658104401, 506768372, 3720289289, 146758799, 4281229592, 4068565046, 3274096306, 3950431744},
				A:   [7]uint32{1228003693, 2096096948, 1284599958, 1574972779, 580637244, 581172117, 2704473856},
				PC:  8151138,
				SR:  1289,
				USP: 1094016,
				SSP: 2993144,
				RAM: [][2]uint32{{8151134, 211}, {8151135, 52}, {8151136, 191}, {8151137, 228}, {8151138, 160}, {8151139, 95}, {8126346, 161}, {8126347, 135}, {8151140, 55}, {8151141, 66}},
			},
			want: 			cpuState{
				D:   [8]uint32{1658104401, 506768372, 3720289289, 146758799, 4281229592, 4068565046, 3274096306, 3950431744},
				A:   [7]uint32{1228003693, 2096096948, 1284599958, 1574972779, 580637244, 581172117, 2704473856},
				PC:  8151142,
				SR:  1299,
				USP: 1094016,
				SSP: 2993144,
				RAM: [][2]uint32{{8151134, 211}, {8151135, 52}, {8151136, 191}, {8151137, 228}, {8151138, 160}, {8151139, 95}, {8126346, 161}, {8126347, 123}, {8151140, 55}, {8151141, 66}},
				Cycles: 18,
			},
		},
		{
			name: "264 ADD.b 5, D0 5a00",
			init: 			cpuState{
				D:   [8]uint32{1332339217, 3207977502, 1529198657, 666856059, 3281390335, 524902094, 991103759, 862692336},
				A:   [7]uint32{4254231313, 273944780, 1326989925, 1082780017, 578738709, 3368017261, 1424928849},
				PC:  1381006,
				SR:  1287,
				USP: 4127406,
				SSP: 13115006,
				RAM: [][2]uint32{{1381002, 90}, {1381003, 0}, {1381004, 99}, {1381005, 13}, {1381006, 88}, {1381007, 206}},
			},
			want: 			cpuState{
				D:   [8]uint32{1332339222, 3207977502, 1529198657, 666856059, 3281390335, 524902094, 991103759, 862692336},
				A:   [7]uint32{4254231313, 273944780, 1326989925, 1082780017, 578738709, 3368017261, 1424928849},
				PC:  1381008,
				SR:  1280,
				USP: 4127406,
				SSP: 13115006,
				RAM: [][2]uint32{{1381002, 90}, {1381003, 0}, {1381004, 99}, {1381005, 13}, {1381006, 88}, {1381007, 206}},
				Cycles: 4,
			},
		},
		{
			name: "554 ADD.b D6, -(A2) dd22",
			init: 			cpuState{
				D:   [8]uint32{499757408, 3804878676, 1973742033, 738881141, 4043590223, 2006731104, 835683952, 3801718581},
				A:   [7]uint32{3040351514, 1078863264, 2960697861, 3691442304, 1175611539, 3642485119, 2788282537},
				PC:  15524162,
				SR:  8720,
				USP: 11179864,
				SSP: 6485108,
				RAM: [][2]uint32{{15524158, 221}, {15524159, 34}, {15524160, 145}, {15524161, 253}, {7907844, 216}, {7907845, 7}, {15524162, 5}, {15524163, 118}},
			},
			want: 			cpuState{
				D:   [8]uint32{499757408, 3804878676, 1973742033, 738881141, 4043590223, 2006731104, 835683952, 3801718581},
				A:   [7]uint32{3040351514, 1078863264, 2960697860, 3691442304, 1175611539, 3642485119, 2788282537},
				PC:  15524164,
				SR:  8721,
				USP: 11179864,
				SSP: 6485108,
				RAM: [][2]uint32{{15524158, 221}, {15524159, 34}, {15524160, 145}, {15524161, 253}, {7907844, 72}, {7907845, 7}, {15524162, 5}, {15524163, 118}},
				Cycles: 14,
			},
		},
		{
			name: "821 ADD.b 5, -(A4) 5a24",
			init: 			cpuState{
				D:   [8]uint32{1520599649, 1028451837, 3780295653, 64546181, 93713961, 46903799, 165011675, 359145250},
				A:   [7]uint32{3970988541, 3072270566, 2662004645, 2187101393, 2182750687, 874296596, 2093457451},
				PC:  5027214,
				SR:  1564,
				USP: 274670,
				SSP: 4063822,
				RAM: [][2]uint32{{5027210, 90}, {5027211, 36}, {5027212, 159}, {5027213, 156}, {1712606, 24}, {1712607, 32}, {5027214, 19}, {5027215, 78}},
			},
			want: 			cpuState{
				D:   [8]uint32{1520599649, 1028451837, 3780295653, 64546181, 93713961, 46903799, 165011675, 359145250},
				A:   [7]uint32{3970988541, 3072270566, 2662004645, 2187101393, 2182750686, 874296596, 2093457451},
				PC:  5027216,
				SR:  1536,
				USP: 274670,
				SSP: 4063822,
				RAM: [][2]uint32{{5027210, 90}, {5027211, 36}, {5027212, 159}, {5027213, 156}, {1712606, 29}, {1712607, 32}, {5027214, 19}, {5027215, 78}},
				Cycles: 14,
			},
		},
		{
			name: "1116 ADD.b (d8, A6, Xn), D3 d636",
			init: 			cpuState{
				D:   [8]uint32{1739279955, 145890029, 856597725, 3164937395, 2459844835, 3445385409, 4122344380, 2516938668},
				A:   [7]uint32{946682693, 1769749755, 3635558841, 1842591176, 2674542442, 803713402, 1751677859},
				PC:  519566,
				SR:  269,
				USP: 9806156,
				SSP: 9515870,
				RAM: [][2]uint32{{519562, 214}, {519563, 54}, {519564, 178}, {519565, 239}, {519566, 228}, {519567, 127}, {6828378, 33}, {6828379, 219}, {519568, 198}, {519569, 234}},
			},
			want: 			cpuState{
				D:   [8]uint32{1739279955, 145890029, 856597725, 3164937428, 2459844835, 3445385409, 4122344380, 2516938668},
				A:   [7]uint32{946682693, 1769749755, 3635558841, 1842591176, 2674542442, 803713402, 1751677859},
				PC:  519570,
				SR:  264,
				USP: 9806156,
				SSP: 9515870,
				RAM: [][2]uint32{{519562, 214}, {519563, 54}, {519564, 178}, {519565, 239}, {519566, 228}, {519567, 127}, {6828378, 33}, {6828379, 219}, {519568, 198}, {519569, 234}},
				Cycles: 14,
			},
		},
		{
			name: "1389 ADD.b (d8, A3, Xn), D2 d433",
			init: 			cpuState{
				D:   [8]uint32{1468033226, 1909147702, 3522245613, 1512759013, 1399053702, 513384095, 3137434089, 2534810723},
				A:   [7]uint32{2665194887, 2310868479, 3490936700, 1137045450, 3143221556, 1044173849, 4201579984},
				PC:  424904,
				SR:  1802,
				USP: 1604680,
				SSP: 15431642,
				RAM: [][2]uint32{{424900, 212}, {424901, 51}, {424902, 104}, {424903, 218}, {424904, 90}, {424905, 153}, {13066636, 65}, {13066637, 153}, {424906, 17}, {424907, 26}},
			},
			want: 			cpuState{
				D:   [8]uint32{1468033226, 1909147702, 3522245510, 1512759013, 1399053702, 513384095, 3137434089, 2534810723},
				A:   [7]uint32{2665194887, 2310868479, 3490936700, 1137045450, 3143221556, 1044173849, 4201579984},
				PC:  424908,
				SR:  1817,
				USP: 1604680,
				SSP: 15431642,
				RAM: [][2]uint32{{424900, 212}, {424901, 51}, {424902, 104}, {424903, 218}, {424904, 90}, {424905, 153}, {13066636, 65}, {13066637, 153}, {424906, 17}, {424907, 26}},
				Cycles: 14,
			},
		},
		{
			name: "1664 ADD.b (A6)+, D3 d61e",
			init: 			cpuState{
				D:   [8]uint32{2106325461, 715126365, 2059610570, 4245610320, 2741195705, 1451024963, 1964138478, 2161812244},
				A:   [7]uint32{3393802742, 2529564791, 3794527657, 2026461345, 3999542614, 2702185835, 1481869251},
				PC:  10999044,
				SR:  8731,
				USP: 13511982,
				SSP: 3456594,
				RAM: [][2]uint32{{10999040, 214}, {10999041, 30}, {10999042, 162}, {10999043, 235}, {5474242, 240}, {5474243, 101}, {10999044, 240}, {10999045, 81}},
			},
			want: 			cpuState{
				D:   [8]uint32{2106325461, 715126365, 2059610570, 4245610421, 2741195705, 1451024963, 1964138478, 2161812244},
				A:   [7]uint32{3393802742, 2529564791, 3794527657, 2026461345, 3999542614, 2702185835, 1481869252},
				PC:  10999046,
				SR:  8714,
				USP: 13511982,
				SSP: 3456594,
				RAM: [][2]uint32{{10999040, 214}, {10999041, 30}, {10999042, 162}, {10999043, 235}, {5474242, 240}, {5474243, 101}, {10999044, 240}, {10999045, 81}},
				Cycles: 8,
			},
		},
		{
			name: "1964 ADD.b D1, (d16, A3) d32b",
			init: 			cpuState{
				D:   [8]uint32{3934148777, 613985096, 3422573385, 971829662, 1838150963, 1879999137, 4263355980, 198572423},
				A:   [7]uint32{2990358974, 2247535558, 2317460820, 2829061106, 1350383224, 3776501887, 2300178889},
				PC:  8009162,
				SR:  9502,
				USP: 11675348,
				SSP: 2512000,
				RAM: [][2]uint32{{8009158, 211}, {8009159, 43}, {8009160, 254}, {8009161, 107}, {8009162, 42}, {8009163, 192}, {10488412, 186}, {10488413, 13}, {8009164, 25}, {8009165, 16}},
			},
			want: 			cpuState{
				D:   [8]uint32{3934148777, 613985096, 3422573385, 971829662, 1838150963, 1879999137, 4263355980, 198572423},
				A:   [7]uint32{2990358974, 2247535558, 2317460820, 2829061106, 1350383224, 3776501887, 2300178889},
				PC:  8009166,
				SR:  9472,
				USP: 11675348,
				SSP: 2512000,
				RAM: [][2]uint32{{8009158, 211}, {8009159, 43}, {8009160, 254}, {8009161, 107}, {8009162, 42}, {8009163, 192}, {10488412, 186}, {10488413, 85}, {8009164, 25}, {8009165, 16}},
				Cycles: 16,
			},
		},
		{
			name: "2238 ADD.b D0, -(A3) d123",
			init: 			cpuState{
				D:   [8]uint32{3085061329, 926992805, 1485120716, 34875024, 468288057, 3275363498, 3651149185, 531139669},
				A:   [7]uint32{2069391260, 688031867, 705813015, 2296670158, 354402994, 274558055, 2879001312},
				PC:  15381482,
				SR:  9730,
				USP: 16203106,
				SSP: 384092,
				RAM: [][2]uint32{{15381478, 209}, {15381479, 35}, {15381480, 160}, {15381481, 17}, {14968780, 49}, {14968781, 23}, {15381482, 228}, {15381483, 81}},
			},
			want: 			cpuState{
				D:   [8]uint32{3085061329, 926992805, 1485120716, 34875024, 468288057, 3275363498, 3651149185, 531139669},
				A:   [7]uint32{2069391260, 688031867, 705813015, 2296670157, 354402994, 274558055, 2879001312},
				PC:  15381484,
				SR:  9736,
				USP: 16203106,
				SSP: 384092,
				RAM: [][2]uint32{{15381478, 209}, {15381479, 35}, {15381480, 160}, {15381481, 17}, {14968780, 49}, {14968781, 232}, {15381482, 228}, {15381483, 81}},
				Cycles: 14,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestADD_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ADD.w 1, D4 5244",
			init: cpuState{
				D:   [8]uint32{430770453, 2802729725, 2039179676, 3255779504, 2270003432, 2019469770, 479886605, 491753643},
				A:   [7]uint32{1909699865, 1739743613, 1028431515, 1544913034, 526166023, 4208995751, 1362253081},
				PC:  7435090,
				SR:  41752,
				USP: 796552,
				SSP: 16059558,
				RAM: [][2]uint32{{7435086, 82}, {7435087, 68}, {7435088, 63}, {7435089, 70}, {7435090, 230}, {7435091, 94}},
			},
			want: cpuState{
				D:   [8]uint32{430770453, 2802729725, 2039179676, 3255779504, 2270003433, 2019469770, 479886605, 491753643},
				A:   [7]uint32{1909699865, 1739743613, 1028431515, 1544913034, 526166023, 4208995751, 1362253081},
				PC:  7435092,
				SR:  41736,
				USP: 796552,
				SSP: 16059558,
				RAM: [][2]uint32{{7435086, 82}, {7435087, 68}, {7435088, 63}, {7435089, 70}, {7435090, 230}, {7435091, 94}},
				Cycles: 4,
			},
		},
		{
			name: "500 ADD.w 6, D4 5c44",
			init: cpuState{
				D:   [8]uint32{2112210899, 2964070417, 1905644747, 697820884, 2982338436, 3240454492, 3551405239, 2086966805},
				A:   [7]uint32{2563005078, 64302311, 636377601, 3598885971, 1556801253, 1695232732, 3346942430},
				PC:  5771750,
				SR:  517,
				USP: 13365698,
				SSP: 9262816,
				RAM: [][2]uint32{{5771746, 92}, {5771747, 68}, {5771748, 79}, {5771749, 231}, {5771750, 135}, {5771751, 80}},
			},
			want: cpuState{
				D:   [8]uint32{2112210899, 2964070417, 1905644747, 697820884, 2982338442, 3240454492, 3551405239, 2086966805},
				A:   [7]uint32{2563005078, 64302311, 636377601, 3598885971, 1556801253, 1695232732, 3346942430},
				PC:  5771752,
				SR:  520,
				USP: 13365698,
				SSP: 9262816,
				RAM: [][2]uint32{{5771746, 92}, {5771747, 68}, {5771748, 79}, {5771749, 231}, {5771750, 135}, {5771751, 80}},
				Cycles: 4,
			},
		},
		{
			name: "1000 ADD.w #, (d8, A4, Xn) 0674",
			init: cpuState{
				D:   [8]uint32{373832229, 2045266333, 2597361689, 240668984, 4086913542, 3506224842, 49363115, 3627640000},
				A:   [7]uint32{2471788548, 574045210, 2856672112, 755277718, 1456953095, 2664118686, 1300343672},
				PC:  8305148,
				SR:  264,
				USP: 12996952,
				SSP: 862336,
				RAM: [][2]uint32{{8305144, 6}, {8305145, 116}, {8305146, 48}, {8305147, 70}, {8305148, 187}, {8305149, 141}, {8305150, 218}, {8305151, 236}, {14415402, 218}, {14415403, 159}, {8305152, 201}, {8305153, 117}},
			},
			want: cpuState{
				D:   [8]uint32{373832229, 2045266333, 2597361689, 240668984, 4086913542, 3506224842, 49363115, 3627640000},
				A:   [7]uint32{2471788548, 574045210, 2856672112, 755277718, 1456953095, 2664118686, 1300343672},
				PC:  8305154,
				SR:  273,
				USP: 12996952,
				SSP: 862336,
				RAM: [][2]uint32{{8305144, 6}, {8305145, 116}, {8305146, 48}, {8305147, 70}, {8305148, 187}, {8305149, 141}, {8305150, 218}, {8305151, 236}, {14415402, 10}, {14415403, 229}, {8305152, 201}, {8305153, 117}},
				Cycles: 22,
			},
		},
		{
			name: "1500 ADD.w D2, -(A2) d562",
			init: cpuState{
				D:   [8]uint32{3292715614, 2045765043, 3181417329, 1300687111, 3501803472, 2364772717, 1226831045, 1007002366},
				A:   [7]uint32{2984759263, 2719015106, 880323050, 3835470203, 3189771112, 3290763888, 1958318305},
				PC:  7360294,
				SR:  10015,
				USP: 806262,
				SSP: 10635868,
				RAM: [][2]uint32{{7360290, 213}, {7360291, 98}, {7360292, 196}, {7360293, 85}, {7907816, 30}, {7907817, 184}, {7360294, 106}, {7360295, 77}},
			},
			want: cpuState{
				D:   [8]uint32{3292715614, 2045765043, 3181417329, 1300687111, 3501803472, 2364772717, 1226831045, 1007002366},
				A:   [7]uint32{2984759263, 2719015106, 880323048, 3835470203, 3189771112, 3290763888, 1958318305},
				PC:  7360296,
				SR:  9992,
				USP: 806262,
				SSP: 10635868,
				RAM: [][2]uint32{{7360290, 213}, {7360291, 98}, {7360292, 196}, {7360293, 85}, {7907816, 178}, {7907817, 41}, {7360294, 106}, {7360295, 77}},
				Cycles: 14,
			},
		},
		{
			name: "2000 ADD.w D0, -(A4) d164",
			init: cpuState{
				D:   [8]uint32{478702470, 1340516552, 2892925863, 760846340, 103963887, 2570774856, 2956880464, 3815113657},
				A:   [7]uint32{2894363122, 619251031, 1290920016, 943671690, 768153821, 790541136, 2818650093},
				PC:  11687738,
				SR:  1040,
				USP: 38220,
				SSP: 8455906,
				RAM: [][2]uint32{{11687734, 209}, {11687735, 100}, {11687736, 241}, {11687737, 51}, {12, 104}, {13, 76}, {14, 131}, {15, 34}, {5014306, 188}, {5014307, 99}, {5014308, 64}, {5014309, 111}},
			},
			want: cpuState{
				D:      [8]uint32{478702470, 1340516552, 2892925863, 760846340, 103963887, 2570774856, 2956880464, 3815113657},
				A:      [7]uint32{2894363122, 619251031, 1290920016, 943671690, 768153819, 790541136, 2818650093},
				PC:     1749844774,
				SR:     9232,
				USP:    38220,
				SSP:    8455892,
				RAM:    [][2]uint32{{11687734, 209}, {11687735, 100}, {11687736, 241}, {11687737, 51}, {8455904, 87}, {8455905, 58}, {8455900, 4}, {8455901, 16}, {8455902, 0}, {8455903, 178}, {8455898, 209}, {8455899, 100}, {8455896, 24}, {8455897, 219}, {8455892, 209}, {8455893, 113}, {8455894, 45}, {8455895, 201}, {12, 104}, {13, 76}, {14, 131}, {15, 34}, {5014306, 188}, {5014307, 99}, {5014308, 64}, {5014309, 111}},
				Halted: true,
			},
		},
		{
			name: "004 ADD.w (d16, A4), D0 d06c",
			init: 			cpuState{
				D:   [8]uint32{1955302260, 3152469229, 3090227136, 3955217490, 1226623351, 2682448729, 2682218035, 2878364256},
				A:   [7]uint32{1377773839, 2280527509, 4090674903, 3918397088, 937065833, 2108199791, 3001794624},
				PC:  13006648,
				SR:  9742,
				USP: 9227812,
				SSP: 6772722,
				RAM: [][2]uint32{{13006644, 208}, {13006645, 108}, {13006646, 27}, {13006647, 181}, {13006648, 2}, {13006649, 251}, {14326046, 228}, {14326047, 212}, {13006650, 229}, {13006651, 120}},
			},
			want: 			cpuState{
				D:   [8]uint32{1955295304, 3152469229, 3090227136, 3955217490, 1226623351, 2682448729, 2682218035, 2878364256},
				A:   [7]uint32{1377773839, 2280527509, 4090674903, 3918397088, 937065833, 2108199791, 3001794624},
				PC:  13006652,
				SR:  9747,
				USP: 9227812,
				SSP: 6772722,
				RAM: [][2]uint32{{13006644, 208}, {13006645, 108}, {13006646, 27}, {13006647, 181}, {13006648, 2}, {13006649, 251}, {14326046, 228}, {14326047, 212}, {13006650, 229}, {13006651, 120}},
				Cycles: 12,
			},
		},
		{
			name: "289 ADD.w (d16, A0), D7 de68",
			init: 			cpuState{
				D:   [8]uint32{567842585, 1615724406, 3839250436, 684342410, 3202037879, 844574042, 1556498575, 3648185140},
				A:   [7]uint32{3508227353, 3982348533, 2849741725, 2946872192, 3335081645, 1388975496, 2601796642},
				PC:  8440956,
				SR:  9229,
				USP: 10130804,
				SSP: 1980676,
				RAM: [][2]uint32{{8440952, 222}, {8440953, 104}, {8440954, 11}, {8440955, 227}, {8440956, 81}, {8440957, 79}, {1792252, 59}, {1792253, 249}, {8440958, 27}, {8440959, 230}},
			},
			want: 			cpuState{
				D:   [8]uint32{567842585, 1615724406, 3839250436, 684342410, 3202037879, 844574042, 1556498575, 3648134957},
				A:   [7]uint32{3508227353, 3982348533, 2849741725, 2946872192, 3335081645, 1388975496, 2601796642},
				PC:  8440960,
				SR:  9233,
				USP: 10130804,
				SSP: 1980676,
				RAM: [][2]uint32{{8440952, 222}, {8440953, 104}, {8440954, 11}, {8440955, 227}, {8440956, 81}, {8440957, 79}, {1792252, 59}, {1792253, 249}, {8440958, 27}, {8440959, 230}},
				Cycles: 12,
			},
		},
		{
			name: "551 ADD.w 4, (A7) 5857",
			init: 			cpuState{
				D:   [8]uint32{2691094432, 1119832249, 248093774, 1636264696, 1325976219, 2492443159, 2131604577, 3550134707},
				A:   [7]uint32{510893003, 3798277221, 855614236, 4253812497, 2113875917, 465243952, 3605992870},
				PC:  15783632,
				SR:  1289,
				USP: 5373086,
				SSP: 16106914,
				RAM: [][2]uint32{{15783628, 88}, {15783629, 87}, {15783630, 166}, {15783631, 183}, {5373086, 214}, {5373087, 252}, {15783632, 138}, {15783633, 248}},
			},
			want: 			cpuState{
				D:   [8]uint32{2691094432, 1119832249, 248093774, 1636264696, 1325976219, 2492443159, 2131604577, 3550134707},
				A:   [7]uint32{510893003, 3798277221, 855614236, 4253812497, 2113875917, 465243952, 3605992870},
				PC:  15783634,
				SR:  1288,
				USP: 5373086,
				SSP: 16106914,
				RAM: [][2]uint32{{15783628, 88}, {15783629, 87}, {15783630, 166}, {15783631, 183}, {5373086, 215}, {5373087, 0}, {15783632, 138}, {15783633, 248}},
				Cycles: 12,
			},
		},
		{
			name: "842 ADD.w (d16, A1), D0 d069",
			init: 			cpuState{
				D:   [8]uint32{2216995004, 939527996, 2150078888, 2025155108, 3169104313, 311867506, 3295166042, 1068691864},
				A:   [7]uint32{3869695718, 858935183, 820480355, 1409722656, 1926940002, 1777235895, 2154129210},
				PC:  338940,
				SR:  9994,
				USP: 15288616,
				SSP: 1678932,
				RAM: [][2]uint32{{338936, 208}, {338937, 105}, {338938, 196}, {338939, 199}, {338940, 13}, {338941, 251}, {3282006, 208}, {3282007, 37}, {338942, 238}, {338943, 227}},
			},
			want: 			cpuState{
				D:   [8]uint32{2216982753, 939527996, 2150078888, 2025155108, 3169104313, 311867506, 3295166042, 1068691864},
				A:   [7]uint32{3869695718, 858935183, 820480355, 1409722656, 1926940002, 1777235895, 2154129210},
				PC:  338944,
				SR:  10003,
				USP: 15288616,
				SSP: 1678932,
				RAM: [][2]uint32{{338936, 208}, {338937, 105}, {338938, 196}, {338939, 199}, {338940, 13}, {338941, 251}, {3282006, 208}, {3282007, 37}, {338942, 238}, {338943, 227}},
				Cycles: 12,
			},
		},
		{
			name: "1131 ADD.w 6, D6 5c46",
			init: 			cpuState{
				D:   [8]uint32{2871950814, 3705243452, 221472205, 3007392039, 2246446157, 1068740231, 2713128288, 3190211468},
				A:   [7]uint32{646652319, 3449295062, 3187553275, 2926413047, 1667526661, 1582807399, 3142020571},
				PC:  15487902,
				SR:  1545,
				USP: 6783918,
				SSP: 12340622,
				RAM: [][2]uint32{{15487898, 92}, {15487899, 70}, {15487900, 187}, {15487901, 136}, {15487902, 97}, {15487903, 64}},
			},
			want: 			cpuState{
				D:   [8]uint32{2871950814, 3705243452, 221472205, 3007392039, 2246446157, 1068740231, 2713128294, 3190211468},
				A:   [7]uint32{646652319, 3449295062, 3187553275, 2926413047, 1667526661, 1582807399, 3142020571},
				PC:  15487904,
				SR:  1536,
				USP: 6783918,
				SSP: 12340622,
				RAM: [][2]uint32{{15487898, 92}, {15487899, 70}, {15487900, 187}, {15487901, 136}, {15487902, 97}, {15487903, 64}},
				Cycles: 4,
			},
		},
		{
			name: "1420 ADD.w (d8, A4, Xn), D0 d074",
			init: 			cpuState{
				D:   [8]uint32{4201449202, 3329055257, 1668220850, 500149239, 1287349664, 2085436229, 3376277631, 3875879974},
				A:   [7]uint32{365120945, 924676368, 387075835, 3376512977, 317967580, 2795349233, 1884128695},
				PC:  14395186,
				SR:  1039,
				USP: 14425540,
				SSP: 1450844,
				RAM: [][2]uint32{{14395182, 208}, {14395183, 116}, {14395184, 51}, {14395185, 83}, {14395186, 103}, {14395187, 46}, {15956262, 200}, {15956263, 70}, {14395188, 111}, {14395189, 15}},
			},
			want: 			cpuState{
				D:   [8]uint32{4201500472, 3329055257, 1668220850, 500149239, 1287349664, 2085436229, 3376277631, 3875879974},
				A:   [7]uint32{365120945, 924676368, 387075835, 3376512977, 317967580, 2795349233, 1884128695},
				PC:  14395190,
				SR:  1032,
				USP: 14425540,
				SSP: 1450844,
				RAM: [][2]uint32{{14395182, 208}, {14395183, 116}, {14395184, 51}, {14395185, 83}, {14395186, 103}, {14395187, 46}, {15956262, 200}, {15956263, 70}, {14395188, 111}, {14395189, 15}},
				Cycles: 14,
			},
		},
		{
			name: "1690 ADD.w -(A0), D0 d060",
			init: 			cpuState{
				D:   [8]uint32{3333872517, 2750047119, 1142855776, 957249393, 3655914426, 3588944756, 4286523766, 3304364075},
				A:   [7]uint32{3381168316, 888387277, 3897518783, 2841468386, 1797802169, 2634685248, 26072645},
				PC:  14528066,
				SR:  1561,
				USP: 14767596,
				SSP: 3771414,
				RAM: [][2]uint32{{14528062, 208}, {14528063, 96}, {14528064, 67}, {14528065, 142}, {8947898, 1}, {8947899, 244}, {14528066, 222}, {14528067, 163}},
			},
			want: 			cpuState{
				D:   [8]uint32{3333873017, 2750047119, 1142855776, 957249393, 3655914426, 3588944756, 4286523766, 3304364075},
				A:   [7]uint32{3381168314, 888387277, 3897518783, 2841468386, 1797802169, 2634685248, 26072645},
				PC:  14528068,
				SR:  1544,
				USP: 14767596,
				SSP: 3771414,
				RAM: [][2]uint32{{14528062, 208}, {14528063, 96}, {14528064, 67}, {14528065, 142}, {8947898, 1}, {8947899, 244}, {14528066, 222}, {14528067, 163}},
				Cycles: 10,
			},
		},
		{
			name: "1979 ADD.w 6, D2 5c42",
			init: 			cpuState{
				D:   [8]uint32{1233152031, 3712397921, 3368195195, 2071099641, 2880066405, 3744233612, 1039561316, 3512645612},
				A:   [7]uint32{258971119, 3936281319, 3894135160, 2339830925, 1767938111, 3716101172, 1600830933},
				PC:  11151594,
				SR:  9242,
				USP: 15914654,
				SSP: 7956776,
				RAM: [][2]uint32{{11151590, 92}, {11151591, 66}, {11151592, 170}, {11151593, 51}, {11151594, 21}, {11151595, 66}},
			},
			want: 			cpuState{
				D:   [8]uint32{1233152031, 3712397921, 3368195201, 2071099641, 2880066405, 3744233612, 1039561316, 3512645612},
				A:   [7]uint32{258971119, 3936281319, 3894135160, 2339830925, 1767938111, 3716101172, 1600830933},
				PC:  11151596,
				SR:  9224,
				USP: 15914654,
				SSP: 7956776,
				RAM: [][2]uint32{{11151590, 92}, {11151591, 66}, {11151592, 170}, {11151593, 51}, {11151594, 21}, {11151595, 66}},
				Cycles: 4,
			},
		},
		{
			name: "2251 ADD.w (A6)+, D3 d65e",
			init: 			cpuState{
				D:   [8]uint32{269384268, 1701971703, 1503972098, 256222901, 2889642322, 2538455090, 1045158815, 1709200581},
				A:   [7]uint32{1419530274, 620048535, 3175264067, 3267756607, 1081605341, 538260924, 2187346178},
				PC:  5714294,
				SR:  9489,
				USP: 6141180,
				SSP: 7350900,
				RAM: [][2]uint32{{5714290, 214}, {5714291, 94}, {5714292, 3}, {5714293, 84}, {6308098, 245}, {6308099, 109}, {5714294, 172}, {5714295, 199}},
			},
			want: 			cpuState{
				D:   [8]uint32{269384268, 1701971703, 1503972098, 256220194, 2889642322, 2538455090, 1045158815, 1709200581},
				A:   [7]uint32{1419530274, 620048535, 3175264067, 3267756607, 1081605341, 538260924, 2187346180},
				PC:  5714296,
				SR:  9497,
				USP: 6141180,
				SSP: 7350900,
				RAM: [][2]uint32{{5714290, 214}, {5714291, 94}, {5714292, 3}, {5714293, 84}, {6308098, 245}, {6308099, 109}, {5714294, 172}, {5714295, 199}},
				Cycles: 8,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestADD_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ADD.l D5, (d8, A3, Xn) dbb3",
			init: cpuState{
				D:   [8]uint32{2716418231, 4207376922, 2543932834, 4262317947, 3724476184, 22002888, 386349136, 3381172759},
				A:   [7]uint32{2874603247, 2869405373, 1615831200, 1045252699, 2138434487, 709118711, 3722715766},
				PC:  3065352,
				SR:  8979,
				USP: 14939940,
				SSP: 4539052,
				RAM: [][2]uint32{{3065348, 219}, {3065349, 179}, {3065350, 12}, {3065351, 79}, {3065352, 6}, {3065353, 183}, {12, 224}, {13, 16}, {14, 233}, {15, 22}, {1108246, 10}, {1108247, 58}, {1108248, 220}, {1108249, 238}},
			},
			want: cpuState{
				D:      [8]uint32{2716418231, 4207376922, 2543932834, 4262317947, 3724476184, 22002888, 386349136, 3381172759},
				A:      [7]uint32{2874603247, 2869405373, 1615831200, 1045252699, 2138434487, 709118711, 3722715766},
				PC:     3759204634,
				SR:     8979,
				USP:    14939940,
				SSP:    4539038,
				RAM:    [][2]uint32{{3065348, 219}, {3065349, 179}, {3065350, 12}, {3065351, 79}, {3065352, 6}, {3065353, 183}, {4539050, 198}, {4539051, 6}, {4539046, 35}, {4539047, 19}, {4539048, 0}, {4539049, 46}, {4539044, 219}, {4539045, 179}, {4539042, 139}, {4539043, 97}, {4539038, 219}, {4539039, 181}, {4539040, 224}, {4539041, 54}, {12, 224}, {13, 16}, {14, 233}, {15, 22}, {1108246, 10}, {1108247, 58}, {1108248, 220}, {1108249, 238}},
				Halted: true,
			},
		},
		{
			name: "500 ADD.l -(A7), D4 d8a7",
			init: cpuState{
				D:   [8]uint32{1464287997, 554386041, 3887730148, 2185993342, 3001880088, 378082243, 3578433898, 2465168491},
				A:   [7]uint32{163518063, 2397436891, 4124904640, 1102613353, 1908206022, 3700052004, 923254654},
				PC:  11151146,
				SR:  1311,
				USP: 12096570,
				SSP: 2525228,
				RAM: [][2]uint32{{11151142, 216}, {11151143, 167}, {11151144, 208}, {11151145, 224}, {12096566, 41}, {12096567, 247}, {12096568, 163}, {12096569, 34}, {11151146, 224}, {11151147, 89}},
			},
			want: cpuState{
				D:   [8]uint32{1464287997, 554386041, 3887730148, 2185993342, 3705975098, 378082243, 3578433898, 2465168491},
				A:   [7]uint32{163518063, 2397436891, 4124904640, 1102613353, 1908206022, 3700052004, 923254654},
				PC:  11151148,
				SR:  1288,
				USP: 12096566,
				SSP: 2525228,
				RAM: [][2]uint32{{11151142, 216}, {11151143, 167}, {11151144, 208}, {11151145, 224}, {12096566, 41}, {12096567, 247}, {12096568, 163}, {12096569, 34}, {11151146, 224}, {11151147, 89}},
				Cycles: 16,
			},
		},
		{
			name: "1000 ADD.l 5, -(A4) 5aa4",
			init: cpuState{
				D:   [8]uint32{2619285985, 1925216638, 378178917, 3926764760, 2401236533, 876400138, 4100076479, 891502556},
				A:   [7]uint32{24336229, 2285867149, 2291944242, 1242972929, 2729282478, 1635746504, 566093415},
				PC:  8721036,
				SR:  8705,
				USP: 10982728,
				SSP: 3918218,
				RAM: [][2]uint32{{8721032, 90}, {8721033, 164}, {8721034, 36}, {8721035, 179}, {11373482, 233}, {11373483, 50}, {11373484, 77}, {11373485, 201}, {8721036, 60}, {8721037, 20}},
			},
			want: cpuState{
				D:   [8]uint32{2619285985, 1925216638, 378178917, 3926764760, 2401236533, 876400138, 4100076479, 891502556},
				A:   [7]uint32{24336229, 2285867149, 2291944242, 1242972929, 2729282474, 1635746504, 566093415},
				PC:  8721038,
				SR:  8712,
				USP: 10982728,
				SSP: 3918218,
				RAM: [][2]uint32{{8721032, 90}, {8721033, 164}, {8721034, 36}, {8721035, 179}, {11373482, 233}, {11373483, 50}, {11373484, 77}, {11373485, 206}, {8721036, 60}, {8721037, 20}},
				Cycles: 22,
			},
		},
		{
			name: "1500 ADD.l (A0)+, D5 da98",
			init: cpuState{
				D:   [8]uint32{1546755666, 3978331449, 292994626, 2574451037, 2483638804, 525818923, 1449235995, 2779746162},
				A:   [7]uint32{1387516899, 1905346324, 1200303954, 1497033632, 1983392107, 403827175, 3371803439},
				PC:  8040040,
				SR:  9477,
				USP: 9588392,
				SSP: 6158450,
				RAM: [][2]uint32{{8040036, 218}, {8040037, 152}, {8040038, 34}, {8040039, 236}, {12, 32}, {13, 58}, {14, 223}, {15, 18}, {3858194, 0}, {3858195, 181}, {3858196, 199}, {3858197, 69}},
			},
			want: cpuState{
				D:      [8]uint32{1546755666, 3978331449, 292994626, 2574451037, 2483638804, 525818923, 1449235995, 2779746162},
				A:      [7]uint32{1387516899, 1905346324, 1200303954, 1497033632, 1983392107, 403827175, 3371803439},
				PC:     540729110,
				SR:     9477,
				USP:    9588392,
				SSP:    6158436,
				RAM:    [][2]uint32{{8040036, 218}, {8040037, 152}, {8040038, 34}, {8040039, 236}, {6158448, 174}, {6158449, 102}, {6158444, 37}, {6158445, 5}, {6158446, 0}, {6158447, 122}, {6158442, 218}, {6158443, 152}, {6158440, 211}, {6158441, 227}, {6158436, 218}, {6158437, 149}, {6158438, 82}, {6158439, 179}, {12, 32}, {13, 58}, {14, 223}, {15, 18}, {3858194, 0}, {3858195, 181}, {3858196, 199}, {3858197, 69}},
				Halted: true,
			},
		},
		{
			name: "2000 ADD.l #, (A0) 0690",
			init: cpuState{
				D:   [8]uint32{1559146838, 3539592242, 3548872570, 963141589, 4011367675, 1828380738, 4264968104, 764381064},
				A:   [7]uint32{349926689, 3406555350, 1647720366, 3609071408, 3111363858, 1523308046, 3279236371},
				PC:  370030,
				SR:  8206,
				USP: 13506444,
				SSP: 190472,
				RAM: [][2]uint32{{370026, 6}, {370027, 144}, {370028, 228}, {370029, 172}, {370030, 54}, {370031, 91}, {370032, 81}, {370033, 172}, {12, 41}, {13, 132}, {14, 198}, {15, 152}, {8701592, 170}, {8701593, 142}, {8701594, 173}, {8701595, 11}},
			},
			want: cpuState{
				D:      [8]uint32{1559146838, 3539592242, 3548872570, 963141589, 4011367675, 1828380738, 4264968104, 764381064},
				A:      [7]uint32{349926689, 3406555350, 1647720366, 3609071408, 3111363858, 1523308046, 3279236371},
				PC:     696567452,
				SR:     8206,
				USP:    13506444,
				SSP:    190458,
				RAM:    [][2]uint32{{370026, 6}, {370027, 144}, {370028, 228}, {370029, 172}, {370030, 54}, {370031, 91}, {370032, 81}, {370033, 172}, {190470, 165}, {190471, 112}, {190466, 32}, {190467, 14}, {190468, 0}, {190469, 5}, {190464, 6}, {190465, 144}, {190462, 117}, {190463, 33}, {190458, 6}, {190459, 149}, {190460, 20}, {190461, 219}, {12, 41}, {13, 132}, {14, 198}, {15, 152}, {8701592, 170}, {8701593, 142}, {8701594, 173}, {8701595, 11}},
				Halted: true,
			},
		},
		{
			name: "002 ADD.l (A2)+, D6 dc9a",
			init: 			cpuState{
				D:   [8]uint32{2918998470, 4280263269, 2217931224, 2018318373, 3381038019, 2592947732, 420430619, 1901456984},
				A:   [7]uint32{1284790511, 3803555667, 1553803970, 298132349, 1168479489, 300992719, 3878284537},
				PC:  5756302,
				SR:  1298,
				USP: 9416820,
				SSP: 16613618,
				RAM: [][2]uint32{{5756298, 220}, {5756299, 154}, {5756300, 13}, {5756301, 236}, {10300098, 148}, {10300099, 229}, {10300100, 143}, {10300101, 198}, {5756302, 164}, {5756303, 250}},
			},
			want: 			cpuState{
				D:   [8]uint32{2918998470, 4280263269, 2217931224, 2018318373, 3381038019, 2592947732, 2918503137, 1901456984},
				A:   [7]uint32{1284790511, 3803555667, 1553803974, 298132349, 1168479489, 300992719, 3878284537},
				PC:  5756304,
				SR:  1288,
				USP: 9416820,
				SSP: 16613618,
				RAM: [][2]uint32{{5756298, 220}, {5756299, 154}, {5756300, 13}, {5756301, 236}, {10300098, 148}, {10300099, 229}, {10300100, 143}, {10300101, 198}, {5756302, 164}, {5756303, 250}},
				Cycles: 14,
			},
		},
		{
			name: "300 ADD.l D4, (xxx).w d9b8",
			init: 			cpuState{
				D:   [8]uint32{314415055, 230091498, 661566923, 3679305290, 1244983991, 3901273203, 1830758627, 2422825839},
				A:   [7]uint32{1358714123, 1779036834, 3798690685, 2428329112, 996832295, 3678164519, 3518543435},
				PC:  4327914,
				SR:  794,
				USP: 4372004,
				SSP: 16017944,
				RAM: [][2]uint32{{4327910, 217}, {4327911, 184}, {4327912, 194}, {4327913, 86}, {4327914, 54}, {4327915, 9}, {16761430, 182}, {16761431, 115}, {16761432, 212}, {16761433, 240}, {4327916, 38}, {4327917, 82}},
			},
			want: 			cpuState{
				D:   [8]uint32{314415055, 230091498, 661566923, 3679305290, 1244983991, 3901273203, 1830758627, 2422825839},
				A:   [7]uint32{1358714123, 1779036834, 3798690685, 2428329112, 996832295, 3678164519, 3518543435},
				PC:  4327918,
				SR:  785,
				USP: 4372004,
				SSP: 16017944,
				RAM: [][2]uint32{{4327910, 217}, {4327911, 184}, {4327912, 194}, {4327913, 86}, {4327914, 54}, {4327915, 9}, {16761430, 0}, {16761431, 168}, {16761432, 199}, {16761433, 167}, {4327916, 38}, {4327917, 82}},
				Cycles: 24,
			},
		},
		{
			name: "582 ADD.l D6, D4 d886",
			init: 			cpuState{
				D:   [8]uint32{4114267297, 912208900, 2895202524, 852692583, 607250322, 574463647, 3745338052, 3801740948},
				A:   [7]uint32{825275728, 957902175, 749268829, 1939309287, 4285863714, 1702741643, 3490331545},
				PC:  10165310,
				SR:  8220,
				USP: 10289368,
				SSP: 9753864,
				RAM: [][2]uint32{{10165306, 216}, {10165307, 134}, {10165308, 195}, {10165309, 154}, {10165310, 243}, {10165311, 72}},
			},
			want: 			cpuState{
				D:   [8]uint32{4114267297, 912208900, 2895202524, 852692583, 57621078, 574463647, 3745338052, 3801740948},
				A:   [7]uint32{825275728, 957902175, 749268829, 1939309287, 4285863714, 1702741643, 3490331545},
				PC:  10165312,
				SR:  8209,
				USP: 10289368,
				SSP: 9753864,
				RAM: [][2]uint32{{10165306, 216}, {10165307, 134}, {10165308, 195}, {10165309, 154}, {10165310, 243}, {10165311, 72}},
				Cycles: 8,
			},
		},
		{
			name: "868 ADD.l (A0), D0 d090",
			init: 			cpuState{
				D:   [8]uint32{2123216565, 367060569, 2305266320, 1386937606, 1253868522, 970463224, 2197943478, 1566339665},
				A:   [7]uint32{2785935074, 3565910505, 1194595007, 127797494, 1146122670, 3147438647, 897225699},
				PC:  808322,
				SR:  1030,
				USP: 12373068,
				SSP: 11708224,
				RAM: [][2]uint32{{808318, 208}, {808319, 144}, {808320, 233}, {808321, 204}, {917218, 128}, {917219, 160}, {917220, 242}, {917221, 43}, {808322, 78}, {808323, 142}},
			},
			want: 			cpuState{
				D:   [8]uint32{4281247968, 367060569, 2305266320, 1386937606, 1253868522, 970463224, 2197943478, 1566339665},
				A:   [7]uint32{2785935074, 3565910505, 1194595007, 127797494, 1146122670, 3147438647, 897225699},
				PC:  808324,
				SR:  1032,
				USP: 12373068,
				SSP: 11708224,
				RAM: [][2]uint32{{808318, 208}, {808319, 144}, {808320, 233}, {808321, 204}, {917218, 128}, {917219, 160}, {917220, 242}, {917221, 43}, {808322, 78}, {808323, 142}},
				Cycles: 14,
			},
		},
		{
			name: "1184 ADD.l D4, -(A4) d9a4",
			init: 			cpuState{
				D:   [8]uint32{1036284485, 3110015816, 2771783940, 2009033426, 3705999219, 712347508, 4143122602, 2978417309},
				A:   [7]uint32{1413222110, 1238509782, 3860067881, 3971071993, 765121704, 3610212020, 1989780816},
				PC:  12299172,
				SR:  9756,
				USP: 3918938,
				SSP: 14731302,
				RAM: [][2]uint32{{12299168, 217}, {12299169, 164}, {12299170, 82}, {12299171, 232}, {10146980, 94}, {10146981, 136}, {10146982, 188}, {10146983, 157}, {12299172, 55}, {12299173, 252}},
			},
			want: 			cpuState{
				D:   [8]uint32{1036284485, 3110015816, 2771783940, 2009033426, 3705999219, 712347508, 4143122602, 2978417309},
				A:   [7]uint32{1413222110, 1238509782, 3860067881, 3971071993, 765121700, 3610212020, 1989780816},
				PC:  12299174,
				SR:  9745,
				USP: 3918938,
				SSP: 14731302,
				RAM: [][2]uint32{{12299168, 217}, {12299169, 164}, {12299170, 82}, {12299171, 232}, {10146980, 59}, {10146981, 109}, {10146982, 204}, {10146983, 16}, {12299172, 55}, {12299173, 252}},
				Cycles: 22,
			},
		},
		{
			name: "1430 ADD.l D7, (A7) df97",
			init: 			cpuState{
				D:   [8]uint32{3944091556, 963968394, 1689726210, 3810038867, 2612821140, 4197691032, 2498171033, 2905980717},
				A:   [7]uint32{627134646, 1697572770, 2866918282, 3589612889, 2019690819, 3528888413, 3704543945},
				PC:  7252094,
				SR:  10000,
				USP: 14999624,
				SSP: 10863744,
				RAM: [][2]uint32{{7252090, 223}, {7252091, 151}, {7252092, 79}, {7252093, 221}, {10863744, 39}, {10863745, 34}, {10863746, 198}, {10863747, 55}, {7252094, 187}, {7252095, 134}},
			},
			want: 			cpuState{
				D:   [8]uint32{3944091556, 963968394, 1689726210, 3810038867, 2612821140, 4197691032, 2498171033, 2905980717},
				A:   [7]uint32{627134646, 1697572770, 2866918282, 3589612889, 2019690819, 3528888413, 3704543945},
				PC:  7252096,
				SR:  9992,
				USP: 14999624,
				SSP: 10863744,
				RAM: [][2]uint32{{7252090, 223}, {7252091, 151}, {7252092, 79}, {7252093, 221}, {10863744, 212}, {10863745, 88}, {10863746, 133}, {10863747, 100}, {7252094, 187}, {7252095, 134}},
				Cycles: 20,
			},
		},
		{
			name: "1658 ADD.l D4, (A1)+ d999",
			init: 			cpuState{
				D:   [8]uint32{3263040157, 3834309658, 3602099486, 2888552305, 2188749264, 3269455322, 1224060696, 4272118113},
				A:   [7]uint32{3893614084, 988894770, 3622013729, 2479330253, 148146499, 2238436336, 594553858},
				PC:  2743172,
				SR:  8978,
				USP: 10474310,
				SSP: 14191182,
				RAM: [][2]uint32{{2743168, 217}, {2743169, 153}, {2743170, 51}, {2743171, 174}, {15816242, 169}, {15816243, 236}, {15816244, 4}, {15816245, 245}, {2743172, 176}, {2743173, 142}},
			},
			want: 			cpuState{
				D:   [8]uint32{3263040157, 3834309658, 3602099486, 2888552305, 2188749264, 3269455322, 1224060696, 4272118113},
				A:   [7]uint32{3893614084, 988894774, 3622013729, 2479330253, 148146499, 2238436336, 594553858},
				PC:  2743174,
				SR:  8979,
				USP: 10474310,
				SSP: 14191182,
				RAM: [][2]uint32{{2743168, 217}, {2743169, 153}, {2743170, 51}, {2743171, 174}, {15816242, 44}, {15816243, 97}, {15816244, 174}, {15816245, 197}, {2743172, 176}, {2743173, 142}},
				Cycles: 20,
			},
		},
		{
			name: "1957 ADD.l 7, (A5) 5e95",
			init: 			cpuState{
				D:   [8]uint32{1488541463, 4117496975, 1633769889, 1414486222, 1240087940, 4191532199, 742171866, 1615686693},
				A:   [7]uint32{3885439866, 2221745418, 11977906, 1089403296, 2932352963, 2677187088, 1891450026},
				PC:  4746102,
				SR:  1793,
				USP: 14394180,
				SSP: 11515060,
				RAM: [][2]uint32{{4746098, 94}, {4746099, 149}, {4746100, 172}, {4746101, 212}, {9609744, 134}, {9609745, 230}, {9609746, 1}, {9609747, 207}, {4746102, 18}, {4746103, 125}},
			},
			want: 			cpuState{
				D:   [8]uint32{1488541463, 4117496975, 1633769889, 1414486222, 1240087940, 4191532199, 742171866, 1615686693},
				A:   [7]uint32{3885439866, 2221745418, 11977906, 1089403296, 2932352963, 2677187088, 1891450026},
				PC:  4746104,
				SR:  1800,
				USP: 14394180,
				SSP: 11515060,
				RAM: [][2]uint32{{4746098, 94}, {4746099, 149}, {4746100, 172}, {4746101, 212}, {9609744, 134}, {9609745, 230}, {9609746, 1}, {9609747, 214}, {4746102, 18}, {4746103, 125}},
				Cycles: 20,
			},
		},
		{
			name: "2237 ADD.l (d8, PC, Xn), D3 d6bb",
			init: 			cpuState{
				D:   [8]uint32{856555284, 4007999430, 963482048, 1184639609, 2806742836, 2778821531, 72300007, 2117612041},
				A:   [7]uint32{802901325, 4039380012, 3762209196, 3907706872, 2879137272, 1664046749, 2445742005},
				PC:  10938242,
				SR:  8715,
				USP: 10994608,
				SSP: 10770600,
				RAM: [][2]uint32{{10938238, 214}, {10938239, 187}, {10938240, 253}, {10938241, 234}, {10938242, 219}, {10938243, 157}, {4931602, 1}, {4931603, 26}, {4931604, 91}, {4931605, 102}, {10938244, 70}, {10938245, 156}},
			},
			want: 			cpuState{
				D:   [8]uint32{856555284, 4007999430, 963482048, 1203144159, 2806742836, 2778821531, 72300007, 2117612041},
				A:   [7]uint32{802901325, 4039380012, 3762209196, 3907706872, 2879137272, 1664046749, 2445742005},
				PC:  10938246,
				SR:  8704,
				USP: 10994608,
				SSP: 10770600,
				RAM: [][2]uint32{{10938238, 214}, {10938239, 187}, {10938240, 253}, {10938241, 234}, {10938242, 219}, {10938243, 157}, {4931602, 1}, {4931603, 26}, {4931604, 91}, {4931605, 102}, {10938244, 70}, {10938245, 156}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestADDA_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ADDA.w (d16, A0), A2 d4e8",
			init: cpuState{
				D:   [8]uint32{3597950942, 3391415435, 3445088799, 1597919559, 294870065, 1337499212, 1126913713, 2248054717},
				A:   [7]uint32{1497914091, 2386817744, 579384692, 2821960988, 3155809731, 2473268795, 2208773622},
				PC:  9681622,
				SR:  34583,
				USP: 481542,
				SSP: 10933724,
				RAM: [][2]uint32{{9681618, 212}, {9681619, 232}, {9681620, 136}, {9681621, 78}, {9681622, 154}, {9681623, 99}, {12, 30}, {13, 124}, {14, 113}, {15, 224}, {8155616, 59}, {8155617, 190}, {8155618, 55}, {8155619, 219}},
			},
			want: cpuState{
				D:      [8]uint32{3597950942, 3391415435, 3445088799, 1597919559, 294870065, 1337499212, 1126913713, 2248054717},
				A:      [7]uint32{1497914091, 2386817744, 579384692, 2821960988, 3155809731, 2473268795, 2208773622},
				PC:     511472100,
				SR:     10007,
				USP:    481542,
				SSP:    10933710,
				RAM:    [][2]uint32{{9681618, 212}, {9681619, 232}, {9681620, 136}, {9681621, 78}, {9681622, 154}, {9681623, 99}, {10933722, 186}, {10933723, 212}, {10933718, 135}, {10933719, 23}, {10933720, 0}, {10933721, 147}, {10933716, 212}, {10933717, 232}, {10933714, 227}, {10933715, 57}, {10933710, 212}, {10933711, 241}, {10933712, 89}, {10933713, 71}, {12, 30}, {13, 124}, {14, 113}, {15, 224}, {8155616, 59}, {8155617, 190}, {8155618, 55}, {8155619, 219}},
				Halted: true,
			},
		},
		{
			name: "500 ADDA.w (A5), A0 d0d5",
			init: cpuState{
				D:   [8]uint32{2705787859, 1489959357, 948773599, 1831963320, 981282264, 4043538049, 592155262, 3174709345},
				A:   [7]uint32{164434849, 2574239793, 3606326509, 154182994, 391755068, 611893632, 1022973450},
				PC:  7527900,
				SR:  33820,
				USP: 14105584,
				SSP: 6859282,
				RAM: [][2]uint32{{7527896, 208}, {7527897, 213}, {7527898, 13}, {7527899, 86}, {7913856, 203}, {7913857, 103}, {7527900, 48}, {7527901, 160}},
			},
			want: cpuState{
				D:   [8]uint32{2705787859, 1489959357, 948773599, 1831963320, 981282264, 4043538049, 592155262, 3174709345},
				A:   [7]uint32{164421384, 2574239793, 3606326509, 154182994, 391755068, 611893632, 1022973450},
				PC:  7527902,
				SR:  33820,
				USP: 14105584,
				SSP: 6859282,
				RAM: [][2]uint32{{7527896, 208}, {7527897, 213}, {7527898, 13}, {7527899, 86}, {7913856, 203}, {7913857, 103}, {7527900, 48}, {7527901, 160}},
				Cycles: 12,
			},
		},
		{
			name: "1000 ADDA.w (d8, A7, Xn), A4 d8f7",
			init: cpuState{
				D:   [8]uint32{3848523572, 3152832300, 732298797, 1686405678, 2759647777, 3002253350, 3241958134, 4280890333},
				A:   [7]uint32{3011731805, 2936270313, 4131770887, 67293818, 2610481305, 3196519856, 2491756737},
				PC:  12860026,
				SR:  532,
				USP: 8027608,
				SSP: 3304262,
				RAM: [][2]uint32{{12860022, 216}, {12860023, 247}, {12860024, 251}, {12860025, 185}, {12860026, 85}, {12860027, 105}, {12, 231}, {13, 4}, {14, 111}, {15, 164}, {290724, 240}, {290725, 53}, {290726, 85}, {290727, 175}},
			},
			want: cpuState{
				D:      [8]uint32{3848523572, 3152832300, 732298797, 1686405678, 2759647777, 3002253350, 3241958134, 4280890333},
				A:      [7]uint32{3011731805, 2936270313, 4131770887, 67293818, 2610481305, 3196519856, 2491756737},
				PC:     3875827624,
				SR:     8724,
				USP:    8027608,
				SSP:    3304248,
				RAM:    [][2]uint32{{12860022, 216}, {12860023, 247}, {12860024, 251}, {12860025, 185}, {12860026, 85}, {12860027, 105}, {3304260, 58}, {3304261, 120}, {3304256, 2}, {3304257, 20}, {3304258, 0}, {3304259, 196}, {3304254, 216}, {3304255, 247}, {3304252, 251}, {3304253, 105}, {3304248, 216}, {3304249, 241}, {3304250, 0}, {3304251, 244}, {12, 231}, {13, 4}, {14, 111}, {15, 164}, {290724, 240}, {290725, 53}, {290726, 85}, {290727, 175}},
				Halted: true,
			},
		},
		{
			name: "1500 ADDA.w D4, A7 dec4",
			init: cpuState{
				D:   [8]uint32{1600072499, 2883560763, 4118941917, 3610026532, 2827090577, 1524493220, 1211169298, 2760757668},
				A:   [7]uint32{2849045241, 3221405000, 1641493384, 904602802, 166532812, 3829357961, 1589140872},
				PC:  10426612,
				SR:  1052,
				USP: 9022032,
				SSP: 6900302,
				RAM: [][2]uint32{{10426608, 222}, {10426609, 196}, {10426610, 214}, {10426611, 214}, {10426612, 36}, {10426613, 113}},
			},
			want: cpuState{
				D:   [8]uint32{1600072499, 2883560763, 4118941917, 3610026532, 2827090577, 1524493220, 1211169298, 2760757668},
				A:   [7]uint32{2849045241, 3221405000, 1641493384, 904602802, 166532812, 3829357961, 1589140872},
				PC:  10426614,
				SR:  1052,
				USP: 9020641,
				SSP: 6900302,
				RAM: [][2]uint32{{10426608, 222}, {10426609, 196}, {10426610, 214}, {10426611, 214}, {10426612, 36}, {10426613, 113}},
				Cycles: 8,
			},
		},
		{
			name: "2000 ADDA.w (A1)+, A2 d4d9",
			init: cpuState{
				D:   [8]uint32{2621495335, 2159505638, 659150666, 3489618385, 2635209543, 2662001846, 1793971140, 2301414497},
				A:   [7]uint32{1328373017, 1307571906, 623087067, 600395495, 2544796043, 2621170528, 1547048081},
				PC:  12134652,
				SR:  9746,
				USP: 12333522,
				SSP: 9232818,
				RAM: [][2]uint32{{12134648, 212}, {12134649, 217}, {12134650, 218}, {12134651, 82}, {15726274, 23}, {15726275, 156}, {12134652, 74}, {12134653, 21}},
			},
			want: cpuState{
				D:   [8]uint32{2621495335, 2159505638, 659150666, 3489618385, 2635209543, 2662001846, 1793971140, 2301414497},
				A:   [7]uint32{1328373017, 1307571908, 623093111, 600395495, 2544796043, 2621170528, 1547048081},
				PC:  12134654,
				SR:  9746,
				USP: 12333522,
				SSP: 9232818,
				RAM: [][2]uint32{{12134648, 212}, {12134649, 217}, {12134650, 218}, {12134651, 82}, {15726274, 23}, {15726275, 156}, {12134652, 74}, {12134653, 21}},
				Cycles: 12,
			},
		},
		{
			name: "001 ADDA.w (A7), A6 dcd7",
			init: 			cpuState{
				D:   [8]uint32{3136281985, 1149292506, 3850632206, 3596104039, 2531632687, 4221633728, 1238922906, 430763890},
				A:   [7]uint32{433304354, 710161134, 2850301888, 2789591379, 2675663443, 4207359874, 1199875927},
				PC:  9883684,
				SR:  1306,
				USP: 9499176,
				SSP: 8718830,
				RAM: [][2]uint32{{9883680, 220}, {9883681, 215}, {9883682, 118}, {9883683, 158}, {9499176, 182}, {9499177, 95}, {9883684, 56}, {9883685, 5}},
			},
			want: 			cpuState{
				D:   [8]uint32{3136281985, 1149292506, 3850632206, 3596104039, 2531632687, 4221633728, 1238922906, 430763890},
				A:   [7]uint32{433304354, 710161134, 2850301888, 2789591379, 2675663443, 4207359874, 1199857078},
				PC:  9883686,
				SR:  1306,
				USP: 9499176,
				SSP: 8718830,
				RAM: [][2]uint32{{9883680, 220}, {9883681, 215}, {9883682, 118}, {9883683, 158}, {9499176, 182}, {9499177, 95}, {9883684, 56}, {9883685, 5}},
				Cycles: 12,
			},
		},
		{
			name: "339 ADDA.w A2, A6 dcca",
			init: 			cpuState{
				D:   [8]uint32{707683760, 3549615504, 4280647966, 1626992854, 3746317752, 1346304983, 2247616360, 4146468265},
				A:   [7]uint32{3060871318, 3742611327, 2371348251, 3880308626, 1142109748, 2402401056, 1777346572},
				PC:  3297704,
				SR:  9486,
				USP: 1266516,
				SSP: 4996370,
				RAM: [][2]uint32{{3297700, 220}, {3297701, 202}, {3297702, 44}, {3297703, 139}, {3297704, 105}, {3297705, 86}},
			},
			want: 			cpuState{
				D:   [8]uint32{707683760, 3549615504, 4280647966, 1626992854, 3746317752, 1346304983, 2247616360, 4146468265},
				A:   [7]uint32{3060871318, 3742611327, 2371348251, 3880308626, 1142109748, 2402401056, 1777340199},
				PC:  3297706,
				SR:  9486,
				USP: 1266516,
				SSP: 4996370,
				RAM: [][2]uint32{{3297700, 220}, {3297701, 202}, {3297702, 44}, {3297703, 139}, {3297704, 105}, {3297705, 86}},
				Cycles: 8,
			},
		},
		{
			name: "631 ADDA.w -(A0), A3 d6e0",
			init: 			cpuState{
				D:   [8]uint32{1113236890, 3127938664, 3539356076, 2056831417, 1566706998, 1328335152, 400848131, 2011303033},
				A:   [7]uint32{3174377272, 2146046779, 2770597037, 341010261, 3387770661, 4253134297, 1783265068},
				PC:  14515012,
				SR:  8705,
				USP: 8336244,
				SSP: 15643144,
				RAM: [][2]uint32{{14515008, 214}, {14515009, 224}, {14515010, 229}, {14515011, 25}, {3483446, 224}, {3483447, 164}, {14515012, 228}, {14515013, 12}},
			},
			want: 			cpuState{
				D:   [8]uint32{1113236890, 3127938664, 3539356076, 2056831417, 1566706998, 1328335152, 400848131, 2011303033},
				A:   [7]uint32{3174377270, 2146046779, 2770597037, 341002233, 3387770661, 4253134297, 1783265068},
				PC:  14515014,
				SR:  8705,
				USP: 8336244,
				SSP: 15643144,
				RAM: [][2]uint32{{14515008, 214}, {14515009, 224}, {14515010, 229}, {14515011, 25}, {3483446, 224}, {3483447, 164}, {14515012, 228}, {14515013, 12}},
				Cycles: 14,
			},
		},
		{
			name: "907 ADDA.w (d16, PC), A2 d4fa",
			init: 			cpuState{
				D:   [8]uint32{3750422780, 1207726820, 2810159850, 2951392810, 3804696854, 2172810627, 2655545711, 203997804},
				A:   [7]uint32{274022984, 1457161048, 1805744314, 518521549, 2153255433, 1494179373, 784089095},
				PC:  16092650,
				SR:  8728,
				USP: 2120216,
				SSP: 10877662,
				RAM: [][2]uint32{{16092646, 212}, {16092647, 250}, {16092648, 142}, {16092649, 126}, {16092650, 105}, {16092651, 163}, {16063590, 231}, {16063591, 52}, {16092652, 38}, {16092653, 132}},
			},
			want: 			cpuState{
				D:   [8]uint32{3750422780, 1207726820, 2810159850, 2951392810, 3804696854, 2172810627, 2655545711, 203997804},
				A:   [7]uint32{274022984, 1457161048, 1805737966, 518521549, 2153255433, 1494179373, 784089095},
				PC:  16092654,
				SR:  8728,
				USP: 2120216,
				SSP: 10877662,
				RAM: [][2]uint32{{16092646, 212}, {16092647, 250}, {16092648, 142}, {16092649, 126}, {16092650, 105}, {16092651, 163}, {16063590, 231}, {16063591, 52}, {16092652, 38}, {16092653, 132}},
				Cycles: 16,
			},
		},
		{
			name: "1160 ADDA.w A1, A0 d0c9",
			init: 			cpuState{
				D:   [8]uint32{3868884851, 2880254116, 1969576233, 1689281874, 642106091, 2131911275, 2208069205, 34890837},
				A:   [7]uint32{663409681, 2391025656, 2849763674, 1406332443, 2015448200, 299054847, 1354108594},
				PC:  16261302,
				SR:  1557,
				USP: 7762466,
				SSP: 3647774,
				RAM: [][2]uint32{{16261298, 208}, {16261299, 201}, {16261300, 30}, {16261301, 32}, {16261302, 9}, {16261303, 69}},
			},
			want: 			cpuState{
				D:   [8]uint32{3868884851, 2880254116, 1969576233, 1689281874, 642106091, 2131911275, 2208069205, 34890837},
				A:   [7]uint32{663419913, 2391025656, 2849763674, 1406332443, 2015448200, 299054847, 1354108594},
				PC:  16261304,
				SR:  1557,
				USP: 7762466,
				SSP: 3647774,
				RAM: [][2]uint32{{16261298, 208}, {16261299, 201}, {16261300, 30}, {16261301, 32}, {16261302, 9}, {16261303, 69}},
				Cycles: 8,
			},
		},
		{
			name: "1411 ADDA.w A4, A5 dacc",
			init: 			cpuState{
				D:   [8]uint32{2688198470, 1488745576, 1369243638, 2641767410, 3182248995, 3436886975, 1395959784, 2317928935},
				A:   [7]uint32{785669550, 2481668801, 3843258323, 1254743972, 4024017152, 3885731556, 2137919284},
				PC:  1538966,
				SR:  9230,
				USP: 54952,
				SSP: 14938434,
				RAM: [][2]uint32{{1538962, 218}, {1538963, 204}, {1538964, 139}, {1538965, 157}, {1538966, 217}, {1538967, 98}},
			},
			want: 			cpuState{
				D:   [8]uint32{2688198470, 1488745576, 1369243638, 2641767410, 3182248995, 3436886975, 1395959784, 2317928935},
				A:   [7]uint32{785669550, 2481668801, 3843258323, 1254743972, 4024017152, 3885707236, 2137919284},
				PC:  1538968,
				SR:  9230,
				USP: 54952,
				SSP: 14938434,
				RAM: [][2]uint32{{1538962, 218}, {1538963, 204}, {1538964, 139}, {1538965, 157}, {1538966, 217}, {1538967, 98}},
				Cycles: 8,
			},
		},
		{
			name: "1659 ADDA.w -(A5), A5 dae5",
			init: 			cpuState{
				D:   [8]uint32{433348854, 3697727544, 1014761428, 1107699857, 3484567933, 2266683579, 3050053734, 354498168},
				A:   [7]uint32{1704916506, 3610442226, 1886833484, 3419580527, 2470648320, 2977867426, 2568366319},
				PC:  4233832,
				SR:  277,
				USP: 11768890,
				SSP: 7954714,
				RAM: [][2]uint32{{4233828, 218}, {4233829, 229}, {4233830, 68}, {4233831, 150}, {8300192, 219}, {8300193, 170}, {4233832, 240}, {4233833, 224}},
			},
			want: 			cpuState{
				D:   [8]uint32{433348854, 3697727544, 1014761428, 1107699857, 3484567933, 2266683579, 3050053734, 354498168},
				A:   [7]uint32{1704916506, 3610442226, 1886833484, 3419580527, 2470648320, 2977858122, 2568366319},
				PC:  4233834,
				SR:  277,
				USP: 11768890,
				SSP: 7954714,
				RAM: [][2]uint32{{4233828, 218}, {4233829, 229}, {4233830, 68}, {4233831, 150}, {8300192, 219}, {8300193, 170}, {4233832, 240}, {4233833, 224}},
				Cycles: 14,
			},
		},
		{
			name: "1938 ADDA.w (d16, A6), A5 daee",
			init: 			cpuState{
				D:   [8]uint32{242754475, 4025084368, 2942214048, 2438240444, 238408713, 1319070277, 462033119, 1412160605},
				A:   [7]uint32{3711621262, 381447865, 943106303, 3975843860, 1502160554, 446712275, 2004745107},
				PC:  14205654,
				SR:  780,
				USP: 9985658,
				SSP: 11931964,
				RAM: [][2]uint32{{14205650, 218}, {14205651, 238}, {14205652, 144}, {14205653, 239}, {14205654, 149}, {14205655, 241}, {8227970, 17}, {8227971, 221}, {14205656, 210}, {14205657, 171}},
			},
			want: 			cpuState{
				D:   [8]uint32{242754475, 4025084368, 2942214048, 2438240444, 238408713, 1319070277, 462033119, 1412160605},
				A:   [7]uint32{3711621262, 381447865, 943106303, 3975843860, 1502160554, 446716848, 2004745107},
				PC:  14205658,
				SR:  780,
				USP: 9985658,
				SSP: 11931964,
				RAM: [][2]uint32{{14205650, 218}, {14205651, 238}, {14205652, 144}, {14205653, 239}, {14205654, 149}, {14205655, 241}, {8227970, 17}, {8227971, 221}, {14205656, 210}, {14205657, 171}},
				Cycles: 16,
			},
		},
		{
			name: "2216 ADDA.w A0, A2 d4c8",
			init: 			cpuState{
				D:   [8]uint32{1306206568, 2088815117, 2331164484, 2376432823, 1596930818, 4222077531, 3591960566, 1024002429},
				A:   [7]uint32{1603306311, 2325425442, 1966203223, 535744941, 3165302471, 1890202602, 4063000699},
				PC:  2022638,
				SR:  537,
				USP: 5680388,
				SSP: 1240466,
				RAM: [][2]uint32{{2022634, 212}, {2022635, 200}, {2022636, 10}, {2022637, 150}, {2022638, 115}, {2022639, 124}},
			},
			want: 			cpuState{
				D:   [8]uint32{1306206568, 2088815117, 2331164484, 2376432823, 1596930818, 4222077531, 3591960566, 1024002429},
				A:   [7]uint32{1603306311, 2325425442, 1966171294, 535744941, 3165302471, 1890202602, 4063000699},
				PC:  2022640,
				SR:  537,
				USP: 5680388,
				SSP: 1240466,
				RAM: [][2]uint32{{2022634, 212}, {2022635, 200}, {2022636, 10}, {2022637, 150}, {2022638, 115}, {2022639, 124}},
				Cycles: 8,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestADDA_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ADDA.l (d16, A6), A6 ddee",
			init: cpuState{
				D:   [8]uint32{601553886, 3882265256, 4081024186, 3333190385, 226977110, 1489897429, 129445653, 2806454671},
				A:   [7]uint32{4046042593, 3262263489, 483918555, 4268878349, 560546210, 1619534125, 1069688090},
				PC:  7360406,
				SR:  34322,
				USP: 9316066,
				SSP: 7938836,
				RAM: [][2]uint32{{7360402, 221}, {7360403, 238}, {7360404, 156}, {7360405, 78}, {7360406, 72}, {7360407, 59}, {12697960, 175}, {12697961, 240}, {12697962, 211}, {12697963, 198}, {7360408, 106}, {7360409, 130}},
			},
			want: cpuState{
				D:   [8]uint32{601553886, 3882265256, 4081024186, 3333190385, 226977110, 1489897429, 129445653, 2806454671},
				A:   [7]uint32{4046042593, 3262263489, 483918555, 4268878349, 560546210, 1619534125, 4021483744},
				PC:  7360410,
				SR:  34322,
				USP: 9316066,
				SSP: 7938836,
				RAM: [][2]uint32{{7360402, 221}, {7360403, 238}, {7360404, 156}, {7360405, 78}, {7360406, 72}, {7360407, 59}, {12697960, 175}, {12697961, 240}, {12697962, 211}, {12697963, 198}, {7360408, 106}, {7360409, 130}},
				Cycles: 18,
			},
		},
		{
			name: "500 ADDA.l A5, A7 dfcd",
			init: cpuState{
				D:   [8]uint32{325425224, 2165434707, 4022750909, 4120326758, 4103400145, 1506280071, 1999615348, 709136770},
				A:   [7]uint32{2135957202, 1644677255, 4110620975, 798277481, 72951212, 2085279858, 3048835118},
				PC:  6300614,
				SR:  41240,
				USP: 6383252,
				SSP: 1977036,
				RAM: [][2]uint32{{6300610, 223}, {6300611, 205}, {6300612, 186}, {6300613, 173}, {6300614, 212}, {6300615, 157}},
			},
			want: cpuState{
				D:   [8]uint32{325425224, 2165434707, 4022750909, 4120326758, 4103400145, 1506280071, 1999615348, 709136770},
				A:   [7]uint32{2135957202, 1644677255, 4110620975, 798277481, 72951212, 2085279858, 3048835118},
				PC:  6300616,
				SR:  41240,
				USP: 6383252,
				SSP: 2087256894,
				RAM: [][2]uint32{{6300610, 223}, {6300611, 205}, {6300612, 186}, {6300613, 173}, {6300614, 212}, {6300615, 157}},
				Cycles: 8,
			},
		},
		{
			name: "1000 ADDA.l -(A4), A3 d7e4",
			init: cpuState{
				D:   [8]uint32{1014014963, 1927771678, 383380099, 1616418368, 101374157, 1392850973, 996040081, 3782587050},
				A:   [7]uint32{1957885287, 2124181366, 2911731850, 341525497, 2637370931, 3171271031, 3677820347},
				PC:  1819318,
				SR:  34568,
				USP: 879188,
				SSP: 10576816,
				RAM: [][2]uint32{{1819314, 215}, {1819315, 228}, {1819316, 230}, {1819317, 1}, {12, 21}, {13, 98}, {14, 204}, {15, 80}, {6474832, 25}, {6474833, 70}, {6474834, 68}, {6474835, 63}},
			},
			want: cpuState{
				D:      [8]uint32{1014014963, 1927771678, 383380099, 1616418368, 101374157, 1392850973, 996040081, 3782587050},
				A:      [7]uint32{1957885287, 2124181366, 2911731850, 341525497, 2637370927, 3171271031, 3677820347},
				PC:     358796372,
				SR:     9992,
				USP:    879188,
				SSP:    10576802,
				RAM:    [][2]uint32{{1819314, 215}, {1819315, 228}, {1819316, 230}, {1819317, 1}, {10576814, 194}, {10576815, 180}, {10576810, 135}, {10576811, 8}, {10576812, 0}, {10576813, 27}, {10576808, 215}, {10576809, 228}, {10576806, 22}, {10576807, 47}, {10576802, 215}, {10576803, 241}, {10576804, 157}, {10576805, 51}, {12, 21}, {13, 98}, {14, 204}, {15, 80}, {6474832, 25}, {6474833, 70}, {6474834, 68}, {6474835, 63}},
				Halted: true,
			},
		},
		{
			name: "1500 ADDA.l (A7), A5 dbd7",
			init: cpuState{
				D:   [8]uint32{1522638056, 984977510, 3739777633, 1430309213, 2406156165, 820282274, 1707776302, 688914386},
				A:   [7]uint32{2833190671, 1627302379, 1442590570, 1781265011, 385127715, 1481129180, 186978221},
				PC:  11317120,
				SR:  9486,
				USP: 1798798,
				SSP: 13358862,
				RAM: [][2]uint32{{11317116, 219}, {11317117, 215}, {11317118, 112}, {11317119, 230}, {13358862, 223}, {13358863, 26}, {13358864, 168}, {13358865, 20}, {11317120, 234}, {11317121, 5}},
			},
			want: cpuState{
				D:   [8]uint32{1522638056, 984977510, 3739777633, 1430309213, 2406156165, 820282274, 1707776302, 688914386},
				A:   [7]uint32{2833190671, 1627302379, 1442590570, 1781265011, 385127715, 929228016, 186978221},
				PC:  11317122,
				SR:  9486,
				USP: 1798798,
				SSP: 13358862,
				RAM: [][2]uint32{{11317116, 219}, {11317117, 215}, {11317118, 112}, {11317119, 230}, {13358862, 223}, {13358863, 26}, {13358864, 168}, {13358865, 20}, {11317120, 234}, {11317121, 5}},
				Cycles: 14,
			},
		},
		{
			name: "2000 ADDA.l A7, A4 d9cf",
			init: cpuState{
				D:   [8]uint32{3696740116, 2987940164, 3097721049, 3664448355, 775441488, 2051348306, 858378600, 1143879448},
				A:   [7]uint32{867382973, 4084847420, 592599200, 1644751001, 2064749223, 1791485335, 625353196},
				PC:  14728864,
				SR:  41218,
				USP: 9934714,
				SSP: 6552504,
				RAM: [][2]uint32{{14728860, 217}, {14728861, 207}, {14728862, 151}, {14728863, 128}, {14728864, 34}, {14728865, 178}},
			},
			want: cpuState{
				D:   [8]uint32{3696740116, 2987940164, 3097721049, 3664448355, 775441488, 2051348306, 858378600, 1143879448},
				A:   [7]uint32{867382973, 4084847420, 592599200, 1644751001, 2071301727, 1791485335, 625353196},
				PC:  14728866,
				SR:  41218,
				USP: 9934714,
				SSP: 6552504,
				RAM: [][2]uint32{{14728860, 217}, {14728861, 207}, {14728862, 151}, {14728863, 128}, {14728864, 34}, {14728865, 178}},
				Cycles: 8,
			},
		},
		{
			name: "002 ADDA.l -(A4), A2 d5e4",
			init: 			cpuState{
				D:   [8]uint32{1340742914, 68833977, 4281764448, 2386594667, 1629481901, 2738347457, 1132593203, 122318442},
				A:   [7]uint32{2196839384, 38618320, 2180683271, 191923568, 2834429824, 904682738, 3537753439},
				PC:  1908338,
				SR:  525,
				USP: 13806942,
				SSP: 8460970,
				RAM: [][2]uint32{{1908334, 213}, {1908335, 228}, {1908336, 232}, {1908337, 242}, {15857532, 214}, {15857533, 78}, {15857534, 156}, {15857535, 6}, {1908338, 54}, {1908339, 142}},
			},
			want: 			cpuState{
				D:   [8]uint32{1340742914, 68833977, 4281764448, 2386594667, 1629481901, 2738347457, 1132593203, 122318442},
				A:   [7]uint32{2196839384, 38618320, 1481191949, 191923568, 2834429820, 904682738, 3537753439},
				PC:  1908340,
				SR:  525,
				USP: 13806942,
				SSP: 8460970,
				RAM: [][2]uint32{{1908334, 213}, {1908335, 228}, {1908336, 232}, {1908337, 242}, {15857532, 214}, {15857533, 78}, {15857534, 156}, {15857535, 6}, {1908338, 54}, {1908339, 142}},
				Cycles: 16,
			},
		},
		{
			name: "257 ADDA.l A2, A3 d7ca",
			init: 			cpuState{
				D:   [8]uint32{1487616484, 2960996053, 400314151, 1599137743, 108365191, 2715479133, 321380583, 3863819894},
				A:   [7]uint32{3562009092, 3149409636, 1451433139, 1799790145, 242866464, 1219840332, 951994805},
				PC:  13569922,
				SR:  25,
				USP: 3588908,
				SSP: 6234852,
				RAM: [][2]uint32{{13569918, 215}, {13569919, 202}, {13569920, 212}, {13569921, 190}, {13569922, 94}, {13569923, 30}},
			},
			want: 			cpuState{
				D:   [8]uint32{1487616484, 2960996053, 400314151, 1599137743, 108365191, 2715479133, 321380583, 3863819894},
				A:   [7]uint32{3562009092, 3149409636, 1451433139, 3251223284, 242866464, 1219840332, 951994805},
				PC:  13569924,
				SR:  25,
				USP: 3588908,
				SSP: 6234852,
				RAM: [][2]uint32{{13569918, 215}, {13569919, 202}, {13569920, 212}, {13569921, 190}, {13569922, 94}, {13569923, 30}},
				Cycles: 8,
			},
		},
		{
			name: "541 ADDA.l (d16, A2), A5 dbea",
			init: 			cpuState{
				D:   [8]uint32{4228746463, 410720642, 76241724, 3246756226, 3015216244, 310288661, 2870019312, 58489199},
				A:   [7]uint32{2423751374, 943694124, 3788346088, 2165501598, 1742002997, 2164512814, 3107335781},
				PC:  14132106,
				SR:  8217,
				USP: 1239778,
				SSP: 1966550,
				RAM: [][2]uint32{{14132102, 219}, {14132103, 234}, {14132104, 137}, {14132105, 146}, {14132106, 104}, {14132107, 87}, {13442170, 190}, {13442171, 9}, {13442172, 65}, {13442173, 80}, {14132108, 162}, {14132109, 167}},
			},
			want: 			cpuState{
				D:   [8]uint32{4228746463, 410720642, 76241724, 3246756226, 3015216244, 310288661, 2870019312, 58489199},
				A:   [7]uint32{2423751374, 943694124, 3788346088, 2165501598, 1742002997, 1057823102, 3107335781},
				PC:  14132110,
				SR:  8217,
				USP: 1239778,
				SSP: 1966550,
				RAM: [][2]uint32{{14132102, 219}, {14132103, 234}, {14132104, 137}, {14132105, 146}, {14132106, 104}, {14132107, 87}, {13442170, 190}, {13442171, 9}, {13442172, 65}, {13442173, 80}, {14132108, 162}, {14132109, 167}},
				Cycles: 18,
			},
		},
		{
			name: "828 ADDA.l (A5), A4 d9d5",
			init: 			cpuState{
				D:   [8]uint32{480118697, 1029968380, 3373049266, 1576301087, 904334553, 3329602745, 3065044315, 280022199},
				A:   [7]uint32{1175476573, 3715095794, 3011157237, 984332144, 1638022925, 856255452, 3897981819},
				PC:  13616600,
				SR:  8206,
				USP: 16252134,
				SSP: 13811480,
				RAM: [][2]uint32{{13616596, 217}, {13616597, 213}, {13616598, 120}, {13616599, 84}, {617436, 233}, {617437, 255}, {617438, 59}, {617439, 224}, {13616600, 209}, {13616601, 232}},
			},
			want: 			cpuState{
				D:   [8]uint32{480118697, 1029968380, 3373049266, 1576301087, 904334553, 3329602745, 3065044315, 280022199},
				A:   [7]uint32{1175476573, 3715095794, 3011157237, 984332144, 1268873965, 856255452, 3897981819},
				PC:  13616602,
				SR:  8206,
				USP: 16252134,
				SSP: 13811480,
				RAM: [][2]uint32{{13616596, 217}, {13616597, 213}, {13616598, 120}, {13616599, 84}, {617436, 233}, {617437, 255}, {617438, 59}, {617439, 224}, {13616600, 209}, {13616601, 232}},
				Cycles: 14,
			},
		},
		{
			name: "1126 ADDA.l D2, A3 d7c2",
			init: 			cpuState{
				D:   [8]uint32{2597680481, 2323312660, 967292172, 1283428560, 3940646157, 944551861, 3082667640, 1607808905},
				A:   [7]uint32{1831061435, 2088648503, 3559199229, 2560993329, 1293842782, 3848981337, 945834463},
				PC:  15046394,
				SR:  9474,
				USP: 13131388,
				SSP: 4503108,
				RAM: [][2]uint32{{15046390, 215}, {15046391, 194}, {15046392, 9}, {15046393, 238}, {15046394, 139}, {15046395, 154}},
			},
			want: 			cpuState{
				D:   [8]uint32{2597680481, 2323312660, 967292172, 1283428560, 3940646157, 944551861, 3082667640, 1607808905},
				A:   [7]uint32{1831061435, 2088648503, 3559199229, 3528285501, 1293842782, 3848981337, 945834463},
				PC:  15046396,
				SR:  9474,
				USP: 13131388,
				SSP: 4503108,
				RAM: [][2]uint32{{15046390, 215}, {15046391, 194}, {15046392, 9}, {15046393, 238}, {15046394, 139}, {15046395, 154}},
				Cycles: 8,
			},
		},
		{
			name: "1394 ADDA.l (d8, A7, Xn), A0 d1f7",
			init: 			cpuState{
				D:   [8]uint32{1643838747, 3624280582, 296901452, 1275028574, 558886319, 1218748418, 3828499530, 3042650732},
				A:   [7]uint32{1070337572, 3324746885, 3117993305, 3845600965, 2016002303, 238940726, 2103835240},
				PC:  6822886,
				SR:  1025,
				USP: 13098032,
				SSP: 3033768,
				RAM: [][2]uint32{{6822882, 209}, {6822883, 247}, {6822884, 126}, {6822885, 120}, {6822886, 164}, {6822887, 33}, {2295572, 211}, {2295573, 6}, {2295574, 113}, {2295575, 130}, {6822888, 132}, {6822889, 77}},
			},
			want: 			cpuState{
				D:   [8]uint32{1643838747, 3624280582, 296901452, 1275028574, 558886319, 1218748418, 3828499530, 3042650732},
				A:   [7]uint32{315785126, 3324746885, 3117993305, 3845600965, 2016002303, 238940726, 2103835240},
				PC:  6822890,
				SR:  1025,
				USP: 13098032,
				SSP: 3033768,
				RAM: [][2]uint32{{6822882, 209}, {6822883, 247}, {6822884, 126}, {6822885, 120}, {6822886, 164}, {6822887, 33}, {2295572, 211}, {2295573, 6}, {2295574, 113}, {2295575, 130}, {6822888, 132}, {6822889, 77}},
				Cycles: 20,
			},
		},
		{
			name: "1643 ADDA.l D3, A2 d5c3",
			init: 			cpuState{
				D:   [8]uint32{3930417043, 2713198132, 2858943429, 3350926142, 349328663, 1087787213, 1772079073, 876333432},
				A:   [7]uint32{3569950943, 1975404292, 1561506176, 2045901683, 2549218627, 973975504, 4077150889},
				PC:  7688818,
				SR:  9474,
				USP: 7214522,
				SSP: 14262796,
				RAM: [][2]uint32{{7688814, 213}, {7688815, 195}, {7688816, 55}, {7688817, 10}, {7688818, 100}, {7688819, 98}},
			},
			want: 			cpuState{
				D:   [8]uint32{3930417043, 2713198132, 2858943429, 3350926142, 349328663, 1087787213, 1772079073, 876333432},
				A:   [7]uint32{3569950943, 1975404292, 617465022, 2045901683, 2549218627, 973975504, 4077150889},
				PC:  7688820,
				SR:  9474,
				USP: 7214522,
				SSP: 14262796,
				RAM: [][2]uint32{{7688814, 213}, {7688815, 195}, {7688816, 55}, {7688817, 10}, {7688818, 100}, {7688819, 98}},
				Cycles: 8,
			},
		},
		{
			name: "1959 ADDA.l D0, A3 d7c0",
			init: 			cpuState{
				D:   [8]uint32{3876287287, 4008188982, 4245852740, 1231629987, 3880573491, 2345825315, 3097033245, 142423182},
				A:   [7]uint32{330374727, 3145703473, 2092606854, 3719155186, 1760373026, 1184264549, 2296025800},
				PC:  16421718,
				SR:  8721,
				USP: 4542166,
				SSP: 10081956,
				RAM: [][2]uint32{{16421714, 215}, {16421715, 192}, {16421716, 232}, {16421717, 214}, {16421718, 255}, {16421719, 14}},
			},
			want: 			cpuState{
				D:   [8]uint32{3876287287, 4008188982, 4245852740, 1231629987, 3880573491, 2345825315, 3097033245, 142423182},
				A:   [7]uint32{330374727, 3145703473, 2092606854, 3300475177, 1760373026, 1184264549, 2296025800},
				PC:  16421720,
				SR:  8721,
				USP: 4542166,
				SSP: 10081956,
				RAM: [][2]uint32{{16421714, 215}, {16421715, 192}, {16421716, 232}, {16421717, 214}, {16421718, 255}, {16421719, 14}},
				Cycles: 8,
			},
		},
		{
			name: "2255 ADDA.l A0, A2 d5c8",
			init: 			cpuState{
				D:   [8]uint32{1954798838, 3430783186, 2299380636, 3877144551, 3316330322, 3288370043, 2115020560, 3971528185},
				A:   [7]uint32{290633542, 3276538963, 1582032088, 3915901070, 3718559500, 1312610157, 482192341},
				PC:  14701398,
				SR:  8723,
				USP: 12348572,
				SSP: 12918674,
				RAM: [][2]uint32{{14701394, 213}, {14701395, 200}, {14701396, 201}, {14701397, 181}, {14701398, 143}, {14701399, 72}},
			},
			want: 			cpuState{
				D:   [8]uint32{1954798838, 3430783186, 2299380636, 3877144551, 3316330322, 3288370043, 2115020560, 3971528185},
				A:   [7]uint32{290633542, 3276538963, 1872665630, 3915901070, 3718559500, 1312610157, 482192341},
				PC:  14701400,
				SR:  8723,
				USP: 12348572,
				SSP: 12918674,
				RAM: [][2]uint32{{14701394, 213}, {14701395, 200}, {14701396, 201}, {14701397, 181}, {14701398, 143}, {14701399, 72}},
				Cycles: 8,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestADDX_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ADDX.b D2, D3 d702",
			init: cpuState{
				D:   [8]uint32{44548103, 261823688, 2324915324, 4058951795, 1544780998, 104217652, 2555894768, 1341936939},
				A:   [7]uint32{230480667, 3437772131, 3037520413, 2374507427, 2278188298, 4056559490, 2377918318},
				PC:  6052604,
				SR:  34311,
				USP: 9835192,
				SSP: 12857820,
				RAM: [][2]uint32{{6052600, 215}, {6052601, 2}, {6052602, 99}, {6052603, 194}, {6052604, 10}, {6052605, 42}},
			},
			want: cpuState{
				D:   [8]uint32{44548103, 261823688, 2324915324, 4058951919, 1544780998, 104217652, 2555894768, 1341936939},
				A:   [7]uint32{230480667, 3437772131, 3037520413, 2374507427, 2278188298, 4056559490, 2377918318},
				PC:  6052606,
				SR:  34314,
				USP: 9835192,
				SSP: 12857820,
				RAM: [][2]uint32{{6052600, 215}, {6052601, 2}, {6052602, 99}, {6052603, 194}, {6052604, 10}, {6052605, 42}},
				Cycles: 4,
			},
		},
		{
			name: "500 ADDX.b D6, D2 d506",
			init: cpuState{
				D:   [8]uint32{1758749811, 2649764283, 1154568341, 2821009687, 2908759639, 2212884726, 3358355161, 1172285619},
				A:   [7]uint32{855896303, 4289596540, 2949982655, 606413390, 3147955411, 4039921642, 291843211},
				PC:  4802834,
				SR:  1054,
				USP: 15169706,
				SSP: 12605438,
				RAM: [][2]uint32{{4802830, 213}, {4802831, 6}, {4802832, 17}, {4802833, 129}, {4802834, 54}, {4802835, 221}},
			},
			want: cpuState{
				D:   [8]uint32{1758749811, 2649764283, 1154568303, 2821009687, 2908759639, 2212884726, 3358355161, 1172285619},
				A:   [7]uint32{855896303, 4289596540, 2949982655, 606413390, 3147955411, 4039921642, 291843211},
				PC:  4802836,
				SR:  1043,
				USP: 15169706,
				SSP: 12605438,
				RAM: [][2]uint32{{4802830, 213}, {4802831, 6}, {4802832, 17}, {4802833, 129}, {4802834, 54}, {4802835, 221}},
				Cycles: 4,
			},
		},
		{
			name: "1000 ADDX.b D2, D0 d102",
			init: cpuState{
				D:   [8]uint32{1791248072, 3603890067, 1211474062, 1740990572, 2600245656, 3032994918, 1491369759, 302012029},
				A:   [7]uint32{127453526, 2073325692, 2744519054, 190396329, 2548142277, 154819654, 1875055831},
				PC:  11170676,
				SR:  42259,
				USP: 5722486,
				SSP: 15820602,
				RAM: [][2]uint32{{11170672, 209}, {11170673, 2}, {11170674, 12}, {11170675, 251}, {11170676, 193}, {11170677, 128}},
			},
			want: cpuState{
				D:   [8]uint32{1791247959, 3603890067, 1211474062, 1740990572, 2600245656, 3032994918, 1491369759, 302012029},
				A:   [7]uint32{127453526, 2073325692, 2744519054, 190396329, 2548142277, 154819654, 1875055831},
				PC:  11170678,
				SR:  42259,
				USP: 5722486,
				SSP: 15820602,
				RAM: [][2]uint32{{11170672, 209}, {11170673, 2}, {11170674, 12}, {11170675, 251}, {11170676, 193}, {11170677, 128}},
				Cycles: 4,
			},
		},
		{
			name: "1500 ADDX.b D6, D6 dd06",
			init: cpuState{
				D:   [8]uint32{1610852722, 2630499302, 202837656, 1694622764, 4133252871, 3595479717, 2740374934, 3590640564},
				A:   [7]uint32{2526809391, 2437997017, 1425815587, 1408663465, 517666581, 1048937585, 3219207909},
				PC:  1266682,
				SR:  517,
				USP: 11347356,
				SSP: 11774022,
				RAM: [][2]uint32{{1266678, 221}, {1266679, 6}, {1266680, 56}, {1266681, 229}, {1266682, 255}, {1266683, 216}},
			},
			want: cpuState{
				D:   [8]uint32{1610852722, 2630499302, 202837656, 1694622764, 4133252871, 3595479717, 2740374828, 3590640564},
				A:   [7]uint32{2526809391, 2437997017, 1425815587, 1408663465, 517666581, 1048937585, 3219207909},
				PC:  1266684,
				SR:  531,
				USP: 11347356,
				SSP: 11774022,
				RAM: [][2]uint32{{1266678, 221}, {1266679, 6}, {1266680, 56}, {1266681, 229}, {1266682, 255}, {1266683, 216}},
				Cycles: 4,
			},
		},
		{
			name: "2000 ADDX.b -(A7), -(A2) d50f",
			init: cpuState{
				D:   [8]uint32{2084856921, 495120043, 994623979, 4199543528, 1697110441, 1284568835, 682106535, 115719222},
				A:   [7]uint32{674489008, 2067737516, 1137699686, 2629200295, 1335284620, 4174141166, 2033007142},
				PC:  11012722,
				SR:  30,
				USP: 16376360,
				SSP: 11120104,
				RAM: [][2]uint32{{11012718, 213}, {11012719, 15}, {11012720, 88}, {11012721, 43}, {16376358, 66}, {16376359, 80}, {13626212, 53}, {13626213, 220}, {11012722, 168}, {11012723, 238}},
			},
			want: cpuState{
				D:   [8]uint32{2084856921, 495120043, 994623979, 4199543528, 1697110441, 1284568835, 682106535, 115719222},
				A:   [7]uint32{674489008, 2067737516, 1137699685, 2629200295, 1335284620, 4174141166, 2033007142},
				PC:  11012724,
				SR:  17,
				USP: 16376358,
				SSP: 11120104,
				RAM: [][2]uint32{{11012718, 213}, {11012719, 15}, {11012720, 88}, {11012721, 43}, {16376358, 66}, {16376359, 80}, {13626212, 53}, {13626213, 31}, {11012722, 168}, {11012723, 238}},
				Cycles: 18,
			},
		},
		{
			name: "001 ADDX.b -(A4), -(A2) d50c",
			init: 			cpuState{
				D:   [8]uint32{862026754, 2342926092, 2181246551, 2789726933, 2002585555, 827409454, 4275583063, 3450259253},
				A:   [7]uint32{2153992199, 3034914198, 2300247296, 1747144140, 561913449, 4291197452, 4100107629},
				PC:  6456418,
				SR:  1293,
				USP: 12401050,
				SSP: 7631848,
				RAM: [][2]uint32{{6456414, 213}, {6456415, 12}, {6456416, 43}, {6456417, 50}, {8265320, 8}, {8265321, 243}, {1768702, 237}, {1768703, 59}, {6456418, 149}, {6456419, 228}},
			},
			want: 			cpuState{
				D:   [8]uint32{862026754, 2342926092, 2181246551, 2789726933, 2002585555, 827409454, 4275583063, 3450259253},
				A:   [7]uint32{2153992199, 3034914198, 2300247295, 1747144140, 561913448, 4291197452, 4100107629},
				PC:  6456420,
				SR:  1280,
				USP: 12401050,
				SSP: 7631848,
				RAM: [][2]uint32{{6456414, 213}, {6456415, 12}, {6456416, 43}, {6456417, 50}, {8265320, 8}, {8265321, 243}, {1768702, 237}, {1768703, 67}, {6456418, 149}, {6456419, 228}},
				Cycles: 18,
			},
		},
		{
			name: "273 ADDX.b -(A7), -(A4) d90f",
			init: 			cpuState{
				D:   [8]uint32{3777178416, 662636378, 3403204126, 4293855118, 1360086906, 3491637852, 2198623814, 3814157844},
				A:   [7]uint32{4255713822, 3845833802, 1178557741, 366868901, 1887872142, 3368764916, 3418719773},
				PC:  16195008,
				SR:  275,
				USP: 4158766,
				SSP: 1683716,
				RAM: [][2]uint32{{16195004, 217}, {16195005, 15}, {16195006, 201}, {16195007, 35}, {4158764, 137}, {4158765, 24}, {8823948, 224}, {8823949, 251}, {16195008, 222}, {16195009, 21}},
			},
			want: 			cpuState{
				D:   [8]uint32{3777178416, 662636378, 3403204126, 4293855118, 1360086906, 3491637852, 2198623814, 3814157844},
				A:   [7]uint32{4255713822, 3845833802, 1178557741, 366868901, 1887872141, 3368764916, 3418719773},
				PC:  16195010,
				SR:  281,
				USP: 4158764,
				SSP: 1683716,
				RAM: [][2]uint32{{16195004, 217}, {16195005, 15}, {16195006, 201}, {16195007, 35}, {4158764, 137}, {4158765, 24}, {8823948, 224}, {8823949, 133}, {16195008, 222}, {16195009, 21}},
				Cycles: 18,
			},
		},
		{
			name: "563 ADDX.b D7, D3 d707",
			init: 			cpuState{
				D:   [8]uint32{2843545693, 100897580, 981202478, 709599259, 2927985622, 2154153906, 1082614313, 982226100},
				A:   [7]uint32{2999109746, 4268086563, 1085856532, 1031387117, 3389841143, 3563626713, 2797070276},
				PC:  14232804,
				SR:  8708,
				USP: 13256732,
				SSP: 2747870,
				RAM: [][2]uint32{{14232800, 215}, {14232801, 7}, {14232802, 8}, {14232803, 163}, {14232804, 80}, {14232805, 4}},
			},
			want: 			cpuState{
				D:   [8]uint32{2843545693, 100897580, 981202478, 709599439, 2927985622, 2154153906, 1082614313, 982226100},
				A:   [7]uint32{2999109746, 4268086563, 1085856532, 1031387117, 3389841143, 3563626713, 2797070276},
				PC:  14232806,
				SR:  8712,
				USP: 13256732,
				SSP: 2747870,
				RAM: [][2]uint32{{14232800, 215}, {14232801, 7}, {14232802, 8}, {14232803, 163}, {14232804, 80}, {14232805, 4}},
				Cycles: 4,
			},
		},
		{
			name: "831 ADDX.b D2, D5 db02",
			init: 			cpuState{
				D:   [8]uint32{1733590870, 2077578734, 2728066003, 1477498549, 2978376075, 2736739057, 1543562587, 500159180},
				A:   [7]uint32{255971071, 344131500, 3735149611, 1920976374, 688231863, 1114769821, 469177834},
				PC:  5473622,
				SR:  1550,
				USP: 11291352,
				SSP: 1944258,
				RAM: [][2]uint32{{5473618, 219}, {5473619, 2}, {5473620, 233}, {5473621, 49}, {5473622, 173}, {5473623, 184}},
			},
			want: 			cpuState{
				D:   [8]uint32{1733590870, 2077578734, 2728066003, 1477498549, 2978376075, 2736739012, 1543562587, 500159180},
				A:   [7]uint32{255971071, 344131500, 3735149611, 1920976374, 688231863, 1114769821, 469177834},
				PC:  5473624,
				SR:  1561,
				USP: 11291352,
				SSP: 1944258,
				RAM: [][2]uint32{{5473618, 219}, {5473619, 2}, {5473620, 233}, {5473621, 49}, {5473622, 173}, {5473623, 184}},
				Cycles: 4,
			},
		},
		{
			name: "1126 ADDX.b -(A3), -(A6) dd0b",
			init: 			cpuState{
				D:   [8]uint32{3243410382, 198617428, 2970027546, 3926433322, 654250652, 785745265, 2674783556, 3321774703},
				A:   [7]uint32{2586280784, 1146648529, 2768942783, 768664411, 3662676479, 3767157691, 3515274903},
				PC:  8376534,
				SR:  1792,
				USP: 14370472,
				SSP: 110954,
				RAM: [][2]uint32{{8376530, 221}, {8376531, 11}, {8376532, 30}, {8376533, 115}, {13689690, 237}, {13689691, 61}, {8836758, 130}, {8836759, 70}, {8376534, 168}, {8376535, 153}},
			},
			want: 			cpuState{
				D:   [8]uint32{3243410382, 198617428, 2970027546, 3926433322, 654250652, 785745265, 2674783556, 3321774703},
				A:   [7]uint32{2586280784, 1146648529, 2768942783, 768664410, 3662676479, 3767157691, 3515274902},
				PC:  8376536,
				SR:  1811,
				USP: 14370472,
				SSP: 110954,
				RAM: [][2]uint32{{8376530, 221}, {8376531, 11}, {8376532, 30}, {8376533, 115}, {13689690, 237}, {13689691, 61}, {8836758, 111}, {8836759, 70}, {8376534, 168}, {8376535, 153}},
				Cycles: 18,
			},
		},
		{
			name: "1385 ADDX.b -(A4), -(A3) d70c",
			init: 			cpuState{
				D:   [8]uint32{2171138470, 2524082486, 558640077, 2336264148, 1508418271, 2059759670, 1733671738, 4031340101},
				A:   [7]uint32{3824217948, 3935086788, 528146349, 2423535675, 4279366040, 1799262763, 641780024},
				PC:  8173538,
				SR:  1822,
				USP: 3979170,
				SSP: 8004962,
				RAM: [][2]uint32{{8173534, 215}, {8173535, 12}, {8173536, 3}, {8173537, 61}, {1175958, 124}, {1175959, 13}, {7616570, 29}, {7616571, 245}, {8173538, 50}, {8173539, 143}},
			},
			want: 			cpuState{
				D:   [8]uint32{2171138470, 2524082486, 558640077, 2336264148, 1508418271, 2059759670, 1733671738, 4031340101},
				A:   [7]uint32{3824217948, 3935086788, 528146349, 2423535674, 4279366039, 1799262763, 641780024},
				PC:  8173540,
				SR:  1792,
				USP: 3979170,
				SSP: 8004962,
				RAM: [][2]uint32{{8173534, 215}, {8173535, 12}, {8173536, 3}, {8173537, 61}, {1175958, 124}, {1175959, 13}, {7616570, 43}, {7616571, 245}, {8173538, 50}, {8173539, 143}},
				Cycles: 18,
			},
		},
		{
			name: "1690 ADDX.b D0, D7 df00",
			init: 			cpuState{
				D:   [8]uint32{1737597440, 3212541361, 2032173082, 1206716071, 3668163656, 412975761, 3479327279, 2669645385},
				A:   [7]uint32{4211413884, 916989035, 859175999, 1579636049, 460361204, 2792642377, 1917633314},
				PC:  1502616,
				SR:  9752,
				USP: 5441300,
				SSP: 8634420,
				RAM: [][2]uint32{{1502612, 223}, {1502613, 0}, {1502614, 187}, {1502615, 47}, {1502616, 255}, {1502617, 74}},
			},
			want: 			cpuState{
				D:   [8]uint32{1737597440, 3212541361, 2032173082, 1206716071, 3668163656, 412975761, 3479327279, 2669645386},
				A:   [7]uint32{4211413884, 916989035, 859175999, 1579636049, 460361204, 2792642377, 1917633314},
				PC:  1502618,
				SR:  9728,
				USP: 5441300,
				SSP: 8634420,
				RAM: [][2]uint32{{1502612, 223}, {1502613, 0}, {1502614, 187}, {1502615, 47}, {1502616, 255}, {1502617, 74}},
				Cycles: 4,
			},
		},
		{
			name: "1985 ADDX.b D1, D6 dd01",
			init: 			cpuState{
				D:   [8]uint32{773671228, 2722276918, 4189378809, 4251251255, 1655764471, 2117033479, 59400913, 1771092989},
				A:   [7]uint32{503591507, 1783149816, 1920327281, 2895586166, 1257249735, 2766683426, 2780933944},
				PC:  8500828,
				SR:  9752,
				USP: 13166098,
				SSP: 9640774,
				RAM: [][2]uint32{{8500824, 221}, {8500825, 1}, {8500826, 131}, {8500827, 223}, {8500828, 43}, {8500829, 187}},
			},
			want: 			cpuState{
				D:   [8]uint32{773671228, 2722276918, 4189378809, 4251251255, 1655764471, 2117033479, 59400712, 1771092989},
				A:   [7]uint32{503591507, 1783149816, 1920327281, 2895586166, 1257249735, 2766683426, 2780933944},
				PC:  8500830,
				SR:  9745,
				USP: 13166098,
				SSP: 9640774,
				RAM: [][2]uint32{{8500824, 221}, {8500825, 1}, {8500826, 131}, {8500827, 223}, {8500828, 43}, {8500829, 187}},
				Cycles: 4,
			},
		},
		{
			name: "2259 ADDX.b D7, D7 df07",
			init: 			cpuState{
				D:   [8]uint32{1087134404, 2942006302, 3038964536, 817538356, 4130725050, 1417799777, 1144817589, 3335044873},
				A:   [7]uint32{1340763991, 2739547367, 3144246779, 4139869399, 2330909951, 1255834408, 3874770536},
				PC:  14104610,
				SR:  9755,
				USP: 10505438,
				SSP: 7734988,
				RAM: [][2]uint32{{14104606, 223}, {14104607, 7}, {14104608, 80}, {14104609, 23}, {14104610, 196}, {14104611, 197}},
			},
			want: 			cpuState{
				D:   [8]uint32{1087134404, 2942006302, 3038964536, 817538356, 4130725050, 1417799777, 1144817589, 3335044883},
				A:   [7]uint32{1340763991, 2739547367, 3144246779, 4139869399, 2330909951, 1255834408, 3874770536},
				PC:  14104612,
				SR:  9728,
				USP: 10505438,
				SSP: 7734988,
				RAM: [][2]uint32{{14104606, 223}, {14104607, 7}, {14104608, 80}, {14104609, 23}, {14104610, 196}, {14104611, 197}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestADDX_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ADDX.w -(A1), -(A0) d149",
			init: cpuState{
				D:   [8]uint32{4224040949, 2022320032, 1925160569, 1739841148, 3920638392, 3871974204, 1202770696, 1059347476},
				A:   [7]uint32{1919114651, 2948124421, 3822682899, 2814065292, 1532911305, 1463532462, 69421316},
				PC:  8735904,
				SR:  8223,
				USP: 7862948,
				SSP: 6686588,
				RAM: [][2]uint32{{8735900, 209}, {8735901, 73}, {8735902, 35}, {8735903, 66}, {12, 79}, {13, 122}, {14, 194}, {15, 70}, {8045126, 176}, {8045127, 215}, {8045128, 230}, {8045129, 159}},
			},
			want: cpuState{
				D:      [8]uint32{4224040949, 2022320032, 1925160569, 1739841148, 3920638392, 3871974204, 1202770696, 1059347476},
				A:      [7]uint32{1919114651, 2948124419, 3822682899, 2814065292, 1532911305, 1463532462, 69421316},
				PC:     1333445194,
				SR:     8223,
				USP:    7862948,
				SSP:    6686574,
				RAM:    [][2]uint32{{8735900, 209}, {8735901, 73}, {8735902, 35}, {8735903, 66}, {6686586, 76}, {6686587, 160}, {6686582, 32}, {6686583, 31}, {6686584, 0}, {6686585, 133}, {6686580, 209}, {6686581, 73}, {6686578, 207}, {6686579, 3}, {6686574, 209}, {6686575, 85}, {6686576, 175}, {6686577, 184}, {12, 79}, {13, 122}, {14, 194}, {15, 70}, {8045126, 176}, {8045127, 215}, {8045128, 230}, {8045129, 159}},
				Halted: true,
			},
		},
		{
			name: "500 ADDX.w D3, D6 dd43",
			init: cpuState{
				D:   [8]uint32{921193556, 3936169273, 3208887717, 369499651, 1795355241, 3057163989, 1176047377, 3441411159},
				A:   [7]uint32{2431475340, 3452238503, 2485025285, 753723195, 3091443919, 3978807955, 2294225276},
				PC:  10917938,
				SR:  34332,
				USP: 2057172,
				SSP: 1280160,
				RAM: [][2]uint32{{10917934, 221}, {10917935, 67}, {10917936, 18}, {10917937, 210}, {10917938, 251}, {10917939, 103}},
			},
			want: cpuState{
				D:   [8]uint32{921193556, 3936169273, 3208887717, 369499651, 1795355241, 3057163989, 1176055061, 3441411159},
				A:   [7]uint32{2431475340, 3452238503, 2485025285, 753723195, 3091443919, 3978807955, 2294225276},
				PC:  10917940,
				SR:  34304,
				USP: 2057172,
				SSP: 1280160,
				RAM: [][2]uint32{{10917934, 221}, {10917935, 67}, {10917936, 18}, {10917937, 210}, {10917938, 251}, {10917939, 103}},
				Cycles: 4,
			},
		},
		{
			name: "1000 ADDX.w -(A0), -(A4) d948",
			init: cpuState{
				D:   [8]uint32{3991951231, 1579443155, 3900364942, 2563991609, 2015557299, 3201390280, 3989341645, 29201898},
				A:   [7]uint32{913281408, 961767058, 47615166, 983406455, 2596001435, 1193193539, 2390382697},
				PC:  12125192,
				SR:  10000,
				USP: 5779338,
				SSP: 11316572,
				RAM: [][2]uint32{{12125188, 217}, {12125189, 72}, {12125190, 44}, {12125191, 204}, {7311742, 123}, {7311743, 67}, {12, 194}, {13, 122}, {14, 49}, {15, 54}, {8007990, 84}, {8007991, 0}, {8007992, 196}, {8007993, 224}},
			},
			want: cpuState{
				D:      [8]uint32{3991951231, 1579443155, 3900364942, 2563991609, 2015557299, 3201390280, 3989341645, 29201898},
				A:      [7]uint32{913281406, 961767058, 47615166, 983406455, 2596001433, 1193193539, 2390382697},
				PC:     3262787898,
				SR:     10000,
				USP:    5779338,
				SSP:    11316558,
				RAM:    [][2]uint32{{12125188, 217}, {12125189, 72}, {12125190, 44}, {12125191, 204}, {7311742, 123}, {7311743, 67}, {11316570, 4}, {11316571, 8}, {11316566, 39}, {11316567, 16}, {11316568, 0}, {11316569, 185}, {11316564, 217}, {11316565, 72}, {11316562, 214}, {11316563, 153}, {11316558, 217}, {11316559, 85}, {11316560, 154}, {11316561, 187}, {12, 194}, {13, 122}, {14, 49}, {15, 54}, {8007990, 84}, {8007991, 0}, {8007992, 196}, {8007993, 224}},
				Halted: true,
			},
		},
		{
			name: "1500 ADDX.w D0, D2 d540",
			init: cpuState{
				D:   [8]uint32{3095417307, 797766886, 1841299555, 429218234, 944155785, 4103913236, 3204259183, 2847506126},
				A:   [7]uint32{1095939720, 3819207191, 2396019033, 3598081810, 487151067, 2039194989, 3283988248},
				PC:  11415672,
				SR:  41733,
				USP: 7137676,
				SSP: 16647184,
				RAM: [][2]uint32{{11415668, 213}, {11415669, 64}, {11415670, 43}, {11415671, 184}, {11415672, 18}, {11415673, 50}},
			},
			want: cpuState{
				D:   [8]uint32{3095417307, 797766886, 1841320510, 429218234, 944155785, 4103913236, 3204259183, 2847506126},
				A:   [7]uint32{1095939720, 3819207191, 2396019033, 3598081810, 487151067, 2039194989, 3283988248},
				PC:  11415674,
				SR:  41728,
				USP: 7137676,
				SSP: 16647184,
				RAM: [][2]uint32{{11415668, 213}, {11415669, 64}, {11415670, 43}, {11415671, 184}, {11415672, 18}, {11415673, 50}},
				Cycles: 4,
			},
		},
		{
			name: "2000 ADDX.w D1, D5 db41",
			init: cpuState{
				D:   [8]uint32{2709841231, 3691936508, 2910150062, 563456753, 3660118800, 4118823669, 3530130283, 1345627357},
				A:   [7]uint32{2388978548, 1813250281, 4211104467, 544864561, 188140976, 1046017600, 3151826148},
				PC:  5267286,
				SR:  9501,
				USP: 10644906,
				SSP: 14222904,
				RAM: [][2]uint32{{5267282, 219}, {5267283, 65}, {5267284, 253}, {5267285, 95}, {5267286, 108}, {5267287, 117}},
			},
			want: cpuState{
				D:   [8]uint32{2709841231, 3691936508, 2910150062, 563456753, 3660118800, 4118855154, 3530130283, 1345627357},
				A:   [7]uint32{2388978548, 1813250281, 4211104467, 544864561, 188140976, 1046017600, 3151826148},
				PC:  5267288,
				SR:  9482,
				USP: 10644906,
				SSP: 14222904,
				RAM: [][2]uint32{{5267282, 219}, {5267283, 65}, {5267284, 253}, {5267285, 95}, {5267286, 108}, {5267287, 117}},
				Cycles: 4,
			},
		},
		{
			name: "001 ADDX.w D6, D1 d346",
			init: 			cpuState{
				D:   [8]uint32{362028726, 421612215, 1073752397, 3115164932, 2754749596, 4050114191, 3981642448, 1596018757},
				A:   [7]uint32{1984451613, 1618354982, 313341779, 1657236012, 1497163880, 1713468719, 3645155931},
				PC:  11921742,
				SR:  9219,
				USP: 12381540,
				SSP: 15025264,
				RAM: [][2]uint32{{11921738, 211}, {11921739, 70}, {11921740, 227}, {11921741, 252}, {11921742, 155}, {11921743, 160}},
			},
			want: 			cpuState{
				D:   [8]uint32{362028726, 421614983, 1073752397, 3115164932, 2754749596, 4050114191, 3981642448, 1596018757},
				A:   [7]uint32{1984451613, 1618354982, 313341779, 1657236012, 1497163880, 1713468719, 3645155931},
				PC:  11921744,
				SR:  9216,
				USP: 12381540,
				SSP: 15025264,
				RAM: [][2]uint32{{11921738, 211}, {11921739, 70}, {11921740, 227}, {11921741, 252}, {11921742, 155}, {11921743, 160}},
				Cycles: 4,
			},
		},
		{
			name: "270 ADDX.w D5, D4 d945",
			init: 			cpuState{
				D:   [8]uint32{874853285, 3867879341, 3390508744, 684554513, 398086483, 3945898841, 3825240299, 1618760051},
				A:   [7]uint32{75962907, 817937608, 4153614758, 742889036, 2824634337, 840725934, 1530781222},
				PC:  5394498,
				SR:  1803,
				USP: 6092620,
				SSP: 11134534,
				RAM: [][2]uint32{{5394494, 217}, {5394495, 69}, {5394496, 182}, {5394497, 170}, {5394498, 92}, {5394499, 51}},
			},
			want: 			cpuState{
				D:   [8]uint32{874853285, 3867879341, 3390508744, 684554513, 398128300, 3945898841, 3825240299, 1618760051},
				A:   [7]uint32{75962907, 817937608, 4153614758, 742889036, 2824634337, 840725934, 1530781222},
				PC:  5394500,
				SR:  1800,
				USP: 6092620,
				SSP: 11134534,
				RAM: [][2]uint32{{5394494, 217}, {5394495, 69}, {5394496, 182}, {5394497, 170}, {5394498, 92}, {5394499, 51}},
				Cycles: 4,
			},
		},
		{
			name: "545 ADDX.w D6, D6 dd46",
			init: 			cpuState{
				D:   [8]uint32{133998324, 42690698, 374766088, 2209471783, 2752088389, 1267359208, 3734159447, 461149700},
				A:   [7]uint32{3648520731, 1694194164, 519786560, 386272448, 1729814769, 148994691, 2153070020},
				PC:  3236640,
				SR:  1793,
				USP: 636814,
				SSP: 3820444,
				RAM: [][2]uint32{{3236636, 221}, {3236637, 70}, {3236638, 88}, {3236639, 54}, {3236640, 98}, {3236641, 146}},
			},
			want: 			cpuState{
				D:   [8]uint32{133998324, 42690698, 374766088, 2209471783, 2752088389, 1267359208, 3734143150, 461149700},
				A:   [7]uint32{3648520731, 1694194164, 519786560, 386272448, 1729814769, 148994691, 2153070020},
				PC:  3236642,
				SR:  1817,
				USP: 636814,
				SSP: 3820444,
				RAM: [][2]uint32{{3236636, 221}, {3236637, 70}, {3236638, 88}, {3236639, 54}, {3236640, 98}, {3236641, 146}},
				Cycles: 4,
			},
		},
		{
			name: "826 ADDX.w D4, D6 dd44",
			init: 			cpuState{
				D:   [8]uint32{2414718422, 2130606472, 329271905, 2418753021, 934089832, 4223008251, 1781199150, 2108802650},
				A:   [7]uint32{2629884410, 919639206, 3444024045, 1331738215, 3678855354, 450003025, 2846611615},
				PC:  10695518,
				SR:  22,
				USP: 13608698,
				SSP: 13349036,
				RAM: [][2]uint32{{10695514, 221}, {10695515, 68}, {10695516, 67}, {10695517, 49}, {10695518, 122}, {10695519, 51}},
			},
			want: 			cpuState{
				D:   [8]uint32{2414718422, 2130606472, 329271905, 2418753021, 934089832, 4223008251, 1781138839, 2108802650},
				A:   [7]uint32{2629884410, 919639206, 3444024045, 1331738215, 3678855354, 450003025, 2846611615},
				PC:  10695520,
				SR:  17,
				USP: 13608698,
				SSP: 13349036,
				RAM: [][2]uint32{{10695514, 221}, {10695515, 68}, {10695516, 67}, {10695517, 49}, {10695518, 122}, {10695519, 51}},
				Cycles: 4,
			},
		},
		{
			name: "1124 ADDX.w D2, D0 d142",
			init: 			cpuState{
				D:   [8]uint32{2027142587, 2018514669, 3298234696, 3993639199, 1044509971, 2837173216, 1905311580, 1278692110},
				A:   [7]uint32{1058514055, 1404712844, 1050056284, 1121674033, 3097943242, 613723108, 3962476334},
				PC:  1970846,
				SR:  9500,
				USP: 7428352,
				SSP: 14027816,
				RAM: [][2]uint32{{1970842, 209}, {1970843, 66}, {1970844, 247}, {1970845, 135}, {1970846, 39}, {1970847, 130}},
			},
			want: 			cpuState{
				D:   [8]uint32{2027147012, 2018514669, 3298234696, 3993639199, 1044509971, 2837173216, 1905311580, 1278692110},
				A:   [7]uint32{1058514055, 1404712844, 1050056284, 1121674033, 3097943242, 613723108, 3962476334},
				PC:  1970848,
				SR:  9480,
				USP: 7428352,
				SSP: 14027816,
				RAM: [][2]uint32{{1970842, 209}, {1970843, 66}, {1970844, 247}, {1970845, 135}, {1970846, 39}, {1970847, 130}},
				Cycles: 4,
			},
		},
		{
			name: "1376 ADDX.w -(A2), -(A2) d54a",
			init: 			cpuState{
				D:   [8]uint32{3795337976, 530235544, 1640766430, 631833014, 3871599733, 1800468454, 2419694757, 1442241328},
				A:   [7]uint32{1763355497, 3394752016, 1810941860, 2027137638, 3155929169, 3277683879, 377404441},
				PC:  14716094,
				SR:  1543,
				USP: 15490716,
				SSP: 8808174,
				RAM: [][2]uint32{{14716090, 213}, {14716091, 74}, {14716092, 138}, {14716093, 28}, {15779746, 214}, {15779747, 46}, {15779744, 200}, {15779745, 146}, {14716094, 168}, {14716095, 31}},
			},
			want: 			cpuState{
				D:   [8]uint32{3795337976, 530235544, 1640766430, 631833014, 3871599733, 1800468454, 2419694757, 1442241328},
				A:   [7]uint32{1763355497, 3394752016, 1810941856, 2027137638, 3155929169, 3277683879, 377404441},
				PC:  14716096,
				SR:  1561,
				USP: 15490716,
				SSP: 8808174,
				RAM: [][2]uint32{{14716090, 213}, {14716091, 74}, {14716092, 138}, {14716093, 28}, {15779746, 214}, {15779747, 46}, {15779744, 158}, {15779745, 192}, {14716094, 168}, {14716095, 31}},
				Cycles: 18,
			},
		},
		{
			name: "1641 ADDX.w D5, D0 d145",
			init: 			cpuState{
				D:   [8]uint32{1293085693, 1652959920, 1895587188, 1983951098, 1447707477, 2932535307, 2610931151, 1666627432},
				A:   [7]uint32{216998860, 2062497293, 3729566810, 3457666111, 2766409802, 672166341, 1679080675},
				PC:  11808782,
				SR:  1822,
				USP: 6561914,
				SSP: 10752352,
				RAM: [][2]uint32{{11808778, 209}, {11808779, 69}, {11808780, 35}, {11808781, 112}, {11808782, 159}, {11808783, 35}},
			},
			want: 			cpuState{
				D:   [8]uint32{1293081609, 1652959920, 1895587188, 1983951098, 1447707477, 2932535307, 2610931151, 1666627432},
				A:   [7]uint32{216998860, 2062497293, 3729566810, 3457666111, 2766409802, 672166341, 1679080675},
				PC:  11808784,
				SR:  1817,
				USP: 6561914,
				SSP: 10752352,
				RAM: [][2]uint32{{11808778, 209}, {11808779, 69}, {11808780, 35}, {11808781, 112}, {11808782, 159}, {11808783, 35}},
				Cycles: 4,
			},
		},
		{
			name: "1921 ADDX.w D4, D0 d144",
			init: 			cpuState{
				D:   [8]uint32{1809016223, 642166361, 2265341455, 2508443417, 2892489050, 2645214251, 3526085309, 2335849789},
				A:   [7]uint32{3859618659, 3341912742, 3210135147, 3992887432, 1610314164, 215254016, 2305181116},
				PC:  6137232,
				SR:  525,
				USP: 2900074,
				SSP: 15857128,
				RAM: [][2]uint32{{6137228, 209}, {6137229, 68}, {6137230, 36}, {6137231, 4}, {6137232, 124}, {6137233, 156}},
			},
			want: 			cpuState{
				D:   [8]uint32{1809008377, 642166361, 2265341455, 2508443417, 2892489050, 2645214251, 3526085309, 2335849789},
				A:   [7]uint32{3859618659, 3341912742, 3210135147, 3992887432, 1610314164, 215254016, 2305181116},
				PC:  6137234,
				SR:  529,
				USP: 2900074,
				SSP: 15857128,
				RAM: [][2]uint32{{6137228, 209}, {6137229, 68}, {6137230, 36}, {6137231, 4}, {6137232, 124}, {6137233, 156}},
				Cycles: 4,
			},
		},
		{
			name: "2207 ADDX.w D0, D6 dd40",
			init: 			cpuState{
				D:   [8]uint32{1430322256, 2921175363, 3349750424, 1882461568, 393657249, 2552203705, 3419837656, 621811731},
				A:   [7]uint32{4254884714, 2339492067, 3011230084, 2694661336, 3724489477, 1848286122, 713446142},
				PC:  3344394,
				SR:  261,
				USP: 9196336,
				SSP: 5345410,
				RAM: [][2]uint32{{3344390, 221}, {3344391, 64}, {3344392, 131}, {3344393, 139}, {3344394, 241}, {3344395, 134}},
			},
			want: 			cpuState{
				D:   [8]uint32{1430322256, 2921175363, 3349750424, 1882461568, 393657249, 2552203705, 3419836712, 621811731},
				A:   [7]uint32{4254884714, 2339492067, 3011230084, 2694661336, 3724489477, 1848286122, 713446142},
				PC:  3344396,
				SR:  281,
				USP: 9196336,
				SSP: 5345410,
				RAM: [][2]uint32{{3344390, 221}, {3344391, 64}, {3344392, 131}, {3344393, 139}, {3344394, 241}, {3344395, 134}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestADDX_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ADDX.l D7, D3 d787",
			init: cpuState{
				D:   [8]uint32{1197053804, 3399353227, 2740321668, 970265451, 3765064288, 1562279320, 307052771, 146705388},
				A:   [7]uint32{1409285987, 2048459142, 2712308714, 2961438980, 566968450, 4263654526, 1243038899},
				PC:  3883982,
				SR:  41996,
				USP: 15027612,
				SSP: 10721058,
				RAM: [][2]uint32{{3883978, 215}, {3883979, 135}, {3883980, 84}, {3883981, 27}, {3883982, 147}, {3883983, 148}},
			},
			want: cpuState{
				D:   [8]uint32{1197053804, 3399353227, 2740321668, 1116970839, 3765064288, 1562279320, 307052771, 146705388},
				A:   [7]uint32{1409285987, 2048459142, 2712308714, 2961438980, 566968450, 4263654526, 1243038899},
				PC:  3883984,
				SR:  41984,
				USP: 15027612,
				SSP: 10721058,
				RAM: [][2]uint32{{3883978, 215}, {3883979, 135}, {3883980, 84}, {3883981, 27}, {3883982, 147}, {3883983, 148}},
				Cycles: 8,
			},
		},
		{
			name: "500 ADDX.l D0, D6 dd80",
			init: cpuState{
				D:   [8]uint32{2301228822, 4098955082, 3906124809, 2880041830, 3515986994, 3697753751, 326443551, 1399239578},
				A:   [7]uint32{1257952984, 121692183, 510024756, 1418552007, 460661837, 3638469699, 2781236375},
				PC:  12913506,
				SR:  1814,
				USP: 9499798,
				SSP: 7660206,
				RAM: [][2]uint32{{12913502, 221}, {12913503, 128}, {12913504, 99}, {12913505, 59}, {12913506, 137}, {12913507, 9}},
			},
			want: cpuState{
				D:   [8]uint32{2301228822, 4098955082, 3906124809, 2880041830, 3515986994, 3697753751, 2627672374, 1399239578},
				A:   [7]uint32{1257952984, 121692183, 510024756, 1418552007, 460661837, 3638469699, 2781236375},
				PC:  12913508,
				SR:  1800,
				USP: 9499798,
				SSP: 7660206,
				RAM: [][2]uint32{{12913502, 221}, {12913503, 128}, {12913504, 99}, {12913505, 59}, {12913506, 137}, {12913507, 9}},
				Cycles: 8,
			},
		},
		{
			name: "1000 ADDX.l -(A6), -(A2) d58e",
			init: cpuState{
				D:   [8]uint32{2746726150, 1945254889, 417643221, 2266878627, 2985751432, 2292996443, 186955863, 3616861156},
				A:   [7]uint32{278975727, 461149493, 1675980301, 2331855053, 3036905593, 866750393, 152336974},
				PC:  4497950,
				SR:  1026,
				USP: 16613890,
				SSP: 14511670,
				RAM: [][2]uint32{{4497946, 213}, {4497947, 142}, {4497948, 177}, {4497949, 254}, {1342028, 191}, {1342029, 4}, {1342026, 56}, {1342027, 2}, {12, 187}, {13, 136}, {14, 37}, {15, 224}, {8922592, 38}, {8922593, 64}, {8922594, 60}, {8922595, 203}},
			},
			want: cpuState{
				D:      [8]uint32{2746726150, 1945254889, 417643221, 2266878627, 2985751432, 2292996443, 186955863, 3616861156},
				A:      [7]uint32{278975727, 461149493, 1675980301, 2331855053, 3036905593, 866750393, 152336970},
				PC:     3146261988,
				SR:     9218,
				USP:    16613890,
				SSP:    14511656,
				RAM:    [][2]uint32{{4497946, 213}, {4497947, 142}, {4497948, 177}, {4497949, 254}, {1342028, 191}, {1342029, 4}, {1342026, 56}, {1342027, 2}, {14511668, 162}, {14511669, 30}, {14511664, 4}, {14511665, 2}, {14511666, 0}, {14511667, 68}, {14511662, 213}, {14511663, 142}, {14511660, 110}, {14511661, 11}, {14511656, 213}, {14511657, 145}, {14511658, 99}, {14511659, 229}, {12, 187}, {13, 136}, {14, 37}, {15, 224}, {8922592, 38}, {8922593, 64}, {8922594, 60}, {8922595, 203}},
				Halted: true,
			},
		},
		{
			name: "1500 ADDX.l D2, D7 df82",
			init: cpuState{
				D:   [8]uint32{4145695073, 2535570807, 3073958342, 2248074834, 3981471895, 2765352897, 3751033112, 3505595434},
				A:   [7]uint32{1007736431, 2572741474, 592864956, 77362809, 3459726544, 3222006758, 2131677545},
				PC:  1589408,
				SR:  9228,
				USP: 16050948,
				SSP: 1651500,
				RAM: [][2]uint32{{1589404, 223}, {1589405, 130}, {1589406, 242}, {1589407, 114}, {1589408, 177}, {1589409, 77}},
			},
			want: cpuState{
				D:   [8]uint32{4145695073, 2535570807, 3073958342, 2248074834, 3981471895, 2765352897, 3751033112, 2284586480},
				A:   [7]uint32{1007736431, 2572741474, 592864956, 77362809, 3459726544, 3222006758, 2131677545},
				PC:  1589410,
				SR:  9241,
				USP: 16050948,
				SSP: 1651500,
				RAM: [][2]uint32{{1589404, 223}, {1589405, 130}, {1589406, 242}, {1589407, 114}, {1589408, 177}, {1589409, 77}},
				Cycles: 8,
			},
		},
		{
			name: "2000 ADDX.l -(A7), -(A0) d18f",
			init: cpuState{
				D:   [8]uint32{1488402042, 3546197818, 825194713, 2556981956, 3521454437, 2293392277, 3169881152, 4015812514},
				A:   [7]uint32{3979553049, 1837613905, 1294803692, 449279801, 429588003, 2986754987, 1778440752},
				PC:  4985326,
				SR:  9240,
				USP: 8592258,
				SSP: 15934418,
				RAM: [][2]uint32{{4985322, 209}, {4985323, 143}, {4985324, 174}, {4985325, 217}, {15934416, 52}, {15934417, 66}, {15934414, 92}, {15934415, 201}, {12, 104}, {13, 170}, {14, 126}, {15, 194}, {11173570, 107}, {11173571, 39}, {11173572, 162}, {11173573, 131}},
			},
			want: cpuState{
				D:      [8]uint32{1488402042, 3546197818, 825194713, 2556981956, 3521454437, 2293392277, 3169881152, 4015812514},
				A:      [7]uint32{3979553049, 1837613905, 1294803692, 449279801, 429588003, 2986754987, 1778440752},
				PC:     1756004038,
				SR:     9240,
				USP:    8592258,
				SSP:    15934400,
				RAM:    [][2]uint32{{4985322, 209}, {4985323, 143}, {4985324, 174}, {4985325, 217}, {15934416, 52}, {15934417, 66}, {15934414, 92}, {15934415, 201}, {15934412, 17}, {15934413, 238}, {15934408, 36}, {15934409, 24}, {15934410, 0}, {15934411, 76}, {15934406, 209}, {15934407, 143}, {15934404, 41}, {15934405, 23}, {15934400, 209}, {15934401, 149}, {15934402, 237}, {15934403, 51}, {12, 104}, {13, 170}, {14, 126}, {15, 194}, {11173570, 107}, {11173571, 39}, {11173572, 162}, {11173573, 131}},
				Halted: true,
			},
		},
		{
			name: "002 ADDX.l -(A5), -(A7) df8d",
			init: 			cpuState{
				D:   [8]uint32{4000153765, 733426698, 3893669270, 4135720468, 3592905820, 1293613508, 253008137, 4259483975},
				A:   [7]uint32{3902585815, 557314780, 1059905589, 2075988365, 34148886, 1713959442, 3200794601},
				PC:  12829726,
				SR:  3,
				USP: 14572300,
				SSP: 7643538,
				RAM: [][2]uint32{{12829722, 223}, {12829723, 141}, {12829724, 104}, {12829725, 1}, {2683408, 209}, {2683409, 144}, {2683406, 225}, {2683407, 169}, {14572298, 181}, {14572299, 222}, {14572296, 38}, {14572297, 246}, {12829726, 163}, {12829727, 30}},
			},
			want: 			cpuState{
				D:   [8]uint32{4000153765, 733426698, 3893669270, 4135720468, 3592905820, 1293613508, 253008137, 4259483975},
				A:   [7]uint32{3902585815, 557314780, 1059905589, 2075988365, 34148886, 1713959438, 3200794601},
				PC:  12829728,
				SR:  17,
				USP: 14572296,
				SSP: 7643538,
				RAM: [][2]uint32{{12829722, 223}, {12829723, 141}, {12829724, 104}, {12829725, 1}, {2683408, 209}, {2683409, 144}, {2683406, 225}, {2683407, 169}, {14572298, 135}, {14572299, 110}, {14572296, 8}, {14572297, 160}, {12829726, 163}, {12829727, 30}},
				Cycles: 30,
			},
		},
		{
			name: "266 ADDX.l D0, D6 dd80",
			init: 			cpuState{
				D:   [8]uint32{905991530, 3712032214, 1014616727, 3543366260, 1514632885, 1776818801, 2930149505, 1918786027},
				A:   [7]uint32{164143241, 8821904, 2552590864, 1004864692, 2289838039, 2574464382, 2621556673},
				PC:  1309758,
				SR:  29,
				USP: 11085588,
				SSP: 13470060,
				RAM: [][2]uint32{{1309754, 221}, {1309755, 128}, {1309756, 182}, {1309757, 100}, {1309758, 165}, {1309759, 156}},
			},
			want: 			cpuState{
				D:   [8]uint32{905991530, 3712032214, 1014616727, 3543366260, 1514632885, 1776818801, 3836141036, 1918786027},
				A:   [7]uint32{164143241, 8821904, 2552590864, 1004864692, 2289838039, 2574464382, 2621556673},
				PC:  1309760,
				SR:  8,
				USP: 11085588,
				SSP: 13470060,
				RAM: [][2]uint32{{1309754, 221}, {1309755, 128}, {1309756, 182}, {1309757, 100}, {1309758, 165}, {1309759, 156}},
				Cycles: 8,
			},
		},
		{
			name: "555 ADDX.l D4, D4 d984",
			init: 			cpuState{
				D:   [8]uint32{2656918425, 2669172370, 1818932805, 1620361280, 2394125615, 854788983, 2880480978, 3012082959},
				A:   [7]uint32{1655082424, 1898083497, 2511473702, 787411780, 2599320878, 1138233970, 283781234},
				PC:  2431432,
				SR:  1801,
				USP: 16561954,
				SSP: 2351788,
				RAM: [][2]uint32{{2431428, 217}, {2431429, 132}, {2431430, 244}, {2431431, 175}, {2431432, 8}, {2431433, 92}},
			},
			want: 			cpuState{
				D:   [8]uint32{2656918425, 2669172370, 1818932805, 1620361280, 493283934, 854788983, 2880480978, 3012082959},
				A:   [7]uint32{1655082424, 1898083497, 2511473702, 787411780, 2599320878, 1138233970, 283781234},
				PC:  2431434,
				SR:  1811,
				USP: 16561954,
				SSP: 2351788,
				RAM: [][2]uint32{{2431428, 217}, {2431429, 132}, {2431430, 244}, {2431431, 175}, {2431432, 8}, {2431433, 92}},
				Cycles: 8,
			},
		},
		{
			name: "830 ADDX.l D7, D1 d387",
			init: 			cpuState{
				D:   [8]uint32{2361387932, 362823545, 1490228154, 2967926254, 3214409874, 3014864012, 1046256401, 449221512},
				A:   [7]uint32{2883152196, 2316635260, 2214374553, 2700225473, 1800419581, 2788288197, 1384490251},
				PC:  91414,
				SR:  1049,
				USP: 2007324,
				SSP: 16220970,
				RAM: [][2]uint32{{91410, 211}, {91411, 135}, {91412, 35}, {91413, 33}, {91414, 245}, {91415, 221}},
			},
			want: 			cpuState{
				D:   [8]uint32{2361387932, 812045058, 1490228154, 2967926254, 3214409874, 3014864012, 1046256401, 449221512},
				A:   [7]uint32{2883152196, 2316635260, 2214374553, 2700225473, 1800419581, 2788288197, 1384490251},
				PC:  91416,
				SR:  1024,
				USP: 2007324,
				SSP: 16220970,
				RAM: [][2]uint32{{91410, 211}, {91411, 135}, {91412, 35}, {91413, 33}, {91414, 245}, {91415, 221}},
				Cycles: 8,
			},
		},
		{
			name: "1096 ADDX.l D7, D2 d587",
			init: 			cpuState{
				D:   [8]uint32{236662243, 1653731940, 2602549896, 3213928288, 1553208462, 639175943, 3386128890, 2843068703},
				A:   [7]uint32{1962377107, 595353600, 2641776018, 2232132843, 4198388427, 1959567835, 2822935054},
				PC:  12018428,
				SR:  10006,
				USP: 5755752,
				SSP: 610114,
				RAM: [][2]uint32{{12018424, 213}, {12018425, 135}, {12018426, 135}, {12018427, 111}, {12018428, 243}, {12018429, 10}},
			},
			want: 			cpuState{
				D:   [8]uint32{236662243, 1653731940, 1150651304, 3213928288, 1553208462, 639175943, 3386128890, 2843068703},
				A:   [7]uint32{1962377107, 595353600, 2641776018, 2232132843, 4198388427, 1959567835, 2822935054},
				PC:  12018430,
				SR:  10003,
				USP: 5755752,
				SSP: 610114,
				RAM: [][2]uint32{{12018424, 213}, {12018425, 135}, {12018426, 135}, {12018427, 111}, {12018428, 243}, {12018429, 10}},
				Cycles: 8,
			},
		},
		{
			name: "1365 ADDX.l D7, D4 d987",
			init: 			cpuState{
				D:   [8]uint32{3148015243, 1960100474, 531171489, 1519109771, 3067762272, 3748136482, 1878196263, 2923699430},
				A:   [7]uint32{3115299848, 1304723362, 308950564, 1807199193, 2322605741, 340941770, 799541652},
				PC:  11647570,
				SR:  258,
				USP: 2086904,
				SSP: 15697186,
				RAM: [][2]uint32{{11647566, 217}, {11647567, 135}, {11647568, 147}, {11647569, 61}, {11647570, 21}, {11647571, 60}},
			},
			want: 			cpuState{
				D:   [8]uint32{3148015243, 1960100474, 531171489, 1519109771, 1696494406, 3748136482, 1878196263, 2923699430},
				A:   [7]uint32{3115299848, 1304723362, 308950564, 1807199193, 2322605741, 340941770, 799541652},
				PC:  11647572,
				SR:  275,
				USP: 2086904,
				SSP: 15697186,
				RAM: [][2]uint32{{11647566, 217}, {11647567, 135}, {11647568, 147}, {11647569, 61}, {11647570, 21}, {11647571, 60}},
				Cycles: 8,
			},
		},
		{
			name: "1656 ADDX.l D7, D5 db87",
			init: 			cpuState{
				D:   [8]uint32{171774362, 4149998807, 921013073, 173816903, 511967, 2564029962, 1460931599, 3784494945},
				A:   [7]uint32{570319507, 1579488430, 1854823924, 483201280, 3669188247, 1264042780, 776078094},
				PC:  9143970,
				SR:  8218,
				USP: 1818764,
				SSP: 3004262,
				RAM: [][2]uint32{{9143966, 219}, {9143967, 135}, {9143968, 187}, {9143969, 128}, {9143970, 78}, {9143971, 101}},
			},
			want: 			cpuState{
				D:   [8]uint32{171774362, 4149998807, 921013073, 173816903, 511967, 2053557612, 1460931599, 3784494945},
				A:   [7]uint32{570319507, 1579488430, 1854823924, 483201280, 3669188247, 1264042780, 776078094},
				PC:  9143972,
				SR:  8211,
				USP: 1818764,
				SSP: 3004262,
				RAM: [][2]uint32{{9143966, 219}, {9143967, 135}, {9143968, 187}, {9143969, 128}, {9143970, 78}, {9143971, 101}},
				Cycles: 8,
			},
		},
		{
			name: "1936 ADDX.l D5, D4 d985",
			init: 			cpuState{
				D:   [8]uint32{3971461138, 255876378, 1498367935, 1063101774, 4081216037, 4214945359, 2955905938, 275952293},
				A:   [7]uint32{1053658035, 1043339987, 2325677044, 1218915076, 1969614263, 103562137, 2488311933},
				PC:  13544522,
				SR:  9221,
				USP: 9068306,
				SSP: 4130688,
				RAM: [][2]uint32{{13544518, 217}, {13544519, 133}, {13544520, 187}, {13544521, 143}, {13544522, 147}, {13544523, 172}},
			},
			want: 			cpuState{
				D:   [8]uint32{3971461138, 255876378, 1498367935, 1063101774, 4001194100, 4214945359, 2955905938, 275952293},
				A:   [7]uint32{1053658035, 1043339987, 2325677044, 1218915076, 1969614263, 103562137, 2488311933},
				PC:  13544524,
				SR:  9241,
				USP: 9068306,
				SSP: 4130688,
				RAM: [][2]uint32{{13544518, 217}, {13544519, 133}, {13544520, 187}, {13544521, 143}, {13544522, 147}, {13544523, 172}},
				Cycles: 8,
			},
		},
		{
			name: "2200 ADDX.l D5, D3 d785",
			init: 			cpuState{
				D:   [8]uint32{202011294, 150318145, 4273899135, 3583782558, 3358125075, 497350890, 3300574699, 1901685562},
				A:   [7]uint32{2781950118, 384530937, 1766148042, 1698397082, 2775619737, 1438790920, 2012706371},
				PC:  12027506,
				SR:  530,
				USP: 14037998,
				SSP: 5445776,
				RAM: [][2]uint32{{12027502, 215}, {12027503, 133}, {12027504, 192}, {12027505, 46}, {12027506, 242}, {12027507, 70}},
			},
			want: 			cpuState{
				D:   [8]uint32{202011294, 150318145, 4273899135, 4081133449, 3358125075, 497350890, 3300574699, 1901685562},
				A:   [7]uint32{2781950118, 384530937, 1766148042, 1698397082, 2775619737, 1438790920, 2012706371},
				PC:  12027508,
				SR:  520,
				USP: 14037998,
				SSP: 5445776,
				RAM: [][2]uint32{{12027502, 215}, {12027503, 133}, {12027504, 192}, {12027505, 46}, {12027506, 242}, {12027507, 70}},
				Cycles: 8,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSUB_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SUB.b #, -(A0) 0420",
			init: cpuState{
				D:   [8]uint32{3437425658, 626517206, 1000825843, 2316349802, 3604152426, 3851502031, 3394184782, 3053024384},
				A:   [7]uint32{3296183512, 3819277623, 1780743123, 2905093333, 1460519341, 1613759537, 718903270},
				PC:  12503382,
				SR:  771,
				USP: 2581670,
				SSP: 124124,
				RAM: [][2]uint32{{12503378, 4}, {12503379, 32}, {12503380, 143}, {12503381, 37}, {12503382, 1}, {12503383, 233}, {7849174, 88}, {7849175, 19}, {12503384, 63}, {12503385, 1}},
			},
			want: cpuState{
				D:   [8]uint32{3437425658, 626517206, 1000825843, 2316349802, 3604152426, 3851502031, 3394184782, 3053024384},
				A:   [7]uint32{3296183511, 3819277623, 1780743123, 2905093333, 1460519341, 1613759537, 718903270},
				PC:  12503386,
				SR:  793,
				USP: 2581670,
				SSP: 124124,
				RAM: [][2]uint32{{12503378, 4}, {12503379, 32}, {12503380, 143}, {12503381, 37}, {12503382, 1}, {12503383, 233}, {7849174, 88}, {7849175, 238}, {12503384, 63}, {12503385, 1}},
				Cycles: 18,
			},
		},
		{
			name: "500 SUB.b (A4), D6 9c14",
			init: cpuState{
				D:   [8]uint32{788171003, 615830693, 1117140683, 1726663104, 2870692238, 19005344, 846034352, 66472723},
				A:   [7]uint32{2909271590, 3472661757, 922855361, 2354883996, 1593318996, 1649173677, 262676505},
				PC:  8660336,
				SR:  41997,
				USP: 16744672,
				SSP: 1199018,
				RAM: [][2]uint32{{8660332, 156}, {8660333, 20}, {8660334, 251}, {8660335, 98}, {16260692, 90}, {16260693, 251}, {8660336, 202}, {8660337, 144}},
			},
			want: cpuState{
				D:   [8]uint32{788171003, 615830693, 1117140683, 1726663104, 2870692238, 19005344, 846034262, 66472723},
				A:   [7]uint32{2909271590, 3472661757, 922855361, 2354883996, 1593318996, 1649173677, 262676505},
				PC:  8660338,
				SR:  41986,
				USP: 16744672,
				SSP: 1199018,
				RAM: [][2]uint32{{8660332, 156}, {8660333, 20}, {8660334, 251}, {8660335, 98}, {16260692, 90}, {16260693, 251}, {8660336, 202}, {8660337, 144}},
				Cycles: 8,
			},
		},
		{
			name: "1000 SUB.b (d8, A3, Xn), D1 9233",
			init: cpuState{
				D:   [8]uint32{4206547149, 4194890382, 3486214681, 3520049570, 3961909652, 968668379, 2269899433, 1554870558},
				A:   [7]uint32{386208379, 2500787246, 324640844, 2367230804, 2858400550, 3191230414, 1687873995},
				PC:  12914814,
				SR:  41755,
				USP: 9041646,
				SSP: 3756558,
				RAM: [][2]uint32{{12914810, 146}, {12914811, 51}, {12914812, 0}, {12914813, 214}, {12914814, 56}, {12914815, 134}, {1631222, 130}, {1631223, 195}, {12914816, 90}, {12914817, 133}},
			},
			want: cpuState{
				D:   [8]uint32{4206547149, 4194890443, 3486214681, 3520049570, 3961909652, 968668379, 2269899433, 1554870558},
				A:   [7]uint32{386208379, 2500787246, 324640844, 2367230804, 2858400550, 3191230414, 1687873995},
				PC:  12914818,
				SR:  41753,
				USP: 9041646,
				SSP: 3756558,
				RAM: [][2]uint32{{12914810, 146}, {12914811, 51}, {12914812, 0}, {12914813, 214}, {12914814, 56}, {12914815, 134}, {1631222, 130}, {1631223, 195}, {12914816, 90}, {12914817, 133}},
				Cycles: 14,
			},
		},
		{
			name: "1500 SUB.b (xxx).w, D6 9c38",
			init: cpuState{
				D:   [8]uint32{2273046000, 331481534, 2065092284, 3013863883, 1906904132, 945353949, 2579006597, 4273195724},
				A:   [7]uint32{1079026672, 3423777972, 3986894373, 2708808711, 2659227820, 868880499, 3102138922},
				PC:  9135864,
				SR:  798,
				USP: 13878842,
				SSP: 1007856,
				RAM: [][2]uint32{{9135860, 156}, {9135861, 56}, {9135862, 68}, {9135863, 174}, {9135864, 210}, {9135865, 32}, {17582, 151}, {17583, 245}, {9135866, 172}, {9135867, 38}},
			},
			want: cpuState{
				D:   [8]uint32{2273046000, 331481534, 2065092284, 3013863883, 1906904132, 945353949, 2579006702, 4273195724},
				A:   [7]uint32{1079026672, 3423777972, 3986894373, 2708808711, 2659227820, 868880499, 3102138922},
				PC:  9135868,
				SR:  793,
				USP: 13878842,
				SSP: 1007856,
				RAM: [][2]uint32{{9135860, 156}, {9135861, 56}, {9135862, 68}, {9135863, 174}, {9135864, 210}, {9135865, 32}, {17582, 151}, {17583, 245}, {9135866, 172}, {9135867, 38}},
				Cycles: 12,
			},
		},
		{
			name: "2000 SUB.b D2, (d16, A1) 9529",
			init: cpuState{
				D:   [8]uint32{3579706632, 2966131563, 2522598236, 2356676839, 228146334, 9204655, 4014346406, 2058141629},
				A:   [7]uint32{3610508292, 1729573067, 1512237355, 1890453634, 3626244582, 4044825426, 1314031991},
				PC:  3914820,
				SR:  9242,
				USP: 8657308,
				SSP: 6590048,
				RAM: [][2]uint32{{3914816, 149}, {3914817, 41}, {3914818, 80}, {3914819, 69}, {3914820, 175}, {3914821, 43}, {1540368, 85}, {1540369, 211}, {3914822, 63}, {3914823, 46}},
			},
			want: cpuState{
				D:   [8]uint32{3579706632, 2966131563, 2522598236, 2356676839, 228146334, 9204655, 4014346406, 2058141629},
				A:   [7]uint32{3610508292, 1729573067, 1512237355, 1890453634, 3626244582, 4044825426, 1314031991},
				PC:  3914824,
				SR:  9241,
				USP: 8657308,
				SSP: 6590048,
				RAM: [][2]uint32{{3914816, 149}, {3914817, 41}, {3914818, 80}, {3914819, 69}, {3914820, 175}, {3914821, 43}, {1540368, 249}, {1540369, 211}, {3914822, 63}, {3914823, 46}},
				Cycles: 16,
			},
		},
		{
			name: "001 SUB.b -(A5), D2 9425",
			init: 			cpuState{
				D:   [8]uint32{725318685, 1949999943, 3808045794, 753923180, 512483933, 1827965673, 3775938868, 419617130},
				A:   [7]uint32{3793886732, 2324089528, 45630088, 123854938, 1348911414, 3994101816, 3519132045},
				PC:  7436866,
				SR:  8222,
				USP: 14675226,
				SSP: 5720206,
				RAM: [][2]uint32{{7436862, 148}, {7436863, 37}, {7436864, 200}, {7436865, 61}, {1124406, 14}, {1124407, 231}, {7436866, 164}, {7436867, 216}},
			},
			want: 			cpuState{
				D:   [8]uint32{725318685, 1949999943, 3808045819, 753923180, 512483933, 1827965673, 3775938868, 419617130},
				A:   [7]uint32{3793886732, 2324089528, 45630088, 123854938, 1348911414, 3994101815, 3519132045},
				PC:  7436868,
				SR:  8217,
				USP: 14675226,
				SSP: 5720206,
				RAM: [][2]uint32{{7436862, 148}, {7436863, 37}, {7436864, 200}, {7436865, 61}, {1124406, 14}, {1124407, 231}, {7436866, 164}, {7436867, 216}},
				Cycles: 10,
			},
		},
		{
			name: "291 SUB.b 2, (A4) 5514",
			init: 			cpuState{
				D:   [8]uint32{338469466, 3189738790, 2802725324, 2332765772, 1479698467, 3107174864, 3579225122, 2258968674},
				A:   [7]uint32{3378016859, 3818665853, 3507091675, 2982675111, 520821892, 3772065377, 150059229},
				PC:  10723042,
				SR:  1800,
				USP: 3376902,
				SSP: 13623286,
				RAM: [][2]uint32{{10723038, 85}, {10723039, 20}, {10723040, 76}, {10723041, 212}, {728196, 128}, {728197, 203}, {10723042, 203}, {10723043, 249}},
			},
			want: 			cpuState{
				D:   [8]uint32{338469466, 3189738790, 2802725324, 2332765772, 1479698467, 3107174864, 3579225122, 2258968674},
				A:   [7]uint32{3378016859, 3818665853, 3507091675, 2982675111, 520821892, 3772065377, 150059229},
				PC:  10723044,
				SR:  1794,
				USP: 3376902,
				SSP: 13623286,
				RAM: [][2]uint32{{10723038, 85}, {10723039, 20}, {10723040, 76}, {10723041, 212}, {728196, 126}, {728197, 203}, {10723042, 203}, {10723043, 249}},
				Cycles: 12,
			},
		},
		{
			name: "565 SUB.b D2, (d16, A2) 952a",
			init: 			cpuState{
				D:   [8]uint32{2285293917, 1185042382, 1745881423, 873791063, 2613087119, 3650206783, 3004738373, 964739940},
				A:   [7]uint32{2004245361, 3790750469, 141329263, 3674624255, 40880652, 1316674245, 611148424},
				PC:  10846016,
				SR:  9477,
				USP: 8842966,
				SSP: 7053686,
				RAM: [][2]uint32{{10846012, 149}, {10846013, 42}, {10846014, 33}, {10846015, 232}, {10846016, 68}, {10846017, 9}, {7120214, 135}, {7120215, 94}, {10846018, 201}, {10846019, 187}},
			},
			want: 			cpuState{
				D:   [8]uint32{2285293917, 1185042382, 1745881423, 873791063, 2613087119, 3650206783, 3004738373, 964739940},
				A:   [7]uint32{2004245361, 3790750469, 141329263, 3674624255, 40880652, 1316674245, 611148424},
				PC:  10846020,
				SR:  9472,
				USP: 8842966,
				SSP: 7053686,
				RAM: [][2]uint32{{10846012, 149}, {10846013, 42}, {10846014, 33}, {10846015, 232}, {10846016, 68}, {10846017, 9}, {7120214, 135}, {7120215, 15}, {10846018, 201}, {10846019, 187}},
				Cycles: 16,
			},
		},
		{
			name: "837 SUB.b D6, (xxx).l 9d39",
			init: 			cpuState{
				D:   [8]uint32{2193790391, 810383325, 4274922928, 2053162501, 1193824628, 3310207477, 3218564104, 208536103},
				A:   [7]uint32{3671448321, 2810277412, 1893467752, 2083437932, 2678966551, 685159020, 1090240076},
				PC:  13195186,
				SR:  8708,
				USP: 13702042,
				SSP: 1442008,
				RAM: [][2]uint32{{13195182, 157}, {13195183, 57}, {13195184, 104}, {13195185, 251}, {13195186, 56}, {13195187, 190}, {13195188, 201}, {13195189, 237}, {16464062, 94}, {16464063, 103}, {13195190, 232}, {13195191, 139}},
			},
			want: 			cpuState{
				D:   [8]uint32{2193790391, 810383325, 4274922928, 2053162501, 1193824628, 3310207477, 3218564104, 208536103},
				A:   [7]uint32{3671448321, 2810277412, 1893467752, 2083437932, 2678966551, 685159020, 1090240076},
				PC:  13195192,
				SR:  8704,
				USP: 13702042,
				SSP: 1442008,
				RAM: [][2]uint32{{13195182, 157}, {13195183, 57}, {13195184, 104}, {13195185, 251}, {13195186, 56}, {13195187, 190}, {13195188, 201}, {13195189, 237}, {16464062, 86}, {16464063, 103}, {13195190, 232}, {13195191, 139}},
				Cycles: 20,
			},
		},
		{
			name: "1091 SUB.b D1, D6 9c01",
			init: 			cpuState{
				D:   [8]uint32{303179556, 2459733306, 1235776351, 1817202063, 182975625, 1259339251, 551057181, 2258592193},
				A:   [7]uint32{3495568955, 1551052233, 1692215047, 3608933796, 3808039687, 2067703420, 1249938981},
				PC:  16546106,
				SR:  1025,
				USP: 16336370,
				SSP: 15208800,
				RAM: [][2]uint32{{16546102, 156}, {16546103, 1}, {16546104, 144}, {16546105, 193}, {16546106, 127}, {16546107, 249}},
			},
			want: 			cpuState{
				D:   [8]uint32{303179556, 2459733306, 1235776351, 1817202063, 182975625, 1259339251, 551057379, 2258592193},
				A:   [7]uint32{3495568955, 1551052233, 1692215047, 3608933796, 3808039687, 2067703420, 1249938981},
				PC:  16546108,
				SR:  1049,
				USP: 16336370,
				SSP: 15208800,
				RAM: [][2]uint32{{16546102, 156}, {16546103, 1}, {16546104, 144}, {16546105, 193}, {16546106, 127}, {16546107, 249}},
				Cycles: 4,
			},
		},
		{
			name: "1369 SUB.b D2, (A1)+ 9519",
			init: 			cpuState{
				D:   [8]uint32{3558400198, 3171612032, 168208461, 922667063, 3246872563, 2598779646, 1423459353, 207768942},
				A:   [7]uint32{1665412407, 2370688143, 2654740316, 3061718711, 691237005, 2950647430, 1121421536},
				PC:  11939146,
				SR:  1811,
				USP: 4408386,
				SSP: 7724324,
				RAM: [][2]uint32{{11939142, 149}, {11939143, 25}, {11939144, 58}, {11939145, 230}, {5100686, 233}, {5100687, 222}, {11939146, 61}, {11939147, 189}},
			},
			want: 			cpuState{
				D:   [8]uint32{3558400198, 3171612032, 168208461, 922667063, 3246872563, 2598779646, 1423459353, 207768942},
				A:   [7]uint32{1665412407, 2370688144, 2654740316, 3061718711, 691237005, 2950647430, 1121421536},
				PC:  11939148,
				SR:  1800,
				USP: 4408386,
				SSP: 7724324,
				RAM: [][2]uint32{{11939142, 149}, {11939143, 25}, {11939144, 58}, {11939145, 230}, {5100686, 233}, {5100687, 145}, {11939146, 61}, {11939147, 189}},
				Cycles: 12,
			},
		},
		{
			name: "1660 SUB.b (d8, A3, Xn), D1 9233",
			init: 			cpuState{
				D:   [8]uint32{3817492674, 2494537058, 2274713213, 113633352, 361392220, 2466694005, 3503421050, 1404015465},
				A:   [7]uint32{1301657003, 1020323834, 488240874, 280835345, 3535876358, 2510438047, 444037324},
				PC:  6715430,
				SR:  8213,
				USP: 783012,
				SSP: 3216026,
				RAM: [][2]uint32{{6715426, 146}, {6715427, 51}, {6715428, 105}, {6715429, 25}, {6715430, 124}, {6715431, 137}, {9382820, 117}, {9382821, 107}, {6715432, 99}, {6715433, 81}},
			},
			want: 			cpuState{
				D:   [8]uint32{3817492674, 2494537197, 2274713213, 113633352, 361392220, 2466694005, 3503421050, 1404015465},
				A:   [7]uint32{1301657003, 1020323834, 488240874, 280835345, 3535876358, 2510438047, 444037324},
				PC:  6715434,
				SR:  8217,
				USP: 783012,
				SSP: 3216026,
				RAM: [][2]uint32{{6715426, 146}, {6715427, 51}, {6715428, 105}, {6715429, 25}, {6715430, 124}, {6715431, 137}, {9382820, 117}, {9382821, 107}, {6715432, 99}, {6715433, 81}},
				Cycles: 14,
			},
		},
		{
			name: "1936 SUB.b D4, (d16, A4) 992c",
			init: 			cpuState{
				D:   [8]uint32{2640267208, 3736830218, 1827214887, 1165534441, 2625878943, 288685766, 104019330, 3195401734},
				A:   [7]uint32{2957464639, 2371584482, 2074548833, 124933288, 3655368819, 2163956567, 3151723566},
				PC:  15431220,
				SR:  1565,
				USP: 14176514,
				SSP: 15684350,
				RAM: [][2]uint32{{15431216, 153}, {15431217, 44}, {15431218, 35}, {15431219, 194}, {15431220, 10}, {15431221, 142}, {14722100, 118}, {14722101, 242}, {15431222, 5}, {15431223, 178}},
			},
			want: 			cpuState{
				D:   [8]uint32{2640267208, 3736830218, 1827214887, 1165534441, 2625878943, 288685766, 104019330, 3195401734},
				A:   [7]uint32{2957464639, 2371584482, 2074548833, 124933288, 3655368819, 2163956567, 3151723566},
				PC:  15431224,
				SR:  1536,
				USP: 14176514,
				SSP: 15684350,
				RAM: [][2]uint32{{15431216, 153}, {15431217, 44}, {15431218, 35}, {15431219, 194}, {15431220, 10}, {15431221, 142}, {14722100, 118}, {14722101, 83}, {15431222, 5}, {15431223, 178}},
				Cycles: 16,
			},
		},
		{
			name: "2206 SUB.b (d16, A5), D1 922d",
			init: 			cpuState{
				D:   [8]uint32{2784666717, 2904634739, 4017576666, 631778069, 4276777857, 770577437, 1102335873, 2068972932},
				A:   [7]uint32{1010709111, 2529804971, 114670285, 1912705361, 1140854828, 2778870672, 493059501},
				PC:  5030244,
				SR:  517,
				USP: 5139126,
				SSP: 10937794,
				RAM: [][2]uint32{{5030240, 146}, {5030241, 45}, {5030242, 10}, {5030243, 208}, {5030244, 64}, {5030245, 201}, {10632800, 205}, {10632801, 174}, {5030246, 5}, {5030247, 15}},
			},
			want: 			cpuState{
				D:   [8]uint32{2784666717, 2904634790, 4017576666, 631778069, 4276777857, 770577437, 1102335873, 2068972932},
				A:   [7]uint32{1010709111, 2529804971, 114670285, 1912705361, 1140854828, 2778870672, 493059501},
				PC:  5030248,
				SR:  539,
				USP: 5139126,
				SSP: 10937794,
				RAM: [][2]uint32{{5030240, 146}, {5030241, 45}, {5030242, 10}, {5030243, 208}, {5030244, 64}, {5030245, 201}, {10632800, 205}, {10632801, 174}, {5030246, 5}, {5030247, 15}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSUB_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SUB.w D7, (xxx).w 9f78",
			init: cpuState{
				D:   [8]uint32{778189525, 3625107800, 2162281962, 3042322923, 602243132, 131004613, 1295821721, 2828723018},
				A:   [7]uint32{2402517068, 1417749771, 3823487136, 1208433966, 355320110, 4050864189, 844697989},
				PC:  11738168,
				SR:  33033,
				USP: 14659424,
				SSP: 16745600,
				RAM: [][2]uint32{{11738164, 159}, {11738165, 120}, {11738166, 183}, {11738167, 203}, {11738168, 209}, {11738169, 234}, {12, 244}, {13, 36}, {14, 149}, {15, 136}, {2397576, 36}, {2397577, 33}, {2397578, 237}, {2397579, 237}},
			},
			want: cpuState{
				D:      [8]uint32{778189525, 3625107800, 2162281962, 3042322923, 602243132, 131004613, 1295821721, 2828723018},
				A:      [7]uint32{2402517068, 1417749771, 3823487136, 1208433966, 355320110, 4050864189, 844697989},
				PC:     4096038284,
				SR:     8457,
				USP:    14659424,
				SSP:    16745586,
				RAM:    [][2]uint32{{11738164, 159}, {11738165, 120}, {11738166, 183}, {11738167, 203}, {11738168, 209}, {11738169, 234}, {16745598, 28}, {16745599, 56}, {16745594, 129}, {16745595, 9}, {16745596, 0}, {16745597, 179}, {16745592, 159}, {16745593, 120}, {16745590, 183}, {16745591, 203}, {16745586, 159}, {16745587, 113}, {16745588, 255}, {16745589, 255}, {12, 244}, {13, 36}, {14, 149}, {15, 136}, {2397576, 36}, {2397577, 33}, {2397578, 237}, {2397579, 237}},
				Halted: true,
			},
		},
		{
			name: "500 SUB.w D6, (d16, A0) 9d68",
			init: cpuState{
				D:   [8]uint32{1395220928, 608279909, 988544966, 3428709179, 3746349990, 2633183441, 1210827680, 627422436},
				A:   [7]uint32{619351081, 3931145708, 236692255, 1170054324, 941137013, 513050375, 3048807278},
				PC:  2142834,
				SR:  34573,
				USP: 2421658,
				SSP: 16610388,
				RAM: [][2]uint32{{2142830, 157}, {2142831, 104}, {2142832, 118}, {2142833, 205}, {2142834, 114}, {2142835, 3}, {15401718, 122}, {15401719, 11}, {2142836, 169}, {2142837, 198}},
			},
			want: cpuState{
				D:   [8]uint32{1395220928, 608279909, 988544966, 3428709179, 3746349990, 2633183441, 1210827680, 627422436},
				A:   [7]uint32{619351081, 3931145708, 236692255, 1170054324, 941137013, 513050375, 3048807278},
				PC:  2142838,
				SR:  34587,
				USP: 2421658,
				SSP: 16610388,
				RAM: [][2]uint32{{2142830, 157}, {2142831, 104}, {2142832, 118}, {2142833, 205}, {2142834, 114}, {2142835, 3}, {15401718, 182}, {15401719, 107}, {2142836, 169}, {2142837, 198}},
				Cycles: 16,
			},
		},
		{
			name: "1000 SUB.w D2, (d8, A6, Xn) 9576",
			init: cpuState{
				D:   [8]uint32{3625249756, 3245171826, 930234665, 2446400959, 628581484, 1262082402, 2267988574, 4106991817},
				A:   [7]uint32{3443608986, 1997088992, 383529149, 2454865281, 1372498769, 2042495561, 650617147},
				PC:  7658838,
				SR:  9735,
				USP: 1794264,
				SSP: 1890700,
				RAM: [][2]uint32{{7658834, 149}, {7658835, 118}, {7658836, 164}, {7658837, 151}, {7658838, 248}, {7658839, 241}, {12, 237}, {13, 154}, {14, 143}, {15, 192}, {10129344, 250}, {10129345, 54}, {10129346, 187}, {10129347, 113}},
			},
			want: cpuState{
				D:      [8]uint32{3625249756, 3245171826, 930234665, 2446400959, 628581484, 1262082402, 2267988574, 4106991817},
				A:      [7]uint32{3443608986, 1997088992, 383529149, 2454865281, 1372498769, 2042495561, 650617147},
				PC:     3986329540,
				SR:     9735,
				USP:    1794264,
				SSP:    1890686,
				RAM:    [][2]uint32{{7658834, 149}, {7658835, 118}, {7658836, 164}, {7658837, 151}, {7658838, 248}, {7658839, 241}, {1890698, 221}, {1890699, 84}, {1890694, 38}, {1890695, 7}, {1890696, 0}, {1890697, 116}, {1890692, 149}, {1890693, 118}, {1890690, 209}, {1890691, 143}, {1890686, 149}, {1890687, 117}, {1890688, 38}, {1890689, 199}, {12, 237}, {13, 154}, {14, 143}, {15, 192}, {10129344, 250}, {10129345, 54}, {10129346, 187}, {10129347, 113}},
				Halted: true,
			},
		},
		{
			name: "1500 SUB.w -(A7), D4 9867",
			init: cpuState{
				D:   [8]uint32{4188791806, 701266004, 2620792223, 1523264027, 2471591911, 204235478, 50810715, 2026526396},
				A:   [7]uint32{451417472, 4225087265, 2634435366, 2755886176, 3431593682, 1783435471, 2941848543},
				PC:  4902344,
				SR:  41495,
				USP: 2322602,
				SSP: 7915082,
				RAM: [][2]uint32{{4902340, 152}, {4902341, 103}, {4902342, 72}, {4902343, 3}, {7915080, 97}, {7915081, 126}, {4902344, 68}, {4902345, 83}},
			},
			want: cpuState{
				D:   [8]uint32{4188791806, 701266004, 2620792223, 1523264027, 2471566953, 204235478, 50810715, 2026526396},
				A:   [7]uint32{451417472, 4225087265, 2634435366, 2755886176, 3431593682, 1783435471, 2941848543},
				PC:  4902346,
				SR:  41472,
				USP: 2322602,
				SSP: 7915080,
				RAM: [][2]uint32{{4902340, 152}, {4902341, 103}, {4902342, 72}, {4902343, 3}, {7915080, 97}, {7915081, 126}, {4902344, 68}, {4902345, 83}},
				Cycles: 10,
			},
		},
		{
			name: "2000 SUB.w D3, (d8, A0, Xn) 9770",
			init: cpuState{
				D:   [8]uint32{2469074980, 1570600625, 2927152919, 137328580, 1047357137, 2368697655, 3555661399, 1024636318},
				A:   [7]uint32{240433839, 2990126750, 549506027, 2898860265, 2394711043, 1502593005, 726682597},
				PC:  3612516,
				SR:  1536,
				USP: 3024784,
				SSP: 7237294,
				RAM: [][2]uint32{{3612512, 151}, {3612513, 112}, {3612514, 77}, {3612515, 218}, {3612516, 105}, {3612517, 127}, {12722522, 228}, {12722523, 213}, {3612518, 180}, {3612519, 138}},
			},
			want: cpuState{
				D:   [8]uint32{2469074980, 1570600625, 2927152919, 137328580, 1047357137, 2368697655, 3555661399, 1024636318},
				A:   [7]uint32{240433839, 2990126750, 549506027, 2898860265, 2394711043, 1502593005, 726682597},
				PC:  3612520,
				SR:  1538,
				USP: 3024784,
				SSP: 7237294,
				RAM: [][2]uint32{{3612512, 151}, {3612513, 112}, {3612514, 77}, {3612515, 218}, {3612516, 105}, {3612517, 127}, {12722522, 109}, {12722523, 17}, {3612518, 180}, {3612519, 138}},
				Cycles: 18,
			},
		},
		{
			name: "001 SUB.w 7, D5 5f45",
			init: 			cpuState{
				D:   [8]uint32{2119332632, 4234872393, 2672373334, 2764724144, 365162105, 3675552603, 2729398510, 2609950995},
				A:   [7]uint32{2745708745, 2433937228, 3180607223, 3808226230, 3713213029, 3492578498, 613601061},
				PC:  15302960,
				SR:  1308,
				USP: 5394232,
				SSP: 67270,
				RAM: [][2]uint32{{15302956, 95}, {15302957, 69}, {15302958, 126}, {15302959, 134}, {15302960, 84}, {15302961, 189}},
			},
			want: 			cpuState{
				D:   [8]uint32{2119332632, 4234872393, 2672373334, 2764724144, 365162105, 3675552596, 2729398510, 2609950995},
				A:   [7]uint32{2745708745, 2433937228, 3180607223, 3808226230, 3713213029, 3492578498, 613601061},
				PC:  15302962,
				SR:  1280,
				USP: 5394232,
				SSP: 67270,
				RAM: [][2]uint32{{15302956, 95}, {15302957, 69}, {15302958, 126}, {15302959, 134}, {15302960, 84}, {15302961, 189}},
				Cycles: 4,
			},
		},
		{
			name: "290 SUB.w #, (A4)+ 045c",
			init: 			cpuState{
				D:   [8]uint32{2105288210, 1756808936, 1818220885, 4023779166, 2734552124, 3785032619, 545538005, 1571346109},
				A:   [7]uint32{3371874760, 49034216, 3664241101, 973775855, 231279142, 2068141644, 73380661},
				PC:  10373590,
				SR:  9241,
				USP: 12764466,
				SSP: 3328590,
				RAM: [][2]uint32{{10373586, 4}, {10373587, 92}, {10373588, 230}, {10373589, 173}, {10373590, 2}, {10373591, 0}, {13175334, 162}, {13175335, 131}, {10373592, 2}, {10373593, 238}},
			},
			want: 			cpuState{
				D:   [8]uint32{2105288210, 1756808936, 1818220885, 4023779166, 2734552124, 3785032619, 545538005, 1571346109},
				A:   [7]uint32{3371874760, 49034216, 3664241101, 973775855, 231279144, 2068141644, 73380661},
				PC:  10373594,
				SR:  9241,
				USP: 12764466,
				SSP: 3328590,
				RAM: [][2]uint32{{10373586, 4}, {10373587, 92}, {10373588, 230}, {10373589, 173}, {10373590, 2}, {10373591, 0}, {13175334, 187}, {13175335, 214}, {10373592, 2}, {10373593, 238}},
				Cycles: 16,
			},
		},
		{
			name: "596 SUB.w 6, (A7)+ 5d5f",
			init: 			cpuState{
				D:   [8]uint32{2164755008, 1750114559, 2529706987, 1321784092, 751086105, 1101200989, 2315084897, 3472730403},
				A:   [7]uint32{2159492922, 2086265725, 228035740, 1887613018, 3755319228, 392996690, 1169718263},
				PC:  217472,
				SR:  1562,
				USP: 9536890,
				SSP: 1548866,
				RAM: [][2]uint32{{217468, 93}, {217469, 95}, {217470, 155}, {217471, 169}, {9536890, 93}, {9536891, 146}, {217472, 118}, {217473, 205}},
			},
			want: 			cpuState{
				D:   [8]uint32{2164755008, 1750114559, 2529706987, 1321784092, 751086105, 1101200989, 2315084897, 3472730403},
				A:   [7]uint32{2159492922, 2086265725, 228035740, 1887613018, 3755319228, 392996690, 1169718263},
				PC:  217474,
				SR:  1536,
				USP: 9536892,
				SSP: 1548866,
				RAM: [][2]uint32{{217468, 93}, {217469, 95}, {217470, 155}, {217471, 169}, {9536890, 93}, {9536891, 140}, {217472, 118}, {217473, 205}},
				Cycles: 12,
			},
		},
		{
			name: "866 SUB.w D1, (A1) 9351",
			init: 			cpuState{
				D:   [8]uint32{3481148548, 3307739564, 813676388, 3165209541, 163570699, 2715555967, 3579454923, 1588135811},
				A:   [7]uint32{512653599, 3753832960, 484022674, 502790415, 46565554, 4243881184, 1815453423},
				PC:  11577740,
				SR:  8452,
				USP: 12846586,
				SSP: 14939822,
				RAM: [][2]uint32{{11577736, 147}, {11577737, 81}, {11577738, 67}, {11577739, 84}, {12513792, 178}, {12513793, 73}, {11577740, 9}, {11577741, 79}},
			},
			want: 			cpuState{
				D:   [8]uint32{3481148548, 3307739564, 813676388, 3165209541, 163570699, 2715555967, 3579454923, 1588135811},
				A:   [7]uint32{512653599, 3753832960, 484022674, 502790415, 46565554, 4243881184, 1815453423},
				PC:  11577742,
				SR:  8456,
				USP: 12846586,
				SSP: 14939822,
				RAM: [][2]uint32{{11577736, 147}, {11577737, 81}, {11577738, 67}, {11577739, 84}, {12513792, 152}, {12513793, 157}, {11577740, 9}, {11577741, 79}},
				Cycles: 12,
			},
		},
		{
			name: "1135 SUB.w 6, D2 5d42",
			init: 			cpuState{
				D:   [8]uint32{4133086755, 499037529, 1187750506, 3572206449, 2820815985, 77170300, 2866099705, 2117439120},
				A:   [7]uint32{2521373720, 3005598047, 597012829, 929666522, 4038602990, 3890877714, 700979314},
				PC:  3079152,
				SR:  9735,
				USP: 7020270,
				SSP: 11787534,
				RAM: [][2]uint32{{3079148, 93}, {3079149, 66}, {3079150, 99}, {3079151, 159}, {3079152, 229}, {3079153, 213}},
			},
			want: 			cpuState{
				D:   [8]uint32{4133086755, 499037529, 1187750500, 3572206449, 2820815985, 77170300, 2866099705, 2117439120},
				A:   [7]uint32{2521373720, 3005598047, 597012829, 929666522, 4038602990, 3890877714, 700979314},
				PC:  3079154,
				SR:  9736,
				USP: 7020270,
				SSP: 11787534,
				RAM: [][2]uint32{{3079148, 93}, {3079149, 66}, {3079150, 99}, {3079151, 159}, {3079152, 229}, {3079153, 213}},
				Cycles: 4,
			},
		},
		{
			name: "1423 SUB.w A3, D2 944b",
			init: 			cpuState{
				D:   [8]uint32{2954680307, 3461870884, 2665683, 2185485584, 4159547268, 4124245745, 564267046, 2701506596},
				A:   [7]uint32{1099750516, 2958153314, 1803829840, 1232146085, 347588994, 3440421672, 2536952048},
				PC:  15069736,
				SR:  8205,
				USP: 812780,
				SSP: 3357490,
				RAM: [][2]uint32{{15069732, 148}, {15069733, 75}, {15069734, 184}, {15069735, 225}, {15069736, 67}, {15069737, 27}},
			},
			want: 			cpuState{
				D:   [8]uint32{2954680307, 3461870884, 2661934, 2185485584, 4159547268, 4124245745, 564267046, 2701506596},
				A:   [7]uint32{1099750516, 2958153314, 1803829840, 1232146085, 347588994, 3440421672, 2536952048},
				PC:  15069738,
				SR:  8200,
				USP: 812780,
				SSP: 3357490,
				RAM: [][2]uint32{{15069732, 148}, {15069733, 75}, {15069734, 184}, {15069735, 225}, {15069736, 67}, {15069737, 27}},
				Cycles: 4,
			},
		},
		{
			name: "1683 SUB.w #, D1 0441",
			init: 			cpuState{
				D:   [8]uint32{3834850290, 976549843, 1608287997, 4116449788, 4211416812, 426286227, 713998807, 285106397},
				A:   [7]uint32{1507265872, 1478100596, 1158982116, 1635883695, 12127084, 3577157160, 1132965451},
				PC:  15004772,
				SR:  770,
				USP: 7626936,
				SSP: 8265770,
				RAM: [][2]uint32{{15004768, 4}, {15004769, 65}, {15004770, 119}, {15004771, 41}, {15004772, 29}, {15004773, 41}, {15004774, 168}, {15004775, 197}},
			},
			want: 			cpuState{
				D:   [8]uint32{3834850290, 976519338, 1608287997, 4116449788, 4211416812, 426286227, 713998807, 285106397},
				A:   [7]uint32{1507265872, 1478100596, 1158982116, 1635883695, 12127084, 3577157160, 1132965451},
				PC:  15004776,
				SR:  776,
				USP: 7626936,
				SSP: 8265770,
				RAM: [][2]uint32{{15004768, 4}, {15004769, 65}, {15004770, 119}, {15004771, 41}, {15004772, 29}, {15004773, 41}, {15004774, 168}, {15004775, 197}},
				Cycles: 8,
			},
		},
		{
			name: "1954 SUB.w (A6), D4 9856",
			init: 			cpuState{
				D:   [8]uint32{4136912828, 830807748, 3334816804, 3274990529, 434704578, 4061903898, 2511989771, 3987297436},
				A:   [7]uint32{905693106, 64786436, 2545787257, 1686414362, 58686327, 2558010727, 3997566704},
				PC:  744712,
				SR:  8449,
				USP: 12839440,
				SSP: 1735250,
				RAM: [][2]uint32{{744708, 152}, {744709, 86}, {744710, 217}, {744711, 149}, {4589296, 231}, {4589297, 239}, {744712, 185}, {744713, 57}},
			},
			want: 			cpuState{
				D:   [8]uint32{4136912828, 830807748, 3334816804, 3274990529, 434710739, 4061903898, 2511989771, 3987297436},
				A:   [7]uint32{905693106, 64786436, 2545787257, 1686414362, 58686327, 2558010727, 3997566704},
				PC:  744714,
				SR:  8465,
				USP: 12839440,
				SSP: 1735250,
				RAM: [][2]uint32{{744708, 152}, {744709, 86}, {744710, 217}, {744711, 149}, {4589296, 231}, {4589297, 239}, {744712, 185}, {744713, 57}},
				Cycles: 8,
			},
		},
		{
			name: "2212 SUB.w 8, A6 514e",
			init: 			cpuState{
				D:   [8]uint32{939462986, 678086656, 183164698, 3750745095, 1132006594, 2522636408, 271273895, 1889786030},
				A:   [7]uint32{1137438858, 1397511575, 200698868, 138800746, 2631567343, 84818727, 3267771413},
				PC:  14698732,
				SR:  9482,
				USP: 5840622,
				SSP: 9597270,
				RAM: [][2]uint32{{14698728, 81}, {14698729, 78}, {14698730, 168}, {14698731, 41}, {14698732, 4}, {14698733, 96}},
			},
			want: 			cpuState{
				D:   [8]uint32{939462986, 678086656, 183164698, 3750745095, 1132006594, 2522636408, 271273895, 1889786030},
				A:   [7]uint32{1137438858, 1397511575, 200698868, 138800746, 2631567343, 84818727, 3267771405},
				PC:  14698734,
				SR:  9482,
				USP: 5840622,
				SSP: 9597270,
				RAM: [][2]uint32{{14698728, 81}, {14698729, 78}, {14698730, 168}, {14698731, 41}, {14698732, 4}, {14698733, 96}},
				Cycles: 8,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSUB_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SUB.l D4, -(A6) 99a6",
			init: cpuState{
				D:   [8]uint32{2430741266, 2034761921, 1379322137, 3782162824, 2038882028, 1468357326, 3551250365, 3843388948},
				A:   [7]uint32{3953464159, 2314470778, 2738875704, 1762611768, 710786340, 164768393, 4009775052},
				PC:  16458270,
				SR:  8991,
				USP: 6416760,
				SSP: 9623548,
				RAM: [][2]uint32{{16458266, 153}, {16458267, 166}, {16458268, 163}, {16458269, 131}, {20424, 120}, {20425, 53}, {20426, 139}, {20427, 92}, {16458270, 161}, {16458271, 219}},
			},
			want: cpuState{
				D:   [8]uint32{2430741266, 2034761921, 1379322137, 3782162824, 2038882028, 1468357326, 3551250365, 3843388948},
				A:   [7]uint32{3953464159, 2314470778, 2738875704, 1762611768, 710786340, 164768393, 4009775048},
				PC:  16458272,
				SR:  8985,
				USP: 6416760,
				SSP: 9623548,
				RAM: [][2]uint32{{16458266, 153}, {16458267, 166}, {16458268, 163}, {16458269, 131}, {20424, 254}, {20425, 174}, {20426, 172}, {20427, 112}, {16458270, 161}, {16458271, 219}},
				Cycles: 22,
			},
		},
		{
			name: "500 SUB.l (d16, A1), D0 90a9",
			init: cpuState{
				D:   [8]uint32{334203677, 312705136, 3898025512, 4292677127, 1400971187, 181492914, 817515606, 3825712596},
				A:   [7]uint32{176575104, 3820522794, 960113371, 2718489097, 3678728455, 2696676619, 685288024},
				PC:  2744060,
				SR:  1282,
				USP: 1524878,
				SSP: 11240890,
				RAM: [][2]uint32{{2744056, 144}, {2744057, 169}, {2744058, 250}, {2744059, 235}, {2744060, 170}, {2744061, 236}, {12, 123}, {13, 114}, {14, 91}, {15, 162}, {7494562, 19}, {7494563, 233}, {7494564, 189}, {7494565, 67}},
			},
			want: cpuState{
				D:      [8]uint32{334203677, 312705136, 3898025512, 4292677127, 1400971187, 181492914, 817515606, 3825712596},
				A:      [7]uint32{176575104, 3820522794, 960113371, 2718489097, 3678728455, 2696676619, 685288024},
				PC:     2071092134,
				SR:     9474,
				USP:    1524878,
				SSP:    11240876,
				RAM:    [][2]uint32{{2744056, 144}, {2744057, 169}, {2744058, 250}, {2744059, 235}, {2744060, 170}, {2744061, 236}, {11240888, 222}, {11240889, 250}, {11240884, 5}, {11240885, 2}, {11240886, 0}, {11240887, 41}, {11240882, 144}, {11240883, 169}, {11240880, 136}, {11240881, 21}, {11240876, 144}, {11240877, 177}, {11240878, 227}, {11240879, 184}, {12, 123}, {13, 114}, {14, 91}, {15, 162}, {7494562, 19}, {7494563, 233}, {7494564, 189}, {7494565, 67}},
				Halted: true,
			},
		},
		{
			name: "1000 SUB.l D0, -(A1) 91a1",
			init: cpuState{
				D:   [8]uint32{6808300, 2348337226, 4144759068, 2994982435, 2430466917, 2679086928, 4115985396, 318674175},
				A:   [7]uint32{1148597021, 3839712008, 3417249186, 360891825, 185301989, 1791949484, 1046588297},
				PC:  12967430,
				SR:  8,
				USP: 6002182,
				SSP: 1339834,
				RAM: [][2]uint32{{12967426, 145}, {12967427, 161}, {12967428, 239}, {12967429, 168}, {14506756, 105}, {14506757, 182}, {14506758, 91}, {14506759, 221}, {12967430, 183}, {12967431, 156}},
			},
			want: cpuState{
				D:   [8]uint32{6808300, 2348337226, 4144759068, 2994982435, 2430466917, 2679086928, 4115985396, 318674175},
				A:   [7]uint32{1148597021, 3839712004, 3417249186, 360891825, 185301989, 1791949484, 1046588297},
				PC:  12967432,
				SR:  0,
				USP: 6002182,
				SSP: 1339834,
				RAM: [][2]uint32{{12967426, 145}, {12967427, 161}, {12967428, 239}, {12967429, 168}, {14506756, 105}, {14506757, 78}, {14506758, 120}, {14506759, 241}, {12967430, 183}, {12967431, 156}},
				Cycles: 22,
			},
		},
		{
			name: "1500 SUB.l D6, (A6) 9d96",
			init: cpuState{
				D:   [8]uint32{3733564301, 3722637472, 114559997, 3933481534, 2935905042, 2313870483, 1452650104, 3190890119},
				A:   [7]uint32{139049803, 783282066, 656214, 921942992, 1484801290, 3818258180, 483380725},
				PC:  16031108,
				SR:  42773,
				USP: 16716632,
				SSP: 11626030,
				RAM: [][2]uint32{{16031104, 157}, {16031105, 150}, {16031106, 2}, {16031107, 139}, {12, 188}, {13, 32}, {14, 255}, {15, 146}, {2162578, 251}, {2162579, 82}, {2162580, 19}, {2162581, 71}},
			},
			want: cpuState{
				D:      [8]uint32{3733564301, 3722637472, 114559997, 3933481534, 2935905042, 2313870483, 1452650104, 3190890119},
				A:      [7]uint32{139049803, 783282066, 656214, 921942992, 1484801290, 3818258180, 483380725},
				PC:     3156279190,
				SR:     10005,
				USP:    16716632,
				SSP:    11626016,
				RAM:    [][2]uint32{{16031104, 157}, {16031105, 150}, {16031106, 2}, {16031107, 139}, {11626028, 157}, {11626029, 130}, {11626024, 167}, {11626025, 21}, {11626026, 0}, {11626027, 244}, {11626022, 157}, {11626023, 150}, {11626020, 205}, {11626021, 245}, {11626016, 157}, {11626017, 149}, {11626018, 28}, {11626019, 207}, {12, 188}, {13, 32}, {14, 255}, {15, 146}, {2162578, 251}, {2162579, 82}, {2162580, 19}, {2162581, 71}},
				Halted: true,
			},
		},
		{
			name: "2000 SUB.l 3, (A7) 5797",
			init: cpuState{
				D:   [8]uint32{3985805992, 1833191869, 3276090607, 3595141033, 2409002652, 2098937895, 1946491201, 1758336557},
				A:   [7]uint32{1884066253, 1364613245, 3379868286, 1592759763, 1773256376, 392562107, 3253197953},
				PC:  10324572,
				SR:  42502,
				USP: 4468658,
				SSP: 1593630,
				RAM: [][2]uint32{{10324568, 87}, {10324569, 151}, {10324570, 40}, {10324571, 199}, {1593630, 231}, {1593631, 192}, {1593632, 224}, {1593633, 135}, {10324572, 31}, {10324573, 207}},
			},
			want: cpuState{
				D:   [8]uint32{3985805992, 1833191869, 3276090607, 3595141033, 2409002652, 2098937895, 1946491201, 1758336557},
				A:   [7]uint32{1884066253, 1364613245, 3379868286, 1592759763, 1773256376, 392562107, 3253197953},
				PC:  10324574,
				SR:  42504,
				USP: 4468658,
				SSP: 1593630,
				RAM: [][2]uint32{{10324568, 87}, {10324569, 151}, {10324570, 40}, {10324571, 199}, {1593630, 231}, {1593631, 192}, {1593632, 224}, {1593633, 132}, {10324572, 31}, {10324573, 207}},
				Cycles: 20,
			},
		},
		{
			name: "002 SUB.l (A1), D5 9a91",
			init: 			cpuState{
				D:   [8]uint32{2606660954, 659188214, 1352781446, 2770366245, 3208922050, 3779685790, 622523122, 407518609},
				A:   [7]uint32{4196752990, 2361897154, 2025421722, 3900552991, 3000613575, 3324072450, 4028659321},
				PC:  3530040,
				SR:  8460,
				USP: 13110440,
				SSP: 4324830,
				RAM: [][2]uint32{{3530036, 154}, {3530037, 145}, {3530038, 112}, {3530039, 217}, {13086914, 66}, {13086915, 171}, {13086916, 169}, {13086917, 172}, {3530040, 211}, {3530041, 31}},
			},
			want: 			cpuState{
				D:   [8]uint32{2606660954, 659188214, 1352781446, 2770366245, 3208922050, 2661139442, 622523122, 407518609},
				A:   [7]uint32{4196752990, 2361897154, 2025421722, 3900552991, 3000613575, 3324072450, 4028659321},
				PC:  3530042,
				SR:  8456,
				USP: 13110440,
				SSP: 4324830,
				RAM: [][2]uint32{{3530036, 154}, {3530037, 145}, {3530038, 112}, {3530039, 217}, {13086914, 66}, {13086915, 171}, {13086916, 169}, {13086917, 172}, {3530040, 211}, {3530041, 31}},
				Cycles: 14,
			},
		},
		{
			name: "286 SUB.l D3, (A2) 9792",
			init: 			cpuState{
				D:   [8]uint32{59199083, 1595762995, 3130454957, 2715258115, 3892121555, 2792890898, 2650111802, 1603078414},
				A:   [7]uint32{401529644, 3107859617, 2909750396, 428193391, 516028808, 1862055910, 682505418},
				PC:  8262092,
				SR:  8474,
				USP: 15549326,
				SSP: 3994376,
				RAM: [][2]uint32{{8262088, 151}, {8262089, 146}, {8262090, 131}, {8262091, 158}, {7292028, 125}, {7292029, 206}, {7292030, 89}, {7292031, 133}, {8262092, 121}, {8262093, 227}},
			},
			want: 			cpuState{
				D:   [8]uint32{59199083, 1595762995, 3130454957, 2715258115, 3892121555, 2792890898, 2650111802, 1603078414},
				A:   [7]uint32{401529644, 3107859617, 2909750396, 428193391, 516028808, 1862055910, 682505418},
				PC:  8262094,
				SR:  8475,
				USP: 15549326,
				SSP: 3994376,
				RAM: [][2]uint32{{8262088, 151}, {8262089, 146}, {8262090, 131}, {8262091, 158}, {7292028, 219}, {7292029, 246}, {7292030, 204}, {7292031, 130}, {8262092, 121}, {8262093, 227}},
				Cycles: 20,
			},
		},
		{
			name: "592 SUB.l 2, (d16, A2) 55aa",
			init: 			cpuState{
				D:   [8]uint32{2455304114, 3414663222, 465098773, 3439661891, 80208191, 1880111710, 3814381200, 2318706269},
				A:   [7]uint32{2112096916, 3313984612, 3245562061, 4177082600, 2826181998, 1804906310, 8829207},
				PC:  5729742,
				SR:  267,
				USP: 14903998,
				SSP: 6297012,
				RAM: [][2]uint32{{5729738, 85}, {5729739, 170}, {5729740, 155}, {5729741, 39}, {5729742, 109}, {5729743, 77}, {7533556, 99}, {7533557, 84}, {7533558, 189}, {7533559, 65}, {5729744, 248}, {5729745, 175}},
			},
			want: 			cpuState{
				D:   [8]uint32{2455304114, 3414663222, 465098773, 3439661891, 80208191, 1880111710, 3814381200, 2318706269},
				A:   [7]uint32{2112096916, 3313984612, 3245562061, 4177082600, 2826181998, 1804906310, 8829207},
				PC:  5729746,
				SR:  256,
				USP: 14903998,
				SSP: 6297012,
				RAM: [][2]uint32{{5729738, 85}, {5729739, 170}, {5729740, 155}, {5729741, 39}, {5729742, 109}, {5729743, 77}, {7533556, 99}, {7533557, 84}, {7533558, 189}, {7533559, 63}, {5729744, 248}, {5729745, 175}},
				Cycles: 24,
			},
		},
		{
			name: "891 SUB.l (d16, A4), D3 96ac",
			init: 			cpuState{
				D:   [8]uint32{949038051, 155688712, 1611192933, 4200259820, 454335471, 3298841500, 2427014881, 2929597118},
				A:   [7]uint32{3343196124, 3847450639, 1918669314, 2586153849, 1104573313, 2000906169, 131501165},
				PC:  11807788,
				SR:  1026,
				USP: 1817288,
				SSP: 9090992,
				RAM: [][2]uint32{{11807784, 150}, {11807785, 172}, {11807786, 173}, {11807787, 219}, {11807788, 68}, {11807789, 16}, {14033244, 103}, {14033245, 75}, {14033246, 234}, {14033247, 149}, {11807790, 185}, {11807791, 131}},
			},
			want: 			cpuState{
				D:   [8]uint32{949038051, 155688712, 1611192933, 2467231319, 454335471, 3298841500, 2427014881, 2929597118},
				A:   [7]uint32{3343196124, 3847450639, 1918669314, 2586153849, 1104573313, 2000906169, 131501165},
				PC:  11807792,
				SR:  1032,
				USP: 1817288,
				SSP: 9090992,
				RAM: [][2]uint32{{11807784, 150}, {11807785, 172}, {11807786, 173}, {11807787, 219}, {11807788, 68}, {11807789, 16}, {14033244, 103}, {14033245, 75}, {14033246, 234}, {14033247, 149}, {11807790, 185}, {11807791, 131}},
				Cycles: 18,
			},
		},
		{
			name: "1146 SUB.l A5, D5 9a8d",
			init: 			cpuState{
				D:   [8]uint32{3357893000, 3836479417, 3754655974, 4239606013, 527935093, 3508174258, 3485650007, 1545416878},
				A:   [7]uint32{3454462707, 3575365918, 406577035, 2641059711, 2968863998, 681355287, 3489255436},
				PC:  12249462,
				SR:  24,
				USP: 13473238,
				SSP: 11526766,
				RAM: [][2]uint32{{12249458, 154}, {12249459, 141}, {12249460, 102}, {12249461, 157}, {12249462, 146}, {12249463, 56}},
			},
			want: 			cpuState{
				D:   [8]uint32{3357893000, 3836479417, 3754655974, 4239606013, 527935093, 2826818971, 3485650007, 1545416878},
				A:   [7]uint32{3454462707, 3575365918, 406577035, 2641059711, 2968863998, 681355287, 3489255436},
				PC:  12249464,
				SR:  8,
				USP: 13473238,
				SSP: 11526766,
				RAM: [][2]uint32{{12249458, 154}, {12249459, 141}, {12249460, 102}, {12249461, 157}, {12249462, 146}, {12249463, 56}},
				Cycles: 8,
			},
		},
		{
			name: "1398 SUB.l 1, (d8, A3, Xn) 53b3",
			init: 			cpuState{
				D:   [8]uint32{952161269, 3769716348, 2140999876, 1647272602, 600273255, 1193782069, 1534221883, 1696531995},
				A:   [7]uint32{3625848051, 4041706157, 2741779219, 2856464729, 1874047661, 1061681771, 443327853},
				PC:  11779482,
				SR:  287,
				USP: 10910564,
				SSP: 377260,
				RAM: [][2]uint32{{11779478, 83}, {11779479, 179}, {11779480, 102}, {11779481, 202}, {11779482, 34}, {11779483, 85}, {4362078, 166}, {4362079, 249}, {4362080, 182}, {4362081, 31}, {11779484, 12}, {11779485, 46}},
			},
			want: 			cpuState{
				D:   [8]uint32{952161269, 3769716348, 2140999876, 1647272602, 600273255, 1193782069, 1534221883, 1696531995},
				A:   [7]uint32{3625848051, 4041706157, 2741779219, 2856464729, 1874047661, 1061681771, 443327853},
				PC:  11779486,
				SR:  264,
				USP: 10910564,
				SSP: 377260,
				RAM: [][2]uint32{{11779478, 83}, {11779479, 179}, {11779480, 102}, {11779481, 202}, {11779482, 34}, {11779483, 85}, {4362078, 166}, {4362079, 249}, {4362080, 182}, {4362081, 30}, {11779484, 12}, {11779485, 46}},
				Cycles: 26,
			},
		},
		{
			name: "1682 SUB.l 4, D7 5987",
			init: 			cpuState{
				D:   [8]uint32{1230001869, 1877316008, 1995686273, 3377386431, 73684092, 2590026583, 58748223, 2817594094},
				A:   [7]uint32{2404598328, 2174368868, 857966332, 1421773012, 3037320862, 1908315329, 818980972},
				PC:  3965290,
				SR:  1806,
				USP: 6741902,
				SSP: 526442,
				RAM: [][2]uint32{{3965286, 89}, {3965287, 135}, {3965288, 33}, {3965289, 36}, {3965290, 84}, {3965291, 152}},
			},
			want: 			cpuState{
				D:   [8]uint32{1230001869, 1877316008, 1995686273, 3377386431, 73684092, 2590026583, 58748223, 2817594090},
				A:   [7]uint32{2404598328, 2174368868, 857966332, 1421773012, 3037320862, 1908315329, 818980972},
				PC:  3965292,
				SR:  1800,
				USP: 6741902,
				SSP: 526442,
				RAM: [][2]uint32{{3965286, 89}, {3965287, 135}, {3965288, 33}, {3965289, 36}, {3965290, 84}, {3965291, 152}},
				Cycles: 8,
			},
		},
		{
			name: "1960 SUB.l 1, D5 5385",
			init: 			cpuState{
				D:   [8]uint32{2550440100, 3218368379, 2638704871, 3677903910, 2827224815, 3866596084, 434005910, 618377963},
				A:   [7]uint32{2436261233, 3320274335, 3616391948, 1616927799, 2409968591, 1090920067, 1518401393},
				PC:  670824,
				SR:  8706,
				USP: 5965214,
				SSP: 3730512,
				RAM: [][2]uint32{{670820, 83}, {670821, 133}, {670822, 10}, {670823, 52}, {670824, 172}, {670825, 181}},
			},
			want: 			cpuState{
				D:   [8]uint32{2550440100, 3218368379, 2638704871, 3677903910, 2827224815, 3866596083, 434005910, 618377963},
				A:   [7]uint32{2436261233, 3320274335, 3616391948, 1616927799, 2409968591, 1090920067, 1518401393},
				PC:  670826,
				SR:  8712,
				USP: 5965214,
				SSP: 3730512,
				RAM: [][2]uint32{{670820, 83}, {670821, 133}, {670822, 10}, {670823, 52}, {670824, 172}, {670825, 181}},
				Cycles: 8,
			},
		},
		{
			name: "2238 SUB.l D2, D3 9682",
			init: 			cpuState{
				D:   [8]uint32{2279142372, 3565360604, 1452486740, 1101642949, 1241846816, 2808182797, 1883088823, 1644443567},
				A:   [7]uint32{4236007951, 686762044, 2462579679, 3916473177, 3564423626, 3233361912, 896176337},
				PC:  3078826,
				SR:  10008,
				USP: 15018104,
				SSP: 5471352,
				RAM: [][2]uint32{{3078822, 150}, {3078823, 130}, {3078824, 104}, {3078825, 97}, {3078826, 116}, {3078827, 191}},
			},
			want: 			cpuState{
				D:   [8]uint32{2279142372, 3565360604, 1452486740, 3944123505, 1241846816, 2808182797, 1883088823, 1644443567},
				A:   [7]uint32{4236007951, 686762044, 2462579679, 3916473177, 3564423626, 3233361912, 896176337},
				PC:  3078828,
				SR:  10009,
				USP: 15018104,
				SSP: 5471352,
				RAM: [][2]uint32{{3078822, 150}, {3078823, 130}, {3078824, 104}, {3078825, 97}, {3078826, 116}, {3078827, 191}},
				Cycles: 8,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSUBA_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SUBA.w (A5), A2 94d5",
			init: cpuState{
				D:   [8]uint32{2555685699, 4294204953, 1208816045, 3095682307, 4075401804, 2797727569, 3906643456, 293716231},
				A:   [7]uint32{2222925949, 1147031860, 955217515, 563695126, 3926080718, 3321264132, 723868351},
				PC:  73010,
				SR:  9736,
				USP: 1517628,
				SSP: 9739654,
				RAM: [][2]uint32{{73006, 148}, {73007, 213}, {73008, 182}, {73009, 106}, {16152580, 232}, {16152581, 53}, {73010, 82}, {73011, 211}},
			},
			want: cpuState{
				D:   [8]uint32{2555685699, 4294204953, 1208816045, 3095682307, 4075401804, 2797727569, 3906643456, 293716231},
				A:   [7]uint32{2222925949, 1147031860, 955223606, 563695126, 3926080718, 3321264132, 723868351},
				PC:  73012,
				SR:  9736,
				USP: 1517628,
				SSP: 9739654,
				RAM: [][2]uint32{{73006, 148}, {73007, 213}, {73008, 182}, {73009, 106}, {16152580, 232}, {16152581, 53}, {73010, 82}, {73011, 211}},
				Cycles: 12,
			},
		},
		{
			name: "500 SUBA.w A4, A2 94cc",
			init: cpuState{
				D:   [8]uint32{2137760209, 1551224382, 1447424128, 3550651661, 1620025275, 1102141270, 309570704, 2381611821},
				A:   [7]uint32{2238744748, 4038488692, 2862719138, 292049888, 788491941, 3720204833, 1461451153},
				PC:  2290934,
				SR:  9235,
				USP: 695150,
				SSP: 9624948,
				RAM: [][2]uint32{{2290930, 148}, {2290931, 204}, {2290932, 238}, {2290933, 210}, {2290934, 187}, {2290935, 200}},
			},
			want: cpuState{
				D:   [8]uint32{2137760209, 1551224382, 1447424128, 3550651661, 1620025275, 1102141270, 309570704, 2381611821},
				A:   [7]uint32{2238744748, 4038488692, 2862690813, 292049888, 788491941, 3720204833, 1461451153},
				PC:  2290936,
				SR:  9235,
				USP: 695150,
				SSP: 9624948,
				RAM: [][2]uint32{{2290930, 148}, {2290931, 204}, {2290932, 238}, {2290933, 210}, {2290934, 187}, {2290935, 200}},
				Cycles: 8,
			},
		},
		{
			name: "1000 SUBA.w A4, A0 90cc",
			init: cpuState{
				D:   [8]uint32{3814257001, 2462933956, 574888176, 800588259, 1865021946, 2291471666, 867968397, 2302830458},
				A:   [7]uint32{1436659069, 3611165953, 4114781543, 661110361, 1278615945, 554176329, 3764800916},
				PC:  14373096,
				SR:  260,
				USP: 11068360,
				SSP: 15685160,
				RAM: [][2]uint32{{14373092, 144}, {14373093, 204}, {14373094, 98}, {14373095, 132}, {14373096, 179}, {14373097, 58}},
			},
			want: cpuState{
				D:   [8]uint32{3814257001, 2462933956, 574888176, 800588259, 1865021946, 2291471666, 867968397, 2302830458},
				A:   [7]uint32{1436650484, 3611165953, 4114781543, 661110361, 1278615945, 554176329, 3764800916},
				PC:  14373098,
				SR:  260,
				USP: 11068360,
				SSP: 15685160,
				RAM: [][2]uint32{{14373092, 144}, {14373093, 204}, {14373094, 98}, {14373095, 132}, {14373096, 179}, {14373097, 58}},
				Cycles: 8,
			},
		},
		{
			name: "1500 SUBA.w A5, A1 92cd",
			init: cpuState{
				D:   [8]uint32{855789783, 936511422, 1361020324, 366716107, 544931698, 1388469891, 621119327, 414792588},
				A:   [7]uint32{3902119118, 3586683336, 1885500271, 2956032494, 1564777523, 3870943353, 2576076073},
				PC:  10240666,
				SR:  41229,
				USP: 16497470,
				SSP: 15277322,
				RAM: [][2]uint32{{10240662, 146}, {10240663, 205}, {10240664, 185}, {10240665, 198}, {10240666, 80}, {10240667, 242}},
			},
			want: cpuState{
				D:   [8]uint32{855789783, 936511422, 1361020324, 366716107, 544931698, 1388469891, 621119327, 414792588},
				A:   [7]uint32{3902119118, 3586689359, 1885500271, 2956032494, 1564777523, 3870943353, 2576076073},
				PC:  10240668,
				SR:  41229,
				USP: 16497470,
				SSP: 15277322,
				RAM: [][2]uint32{{10240662, 146}, {10240663, 205}, {10240664, 185}, {10240665, 198}, {10240666, 80}, {10240667, 242}},
				Cycles: 8,
			},
		},
		{
			name: "2000 SUBA.w (A5)+, A1 92dd",
			init: cpuState{
				D:   [8]uint32{1200094438, 2710464425, 1491532271, 3415499353, 1505559846, 3662795322, 1852107100, 1802724523},
				A:   [7]uint32{2304171441, 4137259190, 1024336870, 3269010179, 3422266355, 742018199, 2420570018},
				PC:  2189056,
				SR:  33024,
				USP: 9280120,
				SSP: 4328632,
				RAM: [][2]uint32{{2189052, 146}, {2189053, 221}, {2189054, 242}, {2189055, 186}, {12, 58}, {13, 228}, {14, 187}, {15, 94}, {14990174, 251}, {14990175, 64}, {14990176, 202}, {14990177, 106}},
			},
			want: cpuState{
				D:      [8]uint32{1200094438, 2710464425, 1491532271, 3415499353, 1505559846, 3662795322, 1852107100, 1802724523},
				A:      [7]uint32{2304171441, 4137259190, 1024336870, 3269010179, 3422266355, 742018201, 2420570018},
				PC:     988068706,
				SR:     8448,
				USP:    9280120,
				SSP:    4328618,
				RAM:    [][2]uint32{{2189052, 146}, {2189053, 221}, {2189054, 242}, {2189055, 186}, {4328630, 102}, {4328631, 254}, {4328626, 129}, {4328627, 0}, {4328628, 0}, {4328629, 33}, {4328624, 146}, {4328625, 221}, {4328622, 76}, {4328623, 151}, {4328618, 146}, {4328619, 209}, {4328620, 44}, {4328621, 58}, {12, 58}, {13, 228}, {14, 187}, {15, 94}, {14990174, 251}, {14990175, 64}, {14990176, 202}, {14990177, 106}},
				Halted: true,
			},
		},
		{
			name: "001 SUBA.w (A6), A4 98d6",
			init: 			cpuState{
				D:   [8]uint32{2749922115, 2033264101, 1443574956, 2826796438, 3115945222, 2821787148, 2461611764, 1915997583},
				A:   [7]uint32{3905252680, 3210093549, 3472175639, 4047002023, 1741206572, 2655788957, 4184664524},
				PC:  6875830,
				SR:  9226,
				USP: 3170374,
				SSP: 9948500,
				RAM: [][2]uint32{{6875826, 152}, {6875827, 214}, {6875828, 61}, {6875829, 38}, {7137740, 76}, {7137741, 8}, {6875830, 162}, {6875831, 24}},
			},
			want: 			cpuState{
				D:   [8]uint32{2749922115, 2033264101, 1443574956, 2826796438, 3115945222, 2821787148, 2461611764, 1915997583},
				A:   [7]uint32{3905252680, 3210093549, 3472175639, 4047002023, 1741187108, 2655788957, 4184664524},
				PC:  6875832,
				SR:  9226,
				USP: 3170374,
				SSP: 9948500,
				RAM: [][2]uint32{{6875826, 152}, {6875827, 214}, {6875828, 61}, {6875829, 38}, {7137740, 76}, {7137741, 8}, {6875830, 162}, {6875831, 24}},
				Cycles: 12,
			},
		},
		{
			name: "302 SUBA.w (A7), A0 90d7",
			init: 			cpuState{
				D:   [8]uint32{3048428256, 1542704025, 2459153122, 3988070680, 3694997139, 3277545225, 2320225808, 341294172},
				A:   [7]uint32{1421086838, 366903764, 2764968967, 3757618705, 4265344832, 915346110, 2003003771},
				PC:  9973226,
				SR:  1033,
				USP: 8380178,
				SSP: 16474316,
				RAM: [][2]uint32{{9973222, 144}, {9973223, 215}, {9973224, 163}, {9973225, 255}, {8380178, 184}, {8380179, 193}, {9973226, 248}, {9973227, 237}},
			},
			want: 			cpuState{
				D:   [8]uint32{3048428256, 1542704025, 2459153122, 3988070680, 3694997139, 3277545225, 2320225808, 341294172},
				A:   [7]uint32{1421105077, 366903764, 2764968967, 3757618705, 4265344832, 915346110, 2003003771},
				PC:  9973228,
				SR:  1033,
				USP: 8380178,
				SSP: 16474316,
				RAM: [][2]uint32{{9973222, 144}, {9973223, 215}, {9973224, 163}, {9973225, 255}, {8380178, 184}, {8380179, 193}, {9973226, 248}, {9973227, 237}},
				Cycles: 12,
			},
		},
		{
			name: "584 SUBA.w D0, A5 9ac0",
			init: 			cpuState{
				D:   [8]uint32{1972966290, 3653273218, 2843781539, 2382368001, 3909766718, 879036876, 2568979941, 3317315172},
				A:   [7]uint32{3801798335, 2716437759, 1604879303, 1077956428, 2449386138, 47232405, 2481715294},
				PC:  436602,
				SR:  9225,
				USP: 6113300,
				SSP: 15441430,
				RAM: [][2]uint32{{436598, 154}, {436599, 192}, {436600, 247}, {436601, 8}, {436602, 158}, {436603, 190}},
			},
			want: 			cpuState{
				D:   [8]uint32{1972966290, 3653273218, 2843781539, 2382368001, 3909766718, 879036876, 2568979941, 3317315172},
				A:   [7]uint32{3801798335, 2716437759, 1604879303, 1077956428, 2449386138, 47227395, 2481715294},
				PC:  436604,
				SR:  9225,
				USP: 6113300,
				SSP: 15441430,
				RAM: [][2]uint32{{436598, 154}, {436599, 192}, {436600, 247}, {436601, 8}, {436602, 158}, {436603, 190}},
				Cycles: 8,
			},
		},
		{
			name: "845 SUBA.w D2, A2 94c2",
			init: 			cpuState{
				D:   [8]uint32{2790878341, 3879797825, 3466972505, 3297953727, 1700345790, 1921499447, 585550072, 2107138907},
				A:   [7]uint32{3837716347, 2270662000, 2504978214, 2193939084, 1832082803, 1147539073, 403678926},
				PC:  621134,
				SR:  8466,
				USP: 7211648,
				SSP: 3824040,
				RAM: [][2]uint32{{621130, 148}, {621131, 194}, {621132, 30}, {621133, 6}, {621134, 139}, {621135, 228}},
			},
			want: 			cpuState{
				D:   [8]uint32{2790878341, 3879797825, 3466972505, 3297953727, 1700345790, 1921499447, 585550072, 2107138907},
				A:   [7]uint32{3837716347, 2270662000, 2504991181, 2193939084, 1832082803, 1147539073, 403678926},
				PC:  621136,
				SR:  8466,
				USP: 7211648,
				SSP: 3824040,
				RAM: [][2]uint32{{621130, 148}, {621131, 194}, {621132, 30}, {621133, 6}, {621134, 139}, {621135, 228}},
				Cycles: 8,
			},
		},
		{
			name: "1145 SUBA.w D6, A2 94c6",
			init: 			cpuState{
				D:   [8]uint32{3305352028, 3851713904, 430752153, 3128083971, 1690165557, 498861699, 1480820131, 3729487950},
				A:   [7]uint32{192426863, 3214404222, 463021687, 3490385649, 3483054781, 2382329587, 639304131},
				PC:  6849380,
				SR:  9995,
				USP: 2195244,
				SSP: 16535762,
				RAM: [][2]uint32{{6849376, 148}, {6849377, 198}, {6849378, 119}, {6849379, 123}, {6849380, 176}, {6849381, 88}},
			},
			want: 			cpuState{
				D:   [8]uint32{3305352028, 3851713904, 430752153, 3128083971, 1690165557, 498861699, 1480820131, 3729487950},
				A:   [7]uint32{192426863, 3214404222, 463053012, 3490385649, 3483054781, 2382329587, 639304131},
				PC:  6849382,
				SR:  9995,
				USP: 2195244,
				SSP: 16535762,
				RAM: [][2]uint32{{6849376, 148}, {6849377, 198}, {6849378, 119}, {6849379, 123}, {6849380, 176}, {6849381, 88}},
				Cycles: 8,
			},
		},
		{
			name: "1437 SUBA.w A2, A1 92ca",
			init: 			cpuState{
				D:   [8]uint32{3237635220, 201712497, 1367331968, 56976497, 4090437655, 1150408550, 3974503516, 68132735},
				A:   [7]uint32{4162847519, 433976291, 2157751822, 1091650368, 618304630, 3745805637, 3903830194},
				PC:  3557980,
				SR:  10001,
				USP: 11616856,
				SSP: 14972202,
				RAM: [][2]uint32{{3557976, 146}, {3557977, 202}, {3557978, 142}, {3557979, 149}, {3557980, 80}, {3557981, 182}},
			},
			want: 			cpuState{
				D:   [8]uint32{3237635220, 201712497, 1367331968, 56976497, 4090437655, 1150408550, 3974503516, 68132735},
				A:   [7]uint32{4162847519, 433997269, 2157751822, 1091650368, 618304630, 3745805637, 3903830194},
				PC:  3557982,
				SR:  10001,
				USP: 11616856,
				SSP: 14972202,
				RAM: [][2]uint32{{3557976, 146}, {3557977, 202}, {3557978, 142}, {3557979, 149}, {3557980, 80}, {3557981, 182}},
				Cycles: 8,
			},
		},
		{
			name: "1689 SUBA.w D1, A2 94c1",
			init: 			cpuState{
				D:   [8]uint32{2987270101, 911051559, 3391254728, 3920636454, 3475195869, 1188734147, 2779350530, 4237802019},
				A:   [7]uint32{222821053, 1447781643, 693718113, 1806122842, 3963721294, 3973164355, 3261544078},
				PC:  4249482,
				SR:  1301,
				USP: 3912118,
				SSP: 3291622,
				RAM: [][2]uint32{{4249478, 148}, {4249479, 193}, {4249480, 147}, {4249481, 61}, {4249482, 181}, {4249483, 71}},
			},
			want: 			cpuState{
				D:   [8]uint32{2987270101, 911051559, 3391254728, 3920636454, 3475195869, 1188734147, 2779350530, 4237802019},
				A:   [7]uint32{222821053, 1447781643, 693748026, 1806122842, 3963721294, 3973164355, 3261544078},
				PC:  4249484,
				SR:  1301,
				USP: 3912118,
				SSP: 3291622,
				RAM: [][2]uint32{{4249478, 148}, {4249479, 193}, {4249480, 147}, {4249481, 61}, {4249482, 181}, {4249483, 71}},
				Cycles: 8,
			},
		},
		{
			name: "1918 SUBA.w (A7), A1 92d7",
			init: 			cpuState{
				D:   [8]uint32{3142202658, 2958074348, 1829944345, 2033835192, 1580645474, 2771917359, 237847315, 2133633253},
				A:   [7]uint32{387453363, 3372275445, 217334617, 2399963080, 2158360964, 1605760981, 2073712381},
				PC:  13813922,
				SR:  8215,
				USP: 15236944,
				SSP: 640250,
				RAM: [][2]uint32{{13813918, 146}, {13813919, 215}, {13813920, 73}, {13813921, 90}, {640250, 72}, {640251, 5}, {13813922, 3}, {13813923, 173}},
			},
			want: 			cpuState{
				D:   [8]uint32{3142202658, 2958074348, 1829944345, 2033835192, 1580645474, 2771917359, 237847315, 2133633253},
				A:   [7]uint32{387453363, 3372257008, 217334617, 2399963080, 2158360964, 1605760981, 2073712381},
				PC:  13813924,
				SR:  8215,
				USP: 15236944,
				SSP: 640250,
				RAM: [][2]uint32{{13813918, 146}, {13813919, 215}, {13813920, 73}, {13813921, 90}, {640250, 72}, {640251, 5}, {13813922, 3}, {13813923, 173}},
				Cycles: 12,
			},
		},
		{
			name: "2188 SUBA.w -(A0), A2 94e0",
			init: 			cpuState{
				D:   [8]uint32{3687633757, 789898880, 1712717833, 3468901351, 3658927060, 3586995811, 4058591503, 2465864111},
				A:   [7]uint32{3815214846, 974848309, 4193793844, 2727622204, 324231817, 3845084081, 1991074749},
				PC:  15870824,
				SR:  1555,
				USP: 10555158,
				SSP: 6212122,
				RAM: [][2]uint32{{15870820, 148}, {15870821, 224}, {15870822, 181}, {15870823, 1}, {6786812, 180}, {6786813, 110}, {15870824, 62}, {15870825, 109}},
			},
			want: 			cpuState{
				D:   [8]uint32{3687633757, 789898880, 1712717833, 3468901351, 3658927060, 3586995811, 4058591503, 2465864111},
				A:   [7]uint32{3815214844, 974848309, 4193813190, 2727622204, 324231817, 3845084081, 1991074749},
				PC:  15870826,
				SR:  1555,
				USP: 10555158,
				SSP: 6212122,
				RAM: [][2]uint32{{15870820, 148}, {15870821, 224}, {15870822, 181}, {15870823, 1}, {6786812, 180}, {6786813, 110}, {15870824, 62}, {15870825, 109}},
				Cycles: 14,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSUBA_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SUBA.l A7, A5 9bcf",
			init: cpuState{
				D:   [8]uint32{2927985550, 2572516369, 3659843338, 2212692435, 329454559, 380389395, 81115122, 3163900104},
				A:   [7]uint32{3354378056, 3285426378, 3967998792, 1787116354, 3683824708, 3322511701, 257399086},
				PC:  1027382,
				SR:  9730,
				USP: 5566452,
				SSP: 5638490,
				RAM: [][2]uint32{{1027378, 155}, {1027379, 207}, {1027380, 80}, {1027381, 239}, {1027382, 117}, {1027383, 14}},
			},
			want: cpuState{
				D:   [8]uint32{2927985550, 2572516369, 3659843338, 2212692435, 329454559, 380389395, 81115122, 3163900104},
				A:   [7]uint32{3354378056, 3285426378, 3967998792, 1787116354, 3683824708, 3316873211, 257399086},
				PC:  1027384,
				SR:  9730,
				USP: 5566452,
				SSP: 5638490,
				RAM: [][2]uint32{{1027378, 155}, {1027379, 207}, {1027380, 80}, {1027381, 239}, {1027382, 117}, {1027383, 14}},
				Cycles: 8,
			},
		},
		{
			name: "500 SUBA.l (A2), A5 9bd2",
			init: cpuState{
				D:   [8]uint32{2185894080, 2051541787, 2533431815, 1356192708, 759413790, 2994854005, 2289983088, 3838686731},
				A:   [7]uint32{1899953752, 78137318, 2480945130, 947692529, 1422852961, 1145668129, 734184684},
				PC:  5085372,
				SR:  34568,
				USP: 5238910,
				SSP: 7270852,
				RAM: [][2]uint32{{5085368, 155}, {5085369, 210}, {5085370, 250}, {5085371, 168}, {14694378, 191}, {14694379, 183}, {14694380, 218}, {14694381, 187}, {5085372, 80}, {5085373, 41}},
			},
			want: cpuState{
				D:   [8]uint32{2185894080, 2051541787, 2533431815, 1356192708, 759413790, 2994854005, 2289983088, 3838686731},
				A:   [7]uint32{1899953752, 78137318, 2480945130, 947692529, 1422852961, 2224138086, 734184684},
				PC:  5085374,
				SR:  34568,
				USP: 5238910,
				SSP: 7270852,
				RAM: [][2]uint32{{5085368, 155}, {5085369, 210}, {5085370, 250}, {5085371, 168}, {14694378, 191}, {14694379, 183}, {14694380, 218}, {14694381, 187}, {5085372, 80}, {5085373, 41}},
				Cycles: 14,
			},
		},
		{
			name: "1000 SUBA.l #, A7 9ffc",
			init: cpuState{
				D:   [8]uint32{1249772816, 1518020361, 2884699220, 3864711330, 1911106808, 3761841370, 2676111703, 923855093},
				A:   [7]uint32{1873603648, 46024271, 760093153, 599376497, 3846156052, 3086390888, 3290626641},
				PC:  14655082,
				SR:  32782,
				USP: 8461784,
				SSP: 215396,
				RAM: [][2]uint32{{14655078, 159}, {14655079, 252}, {14655080, 246}, {14655081, 140}, {14655082, 200}, {14655083, 189}, {14655084, 93}, {14655085, 63}, {14655086, 180}, {14655087, 241}},
			},
			want: cpuState{
				D:   [8]uint32{1249772816, 1518020361, 2884699220, 3864711330, 1911106808, 3761841370, 2676111703, 923855093},
				A:   [7]uint32{1873603648, 46024271, 760093153, 599376497, 3846156052, 3086390888, 3290626641},
				PC:  14655088,
				SR:  32782,
				USP: 167007515,
				SSP: 215396,
				RAM: [][2]uint32{{14655078, 159}, {14655079, 252}, {14655080, 246}, {14655081, 140}, {14655082, 200}, {14655083, 189}, {14655084, 93}, {14655085, 63}, {14655086, 180}, {14655087, 241}},
				Cycles: 16,
			},
		},
		{
			name: "1500 SUBA.l (A3)+, A7 9fdb",
			init: cpuState{
				D:   [8]uint32{4278707095, 3234980542, 852299093, 364256079, 3806006670, 160748904, 1313270789, 784579430},
				A:   [7]uint32{3699481401, 2977221355, 823793567, 3976332257, 492966052, 4180531494, 216652224},
				PC:  6827910,
				SR:  1284,
				USP: 9251184,
				SSP: 9116262,
				RAM: [][2]uint32{{6827906, 159}, {6827907, 219}, {6827908, 183}, {6827909, 74}, {12, 235}, {13, 196}, {14, 251}, {15, 24}, {12909336, 99}, {12909337, 153}, {12909338, 50}, {12909339, 37}},
			},
			want: cpuState{
				D:      [8]uint32{4278707095, 3234980542, 852299093, 364256079, 3806006670, 160748904, 1313270789, 784579430},
				A:      [7]uint32{3699481401, 2977221355, 823793567, 3976332257, 492966052, 4180531494, 216652224},
				PC:     3955555100,
				SR:     9476,
				USP:    9251184,
				SSP:    9116248,
				RAM:    [][2]uint32{{6827906, 159}, {6827907, 219}, {6827908, 183}, {6827909, 74}, {9116260, 47}, {9116261, 132}, {9116256, 5}, {9116257, 4}, {9116258, 0}, {9116259, 104}, {9116254, 159}, {9116255, 219}, {9116252, 3}, {9116253, 225}, {9116248, 159}, {9116249, 209}, {9116250, 237}, {9116251, 2}, {12, 235}, {13, 196}, {14, 251}, {15, 24}, {12909336, 99}, {12909337, 153}, {12909338, 50}, {12909339, 37}},
				Halted: true,
			},
		},
		{
			name: "2000 SUBA.l (d16, A1), A4 99e9",
			init: cpuState{
				D:   [8]uint32{1991873915, 3961568039, 1651929968, 2575840779, 896837556, 2315102667, 842750628, 2507533045},
				A:   [7]uint32{1833300072, 2976508747, 660631124, 495463360, 665171967, 1762331000, 3466448591},
				PC:  6317088,
				SR:  41988,
				USP: 11337178,
				SSP: 6436056,
				RAM: [][2]uint32{{6317084, 153}, {6317085, 233}, {6317086, 168}, {6317087, 64}, {6317088, 191}, {6317089, 138}, {12, 66}, {13, 224}, {14, 234}, {15, 32}, {14740000, 94}, {14740001, 156}, {14740002, 1}, {14740003, 164}},
			},
			want: cpuState{
				D:      [8]uint32{1991873915, 3961568039, 1651929968, 2575840779, 896837556, 2315102667, 842750628, 2507533045},
				A:      [7]uint32{1833300072, 2976508747, 660631124, 495463360, 665171967, 1762331000, 3466448591},
				PC:     1122036260,
				SR:     9220,
				USP:    11337178,
				SSP:    6436042,
				RAM:    [][2]uint32{{6317084, 153}, {6317085, 233}, {6317086, 168}, {6317087, 64}, {6317088, 191}, {6317089, 138}, {6436054, 100}, {6436055, 30}, {6436050, 164}, {6436051, 4}, {6436052, 0}, {6436053, 96}, {6436048, 153}, {6436049, 233}, {6436046, 147}, {6436047, 139}, {6436042, 153}, {6436043, 245}, {6436044, 177}, {6436045, 105}, {12, 66}, {13, 224}, {14, 234}, {15, 32}, {14740000, 94}, {14740001, 156}, {14740002, 1}, {14740003, 164}},
				Halted: true,
			},
		},
		{
			name: "002 SUBA.l (d16, A1), A3 97e9",
			init: 			cpuState{
				D:   [8]uint32{708782290, 647690572, 3649943027, 2434845691, 3164707823, 1262546350, 440600223, 3746165771},
				A:   [7]uint32{3638999188, 3273045672, 612788967, 325184022, 2907110276, 3385813536, 3359253426},
				PC:  11812992,
				SR:  8711,
				USP: 3332360,
				SSP: 11183810,
				RAM: [][2]uint32{{11812988, 151}, {11812989, 233}, {11812990, 203}, {11812991, 68}, {11812992, 224}, {11812993, 92}, {1475052, 171}, {1475053, 159}, {1475054, 55}, {1475055, 114}, {11812994, 146}, {11812995, 6}},
			},
			want: 			cpuState{
				D:   [8]uint32{708782290, 647690572, 3649943027, 2434845691, 3164707823, 1262546350, 440600223, 3746165771},
				A:   [7]uint32{3638999188, 3273045672, 612788967, 1740812964, 2907110276, 3385813536, 3359253426},
				PC:  11812996,
				SR:  8711,
				USP: 3332360,
				SSP: 11183810,
				RAM: [][2]uint32{{11812988, 151}, {11812989, 233}, {11812990, 203}, {11812991, 68}, {11812992, 224}, {11812993, 92}, {1475052, 171}, {1475053, 159}, {1475054, 55}, {1475055, 114}, {11812994, 146}, {11812995, 6}},
				Cycles: 18,
			},
		},
		{
			name: "256 SUBA.l D4, A5 9bc4",
			init: 			cpuState{
				D:   [8]uint32{2414297300, 2293483720, 3716188142, 52972101, 1948491570, 3183387799, 1618761312, 227121215},
				A:   [7]uint32{3524886858, 1522425281, 2663639399, 950108214, 3018351307, 2392517955, 4013799689},
				PC:  9985708,
				SR:  8710,
				USP: 3161802,
				SSP: 16465860,
				RAM: [][2]uint32{{9985704, 155}, {9985705, 196}, {9985706, 75}, {9985707, 12}, {9985708, 12}, {9985709, 75}},
			},
			want: 			cpuState{
				D:   [8]uint32{2414297300, 2293483720, 3716188142, 52972101, 1948491570, 3183387799, 1618761312, 227121215},
				A:   [7]uint32{3524886858, 1522425281, 2663639399, 950108214, 3018351307, 444026385, 4013799689},
				PC:  9985710,
				SR:  8710,
				USP: 3161802,
				SSP: 16465860,
				RAM: [][2]uint32{{9985704, 155}, {9985705, 196}, {9985706, 75}, {9985707, 12}, {9985708, 12}, {9985709, 75}},
				Cycles: 8,
			},
		},
		{
			name: "532 SUBA.l (A7), A5 9bd7",
			init: 			cpuState{
				D:   [8]uint32{2487249157, 2643041892, 1517736582, 2889221922, 4196679390, 852674813, 2751976946, 607936363},
				A:   [7]uint32{4097537756, 3783819916, 3776853350, 723019129, 455372402, 1604096571, 1508680715},
				PC:  15789714,
				SR:  9218,
				USP: 12735580,
				SSP: 661112,
				RAM: [][2]uint32{{15789710, 155}, {15789711, 215}, {15789712, 184}, {15789713, 49}, {661112, 140}, {661113, 64}, {661114, 255}, {661115, 86}, {15789714, 95}, {15789715, 129}},
			},
			want: 			cpuState{
				D:   [8]uint32{2487249157, 2643041892, 1517736582, 2889221922, 4196679390, 852674813, 2751976946, 607936363},
				A:   [7]uint32{4097537756, 3783819916, 3776853350, 723019129, 455372402, 3545993957, 1508680715},
				PC:  15789716,
				SR:  9218,
				USP: 12735580,
				SSP: 661112,
				RAM: [][2]uint32{{15789710, 155}, {15789711, 215}, {15789712, 184}, {15789713, 49}, {661112, 140}, {661113, 64}, {661114, 255}, {661115, 86}, {15789714, 95}, {15789715, 129}},
				Cycles: 14,
			},
		},
		{
			name: "835 SUBA.l D3, A3 97c3",
			init: 			cpuState{
				D:   [8]uint32{1547012413, 584852732, 277088555, 2636980491, 2047253119, 527418607, 1554547417, 188854899},
				A:   [7]uint32{1596431847, 3888141891, 3763073962, 2392721159, 3707771348, 1374384966, 548355695},
				PC:  9573060,
				SR:  19,
				USP: 4259310,
				SSP: 15218300,
				RAM: [][2]uint32{{9573056, 151}, {9573057, 195}, {9573058, 11}, {9573059, 90}, {9573060, 164}, {9573061, 235}},
			},
			want: 			cpuState{
				D:   [8]uint32{1547012413, 584852732, 277088555, 2636980491, 2047253119, 527418607, 1554547417, 188854899},
				A:   [7]uint32{1596431847, 3888141891, 3763073962, 4050707964, 3707771348, 1374384966, 548355695},
				PC:  9573062,
				SR:  19,
				USP: 4259310,
				SSP: 15218300,
				RAM: [][2]uint32{{9573056, 151}, {9573057, 195}, {9573058, 11}, {9573059, 90}, {9573060, 164}, {9573061, 235}},
				Cycles: 8,
			},
		},
		{
			name: "1128 SUBA.l (d16, A4), A4 99ec",
			init: 			cpuState{
				D:   [8]uint32{1047862793, 2000153943, 2967091906, 3464471557, 3692204591, 1966963752, 197043691, 3396688393},
				A:   [7]uint32{2076858682, 882786115, 287509978, 360056927, 1015817341, 1110006843, 211459099},
				PC:  4534288,
				SR:  1309,
				USP: 15725564,
				SSP: 6646830,
				RAM: [][2]uint32{{4534284, 153}, {4534285, 236}, {4534286, 7}, {4534287, 145}, {4534288, 132}, {4534289, 107}, {9186318, 56}, {9186319, 215}, {9186320, 226}, {9186321, 247}, {4534290, 12}, {4534291, 21}},
			},
			want: 			cpuState{
				D:   [8]uint32{1047862793, 2000153943, 2967091906, 3464471557, 3692204591, 1966963752, 197043691, 3396688393},
				A:   [7]uint32{2076858682, 882786115, 287509978, 360056927, 62144902, 1110006843, 211459099},
				PC:  4534292,
				SR:  1309,
				USP: 15725564,
				SSP: 6646830,
				RAM: [][2]uint32{{4534284, 153}, {4534285, 236}, {4534286, 7}, {4534287, 145}, {4534288, 132}, {4534289, 107}, {9186318, 56}, {9186319, 215}, {9186320, 226}, {9186321, 247}, {4534290, 12}, {4534291, 21}},
				Cycles: 18,
			},
		},
		{
			name: "1390 SUBA.l (d16, A2), A5 9bea",
			init: 			cpuState{
				D:   [8]uint32{1625492505, 1697869579, 70458088, 3364522584, 2765499260, 3629474352, 1134777925, 1338631517},
				A:   [7]uint32{1796445678, 1510522240, 3639639190, 2170311807, 1147662174, 2641372087, 1279772182},
				PC:  4681930,
				SR:  1280,
				USP: 8369808,
				SSP: 12518296,
				RAM: [][2]uint32{{4681926, 155}, {4681927, 234}, {4681928, 248}, {4681929, 126}, {4681930, 57}, {4681931, 167}, {15758612, 42}, {15758613, 187}, {15758614, 213}, {15758615, 252}, {4681932, 23}, {4681933, 2}},
			},
			want: 			cpuState{
				D:   [8]uint32{1625492505, 1697869579, 70458088, 3364522584, 2765499260, 3629474352, 1134777925, 1338631517},
				A:   [7]uint32{1796445678, 1510522240, 3639639190, 2170311807, 1147662174, 1924419003, 1279772182},
				PC:  4681934,
				SR:  1280,
				USP: 8369808,
				SSP: 12518296,
				RAM: [][2]uint32{{4681926, 155}, {4681927, 234}, {4681928, 248}, {4681929, 126}, {4681930, 57}, {4681931, 167}, {15758612, 42}, {15758613, 187}, {15758614, 213}, {15758615, 252}, {4681932, 23}, {4681933, 2}},
				Cycles: 18,
			},
		},
		{
			name: "1694 SUBA.l D7, A4 99c7",
			init: 			cpuState{
				D:   [8]uint32{2244198227, 4232615813, 546313675, 4209834576, 1309521905, 4033789885, 2304886443, 2634655959},
				A:   [7]uint32{153395507, 972476482, 1885755648, 1915216929, 1352950666, 2025676025, 2425138065},
				PC:  3053696,
				SR:  9993,
				USP: 5023966,
				SSP: 3386218,
				RAM: [][2]uint32{{3053692, 153}, {3053693, 199}, {3053694, 175}, {3053695, 34}, {3053696, 251}, {3053697, 167}},
			},
			want: 			cpuState{
				D:   [8]uint32{2244198227, 4232615813, 546313675, 4209834576, 1309521905, 4033789885, 2304886443, 2634655959},
				A:   [7]uint32{153395507, 972476482, 1885755648, 1915216929, 3013262003, 2025676025, 2425138065},
				PC:  3053698,
				SR:  9993,
				USP: 5023966,
				SSP: 3386218,
				RAM: [][2]uint32{{3053692, 153}, {3053693, 199}, {3053694, 175}, {3053695, 34}, {3053696, 251}, {3053697, 167}},
				Cycles: 8,
			},
		},
		{
			name: "1967 SUBA.l (A3)+, A5 9bdb",
			init: 			cpuState{
				D:   [8]uint32{3825544686, 3366681543, 186854833, 559159895, 1303468281, 1188962384, 3863680113, 4292210557},
				A:   [7]uint32{405943775, 725205925, 3957797861, 3849324002, 1706173662, 161420810, 3253576201},
				PC:  11714188,
				SR:  9477,
				USP: 10630474,
				SSP: 16365816,
				RAM: [][2]uint32{{11714184, 155}, {11714185, 219}, {11714186, 22}, {11714187, 8}, {7341538, 137}, {7341539, 222}, {7341540, 65}, {7341541, 177}, {11714188, 215}, {11714189, 63}},
			},
			want: 			cpuState{
				D:   [8]uint32{3825544686, 3366681543, 186854833, 559159895, 1303468281, 1188962384, 3863680113, 4292210557},
				A:   [7]uint32{405943775, 725205925, 3957797861, 3849324006, 1706173662, 2143343705, 3253576201},
				PC:  11714190,
				SR:  9477,
				USP: 10630474,
				SSP: 16365816,
				RAM: [][2]uint32{{11714184, 155}, {11714185, 219}, {11714186, 22}, {11714187, 8}, {7341538, 137}, {7341539, 222}, {7341540, 65}, {7341541, 177}, {11714188, 215}, {11714189, 63}},
				Cycles: 14,
			},
		},
		{
			name: "2232 SUBA.l A4, A7 9fcc",
			init: 			cpuState{
				D:   [8]uint32{1873422738, 3526838456, 2584031592, 54062782, 4118803087, 469186548, 1366183385, 2545217060},
				A:   [7]uint32{3723216436, 3891504511, 605095531, 2818421774, 693329663, 2867288527, 151793562},
				PC:  1251628,
				SR:  529,
				USP: 7049066,
				SSP: 13022460,
				RAM: [][2]uint32{{1251624, 159}, {1251625, 204}, {1251626, 37}, {1251627, 66}, {1251628, 222}, {1251629, 217}},
			},
			want: 			cpuState{
				D:   [8]uint32{1873422738, 3526838456, 2584031592, 54062782, 4118803087, 469186548, 1366183385, 2545217060},
				A:   [7]uint32{3723216436, 3891504511, 605095531, 2818421774, 693329663, 2867288527, 151793562},
				PC:  1251630,
				SR:  529,
				USP: 3608686699,
				SSP: 13022460,
				RAM: [][2]uint32{{1251624, 159}, {1251625, 204}, {1251626, 37}, {1251627, 66}, {1251628, 222}, {1251629, 217}},
				Cycles: 8,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSUBX_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SUBX.b -(A6), -(A5) 9b0e",
			init: cpuState{
				D:   [8]uint32{1992413736, 2830914761, 1670552328, 1701732656, 790525025, 2778523620, 586266019, 2663743660},
				A:   [7]uint32{2006458740, 662972021, 885725256, 2224149744, 3585966472, 1971606215, 1492285973},
				PC:  13635960,
				SR:  8463,
				USP: 12911244,
				SSP: 7204516,
				RAM: [][2]uint32{{13635956, 155}, {13635957, 14}, {13635958, 243}, {13635959, 140}, {15890964, 114}, {15890965, 140}, {8671942, 133}, {8671943, 138}, {13635960, 33}, {13635961, 45}},
			},
			want: cpuState{
				D:   [8]uint32{1992413736, 2830914761, 1670552328, 1701732656, 790525025, 2778523620, 586266019, 2663743660},
				A:   [7]uint32{2006458740, 662972021, 885725256, 2224149744, 3585966472, 1971606214, 1492285972},
				PC:  13635962,
				SR:  8450,
				USP: 12911244,
				SSP: 7204516,
				RAM: [][2]uint32{{13635956, 155}, {13635957, 14}, {13635958, 243}, {13635959, 140}, {15890964, 114}, {15890965, 140}, {8671942, 19}, {8671943, 138}, {13635960, 33}, {13635961, 45}},
				Cycles: 18,
			},
		},
		{
			name: "500 SUBX.b D3, D1 9303",
			init: cpuState{
				D:   [8]uint32{3607775820, 3852275476, 2086456299, 3109634837, 3061187380, 4023692619, 606212908, 750760402},
				A:   [7]uint32{2811092768, 3538319113, 2026927621, 129018793, 1986217640, 2307847067, 1577127887},
				PC:  10401066,
				SR:  34574,
				USP: 7201574,
				SSP: 15314004,
				RAM: [][2]uint32{{10401062, 147}, {10401063, 3}, {10401064, 37}, {10401065, 132}, {10401066, 116}, {10401067, 10}},
			},
			want: cpuState{
				D:   [8]uint32{3607775820, 3852275711, 2086456299, 3109634837, 3061187380, 4023692619, 606212908, 750760402},
				A:   [7]uint32{2811092768, 3538319113, 2026927621, 129018793, 1986217640, 2307847067, 1577127887},
				PC:  10401068,
				SR:  34585,
				USP: 7201574,
				SSP: 15314004,
				RAM: [][2]uint32{{10401062, 147}, {10401063, 3}, {10401064, 37}, {10401065, 132}, {10401066, 116}, {10401067, 10}},
				Cycles: 4,
			},
		},
		{
			name: "1000 SUBX.b D3, D7 9f03",
			init: cpuState{
				D:   [8]uint32{2214119253, 3205647929, 1118066804, 3524112174, 2586932746, 3142786789, 2177820875, 3717659512},
				A:   [7]uint32{4065170353, 2794160949, 174123141, 1494318511, 1764308580, 93036787, 4070929803},
				PC:  2268760,
				SR:  9995,
				USP: 7256972,
				SSP: 3415412,
				RAM: [][2]uint32{{2268756, 159}, {2268757, 3}, {2268758, 126}, {2268759, 95}, {2268760, 155}, {2268761, 85}},
			},
			want: cpuState{
				D:   [8]uint32{2214119253, 3205647929, 1118066804, 3524112174, 2586932746, 3142786789, 2177820875, 3717659466},
				A:   [7]uint32{4065170353, 2794160949, 174123141, 1494318511, 1764308580, 93036787, 4070929803},
				PC:  2268762,
				SR:  9984,
				USP: 7256972,
				SSP: 3415412,
				RAM: [][2]uint32{{2268756, 159}, {2268757, 3}, {2268758, 126}, {2268759, 95}, {2268760, 155}, {2268761, 85}},
				Cycles: 4,
			},
		},
		{
			name: "1500 SUBX.b D2, D7 9f02",
			init: cpuState{
				D:   [8]uint32{2404998694, 3054321717, 831178097, 2315447791, 1837712828, 1967192083, 3833131050, 2035964520},
				A:   [7]uint32{3550639313, 2352309012, 3072929013, 681564011, 211763272, 138000919, 1175576334},
				PC:  10970312,
				SR:  9733,
				USP: 11692018,
				SSP: 10180286,
				RAM: [][2]uint32{{10970308, 159}, {10970309, 2}, {10970310, 179}, {10970311, 1}, {10970312, 75}, {10970313, 85}},
			},
			want: cpuState{
				D:   [8]uint32{2404998694, 3054321717, 831178097, 2315447791, 1837712828, 1967192083, 3833131050, 2035964663},
				A:   [7]uint32{3550639313, 2352309012, 3072929013, 681564011, 211763272, 138000919, 1175576334},
				PC:  10970314,
				SR:  9753,
				USP: 11692018,
				SSP: 10180286,
				RAM: [][2]uint32{{10970308, 159}, {10970309, 2}, {10970310, 179}, {10970311, 1}, {10970312, 75}, {10970313, 85}},
				Cycles: 4,
			},
		},
		{
			name: "2000 SUBX.b -(A0), -(A3) 9708",
			init: cpuState{
				D:   [8]uint32{2640525249, 3789624198, 2455280901, 3058645379, 3645109833, 1128799361, 3181016728, 104781491},
				A:   [7]uint32{2149250470, 2067707905, 48345627, 971488715, 3663762014, 3856590103, 644088014},
				PC:  14543104,
				SR:  33024,
				USP: 12161948,
				SSP: 3247132,
				RAM: [][2]uint32{{14543100, 151}, {14543101, 8}, {14543102, 147}, {14543103, 251}, {1766820, 168}, {1766821, 175}, {15187402, 53}, {15187403, 64}, {14543104, 138}, {14543105, 239}},
			},
			want: cpuState{
				D:   [8]uint32{2640525249, 3789624198, 2455280901, 3058645379, 3645109833, 1128799361, 3181016728, 104781491},
				A:   [7]uint32{2149250469, 2067707905, 48345627, 971488714, 3663762014, 3856590103, 644088014},
				PC:  14543106,
				SR:  33051,
				USP: 12161948,
				SSP: 3247132,
				RAM: [][2]uint32{{14543100, 151}, {14543101, 8}, {14543102, 147}, {14543103, 251}, {1766820, 168}, {1766821, 175}, {15187402, 134}, {15187403, 64}, {14543104, 138}, {14543105, 239}},
				Cycles: 18,
			},
		},
		{
			name: "002 SUBX.b -(A6), -(A6) 9d0e",
			init: 			cpuState{
				D:   [8]uint32{1211610694, 2966212525, 3530421839, 3153613557, 1421489449, 405897354, 2053103716, 1015586139},
				A:   [7]uint32{2198940213, 1006148062, 3452209259, 1245486736, 389310410, 2235947992, 744781287},
				PC:  8645858,
				SR:  9220,
				USP: 16391954,
				SSP: 616196,
				RAM: [][2]uint32{{8645854, 157}, {8645855, 14}, {8645856, 91}, {8645857, 254}, {6583782, 15}, {6583783, 132}, {6583780, 45}, {6583781, 65}, {8645858, 93}, {8645859, 141}},
			},
			want: 			cpuState{
				D:   [8]uint32{1211610694, 2966212525, 3530421839, 3153613557, 1421489449, 405897354, 2053103716, 1015586139},
				A:   [7]uint32{2198940213, 1006148062, 3452209259, 1245486736, 389310410, 2235947992, 744781285},
				PC:  8645860,
				SR:  9216,
				USP: 16391954,
				SSP: 616196,
				RAM: [][2]uint32{{8645854, 157}, {8645855, 14}, {8645856, 91}, {8645857, 254}, {6583782, 15}, {6583783, 132}, {6583780, 45}, {6583781, 50}, {8645858, 93}, {8645859, 141}},
				Cycles: 18,
			},
		},
		{
			name: "282 SUBX.b D0, D1 9300",
			init: 			cpuState{
				D:   [8]uint32{1656680575, 573164507, 1464605721, 1467396047, 256281221, 2574842083, 2275588538, 2874597741},
				A:   [7]uint32{337102036, 2222697764, 3091204662, 4224096707, 693186199, 1870452219, 2813567865},
				PC:  12885148,
				SR:  8971,
				USP: 1866836,
				SSP: 15301650,
				RAM: [][2]uint32{{12885144, 147}, {12885145, 0}, {12885146, 49}, {12885147, 96}, {12885148, 21}, {12885149, 157}},
			},
			want: 			cpuState{
				D:   [8]uint32{1656680575, 573164380, 1464605721, 1467396047, 256281221, 2574842083, 2275588538, 2874597741},
				A:   [7]uint32{337102036, 2222697764, 3091204662, 4224096707, 693186199, 1870452219, 2813567865},
				PC:  12885150,
				SR:  8962,
				USP: 1866836,
				SSP: 15301650,
				RAM: [][2]uint32{{12885144, 147}, {12885145, 0}, {12885146, 49}, {12885147, 96}, {12885148, 21}, {12885149, 157}},
				Cycles: 4,
			},
		},
		{
			name: "575 SUBX.b -(A1), -(A5) 9b09",
			init: 			cpuState{
				D:   [8]uint32{2720815582, 169536808, 938255251, 68998708, 3772860864, 1116665504, 1433113857, 603349330},
				A:   [7]uint32{3421910598, 48470841, 4027993083, 4064905600, 185445929, 1521082356, 3274123006},
				PC:  6398174,
				SR:  285,
				USP: 7507956,
				SSP: 10344878,
				RAM: [][2]uint32{{6398170, 155}, {6398171, 9}, {6398172, 149}, {6398173, 5}, {14916408, 245}, {14916409, 74}, {11132914, 65}, {11132915, 114}, {6398174, 163}, {6398175, 82}},
			},
			want: 			cpuState{
				D:   [8]uint32{2720815582, 169536808, 938255251, 68998708, 3772860864, 1116665504, 1433113857, 603349330},
				A:   [7]uint32{3421910598, 48470840, 4027993083, 4064905600, 185445929, 1521082355, 3274123006},
				PC:  6398176,
				SR:  273,
				USP: 7507956,
				SSP: 10344878,
				RAM: [][2]uint32{{6398170, 155}, {6398171, 9}, {6398172, 149}, {6398173, 5}, {14916408, 245}, {14916409, 74}, {11132914, 65}, {11132915, 124}, {6398174, 163}, {6398175, 82}},
				Cycles: 18,
			},
		},
		{
			name: "860 SUBX.b D0, D3 9700",
			init: 			cpuState{
				D:   [8]uint32{3049141974, 1774652188, 3001258318, 3918066095, 3022758789, 2830596614, 3676307543, 4239950800},
				A:   [7]uint32{4108497490, 1126936657, 2398659475, 2354111975, 3370280610, 1185496709, 768796991},
				PC:  4749810,
				SR:  9216,
				USP: 15424454,
				SSP: 7824926,
				RAM: [][2]uint32{{4749806, 151}, {4749807, 0}, {4749808, 18}, {4749809, 112}, {4749810, 9}, {4749811, 221}},
			},
			want: 			cpuState{
				D:   [8]uint32{3049141974, 1774652188, 3001258318, 3918066137, 3022758789, 2830596614, 3676307543, 4239950800},
				A:   [7]uint32{4108497490, 1126936657, 2398659475, 2354111975, 3370280610, 1185496709, 768796991},
				PC:  4749812,
				SR:  9241,
				USP: 15424454,
				SSP: 7824926,
				RAM: [][2]uint32{{4749806, 151}, {4749807, 0}, {4749808, 18}, {4749809, 112}, {4749810, 9}, {4749811, 221}},
				Cycles: 4,
			},
		},
		{
			name: "1123 SUBX.b -(A2), -(A6) 9d0a",
			init: 			cpuState{
				D:   [8]uint32{1564567366, 97907982, 3574420931, 746277917, 912254351, 3014800586, 3013479873, 50651045},
				A:   [7]uint32{1271824321, 3622151665, 1210940530, 3878233029, 649260286, 3482773807, 2502929843},
				PC:  13472650,
				SR:  8718,
				USP: 9208796,
				SSP: 545466,
				RAM: [][2]uint32{{13472646, 157}, {13472647, 10}, {13472648, 196}, {13472649, 155}, {2980976, 60}, {2980977, 124}, {3124658, 214}, {3124659, 164}, {13472650, 80}, {13472651, 150}},
			},
			want: 			cpuState{
				D:   [8]uint32{1564567366, 97907982, 3574420931, 746277917, 912254351, 3014800586, 3013479873, 50651045},
				A:   [7]uint32{1271824321, 3622151665, 1210940529, 3878233029, 649260286, 3482773807, 2502929842},
				PC:  13472652,
				SR:  8706,
				USP: 9208796,
				SSP: 545466,
				RAM: [][2]uint32{{13472646, 157}, {13472647, 10}, {13472648, 196}, {13472649, 155}, {2980976, 60}, {2980977, 124}, {3124658, 90}, {3124659, 164}, {13472650, 80}, {13472651, 150}},
				Cycles: 18,
			},
		},
		{
			name: "1385 SUBX.b D0, D7 9f00",
			init: 			cpuState{
				D:   [8]uint32{2921650439, 2108674210, 2129448061, 825243066, 1435730981, 1021445354, 3778724972, 2619273029},
				A:   [7]uint32{3540842471, 2568401141, 1724552615, 153198712, 3696713456, 2562504613, 3809517873},
				PC:  4793464,
				SR:  8453,
				USP: 13812670,
				SSP: 14136250,
				RAM: [][2]uint32{{4793460, 159}, {4793461, 0}, {4793462, 182}, {4793463, 24}, {4793464, 160}, {4793465, 140}},
			},
			want: 			cpuState{
				D:   [8]uint32{2921650439, 2108674210, 2129448061, 825243066, 1435730981, 1021445354, 3778724972, 2619273022},
				A:   [7]uint32{3540842471, 2568401141, 1724552615, 153198712, 3696713456, 2562504613, 3809517873},
				PC:  4793466,
				SR:  8448,
				USP: 13812670,
				SSP: 14136250,
				RAM: [][2]uint32{{4793460, 159}, {4793461, 0}, {4793462, 182}, {4793463, 24}, {4793464, 160}, {4793465, 140}},
				Cycles: 4,
			},
		},
		{
			name: "1651 SUBX.b D6, D2 9506",
			init: 			cpuState{
				D:   [8]uint32{881205103, 3293152755, 2367728997, 2465064539, 2386117704, 1880438942, 1321459833, 310346056},
				A:   [7]uint32{1450769020, 2113928239, 1177154732, 1468749948, 2177145834, 4291302596, 4215446758},
				PC:  4972628,
				SR:  536,
				USP: 15707722,
				SSP: 3144406,
				RAM: [][2]uint32{{4972624, 149}, {4972625, 6}, {4972626, 187}, {4972627, 80}, {4972628, 9}, {4972629, 72}},
			},
			want: 			cpuState{
				D:   [8]uint32{881205103, 3293152755, 2367729131, 2465064539, 2386117704, 1880438942, 1321459833, 310346056},
				A:   [7]uint32{1450769020, 2113928239, 1177154732, 1468749948, 2177145834, 4291302596, 4215446758},
				PC:  4972630,
				SR:  537,
				USP: 15707722,
				SSP: 3144406,
				RAM: [][2]uint32{{4972624, 149}, {4972625, 6}, {4972626, 187}, {4972627, 80}, {4972628, 9}, {4972629, 72}},
				Cycles: 4,
			},
		},
		{
			name: "1911 SUBX.b -(A6), -(A6) 9d0e",
			init: 			cpuState{
				D:   [8]uint32{2543685122, 1805267063, 1256209096, 2538682220, 1550883171, 4097480766, 2005512199, 359502782},
				A:   [7]uint32{1608336395, 3236860187, 3598988686, 3258297361, 4280941162, 1780100139, 336518369},
				PC:  13692466,
				SR:  515,
				USP: 2687740,
				SSP: 1812964,
				RAM: [][2]uint32{{13692462, 157}, {13692463, 14}, {13692464, 204}, {13692465, 88}, {974048, 231}, {974049, 50}, {974046, 216}, {974047, 147}, {13692466, 79}, {13692467, 124}},
			},
			want: 			cpuState{
				D:   [8]uint32{2543685122, 1805267063, 1256209096, 2538682220, 1550883171, 4097480766, 2005512199, 359502782},
				A:   [7]uint32{1608336395, 3236860187, 3598988686, 3258297361, 4280941162, 1780100139, 336518367},
				PC:  13692468,
				SR:  537,
				USP: 2687740,
				SSP: 1812964,
				RAM: [][2]uint32{{13692462, 157}, {13692463, 14}, {13692464, 204}, {13692465, 88}, {974048, 231}, {974049, 50}, {974046, 216}, {974047, 172}, {13692466, 79}, {13692467, 124}},
				Cycles: 18,
			},
		},
		{
			name: "2198 SUBX.b D5, D5 9b05",
			init: 			cpuState{
				D:   [8]uint32{86278854, 2476456545, 3267299459, 1285292615, 3007900826, 1747026233, 2681153353, 106345664},
				A:   [7]uint32{448034913, 807067856, 4049879719, 2958328779, 2881375652, 3525863809, 3094541625},
				PC:  11783216,
				SR:  9499,
				USP: 16090034,
				SSP: 7350322,
				RAM: [][2]uint32{{11783212, 155}, {11783213, 5}, {11783214, 178}, {11783215, 39}, {11783216, 106}, {11783217, 2}},
			},
			want: 			cpuState{
				D:   [8]uint32{86278854, 2476456545, 3267299459, 1285292615, 3007900826, 1747026431, 2681153353, 106345664},
				A:   [7]uint32{448034913, 807067856, 4049879719, 2958328779, 2881375652, 3525863809, 3094541625},
				PC:  11783218,
				SR:  9497,
				USP: 16090034,
				SSP: 7350322,
				RAM: [][2]uint32{{11783212, 155}, {11783213, 5}, {11783214, 178}, {11783215, 39}, {11783216, 106}, {11783217, 2}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSUBX_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SUBX.w D5, D2 9545",
			init: cpuState{
				D:   [8]uint32{2368090618, 343229324, 4077421584, 1140111816, 776276871, 3590116636, 2450341692, 3648754164},
				A:   [7]uint32{4047161302, 70600069, 1880235323, 2046352221, 2227657362, 3059693067, 2360542679},
				PC:  2067428,
				SR:  41477,
				USP: 4882060,
				SSP: 4975382,
				RAM: [][2]uint32{{2067424, 149}, {2067425, 69}, {2067426, 64}, {2067427, 193}, {2067428, 191}, {2067429, 222}},
			},
			want: cpuState{
				D:   [8]uint32{2368090618, 343229324, 4077432564, 1140111816, 776276871, 3590116636, 2450341692, 3648754164},
				A:   [7]uint32{4047161302, 70600069, 1880235323, 2046352221, 2227657362, 3059693067, 2360542679},
				PC:  2067430,
				SR:  41497,
				USP: 4882060,
				SSP: 4975382,
				RAM: [][2]uint32{{2067424, 149}, {2067425, 69}, {2067426, 64}, {2067427, 193}, {2067428, 191}, {2067429, 222}},
				Cycles: 4,
			},
		},
		{
			name: "500 SUBX.w -(A2), -(A0) 914a",
			init: cpuState{
				D:   [8]uint32{2936823178, 7347522, 3773887089, 4003544569, 3057959006, 2070266061, 1523658904, 3894157454},
				A:   [7]uint32{2682350763, 1452815909, 2769952263, 1459158443, 4178282268, 3078142158, 706093560},
				PC:  10310310,
				SR:  1037,
				USP: 4171798,
				SSP: 4256170,
				RAM: [][2]uint32{{10310306, 145}, {10310307, 74}, {10310308, 101}, {10310309, 149}, {12, 113}, {13, 34}, {14, 72}, {15, 210}, {2246866, 48}, {2246867, 106}, {2246868, 137}, {2246869, 154}},
			},
			want: cpuState{
				D:      [8]uint32{2936823178, 7347522, 3773887089, 4003544569, 3057959006, 2070266061, 1523658904, 3894157454},
				A:      [7]uint32{2682350763, 1452815909, 2769952261, 1459158443, 4178282268, 3078142158, 706093560},
				PC:     1898072278,
				SR:     9229,
				USP:    4171798,
				SSP:    4256156,
				RAM:    [][2]uint32{{10310306, 145}, {10310307, 74}, {10310308, 101}, {10310309, 149}, {4256168, 82}, {4256169, 166}, {4256164, 4}, {4256165, 13}, {4256166, 0}, {4256167, 157}, {4256162, 145}, {4256163, 74}, {4256160, 30}, {4256161, 5}, {4256156, 145}, {4256157, 81}, {4256158, 165}, {4256159, 26}, {12, 113}, {13, 34}, {14, 72}, {15, 210}, {2246866, 48}, {2246867, 106}, {2246868, 137}, {2246869, 154}},
				Halted: true,
			},
		},
		{
			name: "1000 SUBX.w D5, D6 9d45",
			init: cpuState{
				D:   [8]uint32{3743873211, 2510793158, 952828386, 2955811353, 278848245, 1916221434, 173137106, 19647896},
				A:   [7]uint32{3480323470, 558545683, 1696229955, 4116847201, 4258902043, 122529455, 2057321215},
				PC:  13102538,
				SR:  32779,
				USP: 16379214,
				SSP: 14552778,
				RAM: [][2]uint32{{13102534, 157}, {13102535, 69}, {13102536, 170}, {13102537, 148}, {13102538, 109}, {13102539, 206}},
			},
			want: cpuState{
				D:   [8]uint32{3743873211, 2510793158, 952828386, 2955811353, 278848245, 1916221434, 173122776, 19647896},
				A:   [7]uint32{3480323470, 558545683, 1696229955, 4116847201, 4258902043, 122529455, 2057321215},
				PC:  13102540,
				SR:  32776,
				USP: 16379214,
				SSP: 14552778,
				RAM: [][2]uint32{{13102534, 157}, {13102535, 69}, {13102536, 170}, {13102537, 148}, {13102538, 109}, {13102539, 206}},
				Cycles: 4,
			},
		},
		{
			name: "1500 SUBX.w -(A3), -(A1) 934b",
			init: cpuState{
				D:   [8]uint32{3992332493, 2953250120, 3581761513, 1360944680, 1036679635, 1848665135, 368980980, 1772969713},
				A:   [7]uint32{1953424370, 199472263, 2900465183, 3331704019, 1205584150, 1112065161, 1755161018},
				PC:  15138642,
				SR:  8704,
				USP: 15746114,
				SSP: 16484694,
				RAM: [][2]uint32{{15138638, 147}, {15138639, 75}, {15138640, 180}, {15138641, 87}, {12, 151}, {13, 160}, {14, 236}, {15, 228}, {10546404, 128}, {10546405, 31}, {10546406, 216}, {10546407, 24}},
			},
			want: cpuState{
				D:      [8]uint32{3992332493, 2953250120, 3581761513, 1360944680, 1036679635, 1848665135, 368980980, 1772969713},
				A:      [7]uint32{1953424370, 199472263, 2900465183, 3331704017, 1205584150, 1112065161, 1755161018},
				PC:     2543906024,
				SR:     8704,
				USP:    15746114,
				SSP:    16484680,
				RAM:    [][2]uint32{{15138638, 147}, {15138639, 75}, {15138640, 180}, {15138641, 87}, {16484692, 255}, {16484693, 82}, {16484688, 34}, {16484689, 0}, {16484690, 0}, {16484691, 230}, {16484686, 147}, {16484687, 75}, {16484684, 196}, {16484685, 209}, {16484680, 147}, {16484681, 85}, {16484682, 198}, {16484683, 149}, {12, 151}, {13, 160}, {14, 236}, {15, 228}, {10546404, 128}, {10546405, 31}, {10546406, 216}, {10546407, 24}},
				Halted: true,
			},
		},
		{
			name: "2000 SUBX.w D6, D3 9746",
			init: cpuState{
				D:   [8]uint32{2204287251, 926604205, 2878869808, 3199531458, 1911079139, 2047342402, 708180200, 3402671090},
				A:   [7]uint32{386897662, 338160254, 2001948227, 2826979243, 2559545764, 1141324282, 2960639232},
				PC:  5820544,
				SR:  33054,
				USP: 5444154,
				SSP: 3647576,
				RAM: [][2]uint32{{5820540, 151}, {5820541, 70}, {5820542, 209}, {5820543, 15}, {5820544, 160}, {5820545, 62}},
			},
			want: cpuState{
				D:   [8]uint32{2204287251, 926604205, 2878869808, 3199467737, 1911079139, 2047342402, 708180200, 3402671090},
				A:   [7]uint32{386897662, 338160254, 2001948227, 2826979243, 2559545764, 1141324282, 2960639232},
				PC:  5820546,
				SR:  33024,
				USP: 5444154,
				SSP: 3647576,
				RAM: [][2]uint32{{5820540, 151}, {5820541, 70}, {5820542, 209}, {5820543, 15}, {5820544, 160}, {5820545, 62}},
				Cycles: 4,
			},
		},
		{
			name: "001 SUBX.w -(A4), -(A1) 934c",
			init: 			cpuState{
				D:   [8]uint32{203618976, 774788736, 3438626902, 2697277245, 2245322094, 2415624246, 2025661202, 845149995},
				A:   [7]uint32{2153904307, 1715751958, 2923204139, 456200007, 1804159414, 996899578, 1368916492},
				PC:  13792960,
				SR:  9474,
				USP: 15899736,
				SSP: 5362770,
				RAM: [][2]uint32{{13792956, 147}, {13792957, 76}, {13792958, 241}, {13792959, 154}, {8997300, 76}, {8997301, 221}, {4475924, 10}, {4475925, 127}, {13792960, 105}, {13792961, 187}},
			},
			want: 			cpuState{
				D:   [8]uint32{203618976, 774788736, 3438626902, 2697277245, 2245322094, 2415624246, 2025661202, 845149995},
				A:   [7]uint32{2153904307, 1715751956, 2923204139, 456200007, 1804159412, 996899578, 1368916492},
				PC:  13792962,
				SR:  9497,
				USP: 15899736,
				SSP: 5362770,
				RAM: [][2]uint32{{13792956, 147}, {13792957, 76}, {13792958, 241}, {13792959, 154}, {8997300, 76}, {8997301, 221}, {4475924, 189}, {4475925, 162}, {13792960, 105}, {13792961, 187}},
				Cycles: 18,
			},
		},
		{
			name: "284 SUBX.w D1, D7 9f41",
			init: 			cpuState{
				D:   [8]uint32{3866969736, 3726660191, 3080320927, 3264294109, 1687761527, 2255668908, 227220996, 294074682},
				A:   [7]uint32{1237084407, 1066120485, 3766307910, 2040056466, 1974319679, 2088919989, 2113667318},
				PC:  10998332,
				SR:  9219,
				USP: 5511892,
				SSP: 12333262,
				RAM: [][2]uint32{{10998328, 159}, {10998329, 65}, {10998330, 204}, {10998331, 115}, {10998332, 228}, {10998333, 156}},
			},
			want: 			cpuState{
				D:   [8]uint32{3866969736, 3726660191, 3080320927, 3264294109, 1687761527, 2255668908, 227220996, 294119131},
				A:   [7]uint32{1237084407, 1066120485, 3766307910, 2040056466, 1974319679, 2088919989, 2113667318},
				PC:  10998334,
				SR:  9241,
				USP: 5511892,
				SSP: 12333262,
				RAM: [][2]uint32{{10998328, 159}, {10998329, 65}, {10998330, 204}, {10998331, 115}, {10998332, 228}, {10998333, 156}},
				Cycles: 4,
			},
		},
		{
			name: "554 SUBX.w D5, D4 9945",
			init: 			cpuState{
				D:   [8]uint32{3532301485, 3120770490, 974437036, 137071046, 3227120545, 2882020741, 898384631, 4080590547},
				A:   [7]uint32{1948900675, 321957564, 2437536838, 1404885997, 2752902515, 3013267142, 2959729135},
				PC:  15047622,
				SR:  9737,
				USP: 11756010,
				SSP: 11503212,
				RAM: [][2]uint32{{15047618, 153}, {15047619, 69}, {15047620, 114}, {15047621, 41}, {15047622, 209}, {15047623, 142}},
			},
			want: 			cpuState{
				D:   [8]uint32{3532301485, 3120770490, 974437036, 137071046, 3227110940, 2882020741, 898384631, 4080590547},
				A:   [7]uint32{1948900675, 321957564, 2437536838, 1404885997, 2752902515, 3013267142, 2959729135},
				PC:  15047624,
				SR:  9736,
				USP: 11756010,
				SSP: 11503212,
				RAM: [][2]uint32{{15047618, 153}, {15047619, 69}, {15047620, 114}, {15047621, 41}, {15047622, 209}, {15047623, 142}},
				Cycles: 4,
			},
		},
		{
			name: "837 SUBX.w D5, D0 9145",
			init: 			cpuState{
				D:   [8]uint32{485248144, 595441709, 714028032, 691102440, 2254585368, 1630580620, 146232411, 3523644232},
				A:   [7]uint32{2747427728, 212952267, 1038705210, 760568656, 3498235355, 17961287, 1575297778},
				PC:  15559144,
				SR:  9232,
				USP: 15733328,
				SSP: 16481070,
				RAM: [][2]uint32{{15559140, 145}, {15559141, 69}, {15559142, 206}, {15559143, 195}, {15559144, 18}, {15559145, 135}},
			},
			want: 			cpuState{
				D:   [8]uint32{485268739, 595441709, 714028032, 691102440, 2254585368, 1630580620, 146232411, 3523644232},
				A:   [7]uint32{2747427728, 212952267, 1038705210, 760568656, 3498235355, 17961287, 1575297778},
				PC:  15559146,
				SR:  9243,
				USP: 15733328,
				SSP: 16481070,
				RAM: [][2]uint32{{15559140, 145}, {15559141, 69}, {15559142, 206}, {15559143, 195}, {15559144, 18}, {15559145, 135}},
				Cycles: 4,
			},
		},
		{
			name: "1120 SUBX.w -(A6), -(A4) 994e",
			init: 			cpuState{
				D:   [8]uint32{303147646, 128789009, 2390487300, 4293820785, 2125987321, 2332623269, 3100821968, 1067075929},
				A:   [7]uint32{2396165627, 2586741111, 3643768171, 2174802827, 3283738584, 3756124533, 1878665860},
				PC:  13451496,
				SR:  1549,
				USP: 4973896,
				SSP: 2322496,
				RAM: [][2]uint32{{13451492, 153}, {13451493, 78}, {13451494, 89}, {13451495, 217}, {16394882, 158}, {16394883, 220}, {12181462, 61}, {12181463, 19}, {13451496, 252}, {13451497, 67}},
			},
			want: 			cpuState{
				D:   [8]uint32{303147646, 128789009, 2390487300, 4293820785, 2125987321, 2332623269, 3100821968, 1067075929},
				A:   [7]uint32{2396165627, 2586741111, 3643768171, 2174802827, 3283738582, 3756124533, 1878665858},
				PC:  13451498,
				SR:  1563,
				USP: 4973896,
				SSP: 2322496,
				RAM: [][2]uint32{{13451492, 153}, {13451493, 78}, {13451494, 89}, {13451495, 217}, {16394882, 158}, {16394883, 220}, {12181462, 158}, {12181463, 55}, {13451496, 252}, {13451497, 67}},
				Cycles: 18,
			},
		},
		{
			name: "1390 SUBX.w D6, D3 9746",
			init: 			cpuState{
				D:   [8]uint32{341532421, 45685952, 2670312621, 1457139628, 2683790834, 2936164253, 2255093227, 1913528704},
				A:   [7]uint32{150654610, 1417127554, 3039768823, 429148969, 1967257440, 2401482925, 1570500056},
				PC:  2471608,
				SR:  1032,
				USP: 2108552,
				SSP: 9455236,
				RAM: [][2]uint32{{2471604, 151}, {2471605, 70}, {2471606, 192}, {2471607, 156}, {2471608, 198}, {2471609, 43}},
			},
			want: 			cpuState{
				D:   [8]uint32{341532421, 45685952, 2670312621, 1457140161, 2683790834, 2936164253, 2255093227, 1913528704},
				A:   [7]uint32{150654610, 1417127554, 3039768823, 429148969, 1967257440, 2401482925, 1570500056},
				PC:  2471610,
				SR:  1041,
				USP: 2108552,
				SSP: 9455236,
				RAM: [][2]uint32{{2471604, 151}, {2471605, 70}, {2471606, 192}, {2471607, 156}, {2471608, 198}, {2471609, 43}},
				Cycles: 4,
			},
		},
		{
			name: "1686 SUBX.w -(A0), -(A6) 9d48",
			init: 			cpuState{
				D:   [8]uint32{3138376288, 75570579, 1671348170, 691806019, 3588304565, 2969250593, 3178361999, 3868039076},
				A:   [7]uint32{1053498428, 1854356676, 933709709, 747373374, 584400992, 849083206, 3880918954},
				PC:  9481772,
				SR:  8454,
				USP: 6188686,
				SSP: 9514130,
				RAM: [][2]uint32{{9481768, 157}, {9481769, 72}, {9481770, 5}, {9481771, 93}, {13311034, 155}, {13311035, 51}, {5382056, 58}, {5382057, 209}, {9481772, 31}, {9481773, 22}},
			},
			want: 			cpuState{
				D:   [8]uint32{3138376288, 75570579, 1671348170, 691806019, 3588304565, 2969250593, 3178361999, 3868039076},
				A:   [7]uint32{1053498426, 1854356676, 933709709, 747373374, 584400992, 849083206, 3880918952},
				PC:  9481774,
				SR:  8475,
				USP: 6188686,
				SSP: 9514130,
				RAM: [][2]uint32{{9481768, 157}, {9481769, 72}, {9481770, 5}, {9481771, 93}, {13311034, 155}, {13311035, 51}, {5382056, 159}, {5382057, 158}, {9481772, 31}, {9481773, 22}},
				Cycles: 18,
			},
		},
		{
			name: "1923 SUBX.w D1, D7 9f41",
			init: 			cpuState{
				D:   [8]uint32{1589748068, 3977183695, 2972684005, 677031406, 41300284, 1841382738, 1486561435, 3113754547},
				A:   [7]uint32{2269610719, 1783640368, 266271840, 6371284, 899370149, 1114754531, 709178779},
				PC:  1673310,
				SR:  792,
				USP: 3221572,
				SSP: 14806496,
				RAM: [][2]uint32{{1673306, 159}, {1673307, 65}, {1673308, 5}, {1673309, 89}, {1673310, 86}, {1673311, 4}},
			},
			want: 			cpuState{
				D:   [8]uint32{1589748068, 3977183695, 2972684005, 677031406, 41300284, 1841382738, 1486561435, 3113754083},
				A:   [7]uint32{2269610719, 1783640368, 266271840, 6371284, 899370149, 1114754531, 709178779},
				PC:  1673312,
				SR:  768,
				USP: 3221572,
				SSP: 14806496,
				RAM: [][2]uint32{{1673306, 159}, {1673307, 65}, {1673308, 5}, {1673309, 89}, {1673310, 86}, {1673311, 4}},
				Cycles: 4,
			},
		},
		{
			name: "2221 SUBX.w D5, D4 9945",
			init: 			cpuState{
				D:   [8]uint32{320546292, 3371567299, 3534409189, 2956171144, 3081589068, 3896994331, 2005837087, 2479881905},
				A:   [7]uint32{541969536, 2266320003, 393043882, 1425963028, 4290298054, 3795195657, 214027027},
				PC:  12627504,
				SR:  1792,
				USP: 2138342,
				SSP: 11739662,
				RAM: [][2]uint32{{12627500, 153}, {12627501, 69}, {12627502, 2}, {12627503, 167}, {12627504, 205}, {12627505, 179}},
			},
			want: 			cpuState{
				D:   [8]uint32{320546292, 3371567299, 3534409189, 2956171144, 3081627441, 3896994331, 2005837087, 2479881905},
				A:   [7]uint32{541969536, 2266320003, 393043882, 1425963028, 4290298054, 3795195657, 214027027},
				PC:  12627506,
				SR:  1817,
				USP: 2138342,
				SSP: 11739662,
				RAM: [][2]uint32{{12627500, 153}, {12627501, 69}, {12627502, 2}, {12627503, 167}, {12627504, 205}, {12627505, 179}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSUBX_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 SUBX.l -(A6), -(A2) 958e",
			init: cpuState{
				D:   [8]uint32{3998716147, 1884058010, 347900656, 1574976611, 3082201317, 2227218840, 2511244533, 2551522518},
				A:   [7]uint32{1723973144, 3968916633, 1403253225, 1895955939, 868571842, 764095775, 2031814423},
				PC:  10788340,
				SR:  8724,
				USP: 10546882,
				SSP: 4313374,
				RAM: [][2]uint32{{10788336, 149}, {10788337, 142}, {10788338, 143}, {10788339, 243}, {12, 50}, {13, 222}, {14, 157}, {15, 148}, {14589332, 87}, {14589333, 251}, {14589334, 193}, {14589335, 15}},
			},
			want: cpuState{
				D:      [8]uint32{3998716147, 1884058010, 347900656, 1574976611, 3082201317, 2227218840, 2511244533, 2551522518},
				A:      [7]uint32{1723973144, 3968916633, 1403253225, 1895955939, 868571842, 764095775, 2031814423},
				PC:     853450136,
				SR:     8724,
				USP:    10546882,
				SSP:    4313360,
				RAM:    [][2]uint32{{10788336, 149}, {10788337, 142}, {10788338, 143}, {10788339, 243}, {4313372, 157}, {4313373, 244}, {4313368, 34}, {4313369, 20}, {4313370, 0}, {4313371, 164}, {4313366, 149}, {4313367, 142}, {4313364, 7}, {4313365, 21}, {4313360, 149}, {4313361, 149}, {4313362, 121}, {4313363, 27}, {12, 50}, {13, 222}, {14, 157}, {15, 148}, {14589332, 87}, {14589333, 251}, {14589334, 193}, {14589335, 15}},
				Halted: true,
			},
		},
		{
			name: "500 SUBX.l D5, D6 9d85",
			init: cpuState{
				D:   [8]uint32{1177166279, 2983156458, 4052913851, 3653753092, 1481739443, 280949103, 2853165828, 4158329713},
				A:   [7]uint32{1994257294, 3560441798, 555313364, 1296375058, 1883998737, 4097668338, 2082551441},
				PC:  15477386,
				SR:  799,
				USP: 13714882,
				SSP: 7272352,
				RAM: [][2]uint32{{15477382, 157}, {15477383, 133}, {15477384, 88}, {15477385, 163}, {15477386, 203}, {15477387, 226}},
			},
			want: cpuState{
				D:   [8]uint32{1177166279, 2983156458, 4052913851, 3653753092, 1481739443, 280949103, 2572216724, 4158329713},
				A:   [7]uint32{1994257294, 3560441798, 555313364, 1296375058, 1883998737, 4097668338, 2082551441},
				PC:  15477388,
				SR:  776,
				USP: 13714882,
				SSP: 7272352,
				RAM: [][2]uint32{{15477382, 157}, {15477383, 133}, {15477384, 88}, {15477385, 163}, {15477386, 203}, {15477387, 226}},
				Cycles: 8,
			},
		},
		{
			name: "1000 SUBX.l -(A0), -(A2) 9588",
			init: cpuState{
				D:   [8]uint32{1073792535, 1713940482, 4150666253, 3680109022, 3585595004, 133752179, 568794129, 2437906882},
				A:   [7]uint32{3406972139, 3339041660, 4172556270, 4200484020, 1820746192, 4211564701, 177623546},
				PC:  16263260,
				SR:  1291,
				USP: 8404574,
				SSP: 12640662,
				RAM: [][2]uint32{{16263256, 149}, {16263257, 136}, {16263258, 249}, {16263259, 41}, {12, 129}, {13, 34}, {14, 201}, {15, 52}, {2279732, 134}, {2279733, 128}, {2279734, 109}, {2279735, 192}},
			},
			want: cpuState{
				D:      [8]uint32{1073792535, 1713940482, 4150666253, 3680109022, 3585595004, 133752179, 568794129, 2437906882},
				A:      [7]uint32{3406972139, 3339041660, 4172556270, 4200484020, 1820746192, 4211564701, 177623546},
				PC:     2166540600,
				SR:     9483,
				USP:    8404574,
				SSP:    12640648,
				RAM:    [][2]uint32{{16263256, 149}, {16263257, 136}, {16263258, 249}, {16263259, 41}, {12640660, 40}, {12640661, 92}, {12640656, 5}, {12640657, 11}, {12640658, 0}, {12640659, 248}, {12640654, 149}, {12640655, 136}, {12640652, 68}, {12640653, 233}, {12640648, 149}, {12640649, 145}, {12640650, 203}, {12640651, 18}, {12, 129}, {13, 34}, {14, 201}, {15, 52}, {2279732, 134}, {2279733, 128}, {2279734, 109}, {2279735, 192}},
				Halted: true,
			},
		},
		{
			name: "1500 SUBX.l D3, D1 9383",
			init: cpuState{
				D:   [8]uint32{3081361654, 1949624502, 275647440, 4203986045, 2801166071, 3214309611, 3618139208, 521033498},
				A:   [7]uint32{2198920263, 2656819640, 1901102606, 1347607790, 527186474, 2690600641, 2192291404},
				PC:  5508346,
				SR:  42781,
				USP: 14277816,
				SSP: 6647522,
				RAM: [][2]uint32{{5508342, 147}, {5508343, 131}, {5508344, 66}, {5508345, 153}, {5508346, 69}, {5508347, 84}},
			},
			want: cpuState{
				D:   [8]uint32{3081361654, 2040605752, 275647440, 4203986045, 2801166071, 3214309611, 3618139208, 521033498},
				A:   [7]uint32{2198920263, 2656819640, 1901102606, 1347607790, 527186474, 2690600641, 2192291404},
				PC:  5508348,
				SR:  42769,
				USP: 14277816,
				SSP: 6647522,
				RAM: [][2]uint32{{5508342, 147}, {5508343, 131}, {5508344, 66}, {5508345, 153}, {5508346, 69}, {5508347, 84}},
				Cycles: 8,
			},
		},
		{
			name: "2000 SUBX.l D1, D6 9d81",
			init: cpuState{
				D:   [8]uint32{3270441181, 2998506866, 266330081, 3613779098, 2443894529, 3085376056, 2530138017, 819066031},
				A:   [7]uint32{568205808, 4157961893, 2519078259, 720555680, 940767118, 3553912161, 883864083},
				PC:  13146686,
				SR:  8961,
				USP: 574652,
				SSP: 3515870,
				RAM: [][2]uint32{{13146682, 157}, {13146683, 129}, {13146684, 123}, {13146685, 25}, {13146686, 243}, {13146687, 27}},
			},
			want: cpuState{
				D:   [8]uint32{3270441181, 2998506866, 266330081, 3613779098, 2443894529, 3085376056, 3826598447, 819066031},
				A:   [7]uint32{568205808, 4157961893, 2519078259, 720555680, 940767118, 3553912161, 883864083},
				PC:  13146688,
				SR:  8985,
				USP: 574652,
				SSP: 3515870,
				RAM: [][2]uint32{{13146682, 157}, {13146683, 129}, {13146684, 123}, {13146685, 25}, {13146686, 243}, {13146687, 27}},
				Cycles: 8,
			},
		},
		{
			name: "001 SUBX.l D4, D7 9f84",
			init: 			cpuState{
				D:   [8]uint32{2846744529, 3811950143, 3757458348, 791707571, 3128395329, 2706499770, 1389574661, 1971322148},
				A:   [7]uint32{706501897, 2465501078, 1176199486, 1633805654, 3975683162, 3997360605, 2424496290},
				PC:  10590438,
				SR:  9759,
				USP: 7568458,
				SSP: 1969398,
				RAM: [][2]uint32{{10590434, 159}, {10590435, 132}, {10590436, 123}, {10590437, 176}, {10590438, 9}, {10590439, 83}},
			},
			want: 			cpuState{
				D:   [8]uint32{2846744529, 3811950143, 3757458348, 791707571, 3128395329, 2706499770, 1389574661, 3137894114},
				A:   [7]uint32{706501897, 2465501078, 1176199486, 1633805654, 3975683162, 3997360605, 2424496290},
				PC:  10590440,
				SR:  9755,
				USP: 7568458,
				SSP: 1969398,
				RAM: [][2]uint32{{10590434, 159}, {10590435, 132}, {10590436, 123}, {10590437, 176}, {10590438, 9}, {10590439, 83}},
				Cycles: 8,
			},
		},
		{
			name: "268 SUBX.l D0, D5 9b80",
			init: 			cpuState{
				D:   [8]uint32{3627360231, 1891284473, 636061557, 488189796, 889711014, 3202279026, 2560861616, 3283368252},
				A:   [7]uint32{3366442407, 1048612978, 1169874189, 499602073, 688749751, 2284745398, 3716118638},
				PC:  3778492,
				SR:  8969,
				USP: 4208576,
				SSP: 14165898,
				RAM: [][2]uint32{{3778488, 155}, {3778489, 128}, {3778490, 93}, {3778491, 22}, {3778492, 226}, {3778493, 215}},
			},
			want: 			cpuState{
				D:   [8]uint32{3627360231, 1891284473, 636061557, 488189796, 889711014, 3869886091, 2560861616, 3283368252},
				A:   [7]uint32{3366442407, 1048612978, 1169874189, 499602073, 688749751, 2284745398, 3716118638},
				PC:  3778494,
				SR:  8985,
				USP: 4208576,
				SSP: 14165898,
				RAM: [][2]uint32{{3778488, 155}, {3778489, 128}, {3778490, 93}, {3778491, 22}, {3778492, 226}, {3778493, 215}},
				Cycles: 8,
			},
		},
		{
			name: "537 SUBX.l D6, D1 9386",
			init: 			cpuState{
				D:   [8]uint32{1347472755, 2303619929, 2296112491, 1991508393, 2641389212, 1588511895, 462299543, 1096180515},
				A:   [7]uint32{600780468, 2732745891, 2227987218, 4293033472, 440166393, 1933036396, 3755800177},
				PC:  3927564,
				SR:  773,
				USP: 15437456,
				SSP: 2727166,
				RAM: [][2]uint32{{3927560, 147}, {3927561, 134}, {3927562, 152}, {3927563, 239}, {3927564, 229}, {3927565, 214}},
			},
			want: 			cpuState{
				D:   [8]uint32{1347472755, 1841320386, 2296112491, 1991508393, 2641389212, 1588511895, 462299543, 1096180515},
				A:   [7]uint32{600780468, 2732745891, 2227987218, 4293033472, 440166393, 1933036396, 3755800177},
				PC:  3927566,
				SR:  770,
				USP: 15437456,
				SSP: 2727166,
				RAM: [][2]uint32{{3927560, 147}, {3927561, 134}, {3927562, 152}, {3927563, 239}, {3927564, 229}, {3927565, 214}},
				Cycles: 8,
			},
		},
		{
			name: "810 SUBX.l D4, D4 9984",
			init: 			cpuState{
				D:   [8]uint32{1155498546, 2284177243, 276579434, 2674706048, 2203284177, 4059553492, 504782347, 3822826347},
				A:   [7]uint32{886501510, 3721436392, 2022175452, 3235544668, 784431293, 1471060011, 3575802022},
				PC:  10123572,
				SR:  515,
				USP: 2397764,
				SSP: 10121408,
				RAM: [][2]uint32{{10123568, 153}, {10123569, 132}, {10123570, 38}, {10123571, 116}, {10123572, 173}, {10123573, 109}},
			},
			want: 			cpuState{
				D:   [8]uint32{1155498546, 2284177243, 276579434, 2674706048, 0, 4059553492, 504782347, 3822826347},
				A:   [7]uint32{886501510, 3721436392, 2022175452, 3235544668, 784431293, 1471060011, 3575802022},
				PC:  10123574,
				SR:  512,
				USP: 2397764,
				SSP: 10121408,
				RAM: [][2]uint32{{10123568, 153}, {10123569, 132}, {10123570, 38}, {10123571, 116}, {10123572, 173}, {10123573, 109}},
				Cycles: 8,
			},
		},
		{
			name: "1076 SUBX.l -(A4), -(A7) 9f8c",
			init: 			cpuState{
				D:   [8]uint32{1889358426, 658794376, 2237780835, 3078004083, 3989963167, 1515568213, 3874524428, 317055382},
				A:   [7]uint32{840490223, 2960662902, 1729667349, 1874951720, 3752283964, 3909502000, 4200170333},
				PC:  3771974,
				SR:  256,
				USP: 1457476,
				SSP: 347520,
				RAM: [][2]uint32{{3771970, 159}, {3771971, 140}, {3771972, 231}, {3771973, 47}, {10964794, 43}, {10964795, 217}, {10964792, 221}, {10964793, 45}, {1457474, 134}, {1457475, 221}, {1457472, 196}, {1457473, 204}, {3771974, 132}, {3771975, 159}},
			},
			want: 			cpuState{
				D:   [8]uint32{1889358426, 658794376, 2237780835, 3078004083, 3989963167, 1515568213, 3874524428, 317055382},
				A:   [7]uint32{840490223, 2960662902, 1729667349, 1874951720, 3752283960, 3909502000, 4200170333},
				PC:  3771976,
				SR:  281,
				USP: 1457472,
				SSP: 347520,
				RAM: [][2]uint32{{3771970, 159}, {3771971, 140}, {3771972, 231}, {3771973, 47}, {10964794, 43}, {10964795, 217}, {10964792, 221}, {10964793, 45}, {1457474, 91}, {1457475, 4}, {1457472, 231}, {1457473, 159}, {3771974, 132}, {3771975, 159}},
				Cycles: 30,
			},
		},
		{
			name: "1332 SUBX.l D0, D1 9380",
			init: 			cpuState{
				D:   [8]uint32{4038978936, 182381623, 2210319843, 3476606316, 892418665, 1978877863, 849076894, 1454509943},
				A:   [7]uint32{2846415773, 2371864051, 2858151837, 1740233342, 3409008133, 4034491601, 3961789807},
				PC:  12820,
				SR:  9226,
				USP: 1300084,
				SSP: 609800,
				RAM: [][2]uint32{{12816, 147}, {12817, 128}, {12818, 14}, {12819, 188}, {12820, 93}, {12821, 240}},
			},
			want: 			cpuState{
				D:   [8]uint32{4038978936, 438369983, 2210319843, 3476606316, 892418665, 1978877863, 849076894, 1454509943},
				A:   [7]uint32{2846415773, 2371864051, 2858151837, 1740233342, 3409008133, 4034491601, 3961789807},
				PC:  12822,
				SR:  9233,
				USP: 1300084,
				SSP: 609800,
				RAM: [][2]uint32{{12816, 147}, {12817, 128}, {12818, 14}, {12819, 188}, {12820, 93}, {12821, 240}},
				Cycles: 8,
			},
		},
		{
			name: "1620 SUBX.l -(A4), -(A7) 9f8c",
			init: 			cpuState{
				D:   [8]uint32{1040778239, 2696205957, 4236358866, 908537446, 316714423, 1269343830, 2035106146, 3899518325},
				A:   [7]uint32{2658296679, 3624286719, 2416255340, 2388971360, 3043231172, 2574511205, 2864830366},
				PC:  2505620,
				SR:  8458,
				USP: 10971540,
				SSP: 4931090,
				RAM: [][2]uint32{{2505616, 159}, {2505617, 140}, {2505618, 41}, {2505619, 210}, {6555074, 35}, {6555075, 57}, {6555072, 204}, {6555073, 161}, {4931088, 207}, {4931089, 81}, {4931086, 130}, {4931087, 18}, {2505620, 68}, {2505621, 187}},
			},
			want: 			cpuState{
				D:   [8]uint32{1040778239, 2696205957, 4236358866, 908537446, 316714423, 1269343830, 2035106146, 3899518325},
				A:   [7]uint32{2658296679, 3624286719, 2416255340, 2388971360, 3043231168, 2574511205, 2864830366},
				PC:  2505622,
				SR:  8473,
				USP: 10971540,
				SSP: 4931086,
				RAM: [][2]uint32{{2505616, 159}, {2505617, 140}, {2505618, 41}, {2505619, 210}, {6555074, 35}, {6555075, 57}, {6555072, 204}, {6555073, 161}, {4931088, 172}, {4931089, 24}, {4931086, 181}, {4931087, 113}, {2505620, 68}, {2505621, 187}},
				Cycles: 30,
			},
		},
		{
			name: "1908 SUBX.l D4, D5 9b84",
			init: 			cpuState{
				D:   [8]uint32{2799306227, 2017843723, 3361845494, 3469794309, 901884384, 542470516, 3055179047, 4104589746},
				A:   [7]uint32{1364478446, 4275886669, 860558871, 2941457501, 2304733611, 266235466, 2063626168},
				PC:  6336898,
				SR:  535,
				USP: 4717914,
				SSP: 1617556,
				RAM: [][2]uint32{{6336894, 155}, {6336895, 132}, {6336896, 105}, {6336897, 122}, {6336898, 33}, {6336899, 238}},
			},
			want: 			cpuState{
				D:   [8]uint32{2799306227, 2017843723, 3361845494, 3469794309, 901884384, 3935553427, 3055179047, 4104589746},
				A:   [7]uint32{1364478446, 4275886669, 860558871, 2941457501, 2304733611, 266235466, 2063626168},
				PC:  6336900,
				SR:  537,
				USP: 4717914,
				SSP: 1617556,
				RAM: [][2]uint32{{6336894, 155}, {6336895, 132}, {6336896, 105}, {6336897, 122}, {6336898, 33}, {6336899, 238}},
				Cycles: 8,
			},
		},
		{
			name: "2198 SUBX.l D2, D4 9982",
			init: 			cpuState{
				D:   [8]uint32{855195509, 2690762680, 3553311503, 213933440, 3537759294, 1008321809, 227323947, 3078587872},
				A:   [7]uint32{26167993, 274984623, 2368621872, 3323694881, 1406242803, 3847457355, 19844663},
				PC:  6752430,
				SR:  1796,
				USP: 13192260,
				SSP: 8889412,
				RAM: [][2]uint32{{6752426, 153}, {6752427, 130}, {6752428, 78}, {6752429, 180}, {6752430, 99}, {6752431, 32}},
			},
			want: 			cpuState{
				D:   [8]uint32{855195509, 2690762680, 3553311503, 213933440, 4279415087, 1008321809, 227323947, 3078587872},
				A:   [7]uint32{26167993, 274984623, 2368621872, 3323694881, 1406242803, 3847457355, 19844663},
				PC:  6752432,
				SR:  1817,
				USP: 13192260,
				SSP: 8889412,
				RAM: [][2]uint32{{6752426, 153}, {6752427, 130}, {6752428, 78}, {6752429, 180}, {6752430, 99}, {6752431, 32}},
				Cycles: 8,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestCMP_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 CMP.b -(A6), D4 b826",
			init: cpuState{
				D:   [8]uint32{971844580, 1812861013, 27970319, 3949035807, 2380838791, 3659193200, 145864429, 3453271095},
				A:   [7]uint32{1372439117, 2510623076, 305287105, 4155038048, 367488451, 2584974675, 2945782320},
				PC:  10279440,
				SR:  34061,
				USP: 11391200,
				SSP: 10095880,
				RAM: [][2]uint32{{10279436, 184}, {10279437, 38}, {10279438, 17}, {10279439, 4}, {9769518, 63}, {9769519, 246}, {10279440, 74}, {10279441, 145}},
			},
			want: cpuState{
				D:   [8]uint32{971844580, 1812861013, 27970319, 3949035807, 2380838791, 3659193200, 145864429, 3453271095},
				A:   [7]uint32{1372439117, 2510623076, 305287105, 4155038048, 367488451, 2584974675, 2945782319},
				PC:  10279442,
				SR:  34057,
				USP: 11391200,
				SSP: 10095880,
				RAM: [][2]uint32{{10279436, 184}, {10279437, 38}, {10279438, 17}, {10279439, 4}, {9769518, 63}, {9769519, 246}, {10279440, 74}, {10279441, 145}},
				Cycles: 10,
			},
		},
		{
			name: "500 CMP.b (A3)+, D6 bc1b",
			init: cpuState{
				D:   [8]uint32{4103582143, 3541400306, 2142431289, 2317210614, 1887327045, 2952401233, 3185063202, 3176330391},
				A:   [7]uint32{1407754141, 401874186, 4286769263, 2964796375, 2781891991, 3233929964, 2763242394},
				PC:  2419364,
				SR:  42764,
				USP: 3717632,
				SSP: 7952714,
				RAM: [][2]uint32{{2419360, 188}, {2419361, 27}, {2419362, 104}, {2419363, 32}, {12006358, 184}, {12006359, 148}, {2419364, 102}, {2419365, 185}},
			},
			want: cpuState{
				D:   [8]uint32{4103582143, 3541400306, 2142431289, 2317210614, 1887327045, 2952401233, 3185063202, 3176330391},
				A:   [7]uint32{1407754141, 401874186, 4286769263, 2964796376, 2781891991, 3233929964, 2763242394},
				PC:  2419366,
				SR:  42763,
				USP: 3717632,
				SSP: 7952714,
				RAM: [][2]uint32{{2419360, 188}, {2419361, 27}, {2419362, 104}, {2419363, 32}, {12006358, 184}, {12006359, 148}, {2419364, 102}, {2419365, 185}},
				Cycles: 8,
			},
		},
		{
			name: "1000 CMP.b (A2)+, D6 bc1a",
			init: cpuState{
				D:   [8]uint32{587359256, 3377784372, 3419674454, 3191861891, 2231089784, 4260099078, 836723093, 3141217735},
				A:   [7]uint32{4137390969, 809576895, 2181251552, 4114761434, 2237186001, 2287719562, 2250507913},
				PC:  5320572,
				SR:  271,
				USP: 9094554,
				SSP: 11548102,
				RAM: [][2]uint32{{5320568, 188}, {5320569, 26}, {5320570, 159}, {5320571, 133}, {213472, 159}, {213473, 23}, {5320572, 11}, {5320573, 12}},
			},
			want: cpuState{
				D:   [8]uint32{587359256, 3377784372, 3419674454, 3191861891, 2231089784, 4260099078, 836723093, 3141217735},
				A:   [7]uint32{4137390969, 809576895, 2181251553, 4114761434, 2237186001, 2287719562, 2250507913},
				PC:  5320574,
				SR:  265,
				USP: 9094554,
				SSP: 11548102,
				RAM: [][2]uint32{{5320568, 188}, {5320569, 26}, {5320570, 159}, {5320571, 133}, {213472, 159}, {213473, 23}, {5320572, 11}, {5320573, 12}},
				Cycles: 8,
			},
		},
		{
			name: "1500 CMP.b (A0)+, (A1)+ b308",
			init: cpuState{
				D:   [8]uint32{477093065, 2614927220, 3913435992, 1552413812, 3318717539, 1856776789, 2613612364, 1210048736},
				A:   [7]uint32{971509181, 1410455758, 1605825394, 2560635674, 4207601826, 3367104321, 1245244702},
				PC:  2291006,
				SR:  1547,
				USP: 14016228,
				SSP: 7422354,
				RAM: [][2]uint32{{2291002, 179}, {2291003, 8}, {2291004, 252}, {2291005, 194}, {15207868, 20}, {15207869, 198}, {1169614, 235}, {1169615, 54}, {2291006, 191}, {2291007, 64}},
			},
			want: cpuState{
				D:   [8]uint32{477093065, 2614927220, 3913435992, 1552413812, 3318717539, 1856776789, 2613612364, 1210048736},
				A:   [7]uint32{971509182, 1410455759, 1605825394, 2560635674, 4207601826, 3367104321, 1245244702},
				PC:  2291008,
				SR:  1536,
				USP: 14016228,
				SSP: 7422354,
				RAM: [][2]uint32{{2291002, 179}, {2291003, 8}, {2291004, 252}, {2291005, 194}, {15207868, 20}, {15207869, 198}, {1169614, 235}, {1169615, 54}, {2291006, 191}, {2291007, 64}},
				Cycles: 12,
			},
		},
		{
			name: "2000 CMP.b (A0)+, (A7)+ bf08",
			init: cpuState{
				D:   [8]uint32{2664990469, 3584817476, 1655904414, 3265092004, 2379807461, 1282059737, 3821217157, 44524397},
				A:   [7]uint32{4057619591, 446612087, 2324484762, 562336244, 1340700737, 1157129157, 738026055},
				PC:  2839622,
				SR:  41485,
				USP: 6060238,
				SSP: 2341050,
				RAM: [][2]uint32{{2839618, 191}, {2839619, 8}, {2839620, 166}, {2839621, 7}, {14310534, 30}, {14310535, 222}, {2341050, 157}, {2341051, 57}, {2839622, 46}, {2839623, 111}},
			},
			want: cpuState{
				D:   [8]uint32{2664990469, 3584817476, 1655904414, 3265092004, 2379807461, 1282059737, 3821217157, 44524397},
				A:   [7]uint32{4057619592, 446612087, 2324484762, 562336244, 1340700737, 1157129157, 738026055},
				PC:  2839624,
				SR:  41481,
				USP: 6060238,
				SSP: 2341052,
				RAM: [][2]uint32{{2839618, 191}, {2839619, 8}, {2839620, 166}, {2839621, 7}, {14310534, 30}, {14310535, 222}, {2341050, 157}, {2341051, 57}, {2839622, 46}, {2839623, 111}},
				Cycles: 12,
			},
		},
		{
			name: "002 CMP.b (d8, PC, Xn), D2 b43b",
			init: 			cpuState{
				D:   [8]uint32{3989715567, 1302537333, 401529763, 3169726609, 4063666599, 2368054247, 990446886, 3062977807},
				A:   [7]uint32{2202149248, 3242217670, 960171128, 3634554875, 1083952000, 209030031, 2859413565},
				PC:  9685998,
				SR:  780,
				USP: 13852610,
				SSP: 10709700,
				RAM: [][2]uint32{{9685994, 180}, {9685995, 59}, {9685996, 14}, {9685997, 254}, {9685998, 165}, {9685999, 24}, {6424152, 237}, {6424153, 59}, {9686000, 201}, {9686001, 35}},
			},
			want: 			cpuState{
				D:   [8]uint32{3989715567, 1302537333, 401529763, 3169726609, 4063666599, 2368054247, 990446886, 3062977807},
				A:   [7]uint32{2202149248, 3242217670, 960171128, 3634554875, 1083952000, 209030031, 2859413565},
				PC:  9686002,
				SR:  770,
				USP: 13852610,
				SSP: 10709700,
				RAM: [][2]uint32{{9685994, 180}, {9685995, 59}, {9685996, 14}, {9685997, 254}, {9685998, 165}, {9685999, 24}, {6424152, 237}, {6424153, 59}, {9686000, 201}, {9686001, 35}},
				Cycles: 14,
			},
		},
		{
			name: "296 CMP.b (d8, A4, Xn), D5 ba34",
			init: 			cpuState{
				D:   [8]uint32{2585432126, 3276385240, 2138257765, 3765043258, 44839818, 3822429931, 4078893862, 551766447},
				A:   [7]uint32{946006601, 3065764921, 1455124836, 795514392, 3058701479, 2740883538, 1962566536},
				PC:  3910802,
				SR:  8213,
				USP: 15472930,
				SSP: 10401124,
				RAM: [][2]uint32{{3910798, 186}, {3910799, 52}, {3910800, 175}, {3910801, 227}, {3910802, 134}, {3910803, 209}, {755182, 239}, {755183, 139}, {3910804, 173}, {3910805, 193}},
			},
			want: 			cpuState{
				D:   [8]uint32{2585432126, 3276385240, 2138257765, 3765043258, 44839818, 3822429931, 4078893862, 551766447},
				A:   [7]uint32{946006601, 3065764921, 1455124836, 795514392, 3058701479, 2740883538, 1962566536},
				PC:  3910806,
				SR:  8217,
				USP: 15472930,
				SSP: 10401124,
				RAM: [][2]uint32{{3910798, 186}, {3910799, 52}, {3910800, 175}, {3910801, 227}, {3910802, 134}, {3910803, 209}, {755182, 239}, {755183, 139}, {3910804, 173}, {3910805, 193}},
				Cycles: 14,
			},
		},
		{
			name: "606 CMP.b (A6)+, (A0)+ b10e",
			init: 			cpuState{
				D:   [8]uint32{2265321887, 2542610324, 631660437, 1976613724, 3936386585, 3590096312, 1784282238, 839269422},
				A:   [7]uint32{1431361966, 271077692, 4147564658, 2097640564, 2901087020, 3802930278, 930206317},
				PC:  2284416,
				SR:  1282,
				USP: 6780032,
				SSP: 14873740,
				RAM: [][2]uint32{{2284412, 177}, {2284413, 14}, {2284414, 47}, {2284415, 93}, {7459436, 150}, {7459437, 159}, {5298606, 118}, {5298607, 4}, {2284416, 242}, {2284417, 26}},
			},
			want: 			cpuState{
				D:   [8]uint32{2265321887, 2542610324, 631660437, 1976613724, 3936386585, 3590096312, 1784282238, 839269422},
				A:   [7]uint32{1431361967, 271077692, 4147564658, 2097640564, 2901087020, 3802930278, 930206318},
				PC:  2284418,
				SR:  1291,
				USP: 6780032,
				SSP: 14873740,
				RAM: [][2]uint32{{2284412, 177}, {2284413, 14}, {2284414, 47}, {2284415, 93}, {7459436, 150}, {7459437, 159}, {5298606, 118}, {5298607, 4}, {2284416, 242}, {2284417, 26}},
				Cycles: 12,
			},
		},
		{
			name: "885 CMP.b D4, D3 b604",
			init: 			cpuState{
				D:   [8]uint32{1807466121, 3058053230, 1764205360, 1987661992, 3231659982, 79529115, 569474669, 2104788883},
				A:   [7]uint32{4084892244, 1784610339, 2242641608, 2697791487, 601444437, 439027659, 233791423},
				PC:  5286596,
				SR:  8479,
				USP: 7222972,
				SSP: 8183284,
				RAM: [][2]uint32{{5286592, 182}, {5286593, 4}, {5286594, 209}, {5286595, 4}, {5286596, 95}, {5286597, 94}},
			},
			want: 			cpuState{
				D:   [8]uint32{1807466121, 3058053230, 1764205360, 1987661992, 3231659982, 79529115, 569474669, 2104788883},
				A:   [7]uint32{4084892244, 1784610339, 2242641608, 2697791487, 601444437, 439027659, 233791423},
				PC:  5286598,
				SR:  8473,
				USP: 7222972,
				SSP: 8183284,
				RAM: [][2]uint32{{5286592, 182}, {5286593, 4}, {5286594, 209}, {5286595, 4}, {5286596, 95}, {5286597, 94}},
				Cycles: 4,
			},
		},
		{
			name: "1132 CMP.b -(A7), D0 b027",
			init: 			cpuState{
				D:   [8]uint32{2447994202, 1537048186, 2865603401, 3905308907, 2561064429, 1125761410, 2763601349, 1968096266},
				A:   [7]uint32{1378273867, 1558435517, 3073119962, 2774174572, 1260094523, 1152195663, 3900501349},
				PC:  4071892,
				SR:  1030,
				USP: 13126958,
				SSP: 13320928,
				RAM: [][2]uint32{{4071888, 176}, {4071889, 39}, {4071890, 148}, {4071891, 144}, {13126956, 233}, {13126957, 111}, {4071892, 128}, {4071893, 104}},
			},
			want: 			cpuState{
				D:   [8]uint32{2447994202, 1537048186, 2865603401, 3905308907, 2561064429, 1125761410, 2763601349, 1968096266},
				A:   [7]uint32{1378273867, 1558435517, 3073119962, 2774174572, 1260094523, 1152195663, 3900501349},
				PC:  4071894,
				SR:  1025,
				USP: 13126956,
				SSP: 13320928,
				RAM: [][2]uint32{{4071888, 176}, {4071889, 39}, {4071890, 148}, {4071891, 144}, {13126956, 233}, {13126957, 111}, {4071892, 128}, {4071893, 104}},
				Cycles: 10,
			},
		},
		{
			name: "1409 CMP.b (d8, A5, Xn), D4 b835",
			init: 			cpuState{
				D:   [8]uint32{180278429, 3352708790, 4080488667, 2562797684, 3286927501, 2796304691, 3596905366, 3522208445},
				A:   [7]uint32{104382506, 1044807556, 781186689, 3211151941, 1501413890, 1109574114, 2796778760},
				PC:  4496098,
				SR:  1795,
				USP: 11499318,
				SSP: 5215542,
				RAM: [][2]uint32{{4496094, 184}, {4496095, 53}, {4496096, 161}, {4496097, 95}, {4496098, 180}, {4496099, 191}, {2275522, 104}, {2275523, 38}, {4496100, 42}, {4496101, 239}},
			},
			want: 			cpuState{
				D:   [8]uint32{180278429, 3352708790, 4080488667, 2562797684, 3286927501, 2796304691, 3596905366, 3522208445},
				A:   [7]uint32{104382506, 1044807556, 781186689, 3211151941, 1501413890, 1109574114, 2796778760},
				PC:  4496102,
				SR:  1794,
				USP: 11499318,
				SSP: 5215542,
				RAM: [][2]uint32{{4496094, 184}, {4496095, 53}, {4496096, 161}, {4496097, 95}, {4496098, 180}, {4496099, 191}, {2275522, 104}, {2275523, 38}, {4496100, 42}, {4496101, 239}},
				Cycles: 14,
			},
		},
		{
			name: "1684 CMP.b (A1)+, (A6)+ bd09",
			init: 			cpuState{
				D:   [8]uint32{421100080, 3901499752, 299820611, 2536805308, 1200400550, 3419209804, 115677565, 1260627495},
				A:   [7]uint32{1056335815, 477278968, 2024759193, 2321782126, 285580517, 680720384, 1161956883},
				PC:  6554554,
				SR:  8718,
				USP: 2152044,
				SSP: 14259520,
				RAM: [][2]uint32{{6554550, 189}, {6554551, 9}, {6554552, 145}, {6554553, 78}, {7516920, 227}, {7516921, 3}, {4328978, 215}, {4328979, 10}, {6554554, 45}, {6554555, 149}},
			},
			want: 			cpuState{
				D:   [8]uint32{421100080, 3901499752, 299820611, 2536805308, 1200400550, 3419209804, 115677565, 1260627495},
				A:   [7]uint32{1056335815, 477278969, 2024759193, 2321782126, 285580517, 680720384, 1161956884},
				PC:  6554556,
				SR:  8705,
				USP: 2152044,
				SSP: 14259520,
				RAM: [][2]uint32{{6554550, 189}, {6554551, 9}, {6554552, 145}, {6554553, 78}, {7516920, 227}, {7516921, 3}, {4328978, 215}, {4328979, 10}, {6554554, 45}, {6554555, 149}},
				Cycles: 12,
			},
		},
		{
			name: "1950 CMP.b (d16, A4), D5 ba2c",
			init: 			cpuState{
				D:   [8]uint32{3461101194, 453261149, 1799883774, 3889119684, 720496343, 784615435, 3552283447, 411963894},
				A:   [7]uint32{3767937714, 4045996064, 3682529728, 4088118180, 1814677340, 686986873, 3662957746},
				PC:  6934522,
				SR:  22,
				USP: 8337032,
				SSP: 7976310,
				RAM: [][2]uint32{{6934518, 186}, {6934519, 44}, {6934520, 66}, {6934521, 91}, {6934522, 150}, {6934523, 102}, {2754998, 234}, {2754999, 75}, {6934524, 136}, {6934525, 40}},
			},
			want: 			cpuState{
				D:   [8]uint32{3461101194, 453261149, 1799883774, 3889119684, 720496343, 784615435, 3552283447, 411963894},
				A:   [7]uint32{3767937714, 4045996064, 3682529728, 4088118180, 1814677340, 686986873, 3662957746},
				PC:  6934526,
				SR:  25,
				USP: 8337032,
				SSP: 7976310,
				RAM: [][2]uint32{{6934518, 186}, {6934519, 44}, {6934520, 66}, {6934521, 91}, {6934522, 150}, {6934523, 102}, {2754998, 234}, {2754999, 75}, {6934524, 136}, {6934525, 40}},
				Cycles: 12,
			},
		},
		{
			name: "2225 CMP.b (A4)+, (A3)+ b70c",
			init: 			cpuState{
				D:   [8]uint32{1207165996, 2935955860, 1537178041, 34257171, 2637019177, 2971316985, 3483245005, 4201230487},
				A:   [7]uint32{2515480549, 2559473744, 2521791565, 1567807257, 4046319782, 3643660404, 1103062621},
				PC:  4056948,
				SR:  9987,
				USP: 6248754,
				SSP: 4293974,
				RAM: [][2]uint32{{4056944, 183}, {4056945, 12}, {4056946, 237}, {4056947, 162}, {3010726, 211}, {3010727, 35}, {7526168, 172}, {7526169, 20}, {4056948, 202}, {4056949, 23}},
			},
			want: 			cpuState{
				D:   [8]uint32{1207165996, 2935955860, 1537178041, 34257171, 2637019177, 2971316985, 3483245005, 4201230487},
				A:   [7]uint32{2515480549, 2559473744, 2521791565, 1567807258, 4046319783, 3643660404, 1103062621},
				PC:  4056950,
				SR:  9985,
				USP: 6248754,
				SSP: 4293974,
				RAM: [][2]uint32{{4056944, 183}, {4056945, 12}, {4056946, 237}, {4056947, 162}, {3010726, 211}, {3010727, 35}, {7526168, 172}, {7526169, 20}, {4056948, 202}, {4056949, 23}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestCMP_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 CMP.w D0, D7 be40",
			init: cpuState{
				D:   [8]uint32{475846680, 1619015039, 2261907358, 638950013, 2024958630, 2787497989, 2852434231, 2181996627},
				A:   [7]uint32{912093076, 3515086865, 685731751, 945725105, 709438987, 719239687, 621681129},
				PC:  4295318,
				SR:  1553,
				USP: 15983202,
				SSP: 14333880,
				RAM: [][2]uint32{{4295314, 190}, {4295315, 64}, {4295316, 17}, {4295317, 40}, {4295318, 156}, {4295319, 47}},
			},
			want: cpuState{
				D:   [8]uint32{475846680, 1619015039, 2261907358, 638950013, 2024958630, 2787497989, 2852434231, 2181996627},
				A:   [7]uint32{912093076, 3515086865, 685731751, 945725105, 709438987, 719239687, 621681129},
				PC:  4295320,
				SR:  1561,
				USP: 15983202,
				SSP: 14333880,
				RAM: [][2]uint32{{4295314, 190}, {4295315, 64}, {4295316, 17}, {4295317, 40}, {4295318, 156}, {4295319, 47}},
				Cycles: 4,
			},
		},
		{
			name: "500 CMP.w -(A1), D0 b061",
			init: cpuState{
				D:   [8]uint32{142592529, 2185911067, 2934495150, 141010255, 2931120456, 3253358107, 845451191, 2640229853},
				A:   [7]uint32{3094419315, 2760999199, 1086957140, 2775550500, 1745243799, 1831606442, 1400276022},
				PC:  9636860,
				SR:  1798,
				USP: 7476816,
				SSP: 7402524,
				RAM: [][2]uint32{{9636856, 176}, {9636857, 97}, {9636858, 116}, {9636859, 108}, {12, 136}, {13, 72}, {14, 119}, {15, 208}, {4749264, 31}, {4749265, 143}, {4749266, 70}, {4749267, 210}},
			},
			want: cpuState{
				D:      [8]uint32{142592529, 2185911067, 2934495150, 141010255, 2931120456, 3253358107, 845451191, 2640229853},
				A:      [7]uint32{3094419315, 2760999197, 1086957140, 2775550500, 1745243799, 1831606442, 1400276022},
				PC:     2286450644,
				SR:     9990,
				USP:    7476816,
				SSP:    7402510,
				RAM:    [][2]uint32{{9636856, 176}, {9636857, 97}, {9636858, 116}, {9636859, 108}, {7402522, 11}, {7402523, 252}, {7402518, 7}, {7402519, 6}, {7402520, 0}, {7402521, 147}, {7402516, 176}, {7402517, 97}, {7402514, 129}, {7402515, 29}, {7402510, 176}, {7402511, 113}, {7402512, 164}, {7402513, 145}, {12, 136}, {13, 72}, {14, 119}, {15, 208}, {4749264, 31}, {4749265, 143}, {4749266, 70}, {4749267, 210}},
				Halted: true,
			},
		},
		{
			name: "1000 CMP.w (A1)+, (A2)+ b549",
			init: cpuState{
				D:   [8]uint32{2174776045, 2906739810, 2593367242, 1246203378, 3712275982, 270526096, 2282705329, 2654483443},
				A:   [7]uint32{2647120325, 2459271211, 2668870752, 383522417, 2493378426, 4249576296, 3061110826},
				PC:  11441080,
				SR:  42763,
				USP: 875472,
				SSP: 8920110,
				RAM: [][2]uint32{{11441076, 181}, {11441077, 73}, {11441078, 125}, {11441079, 0}, {12, 208}, {13, 32}, {14, 233}, {15, 160}, {2156960, 236}, {2156961, 166}, {2156962, 25}, {2156963, 70}},
			},
			want: cpuState{
				D:      [8]uint32{2174776045, 2906739810, 2593367242, 1246203378, 3712275982, 270526096, 2282705329, 2654483443},
				A:      [7]uint32{2647120325, 2459271213, 2668870752, 383522417, 2493378426, 4249576296, 3061110826},
				PC:     3491817892,
				SR:     9995,
				USP:    875472,
				SSP:    8920096,
				RAM:    [][2]uint32{{11441076, 181}, {11441077, 73}, {11441078, 125}, {11441079, 0}, {8920108, 147}, {8920109, 184}, {8920104, 167}, {8920105, 11}, {8920106, 0}, {8920107, 174}, {8920102, 181}, {8920103, 73}, {8920100, 128}, {8920101, 43}, {8920096, 181}, {8920097, 85}, {8920098, 146}, {8920099, 149}, {12, 208}, {13, 32}, {14, 233}, {15, 160}, {2156960, 236}, {2156961, 166}, {2156962, 25}, {2156963, 70}},
				Halted: true,
			},
		},
		{
			name: "1500 CMP.w A3, D1 b24b",
			init: cpuState{
				D:   [8]uint32{532461093, 719949441, 1485963593, 1746427899, 973757195, 1222926418, 2625085399, 3467197186},
				A:   [7]uint32{2932473002, 2804142607, 2270392323, 2858873931, 757070850, 916000211, 1657168767},
				PC:  3642172,
				SR:  8729,
				USP: 5541678,
				SSP: 10787434,
				RAM: [][2]uint32{{3642168, 178}, {3642169, 75}, {3642170, 120}, {3642171, 176}, {3642172, 8}, {3642173, 248}},
			},
			want: cpuState{
				D:   [8]uint32{532461093, 719949441, 1485963593, 1746427899, 973757195, 1222926418, 2625085399, 3467197186},
				A:   [7]uint32{2932473002, 2804142607, 2270392323, 2858873931, 757070850, 916000211, 1657168767},
				PC:  3642174,
				SR:  8729,
				USP: 5541678,
				SSP: 10787434,
				RAM: [][2]uint32{{3642168, 178}, {3642169, 75}, {3642170, 120}, {3642171, 176}, {3642172, 8}, {3642173, 248}},
				Cycles: 4,
			},
		},
		{
			name: "2000 CMP.w (d16, A1), D6 bc69",
			init: cpuState{
				D:   [8]uint32{3380041833, 1023749837, 1014912297, 3165526920, 1286129792, 796254585, 3163641195, 4282601106},
				A:   [7]uint32{191094300, 3417913887, 1168948522, 760140204, 1605406607, 2413961042, 161870244},
				PC:  8605712,
				SR:  32797,
				USP: 2286494,
				SSP: 4895084,
				RAM: [][2]uint32{{8605708, 188}, {8605709, 105}, {8605710, 230}, {8605711, 107}, {8605712, 71}, {8605713, 146}, {12132490, 184}, {12132491, 11}, {8605714, 118}, {8605715, 180}},
			},
			want: cpuState{
				D:   [8]uint32{3380041833, 1023749837, 1014912297, 3165526920, 1286129792, 796254585, 3163641195, 4282601106},
				A:   [7]uint32{191094300, 3417913887, 1168948522, 760140204, 1605406607, 2413961042, 161870244},
				PC:  8605716,
				SR:  32795,
				USP: 2286494,
				SSP: 4895084,
				RAM: [][2]uint32{{8605708, 188}, {8605709, 105}, {8605710, 230}, {8605711, 107}, {8605712, 71}, {8605713, 146}, {12132490, 184}, {12132491, 11}, {8605714, 118}, {8605715, 180}},
				Cycles: 12,
			},
		},
		{
			name: "004 CMP.w A7, D1 b24f",
			init: 			cpuState{
				D:   [8]uint32{4069806603, 3753324041, 2582304153, 82975163, 3218140247, 3743240808, 3389596798, 1969098423},
				A:   [7]uint32{3679047434, 4054464783, 3924683846, 3523685857, 1966797904, 4178429502, 1523375641},
				PC:  11424766,
				SR:  1052,
				USP: 9050752,
				SSP: 2179360,
				RAM: [][2]uint32{{11424762, 178}, {11424763, 79}, {11424764, 39}, {11424765, 253}, {11424766, 247}, {11424767, 195}},
			},
			want: 			cpuState{
				D:   [8]uint32{4069806603, 3753324041, 2582304153, 82975163, 3218140247, 3743240808, 3389596798, 1969098423},
				A:   [7]uint32{3679047434, 4054464783, 3924683846, 3523685857, 1966797904, 4178429502, 1523375641},
				PC:  11424768,
				SR:  1040,
				USP: 9050752,
				SSP: 2179360,
				RAM: [][2]uint32{{11424762, 178}, {11424763, 79}, {11424764, 39}, {11424765, 253}, {11424766, 247}, {11424767, 195}},
				Cycles: 4,
			},
		},
		{
			name: "333 CMP.w #, (A2)+ 0c5a",
			init: 			cpuState{
				D:   [8]uint32{1434217184, 382045865, 1844867861, 379051030, 535806862, 1484859985, 1572016418, 1453442495},
				A:   [7]uint32{1727790216, 977549952, 872817442, 1301368808, 3412507164, 1721027633, 1858430673},
				PC:  15226006,
				SR:  8988,
				USP: 14549104,
				SSP: 12480324,
				RAM: [][2]uint32{{15226002, 12}, {15226003, 90}, {15226004, 23}, {15226005, 203}, {15226006, 136}, {15226007, 234}, {402210, 197}, {402211, 221}, {15226008, 63}, {15226009, 78}},
			},
			want: 			cpuState{
				D:   [8]uint32{1434217184, 382045865, 1844867861, 379051030, 535806862, 1484859985, 1572016418, 1453442495},
				A:   [7]uint32{1727790216, 977549952, 872817444, 1301368808, 3412507164, 1721027633, 1858430673},
				PC:  15226010,
				SR:  8984,
				USP: 14549104,
				SSP: 12480324,
				RAM: [][2]uint32{{15226002, 12}, {15226003, 90}, {15226004, 23}, {15226005, 203}, {15226006, 136}, {15226007, 234}, {402210, 197}, {402211, 221}, {15226008, 63}, {15226009, 78}},
				Cycles: 12,
			},
		},
		{
			name: "598 CMP.w (d8, A7, Xn), D1 b277",
			init: 			cpuState{
				D:   [8]uint32{2878190995, 2618587320, 402853724, 2476618356, 254290997, 877119741, 2518006833, 106446098},
				A:   [7]uint32{2552892364, 1262998495, 772993735, 763081946, 4177412998, 3943018283, 3074783860},
				PC:  7847306,
				SR:  1544,
				USP: 2403110,
				SSP: 10498174,
				RAM: [][2]uint32{{7847302, 178}, {7847303, 119}, {7847304, 198}, {7847305, 2}, {7847306, 179}, {7847307, 58}, {2420398, 132}, {2420399, 229}, {7847308, 198}, {7847309, 63}},
			},
			want: 			cpuState{
				D:   [8]uint32{2878190995, 2618587320, 402853724, 2476618356, 254290997, 877119741, 2518006833, 106446098},
				A:   [7]uint32{2552892364, 1262998495, 772993735, 763081946, 4177412998, 3943018283, 3074783860},
				PC:  7847310,
				SR:  1547,
				USP: 2403110,
				SSP: 10498174,
				RAM: [][2]uint32{{7847302, 178}, {7847303, 119}, {7847304, 198}, {7847305, 2}, {7847306, 179}, {7847307, 58}, {2420398, 132}, {2420399, 229}, {7847308, 198}, {7847309, 63}},
				Cycles: 14,
			},
		},
		{
			name: "858 CMP.w D3, D6 bc43",
			init: 			cpuState{
				D:   [8]uint32{1777291747, 3152359076, 114861547, 3478112364, 83322821, 3000907664, 2186869186, 177212280},
				A:   [7]uint32{2625383126, 2763194117, 714123645, 4035293038, 2721149607, 512436942, 715356904},
				PC:  748684,
				SR:  9729,
				USP: 8720056,
				SSP: 209986,
				RAM: [][2]uint32{{748680, 188}, {748681, 67}, {748682, 153}, {748683, 223}, {748684, 127}, {748685, 41}},
			},
			want: 			cpuState{
				D:   [8]uint32{1777291747, 3152359076, 114861547, 3478112364, 83322821, 3000907664, 2186869186, 177212280},
				A:   [7]uint32{2625383126, 2763194117, 714123645, 4035293038, 2721149607, 512436942, 715356904},
				PC:  748686,
				SR:  9728,
				USP: 8720056,
				SSP: 209986,
				RAM: [][2]uint32{{748680, 188}, {748681, 67}, {748682, 153}, {748683, 223}, {748684, 127}, {748685, 41}},
				Cycles: 4,
			},
		},
		{
			name: "1105 CMP.w D2, D5 ba42",
			init: 			cpuState{
				D:   [8]uint32{10584291, 3158986779, 968048931, 578642302, 589781760, 3625034249, 3879355326, 3621772604},
				A:   [7]uint32{1043744953, 1141901422, 1035625726, 3176170244, 4001627389, 1869039262, 1433362394},
				PC:  16219058,
				SR:  8470,
				USP: 13874062,
				SSP: 4904274,
				RAM: [][2]uint32{{16219054, 186}, {16219055, 66}, {16219056, 209}, {16219057, 232}, {16219058, 112}, {16219059, 191}},
			},
			want: 			cpuState{
				D:   [8]uint32{10584291, 3158986779, 968048931, 578642302, 589781760, 3625034249, 3879355326, 3621772604},
				A:   [7]uint32{1043744953, 1141901422, 1035625726, 3176170244, 4001627389, 1869039262, 1433362394},
				PC:  16219060,
				SR:  8466,
				USP: 13874062,
				SSP: 4904274,
				RAM: [][2]uint32{{16219054, 186}, {16219055, 66}, {16219056, 209}, {16219057, 232}, {16219058, 112}, {16219059, 191}},
				Cycles: 4,
			},
		},
		{
			name: "1386 CMP.w (d8, A4, Xn), D1 b274",
			init: 			cpuState{
				D:   [8]uint32{3600819972, 4166441974, 1506750735, 3863264803, 411419395, 39314099, 199716623, 3013470601},
				A:   [7]uint32{2609427529, 3340348923, 3165698212, 1770814257, 916010983, 475469974, 187331625},
				PC:  7468840,
				SR:  778,
				USP: 12869310,
				SSP: 16762902,
				RAM: [][2]uint32{{7468836, 178}, {7468837, 116}, {7468838, 223}, {7468839, 77}, {7468840, 158}, {7468841, 78}, {15749322, 3}, {15749323, 59}, {7468842, 76}, {7468843, 114}},
			},
			want: 			cpuState{
				D:   [8]uint32{3600819972, 4166441974, 1506750735, 3863264803, 411419395, 39314099, 199716623, 3013470601},
				A:   [7]uint32{2609427529, 3340348923, 3165698212, 1770814257, 916010983, 475469974, 187331625},
				PC:  7468844,
				SR:  776,
				USP: 12869310,
				SSP: 16762902,
				RAM: [][2]uint32{{7468836, 178}, {7468837, 116}, {7468838, 223}, {7468839, 77}, {7468840, 158}, {7468841, 78}, {15749322, 3}, {15749323, 59}, {7468842, 76}, {7468843, 114}},
				Cycles: 14,
			},
		},
		{
			name: "1698 CMP.w (A2)+, D3 b65a",
			init: 			cpuState{
				D:   [8]uint32{2492706565, 578940840, 3181607790, 2602717631, 3909952922, 3395380338, 1642459240, 4169941126},
				A:   [7]uint32{3271084087, 2723928101, 4192690876, 906254426, 825966027, 2572468846, 2137768211},
				PC:  5491446,
				SR:  9482,
				USP: 15085842,
				SSP: 13264604,
				RAM: [][2]uint32{{5491442, 182}, {5491443, 90}, {5491444, 60}, {5491445, 238}, {15164092, 236}, {15164093, 87}, {5491446, 59}, {5491447, 62}},
			},
			want: 			cpuState{
				D:   [8]uint32{2492706565, 578940840, 3181607790, 2602717631, 3909952922, 3395380338, 1642459240, 4169941126},
				A:   [7]uint32{3271084087, 2723928101, 4192690878, 906254426, 825966027, 2572468846, 2137768211},
				PC:  5491448,
				SR:  9473,
				USP: 15085842,
				SSP: 13264604,
				RAM: [][2]uint32{{5491442, 182}, {5491443, 90}, {5491444, 60}, {5491445, 238}, {15164092, 236}, {15164093, 87}, {5491446, 59}, {5491447, 62}},
				Cycles: 8,
			},
		},
		{
			name: "1966 CMP.w (A4)+, (A5)+ bb4c",
			init: 			cpuState{
				D:   [8]uint32{781303188, 2431106360, 2306757309, 678418739, 4254599328, 1692622026, 603655471, 4075877739},
				A:   [7]uint32{3757323707, 1388584923, 1754198831, 979249991, 2172877686, 3327307628, 1789316032},
				PC:  5371242,
				SR:  794,
				USP: 12089458,
				SSP: 5238344,
				RAM: [][2]uint32{{5371238, 187}, {5371239, 76}, {5371240, 103}, {5371241, 77}, {8616822, 191}, {8616823, 182}, {5418860, 191}, {5418861, 14}, {5371242, 150}, {5371243, 111}},
			},
			want: 			cpuState{
				D:   [8]uint32{781303188, 2431106360, 2306757309, 678418739, 4254599328, 1692622026, 603655471, 4075877739},
				A:   [7]uint32{3757323707, 1388584923, 1754198831, 979249991, 2172877688, 3327307630, 1789316032},
				PC:  5371244,
				SR:  793,
				USP: 12089458,
				SSP: 5238344,
				RAM: [][2]uint32{{5371238, 187}, {5371239, 76}, {5371240, 103}, {5371241, 77}, {8616822, 191}, {8616823, 182}, {5418860, 191}, {5418861, 14}, {5371242, 150}, {5371243, 111}},
				Cycles: 12,
			},
		},
		{
			name: "2227 CMP.w -(A7), D0 b067",
			init: 			cpuState{
				D:   [8]uint32{4266164609, 3112977182, 1735393303, 3173679107, 4219993445, 1683045178, 2084036794, 448010881},
				A:   [7]uint32{3563506870, 132227778, 2645261427, 3502868245, 3729866553, 3898002320, 2268732028},
				PC:  3611448,
				SR:  8711,
				USP: 770728,
				SSP: 13180412,
				RAM: [][2]uint32{{3611444, 176}, {3611445, 103}, {3611446, 21}, {3611447, 110}, {13180410, 188}, {13180411, 162}, {3611448, 204}, {3611449, 155}},
			},
			want: 			cpuState{
				D:   [8]uint32{4266164609, 3112977182, 1735393303, 3173679107, 4219993445, 1683045178, 2084036794, 448010881},
				A:   [7]uint32{3563506870, 132227778, 2645261427, 3502868245, 3729866553, 3898002320, 2268732028},
				PC:  3611450,
				SR:  8713,
				USP: 770728,
				SSP: 13180410,
				RAM: [][2]uint32{{3611444, 176}, {3611445, 103}, {3611446, 21}, {3611447, 110}, {13180410, 188}, {13180411, 162}, {3611448, 204}, {3611449, 155}},
				Cycles: 10,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestCMP_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 CMP.l (A1)+, (A6)+ bd89",
			init: cpuState{
				D:   [8]uint32{2602817071, 3813811932, 4035084860, 112487151, 1127809461, 19275107, 1666006179, 2424633415},
				A:   [7]uint32{1989085351, 2865131306, 3839278173, 3151297554, 2196693584, 4001985737, 2898117290},
				PC:  8257522,
				SR:  1049,
				USP: 7460316,
				SSP: 15544974,
				RAM: [][2]uint32{{8257518, 189}, {8257519, 137}, {8257520, 187}, {8257521, 97}, {13004586, 197}, {13004587, 50}, {13004588, 199}, {13004589, 185}, {12436138, 187}, {12436139, 64}, {12436140, 116}, {12436141, 119}, {8257522, 148}, {8257523, 95}},
			},
			want: cpuState{
				D:   [8]uint32{2602817071, 3813811932, 4035084860, 112487151, 1127809461, 19275107, 1666006179, 2424633415},
				A:   [7]uint32{1989085351, 2865131310, 3839278173, 3151297554, 2196693584, 4001985737, 2898117294},
				PC:  8257524,
				SR:  1049,
				USP: 7460316,
				SSP: 15544974,
				RAM: [][2]uint32{{8257518, 189}, {8257519, 137}, {8257520, 187}, {8257521, 97}, {13004586, 197}, {13004587, 50}, {13004588, 199}, {13004589, 185}, {12436138, 187}, {12436139, 64}, {12436140, 116}, {12436141, 119}, {8257522, 148}, {8257523, 95}},
				Cycles: 20,
			},
		},
		{
			name: "500 CMP.l (d8, A4, Xn), D6 bcb4",
			init: cpuState{
				D:   [8]uint32{1376672531, 1885140260, 623935522, 2233742434, 3028840733, 891270686, 2271780302, 3180168354},
				A:   [7]uint32{2594637097, 2333959586, 1113885730, 2321971044, 3588261746, 4179365780, 3796795233},
				PC:  3335270,
				SR:  1549,
				USP: 996568,
				SSP: 16454320,
				RAM: [][2]uint32{{3335266, 188}, {3335267, 180}, {3335268, 76}, {3335269, 198}, {3335270, 106}, {3335271, 78}, {12, 102}, {13, 186}, {14, 182}, {15, 40}, {12236328, 90}, {12236329, 202}, {12236330, 190}, {12236331, 153}},
			},
			want: cpuState{
				D:      [8]uint32{1376672531, 1885140260, 623935522, 2233742434, 3028840733, 891270686, 2271780302, 3180168354},
				A:      [7]uint32{2594637097, 2333959586, 1113885730, 2321971044, 3588261746, 4179365780, 3796795233},
				PC:     1723512364,
				SR:     9741,
				USP:    996568,
				SSP:    16454306,
				RAM:    [][2]uint32{{3335266, 188}, {3335267, 180}, {3335268, 76}, {3335269, 198}, {3335270, 106}, {3335271, 78}, {16454318, 228}, {16454319, 100}, {16454314, 6}, {16454315, 13}, {16454316, 0}, {16454317, 50}, {16454312, 188}, {16454313, 180}, {16454310, 248}, {16454311, 85}, {16454306, 188}, {16454307, 177}, {16454308, 138}, {16454309, 104}, {12, 102}, {13, 186}, {14, 182}, {15, 40}, {12236328, 90}, {12236329, 202}, {12236330, 190}, {12236331, 153}},
				Halted: true,
			},
		},
		{
			name: "1000 CMP.l -(A0), D7 bea0",
			init: cpuState{
				D:   [8]uint32{1270657884, 4245752031, 3640518077, 3550181606, 293055011, 1312543449, 2467842035, 1690838038},
				A:   [7]uint32{3663490712, 3097110916, 2355529633, 423090181, 1109150842, 2221997236, 2510293408},
				PC:  15620792,
				SR:  42782,
				USP: 8518812,
				SSP: 7322328,
				RAM: [][2]uint32{{15620788, 190}, {15620789, 160}, {15620790, 196}, {15620791, 9}, {6057620, 159}, {6057621, 85}, {6057622, 209}, {6057623, 132}, {15620792, 54}, {15620793, 47}},
			},
			want: cpuState{
				D:   [8]uint32{1270657884, 4245752031, 3640518077, 3550181606, 293055011, 1312543449, 2467842035, 1690838038},
				A:   [7]uint32{3663490708, 3097110916, 2355529633, 423090181, 1109150842, 2221997236, 2510293408},
				PC:  15620794,
				SR:  42779,
				USP: 8518812,
				SSP: 7322328,
				RAM: [][2]uint32{{15620788, 190}, {15620789, 160}, {15620790, 196}, {15620791, 9}, {6057620, 159}, {6057621, 85}, {6057622, 209}, {6057623, 132}, {15620792, 54}, {15620793, 47}},
				Cycles: 16,
			},
		},
		{
			name: "1500 CMP.l (d8, A6, Xn), D7 beb6",
			init: cpuState{
				D:   [8]uint32{1769718620, 2710303105, 1506316887, 1509684142, 3864885641, 4270562231, 325454053, 894372554},
				A:   [7]uint32{3666905663, 3568298632, 2842972664, 4178202536, 14971123, 1315932753, 216521209},
				PC:  11401684,
				SR:  34590,
				USP: 5074658,
				SSP: 5124358,
				RAM: [][2]uint32{{11401680, 190}, {11401681, 182}, {11401682, 156}, {11401683, 136}, {11401684, 196}, {11401685, 159}, {12, 22}, {13, 172}, {14, 78}, {15, 14}, {11292174, 37}, {11292175, 242}, {11292176, 208}, {11292177, 126}},
			},
			want: cpuState{
				D:      [8]uint32{1769718620, 2710303105, 1506316887, 1509684142, 3864885641, 4270562231, 325454053, 894372554},
				A:      [7]uint32{3666905663, 3568298632, 2842972664, 4178202536, 14971123, 1315932753, 216521209},
				PC:     380390930,
				SR:     10014,
				USP:    5074658,
				SSP:    5124344,
				RAM:    [][2]uint32{{11401680, 190}, {11401681, 182}, {11401682, 156}, {11401683, 136}, {11401684, 196}, {11401685, 159}, {5124356, 249}, {5124357, 210}, {5124352, 135}, {5124353, 30}, {5124354, 0}, {5124355, 173}, {5124350, 190}, {5124351, 182}, {5124348, 196}, {5124349, 9}, {5124344, 190}, {5124345, 177}, {5124346, 225}, {5124347, 151}, {12, 22}, {13, 172}, {14, 78}, {15, 14}, {11292174, 37}, {11292175, 242}, {11292176, 208}, {11292177, 126}},
				Halted: true,
			},
		},
		{
			name: "2000 CMP.l (d8, A0, Xn), D5 bab0",
			init: cpuState{
				D:   [8]uint32{2077505327, 463790756, 3129488334, 4263845755, 4193451820, 3717590645, 846018652, 2030228542},
				A:   [7]uint32{2228968255, 4294540364, 4262826014, 2381997817, 3023409651, 3204030991, 914704705},
				PC:  5056442,
				SR:  41472,
				USP: 6027476,
				SSP: 10809520,
				RAM: [][2]uint32{{5056438, 186}, {5056439, 176}, {5056440, 26}, {5056441, 166}, {5056442, 8}, {5056443, 219}, {12, 236}, {13, 128}, {14, 220}, {15, 16}, {8444944, 43}, {8444945, 48}, {8444946, 216}, {8444947, 128}},
			},
			want: cpuState{
				D:      [8]uint32{2077505327, 463790756, 3129488334, 4263845755, 4193451820, 3717590645, 846018652, 2030228542},
				A:      [7]uint32{2228968255, 4294540364, 4262826014, 2381997817, 3023409651, 3204030991, 914704705},
				PC:     3967867924,
				SR:     8704,
				USP:    6027476,
				SSP:    10809506,
				RAM:    [][2]uint32{{5056438, 186}, {5056439, 176}, {5056440, 26}, {5056441, 166}, {5056442, 8}, {5056443, 219}, {10809518, 39}, {10809519, 184}, {10809514, 162}, {10809515, 0}, {10809516, 0}, {10809517, 77}, {10809512, 186}, {10809513, 176}, {10809510, 61}, {10809511, 137}, {10809506, 186}, {10809507, 181}, {10809508, 160}, {10809509, 128}, {12, 236}, {13, 128}, {14, 220}, {15, 16}, {8444944, 43}, {8444945, 48}, {8444946, 216}, {8444947, 128}},
				Halted: true,
			},
		},
		{
			name: "002 CMP.l (A6)+, D1 b29e",
			init: 			cpuState{
				D:   [8]uint32{2840639815, 4227757821, 3570826347, 2116977896, 2563699950, 406450036, 2977729503, 2486384061},
				A:   [7]uint32{3631823290, 1838664556, 3686470150, 721292173, 2429535577, 3045700420, 2419636620},
				PC:  4119390,
				SR:  9495,
				USP: 14100126,
				SSP: 4699762,
				RAM: [][2]uint32{{4119386, 178}, {4119387, 158}, {4119388, 120}, {4119389, 12}, {3717516, 34}, {3717517, 121}, {3717518, 77}, {3717519, 52}, {4119390, 104}, {4119391, 156}},
			},
			want: 			cpuState{
				D:   [8]uint32{2840639815, 4227757821, 3570826347, 2116977896, 2563699950, 406450036, 2977729503, 2486384061},
				A:   [7]uint32{3631823290, 1838664556, 3686470150, 721292173, 2429535577, 3045700420, 2419636624},
				PC:  4119392,
				SR:  9496,
				USP: 14100126,
				SSP: 4699762,
				RAM: [][2]uint32{{4119386, 178}, {4119387, 158}, {4119388, 120}, {4119389, 12}, {3717516, 34}, {3717517, 121}, {3717518, 77}, {3717519, 52}, {4119390, 104}, {4119391, 156}},
				Cycles: 14,
			},
		},
		{
			name: "243 CMP.l A0, D4 b888",
			init: 			cpuState{
				D:   [8]uint32{4290831964, 880947326, 3466211592, 3124121250, 2833035915, 1348324212, 1605168060, 185655255},
				A:   [7]uint32{2140781993, 4251342789, 3836341633, 1256958939, 2402765266, 1735161207, 3625317550},
				PC:  7636484,
				SR:  792,
				USP: 1079018,
				SSP: 14204104,
				RAM: [][2]uint32{{7636480, 184}, {7636481, 136}, {7636482, 11}, {7636483, 75}, {7636484, 154}, {7636485, 100}},
			},
			want: 			cpuState{
				D:   [8]uint32{4290831964, 880947326, 3466211592, 3124121250, 2833035915, 1348324212, 1605168060, 185655255},
				A:   [7]uint32{2140781993, 4251342789, 3836341633, 1256958939, 2402765266, 1735161207, 3625317550},
				PC:  7636486,
				SR:  786,
				USP: 1079018,
				SSP: 14204104,
				RAM: [][2]uint32{{7636480, 184}, {7636481, 136}, {7636482, 11}, {7636483, 75}, {7636484, 154}, {7636485, 100}},
				Cycles: 6,
			},
		},
		{
			name: "568 CMP.l (A6), D1 b296",
			init: 			cpuState{
				D:   [8]uint32{3598370540, 1270409876, 1441758605, 461362044, 1615519005, 19333634, 3444586395, 3603642499},
				A:   [7]uint32{2035097684, 48731542, 1473253670, 1627463424, 3240810374, 59936088, 603768378},
				PC:  4404600,
				SR:  1305,
				USP: 12884038,
				SSP: 1405002,
				RAM: [][2]uint32{{4404596, 178}, {4404597, 150}, {4404598, 206}, {4404599, 74}, {16565818, 222}, {16565819, 195}, {16565820, 188}, {16565821, 225}, {4404600, 145}, {4404601, 203}},
			},
			want: 			cpuState{
				D:   [8]uint32{3598370540, 1270409876, 1441758605, 461362044, 1615519005, 19333634, 3444586395, 3603642499},
				A:   [7]uint32{2035097684, 48731542, 1473253670, 1627463424, 3240810374, 59936088, 603768378},
				PC:  4404602,
				SR:  1297,
				USP: 12884038,
				SSP: 1405002,
				RAM: [][2]uint32{{4404596, 178}, {4404597, 150}, {4404598, 206}, {4404599, 74}, {16565818, 222}, {16565819, 195}, {16565820, 188}, {16565821, 225}, {4404600, 145}, {4404601, 203}},
				Cycles: 14,
			},
		},
		{
			name: "881 CMP.l (d16, A0), D5 baa8",
			init: 			cpuState{
				D:   [8]uint32{2381033596, 3639292727, 1283223600, 3285319125, 2563835236, 19633528, 1206461437, 294075374},
				A:   [7]uint32{3825124250, 2591037426, 3624768771, 3563887198, 2486213758, 3033814156, 2306266310},
				PC:  10534506,
				SR:  267,
				USP: 3218866,
				SSP: 449954,
				RAM: [][2]uint32{{10534502, 186}, {10534503, 168}, {10534504, 110}, {10534505, 196}, {10534506, 236}, {10534507, 177}, {16724574, 238}, {16724575, 121}, {16724576, 217}, {16724577, 166}, {10534508, 123}, {10534509, 219}},
			},
			want: 			cpuState{
				D:   [8]uint32{2381033596, 3639292727, 1283223600, 3285319125, 2563835236, 19633528, 1206461437, 294075374},
				A:   [7]uint32{3825124250, 2591037426, 3624768771, 3563887198, 2486213758, 3033814156, 2306266310},
				PC:  10534510,
				SR:  257,
				USP: 3218866,
				SSP: 449954,
				RAM: [][2]uint32{{10534502, 186}, {10534503, 168}, {10534504, 110}, {10534505, 196}, {10534506, 236}, {10534507, 177}, {16724574, 238}, {16724575, 121}, {16724576, 217}, {16724577, 166}, {10534508, 123}, {10534509, 219}},
				Cycles: 18,
			},
		},
		{
			name: "1132 CMP.l D2, D0 b082",
			init: 			cpuState{
				D:   [8]uint32{1031526903, 2136889095, 1965923550, 738819969, 3154229749, 1291464951, 892575545, 4160186502},
				A:   [7]uint32{887238243, 935838197, 555553379, 2679607890, 3239996038, 1665767315, 2912840731},
				PC:  15771222,
				SR:  10002,
				USP: 2993240,
				SSP: 3356474,
				RAM: [][2]uint32{{15771218, 176}, {15771219, 130}, {15771220, 40}, {15771221, 64}, {15771222, 239}, {15771223, 186}},
			},
			want: 			cpuState{
				D:   [8]uint32{1031526903, 2136889095, 1965923550, 738819969, 3154229749, 1291464951, 892575545, 4160186502},
				A:   [7]uint32{887238243, 935838197, 555553379, 2679607890, 3239996038, 1665767315, 2912840731},
				PC:  15771224,
				SR:  10009,
				USP: 2993240,
				SSP: 3356474,
				RAM: [][2]uint32{{15771218, 176}, {15771219, 130}, {15771220, 40}, {15771221, 64}, {15771222, 239}, {15771223, 186}},
				Cycles: 6,
			},
		},
		{
			name: "1425 CMP.l -(A3), D1 b2a3",
			init: 			cpuState{
				D:   [8]uint32{2523555126, 4091523535, 2646008342, 1203955353, 1919637894, 1841612476, 3672666706, 40840488},
				A:   [7]uint32{521914814, 1704590754, 1394380243, 3879588224, 654093619, 2065816718, 1774238137},
				PC:  2358386,
				SR:  9503,
				USP: 8899196,
				SSP: 6512450,
				RAM: [][2]uint32{{2358382, 178}, {2358383, 163}, {2358384, 45}, {2358385, 169}, {4051324, 195}, {4051325, 180}, {4051326, 1}, {4051327, 7}, {2358386, 140}, {2358387, 160}},
			},
			want: 			cpuState{
				D:   [8]uint32{2523555126, 4091523535, 2646008342, 1203955353, 1919637894, 1841612476, 3672666706, 40840488},
				A:   [7]uint32{521914814, 1704590754, 1394380243, 3879588220, 654093619, 2065816718, 1774238137},
				PC:  2358388,
				SR:  9488,
				USP: 8899196,
				SSP: 6512450,
				RAM: [][2]uint32{{2358382, 178}, {2358383, 163}, {2358384, 45}, {2358385, 169}, {4051324, 195}, {4051325, 180}, {4051326, 1}, {4051327, 7}, {2358386, 140}, {2358387, 160}},
				Cycles: 16,
			},
		},
		{
			name: "1720 CMP.l (d16, A3), D4 b8ab",
			init: 			cpuState{
				D:   [8]uint32{1009911487, 928006329, 4181815573, 574777256, 1143214723, 1379810813, 2711659777, 4065975540},
				A:   [7]uint32{20938222, 825791463, 1589285027, 1865132230, 3477350331, 2047483739, 3627770328},
				PC:  10204738,
				SR:  8455,
				USP: 13644074,
				SSP: 15534550,
				RAM: [][2]uint32{{10204734, 184}, {10204735, 171}, {10204736, 97}, {10204737, 204}, {10204738, 223}, {10204739, 114}, {2886290, 193}, {2886291, 165}, {2886292, 232}, {2886293, 80}, {10204740, 202}, {10204741, 173}},
			},
			want: 			cpuState{
				D:   [8]uint32{1009911487, 928006329, 4181815573, 574777256, 1143214723, 1379810813, 2711659777, 4065975540},
				A:   [7]uint32{20938222, 825791463, 1589285027, 1865132230, 3477350331, 2047483739, 3627770328},
				PC:  10204742,
				SR:  8459,
				USP: 13644074,
				SSP: 15534550,
				RAM: [][2]uint32{{10204734, 184}, {10204735, 171}, {10204736, 97}, {10204737, 204}, {10204738, 223}, {10204739, 114}, {2886290, 193}, {2886291, 165}, {2886292, 232}, {2886293, 80}, {10204740, 202}, {10204741, 173}},
				Cycles: 18,
			},
		},
		{
			name: "1950 CMP.l D3, D6 bc83",
			init: 			cpuState{
				D:   [8]uint32{1506983598, 2530478670, 2123964506, 2128306856, 1174446088, 4095432296, 1272569361, 2990928929},
				A:   [7]uint32{1303734148, 4292437595, 85240391, 1762703609, 3484968243, 3830449028, 1287505865},
				PC:  8347424,
				SR:  1042,
				USP: 9890460,
				SSP: 1254870,
				RAM: [][2]uint32{{8347420, 188}, {8347421, 131}, {8347422, 158}, {8347423, 239}, {8347424, 165}, {8347425, 149}},
			},
			want: 			cpuState{
				D:   [8]uint32{1506983598, 2530478670, 2123964506, 2128306856, 1174446088, 4095432296, 1272569361, 2990928929},
				A:   [7]uint32{1303734148, 4292437595, 85240391, 1762703609, 3484968243, 3830449028, 1287505865},
				PC:  8347426,
				SR:  1049,
				USP: 9890460,
				SSP: 1254870,
				RAM: [][2]uint32{{8347420, 188}, {8347421, 131}, {8347422, 158}, {8347423, 239}, {8347424, 165}, {8347425, 149}},
				Cycles: 6,
			},
		},
		{
			name: "2218 CMP.l D1, D7 be81",
			init: 			cpuState{
				D:   [8]uint32{4119864467, 1585856348, 1065796340, 2588727962, 3917859661, 2798536862, 2304014924, 1755954760},
				A:   [7]uint32{3944375441, 4285880465, 3135653923, 1614945456, 254270645, 440147346, 3230528579},
				PC:  6487976,
				SR:  8199,
				USP: 3343020,
				SSP: 3954880,
				RAM: [][2]uint32{{6487972, 190}, {6487973, 129}, {6487974, 115}, {6487975, 88}, {6487976, 146}, {6487977, 42}},
			},
			want: 			cpuState{
				D:   [8]uint32{4119864467, 1585856348, 1065796340, 2588727962, 3917859661, 2798536862, 2304014924, 1755954760},
				A:   [7]uint32{3944375441, 4285880465, 3135653923, 1614945456, 254270645, 440147346, 3230528579},
				PC:  6487978,
				SR:  8192,
				USP: 3343020,
				SSP: 3954880,
				RAM: [][2]uint32{{6487972, 190}, {6487973, 129}, {6487974, 115}, {6487975, 88}, {6487976, 146}, {6487977, 42}},
				Cycles: 6,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestCMPA_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 CMPA.w (A3)+, A3 b6db",
			init: cpuState{
				D:   [8]uint32{492070105, 1571437183, 313863493, 1080259018, 2237413311, 1921128094, 2709787501, 2022490657},
				A:   [7]uint32{578471791, 1488481635, 724012354, 93350870, 1485134294, 1369588139, 1380749972},
				PC:  14948046,
				SR:  8450,
				USP: 13927062,
				SSP: 5762640,
				RAM: [][2]uint32{{14948042, 182}, {14948043, 219}, {14948044, 16}, {14948045, 79}, {9464790, 205}, {9464791, 231}, {14948046, 170}, {14948047, 166}},
			},
			want: cpuState{
				D:   [8]uint32{492070105, 1571437183, 313863493, 1080259018, 2237413311, 1921128094, 2709787501, 2022490657},
				A:   [7]uint32{578471791, 1488481635, 724012354, 93350872, 1485134294, 1369588139, 1380749972},
				PC:  14948048,
				SR:  8449,
				USP: 13927062,
				SSP: 5762640,
				RAM: [][2]uint32{{14948042, 182}, {14948043, 219}, {14948044, 16}, {14948045, 79}, {9464790, 205}, {9464791, 231}, {14948046, 170}, {14948047, 166}},
				Cycles: 10,
			},
		},
		{
			name: "500 CMPA.w D7, A4 b8c7",
			init: cpuState{
				D:   [8]uint32{1684219232, 340340602, 2020911260, 3878343800, 1607588106, 2899264654, 891078013, 2475017235},
				A:   [7]uint32{759508923, 4292527294, 1609179738, 2856449460, 969409643, 3807140723, 3376424158},
				PC:  13890546,
				SR:  260,
				USP: 16031100,
				SSP: 9582176,
				RAM: [][2]uint32{{13890542, 184}, {13890543, 199}, {13890544, 227}, {13890545, 86}, {13890546, 32}, {13890547, 220}},
			},
			want: cpuState{
				D:   [8]uint32{1684219232, 340340602, 2020911260, 3878343800, 1607588106, 2899264654, 891078013, 2475017235},
				A:   [7]uint32{759508923, 4292527294, 1609179738, 2856449460, 969409643, 3807140723, 3376424158},
				PC:  13890548,
				SR:  257,
				USP: 16031100,
				SSP: 9582176,
				RAM: [][2]uint32{{13890542, 184}, {13890543, 199}, {13890544, 227}, {13890545, 86}, {13890546, 32}, {13890547, 220}},
				Cycles: 6,
			},
		},
		{
			name: "1000 CMPA.w (A0)+, A3 b6d8",
			init: cpuState{
				D:   [8]uint32{417406711, 3642446289, 833343870, 2456269747, 1638293136, 2476317691, 3057716634, 3075085268},
				A:   [7]uint32{2810769204, 2611851034, 3505614135, 2003770830, 2335048986, 1636705159, 583241371},
				PC:  8152848,
				SR:  512,
				USP: 9546952,
				SSP: 14164524,
				RAM: [][2]uint32{{8152844, 182}, {8152845, 216}, {8152846, 230}, {8152847, 36}, {8974132, 56}, {8974133, 205}, {8152848, 190}, {8152849, 116}},
			},
			want: cpuState{
				D:   [8]uint32{417406711, 3642446289, 833343870, 2456269747, 1638293136, 2476317691, 3057716634, 3075085268},
				A:   [7]uint32{2810769206, 2611851034, 3505614135, 2003770830, 2335048986, 1636705159, 583241371},
				PC:  8152850,
				SR:  512,
				USP: 9546952,
				SSP: 14164524,
				RAM: [][2]uint32{{8152844, 182}, {8152845, 216}, {8152846, 230}, {8152847, 36}, {8974132, 56}, {8974133, 205}, {8152848, 190}, {8152849, 116}},
				Cycles: 10,
			},
		},
		{
			name: "1500 CMPA.w -(A7), A1 b2e7",
			init: cpuState{
				D:   [8]uint32{2045924875, 1671279105, 3095246169, 2853977159, 1249068894, 762824857, 3569871165, 3449744706},
				A:   [7]uint32{423035514, 2505079516, 2715657797, 2776337756, 3487025369, 3384318591, 3393958738},
				PC:  12734732,
				SR:  41486,
				USP: 16719434,
				SSP: 13916380,
				RAM: [][2]uint32{{12734728, 178}, {12734729, 231}, {12734730, 227}, {12734731, 140}, {13916378, 129}, {13916379, 132}, {12734732, 169}, {12734733, 90}},
			},
			want: cpuState{
				D:   [8]uint32{2045924875, 1671279105, 3095246169, 2853977159, 1249068894, 762824857, 3569871165, 3449744706},
				A:   [7]uint32{423035514, 2505079516, 2715657797, 2776337756, 3487025369, 3384318591, 3393958738},
				PC:  12734734,
				SR:  41481,
				USP: 16719434,
				SSP: 13916378,
				RAM: [][2]uint32{{12734728, 178}, {12734729, 231}, {12734730, 227}, {12734731, 140}, {13916378, 129}, {13916379, 132}, {12734732, 169}, {12734733, 90}},
				Cycles: 12,
			},
		},
		{
			name: "2000 CMPA.w (A3)+, A3 b6db",
			init: cpuState{
				D:   [8]uint32{2610677873, 2182921324, 1994046837, 1991770870, 1254942964, 4117929659, 3292579872, 1420689387},
				A:   [7]uint32{2430273115, 3471146516, 2202927400, 1326717104, 4241561056, 3700412691, 1960209238},
				PC:  5946206,
				SR:  1307,
				USP: 5204142,
				SSP: 8869418,
				RAM: [][2]uint32{{5946202, 182}, {5946203, 219}, {5946204, 153}, {5946205, 43}, {1317040, 126}, {1317041, 84}, {5946206, 44}, {5946207, 215}},
			},
			want: cpuState{
				D:   [8]uint32{2610677873, 2182921324, 1994046837, 1991770870, 1254942964, 4117929659, 3292579872, 1420689387},
				A:   [7]uint32{2430273115, 3471146516, 2202927400, 1326717106, 4241561056, 3700412691, 1960209238},
				PC:  5946208,
				SR:  1296,
				USP: 5204142,
				SSP: 8869418,
				RAM: [][2]uint32{{5946202, 182}, {5946203, 219}, {5946204, 153}, {5946205, 43}, {1317040, 126}, {1317041, 84}, {5946206, 44}, {5946207, 215}},
				Cycles: 10,
			},
		},
		{
			name: "002 CMPA.w (A3)+, A5 badb",
			init: 			cpuState{
				D:   [8]uint32{2199205480, 4136948498, 1764608447, 1502265048, 1679985107, 536295087, 1697129123, 1464897363},
				A:   [7]uint32{507571343, 3964910236, 2371505811, 4261085422, 1692769254, 4141863104, 2334681781},
				PC:  2297690,
				SR:  9485,
				USP: 11031980,
				SSP: 8594708,
				RAM: [][2]uint32{{2297686, 186}, {2297687, 219}, {2297688, 187}, {2297689, 28}, {16449774, 233}, {16449775, 82}, {2297690, 231}, {2297691, 39}},
			},
			want: 			cpuState{
				D:   [8]uint32{2199205480, 4136948498, 1764608447, 1502265048, 1679985107, 536295087, 1697129123, 1464897363},
				A:   [7]uint32{507571343, 3964910236, 2371505811, 4261085424, 1692769254, 4141863104, 2334681781},
				PC:  2297692,
				SR:  9481,
				USP: 11031980,
				SSP: 8594708,
				RAM: [][2]uint32{{2297686, 186}, {2297687, 219}, {2297688, 187}, {2297689, 28}, {16449774, 233}, {16449775, 82}, {2297690, 231}, {2297691, 39}},
				Cycles: 10,
			},
		},
		{
			name: "321 CMPA.w (A3)+, A5 badb",
			init: 			cpuState{
				D:   [8]uint32{959754614, 1344097888, 449918787, 185902784, 2336928840, 2574064744, 1086124115, 1428727049},
				A:   [7]uint32{1659114195, 3183041330, 2401424063, 2276320460, 1217877353, 674406258, 1109826725},
				PC:  10468394,
				SR:  265,
				USP: 3887940,
				SSP: 551358,
				RAM: [][2]uint32{{10468390, 186}, {10468391, 219}, {10468392, 97}, {10468393, 140}, {11396300, 205}, {11396301, 34}, {10468394, 122}, {10468395, 211}},
			},
			want: 			cpuState{
				D:   [8]uint32{959754614, 1344097888, 449918787, 185902784, 2336928840, 2574064744, 1086124115, 1428727049},
				A:   [7]uint32{1659114195, 3183041330, 2401424063, 2276320462, 1217877353, 674406258, 1109826725},
				PC:  10468396,
				SR:  257,
				USP: 3887940,
				SSP: 551358,
				RAM: [][2]uint32{{10468390, 186}, {10468391, 219}, {10468392, 97}, {10468393, 140}, {11396300, 205}, {11396301, 34}, {10468394, 122}, {10468395, 211}},
				Cycles: 10,
			},
		},
		{
			name: "593 CMPA.w (A2), A0 b0d2",
			init: 			cpuState{
				D:   [8]uint32{470561054, 3310720790, 722963261, 2750539692, 1128518535, 1077319873, 3028934546, 817955033},
				A:   [7]uint32{3979895436, 1020310871, 3561605466, 828875058, 2253993824, 2444348710, 3620013217},
				PC:  8221942,
				SR:  286,
				USP: 12823722,
				SSP: 16226616,
				RAM: [][2]uint32{{8221938, 176}, {8221939, 210}, {8221940, 91}, {8221941, 235}, {4835674, 142}, {4835675, 102}, {8221942, 153}, {8221943, 16}},
			},
			want: 			cpuState{
				D:   [8]uint32{470561054, 3310720790, 722963261, 2750539692, 1128518535, 1077319873, 3028934546, 817955033},
				A:   [7]uint32{3979895436, 1020310871, 3561605466, 828875058, 2253993824, 2444348710, 3620013217},
				PC:  8221944,
				SR:  281,
				USP: 12823722,
				SSP: 16226616,
				RAM: [][2]uint32{{8221938, 176}, {8221939, 210}, {8221940, 91}, {8221941, 235}, {4835674, 142}, {4835675, 102}, {8221942, 153}, {8221943, 16}},
				Cycles: 10,
			},
		},
		{
			name: "856 CMPA.w (A2)+, A2 b4da",
			init: 			cpuState{
				D:   [8]uint32{304446536, 1563673130, 1660285403, 3616164273, 485229338, 2586153653, 4245587225, 353442493},
				A:   [7]uint32{3076295431, 3309212980, 3082303232, 1105600079, 3687708387, 3959591087, 3511728383},
				PC:  15323250,
				SR:  8986,
				USP: 11895734,
				SSP: 15334644,
				RAM: [][2]uint32{{15323246, 180}, {15323247, 218}, {15323248, 184}, {15323249, 42}, {12072704, 194}, {12072705, 96}, {15323250, 200}, {15323251, 235}},
			},
			want: 			cpuState{
				D:   [8]uint32{304446536, 1563673130, 1660285403, 3616164273, 485229338, 2586153653, 4245587225, 353442493},
				A:   [7]uint32{3076295431, 3309212980, 3082303234, 1105600079, 3687708387, 3959591087, 3511728383},
				PC:  15323252,
				SR:  8985,
				USP: 11895734,
				SSP: 15334644,
				RAM: [][2]uint32{{15323246, 180}, {15323247, 218}, {15323248, 184}, {15323249, 42}, {12072704, 194}, {12072705, 96}, {15323250, 200}, {15323251, 235}},
				Cycles: 10,
			},
		},
		{
			name: "1170 CMPA.w D3, A6 bcc3",
			init: 			cpuState{
				D:   [8]uint32{2781403321, 983017502, 1930203254, 2873871745, 342392624, 234307246, 620007621, 3749303492},
				A:   [7]uint32{2136093214, 2484229524, 1083111230, 94949065, 2225526960, 3416180569, 1052003388},
				PC:  5763880,
				SR:  1796,
				USP: 4612796,
				SSP: 16627346,
				RAM: [][2]uint32{{5763876, 188}, {5763877, 195}, {5763878, 203}, {5763879, 21}, {5763880, 30}, {5763881, 40}},
			},
			want: 			cpuState{
				D:   [8]uint32{2781403321, 983017502, 1930203254, 2873871745, 342392624, 234307246, 620007621, 3749303492},
				A:   [7]uint32{2136093214, 2484229524, 1083111230, 94949065, 2225526960, 3416180569, 1052003388},
				PC:  5763882,
				SR:  1793,
				USP: 4612796,
				SSP: 16627346,
				RAM: [][2]uint32{{5763876, 188}, {5763877, 195}, {5763878, 203}, {5763879, 21}, {5763880, 30}, {5763881, 40}},
				Cycles: 6,
			},
		},
		{
			name: "1450 CMPA.w (d16, A7), A7 beef",
			init: 			cpuState{
				D:   [8]uint32{886562775, 2739352617, 333037523, 4033222647, 1189025244, 3864062979, 2427074594, 3676605550},
				A:   [7]uint32{2482910408, 98969140, 3212087271, 3621378300, 2351982678, 3511717724, 2961245994},
				PC:  472350,
				SR:  10013,
				USP: 11678226,
				SSP: 2588692,
				RAM: [][2]uint32{{472346, 190}, {472347, 239}, {472348, 148}, {472349, 58}, {472350, 15}, {472351, 167}, {2561102, 221}, {2561103, 64}, {472352, 165}, {472353, 137}},
			},
			want: 			cpuState{
				D:   [8]uint32{886562775, 2739352617, 333037523, 4033222647, 1189025244, 3864062979, 2427074594, 3676605550},
				A:   [7]uint32{2482910408, 98969140, 3212087271, 3621378300, 2351982678, 3511717724, 2961245994},
				PC:  472354,
				SR:  10001,
				USP: 11678226,
				SSP: 2588692,
				RAM: [][2]uint32{{472346, 190}, {472347, 239}, {472348, 148}, {472349, 58}, {472350, 15}, {472351, 167}, {2561102, 221}, {2561103, 64}, {472352, 165}, {472353, 137}},
				Cycles: 14,
			},
		},
		{
			name: "1700 CMPA.w (A5), A6 bcd5",
			init: 			cpuState{
				D:   [8]uint32{702293120, 3179564204, 2652127834, 583397122, 3992963720, 2148606402, 2414606252, 2581850846},
				A:   [7]uint32{680711504, 1081599740, 4172495707, 2807153566, 844473459, 2107287276, 536688771},
				PC:  11970646,
				SR:  9484,
				USP: 2923382,
				SSP: 12589974,
				RAM: [][2]uint32{{11970642, 188}, {11970643, 213}, {11970644, 190}, {11970645, 81}, {10135276, 142}, {10135277, 77}, {11970646, 124}, {11970647, 243}},
			},
			want: 			cpuState{
				D:   [8]uint32{702293120, 3179564204, 2652127834, 583397122, 3992963720, 2148606402, 2414606252, 2581850846},
				A:   [7]uint32{680711504, 1081599740, 4172495707, 2807153566, 844473459, 2107287276, 536688771},
				PC:  11970648,
				SR:  9473,
				USP: 2923382,
				SSP: 12589974,
				RAM: [][2]uint32{{11970642, 188}, {11970643, 213}, {11970644, 190}, {11970645, 81}, {10135276, 142}, {10135277, 77}, {11970646, 124}, {11970647, 243}},
				Cycles: 10,
			},
		},
		{
			name: "1997 CMPA.w (d8, A4, Xn), A4 b8f4",
			init: 			cpuState{
				D:   [8]uint32{1423595950, 2571281041, 742904499, 3430705157, 2793168230, 2155930495, 1667059991, 2570667512},
				A:   [7]uint32{2082224074, 2400562957, 2058813082, 3396492384, 1538831904, 3572459092, 2859377686},
				PC:  936802,
				SR:  281,
				USP: 12995832,
				SSP: 882862,
				RAM: [][2]uint32{{936798, 184}, {936799, 244}, {936800, 111}, {936801, 99}, {936802, 97}, {936803, 223}, {1443738, 228}, {1443739, 84}, {936804, 180}, {936805, 121}},
			},
			want: 			cpuState{
				D:   [8]uint32{1423595950, 2571281041, 742904499, 3430705157, 2793168230, 2155930495, 1667059991, 2570667512},
				A:   [7]uint32{2082224074, 2400562957, 2058813082, 3396492384, 1538831904, 3572459092, 2859377686},
				PC:  936806,
				SR:  273,
				USP: 12995832,
				SSP: 882862,
				RAM: [][2]uint32{{936798, 184}, {936799, 244}, {936800, 111}, {936801, 99}, {936802, 97}, {936803, 223}, {1443738, 228}, {1443739, 84}, {936804, 180}, {936805, 121}},
				Cycles: 16,
			},
		},
		{
			name: "2247 CMPA.w -(A7), A1 b2e7",
			init: 			cpuState{
				D:   [8]uint32{1490310246, 2469147340, 2113629030, 986508922, 3870242353, 3320516962, 1367307936, 1590337072},
				A:   [7]uint32{2240977704, 3583692622, 1526013546, 3107917616, 363243742, 947808192, 695937193},
				PC:  15749522,
				SR:  29,
				USP: 11493748,
				SSP: 6113534,
				RAM: [][2]uint32{{15749518, 178}, {15749519, 231}, {15749520, 148}, {15749521, 42}, {11493746, 44}, {11493747, 207}, {15749522, 135}, {15749523, 201}},
			},
			want: 			cpuState{
				D:   [8]uint32{1490310246, 2469147340, 2113629030, 986508922, 3870242353, 3320516962, 1367307936, 1590337072},
				A:   [7]uint32{2240977704, 3583692622, 1526013546, 3107917616, 363243742, 947808192, 695937193},
				PC:  15749524,
				SR:  24,
				USP: 11493746,
				SSP: 6113534,
				RAM: [][2]uint32{{15749518, 178}, {15749519, 231}, {15749520, 148}, {15749521, 42}, {11493746, 44}, {11493747, 207}, {15749522, 135}, {15749523, 201}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestCMPA_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 CMPA.l (d16, A4), A3 b7ec",
			init: cpuState{
				D:   [8]uint32{2890798821, 1862138709, 2854314823, 398855901, 3873552237, 4105501077, 2205126645, 3703781335},
				A:   [7]uint32{854050806, 399742751, 2206797844, 3644069934, 2479716593, 1347522574, 2529794186},
				PC:  4796260,
				SR:  8711,
				USP: 3160850,
				SSP: 11019136,
				RAM: [][2]uint32{{4796256, 183}, {4796257, 236}, {4796258, 21}, {4796259, 34}, {4796260, 191}, {4796261, 37}, {12, 116}, {13, 242}, {14, 2}, {15, 254}, {15860478, 254}, {15860479, 45}, {15860480, 4}, {15860481, 213}},
			},
			want: cpuState{
				D:      [8]uint32{2890798821, 1862138709, 2854314823, 398855901, 3873552237, 4105501077, 2205126645, 3703781335},
				A:      [7]uint32{854050806, 399742751, 2206797844, 3644069934, 2479716593, 1347522574, 2529794186},
				PC:     1962017538,
				SR:     8711,
				USP:    3160850,
				SSP:    11019122,
				RAM:    [][2]uint32{{4796256, 183}, {4796257, 236}, {4796258, 21}, {4796259, 34}, {4796260, 191}, {4796261, 37}, {11019134, 47}, {11019135, 98}, {11019130, 34}, {11019131, 7}, {11019132, 0}, {11019133, 73}, {11019128, 183}, {11019129, 236}, {11019126, 142}, {11019127, 19}, {11019122, 183}, {11019123, 245}, {11019124, 147}, {11019125, 205}, {12, 116}, {13, 242}, {14, 2}, {15, 254}, {15860478, 254}, {15860479, 45}, {15860480, 4}, {15860481, 213}},
				Halted: true,
			},
		},
		{
			name: "500 CMPA.l (A3), A2 b5d3",
			init: cpuState{
				D:   [8]uint32{2252290140, 3090839686, 3370884756, 2616564005, 4104746129, 3510351794, 3807957154, 3476238244},
				A:   [7]uint32{3003121672, 108294146, 3334919252, 663744853, 390905783, 871256995, 2525146124},
				PC:  7496644,
				SR:  8971,
				USP: 9358608,
				SSP: 9889444,
				RAM: [][2]uint32{{7496640, 181}, {7496641, 211}, {7496642, 190}, {7496643, 234}, {12, 47}, {13, 158}, {14, 165}, {15, 18}, {10396946, 193}, {10396947, 64}, {10396948, 197}, {10396949, 5}},
			},
			want: cpuState{
				D:      [8]uint32{2252290140, 3090839686, 3370884756, 2616564005, 4104746129, 3510351794, 3807957154, 3476238244},
				A:      [7]uint32{3003121672, 108294146, 3334919252, 663744853, 390905783, 871256995, 2525146124},
				PC:     798926102,
				SR:     8971,
				USP:    9358608,
				SSP:    9889430,
				RAM:    [][2]uint32{{7496640, 181}, {7496641, 211}, {7496642, 190}, {7496643, 234}, {9889442, 99}, {9889443, 194}, {9889438, 35}, {9889439, 11}, {9889440, 0}, {9889441, 114}, {9889436, 181}, {9889437, 211}, {9889434, 241}, {9889435, 85}, {9889430, 181}, {9889431, 213}, {9889432, 39}, {9889433, 143}, {12, 47}, {13, 158}, {14, 165}, {15, 18}, {10396946, 193}, {10396947, 64}, {10396948, 197}, {10396949, 5}},
				Halted: true,
			},
		},
		{
			name: "1000 CMPA.l D4, A7 bfc4",
			init: cpuState{
				D:   [8]uint32{4245341750, 2180014711, 1511230218, 2546602185, 1155340818, 3749460867, 2586965732, 2223212119},
				A:   [7]uint32{2743596617, 1657190777, 1818367150, 691250381, 502230760, 1314469045, 2399492302},
				PC:  2732462,
				SR:  33823,
				USP: 9920682,
				SSP: 954602,
				RAM: [][2]uint32{{2732458, 191}, {2732459, 196}, {2732460, 26}, {2732461, 133}, {2732462, 141}, {2732463, 143}},
			},
			want: cpuState{
				D:   [8]uint32{4245341750, 2180014711, 1511230218, 2546602185, 1155340818, 3749460867, 2586965732, 2223212119},
				A:   [7]uint32{2743596617, 1657190777, 1818367150, 691250381, 502230760, 1314469045, 2399492302},
				PC:  2732464,
				SR:  33817,
				USP: 9920682,
				SSP: 954602,
				RAM: [][2]uint32{{2732458, 191}, {2732459, 196}, {2732460, 26}, {2732461, 133}, {2732462, 141}, {2732463, 143}},
				Cycles: 6,
			},
		},
		{
			name: "1500 CMPA.l (d8, A6, Xn), A7 bff6",
			init: cpuState{
				D:   [8]uint32{3987165711, 102518476, 275509086, 3062358003, 2513144564, 2637653817, 4071257875, 1143483842},
				A:   [7]uint32{3909428019, 3152158048, 2799137073, 1989633970, 1503233045, 994553797, 2954679395},
				PC:  12331406,
				SR:  793,
				USP: 1124404,
				SSP: 8804074,
				RAM: [][2]uint32{{12331402, 191}, {12331403, 246}, {12331404, 54}, {12331405, 174}, {12331406, 187}, {12331407, 3}, {1881092, 225}, {1881093, 23}, {1881094, 126}, {1881095, 183}, {12331408, 0}, {12331409, 59}},
			},
			want: cpuState{
				D:   [8]uint32{3987165711, 102518476, 275509086, 3062358003, 2513144564, 2637653817, 4071257875, 1143483842},
				A:   [7]uint32{3909428019, 3152158048, 2799137073, 1989633970, 1503233045, 994553797, 2954679395},
				PC:  12331410,
				SR:  785,
				USP: 1124404,
				SSP: 8804074,
				RAM: [][2]uint32{{12331402, 191}, {12331403, 246}, {12331404, 54}, {12331405, 174}, {12331406, 187}, {12331407, 3}, {1881092, 225}, {1881093, 23}, {1881094, 126}, {1881095, 183}, {12331408, 0}, {12331409, 59}},
				Cycles: 20,
			},
		},
		{
			name: "2000 CMPA.l (d8, A3, Xn), A7 bff3",
			init: cpuState{
				D:   [8]uint32{824506334, 1008659423, 4073145469, 2386503430, 3167144410, 2077742698, 4293335420, 43512426},
				A:   [7]uint32{3272086479, 4213570550, 1461721843, 205849882, 1614537925, 2773894694, 3722807823},
				PC:  8788234,
				SR:  782,
				USP: 12995958,
				SSP: 12226408,
				RAM: [][2]uint32{{8788230, 191}, {8788231, 243}, {8788232, 49}, {8788233, 6}, {8788234, 82}, {8788235, 235}, {4533286, 244}, {4533287, 6}, {4533288, 89}, {4533289, 126}, {8788236, 18}, {8788237, 225}},
			},
			want: cpuState{
				D:   [8]uint32{824506334, 1008659423, 4073145469, 2386503430, 3167144410, 2077742698, 4293335420, 43512426},
				A:   [7]uint32{3272086479, 4213570550, 1461721843, 205849882, 1614537925, 2773894694, 3722807823},
				PC:  8788238,
				SR:  769,
				USP: 12995958,
				SSP: 12226408,
				RAM: [][2]uint32{{8788230, 191}, {8788231, 243}, {8788232, 49}, {8788233, 6}, {8788234, 82}, {8788235, 235}, {4533286, 244}, {4533287, 6}, {4533288, 89}, {4533289, 126}, {8788236, 18}, {8788237, 225}},
				Cycles: 20,
			},
		},
		{
			name: "001 CMPA.l (xxx).w, A0 b1f8",
			init: 			cpuState{
				D:   [8]uint32{1857791523, 2025923305, 1597217911, 1586768434, 405249764, 679794042, 1043098009, 3359219585},
				A:   [7]uint32{2484096244, 1728183462, 690899843, 690950076, 760366331, 3264554880, 2501603119},
				PC:  602884,
				SR:  10002,
				USP: 13632862,
				SSP: 10689402,
				RAM: [][2]uint32{{602880, 177}, {602881, 248}, {602882, 157}, {602883, 86}, {602884, 37}, {602885, 207}, {16751958, 54}, {16751959, 67}, {16751960, 229}, {16751961, 77}, {602886, 72}, {602887, 152}},
			},
			want: 			cpuState{
				D:   [8]uint32{1857791523, 2025923305, 1597217911, 1586768434, 405249764, 679794042, 1043098009, 3359219585},
				A:   [7]uint32{2484096244, 1728183462, 690899843, 690950076, 760366331, 3264554880, 2501603119},
				PC:  602888,
				SR:  10002,
				USP: 13632862,
				SSP: 10689402,
				RAM: [][2]uint32{{602880, 177}, {602881, 248}, {602882, 157}, {602883, 86}, {602884, 37}, {602885, 207}, {16751958, 54}, {16751959, 67}, {16751960, 229}, {16751961, 77}, {602886, 72}, {602887, 152}},
				Cycles: 18,
			},
		},
		{
			name: "284 CMPA.l (d16, A0), A5 bbe8",
			init: 			cpuState{
				D:   [8]uint32{2402387233, 1399728182, 612562794, 2014598988, 2491268708, 473647345, 2518113336, 1178902942},
				A:   [7]uint32{732433218, 3759607950, 2456129521, 1878942102, 2319323804, 1425709665, 183657777},
				PC:  633418,
				SR:  9729,
				USP: 4502742,
				SSP: 12789234,
				RAM: [][2]uint32{{633414, 187}, {633415, 232}, {633416, 11}, {633417, 72}, {633418, 10}, {633419, 125}, {11015818, 182}, {11015819, 222}, {11015820, 21}, {11015821, 149}, {633420, 229}, {633421, 178}},
			},
			want: 			cpuState{
				D:   [8]uint32{2402387233, 1399728182, 612562794, 2014598988, 2491268708, 473647345, 2518113336, 1178902942},
				A:   [7]uint32{732433218, 3759607950, 2456129521, 1878942102, 2319323804, 1425709665, 183657777},
				PC:  633422,
				SR:  9739,
				USP: 4502742,
				SSP: 12789234,
				RAM: [][2]uint32{{633414, 187}, {633415, 232}, {633416, 11}, {633417, 72}, {633418, 10}, {633419, 125}, {11015818, 182}, {11015819, 222}, {11015820, 21}, {11015821, 149}, {633420, 229}, {633421, 178}},
				Cycles: 18,
			},
		},
		{
			name: "584 CMPA.l D6, A5 bbc6",
			init: 			cpuState{
				D:   [8]uint32{3097181816, 2904187214, 1143778587, 3992765728, 2958800308, 1388406137, 595227042, 1067484165},
				A:   [7]uint32{4231477169, 3192649566, 2484111406, 3108766813, 2585242692, 2462263935, 1333220572},
				PC:  8297574,
				SR:  24,
				USP: 2418052,
				SSP: 1436946,
				RAM: [][2]uint32{{8297570, 187}, {8297571, 198}, {8297572, 183}, {8297573, 33}, {8297574, 141}, {8297575, 195}},
			},
			want: 			cpuState{
				D:   [8]uint32{3097181816, 2904187214, 1143778587, 3992765728, 2958800308, 1388406137, 595227042, 1067484165},
				A:   [7]uint32{4231477169, 3192649566, 2484111406, 3108766813, 2585242692, 2462263935, 1333220572},
				PC:  8297576,
				SR:  18,
				USP: 2418052,
				SSP: 1436946,
				RAM: [][2]uint32{{8297570, 187}, {8297571, 198}, {8297572, 183}, {8297573, 33}, {8297574, 141}, {8297575, 195}},
				Cycles: 6,
			},
		},
		{
			name: "858 CMPA.l (A7)+, A0 b1df",
			init: 			cpuState{
				D:   [8]uint32{4061113588, 1520833260, 1651259472, 1448156303, 1368999350, 2096077542, 1696080007, 3166214995},
				A:   [7]uint32{81577579, 1162303501, 2961658284, 3107200729, 383352553, 2210196041, 202323806},
				PC:  4485356,
				SR:  8469,
				USP: 16623552,
				SSP: 8422538,
				RAM: [][2]uint32{{4485352, 177}, {4485353, 223}, {4485354, 226}, {4485355, 196}, {8422538, 30}, {8422539, 112}, {8422540, 99}, {8422541, 175}, {4485356, 200}, {4485357, 135}},
			},
			want: 			cpuState{
				D:   [8]uint32{4061113588, 1520833260, 1651259472, 1448156303, 1368999350, 2096077542, 1696080007, 3166214995},
				A:   [7]uint32{81577579, 1162303501, 2961658284, 3107200729, 383352553, 2210196041, 202323806},
				PC:  4485358,
				SR:  8473,
				USP: 16623552,
				SSP: 8422542,
				RAM: [][2]uint32{{4485352, 177}, {4485353, 223}, {4485354, 226}, {4485355, 196}, {8422538, 30}, {8422539, 112}, {8422540, 99}, {8422541, 175}, {4485356, 200}, {4485357, 135}},
				Cycles: 14,
			},
		},
		{
			name: "1114 CMPA.l (A4), A2 b5d4",
			init: 			cpuState{
				D:   [8]uint32{3740205485, 3211991999, 2941498524, 3308453482, 3125716937, 810136606, 582654950, 1804217623},
				A:   [7]uint32{2737203242, 1335060598, 763119291, 1057461191, 2238402024, 3608485526, 2397191061},
				PC:  10261464,
				SR:  9986,
				USP: 13915954,
				SSP: 6558448,
				RAM: [][2]uint32{{10261460, 181}, {10261461, 212}, {10261462, 81}, {10261463, 166}, {7032296, 45}, {7032297, 11}, {7032298, 93}, {7032299, 230}, {10261464, 190}, {10261465, 40}},
			},
			want: 			cpuState{
				D:   [8]uint32{3740205485, 3211991999, 2941498524, 3308453482, 3125716937, 810136606, 582654950, 1804217623},
				A:   [7]uint32{2737203242, 1335060598, 763119291, 1057461191, 2238402024, 3608485526, 2397191061},
				PC:  10261466,
				SR:  9984,
				USP: 13915954,
				SSP: 6558448,
				RAM: [][2]uint32{{10261460, 181}, {10261461, 212}, {10261462, 81}, {10261463, 166}, {7032296, 45}, {7032297, 11}, {7032298, 93}, {7032299, 230}, {10261464, 190}, {10261465, 40}},
				Cycles: 14,
			},
		},
		{
			name: "1371 CMPA.l D3, A2 b5c3",
			init: 			cpuState{
				D:   [8]uint32{3650679027, 3205094846, 2350475687, 2930493745, 1957757925, 2027171673, 3638159806, 3896745808},
				A:   [7]uint32{843646346, 186394483, 1668817328, 1066417980, 1791234066, 1332929321, 2371811156},
				PC:  14095284,
				SR:  262,
				USP: 15306650,
				SSP: 2834804,
				RAM: [][2]uint32{{14095280, 181}, {14095281, 195}, {14095282, 84}, {14095283, 78}, {14095284, 232}, {14095285, 132}},
			},
			want: 			cpuState{
				D:   [8]uint32{3650679027, 3205094846, 2350475687, 2930493745, 1957757925, 2027171673, 3638159806, 3896745808},
				A:   [7]uint32{843646346, 186394483, 1668817328, 1066417980, 1791234066, 1332929321, 2371811156},
				PC:  14095286,
				SR:  267,
				USP: 15306650,
				SSP: 2834804,
				RAM: [][2]uint32{{14095280, 181}, {14095281, 195}, {14095282, 84}, {14095283, 78}, {14095284, 232}, {14095285, 132}},
				Cycles: 6,
			},
		},
		{
			name: "1645 CMPA.l (d8, A2, Xn), A0 b1f2",
			init: 			cpuState{
				D:   [8]uint32{2191020418, 561392689, 2737356848, 1683408886, 3552007635, 2460679373, 3020269326, 768752219},
				A:   [7]uint32{1497164712, 1354209852, 1353246706, 1768706829, 1250283661, 4238219877, 2934358240},
				PC:  10088326,
				SR:  8732,
				USP: 14295134,
				SSP: 16394488,
				RAM: [][2]uint32{{10088322, 177}, {10088323, 242}, {10088324, 186}, {10088325, 223}, {10088326, 30}, {10088327, 222}, {1391326, 202}, {1391327, 244}, {1391328, 208}, {1391329, 32}, {10088328, 224}, {10088329, 181}},
			},
			want: 			cpuState{
				D:   [8]uint32{2191020418, 561392689, 2737356848, 1683408886, 3552007635, 2460679373, 3020269326, 768752219},
				A:   [7]uint32{1497164712, 1354209852, 1353246706, 1768706829, 1250283661, 4238219877, 2934358240},
				PC:  10088330,
				SR:  8731,
				USP: 14295134,
				SSP: 16394488,
				RAM: [][2]uint32{{10088322, 177}, {10088323, 242}, {10088324, 186}, {10088325, 223}, {10088326, 30}, {10088327, 222}, {1391326, 202}, {1391327, 244}, {1391328, 208}, {1391329, 32}, {10088328, 224}, {10088329, 181}},
				Cycles: 20,
			},
		},
		{
			name: "1912 CMPA.l A6, A3 b7ce",
			init: 			cpuState{
				D:   [8]uint32{1948972360, 1671655780, 3680021875, 3413573754, 3482472070, 2958638475, 3599832215, 1615788695},
				A:   [7]uint32{149213624, 2287684992, 847504624, 3435304595, 668251166, 3096261986, 2242118257},
				PC:  10449666,
				SR:  775,
				USP: 4643232,
				SSP: 603004,
				RAM: [][2]uint32{{10449662, 183}, {10449663, 206}, {10449664, 143}, {10449665, 46}, {10449666, 39}, {10449667, 25}},
			},
			want: 			cpuState{
				D:   [8]uint32{1948972360, 1671655780, 3680021875, 3413573754, 3482472070, 2958638475, 3599832215, 1615788695},
				A:   [7]uint32{149213624, 2287684992, 847504624, 3435304595, 668251166, 3096261986, 2242118257},
				PC:  10449668,
				SR:  768,
				USP: 4643232,
				SSP: 603004,
				RAM: [][2]uint32{{10449662, 183}, {10449663, 206}, {10449664, 143}, {10449665, 46}, {10449666, 39}, {10449667, 25}},
				Cycles: 6,
			},
		},
		{
			name: "2193 CMPA.l (d16, PC), A5 bbfa",
			init: 			cpuState{
				D:   [8]uint32{2394719256, 1557596306, 3511531090, 2070945257, 3855442358, 4080375365, 3805877955, 3848075511},
				A:   [7]uint32{3474356374, 2236411647, 2784869758, 3660134756, 2403073148, 1963897336, 371376855},
				PC:  5260536,
				SR:  8704,
				USP: 1352356,
				SSP: 11715760,
				RAM: [][2]uint32{{5260532, 187}, {5260533, 250}, {5260534, 112}, {5260535, 22}, {5260536, 208}, {5260537, 86}, {5289228, 12}, {5289229, 231}, {5289230, 175}, {5289231, 20}, {5260538, 1}, {5260539, 228}},
			},
			want: 			cpuState{
				D:   [8]uint32{2394719256, 1557596306, 3511531090, 2070945257, 3855442358, 4080375365, 3805877955, 3848075511},
				A:   [7]uint32{3474356374, 2236411647, 2784869758, 3660134756, 2403073148, 1963897336, 371376855},
				PC:  5260540,
				SR:  8704,
				USP: 1352356,
				SSP: 11715760,
				RAM: [][2]uint32{{5260532, 187}, {5260533, 250}, {5260534, 112}, {5260535, 22}, {5260536, 208}, {5260537, 86}, {5289228, 12}, {5289229, 231}, {5289230, 175}, {5289231, 20}, {5260538, 1}, {5260539, 228}},
				Cycles: 18,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMULU(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MULU D7, D6 ccc7",
			init: cpuState{
				D:   [8]uint32{2909375531, 45066297, 2272781739, 3284563293, 222391173, 2171116808, 1410154944, 3340024981},
				A:   [7]uint32{3471851701, 600322505, 4058441337, 3860183758, 245925844, 2792002862, 3063616133},
				PC:  14881286,
				SR:  33543,
				USP: 2770922,
				SSP: 14958,
				RAM: [][2]uint32{{14881282, 204}, {14881283, 199}, {14881284, 116}, {14881285, 37}, {14881286, 34}, {14881287, 226}},
			},
			want: cpuState{
				D:   [8]uint32{2909375531, 45066297, 2272781739, 3284563293, 222391173, 2171116808, 812598464, 3340024981},
				A:   [7]uint32{3471851701, 600322505, 4058441337, 3860183758, 245925844, 2792002862, 3063616133},
				PC:  14881288,
				SR:  33536,
				USP: 2770922,
				SSP: 14958,
				RAM: [][2]uint32{{14881282, 204}, {14881283, 199}, {14881284, 116}, {14881285, 37}, {14881286, 34}, {14881287, 226}},
				// MULU: uses flat worst-case 70 cycles (real range 38-70).
				// Cycles: 56,
			},
		},
		{
			name: "500 MULU (A6), D4 c8d6",
			init: cpuState{
				D:   [8]uint32{557752111, 3120745195, 1183650044, 1157818305, 1856489520, 4115329407, 2275210584, 1322986555},
				A:   [7]uint32{3961347917, 290040884, 2837849344, 2516501503, 103586381, 1311019909, 3311802680},
				PC:  15573028,
				SR:  277,
				USP: 13123928,
				SSP: 10552228,
				RAM: [][2]uint32{{15573024, 200}, {15573025, 214}, {15573026, 184}, {15573027, 114}, {6691128, 11}, {6691129, 213}, {15573028, 32}, {15573029, 147}},
			},
			want: cpuState{
				D:   [8]uint32{557752111, 3120745195, 1183650044, 1157818305, 155230192, 4115329407, 2275210584, 1322986555},
				A:   [7]uint32{3961347917, 290040884, 2837849344, 2516501503, 103586381, 1311019909, 3311802680},
				PC:  15573030,
				SR:  272,
				USP: 13123928,
				SSP: 10552228,
				RAM: [][2]uint32{{15573024, 200}, {15573025, 214}, {15573026, 184}, {15573027, 114}, {6691128, 11}, {6691129, 213}, {15573028, 32}, {15573029, 147}},
				// MULU: uses flat worst-case 70 cycles (real range 38-70).
				// Cycles: 58,
			},
		},
		{
			name: "1000 MULU (d16, A6), D1 c2ee",
			init: cpuState{
				D:   [8]uint32{499070063, 2416728071, 2856028692, 2663182908, 302958052, 3718686238, 3918859815, 4238725179},
				A:   [7]uint32{635427773, 736488623, 2903352753, 3303195388, 1422995643, 3916655940, 2230818305},
				PC:  13310326,
				SR:  8984,
				USP: 1814124,
				SSP: 6229988,
				RAM: [][2]uint32{{13310322, 194}, {13310323, 238}, {13310324, 222}, {13310325, 206}, {13310326, 140}, {13310327, 73}, {12, 192}, {13, 122}, {14, 107}, {15, 58}, {8022842, 21}, {8022843, 113}, {8022844, 93}, {8022845, 209}},
			},
			want: cpuState{
				D:      [8]uint32{499070063, 2416728071, 2856028692, 2663182908, 302958052, 3718686238, 3918859815, 4238725179},
				A:      [7]uint32{635427773, 736488623, 2903352753, 3303195388, 1422995643, 3916655940, 2230818305},
				PC:     3229248318,
				SR:     8984,
				USP:    1814124,
				SSP:    6229974,
				RAM:    [][2]uint32{{13310322, 194}, {13310323, 238}, {13310324, 222}, {13310325, 206}, {13310326, 140}, {13310327, 73}, {6229986, 25}, {6229987, 116}, {6229982, 35}, {6229983, 24}, {6229984, 0}, {6229985, 203}, {6229980, 194}, {6229981, 238}, {6229978, 116}, {6229979, 207}, {6229974, 194}, {6229975, 245}, {6229976, 132}, {6229977, 247}, {12, 192}, {13, 122}, {14, 107}, {15, 58}, {8022842, 21}, {8022843, 113}, {8022844, 93}, {8022845, 209}},
				Halted: true,
			},
		},
		{
			name: "1500 MULU (d8, PC, Xn), D4 c8fb",
			init: cpuState{
				D:   [8]uint32{3944805228, 1156130819, 881415182, 1582996232, 2282124988, 962557027, 1129793315, 1924010085},
				A:   [7]uint32{231387872, 4220046673, 2645142616, 3874436287, 576378809, 2675111738, 1981800159},
				PC:  5331250,
				SR:  40966,
				USP: 12464774,
				SSP: 8192214,
				RAM: [][2]uint32{{5331246, 200}, {5331247, 251}, {5331248, 208}, {5331249, 178}, {5331250, 42}, {5331251, 155}, {5328924, 225}, {5328925, 67}, {5331252, 65}, {5331253, 62}},
			},
			want: cpuState{
				D:   [8]uint32{3944805228, 1156130819, 881415182, 1582996232, 1752846132, 962557027, 1129793315, 1924010085},
				A:   [7]uint32{231387872, 4220046673, 2645142616, 3874436287, 576378809, 2675111738, 1981800159},
				PC:  5331254,
				SR:  40960,
				USP: 12464774,
				SSP: 8192214,
				RAM: [][2]uint32{{5331246, 200}, {5331247, 251}, {5331248, 208}, {5331249, 178}, {5331250, 42}, {5331251, 155}, {5328924, 225}, {5328925, 67}, {5331252, 65}, {5331253, 62}},
				// MULU: uses flat worst-case 70 cycles (real range 38-70).
				// Cycles: 62,
			},
		},
		{
			name: "2000 MULU (d16, A6), D3 c6ee",
			init: cpuState{
				D:   [8]uint32{3435918671, 795469021, 1742257036, 343936349, 2602879117, 3692859732, 1040948598, 3927716538},
				A:   [7]uint32{1207471368, 1038265701, 2963329091, 641468235, 541445411, 1655751825, 664242045},
				PC:  8986292,
				SR:  42760,
				USP: 14887320,
				SSP: 9745114,
				RAM: [][2]uint32{{8986288, 198}, {8986289, 238}, {8986290, 241}, {8986291, 61}, {8986292, 69}, {8986293, 122}, {9926842, 182}, {9926843, 192}, {8986294, 200}, {8986295, 164}},
			},
			want: cpuState{
				D:   [8]uint32{3435918671, 795469021, 1742257036, 160048064, 2602879117, 3692859732, 1040948598, 3927716538},
				A:   [7]uint32{1207471368, 1038265701, 2963329091, 641468235, 541445411, 1655751825, 664242045},
				PC:  8986296,
				SR:  42752,
				USP: 14887320,
				SSP: 9745114,
				RAM: [][2]uint32{{8986288, 198}, {8986289, 238}, {8986290, 241}, {8986291, 61}, {8986292, 69}, {8986293, 122}, {9926842, 182}, {9926843, 192}, {8986294, 200}, {8986295, 164}},
				// MULU: uses flat worst-case 70 cycles (real range 38-70).
				// Cycles: 60,
			},
		},
		{
			name: "001 MULU -(A1), D7 cee1",
			init: 			cpuState{
				D:   [8]uint32{1315198159, 902315066, 157072743, 3720484852, 2938192116, 2925844144, 1996925972, 2610936829},
				A:   [7]uint32{500701953, 2392276610, 99865811, 2657752381, 3305813636, 660355225, 2805834601},
				PC:  14338326,
				SR:  270,
				USP: 1551740,
				SSP: 7164324,
				RAM: [][2]uint32{{14338322, 206}, {14338323, 225}, {14338324, 195}, {14338325, 23}, {9911936, 220}, {9911937, 79}, {14338326, 149}, {14338327, 16}},
			},
			want: 			cpuState{
				D:   [8]uint32{1315198159, 902315066, 157072743, 3720484852, 2938192116, 2925844144, 1996925972, 2714201875},
				A:   [7]uint32{500701953, 2392276608, 99865811, 2657752381, 3305813636, 660355225, 2805834601},
				PC:  14338328,
				SR:  264,
				USP: 1551740,
				SSP: 7164324,
				RAM: [][2]uint32{{14338322, 206}, {14338323, 225}, {14338324, 195}, {14338325, 23}, {9911936, 220}, {9911937, 79}, {14338326, 149}, {14338327, 16}},
				Cycles: 0,
			},
		},
		{
			name: "255 MULU -(A4), D3 c6e4",
			init: 			cpuState{
				D:   [8]uint32{2332501711, 688933599, 2060269709, 4184381828, 3265202822, 1580985463, 3045324528, 4101586724},
				A:   [7]uint32{3666594860, 1570233689, 3289817801, 369585906, 3585429792, 802625699, 4279253813},
				PC:  1141164,
				SR:  774,
				USP: 6550514,
				SSP: 12377926,
				RAM: [][2]uint32{{1141160, 198}, {1141161, 228}, {1141162, 144}, {1141163, 112}, {11882782, 54}, {11882783, 111}, {1141164, 103}, {1141165, 231}},
			},
			want: 			cpuState{
				D:   [8]uint32{2332501711, 688933599, 2060269709, 547645500, 3265202822, 1580985463, 3045324528, 4101586724},
				A:   [7]uint32{3666594860, 1570233689, 3289817801, 369585906, 3585429790, 802625699, 4279253813},
				PC:  1141166,
				SR:  768,
				USP: 6550514,
				SSP: 12377926,
				RAM: [][2]uint32{{1141160, 198}, {1141161, 228}, {1141162, 144}, {1141163, 112}, {11882782, 54}, {11882783, 111}, {1141164, 103}, {1141165, 231}},
				Cycles: 0,
			},
		},
		{
			name: "532 MULU D3, D2 c4c3",
			init: 			cpuState{
				D:   [8]uint32{1770609704, 954627871, 2309117818, 1364727510, 2504179116, 864820357, 2360223172, 622545791},
				A:   [7]uint32{2007938438, 2615514230, 733762992, 1779467101, 1542414214, 3871569400, 2593608780},
				PC:  3224536,
				SR:  9985,
				USP: 16226520,
				SSP: 6142740,
				RAM: [][2]uint32{{3224532, 196}, {3224533, 195}, {3224534, 47}, {3224535, 130}, {3224536, 249}, {3224537, 138}},
			},
			want: 			cpuState{
				D:   [8]uint32{1770609704, 954627871, 130915324, 1364727510, 2504179116, 864820357, 2360223172, 622545791},
				A:   [7]uint32{2007938438, 2615514230, 733762992, 1779467101, 1542414214, 3871569400, 2593608780},
				PC:  3224538,
				SR:  9984,
				USP: 16226520,
				SSP: 6142740,
				RAM: [][2]uint32{{3224532, 196}, {3224533, 195}, {3224534, 47}, {3224535, 130}, {3224536, 249}, {3224537, 138}},
				Cycles: 0,
			},
		},
		{
			name: "800 MULU D2, D1 c2c2",
			init: 			cpuState{
				D:   [8]uint32{1470597812, 2697965622, 1058629119, 1294028096, 3740380548, 2093579906, 2027232436, 25898583},
				A:   [7]uint32{332749937, 222842549, 341602888, 3007911163, 2039087028, 3923144888, 3320775954},
				PC:  853196,
				SR:  784,
				USP: 8614252,
				SSP: 6152048,
				RAM: [][2]uint32{{853192, 194}, {853193, 194}, {853194, 113}, {853195, 125}, {853196, 229}, {853197, 4}},
			},
			want: 			cpuState{
				D:   [8]uint32{1470597812, 1177867210, 1058629119, 1294028096, 3740380548, 2093579906, 2027232436, 25898583},
				A:   [7]uint32{332749937, 222842549, 341602888, 3007911163, 2039087028, 3923144888, 3320775954},
				PC:  853198,
				SR:  784,
				USP: 8614252,
				SSP: 6152048,
				RAM: [][2]uint32{{853192, 194}, {853193, 194}, {853194, 113}, {853195, 125}, {853196, 229}, {853197, 4}},
				Cycles: 0,
			},
		},
		{
			name: "1091 MULU (A4)+, D0 c0dc",
			init: 			cpuState{
				D:   [8]uint32{2427210078, 2204185667, 4010396788, 961888966, 2757078097, 1036165170, 2027019126, 4282927143},
				A:   [7]uint32{2423820216, 147353365, 3889305900, 3322736755, 3640971824, 3410542725, 1469386131},
				PC:  425532,
				SR:  794,
				USP: 7235800,
				SSP: 2614066,
				RAM: [][2]uint32{{425528, 192}, {425529, 220}, {425530, 142}, {425531, 97}, {315952, 198}, {315953, 107}, {425532, 255}, {425533, 96}},
			},
			want: 			cpuState{
				D:   [8]uint32{954031690, 2204185667, 4010396788, 961888966, 2757078097, 1036165170, 2027019126, 4282927143},
				A:   [7]uint32{2423820216, 147353365, 3889305900, 3322736755, 3640971826, 3410542725, 1469386131},
				PC:  425534,
				SR:  784,
				USP: 7235800,
				SSP: 2614066,
				RAM: [][2]uint32{{425528, 192}, {425529, 220}, {425530, 142}, {425531, 97}, {315952, 198}, {315953, 107}, {425532, 255}, {425533, 96}},
				Cycles: 0,
			},
		},
		{
			name: "1343 MULU (d8, A0, Xn), D7 cef0",
			init: 			cpuState{
				D:   [8]uint32{806066257, 3445425395, 45905701, 2876176191, 2979999458, 349756451, 3039050845, 143035933},
				A:   [7]uint32{1942186915, 1964011190, 759237493, 3351205838, 3505898509, 4284347451, 830066048},
				PC:  13193528,
				SR:  1562,
				USP: 1487310,
				SSP: 14802786,
				RAM: [][2]uint32{{13193524, 206}, {13193525, 240}, {13193526, 176}, {13193527, 75}, {13193528, 97}, {13193529, 113}, {12829628, 69}, {12829629, 113}, {13193530, 172}, {13193531, 42}},
			},
			want: 			cpuState{
				D:   [8]uint32{806066257, 3445425395, 45905701, 2876176191, 2979999458, 349756451, 3039050845, 646745037},
				A:   [7]uint32{1942186915, 1964011190, 759237493, 3351205838, 3505898509, 4284347451, 830066048},
				PC:  13193532,
				SR:  1552,
				USP: 1487310,
				SSP: 14802786,
				RAM: [][2]uint32{{13193524, 206}, {13193525, 240}, {13193526, 176}, {13193527, 75}, {13193528, 97}, {13193529, 113}, {12829628, 69}, {12829629, 113}, {13193530, 172}, {13193531, 42}},
				Cycles: 0,
			},
		},
		{
			name: "1636 MULU (d16, A3), D0 c0eb",
			init: 			cpuState{
				D:   [8]uint32{575490819, 1649030048, 1580145577, 3733836990, 352424801, 1822822088, 2093035696, 1917929727},
				A:   [7]uint32{260677404, 915168651, 3789908421, 2751164339, 666449434, 2465824951, 2981436681},
				PC:  5143396,
				SR:  8979,
				USP: 6012754,
				SSP: 15264332,
				RAM: [][2]uint32{{5143392, 192}, {5143393, 235}, {5143394, 241}, {5143395, 207}, {5143396, 106}, {5143397, 98}, {16474498, 219}, {16474499, 225}, {5143398, 165}, {5143399, 16}},
			},
			want: 			cpuState{
				D:   [8]uint32{1080917667, 1649030048, 1580145577, 3733836990, 352424801, 1822822088, 2093035696, 1917929727},
				A:   [7]uint32{260677404, 915168651, 3789908421, 2751164339, 666449434, 2465824951, 2981436681},
				PC:  5143400,
				SR:  8976,
				USP: 6012754,
				SSP: 15264332,
				RAM: [][2]uint32{{5143392, 192}, {5143393, 235}, {5143394, 241}, {5143395, 207}, {5143396, 106}, {5143397, 98}, {16474498, 219}, {16474499, 225}, {5143398, 165}, {5143399, 16}},
				Cycles: 0,
			},
		},
		{
			name: "1950 MULU (d8, PC, Xn), D5 cafb",
			init: 			cpuState{
				D:   [8]uint32{1026007511, 645562481, 3023162177, 3173568635, 3502043563, 1132510038, 3346762099, 3790504697},
				A:   [7]uint32{1052405226, 964251944, 3737925921, 175543963, 4204902802, 2973669928, 914675503},
				PC:  7771876,
				SR:  526,
				USP: 3848068,
				SSP: 9599774,
				RAM: [][2]uint32{{7771872, 202}, {7771873, 251}, {7771874, 222}, {7771875, 230}, {7771876, 13}, {7771877, 170}, {11874544, 27}, {11874545, 94}, {7771878, 238}, {7771879, 216}},
			},
			want: 			cpuState{
				D:   [8]uint32{1026007511, 645562481, 3023162177, 3173568635, 3502043563, 335993748, 3346762099, 3790504697},
				A:   [7]uint32{1052405226, 964251944, 3737925921, 175543963, 4204902802, 2973669928, 914675503},
				PC:  7771880,
				SR:  512,
				USP: 3848068,
				SSP: 9599774,
				RAM: [][2]uint32{{7771872, 202}, {7771873, 251}, {7771874, 222}, {7771875, 230}, {7771876, 13}, {7771877, 170}, {11874544, 27}, {11874545, 94}, {7771878, 238}, {7771879, 216}},
				Cycles: 0,
			},
		},
		{
			name: "2222 MULU -(A7), D0 c0e7",
			init: 			cpuState{
				D:   [8]uint32{770773975, 3653479792, 3551815997, 33608277, 1033682719, 1590424898, 1697629256, 3553698089},
				A:   [7]uint32{934203450, 1971451624, 2221122803, 1424172711, 1332506410, 3182280539, 3654890593},
				PC:  8124250,
				SR:  1815,
				USP: 15380912,
				SSP: 7068108,
				RAM: [][2]uint32{{8124246, 192}, {8124247, 231}, {8124248, 210}, {8124249, 138}, {15380910, 163}, {15380911, 44}, {8124250, 25}, {8124251, 154}},
			},
			want: 			cpuState{
				D:   [8]uint32{212159988, 3653479792, 3551815997, 33608277, 1033682719, 1590424898, 1697629256, 3553698089},
				A:   [7]uint32{934203450, 1971451624, 2221122803, 1424172711, 1332506410, 3182280539, 3654890593},
				PC:  8124252,
				SR:  1808,
				USP: 15380910,
				SSP: 7068108,
				RAM: [][2]uint32{{8124246, 192}, {8124247, 231}, {8124248, 210}, {8124249, 138}, {15380910, 163}, {15380911, 44}, {8124250, 25}, {8124251, 154}},
				Cycles: 0,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMULS(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MULS (A0), D7 cfd0",
			init: cpuState{
				D:   [8]uint32{1704645368, 1901729937, 3128084608, 2902137850, 1704553321, 1645148921, 1541705176, 3019654251},
				A:   [7]uint32{3191554209, 2285547708, 1406541405, 3273714787, 3633134209, 1861415841, 1909716418},
				PC:  7257768,
				SR:  41231,
				USP: 11325510,
				SSP: 4905300,
				RAM: [][2]uint32{{7257764, 207}, {7257765, 208}, {7257766, 65}, {7257767, 182}, {12, 212}, {13, 136}, {14, 12}, {15, 28}, {8915996, 32}, {8915997, 192}, {8915998, 67}, {8915999, 162}},
			},
			want: cpuState{
				D:      [8]uint32{1704645368, 1901729937, 3128084608, 2902137850, 1704553321, 1645148921, 1541705176, 3019654251},
				A:      [7]uint32{3191554209, 2285547708, 1406541405, 3273714787, 3633134209, 1861415841, 1909716418},
				PC:     3565685792,
				SR:     8463,
				USP:    11325510,
				SSP:    4905286,
				RAM:    [][2]uint32{{7257764, 207}, {7257765, 208}, {7257766, 65}, {7257767, 182}, {4905298, 190}, {4905299, 166}, {4905294, 161}, {4905295, 15}, {4905296, 0}, {4905297, 110}, {4905292, 207}, {4905293, 208}, {4905290, 64}, {4905291, 161}, {4905286, 207}, {4905287, 213}, {4905288, 190}, {4905289, 59}, {12, 212}, {13, 136}, {14, 12}, {15, 28}, {8915996, 32}, {8915997, 192}, {8915998, 67}, {8915999, 162}},
				Halted: true,
			},
		},
		{
			name: "500 MULS (A4), D3 c7d4",
			init: cpuState{
				D:   [8]uint32{3201550852, 1081349702, 4268869544, 1144659714, 3038672353, 3112386840, 3444486923, 221977737},
				A:   [7]uint32{3336816699, 1872675517, 1376689166, 3395013168, 586106007, 2358942989, 767937415},
				PC:  11326772,
				SR:  42761,
				USP: 10667612,
				SSP: 11962342,
				RAM: [][2]uint32{{11326768, 199}, {11326769, 212}, {11326770, 55}, {11326771, 14}, {12, 83}, {13, 26}, {14, 15}, {15, 150}, {1707926, 123}, {1707927, 31}, {1707928, 36}, {1707929, 21}},
			},
			want: cpuState{
				D:      [8]uint32{3201550852, 1081349702, 4268869544, 1144659714, 3038672353, 3112386840, 3444486923, 221977737},
				A:      [7]uint32{3336816699, 1872675517, 1376689166, 3395013168, 586106007, 2358942989, 767937415},
				PC:     1394216858,
				SR:     9993,
				USP:    10667612,
				SSP:    11962328,
				RAM:    [][2]uint32{{11326768, 199}, {11326769, 212}, {11326770, 55}, {11326771, 14}, {11962340, 213}, {11962341, 50}, {11962336, 167}, {11962337, 9}, {11962338, 0}, {11962339, 172}, {11962334, 199}, {11962335, 212}, {11962332, 68}, {11962333, 151}, {11962328, 199}, {11962329, 213}, {11962330, 34}, {11962331, 239}, {12, 83}, {13, 26}, {14, 15}, {15, 150}, {1707926, 123}, {1707927, 31}, {1707928, 36}, {1707929, 21}},
				Halted: true,
			},
		},
		{
			name: "1000 MULS (xxx).l, D4 c9f9",
			init: cpuState{
				D:   [8]uint32{3647687287, 1485830246, 721887628, 2156691615, 450378171, 624011470, 49863416, 1355137234},
				A:   [7]uint32{124806300, 46428065, 3305759920, 241462433, 945399426, 1783884140, 871044685},
				PC:  3275976,
				SR:  33287,
				USP: 6323212,
				SSP: 10972184,
				RAM: [][2]uint32{{3275972, 201}, {3275973, 249}, {3275974, 209}, {3275975, 224}, {3275976, 177}, {3275977, 43}, {3275978, 39}, {3275979, 198}, {12, 141}, {13, 154}, {14, 215}, {15, 86}, {10147670, 111}, {10147671, 17}, {10147672, 63}, {10147673, 41}},
			},
			want: cpuState{
				D:      [8]uint32{3647687287, 1485830246, 721887628, 2156691615, 450378171, 624011470, 49863416, 1355137234},
				A:      [7]uint32{124806300, 46428065, 3305759920, 241462433, 945399426, 1783884140, 871044685},
				PC:     2375735130,
				SR:     8711,
				USP:    6323212,
				SSP:    10972170,
				RAM:    [][2]uint32{{3275972, 201}, {3275973, 249}, {3275974, 209}, {3275975, 224}, {3275976, 177}, {3275977, 43}, {3275978, 39}, {3275979, 198}, {10972182, 252}, {10972183, 202}, {10972178, 130}, {10972179, 7}, {10972180, 0}, {10972181, 49}, {10972176, 201}, {10972177, 249}, {10972174, 177}, {10972175, 43}, {10972170, 201}, {10972171, 241}, {10972172, 209}, {10972173, 224}, {12, 141}, {13, 154}, {14, 215}, {15, 86}, {10147670, 111}, {10147671, 17}, {10147672, 63}, {10147673, 41}},
				Halted: true,
			},
		},
		{
			name: "1500 MULS -(A0), D4 c9e0",
			init: cpuState{
				D:   [8]uint32{1292028538, 1563758125, 1394486475, 3212262621, 1772501401, 3984915181, 1212938363, 529248960},
				A:   [7]uint32{838640754, 1277056709, 2192284561, 361350074, 2531121974, 2923346865, 50233311},
				PC:  10262042,
				SR:  8732,
				USP: 5413410,
				SSP: 15468822,
				RAM: [][2]uint32{{10262038, 201}, {10262039, 224}, {10262040, 216}, {10262041, 150}, {16557168, 41}, {16557169, 24}, {10262042, 160}, {10262043, 207}},
			},
			want: cpuState{
				D:   [8]uint32{1292028538, 1563758125, 1394486475, 3212262621, 155117400, 3984915181, 1212938363, 529248960},
				A:   [7]uint32{838640752, 1277056709, 2192284561, 361350074, 2531121974, 2923346865, 50233311},
				PC:  10262044,
				SR:  8720,
				USP: 5413410,
				SSP: 15468822,
				RAM: [][2]uint32{{10262038, 201}, {10262039, 224}, {10262040, 216}, {10262041, 150}, {16557168, 41}, {16557169, 24}, {10262042, 160}, {10262043, 207}},
				// MULS: uses flat worst-case 70 cycles (real range 38-70).
				// Cycles: 60,
			},
		},
		{
			name: "2000 MULS (d16, A5), D6 cded",
			init: cpuState{
				D:   [8]uint32{4020554460, 1046034208, 3440707144, 2082346192, 985801223, 2711674057, 2405889320, 2263125806},
				A:   [7]uint32{2793487633, 846310692, 2932435961, 1621580739, 641085303, 3175606001, 2751795172},
				PC:  16187586,
				SR:  1296,
				USP: 15891238,
				SSP: 12708586,
				RAM: [][2]uint32{{16187582, 205}, {16187583, 237}, {16187584, 165}, {16187585, 13}, {16187586, 198}, {16187587, 92}, {4688894, 2}, {4688895, 69}, {16187588, 252}, {16187589, 0}},
			},
			want: cpuState{
				D:   [8]uint32{4020554460, 1046034208, 3440707144, 2082346192, 985801223, 2711674057, 4293354440, 2263125806},
				A:   [7]uint32{2793487633, 846310692, 2932435961, 1621580739, 641085303, 3175606001, 2751795172},
				PC:  16187590,
				SR:  1304,
				USP: 15891238,
				SSP: 12708586,
				RAM: [][2]uint32{{16187582, 205}, {16187583, 237}, {16187584, 165}, {16187585, 13}, {16187586, 198}, {16187587, 92}, {4688894, 2}, {4688895, 69}, {16187588, 252}, {16187589, 0}},
				// MULS: uses flat worst-case 70 cycles (real range 38-70).
				// Cycles: 62,
			},
		},
		{
			name: "009 MULS (d16, A2), D4 c9ea",
			init: 			cpuState{
				D:   [8]uint32{1954974071, 3283500006, 2650055118, 1177807590, 1852994727, 2831586079, 4062836034, 3961793668},
				A:   [7]uint32{3197406953, 1705704669, 1873372881, 3260692136, 3882125404, 3355704837, 3797428900},
				PC:  4904598,
				SR:  8476,
				USP: 612040,
				SSP: 720192,
				RAM: [][2]uint32{{4904594, 201}, {4904595, 234}, {4904596, 90}, {4904597, 21}, {4904598, 84}, {4904599, 20}, {11124966, 176}, {11124967, 159}, {4904600, 115}, {4904601, 202}},
			},
			want: 			cpuState{
				D:   [8]uint32{1954974071, 3283500006, 2650055118, 1177807590, 3688121273, 2831586079, 4062836034, 3961793668},
				A:   [7]uint32{3197406953, 1705704669, 1873372881, 3260692136, 3882125404, 3355704837, 3797428900},
				PC:  4904602,
				SR:  8472,
				USP: 612040,
				SSP: 720192,
				RAM: [][2]uint32{{4904594, 201}, {4904595, 234}, {4904596, 90}, {4904597, 21}, {4904598, 84}, {4904599, 20}, {11124966, 176}, {11124967, 159}, {4904600, 115}, {4904601, 202}},
				Cycles: 0,
			},
		},
		{
			name: "287 MULS (d8, A6, Xn), D3 c7f6",
			init: 			cpuState{
				D:   [8]uint32{2102726057, 2921929796, 853547966, 1227347495, 3729451690, 687523460, 2576201141, 518807884},
				A:   [7]uint32{1372039623, 634864035, 3288146213, 2115924332, 536885896, 3878773346, 1464609045},
				PC:  6872242,
				SR:  524,
				USP: 13138290,
				SSP: 11332264,
				RAM: [][2]uint32{{6872238, 199}, {6872239, 246}, {6872240, 137}, {6872241, 148}, {6872242, 60}, {6872243, 115}, {1299056, 153}, {1299057, 196}, {6872244, 155}, {6872245, 155}},
			},
			want: 			cpuState{
				D:   [8]uint32{2102726057, 2921929796, 853547966, 280380636, 3729451690, 687523460, 2576201141, 518807884},
				A:   [7]uint32{1372039623, 634864035, 3288146213, 2115924332, 536885896, 3878773346, 1464609045},
				PC:  6872246,
				SR:  512,
				USP: 13138290,
				SSP: 11332264,
				RAM: [][2]uint32{{6872238, 199}, {6872239, 246}, {6872240, 137}, {6872241, 148}, {6872242, 60}, {6872243, 115}, {1299056, 153}, {1299057, 196}, {6872244, 155}, {6872245, 155}},
				Cycles: 0,
			},
		},
		{
			name: "531 MULS (d8, PC, Xn), D6 cdfb",
			init: 			cpuState{
				D:   [8]uint32{1776048594, 3538883594, 487066947, 632420962, 1043515125, 1677465285, 3119233968, 2765358844},
				A:   [7]uint32{2397720414, 1599174946, 2841200482, 3304383570, 536816498, 990928095, 3226583082},
				PC:  14333056,
				SR:  4,
				USP: 14410382,
				SSP: 804090,
				RAM: [][2]uint32{{14333052, 205}, {14333053, 251}, {14333054, 254}, {14333055, 92}, {14333056, 97}, {14333057, 249}, {11966312, 245}, {11966313, 39}, {14333058, 211}, {14333059, 160}},
			},
			want: 			cpuState{
				D:   [8]uint32{1776048594, 3538883594, 487066947, 632420962, 1043515125, 1677465285, 48564176, 2765358844},
				A:   [7]uint32{2397720414, 1599174946, 2841200482, 3304383570, 536816498, 990928095, 3226583082},
				PC:  14333060,
				SR:  0,
				USP: 14410382,
				SSP: 804090,
				RAM: [][2]uint32{{14333052, 205}, {14333053, 251}, {14333054, 254}, {14333055, 92}, {14333056, 97}, {14333057, 249}, {11966312, 245}, {11966313, 39}, {14333058, 211}, {14333059, 160}},
				Cycles: 0,
			},
		},
		{
			name: "837 MULS -(A1), D0 c1e1",
			init: 			cpuState{
				D:   [8]uint32{4266489051, 1871504054, 1537037644, 3798667011, 950748575, 1465634452, 2472638423, 330451779},
				A:   [7]uint32{2128782497, 320091188, 3524497198, 1064713173, 3084273779, 3374205403, 1502871896},
				PC:  3509904,
				SR:  537,
				USP: 13033858,
				SSP: 5497792,
				RAM: [][2]uint32{{3509900, 193}, {3509901, 225}, {3509902, 85}, {3509903, 224}, {1324082, 215}, {1324083, 217}, {3509904, 244}, {3509905, 62}},
			},
			want: 			cpuState{
				D:   [8]uint32{3987471011, 1871504054, 1537037644, 3798667011, 950748575, 1465634452, 2472638423, 330451779},
				A:   [7]uint32{2128782497, 320091186, 3524497198, 1064713173, 3084273779, 3374205403, 1502871896},
				PC:  3509906,
				SR:  536,
				USP: 13033858,
				SSP: 5497792,
				RAM: [][2]uint32{{3509900, 193}, {3509901, 225}, {3509902, 85}, {3509903, 224}, {1324082, 215}, {1324083, 217}, {3509904, 244}, {3509905, 62}},
				Cycles: 0,
			},
		},
		{
			name: "1092 MULS -(A1), D1 c3e1",
			init: 			cpuState{
				D:   [8]uint32{1657535608, 1304674926, 4212643690, 3211816939, 3340831289, 3408256587, 2688398583, 1910881984},
				A:   [7]uint32{1550768615, 298026566, 343129830, 3499432405, 1536457232, 4058646899, 3359705360},
				PC:  10134658,
				SR:  518,
				USP: 12913658,
				SSP: 3223254,
				RAM: [][2]uint32{{10134654, 195}, {10134655, 225}, {10134656, 255}, {10134657, 243}, {12813892, 212}, {12813893, 229}, {10134658, 118}, {10134659, 204}},
			},
			want: 			cpuState{
				D:   [8]uint32{1657535608, 173933670, 4212643690, 3211816939, 3340831289, 3408256587, 2688398583, 1910881984},
				A:   [7]uint32{1550768615, 298026564, 343129830, 3499432405, 1536457232, 4058646899, 3359705360},
				PC:  10134660,
				SR:  512,
				USP: 12913658,
				SSP: 3223254,
				RAM: [][2]uint32{{10134654, 195}, {10134655, 225}, {10134656, 255}, {10134657, 243}, {12813892, 212}, {12813893, 229}, {10134658, 118}, {10134659, 204}},
				Cycles: 0,
			},
		},
		{
			name: "1414 MULS D4, D6 cdc4",
			init: 			cpuState{
				D:   [8]uint32{2754989477, 1909279535, 2284216340, 887494283, 3609010554, 2586254921, 2084306793, 1199011687},
				A:   [7]uint32{70550179, 3183510779, 2836351969, 1059744460, 3624016026, 3134132629, 951093579},
				PC:  12849322,
				SR:  9226,
				USP: 15058286,
				SSP: 14479516,
				RAM: [][2]uint32{{12849318, 205}, {12849319, 196}, {12849320, 112}, {12849321, 180}, {12849322, 4}, {12849323, 193}},
			},
			want: 			cpuState{
				D:   [8]uint32{2754989477, 1909279535, 2284216340, 887494283, 3609010554, 2586254921, 4293673226, 1199011687},
				A:   [7]uint32{70550179, 3183510779, 2836351969, 1059744460, 3624016026, 3134132629, 951093579},
				PC:  12849324,
				SR:  9224,
				USP: 15058286,
				SSP: 14479516,
				RAM: [][2]uint32{{12849318, 205}, {12849319, 196}, {12849320, 112}, {12849321, 180}, {12849322, 4}, {12849323, 193}},
				Cycles: 0,
			},
		},
		{
			name: "1687 MULS (A7), D2 c5d7",
			init: 			cpuState{
				D:   [8]uint32{3082352873, 2809886002, 1442818560, 1586175241, 3461811096, 2146831063, 2932078163, 3889503082},
				A:   [7]uint32{3337071590, 2539969577, 896143511, 60962697, 2628812020, 2561245121, 3477317671},
				PC:  15111902,
				SR:  1032,
				USP: 11235470,
				SSP: 2172268,
				RAM: [][2]uint32{{15111898, 197}, {15111899, 215}, {15111900, 206}, {15111901, 171}, {11235470, 53}, {11235471, 137}, {15111902, 21}, {15111903, 157}},
			},
			want: 			cpuState{
				D:   [8]uint32{3082352873, 2809886002, 3993238016, 1586175241, 3461811096, 2146831063, 2932078163, 3889503082},
				A:   [7]uint32{3337071590, 2539969577, 896143511, 60962697, 2628812020, 2561245121, 3477317671},
				PC:  15111904,
				SR:  1032,
				USP: 11235470,
				SSP: 2172268,
				RAM: [][2]uint32{{15111898, 197}, {15111899, 215}, {15111900, 206}, {15111901, 171}, {11235470, 53}, {11235471, 137}, {15111902, 21}, {15111903, 157}},
				Cycles: 0,
			},
		},
		{
			name: "1982 MULS (A7)+, D1 c3df",
			init: 			cpuState{
				D:   [8]uint32{1277580657, 525592875, 2422841092, 2846591942, 2864250918, 2941737529, 1518601792, 3019296689},
				A:   [7]uint32{1637225739, 3427474566, 88387751, 2538747482, 681505347, 3894286141, 3443232445},
				PC:  4240462,
				SR:  1553,
				USP: 13370022,
				SSP: 10789460,
				RAM: [][2]uint32{{4240458, 195}, {4240459, 223}, {4240460, 211}, {4240461, 62}, {13370022, 214}, {13370023, 193}, {4240462, 188}, {4240463, 25}},
			},
			want: 			cpuState{
				D:   [8]uint32{1277580657, 61717355, 2422841092, 2846591942, 2864250918, 2941737529, 1518601792, 3019296689},
				A:   [7]uint32{1637225739, 3427474566, 88387751, 2538747482, 681505347, 3894286141, 3443232445},
				PC:  4240464,
				SR:  1552,
				USP: 13370024,
				SSP: 10789460,
				RAM: [][2]uint32{{4240458, 195}, {4240459, 223}, {4240460, 211}, {4240461, 62}, {13370022, 214}, {13370023, 193}, {4240462, 188}, {4240463, 25}},
				Cycles: 0,
			},
		},
		{
			name: "2250 MULS D3, D3 c7c3",
			init: 			cpuState{
				D:   [8]uint32{2357597878, 619510060, 3656257985, 414463482, 1704356843, 1689437189, 4078472249, 3568200961},
				A:   [7]uint32{1391848785, 1168539177, 800385298, 3377302111, 3534845785, 2423911273, 388534994},
				PC:  15309170,
				SR:  1026,
				USP: 5049728,
				SSP: 916254,
				RAM: [][2]uint32{{15309166, 199}, {15309167, 195}, {15309168, 103}, {15309169, 32}, {15309170, 209}, {15309171, 200}},
			},
			want: 			cpuState{
				D:   [8]uint32{2357597878, 619510060, 3656257985, 190937124, 1704356843, 1689437189, 4078472249, 3568200961},
				A:   [7]uint32{1391848785, 1168539177, 800385298, 3377302111, 3534845785, 2423911273, 388534994},
				PC:  15309172,
				SR:  1024,
				USP: 5049728,
				SSP: 916254,
				RAM: [][2]uint32{{15309166, 199}, {15309167, 195}, {15309168, 103}, {15309169, 32}, {15309170, 209}, {15309171, 200}},
				Cycles: 0,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestDIVU(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 DIVU (xxx).l, D4 88f9",
			init: cpuState{
				D:   [8]uint32{851875928, 3326892796, 3873463131, 1757372564, 3594990973, 3869244608, 1245250439, 1267479684},
				A:   [7]uint32{1311392589, 1906478983, 557940564, 4217376967, 2321827578, 133874346, 2055113439},
				PC:  7822936,
				SR:  8712,
				USP: 2144018,
				SSP: 4103512,
				RAM: [][2]uint32{{7822932, 136}, {7822933, 249}, {7822934, 123}, {7822935, 151}, {7822936, 142}, {7822937, 194}, {7822938, 61}, {7822939, 93}, {9932482, 115}, {9932483, 216}, {7822940, 11}, {7822941, 53}},
			},
			want: cpuState{
				D:   [8]uint32{851875928, 3326892796, 3873463131, 1757372564, 3594990973, 3869244608, 1245250439, 1267479684},
				A:   [7]uint32{1311392589, 1906478983, 557940564, 4217376967, 2321827578, 133874346, 2055113439},
				PC:  7822942,
				SR:  8714,
				USP: 2144018,
				SSP: 4103512,
				RAM: [][2]uint32{{7822932, 136}, {7822933, 249}, {7822934, 123}, {7822935, 151}, {7822936, 142}, {7822937, 194}, {7822938, 61}, {7822939, 93}, {9932482, 115}, {9932483, 216}, {7822940, 11}, {7822941, 53}},
				// DIVU: uses flat worst-case 140 cycles (real range 76-140).
				// Cycles: 22,
			},
		},
		{
			name: "500 DIVU (A1)+, D5 8ad9",
			init: cpuState{
				D:   [8]uint32{2875726544, 3909222798, 1463529590, 1958708671, 2129862750, 1126164708, 2838606430, 1472630705},
				A:   [7]uint32{3437469760, 238558146, 4166014496, 40557750, 268931461, 1288885616, 2910876823},
				PC:  10731880,
				SR:  33546,
				USP: 14436168,
				SSP: 12846300,
				RAM: [][2]uint32{{10731876, 138}, {10731877, 217}, {10731878, 101}, {10731879, 14}, {3677122, 154}, {3677123, 240}, {10731880, 229}, {10731881, 151}},
			},
			want: cpuState{
				D:   [8]uint32{2875726544, 3909222798, 1463529590, 1958708671, 2129862750, 1600417512, 2838606430, 1472630705},
				A:   [7]uint32{3437469760, 238558148, 4166014496, 40557750, 268931461, 1288885616, 2910876823},
				PC:  10731882,
				SR:  33536,
				USP: 14436168,
				SSP: 12846300,
				RAM: [][2]uint32{{10731876, 138}, {10731877, 217}, {10731878, 101}, {10731879, 14}, {3677122, 154}, {3677123, 240}, {10731880, 229}, {10731881, 151}},
				// DIVU: uses flat worst-case 140 cycles (real range 76-140).
				// Cycles: 114,
			},
		},
		{
			name: "1000 DIVU (A6)+, D6 8cde",
			init: cpuState{
				D:   [8]uint32{3834880392, 129793522, 1395288021, 74557267, 3782152033, 4222315986, 326548149, 352547979},
				A:   [7]uint32{3766499185, 1593713367, 3608282384, 4288771288, 2571080414, 2229585658, 263275133},
				PC:  9890412,
				SR:  8733,
				USP: 5114318,
				SSP: 7162290,
				RAM: [][2]uint32{{9890408, 140}, {9890409, 222}, {9890410, 91}, {9890411, 199}, {12, 215}, {13, 72}, {14, 104}, {15, 154}, {4745370, 237}, {4745371, 60}, {4745372, 96}, {4745373, 170}},
			},
			want: cpuState{
				D:      [8]uint32{3834880392, 129793522, 1395288021, 74557267, 3782152033, 4222315986, 326548149, 352547979},
				A:      [7]uint32{3766499185, 1593713367, 3608282384, 4288771288, 2571080414, 2229585658, 263275135},
				PC:     3611846814,
				SR:     8733,
				USP:    5114318,
				SSP:    7162276,
				RAM:    [][2]uint32{{9890408, 140}, {9890409, 222}, {9890410, 91}, {9890411, 199}, {7162288, 234}, {7162289, 106}, {7162284, 34}, {7162285, 29}, {7162286, 0}, {7162287, 150}, {7162282, 140}, {7162283, 222}, {7162280, 66}, {7162281, 125}, {7162276, 140}, {7162277, 213}, {7162278, 15}, {7162279, 177}, {12, 215}, {13, 72}, {14, 104}, {15, 154}, {4745370, 237}, {4745371, 60}, {4745372, 96}, {4745373, 170}},
				Halted: true,
			},
		},
		{
			name: "1500 DIVU (A1), D1 82d1",
			init: cpuState{
				D:   [8]uint32{1131935187, 2967760831, 3107902653, 2388280997, 4053163231, 3090168194, 3223175447, 2391423524},
				A:   [7]uint32{2775753798, 2091270239, 879934419, 2666592742, 4506931, 1945308521, 422319434},
				PC:  819074,
				SR:  533,
				USP: 2463218,
				SSP: 16327346,
				RAM: [][2]uint32{{819070, 130}, {819071, 209}, {819072, 45}, {819073, 231}, {12, 22}, {13, 210}, {14, 49}, {15, 210}, {13775314, 6}, {13775315, 81}, {13775316, 135}, {13775317, 237}},
			},
			want: cpuState{
				D:      [8]uint32{1131935187, 2967760831, 3107902653, 2388280997, 4053163231, 3090168194, 3223175447, 2391423524},
				A:      [7]uint32{2775753798, 2091270239, 879934419, 2666592742, 4506931, 1945308521, 422319434},
				PC:     382874070,
				SR:     8725,
				USP:    2463218,
				SSP:    16327332,
				RAM:    [][2]uint32{{819070, 130}, {819071, 209}, {819072, 45}, {819073, 231}, {16327344, 127}, {16327345, 128}, {16327340, 2}, {16327341, 21}, {16327342, 0}, {16327343, 12}, {16327338, 130}, {16327339, 209}, {16327336, 64}, {16327337, 95}, {16327332, 130}, {16327333, 209}, {16327334, 124}, {16327335, 166}, {12, 22}, {13, 210}, {14, 49}, {15, 210}, {13775314, 6}, {13775315, 81}, {13775316, 135}, {13775317, 237}},
				Halted: true,
			},
		},
		{
			name: "2000 DIVU (d16, A1), D0 80e9",
			init: cpuState{
				D:   [8]uint32{2573467237, 3026339520, 4094927323, 3437714138, 3760626698, 2874405135, 3138198561, 2290507765},
				A:   [7]uint32{1340680993, 1499019, 1526447768, 1580288638, 3229236120, 529531783, 3686956147},
				PC:  14913576,
				SR:  8983,
				USP: 2511940,
				SSP: 4898976,
				RAM: [][2]uint32{{14913572, 128}, {14913573, 233}, {14913574, 198}, {14913575, 76}, {14913576, 136}, {14913577, 34}, {12, 233}, {13, 46}, {14, 225}, {15, 212}, {3072468, 147}, {3072469, 9}, {3072470, 123}, {3072471, 217}},
			},
			want: cpuState{
				D:      [8]uint32{2573467237, 3026339520, 4094927323, 3437714138, 3760626698, 2874405135, 3138198561, 2290507765},
				A:      [7]uint32{1340680993, 1499019, 1526447768, 1580288638, 3229236120, 529531783, 3686956147},
				PC:     3912163800,
				SR:     8983,
				USP:    2511940,
				SSP:    4898962,
				RAM:    [][2]uint32{{14913572, 128}, {14913573, 233}, {14913574, 198}, {14913575, 76}, {14913576, 136}, {14913577, 34}, {4898974, 144}, {4898975, 38}, {4898970, 35}, {4898971, 23}, {4898972, 0}, {4898973, 227}, {4898968, 128}, {4898969, 233}, {4898966, 165}, {4898967, 215}, {4898962, 128}, {4898963, 245}, {4898964, 0}, {4898965, 22}, {12, 233}, {13, 46}, {14, 225}, {15, 212}, {3072468, 147}, {3072469, 9}, {3072470, 123}, {3072471, 217}},
				Halted: true,
			},
		},
		{
			name: "002 DIVU (d16, A2), D5 8aea",
			init: 			cpuState{
				D:   [8]uint32{2951521726, 2575853730, 792104566, 2044710209, 2015777966, 1938728211, 4213962660, 2464927978},
				A:   [7]uint32{1976222876, 3810927986, 2512945711, 1964836953, 1724795965, 1249280116, 2016526301},
				PC:  675248,
				SR:  8978,
				USP: 5246360,
				SSP: 9042904,
				RAM: [][2]uint32{{675244, 138}, {675245, 234}, {675246, 225}, {675247, 239}, {675248, 78}, {675249, 83}, {13132830, 64}, {13132831, 12}, {675250, 226}, {675251, 177}},
			},
			want: 			cpuState{
				D:   [8]uint32{2951521726, 2575853730, 792104566, 2044710209, 2015777966, 1938728211, 4213962660, 2464927978},
				A:   [7]uint32{1976222876, 3810927986, 2512945711, 1964836953, 1724795965, 1249280116, 2016526301},
				PC:  675252,
				SR:  8986,
				USP: 5246360,
				SSP: 9042904,
				RAM: [][2]uint32{{675244, 138}, {675245, 234}, {675246, 225}, {675247, 239}, {675248, 78}, {675249, 83}, {13132830, 64}, {13132831, 12}, {675250, 226}, {675251, 177}},
				Cycles: 0,
			},
		},
		{
			name: "252 DIVU D5, D3 86c5",
			init: 			cpuState{
				D:   [8]uint32{38973529, 2224701525, 1385820557, 3428219619, 1813970817, 988546078, 3596615273, 1782464101},
				A:   [7]uint32{1402381269, 3322527696, 528869594, 3080876, 357855039, 4044700770, 2445631790},
				PC:  3523682,
				SR:  1307,
				USP: 16055192,
				SSP: 10192524,
				RAM: [][2]uint32{{3523678, 134}, {3523679, 197}, {3523680, 205}, {3523681, 85}, {3523682, 95}, {3523683, 34}},
			},
			want: 			cpuState{
				D:   [8]uint32{38973529, 2224701525, 1385820557, 3428219619, 1813970817, 988546078, 3596615273, 1782464101},
				A:   [7]uint32{1402381269, 3322527696, 528869594, 3080876, 357855039, 4044700770, 2445631790},
				PC:  3523684,
				SR:  1306,
				USP: 16055192,
				SSP: 10192524,
				RAM: [][2]uint32{{3523678, 134}, {3523679, 197}, {3523680, 205}, {3523681, 85}, {3523682, 95}, {3523683, 34}},
				Cycles: 0,
			},
		},
		{
			name: "566 DIVU (d16, A5), D3 86ed",
			init: 			cpuState{
				D:   [8]uint32{953549213, 3879174727, 569762846, 1001092947, 3422924464, 1166060490, 3474281179, 2829062634},
				A:   [7]uint32{4132329105, 1425110469, 3384337146, 710180110, 492660605, 3144095748, 90439551},
				PC:  8025108,
				SR:  1540,
				USP: 13908086,
				SSP: 10417910,
				RAM: [][2]uint32{{8025104, 134}, {8025105, 237}, {8025106, 218}, {8025107, 176}, {8025108, 230}, {8025109, 80}, {6746804, 62}, {6746805, 53}, {8025110, 214}, {8025111, 254}},
			},
			want: 			cpuState{
				D:   [8]uint32{953549213, 3879174727, 569762846, 1022227854, 3422924464, 1166060490, 3474281179, 2829062634},
				A:   [7]uint32{4132329105, 1425110469, 3384337146, 710180110, 492660605, 3144095748, 90439551},
				PC:  8025112,
				SR:  1544,
				USP: 13908086,
				SSP: 10417910,
				RAM: [][2]uint32{{8025104, 134}, {8025105, 237}, {8025106, 218}, {8025107, 176}, {8025108, 230}, {8025109, 80}, {6746804, 62}, {6746805, 53}, {8025110, 214}, {8025111, 254}},
				Cycles: 0,
			},
		},
		{
			name: "840 DIVU D6, D1 82c6",
			init: 			cpuState{
				D:   [8]uint32{1814718144, 1290803072, 447681634, 1086683764, 2447479273, 540542481, 3154215622, 2950789885},
				A:   [7]uint32{860554762, 2110242959, 2749509341, 3404495344, 1653960039, 1572369048, 2873597818},
				PC:  9558346,
				SR:  262,
				USP: 10618278,
				SSP: 13149478,
				RAM: [][2]uint32{{9558342, 130}, {9558343, 198}, {9558344, 205}, {9558345, 230}, {9558346, 119}, {9558347, 166}},
			},
			want: 			cpuState{
				D:   [8]uint32{1814718144, 1658361500, 447681634, 1086683764, 2447479273, 540542481, 3154215622, 2950789885},
				A:   [7]uint32{860554762, 2110242959, 2749509341, 3404495344, 1653960039, 1572369048, 2873597818},
				PC:  9558348,
				SR:  264,
				USP: 10618278,
				SSP: 13149478,
				RAM: [][2]uint32{{9558342, 130}, {9558343, 198}, {9558344, 205}, {9558345, 230}, {9558346, 119}, {9558347, 166}},
				Cycles: 0,
			},
		},
		{
			name: "1122 DIVU (A4), D7 8ed4",
			init: 			cpuState{
				D:   [8]uint32{3049225143, 1136049290, 3329043023, 650207261, 594616652, 583483802, 72873214, 1173056619},
				A:   [7]uint32{836302001, 77486108, 3673499964, 189809599, 2759180386, 1500185565, 494002478},
				PC:  9683606,
				SR:  540,
				USP: 14418118,
				SSP: 12396952,
				RAM: [][2]uint32{{9683602, 142}, {9683603, 212}, {9683604, 206}, {9683605, 134}, {7716962, 89}, {7716963, 87}, {9683606, 224}, {9683607, 249}},
			},
			want: 			cpuState{
				D:   [8]uint32{3049225143, 1136049290, 3329043023, 650207261, 594616652, 583483802, 72873214, 198559834},
				A:   [7]uint32{836302001, 77486108, 3673499964, 189809599, 2759180386, 1500185565, 494002478},
				PC:  9683608,
				SR:  536,
				USP: 14418118,
				SSP: 12396952,
				RAM: [][2]uint32{{9683602, 142}, {9683603, 212}, {9683604, 206}, {9683605, 134}, {7716962, 89}, {7716963, 87}, {9683606, 224}, {9683607, 249}},
				Cycles: 0,
			},
		},
		{
			name: "1434 DIVU D7, D3 86c7",
			init: 			cpuState{
				D:   [8]uint32{1109885209, 727524907, 3848638135, 735954802, 248605936, 2236460153, 2388995414, 3096908276},
				A:   [7]uint32{2210408631, 3122298673, 4190090952, 1528513497, 601250569, 3540365537, 1043578444},
				PC:  5710496,
				SR:  280,
				USP: 3972872,
				SSP: 5665262,
				RAM: [][2]uint32{{5710492, 134}, {5710493, 199}, {5710494, 134}, {5710495, 178}, {5710496, 66}, {5710497, 146}},
			},
			want: 			cpuState{
				D:   [8]uint32{1109885209, 727524907, 3848638135, 735954802, 248605936, 2236460153, 2388995414, 3096908276},
				A:   [7]uint32{2210408631, 3122298673, 4190090952, 1528513497, 601250569, 3540365537, 1043578444},
				PC:  5710498,
				SR:  282,
				USP: 3972872,
				SSP: 5665262,
				RAM: [][2]uint32{{5710492, 134}, {5710493, 199}, {5710494, 134}, {5710495, 178}, {5710496, 66}, {5710497, 146}},
				Cycles: 0,
			},
		},
		{
			name: "1699 DIVU D4, D1 82c4",
			init: 			cpuState{
				D:   [8]uint32{2419627234, 2762527268, 3871591434, 1760906644, 681960111, 1824155517, 1700836832, 2345717098},
				A:   [7]uint32{1314742439, 3013752449, 2178332558, 2378293117, 2116766920, 3631067396, 763781988},
				PC:  7408970,
				SR:  25,
				USP: 9586272,
				SSP: 1652842,
				RAM: [][2]uint32{{7408966, 130}, {7408967, 196}, {7408968, 200}, {7408969, 39}, {7408970, 237}, {7408971, 8}},
			},
			want: 			cpuState{
				D:   [8]uint32{2419627234, 1280883188, 3871591434, 1760906644, 681960111, 1824155517, 1700836832, 2345717098},
				A:   [7]uint32{1314742439, 3013752449, 2178332558, 2378293117, 2116766920, 3631067396, 763781988},
				PC:  7408972,
				SR:  24,
				USP: 9586272,
				SSP: 1652842,
				RAM: [][2]uint32{{7408966, 130}, {7408967, 196}, {7408968, 200}, {7408969, 39}, {7408970, 237}, {7408971, 8}},
				Cycles: 0,
			},
		},
		{
			name: "1992 DIVU (d8, A1, Xn), D0 80f1",
			init: 			cpuState{
				D:   [8]uint32{3660613146, 812141079, 1831623278, 4147985785, 1538624394, 595916912, 2520502409, 1445395733},
				A:   [7]uint32{1542767354, 2719691769, 2368238667, 1273958722, 1458952325, 2084481937, 2292451044},
				PC:  503118,
				SR:  18,
				USP: 14401436,
				SSP: 7739576,
				RAM: [][2]uint32{{503114, 128}, {503115, 241}, {503116, 3}, {503117, 83}, {503118, 15}, {503119, 128}, {1751654, 214}, {1751655, 2}, {503120, 33}, {503121, 23}},
			},
			want: 			cpuState{
				D:   [8]uint32{3660613146, 812141079, 1831623278, 4147985785, 1538624394, 595916912, 2520502409, 1445395733},
				A:   [7]uint32{1542767354, 2719691769, 2368238667, 1273958722, 1458952325, 2084481937, 2292451044},
				PC:  503122,
				SR:  26,
				USP: 14401436,
				SSP: 7739576,
				RAM: [][2]uint32{{503114, 128}, {503115, 241}, {503116, 3}, {503117, 83}, {503118, 15}, {503119, 128}, {1751654, 214}, {1751655, 2}, {503120, 33}, {503121, 23}},
				Cycles: 0,
			},
		},
		{
			name: "2232 DIVU (d8, A0, Xn), D5 8af0",
			init: 			cpuState{
				D:   [8]uint32{1384529820, 3032412244, 2356513682, 583822786, 2037617415, 2955792315, 1849699340, 166217162},
				A:   [7]uint32{2485071488, 1702887057, 1771415138, 112042919, 3441602088, 4019865665, 1510488557},
				PC:  3782318,
				SR:  9218,
				USP: 1180292,
				SSP: 9144790,
				RAM: [][2]uint32{{3782314, 138}, {3782315, 240}, {3782316, 237}, {3782317, 99}, {3782318, 76}, {3782319, 233}, {2582736, 252}, {2582737, 93}, {3782320, 247}, {3782321, 108}},
			},
			want: 			cpuState{
				D:   [8]uint32{1384529820, 3032412244, 2356513682, 583822786, 2037617415, 3208688311, 1849699340, 166217162},
				A:   [7]uint32{2485071488, 1702887057, 1771415138, 112042919, 3441602088, 4019865665, 1510488557},
				PC:  3782322,
				SR:  9224,
				USP: 1180292,
				SSP: 9144790,
				RAM: [][2]uint32{{3782314, 138}, {3782315, 240}, {3782316, 237}, {3782317, 99}, {3782318, 76}, {3782319, 233}, {2582736, 252}, {2582737, 93}, {3782320, 247}, {3782321, 108}},
				Cycles: 0,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestDIVS(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 DIVS (d8, A5, Xn), D3 87f5",
			init: cpuState{
				D:   [8]uint32{29756972, 616991612, 1976999711, 1678834343, 612027647, 4184950574, 3466407835, 1066071521},
				A:   [7]uint32{2537772812, 2955085712, 610031400, 2987339094, 923989849, 2054121622, 2621212741},
				PC:  1031504,
				SR:  42761,
				USP: 7062182,
				SSP: 3341948,
				RAM: [][2]uint32{{1031500, 135}, {1031501, 245}, {1031502, 7}, {1031503, 251}, {1031504, 108}, {1031505, 133}, {12, 220}, {13, 50}, {14, 58}, {15, 120}, {3291768, 113}, {3291769, 38}, {3291770, 26}, {3291771, 106}},
			},
			want: cpuState{
				D:      [8]uint32{29756972, 616991612, 1976999711, 1678834343, 612027647, 4184950574, 3466407835, 1066071521},
				A:      [7]uint32{2537772812, 2955085712, 610031400, 2987339094, 923989849, 2054121622, 2621212741},
				PC:     3694279292,
				SR:     9993,
				USP:    7062182,
				SSP:    3341934,
				RAM:    [][2]uint32{{1031500, 135}, {1031501, 245}, {1031502, 7}, {1031503, 251}, {1031504, 108}, {1031505, 133}, {3341946, 189}, {3341947, 78}, {3341942, 167}, {3341943, 9}, {3341944, 0}, {3341945, 15}, {3341940, 135}, {3341941, 245}, {3341938, 118}, {3341939, 189}, {3341934, 135}, {3341935, 245}, {3341936, 122}, {3341937, 111}, {12, 220}, {13, 50}, {14, 58}, {15, 120}, {3291768, 113}, {3291769, 38}, {3291770, 26}, {3291771, 106}},
				Halted: true,
			},
		},
		{
			name: "500 DIVS (d8, A3, Xn), D0 81f3",
			init: cpuState{
				D:   [8]uint32{3995915321, 553520025, 206943654, 3165326492, 3550810973, 4018946453, 249052858, 983860650},
				A:   [7]uint32{1414792790, 4286187463, 3643521646, 1173483425, 2582455143, 2245589733, 3801426438},
				PC:  5078722,
				SR:  33033,
				USP: 6621918,
				SSP: 15205072,
				RAM: [][2]uint32{{5078718, 129}, {5078719, 243}, {5078720, 236}, {5078721, 1}, {5078722, 73}, {5078723, 30}, {8853928, 112}, {8853929, 208}, {5078724, 192}, {5078725, 186}},
			},
			want: cpuState{
				D:   [8]uint32{2430195598, 553520025, 206943654, 3165326492, 3550810973, 4018946453, 249052858, 983860650},
				A:   [7]uint32{1414792790, 4286187463, 3643521646, 1173483425, 2582455143, 2245589733, 3801426438},
				PC:  5078726,
				SR:  33032,
				USP: 6621918,
				SSP: 15205072,
				RAM: [][2]uint32{{5078718, 129}, {5078719, 243}, {5078720, 236}, {5078721, 1}, {5078722, 73}, {5078723, 30}, {8853928, 112}, {8853929, 208}, {5078724, 192}, {5078725, 186}},
				// DIVS: uses flat worst-case 158 cycles (real range 120-158).
				// Cycles: 154,
			},
		},
		{
			name: "1000 DIVS (d16, A5), D0 81ed",
			init: cpuState{
				D:   [8]uint32{1140547528, 3945238508, 911961796, 2286671031, 2910261111, 2633603275, 4183104995, 2747525250},
				A:   [7]uint32{3262756970, 2864873974, 141573598, 1606328851, 2468185197, 2079355363, 2970406466},
				PC:  8689642,
				SR:  1037,
				USP: 8752324,
				SSP: 985666,
				RAM: [][2]uint32{{8689638, 129}, {8689639, 237}, {8689640, 50}, {8689641, 137}, {8689642, 246}, {8689643, 7}, {15770732, 236}, {15770733, 167}, {8689644, 167}, {8689645, 224}},
			},
			want: cpuState{
				D:   [8]uint32{1140547528, 3945238508, 911961796, 2286671031, 2910261111, 2633603275, 4183104995, 2747525250},
				A:   [7]uint32{3262756970, 2864873974, 141573598, 1606328851, 2468185197, 2079355363, 2970406466},
				PC:  8689646,
				SR:  1034,
				USP: 8752324,
				SSP: 985666,
				RAM: [][2]uint32{{8689638, 129}, {8689639, 237}, {8689640, 50}, {8689641, 137}, {8689642, 246}, {8689643, 7}, {15770732, 236}, {15770733, 167}, {8689644, 167}, {8689645, 224}},
				// DIVS: uses flat worst-case 158 cycles (real range 120-158).
				// Cycles: 24,
			},
		},
		{
			name: "1500 DIVS (d16, A0), D1 83e8",
			init: cpuState{
				D:   [8]uint32{3455805657, 3979762557, 26397384, 3452840719, 2888931481, 977527031, 3078193129, 768169947},
				A:   [7]uint32{2304857202, 2116751071, 2503783967, 3736252680, 4038767710, 2446533077, 2827146597},
				PC:  2024984,
				SR:  40981,
				USP: 4313356,
				SSP: 1473638,
				RAM: [][2]uint32{{2024980, 131}, {2024981, 232}, {2024982, 159}, {2024983, 248}, {2024984, 231}, {2024985, 253}, {6354026, 232}, {6354027, 146}, {2024986, 236}, {2024987, 86}},
			},
			want: cpuState{
				D:   [8]uint32{3455805657, 3979762557, 26397384, 3452840719, 2888931481, 977527031, 3078193129, 768169947},
				A:   [7]uint32{2304857202, 2116751071, 2503783967, 3736252680, 4038767710, 2446533077, 2827146597},
				PC:  2024988,
				SR:  40986,
				USP: 4313356,
				SSP: 1473638,
				RAM: [][2]uint32{{2024980, 131}, {2024981, 232}, {2024982, 159}, {2024983, 248}, {2024984, 231}, {2024985, 253}, {6354026, 232}, {6354027, 146}, {2024986, 236}, {2024987, 86}},
				// DIVS: uses flat worst-case 158 cycles (real range 120-158).
				// Cycles: 146,
			},
		},
		{
			name: "2000 DIVS D3, D2 85c3",
			init: cpuState{
				D:   [8]uint32{3864652131, 4018289350, 1746872504, 1569775634, 1930582046, 2901171047, 950435295, 1846188894},
				A:   [7]uint32{4037778918, 394480229, 1588205379, 2817207162, 1556542572, 1087663718, 2056948104},
				PC:  904396,
				SR:  33311,
				USP: 4975052,
				SSP: 16282624,
				RAM: [][2]uint32{{904392, 133}, {904393, 195}, {904394, 99}, {904395, 20}, {904396, 176}, {904397, 212}},
			},
			want: cpuState{
				D:   [8]uint32{3864652131, 4018289350, 1746872504, 1569775634, 1930582046, 2901171047, 950435295, 1846188894},
				A:   [7]uint32{4037778918, 394480229, 1588205379, 2817207162, 1556542572, 1087663718, 2056948104},
				PC:  904398,
				SR:  33306,
				USP: 4975052,
				SSP: 16282624,
				RAM: [][2]uint32{{904392, 133}, {904393, 195}, {904394, 99}, {904395, 20}, {904396, 176}, {904397, 212}},
				// DIVS: uses flat worst-case 158 cycles (real range 120-158).
				// Cycles: 16,
			},
		},
		{
			name: "004 DIVS -(A3), D0 81e3",
			init: 			cpuState{
				D:   [8]uint32{1638657705, 1410559313, 722737389, 2933652320, 3805186707, 1911386333, 1223216715, 339701469},
				A:   [7]uint32{4060669414, 2926818730, 2876044521, 1061928316, 2305678651, 2521729636, 4271869442},
				PC:  10092102,
				SR:  1565,
				USP: 13533150,
				SSP: 6411516,
				RAM: [][2]uint32{{10092098, 129}, {10092099, 227}, {10092100, 43}, {10092101, 240}, {4963706, 116}, {4963707, 86}, {10092102, 58}, {10092103, 184}},
			},
			want: 			cpuState{
				D:   [8]uint32{1638657705, 1410559313, 722737389, 2933652320, 3805186707, 1911386333, 1223216715, 339701469},
				A:   [7]uint32{4060669414, 2926818730, 2876044521, 1061928314, 2305678651, 2521729636, 4271869442},
				PC:  10092104,
				SR:  1562,
				USP: 13533150,
				SSP: 6411516,
				RAM: [][2]uint32{{10092098, 129}, {10092099, 227}, {10092100, 43}, {10092101, 240}, {4963706, 116}, {4963707, 86}, {10092102, 58}, {10092103, 184}},
				Cycles: 0,
			},
		},
		{
			name: "237 DIVS (d16, A5), D1 83ed",
			init: 			cpuState{
				D:   [8]uint32{1472680322, 1571352773, 1646705597, 175161418, 918563320, 2283486639, 43127368, 2156139745},
				A:   [7]uint32{1802133481, 3641706480, 1883240973, 3454699258, 660059537, 2046189104, 708171013},
				PC:  6937402,
				SR:  520,
				USP: 11501254,
				SSP: 9815070,
				RAM: [][2]uint32{{6937398, 131}, {6937399, 237}, {6937400, 62}, {6937401, 202}, {6937402, 139}, {6937403, 19}, {16162042, 111}, {16162043, 60}, {6937404, 89}, {6937405, 223}},
			},
			want: 			cpuState{
				D:   [8]uint32{1472680322, 1571352773, 1646705597, 175161418, 918563320, 2283486639, 43127368, 2156139745},
				A:   [7]uint32{1802133481, 3641706480, 1883240973, 3454699258, 660059537, 2046189104, 708171013},
				PC:  6937406,
				SR:  522,
				USP: 11501254,
				SSP: 9815070,
				RAM: [][2]uint32{{6937398, 131}, {6937399, 237}, {6937400, 62}, {6937401, 202}, {6937402, 139}, {6937403, 19}, {16162042, 111}, {16162043, 60}, {6937404, 89}, {6937405, 223}},
				Cycles: 0,
			},
		},
		{
			name: "530 DIVS (d16, A3), D0 81eb",
			init: 			cpuState{
				D:   [8]uint32{4245152870, 2305148483, 2840026336, 4082130591, 1687292468, 3028669271, 4102236150, 2047742477},
				A:   [7]uint32{1437614831, 1543467162, 1154710129, 3746718484, 3688514608, 1525381403, 3583368665},
				PC:  8308926,
				SR:  8975,
				USP: 7524626,
				SSP: 2928040,
				RAM: [][2]uint32{{8308922, 129}, {8308923, 235}, {8308924, 241}, {8308925, 228}, {8308926, 155}, {8308927, 67}, {5395704, 250}, {5395705, 238}, {8308928, 176}, {8308929, 50}},
			},
			want: 			cpuState{
				D:   [8]uint32{4245152870, 2305148483, 2840026336, 4082130591, 1687292468, 3028669271, 4102236150, 2047742477},
				A:   [7]uint32{1437614831, 1543467162, 1154710129, 3746718484, 3688514608, 1525381403, 3583368665},
				PC:  8308930,
				SR:  8970,
				USP: 7524626,
				SSP: 2928040,
				RAM: [][2]uint32{{8308922, 129}, {8308923, 235}, {8308924, 241}, {8308925, 228}, {8308926, 155}, {8308927, 67}, {5395704, 250}, {5395705, 238}, {8308928, 176}, {8308929, 50}},
				Cycles: 0,
			},
		},
		{
			name: "860 DIVS (A6)+, D3 87de",
			init: 			cpuState{
				D:   [8]uint32{859754033, 247825463, 1713241615, 1878761854, 2188523608, 1260317194, 3756788079, 869837797},
				A:   [7]uint32{4012065247, 3606184631, 1113647670, 1689282448, 74759629, 1740917027, 3439303096},
				PC:  10752890,
				SR:  8451,
				USP: 7847154,
				SSP: 10282490,
				RAM: [][2]uint32{{10752886, 135}, {10752887, 222}, {10752888, 77}, {10752889, 221}, {16751032, 145}, {16751033, 134}, {10752890, 32}, {10752891, 134}},
			},
			want: 			cpuState{
				D:   [8]uint32{859754033, 247825463, 1713241615, 1878761854, 2188523608, 1260317194, 3756788079, 869837797},
				A:   [7]uint32{4012065247, 3606184631, 1113647670, 1689282448, 74759629, 1740917027, 3439303098},
				PC:  10752892,
				SR:  8458,
				USP: 7847154,
				SSP: 10282490,
				RAM: [][2]uint32{{10752886, 135}, {10752887, 222}, {10752888, 77}, {10752889, 221}, {16751032, 145}, {16751033, 134}, {10752890, 32}, {10752891, 134}},
				Cycles: 0,
			},
		},
		{
			name: "1123 DIVS D5, D6 8dc5",
			init: 			cpuState{
				D:   [8]uint32{2024015145, 2809187520, 193281685, 3533680268, 1396168423, 631656860, 3174164143, 914732374},
				A:   [7]uint32{2292092256, 2858318860, 1038648801, 1642846691, 2651363592, 1677417524, 2111968065},
				PC:  3756648,
				SR:  1821,
				USP: 14498120,
				SSP: 7438280,
				RAM: [][2]uint32{{3756644, 141}, {3756645, 197}, {3756646, 238}, {3756647, 155}, {3756648, 182}, {3756649, 6}},
			},
			want: 			cpuState{
				D:   [8]uint32{2024015145, 2809187520, 193281685, 3533680268, 1396168423, 631656860, 3174164143, 914732374},
				A:   [7]uint32{2292092256, 2858318860, 1038648801, 1642846691, 2651363592, 1677417524, 2111968065},
				PC:  3756650,
				SR:  1818,
				USP: 14498120,
				SSP: 7438280,
				RAM: [][2]uint32{{3756644, 141}, {3756645, 197}, {3756646, 238}, {3756647, 155}, {3756648, 182}, {3756649, 6}},
				Cycles: 0,
			},
		},
		{
			name: "1417 DIVS D3, D5 8bc3",
			init: 			cpuState{
				D:   [8]uint32{951174222, 1004497110, 181161989, 307489881, 3023658454, 2275574673, 361134457, 2156331739},
				A:   [7]uint32{819064380, 2318287155, 1950480113, 4086973025, 1471618187, 2762104753, 2399888563},
				PC:  6230946,
				SR:  8990,
				USP: 7351800,
				SSP: 4470394,
				RAM: [][2]uint32{{6230942, 139}, {6230943, 195}, {6230944, 86}, {6230945, 212}, {6230946, 169}, {6230947, 16}},
			},
			want: 			cpuState{
				D:   [8]uint32{951174222, 1004497110, 181161989, 307489881, 3023658454, 2275574673, 361134457, 2156331739},
				A:   [7]uint32{819064380, 2318287155, 1950480113, 4086973025, 1471618187, 2762104753, 2399888563},
				PC:  6230948,
				SR:  8986,
				USP: 7351800,
				SSP: 4470394,
				RAM: [][2]uint32{{6230942, 139}, {6230943, 195}, {6230944, 86}, {6230945, 212}, {6230946, 169}, {6230947, 16}},
				Cycles: 0,
			},
		},
		{
			name: "1700 DIVS -(A1), D2 85e1",
			init: 			cpuState{
				D:   [8]uint32{252808609, 2015958734, 3534892350, 4063004440, 1507697957, 4233279180, 3095442137, 2674404526},
				A:   [7]uint32{1851410432, 3988844968, 1964303200, 1217099036, 139067873, 88207551, 4041592317},
				PC:  10834330,
				SR:  1031,
				USP: 324348,
				SSP: 6317616,
				RAM: [][2]uint32{{10834326, 133}, {10834327, 225}, {10834328, 135}, {10834329, 159}, {12644774, 176}, {12644775, 128}, {10834330, 98}, {10834331, 252}},
			},
			want: 			cpuState{
				D:   [8]uint32{252808609, 2015958734, 3534892350, 4063004440, 1507697957, 4233279180, 3095442137, 2674404526},
				A:   [7]uint32{1851410432, 3988844966, 1964303200, 1217099036, 139067873, 88207551, 4041592317},
				PC:  10834332,
				SR:  1034,
				USP: 324348,
				SSP: 6317616,
				RAM: [][2]uint32{{10834326, 133}, {10834327, 225}, {10834328, 135}, {10834329, 159}, {12644774, 176}, {12644775, 128}, {10834330, 98}, {10834331, 252}},
				Cycles: 0,
			},
		},
		{
			name: "1993 DIVS (d16, PC), D5 8bfa",
			init: 			cpuState{
				D:   [8]uint32{2682110320, 986131952, 2983545976, 2820463802, 646486305, 1854645643, 1138509994, 650368101},
				A:   [7]uint32{830835503, 2380390325, 1289282929, 3934483156, 1310242650, 577962375, 2610230084},
				PC:  14446704,
				SR:  9993,
				USP: 5649498,
				SSP: 2559322,
				RAM: [][2]uint32{{14446700, 139}, {14446701, 250}, {14446702, 66}, {14446703, 254}, {14446704, 231}, {14446705, 52}, {14463852, 132}, {14463853, 110}, {14446706, 82}, {14446707, 158}},
			},
			want: 			cpuState{
				D:   [8]uint32{2682110320, 986131952, 2983545976, 2820463802, 646486305, 1854645643, 1138509994, 650368101},
				A:   [7]uint32{830835503, 2380390325, 1289282929, 3934483156, 1310242650, 577962375, 2610230084},
				PC:  14446708,
				SR:  9994,
				USP: 5649498,
				SSP: 2559322,
				RAM: [][2]uint32{{14446700, 139}, {14446701, 250}, {14446702, 66}, {14446703, 254}, {14446704, 231}, {14446705, 52}, {14463852, 132}, {14463853, 110}, {14446706, 82}, {14446707, 158}},
				Cycles: 0,
			},
		},
		{
			name: "2252 DIVS D1, D0 81c1",
			init: 			cpuState{
				D:   [8]uint32{3907919853, 4056553330, 1530553126, 627848973, 2034909841, 1619438404, 1637929052, 2359735046},
				A:   [7]uint32{1802735501, 3366495725, 2870089766, 2946743447, 2482588116, 2910327879, 2648401170},
				PC:  16484642,
				SR:  270,
				USP: 4368380,
				SSP: 15807298,
				RAM: [][2]uint32{{16484638, 129}, {16484639, 193}, {16484640, 184}, {16484641, 19}, {16484642, 22}, {16484643, 225}},
			},
			want: 			cpuState{
				D:   [8]uint32{3907919853, 4056553330, 1530553126, 627848973, 2034909841, 1619438404, 1637929052, 2359735046},
				A:   [7]uint32{1802735501, 3366495725, 2870089766, 2946743447, 2482588116, 2910327879, 2648401170},
				PC:  16484644,
				SR:  266,
				USP: 4368380,
				SSP: 15807298,
				RAM: [][2]uint32{{16484638, 129}, {16484639, 193}, {16484640, 184}, {16484641, 19}, {16484642, 22}, {16484643, 225}},
				Cycles: 0,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNEG_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NEG.b -(A7) 4427",
			init: cpuState{
				D:   [8]uint32{396198535, 1181930665, 4254672472, 1589792576, 3682259040, 2742747230, 1605057671, 3666742351},
				A:   [7]uint32{3326241225, 1745474568, 2308808067, 618589700, 237322954, 1065187218, 868963597},
				PC:  3464952,
				SR:  8468,
				USP: 6936958,
				SSP: 16215566,
				RAM: [][2]uint32{{3464948, 68}, {3464949, 39}, {3464950, 172}, {3464951, 187}, {16215564, 163}, {16215565, 170}, {3464952, 167}, {3464953, 71}},
			},
			want: cpuState{
				D:   [8]uint32{396198535, 1181930665, 4254672472, 1589792576, 3682259040, 2742747230, 1605057671, 3666742351},
				A:   [7]uint32{3326241225, 1745474568, 2308808067, 618589700, 237322954, 1065187218, 868963597},
				PC:  3464954,
				SR:  8465,
				USP: 6936958,
				SSP: 16215564,
				RAM: [][2]uint32{{3464948, 68}, {3464949, 39}, {3464950, 172}, {3464951, 187}, {16215564, 93}, {16215565, 170}, {3464952, 167}, {3464953, 71}},
				Cycles: 14,
			},
		},
		{
			name: "500 NEG.b D3 4403",
			init: cpuState{
				D:   [8]uint32{4052738919, 2109823174, 2309325061, 1905689638, 2930924339, 1292244688, 1926885157, 2878920677},
				A:   [7]uint32{1762795623, 420605471, 394071882, 3472566300, 63814529, 2402662751, 1809944939},
				PC:  16581962,
				SR:  34575,
				USP: 4653340,
				SSP: 16025210,
				RAM: [][2]uint32{{16581958, 68}, {16581959, 3}, {16581960, 157}, {16581961, 204}, {16581962, 117}, {16581963, 46}},
			},
			want: cpuState{
				D:   [8]uint32{4052738919, 2109823174, 2309325061, 1905689818, 2930924339, 1292244688, 1926885157, 2878920677},
				A:   [7]uint32{1762795623, 420605471, 394071882, 3472566300, 63814529, 2402662751, 1809944939},
				PC:  16581964,
				SR:  34585,
				USP: 4653340,
				SSP: 16025210,
				RAM: [][2]uint32{{16581958, 68}, {16581959, 3}, {16581960, 157}, {16581961, 204}, {16581962, 117}, {16581963, 46}},
				Cycles: 4,
			},
		},
		{
			name: "1000 NEG.b D6 4406",
			init: cpuState{
				D:   [8]uint32{2786115618, 3243187115, 1122253902, 2223062291, 1995878727, 1396728621, 3991122186, 3116227774},
				A:   [7]uint32{3795215193, 1544589005, 2451242365, 1339654275, 1285430270, 1960634620, 225127047},
				PC:  13624918,
				SR:  8975,
				USP: 8890354,
				SSP: 5700712,
				RAM: [][2]uint32{{13624914, 68}, {13624915, 6}, {13624916, 152}, {13624917, 6}, {13624918, 52}, {13624919, 35}},
			},
			want: cpuState{
				D:   [8]uint32{2786115618, 3243187115, 1122253902, 2223062291, 1995878727, 1396728621, 3991122422, 3116227774},
				A:   [7]uint32{3795215193, 1544589005, 2451242365, 1339654275, 1285430270, 1960634620, 225127047},
				PC:  13624920,
				SR:  8985,
				USP: 8890354,
				SSP: 5700712,
				RAM: [][2]uint32{{13624914, 68}, {13624915, 6}, {13624916, 152}, {13624917, 6}, {13624918, 52}, {13624919, 35}},
				Cycles: 4,
			},
		},
		{
			name: "1500 NEG.b (A1) 4411",
			init: cpuState{
				D:   [8]uint32{1742587891, 3019803964, 4213390566, 888229207, 3942216734, 3813704720, 2340870396, 3902060417},
				A:   [7]uint32{1325795159, 1474082938, 563223687, 1617302894, 3264310563, 3799719278, 3666975137},
				PC:  9325484,
				SR:  42516,
				USP: 4940062,
				SSP: 12404136,
				RAM: [][2]uint32{{9325480, 68}, {9325481, 17}, {9325482, 82}, {9325483, 46}, {14465146, 246}, {14465147, 158}, {9325484, 255}, {9325485, 253}},
			},
			want: cpuState{
				D:   [8]uint32{1742587891, 3019803964, 4213390566, 888229207, 3942216734, 3813704720, 2340870396, 3902060417},
				A:   [7]uint32{1325795159, 1474082938, 563223687, 1617302894, 3264310563, 3799719278, 3666975137},
				PC:  9325486,
				SR:  42513,
				USP: 4940062,
				SSP: 12404136,
				RAM: [][2]uint32{{9325480, 68}, {9325481, 17}, {9325482, 82}, {9325483, 46}, {14465146, 10}, {14465147, 158}, {9325484, 255}, {9325485, 253}},
				Cycles: 12,
			},
		},
		{
			name: "2000 NEG.b (A2)+ 441a",
			init: cpuState{
				D:   [8]uint32{1383727117, 1981057679, 1629380444, 1107732215, 845514815, 3423783678, 335276429, 794835931},
				A:   [7]uint32{1193091966, 344326133, 2878833117, 3876587753, 2853679709, 3400865416, 2677642943},
				PC:  15676058,
				SR:  42753,
				USP: 12270282,
				SSP: 2962958,
				RAM: [][2]uint32{{15676054, 68}, {15676055, 26}, {15676056, 41}, {15676057, 74}, {9929180, 109}, {9929181, 10}, {15676058, 33}, {15676059, 136}},
			},
			want: cpuState{
				D:   [8]uint32{1383727117, 1981057679, 1629380444, 1107732215, 845514815, 3423783678, 335276429, 794835931},
				A:   [7]uint32{1193091966, 344326133, 2878833118, 3876587753, 2853679709, 3400865416, 2677642943},
				PC:  15676060,
				SR:  42777,
				USP: 12270282,
				SSP: 2962958,
				RAM: [][2]uint32{{15676054, 68}, {15676055, 26}, {15676056, 41}, {15676057, 74}, {9929180, 109}, {9929181, 246}, {15676058, 33}, {15676059, 136}},
				Cycles: 12,
			},
		},
		{
			name: "001 NEG.b (d16, A3) 442b",
			init: 			cpuState{
				D:   [8]uint32{1401612807, 2396748424, 1449429120, 42284096, 1854965550, 1541904050, 1806026476, 2513038545},
				A:   [7]uint32{604799145, 1798761744, 3526558023, 1997253443, 3801018172, 964386887, 480869067},
				PC:  5011386,
				SR:  1050,
				USP: 11252182,
				SSP: 3562044,
				RAM: [][2]uint32{{5011382, 68}, {5011383, 43}, {5011384, 102}, {5011385, 102}, {5011386, 213}, {5011387, 161}, {790952, 58}, {790953, 14}, {5011388, 175}, {5011389, 209}},
			},
			want: 			cpuState{
				D:   [8]uint32{1401612807, 2396748424, 1449429120, 42284096, 1854965550, 1541904050, 1806026476, 2513038545},
				A:   [7]uint32{604799145, 1798761744, 3526558023, 1997253443, 3801018172, 964386887, 480869067},
				PC:  5011390,
				SR:  1049,
				USP: 11252182,
				SSP: 3562044,
				RAM: [][2]uint32{{5011382, 68}, {5011383, 43}, {5011384, 102}, {5011385, 102}, {5011386, 213}, {5011387, 161}, {790952, 58}, {790953, 242}, {5011388, 175}, {5011389, 209}},
				Cycles: 16,
			},
		},
		{
			name: "279 NEG.b D3 4403",
			init: 			cpuState{
				D:   [8]uint32{3971554871, 55939276, 420067017, 2817503011, 3724587129, 106369299, 130304138, 1110710285},
				A:   [7]uint32{52201285, 449633466, 2048602480, 4163445320, 3702687586, 2454975837, 3406354927},
				PC:  2607458,
				SR:  541,
				USP: 5694424,
				SSP: 12466116,
				RAM: [][2]uint32{{2607454, 68}, {2607455, 3}, {2607456, 31}, {2607457, 104}, {2607458, 22}, {2607459, 104}},
			},
			want: 			cpuState{
				D:   [8]uint32{3971554871, 55939276, 420067017, 2817503197, 3724587129, 106369299, 130304138, 1110710285},
				A:   [7]uint32{52201285, 449633466, 2048602480, 4163445320, 3702687586, 2454975837, 3406354927},
				PC:  2607460,
				SR:  537,
				USP: 5694424,
				SSP: 12466116,
				RAM: [][2]uint32{{2607454, 68}, {2607455, 3}, {2607456, 31}, {2607457, 104}, {2607458, 22}, {2607459, 104}},
				Cycles: 4,
			},
		},
		{
			name: "521 NEG.b (A7) 4417",
			init: 			cpuState{
				D:   [8]uint32{3245754715, 79943654, 1201539592, 252532103, 140331825, 967618922, 578530980, 3636319315},
				A:   [7]uint32{99550411, 3754613456, 2925042996, 1514786304, 282778790, 120725156, 2527471493},
				PC:  8660702,
				SR:  1805,
				USP: 5320812,
				SSP: 4737288,
				RAM: [][2]uint32{{8660698, 68}, {8660699, 23}, {8660700, 211}, {8660701, 215}, {5320812, 104}, {5320813, 246}, {8660702, 92}, {8660703, 247}},
			},
			want: 			cpuState{
				D:   [8]uint32{3245754715, 79943654, 1201539592, 252532103, 140331825, 967618922, 578530980, 3636319315},
				A:   [7]uint32{99550411, 3754613456, 2925042996, 1514786304, 282778790, 120725156, 2527471493},
				PC:  8660704,
				SR:  1817,
				USP: 5320812,
				SSP: 4737288,
				RAM: [][2]uint32{{8660698, 68}, {8660699, 23}, {8660700, 211}, {8660701, 215}, {5320812, 152}, {5320813, 246}, {8660702, 92}, {8660703, 247}},
				Cycles: 12,
			},
		},
		{
			name: "805 NEG.b (A4) 4414",
			init: 			cpuState{
				D:   [8]uint32{3301055480, 3966230961, 544461292, 801317457, 1119389879, 3896878027, 2574453196, 1451489611},
				A:   [7]uint32{1261143582, 4270714786, 110007955, 527309148, 2154923413, 2174773833, 1620567379},
				PC:  4397424,
				SR:  8987,
				USP: 10853120,
				SSP: 5167990,
				RAM: [][2]uint32{{4397420, 68}, {4397421, 20}, {4397422, 104}, {4397423, 185}, {7439764, 134}, {7439765, 231}, {4397424, 200}, {4397425, 230}},
			},
			want: 			cpuState{
				D:   [8]uint32{3301055480, 3966230961, 544461292, 801317457, 1119389879, 3896878027, 2574453196, 1451489611},
				A:   [7]uint32{1261143582, 4270714786, 110007955, 527309148, 2154923413, 2174773833, 1620567379},
				PC:  4397426,
				SR:  8977,
				USP: 10853120,
				SSP: 5167990,
				RAM: [][2]uint32{{4397420, 68}, {4397421, 20}, {4397422, 104}, {4397423, 185}, {7439764, 134}, {7439765, 25}, {4397424, 200}, {4397425, 230}},
				Cycles: 12,
			},
		},
		{
			name: "1077 NEG.b (d8, A3, Xn) 4433",
			init: 			cpuState{
				D:   [8]uint32{1357806403, 3507859660, 2171429833, 2776014141, 441070906, 3426925351, 1412830020, 2519166975},
				A:   [7]uint32{177317720, 2376089406, 82723031, 2338244131, 3926918274, 2791712333, 4049950404},
				PC:  13012304,
				SR:  8970,
				USP: 222066,
				SSP: 9731494,
				RAM: [][2]uint32{{13012300, 68}, {13012301, 51}, {13012302, 111}, {13012303, 101}, {13012304, 195}, {13012305, 0}, {9755084, 55}, {9755085, 222}, {13012306, 169}, {13012307, 117}},
			},
			want: 			cpuState{
				D:   [8]uint32{1357806403, 3507859660, 2171429833, 2776014141, 441070906, 3426925351, 1412830020, 2519166975},
				A:   [7]uint32{177317720, 2376089406, 82723031, 2338244131, 3926918274, 2791712333, 4049950404},
				PC:  13012308,
				SR:  8985,
				USP: 222066,
				SSP: 9731494,
				RAM: [][2]uint32{{13012300, 68}, {13012301, 51}, {13012302, 111}, {13012303, 101}, {13012304, 195}, {13012305, 0}, {9755084, 201}, {9755085, 222}, {13012306, 169}, {13012307, 117}},
				Cycles: 18,
			},
		},
		{
			name: "1370 NEG.b D4 4404",
			init: 			cpuState{
				D:   [8]uint32{367182563, 3421976586, 2423791740, 2511898978, 233254498, 3682090465, 889898609, 688408637},
				A:   [7]uint32{2076274571, 3294501046, 3228287240, 1645383646, 527484167, 3224564416, 589298121},
				PC:  11342518,
				SR:  8220,
				USP: 1049350,
				SSP: 6690240,
				RAM: [][2]uint32{{11342514, 68}, {11342515, 4}, {11342516, 50}, {11342517, 176}, {11342518, 236}, {11342519, 205}},
			},
			want: 			cpuState{
				D:   [8]uint32{367182563, 3421976586, 2423791740, 2511898978, 233254558, 3682090465, 889898609, 688408637},
				A:   [7]uint32{2076274571, 3294501046, 3228287240, 1645383646, 527484167, 3224564416, 589298121},
				PC:  11342520,
				SR:  8217,
				USP: 1049350,
				SSP: 6690240,
				RAM: [][2]uint32{{11342514, 68}, {11342515, 4}, {11342516, 50}, {11342517, 176}, {11342518, 236}, {11342519, 205}},
				Cycles: 4,
			},
		},
		{
			name: "1652 NEG.b (d8, A0, Xn) 4430",
			init: 			cpuState{
				D:   [8]uint32{2474543146, 2803563343, 4106482843, 2038753557, 194342555, 1947761967, 4155226504, 4272141852},
				A:   [7]uint32{57521614, 2283833885, 1465755490, 138694023, 1521253453, 3889187328, 2659169155},
				PC:  6197414,
				SR:  8705,
				USP: 8237520,
				SSP: 13809410,
				RAM: [][2]uint32{{6197410, 68}, {6197411, 48}, {6197412, 39}, {6197413, 89}, {6197414, 28}, {6197415, 7}, {7187138, 236}, {7187139, 36}, {6197416, 108}, {6197417, 48}},
			},
			want: 			cpuState{
				D:   [8]uint32{2474543146, 2803563343, 4106482843, 2038753557, 194342555, 1947761967, 4155226504, 4272141852},
				A:   [7]uint32{57521614, 2283833885, 1465755490, 138694023, 1521253453, 3889187328, 2659169155},
				PC:  6197418,
				SR:  8721,
				USP: 8237520,
				SSP: 13809410,
				RAM: [][2]uint32{{6197410, 68}, {6197411, 48}, {6197412, 39}, {6197413, 89}, {6197414, 28}, {6197415, 7}, {7187138, 20}, {7187139, 36}, {6197416, 108}, {6197417, 48}},
				Cycles: 18,
			},
		},
		{
			name: "1960 NEG.b D3 4403",
			init: 			cpuState{
				D:   [8]uint32{1048756452, 3125896700, 3918536815, 3875045219, 2621691135, 322519131, 1647709765, 150972237},
				A:   [7]uint32{1236154189, 286095578, 1023262588, 1179110887, 2985799301, 1633971658, 2235402601},
				PC:  15523518,
				SR:  8196,
				USP: 7250396,
				SSP: 14436654,
				RAM: [][2]uint32{{15523514, 68}, {15523515, 3}, {15523516, 166}, {15523517, 64}, {15523518, 64}, {15523519, 178}},
			},
			want: 			cpuState{
				D:   [8]uint32{1048756452, 3125896700, 3918536815, 3875045277, 2621691135, 322519131, 1647709765, 150972237},
				A:   [7]uint32{1236154189, 286095578, 1023262588, 1179110887, 2985799301, 1633971658, 2235402601},
				PC:  15523520,
				SR:  8217,
				USP: 7250396,
				SSP: 14436654,
				RAM: [][2]uint32{{15523514, 68}, {15523515, 3}, {15523516, 166}, {15523517, 64}, {15523518, 64}, {15523519, 178}},
				Cycles: 4,
			},
		},
		{
			name: "2223 NEG.b D7 4407",
			init: 			cpuState{
				D:   [8]uint32{3320808181, 1669927789, 408556190, 3727952570, 1780694229, 3620354740, 246047623, 4023663547},
				A:   [7]uint32{3148795751, 3665739755, 851287713, 3749847199, 3613858967, 3298663082, 610273402},
				PC:  1698504,
				SR:  786,
				USP: 6129768,
				SSP: 9867478,
				RAM: [][2]uint32{{1698500, 68}, {1698501, 7}, {1698502, 182}, {1698503, 3}, {1698504, 5}, {1698505, 184}},
			},
			want: 			cpuState{
				D:   [8]uint32{3320808181, 1669927789, 408556190, 3727952570, 1780694229, 3620354740, 246047623, 4023663429},
				A:   [7]uint32{3148795751, 3665739755, 851287713, 3749847199, 3613858967, 3298663082, 610273402},
				PC:  1698506,
				SR:  785,
				USP: 6129768,
				SSP: 9867478,
				RAM: [][2]uint32{{1698500, 68}, {1698501, 7}, {1698502, 182}, {1698503, 3}, {1698504, 5}, {1698505, 184}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNEG_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NEG.w D6 4446",
			init: cpuState{
				D:   [8]uint32{2915949660, 4208110988, 3897725201, 157986744, 2424547139, 398580832, 3144043529, 3319658943},
				A:   [7]uint32{1155462772, 3810844444, 3589085788, 2091927467, 2326765843, 144408155, 1896118326},
				PC:  2969060,
				SR:  42259,
				USP: 15124356,
				SSP: 5960562,
				RAM: [][2]uint32{{2969056, 68}, {2969057, 70}, {2969058, 207}, {2969059, 223}, {2969060, 60}, {2969061, 110}},
			},
			want: cpuState{
				D:   [8]uint32{2915949660, 4208110988, 3897725201, 157986744, 2424547139, 398580832, 3144070135, 3319658943},
				A:   [7]uint32{1155462772, 3810844444, 3589085788, 2091927467, 2326765843, 144408155, 1896118326},
				PC:  2969062,
				SR:  42265,
				USP: 15124356,
				SSP: 5960562,
				RAM: [][2]uint32{{2969056, 68}, {2969057, 70}, {2969058, 207}, {2969059, 223}, {2969060, 60}, {2969061, 110}},
				Cycles: 4,
			},
		},
		{
			name: "500 NEG.w -(A3) 4463",
			init: cpuState{
				D:   [8]uint32{1355486337, 3788654406, 2725608882, 2862724238, 1739299320, 2577950922, 138807065, 1989673365},
				A:   [7]uint32{2626402756, 3905705728, 2872122411, 1799684652, 2856217698, 3949908055, 3113370227},
				PC:  16713452,
				SR:  8715,
				USP: 9174686,
				SSP: 11450042,
				RAM: [][2]uint32{{16713448, 68}, {16713449, 99}, {16713450, 80}, {16713451, 249}, {4522538, 41}, {4522539, 9}, {16713452, 45}, {16713453, 106}},
			},
			want: cpuState{
				D:   [8]uint32{1355486337, 3788654406, 2725608882, 2862724238, 1739299320, 2577950922, 138807065, 1989673365},
				A:   [7]uint32{2626402756, 3905705728, 2872122411, 1799684650, 2856217698, 3949908055, 3113370227},
				PC:  16713454,
				SR:  8729,
				USP: 9174686,
				SSP: 11450042,
				RAM: [][2]uint32{{16713448, 68}, {16713449, 99}, {16713450, 80}, {16713451, 249}, {4522538, 214}, {4522539, 247}, {16713452, 45}, {16713453, 106}},
				Cycles: 14,
			},
		},
		{
			name: "1000 NEG.w D1 4441",
			init: cpuState{
				D:   [8]uint32{2361158122, 3623290893, 3361650531, 2649015181, 4226626170, 3008168291, 3547930330, 1188128845},
				A:   [7]uint32{1036195776, 709692555, 2017677353, 3748819848, 2350382517, 4261949209, 621255156},
				PC:  1425156,
				SR:  41244,
				USP: 6837652,
				SSP: 14997410,
				RAM: [][2]uint32{{1425152, 68}, {1425153, 65}, {1425154, 170}, {1425155, 170}, {1425156, 227}, {1425157, 165}},
			},
			want: cpuState{
				D:   [8]uint32{2361158122, 3623352307, 3361650531, 2649015181, 4226626170, 3008168291, 3547930330, 1188128845},
				A:   [7]uint32{1036195776, 709692555, 2017677353, 3748819848, 2350382517, 4261949209, 621255156},
				PC:  1425158,
				SR:  41241,
				USP: 6837652,
				SSP: 14997410,
				RAM: [][2]uint32{{1425152, 68}, {1425153, 65}, {1425154, 170}, {1425155, 170}, {1425156, 227}, {1425157, 165}},
				Cycles: 4,
			},
		},
		{
			name: "1500 NEG.w -(A6) 4466",
			init: cpuState{
				D:   [8]uint32{1794164851, 758705101, 3432477330, 2444286583, 3418335022, 1704792676, 3636392261, 2252475950},
				A:   [7]uint32{917265208, 2625191631, 1208269651, 4060029441, 3006062624, 4058222987, 924253985},
				PC:  9348616,
				SR:  42245,
				USP: 7471700,
				SSP: 15119528,
				RAM: [][2]uint32{{9348612, 68}, {9348613, 102}, {9348614, 148}, {9348615, 239}, {12, 97}, {13, 162}, {14, 67}, {15, 80}, {10634064, 89}, {10634065, 254}, {10634066, 207}, {10634067, 38}},
			},
			want: cpuState{
				D:      [8]uint32{1794164851, 758705101, 3432477330, 2444286583, 3418335022, 1704792676, 3636392261, 2252475950},
				A:      [7]uint32{917265208, 2625191631, 1208269651, 4060029441, 3006062624, 4058222987, 924253983},
				PC:     1638024020,
				SR:     9477,
				USP:    7471700,
				SSP:    15119514,
				RAM:    [][2]uint32{{9348612, 68}, {9348613, 102}, {9348614, 148}, {9348615, 239}, {15119526, 166}, {15119527, 8}, {15119522, 165}, {15119523, 5}, {15119524, 0}, {15119525, 142}, {15119520, 68}, {15119521, 102}, {15119518, 255}, {15119519, 31}, {15119514, 68}, {15119515, 117}, {15119516, 55}, {15119517, 22}, {12, 97}, {13, 162}, {14, 67}, {15, 80}, {10634064, 89}, {10634065, 254}, {10634066, 207}, {10634067, 38}},
				Halted: true,
			},
		},
		{
			name: "2000 NEG.w (d16, A3) 446b",
			init: cpuState{
				D:   [8]uint32{1893049647, 3815111632, 4116717305, 1969157946, 2776697103, 4051343205, 3645149036, 304192302},
				A:   [7]uint32{1932126572, 446931892, 402232159, 1540546781, 3752128603, 1546144732, 1782733958},
				PC:  3623616,
				SR:  42502,
				USP: 3634900,
				SSP: 5757298,
				RAM: [][2]uint32{{3623612, 68}, {3623613, 107}, {3623614, 220}, {3623615, 132}, {3623616, 146}, {3623617, 57}, {12, 57}, {13, 8}, {14, 227}, {15, 42}, {582442, 221}, {582443, 66}, {582444, 37}, {582445, 31}},
			},
			want: cpuState{
				D:      [8]uint32{1893049647, 3815111632, 4116717305, 1969157946, 2776697103, 4051343205, 3645149036, 304192302},
				A:      [7]uint32{1932126572, 446931892, 402232159, 1540546781, 3752128603, 1546144732, 1782733958},
				PC:     956883758,
				SR:     9734,
				USP:    3634900,
				SSP:    5757284,
				RAM:    [][2]uint32{{3623612, 68}, {3623613, 107}, {3623614, 220}, {3623615, 132}, {3623616, 146}, {3623617, 57}, {5757296, 74}, {5757297, 190}, {5757292, 166}, {5757293, 6}, {5757294, 0}, {5757295, 55}, {5757290, 68}, {5757291, 107}, {5757288, 189}, {5757289, 97}, {5757284, 68}, {5757285, 117}, {5757286, 91}, {5757287, 210}, {12, 57}, {13, 8}, {14, 227}, {15, 42}, {582442, 221}, {582443, 66}, {582444, 37}, {582445, 31}},
				Halted: true,
			},
		},
		{
			name: "005 NEG.w (d16, A0) 4468",
			init: 			cpuState{
				D:   [8]uint32{4261993831, 3074585935, 1341580250, 2772059542, 2869104769, 2730484574, 981999688, 125215349},
				A:   [7]uint32{3897934767, 290021581, 3563594041, 1003708075, 2743944745, 1840976030, 4006792081},
				PC:  10726108,
				SR:  1051,
				USP: 15449348,
				SSP: 15049118,
				RAM: [][2]uint32{{10726104, 68}, {10726105, 104}, {10726106, 66}, {10726107, 169}, {10726108, 195}, {10726109, 218}, {5637720, 232}, {5637721, 95}, {10726110, 168}, {10726111, 0}},
			},
			want: 			cpuState{
				D:   [8]uint32{4261993831, 3074585935, 1341580250, 2772059542, 2869104769, 2730484574, 981999688, 125215349},
				A:   [7]uint32{3897934767, 290021581, 3563594041, 1003708075, 2743944745, 1840976030, 4006792081},
				PC:  10726112,
				SR:  1041,
				USP: 15449348,
				SSP: 15049118,
				RAM: [][2]uint32{{10726104, 68}, {10726105, 104}, {10726106, 66}, {10726107, 169}, {10726108, 195}, {10726109, 218}, {5637720, 23}, {5637721, 161}, {10726110, 168}, {10726111, 0}},
				Cycles: 16,
			},
		},
		{
			name: "281 NEG.w D7 4447",
			init: 			cpuState{
				D:   [8]uint32{3700306930, 300406316, 282290701, 3430655732, 2124030949, 1032907459, 111344637, 3901695430},
				A:   [7]uint32{2320588982, 1406277491, 4140188955, 1216268558, 2463738749, 292030742, 1727990467},
				PC:  690814,
				SR:  1288,
				USP: 4213508,
				SSP: 10883568,
				RAM: [][2]uint32{{690810, 68}, {690811, 71}, {690812, 104}, {690813, 217}, {690814, 7}, {690815, 123}},
			},
			want: 			cpuState{
				D:   [8]uint32{3700306930, 300406316, 282290701, 3430655732, 2124030949, 1032907459, 111344637, 3901741626},
				A:   [7]uint32{2320588982, 1406277491, 4140188955, 1216268558, 2463738749, 292030742, 1727990467},
				PC:  690816,
				SR:  1305,
				USP: 4213508,
				SSP: 10883568,
				RAM: [][2]uint32{{690810, 68}, {690811, 71}, {690812, 104}, {690813, 217}, {690814, 7}, {690815, 123}},
				Cycles: 4,
			},
		},
		{
			name: "583 NEG.w D3 4443",
			init: 			cpuState{
				D:   [8]uint32{2647773077, 185641304, 4267808172, 3669195458, 2264610671, 3264582914, 2363127398, 1708040849},
				A:   [7]uint32{1688281474, 3177319132, 549242773, 2942095434, 1579124758, 984588524, 148181234},
				PC:  8290326,
				SR:  8459,
				USP: 252168,
				SSP: 2897748,
				RAM: [][2]uint32{{8290322, 68}, {8290323, 67}, {8290324, 9}, {8290325, 167}, {8290326, 248}, {8290327, 126}},
			},
			want: 			cpuState{
				D:   [8]uint32{2647773077, 185641304, 4267808172, 3669198142, 2264610671, 3264582914, 2363127398, 1708040849},
				A:   [7]uint32{1688281474, 3177319132, 549242773, 2942095434, 1579124758, 984588524, 148181234},
				PC:  8290328,
				SR:  8473,
				USP: 252168,
				SSP: 2897748,
				RAM: [][2]uint32{{8290322, 68}, {8290323, 67}, {8290324, 9}, {8290325, 167}, {8290326, 248}, {8290327, 126}},
				Cycles: 4,
			},
		},
		{
			name: "863 NEG.w (d8, A3, Xn) 4473",
			init: 			cpuState{
				D:   [8]uint32{657967036, 1109928265, 807245324, 3614917932, 4268464065, 1363181754, 1781052398, 2182060507},
				A:   [7]uint32{3327588801, 2959804080, 849202331, 1308654562, 1167866505, 1376849656, 1908847838},
				PC:  6406610,
				SR:  9239,
				USP: 10667916,
				SSP: 16115704,
				RAM: [][2]uint32{{6406606, 68}, {6406607, 115}, {6406608, 8}, {6406609, 84}, {6406610, 58}, {6406611, 158}, {3687410, 174}, {3687411, 160}, {6406612, 38}, {6406613, 79}},
			},
			want: 			cpuState{
				D:   [8]uint32{657967036, 1109928265, 807245324, 3614917932, 4268464065, 1363181754, 1781052398, 2182060507},
				A:   [7]uint32{3327588801, 2959804080, 849202331, 1308654562, 1167866505, 1376849656, 1908847838},
				PC:  6406614,
				SR:  9233,
				USP: 10667916,
				SSP: 16115704,
				RAM: [][2]uint32{{6406606, 68}, {6406607, 115}, {6406608, 8}, {6406609, 84}, {6406610, 58}, {6406611, 158}, {3687410, 81}, {3687411, 96}, {6406612, 38}, {6406613, 79}},
				Cycles: 18,
			},
		},
		{
			name: "1116 NEG.w D6 4446",
			init: 			cpuState{
				D:   [8]uint32{4052908389, 35079441, 1840747864, 2026390538, 3064940540, 787307014, 3314572848, 4292266780},
				A:   [7]uint32{2999094620, 3737336616, 1857515619, 1161251091, 966581300, 3664653069, 1654937674},
				PC:  606384,
				SR:  9482,
				USP: 13750560,
				SSP: 1095704,
				RAM: [][2]uint32{{606380, 68}, {606381, 70}, {606382, 174}, {606383, 37}, {606384, 196}, {606385, 120}},
			},
			want: 			cpuState{
				D:   [8]uint32{4052908389, 35079441, 1840747864, 2026390538, 3064940540, 787307014, 3314590160, 4292266780},
				A:   [7]uint32{2999094620, 3737336616, 1857515619, 1161251091, 966581300, 3664653069, 1654937674},
				PC:  606386,
				SR:  9497,
				USP: 13750560,
				SSP: 1095704,
				RAM: [][2]uint32{{606380, 68}, {606381, 70}, {606382, 174}, {606383, 37}, {606384, 196}, {606385, 120}},
				Cycles: 4,
			},
		},
		{
			name: "1354 NEG.w (d16, A4) 446c",
			init: 			cpuState{
				D:   [8]uint32{1087056185, 3835743131, 1504177993, 1386097865, 2302195492, 2641761458, 21103832, 2469627938},
				A:   [7]uint32{4161366816, 3524242352, 1403663406, 4195635316, 200302965, 2376422778, 2731464292},
				PC:  13781534,
				SR:  8468,
				USP: 7707312,
				SSP: 14289756,
				RAM: [][2]uint32{{13781530, 68}, {13781531, 108}, {13781532, 81}, {13781533, 49}, {13781534, 201}, {13781535, 167}, {15774374, 27}, {15774375, 114}, {13781536, 62}, {13781537, 2}},
			},
			want: 			cpuState{
				D:   [8]uint32{1087056185, 3835743131, 1504177993, 1386097865, 2302195492, 2641761458, 21103832, 2469627938},
				A:   [7]uint32{4161366816, 3524242352, 1403663406, 4195635316, 200302965, 2376422778, 2731464292},
				PC:  13781538,
				SR:  8473,
				USP: 7707312,
				SSP: 14289756,
				RAM: [][2]uint32{{13781530, 68}, {13781531, 108}, {13781532, 81}, {13781533, 49}, {13781534, 201}, {13781535, 167}, {15774374, 228}, {15774375, 142}, {13781536, 62}, {13781537, 2}},
				Cycles: 16,
			},
		},
		{
			name: "1686 NEG.w (A7) 4457",
			init: 			cpuState{
				D:   [8]uint32{1804094443, 200631523, 1225400660, 4081464210, 1445875717, 783406385, 3320295847, 542115704},
				A:   [7]uint32{133606653, 1289224184, 2319174886, 2631544132, 629209660, 3260317841, 3619248054},
				PC:  8303126,
				SR:  10015,
				USP: 1254660,
				SSP: 2686478,
				RAM: [][2]uint32{{8303122, 68}, {8303123, 87}, {8303124, 126}, {8303125, 43}, {2686478, 0}, {2686479, 62}, {8303126, 194}, {8303127, 67}},
			},
			want: 			cpuState{
				D:   [8]uint32{1804094443, 200631523, 1225400660, 4081464210, 1445875717, 783406385, 3320295847, 542115704},
				A:   [7]uint32{133606653, 1289224184, 2319174886, 2631544132, 629209660, 3260317841, 3619248054},
				PC:  8303128,
				SR:  10009,
				USP: 1254660,
				SSP: 2686478,
				RAM: [][2]uint32{{8303122, 68}, {8303123, 87}, {8303124, 126}, {8303125, 43}, {2686478, 255}, {2686479, 194}, {8303126, 194}, {8303127, 67}},
				Cycles: 12,
			},
		},
		{
			name: "1999 NEG.w -(A1) 4461",
			init: 			cpuState{
				D:   [8]uint32{2173445973, 1963999805, 2395274810, 133352661, 2720339647, 2641183001, 3350477670, 3971824256},
				A:   [7]uint32{3537887822, 3987147508, 700339828, 721441900, 3992121543, 464977178, 1284042771},
				PC:  6159428,
				SR:  1544,
				USP: 5010198,
				SSP: 1365430,
				RAM: [][2]uint32{{6159424, 68}, {6159425, 97}, {6159426, 238}, {6159427, 36}, {10947314, 193}, {10947315, 129}, {6159428, 180}, {6159429, 238}},
			},
			want: 			cpuState{
				D:   [8]uint32{2173445973, 1963999805, 2395274810, 133352661, 2720339647, 2641183001, 3350477670, 3971824256},
				A:   [7]uint32{3537887822, 3987147506, 700339828, 721441900, 3992121543, 464977178, 1284042771},
				PC:  6159430,
				SR:  1553,
				USP: 5010198,
				SSP: 1365430,
				RAM: [][2]uint32{{6159424, 68}, {6159425, 97}, {6159426, 238}, {6159427, 36}, {10947314, 62}, {10947315, 127}, {6159428, 180}, {6159429, 238}},
				Cycles: 14,
			},
		},
		{
			name: "2223 NEG.w (A2) 4452",
			init: 			cpuState{
				D:   [8]uint32{3555630276, 3349904683, 3620663100, 3188292614, 2674744611, 623832403, 1903507527, 2991690744},
				A:   [7]uint32{2780284675, 1449700388, 968287154, 3623835102, 728243166, 328627359, 84824171},
				PC:  14440220,
				SR:  4,
				USP: 8483092,
				SSP: 10442222,
				RAM: [][2]uint32{{14440216, 68}, {14440217, 82}, {14440218, 153}, {14440219, 85}, {11985842, 53}, {11985843, 235}, {14440220, 158}, {14440221, 97}},
			},
			want: 			cpuState{
				D:   [8]uint32{3555630276, 3349904683, 3620663100, 3188292614, 2674744611, 623832403, 1903507527, 2991690744},
				A:   [7]uint32{2780284675, 1449700388, 968287154, 3623835102, 728243166, 328627359, 84824171},
				PC:  14440222,
				SR:  25,
				USP: 8483092,
				SSP: 10442222,
				RAM: [][2]uint32{{14440216, 68}, {14440217, 82}, {14440218, 153}, {14440219, 85}, {11985842, 202}, {11985843, 21}, {14440220, 158}, {14440221, 97}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNEG_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NEG.l (d8, A6, Xn) 44b6",
			init: cpuState{
				D:   [8]uint32{719086016, 3259811995, 2860197788, 2621662612, 2307160278, 3595857550, 3802541122, 3273727736},
				A:   [7]uint32{853453440, 2727382335, 3119527772, 529205721, 182644064, 637917436, 2865619974},
				PC:  10066980,
				SR:  42516,
				USP: 10268442,
				SSP: 10730316,
				RAM: [][2]uint32{{10066976, 68}, {10066977, 182}, {10066978, 152}, {10066979, 29}, {10066980, 23}, {10066981, 213}, {6189410, 144}, {6189411, 137}, {6189412, 54}, {6189413, 166}, {10066982, 241}, {10066983, 187}},
			},
			want: cpuState{
				D:   [8]uint32{719086016, 3259811995, 2860197788, 2621662612, 2307160278, 3595857550, 3802541122, 3273727736},
				A:   [7]uint32{853453440, 2727382335, 3119527772, 529205721, 182644064, 637917436, 2865619974},
				PC:  10066984,
				SR:  42513,
				USP: 10268442,
				SSP: 10730316,
				RAM: [][2]uint32{{10066976, 68}, {10066977, 182}, {10066978, 152}, {10066979, 29}, {10066980, 23}, {10066981, 213}, {6189410, 111}, {6189411, 118}, {6189412, 201}, {6189413, 90}, {10066982, 241}, {10066983, 187}},
				Cycles: 26,
			},
		},
		{
			name: "500 NEG.l -(A1) 44a1",
			init: cpuState{
				D:   [8]uint32{3820270538, 3167951532, 4280191509, 1841217126, 3700595061, 1792962292, 992386636, 3652894431},
				A:   [7]uint32{3643201910, 2513309119, 1797912110, 1722048088, 4228619898, 2965726583, 2659334603},
				PC:  2765298,
				SR:  519,
				USP: 9858294,
				SSP: 4355452,
				RAM: [][2]uint32{{2765294, 68}, {2765295, 161}, {2765296, 228}, {2765297, 116}, {12, 91}, {13, 164}, {14, 17}, {15, 234}, {10752490, 198}, {10752491, 11}, {10752492, 116}, {10752493, 100}},
			},
			want: cpuState{
				D:      [8]uint32{3820270538, 3167951532, 4280191509, 1841217126, 3700595061, 1792962292, 992386636, 3652894431},
				A:      [7]uint32{3643201910, 2513309115, 1797912110, 1722048088, 4228619898, 2965726583, 2659334603},
				PC:     1537479150,
				SR:     8711,
				USP:    9858294,
				SSP:    4355438,
				RAM:    [][2]uint32{{2765294, 68}, {2765295, 161}, {2765296, 228}, {2765297, 116}, {4355450, 49}, {4355451, 240}, {4355446, 2}, {4355447, 7}, {4355448, 0}, {4355449, 42}, {4355444, 68}, {4355445, 161}, {4355442, 13}, {4355443, 187}, {4355438, 68}, {4355439, 177}, {4355440, 149}, {4355441, 206}, {12, 91}, {13, 164}, {14, 17}, {15, 234}, {10752490, 198}, {10752491, 11}, {10752492, 116}, {10752493, 100}},
				Halted: true,
			},
		},
		{
			name: "1000 NEG.l (A2) 4492",
			init: cpuState{
				D:   [8]uint32{1600078150, 1192545120, 2851157367, 3218614624, 4013698055, 456788395, 1877373041, 1086344250},
				A:   [7]uint32{2676042129, 1114560778, 3749899372, 4215979598, 4003652880, 3239091244, 949257642},
				PC:  8487452,
				SR:  1539,
				USP: 1765752,
				SSP: 15538022,
				RAM: [][2]uint32{{8487448, 68}, {8487449, 146}, {8487450, 203}, {8487451, 68}, {8580204, 85}, {8580205, 63}, {8580206, 149}, {8580207, 56}, {8487452, 66}, {8487453, 38}},
			},
			want: cpuState{
				D:   [8]uint32{1600078150, 1192545120, 2851157367, 3218614624, 4013698055, 456788395, 1877373041, 1086344250},
				A:   [7]uint32{2676042129, 1114560778, 3749899372, 4215979598, 4003652880, 3239091244, 949257642},
				PC:  8487454,
				SR:  1561,
				USP: 1765752,
				SSP: 15538022,
				RAM: [][2]uint32{{8487448, 68}, {8487449, 146}, {8487450, 203}, {8487451, 68}, {8580204, 170}, {8580205, 192}, {8580206, 106}, {8580207, 200}, {8487452, 66}, {8487453, 38}},
				Cycles: 20,
			},
		},
		{
			name: "1500 NEG.l (d8, A2, Xn) 44b2",
			init: cpuState{
				D:   [8]uint32{4264905605, 3598216323, 3153051087, 3593934027, 1611263043, 2584955757, 3339391747, 3225157841},
				A:   [7]uint32{1856076612, 3605553870, 2288008320, 2404733416, 4245482680, 2772047808, 2407091370},
				PC:  8998054,
				SR:  9755,
				USP: 13841716,
				SSP: 2052772,
				RAM: [][2]uint32{{8998050, 68}, {8998051, 178}, {8998052, 92}, {8998053, 9}, {8998054, 100}, {8998055, 219}, {7571446, 128}, {7571447, 107}, {7571448, 84}, {7571449, 23}, {8998056, 141}, {8998057, 155}},
			},
			want: cpuState{
				D:   [8]uint32{4264905605, 3598216323, 3153051087, 3593934027, 1611263043, 2584955757, 3339391747, 3225157841},
				A:   [7]uint32{1856076612, 3605553870, 2288008320, 2404733416, 4245482680, 2772047808, 2407091370},
				PC:  8998058,
				SR:  9745,
				USP: 13841716,
				SSP: 2052772,
				RAM: [][2]uint32{{8998050, 68}, {8998051, 178}, {8998052, 92}, {8998053, 9}, {8998054, 100}, {8998055, 219}, {7571446, 127}, {7571447, 148}, {7571448, 171}, {7571449, 233}, {8998056, 141}, {8998057, 155}},
				Cycles: 26,
			},
		},
		{
			name: "2000 NEG.l (A0)+ 4498",
			init: cpuState{
				D:   [8]uint32{520310635, 1158175548, 1286392270, 637683192, 3826063731, 2568583579, 57436952, 4201783504},
				A:   [7]uint32{2141690914, 3107331254, 2161806859, 1548999783, 4183940512, 2096745090, 3643515432},
				PC:  7823060,
				SR:  9245,
				USP: 3961036,
				SSP: 10385274,
				RAM: [][2]uint32{{7823056, 68}, {7823057, 152}, {7823058, 75}, {7823059, 34}, {10984482, 205}, {10984483, 225}, {10984484, 57}, {10984485, 52}, {7823060, 117}, {7823061, 5}},
			},
			want: cpuState{
				D:   [8]uint32{520310635, 1158175548, 1286392270, 637683192, 3826063731, 2568583579, 57436952, 4201783504},
				A:   [7]uint32{2141690918, 3107331254, 2161806859, 1548999783, 4183940512, 2096745090, 3643515432},
				PC:  7823062,
				SR:  9233,
				USP: 3961036,
				SSP: 10385274,
				RAM: [][2]uint32{{7823056, 68}, {7823057, 152}, {7823058, 75}, {7823059, 34}, {10984482, 50}, {10984483, 30}, {10984484, 198}, {10984485, 204}, {7823060, 117}, {7823061, 5}},
				Cycles: 20,
			},
		},
		{
			name: "004 NEG.l (xxx).w 44b8",
			init: 			cpuState{
				D:   [8]uint32{1328870617, 446336190, 728374727, 651490176, 591291085, 3844712108, 3874991571, 1736740034},
				A:   [7]uint32{2020719606, 2711992169, 1043432286, 3408310746, 4056353530, 4026529297, 2587747289},
				PC:  7863630,
				SR:  9217,
				USP: 12263342,
				SSP: 10560886,
				RAM: [][2]uint32{{7863626, 68}, {7863627, 184}, {7863628, 235}, {7863629, 94}, {7863630, 191}, {7863631, 225}, {16771934, 201}, {16771935, 9}, {16771936, 81}, {16771937, 37}, {7863632, 229}, {7863633, 66}},
			},
			want: 			cpuState{
				D:   [8]uint32{1328870617, 446336190, 728374727, 651490176, 591291085, 3844712108, 3874991571, 1736740034},
				A:   [7]uint32{2020719606, 2711992169, 1043432286, 3408310746, 4056353530, 4026529297, 2587747289},
				PC:  7863634,
				SR:  9233,
				USP: 12263342,
				SSP: 10560886,
				RAM: [][2]uint32{{7863626, 68}, {7863627, 184}, {7863628, 235}, {7863629, 94}, {7863630, 191}, {7863631, 225}, {16771934, 54}, {16771935, 246}, {16771936, 174}, {16771937, 219}, {7863632, 229}, {7863633, 66}},
				Cycles: 24,
			},
		},
		{
			name: "305 NEG.l D6 4486",
			init: 			cpuState{
				D:   [8]uint32{664176215, 2074859152, 4045982118, 2903213018, 4058996823, 3735981481, 3312415148, 1070216406},
				A:   [7]uint32{1688838906, 1515490615, 95336306, 623567770, 3232605218, 989236729, 681067053},
				PC:  15383598,
				SR:  8479,
				USP: 14436122,
				SSP: 16491852,
				RAM: [][2]uint32{{15383594, 68}, {15383595, 134}, {15383596, 146}, {15383597, 254}, {15383598, 114}, {15383599, 59}},
			},
			want: 			cpuState{
				D:   [8]uint32{664176215, 2074859152, 4045982118, 2903213018, 4058996823, 3735981481, 982552148, 1070216406},
				A:   [7]uint32{1688838906, 1515490615, 95336306, 623567770, 3232605218, 989236729, 681067053},
				PC:  15383600,
				SR:  8465,
				USP: 14436122,
				SSP: 16491852,
				RAM: [][2]uint32{{15383594, 68}, {15383595, 134}, {15383596, 146}, {15383597, 254}, {15383598, 114}, {15383599, 59}},
				Cycles: 6,
			},
		},
		{
			name: "591 NEG.l -(A5) 44a5",
			init: 			cpuState{
				D:   [8]uint32{2582883929, 3752853286, 2272087729, 2137697233, 1106635650, 3720069563, 1108677723, 4209546541},
				A:   [7]uint32{785165335, 3289935778, 3194854664, 3350246375, 3537229366, 2924603352, 4236993587},
				PC:  7199002,
				SR:  778,
				USP: 2075854,
				SSP: 8251344,
				RAM: [][2]uint32{{7198998, 68}, {7198999, 165}, {7199000, 101}, {7199001, 47}, {5367764, 197}, {5367765, 33}, {5367766, 138}, {5367767, 49}, {7199002, 190}, {7199003, 230}},
			},
			want: 			cpuState{
				D:   [8]uint32{2582883929, 3752853286, 2272087729, 2137697233, 1106635650, 3720069563, 1108677723, 4209546541},
				A:   [7]uint32{785165335, 3289935778, 3194854664, 3350246375, 3537229366, 2924603348, 4236993587},
				PC:  7199004,
				SR:  785,
				USP: 2075854,
				SSP: 8251344,
				RAM: [][2]uint32{{7198998, 68}, {7198999, 165}, {7199000, 101}, {7199001, 47}, {5367764, 58}, {5367765, 222}, {5367766, 117}, {5367767, 207}, {7199002, 190}, {7199003, 230}},
				Cycles: 22,
			},
		},
		{
			name: "895 NEG.l -(A0) 44a0",
			init: 			cpuState{
				D:   [8]uint32{4170825604, 2414120494, 342725064, 4001624565, 1485847188, 3376373662, 3590796092, 237797576},
				A:   [7]uint32{3248217490, 91167905, 897733774, 2907968111, 102556469, 876188266, 1081938530},
				PC:  1790566,
				SR:  264,
				USP: 11353408,
				SSP: 13780244,
				RAM: [][2]uint32{{1790562, 68}, {1790563, 160}, {1790564, 2}, {1790565, 161}, {10214798, 210}, {10214799, 165}, {10214800, 254}, {10214801, 151}, {1790566, 139}, {1790567, 48}},
			},
			want: 			cpuState{
				D:   [8]uint32{4170825604, 2414120494, 342725064, 4001624565, 1485847188, 3376373662, 3590796092, 237797576},
				A:   [7]uint32{3248217486, 91167905, 897733774, 2907968111, 102556469, 876188266, 1081938530},
				PC:  1790568,
				SR:  273,
				USP: 11353408,
				SSP: 13780244,
				RAM: [][2]uint32{{1790562, 68}, {1790563, 160}, {1790564, 2}, {1790565, 161}, {10214798, 45}, {10214799, 90}, {10214800, 1}, {10214801, 105}, {1790566, 139}, {1790567, 48}},
				Cycles: 22,
			},
		},
		{
			name: "1171 NEG.l -(A3) 44a3",
			init: 			cpuState{
				D:   [8]uint32{301625621, 905311121, 2831111962, 1098563703, 1100952638, 2983134690, 3678439304, 920643089},
				A:   [7]uint32{4130970705, 4082763955, 3583776618, 4219343472, 4156360389, 1684499967, 574983805},
				PC:  8092458,
				SR:  779,
				USP: 8272898,
				SSP: 11571944,
				RAM: [][2]uint32{{8092454, 68}, {8092455, 163}, {8092456, 151}, {8092457, 78}, {8262252, 35}, {8262253, 116}, {8262254, 182}, {8262255, 126}, {8092458, 233}, {8092459, 89}},
			},
			want: 			cpuState{
				D:   [8]uint32{301625621, 905311121, 2831111962, 1098563703, 1100952638, 2983134690, 3678439304, 920643089},
				A:   [7]uint32{4130970705, 4082763955, 3583776618, 4219343468, 4156360389, 1684499967, 574983805},
				PC:  8092460,
				SR:  793,
				USP: 8272898,
				SSP: 11571944,
				RAM: [][2]uint32{{8092454, 68}, {8092455, 163}, {8092456, 151}, {8092457, 78}, {8262252, 220}, {8262253, 139}, {8262254, 73}, {8262255, 130}, {8092458, 233}, {8092459, 89}},
				Cycles: 22,
			},
		},
		{
			name: "1457 NEG.l -(A1) 44a1",
			init: 			cpuState{
				D:   [8]uint32{1230928567, 3378975236, 953867744, 697950955, 3828875893, 4171442091, 1313874990, 1503830541},
				A:   [7]uint32{1019309891, 105545438, 1895441664, 406237631, 2359020701, 2135238427, 3528163286},
				PC:  7910608,
				SR:  8478,
				USP: 3670796,
				SSP: 1021458,
				RAM: [][2]uint32{{7910604, 68}, {7910605, 161}, {7910606, 58}, {7910607, 208}, {4882138, 151}, {4882139, 130}, {4882140, 73}, {4882141, 163}, {7910608, 222}, {7910609, 1}},
			},
			want: 			cpuState{
				D:   [8]uint32{1230928567, 3378975236, 953867744, 697950955, 3828875893, 4171442091, 1313874990, 1503830541},
				A:   [7]uint32{1019309891, 105545434, 1895441664, 406237631, 2359020701, 2135238427, 3528163286},
				PC:  7910610,
				SR:  8465,
				USP: 3670796,
				SSP: 1021458,
				RAM: [][2]uint32{{7910604, 68}, {7910605, 161}, {7910606, 58}, {7910607, 208}, {4882138, 104}, {4882139, 125}, {4882140, 182}, {4882141, 93}, {7910608, 222}, {7910609, 1}},
				Cycles: 22,
			},
		},
		{
			name: "1724 NEG.l -(A6) 44a6",
			init: 			cpuState{
				D:   [8]uint32{1798423537, 1074430801, 3667697616, 1847950143, 186215830, 2872253544, 4274660919, 2121284902},
				A:   [7]uint32{3950315752, 2332193608, 4240859872, 2252227789, 3189650690, 4028887212, 2125286362},
				PC:  13452114,
				SR:  8961,
				USP: 8741358,
				SSP: 10016214,
				RAM: [][2]uint32{{13452110, 68}, {13452111, 166}, {13452112, 18}, {13452113, 4}, {11357142, 154}, {11357143, 202}, {11357144, 202}, {11357145, 82}, {13452114, 87}, {13452115, 34}},
			},
			want: 			cpuState{
				D:   [8]uint32{1798423537, 1074430801, 3667697616, 1847950143, 186215830, 2872253544, 4274660919, 2121284902},
				A:   [7]uint32{3950315752, 2332193608, 4240859872, 2252227789, 3189650690, 4028887212, 2125286358},
				PC:  13452116,
				SR:  8977,
				USP: 8741358,
				SSP: 10016214,
				RAM: [][2]uint32{{13452110, 68}, {13452111, 166}, {13452112, 18}, {13452113, 4}, {11357142, 101}, {11357143, 53}, {11357144, 53}, {11357145, 174}, {13452114, 87}, {13452115, 34}},
				Cycles: 22,
			},
		},
		{
			name: "1984 NEG.l (d8, A0, Xn) 44b0",
			init: 			cpuState{
				D:   [8]uint32{2785194040, 235459206, 629883415, 3419135947, 2411490723, 1589237883, 2499990162, 1245332436},
				A:   [7]uint32{3961720339, 1376532323, 2148076893, 4118613119, 833942975, 499069516, 2087088305},
				PC:  7143924,
				SR:  9739,
				USP: 11065042,
				SSP: 3122606,
				RAM: [][2]uint32{{7143920, 68}, {7143921, 176}, {7143922, 208}, {7143923, 231}, {7143924, 254}, {7143925, 130}, {2310214, 44}, {2310215, 92}, {2310216, 250}, {2310217, 89}, {7143926, 190}, {7143927, 169}},
			},
			want: 			cpuState{
				D:   [8]uint32{2785194040, 235459206, 629883415, 3419135947, 2411490723, 1589237883, 2499990162, 1245332436},
				A:   [7]uint32{3961720339, 1376532323, 2148076893, 4118613119, 833942975, 499069516, 2087088305},
				PC:  7143928,
				SR:  9753,
				USP: 11065042,
				SSP: 3122606,
				RAM: [][2]uint32{{7143920, 68}, {7143921, 176}, {7143922, 208}, {7143923, 231}, {7143924, 254}, {7143925, 130}, {2310214, 211}, {2310215, 163}, {2310216, 5}, {2310217, 167}, {7143926, 190}, {7143927, 169}},
				Cycles: 26,
			},
		},
		{
			name: "2234 NEG.l D1 4481",
			init: 			cpuState{
				D:   [8]uint32{2402628205, 3919294217, 1669181176, 3754268597, 3465001611, 89993682, 71111319, 1817630645},
				A:   [7]uint32{2970954851, 3979785660, 2031596661, 2846920810, 2873803197, 4056166075, 3612820097},
				PC:  6946650,
				SR:  1303,
				USP: 2023408,
				SSP: 3658240,
				RAM: [][2]uint32{{6946646, 68}, {6946647, 129}, {6946648, 242}, {6946649, 166}, {6946650, 7}, {6946651, 43}},
			},
			want: 			cpuState{
				D:   [8]uint32{2402628205, 375673079, 1669181176, 3754268597, 3465001611, 89993682, 71111319, 1817630645},
				A:   [7]uint32{2970954851, 3979785660, 2031596661, 2846920810, 2873803197, 4056166075, 3612820097},
				PC:  6946652,
				SR:  1297,
				USP: 2023408,
				SSP: 3658240,
				RAM: [][2]uint32{{6946646, 68}, {6946647, 129}, {6946648, 242}, {6946649, 166}, {6946650, 7}, {6946651, 43}},
				Cycles: 6,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNEGX_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NEGX.b D4 4004",
			init: cpuState{
				D:   [8]uint32{3980333592, 874802409, 3547105131, 2086528331, 3516025262, 4018885167, 3021613333, 725556595},
				A:   [7]uint32{4135520359, 4262412885, 3628678038, 1903614322, 1837529438, 1174442293, 258316547},
				PC:  12852440,
				SR:  9473,
				USP: 18164,
				SSP: 506524,
				RAM: [][2]uint32{{12852436, 64}, {12852437, 4}, {12852438, 170}, {12852439, 152}, {12852440, 206}, {12852441, 230}},
			},
			want: cpuState{
				D:   [8]uint32{3980333592, 874802409, 3547105131, 2086528331, 3516025170, 4018885167, 3021613333, 725556595},
				A:   [7]uint32{4135520359, 4262412885, 3628678038, 1903614322, 1837529438, 1174442293, 258316547},
				PC:  12852442,
				SR:  9489,
				USP: 18164,
				SSP: 506524,
				RAM: [][2]uint32{{12852436, 64}, {12852437, 4}, {12852438, 170}, {12852439, 152}, {12852440, 206}, {12852441, 230}},
				Cycles: 4,
			},
		},
		{
			name: "500 NEGX.b (d8, A1, Xn) 4031",
			init: cpuState{
				D:   [8]uint32{779448900, 1836693705, 578847797, 51354482, 918121271, 1356123195, 1512677812, 471225132},
				A:   [7]uint32{4046098897, 1024231822, 3009554779, 4231646865, 2748788438, 4277691689, 951330482},
				PC:  7299394,
				SR:  1794,
				USP: 10784694,
				SSP: 8131868,
				RAM: [][2]uint32{{7299390, 64}, {7299391, 49}, {7299392, 107}, {7299393, 16}, {7299394, 97}, {7299395, 78}, {3550034, 48}, {3550035, 15}, {7299396, 29}, {7299397, 51}},
			},
			want: cpuState{
				D:   [8]uint32{779448900, 1836693705, 578847797, 51354482, 918121271, 1356123195, 1512677812, 471225132},
				A:   [7]uint32{4046098897, 1024231822, 3009554779, 4231646865, 2748788438, 4277691689, 951330482},
				PC:  7299398,
				SR:  1817,
				USP: 10784694,
				SSP: 8131868,
				RAM: [][2]uint32{{7299390, 64}, {7299391, 49}, {7299392, 107}, {7299393, 16}, {7299394, 97}, {7299395, 78}, {3550034, 208}, {3550035, 15}, {7299396, 29}, {7299397, 51}},
				Cycles: 18,
			},
		},
		{
			name: "1000 NEGX.b (d16, A6) 402e",
			init: cpuState{
				D:   [8]uint32{11066133, 3698093092, 49542838, 2461574175, 1295205905, 2386816731, 1574440678, 4127703378},
				A:   [7]uint32{763463074, 3395581797, 2827092875, 1229755049, 933990074, 1810603751, 3429094173},
				PC:  1560824,
				SR:  34072,
				USP: 8029710,
				SSP: 3991910,
				RAM: [][2]uint32{{1560820, 64}, {1560821, 46}, {1560822, 46}, {1560823, 251}, {1560824, 102}, {1560825, 95}, {6554136, 34}, {6554137, 168}, {1560826, 207}, {1560827, 161}},
			},
			want: cpuState{
				D:   [8]uint32{11066133, 3698093092, 49542838, 2461574175, 1295205905, 2386816731, 1574440678, 4127703378},
				A:   [7]uint32{763463074, 3395581797, 2827092875, 1229755049, 933990074, 1810603751, 3429094173},
				PC:  1560828,
				SR:  34073,
				USP: 8029710,
				SSP: 3991910,
				RAM: [][2]uint32{{1560820, 64}, {1560821, 46}, {1560822, 46}, {1560823, 251}, {1560824, 102}, {1560825, 95}, {6554136, 221}, {6554137, 168}, {1560826, 207}, {1560827, 161}},
				Cycles: 16,
			},
		},
		{
			name: "1500 NEGX.b (A2)+ 401a",
			init: cpuState{
				D:   [8]uint32{4123596445, 2369664390, 1790215658, 4064424284, 204433936, 3140704313, 4257698800, 1164461973},
				A:   [7]uint32{233767048, 2476974590, 1587941988, 2593478033, 2684713315, 443548151, 1998600408},
				PC:  2074270,
				SR:  34321,
				USP: 6229444,
				SSP: 1757354,
				RAM: [][2]uint32{{2074266, 64}, {2074267, 26}, {2074268, 113}, {2074269, 11}, {10883684, 137}, {10883685, 156}, {2074270, 70}, {2074271, 6}},
			},
			want: cpuState{
				D:   [8]uint32{4123596445, 2369664390, 1790215658, 4064424284, 204433936, 3140704313, 4257698800, 1164461973},
				A:   [7]uint32{233767048, 2476974590, 1587941989, 2593478033, 2684713315, 443548151, 1998600408},
				PC:  2074272,
				SR:  34321,
				USP: 6229444,
				SSP: 1757354,
				RAM: [][2]uint32{{2074266, 64}, {2074267, 26}, {2074268, 113}, {2074269, 11}, {10883684, 118}, {10883685, 156}, {2074270, 70}, {2074271, 6}},
				Cycles: 12,
			},
		},
		{
			name: "2000 NEGX.b -(A4) 4024",
			init: cpuState{
				D:   [8]uint32{2762991148, 2120424293, 115103032, 570626981, 413385005, 1602143742, 1730016526, 903205874},
				A:   [7]uint32{3093332292, 896652120, 2365349382, 1154851703, 4102627304, 4004371961, 4096471579},
				PC:  10518912,
				SR:  9238,
				USP: 3399402,
				SSP: 5077546,
				RAM: [][2]uint32{{10518908, 64}, {10518909, 36}, {10518910, 83}, {10518911, 211}, {8986598, 229}, {8986599, 102}, {10518912, 252}, {10518913, 185}},
			},
			want: cpuState{
				D:   [8]uint32{2762991148, 2120424293, 115103032, 570626981, 413385005, 1602143742, 1730016526, 903205874},
				A:   [7]uint32{3093332292, 896652120, 2365349382, 1154851703, 4102627303, 4004371961, 4096471579},
				PC:  10518914,
				SR:  9241,
				USP: 3399402,
				SSP: 5077546,
				RAM: [][2]uint32{{10518908, 64}, {10518909, 36}, {10518910, 83}, {10518911, 211}, {8986598, 229}, {8986599, 153}, {10518912, 252}, {10518913, 185}},
				Cycles: 14,
			},
		},
		{
			name: "002 NEGX.b -(A4) 4024",
			init: 			cpuState{
				D:   [8]uint32{3125090859, 3118354489, 1136350604, 3393787694, 3238491954, 4005497426, 2891118263, 1004346531},
				A:   [7]uint32{3764900287, 2862348789, 555255301, 3869339978, 1562498107, 2499551444, 3153125524},
				PC:  11795602,
				SR:  1805,
				USP: 8655462,
				SSP: 15772006,
				RAM: [][2]uint32{{11795598, 64}, {11795599, 36}, {11795600, 132}, {11795601, 125}, {2217018, 137}, {2217019, 215}, {11795602, 152}, {11795603, 149}},
			},
			want: 			cpuState{
				D:   [8]uint32{3125090859, 3118354489, 1136350604, 3393787694, 3238491954, 4005497426, 2891118263, 1004346531},
				A:   [7]uint32{3764900287, 2862348789, 555255301, 3869339978, 1562498106, 2499551444, 3153125524},
				PC:  11795604,
				SR:  1809,
				USP: 8655462,
				SSP: 15772006,
				RAM: [][2]uint32{{11795598, 64}, {11795599, 36}, {11795600, 132}, {11795601, 125}, {2217018, 119}, {2217019, 215}, {11795602, 152}, {11795603, 149}},
				Cycles: 14,
			},
		},
		{
			name: "254 NEGX.b (xxx).l 4039",
			init: 			cpuState{
				D:   [8]uint32{3049899914, 2751534419, 2244555856, 1614937176, 918952848, 2651735875, 4099404371, 4271985009},
				A:   [7]uint32{454664901, 991829391, 3982505960, 77756169, 3926593963, 4046600411, 1823579555},
				PC:  7779834,
				SR:  8963,
				USP: 4773774,
				SSP: 5777298,
				RAM: [][2]uint32{{7779830, 64}, {7779831, 57}, {7779832, 140}, {7779833, 15}, {7779834, 15}, {7779835, 114}, {7779836, 208}, {7779837, 110}, {986994, 251}, {986995, 236}, {7779838, 20}, {7779839, 183}},
			},
			want: 			cpuState{
				D:   [8]uint32{3049899914, 2751534419, 2244555856, 1614937176, 918952848, 2651735875, 4099404371, 4271985009},
				A:   [7]uint32{454664901, 991829391, 3982505960, 77756169, 3926593963, 4046600411, 1823579555},
				PC:  7779840,
				SR:  8977,
				USP: 4773774,
				SSP: 5777298,
				RAM: [][2]uint32{{7779830, 64}, {7779831, 57}, {7779832, 140}, {7779833, 15}, {7779834, 15}, {7779835, 114}, {7779836, 208}, {7779837, 110}, {986994, 5}, {986995, 236}, {7779838, 20}, {7779839, 183}},
				Cycles: 20,
			},
		},
		{
			name: "537 NEGX.b (d8, A5, Xn) 4035",
			init: 			cpuState{
				D:   [8]uint32{681969791, 3023488694, 2991577158, 1977901562, 1548908349, 2634109438, 1888874488, 996584347},
				A:   [7]uint32{222329011, 1642251839, 1545339462, 311482003, 280655877, 2187698162, 175916201},
				PC:  15058206,
				SR:  8960,
				USP: 16515848,
				SSP: 16076326,
				RAM: [][2]uint32{{15058202, 64}, {15058203, 53}, {15058204, 17}, {15058205, 92}, {15058206, 216}, {15058207, 70}, {6645508, 47}, {6645509, 92}, {15058208, 138}, {15058209, 35}},
			},
			want: 			cpuState{
				D:   [8]uint32{681969791, 3023488694, 2991577158, 1977901562, 1548908349, 2634109438, 1888874488, 996584347},
				A:   [7]uint32{222329011, 1642251839, 1545339462, 311482003, 280655877, 2187698162, 175916201},
				PC:  15058210,
				SR:  8985,
				USP: 16515848,
				SSP: 16076326,
				RAM: [][2]uint32{{15058202, 64}, {15058203, 53}, {15058204, 17}, {15058205, 92}, {15058206, 216}, {15058207, 70}, {6645508, 209}, {6645509, 92}, {15058208, 138}, {15058209, 35}},
				Cycles: 18,
			},
		},
		{
			name: "809 NEGX.b (A0) 4010",
			init: 			cpuState{
				D:   [8]uint32{3186898930, 1073743837, 4247262569, 668826878, 1674370217, 952716391, 3046786432, 496080366},
				A:   [7]uint32{1096461760, 2758918504, 2147745528, 3170356804, 3452789489, 4254548416, 667724028},
				PC:  12914520,
				SR:  1801,
				USP: 16755056,
				SSP: 11268178,
				RAM: [][2]uint32{{12914516, 64}, {12914517, 16}, {12914518, 39}, {12914519, 168}, {5942720, 106}, {5942721, 120}, {12914520, 1}, {12914521, 204}},
			},
			want: 			cpuState{
				D:   [8]uint32{3186898930, 1073743837, 4247262569, 668826878, 1674370217, 952716391, 3046786432, 496080366},
				A:   [7]uint32{1096461760, 2758918504, 2147745528, 3170356804, 3452789489, 4254548416, 667724028},
				PC:  12914522,
				SR:  1817,
				USP: 16755056,
				SSP: 11268178,
				RAM: [][2]uint32{{12914516, 64}, {12914517, 16}, {12914518, 39}, {12914519, 168}, {5942720, 150}, {5942721, 120}, {12914520, 1}, {12914521, 204}},
				Cycles: 12,
			},
		},
		{
			name: "1077 NEGX.b (A6) 4016",
			init: 			cpuState{
				D:   [8]uint32{3266074903, 1647030357, 2969366119, 1416915002, 1702735528, 3434089095, 2732911564, 3028472876},
				A:   [7]uint32{546370666, 3073108433, 3630828636, 2198645885, 2499327939, 1012149146, 2550117940},
				PC:  537378,
				SR:  1299,
				USP: 384846,
				SSP: 3113852,
				RAM: [][2]uint32{{537374, 64}, {537375, 22}, {537376, 15}, {537377, 80}, {16758324, 24}, {16758325, 66}, {537378, 120}, {537379, 80}},
			},
			want: 			cpuState{
				D:   [8]uint32{3266074903, 1647030357, 2969366119, 1416915002, 1702735528, 3434089095, 2732911564, 3028472876},
				A:   [7]uint32{546370666, 3073108433, 3630828636, 2198645885, 2499327939, 1012149146, 2550117940},
				PC:  537380,
				SR:  1305,
				USP: 384846,
				SSP: 3113852,
				RAM: [][2]uint32{{537374, 64}, {537375, 22}, {537376, 15}, {537377, 80}, {16758324, 231}, {16758325, 66}, {537378, 120}, {537379, 80}},
				Cycles: 12,
			},
		},
		{
			name: "1335 NEGX.b D2 4002",
			init: 			cpuState{
				D:   [8]uint32{3644510176, 392504582, 1861051316, 28435562, 2633309088, 781809907, 1039263615, 3781942913},
				A:   [7]uint32{2856986354, 2203593411, 2678842186, 2511346144, 378907870, 3662775021, 3984009900},
				PC:  410644,
				SR:  779,
				USP: 9411634,
				SSP: 2588722,
				RAM: [][2]uint32{{410640, 64}, {410641, 2}, {410642, 246}, {410643, 213}, {410644, 151}, {410645, 13}},
			},
			want: 			cpuState{
				D:   [8]uint32{3644510176, 392504582, 1861051212, 28435562, 2633309088, 781809907, 1039263615, 3781942913},
				A:   [7]uint32{2856986354, 2203593411, 2678842186, 2511346144, 378907870, 3662775021, 3984009900},
				PC:  410646,
				SR:  785,
				USP: 9411634,
				SSP: 2588722,
				RAM: [][2]uint32{{410640, 64}, {410641, 2}, {410642, 246}, {410643, 213}, {410644, 151}, {410645, 13}},
				Cycles: 4,
			},
		},
		{
			name: "1634 NEGX.b (d8, A1, Xn) 4031",
			init: 			cpuState{
				D:   [8]uint32{1403238030, 2069619012, 3473693804, 4166905976, 2102353084, 2181489936, 556786271, 1154428456},
				A:   [7]uint32{2606103111, 1146122888, 68032281, 2915690797, 3628627513, 2619675325, 3165570342},
				PC:  12722128,
				SR:  9477,
				USP: 11396216,
				SSP: 9866870,
				RAM: [][2]uint32{{12722124, 64}, {12722125, 49}, {12722126, 200}, {12722127, 175}, {12722128, 80}, {12722129, 171}, {10020976, 80}, {10020977, 66}, {12722130, 162}, {12722131, 201}},
			},
			want: 			cpuState{
				D:   [8]uint32{1403238030, 2069619012, 3473693804, 4166905976, 2102353084, 2181489936, 556786271, 1154428456},
				A:   [7]uint32{2606103111, 1146122888, 68032281, 2915690797, 3628627513, 2619675325, 3165570342},
				PC:  12722132,
				SR:  9497,
				USP: 11396216,
				SSP: 9866870,
				RAM: [][2]uint32{{12722124, 64}, {12722125, 49}, {12722126, 200}, {12722127, 175}, {12722128, 80}, {12722129, 171}, {10020976, 176}, {10020977, 66}, {12722130, 162}, {12722131, 201}},
				Cycles: 18,
			},
		},
		{
			name: "1947 NEGX.b D0 4000",
			init: 			cpuState{
				D:   [8]uint32{3113261598, 607088979, 1666080571, 2691410734, 216481716, 3626072459, 2397257140, 1776781318},
				A:   [7]uint32{1612087482, 3782184541, 1465411475, 623662740, 290680920, 1022258659, 1273770116},
				PC:  2947044,
				SR:  772,
				USP: 14647046,
				SSP: 499606,
				RAM: [][2]uint32{{2947040, 64}, {2947041, 0}, {2947042, 35}, {2947043, 95}, {2947044, 103}, {2947045, 25}},
			},
			want: 			cpuState{
				D:   [8]uint32{3113261794, 607088979, 1666080571, 2691410734, 216481716, 3626072459, 2397257140, 1776781318},
				A:   [7]uint32{1612087482, 3782184541, 1465411475, 623662740, 290680920, 1022258659, 1273770116},
				PC:  2947046,
				SR:  793,
				USP: 14647046,
				SSP: 499606,
				RAM: [][2]uint32{{2947040, 64}, {2947041, 0}, {2947042, 35}, {2947043, 95}, {2947044, 103}, {2947045, 25}},
				Cycles: 4,
			},
		},
		{
			name: "2217 NEGX.b (A5)+ 401d",
			init: 			cpuState{
				D:   [8]uint32{2080275136, 1817915653, 1905706748, 272763018, 377431833, 1016060711, 1317997611, 2598036778},
				A:   [7]uint32{4223587922, 2444082583, 2441644924, 2780996675, 2884954505, 1107103308, 2770818496},
				PC:  1647948,
				SR:  9752,
				USP: 6376552,
				SSP: 6807908,
				RAM: [][2]uint32{{1647944, 64}, {1647945, 29}, {1647946, 220}, {1647947, 192}, {16584268, 105}, {16584269, 24}, {1647948, 104}, {1647949, 153}},
			},
			want: 			cpuState{
				D:   [8]uint32{2080275136, 1817915653, 1905706748, 272763018, 377431833, 1016060711, 1317997611, 2598036778},
				A:   [7]uint32{4223587922, 2444082583, 2441644924, 2780996675, 2884954505, 1107103309, 2770818496},
				PC:  1647950,
				SR:  9753,
				USP: 6376552,
				SSP: 6807908,
				RAM: [][2]uint32{{1647944, 64}, {1647945, 29}, {1647946, 220}, {1647947, 192}, {16584268, 150}, {16584269, 24}, {1647948, 104}, {1647949, 153}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNEGX_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NEGX.w (d16, A1) 4069",
			init: cpuState{
				D:   [8]uint32{1064059708, 2948880760, 3150013704, 1370511521, 1090054400, 2992938096, 1579011178, 3096968114},
				A:   [7]uint32{671629648, 1609631514, 2343267296, 3868328393, 2033000172, 1710072273, 813654814},
				PC:  2523460,
				SR:  8470,
				USP: 14584866,
				SSP: 6486856,
				RAM: [][2]uint32{{2523456, 64}, {2523457, 105}, {2523458, 230}, {2523459, 181}, {2523460, 225}, {2523461, 98}, {12, 137}, {13, 86}, {14, 131}, {15, 142}, {5669774, 14}, {5669775, 36}, {5669776, 111}, {5669777, 86}},
			},
			want: cpuState{
				D:      [8]uint32{1064059708, 2948880760, 3150013704, 1370511521, 1090054400, 2992938096, 1579011178, 3096968114},
				A:      [7]uint32{671629648, 1609631514, 2343267296, 3868328393, 2033000172, 1710072273, 813654814},
				PC:     2304148370,
				SR:     8470,
				USP:    14584866,
				SSP:    6486842,
				RAM:    [][2]uint32{{2523456, 64}, {2523457, 105}, {2523458, 230}, {2523459, 181}, {2523460, 225}, {2523461, 98}, {6486854, 129}, {6486855, 66}, {6486850, 33}, {6486851, 22}, {6486852, 0}, {6486853, 38}, {6486848, 64}, {6486849, 105}, {6486846, 237}, {6486847, 207}, {6486842, 64}, {6486843, 117}, {6486844, 95}, {6486845, 240}, {12, 137}, {13, 86}, {14, 131}, {15, 142}, {5669774, 14}, {5669775, 36}, {5669776, 111}, {5669777, 86}},
				Halted: true,
			},
		},
		{
			name: "500 NEGX.w (d16, A6) 406e",
			init: cpuState{
				D:   [8]uint32{2777281223, 732087108, 3932581887, 910388629, 2612108473, 418631947, 3082288770, 1234535461},
				A:   [7]uint32{2239970411, 1087513444, 3180514328, 2186521960, 2251003407, 1638231520, 2741287547},
				PC:  5567408,
				SR:  526,
				USP: 8099216,
				SSP: 3790816,
				RAM: [][2]uint32{{5567404, 64}, {5567405, 110}, {5567406, 63}, {5567407, 132}, {5567408, 36}, {5567409, 216}, {12, 30}, {13, 220}, {14, 45}, {15, 74}, {14429514, 16}, {14429515, 8}, {14429516, 245}, {14429517, 121}},
			},
			want: cpuState{
				D:      [8]uint32{2777281223, 732087108, 3932581887, 910388629, 2612108473, 418631947, 3082288770, 1234535461},
				A:      [7]uint32{2239970411, 1087513444, 3180514328, 2186521960, 2251003407, 1638231520, 2741287547},
				PC:     517745998,
				SR:     8718,
				USP:    8099216,
				SSP:    3790802,
				RAM:    [][2]uint32{{5567404, 64}, {5567405, 110}, {5567406, 63}, {5567407, 132}, {5567408, 36}, {5567409, 216}, {3790814, 243}, {3790815, 174}, {3790810, 2}, {3790811, 14}, {3790812, 0}, {3790813, 84}, {3790808, 64}, {3790809, 110}, {3790806, 249}, {3790807, 255}, {3790802, 64}, {3790803, 113}, {3790804, 163}, {3790805, 100}, {12, 30}, {13, 220}, {14, 45}, {15, 74}, {14429514, 16}, {14429515, 8}, {14429516, 245}, {14429517, 121}},
				Halted: true,
			},
		},
		{
			name: "1000 NEGX.w (d8, A1, Xn) 4071",
			init: cpuState{
				D:   [8]uint32{3842873051, 4137188192, 181526536, 75040596, 1482918950, 319385367, 783924732, 971181099},
				A:   [7]uint32{1532412480, 1702480641, 1038355970, 2617144223, 3119047569, 317415789, 270821705},
				PC:  2208734,
				SR:  514,
				USP: 178180,
				SSP: 16349680,
				RAM: [][2]uint32{{2208730, 64}, {2208731, 113}, {2208732, 112}, {2208733, 27}, {2208734, 64}, {2208735, 68}, {12, 73}, {13, 228}, {14, 88}, {15, 2}, {14964738, 28}, {14964739, 180}, {14964740, 215}, {14964741, 108}},
			},
			want: cpuState{
				D:      [8]uint32{3842873051, 4137188192, 181526536, 75040596, 1482918950, 319385367, 783924732, 971181099},
				A:      [7]uint32{1532412480, 1702480641, 1038355970, 2617144223, 3119047569, 317415789, 270821705},
				PC:     1239701510,
				SR:     8706,
				USP:    178180,
				SSP:    16349666,
				RAM:    [][2]uint32{{2208730, 64}, {2208731, 113}, {2208732, 112}, {2208733, 27}, {2208734, 64}, {2208735, 68}, {16349678, 179}, {16349679, 220}, {16349674, 2}, {16349675, 2}, {16349676, 0}, {16349677, 33}, {16349672, 64}, {16349673, 113}, {16349670, 215}, {16349671, 71}, {16349666, 64}, {16349667, 113}, {16349668, 101}, {16349669, 121}, {12, 73}, {13, 228}, {14, 88}, {15, 2}, {14964738, 28}, {14964739, 180}, {14964740, 215}, {14964741, 108}},
				Halted: true,
			},
		},
		{
			name: "1500 NEGX.w D1 4041",
			init: cpuState{
				D:   [8]uint32{2296759308, 2907016722, 1542574161, 2607177950, 3953991193, 1274392134, 2426391365, 4028269222},
				A:   [7]uint32{80423850, 2582462382, 2470789728, 2189346364, 4271158815, 3825166643, 2809976678},
				PC:  15932072,
				SR:  8205,
				USP: 11605910,
				SSP: 4163182,
				RAM: [][2]uint32{{15932068, 64}, {15932069, 65}, {15932070, 25}, {15932071, 193}, {15932072, 67}, {15932073, 105}},
			},
			want: cpuState{
				D:   [8]uint32{2296759308, 2907009518, 1542574161, 2607177950, 3953991193, 1274392134, 2426391365, 4028269222},
				A:   [7]uint32{80423850, 2582462382, 2470789728, 2189346364, 4271158815, 3825166643, 2809976678},
				PC:  15932074,
				SR:  8209,
				USP: 11605910,
				SSP: 4163182,
				RAM: [][2]uint32{{15932068, 64}, {15932069, 65}, {15932070, 25}, {15932071, 193}, {15932072, 67}, {15932073, 105}},
				Cycles: 4,
			},
		},
		{
			name: "2000 NEGX.w D4 4044",
			init: cpuState{
				D:   [8]uint32{3322846783, 2301773415, 3097965220, 598260863, 3640736768, 1999808889, 36380249, 2084825944},
				A:   [7]uint32{2376813229, 1372505702, 306325296, 4110400587, 2377250960, 2627511076, 2732170484},
				PC:  12754342,
				SR:  795,
				USP: 6245492,
				SSP: 10228444,
				RAM: [][2]uint32{{12754338, 64}, {12754339, 68}, {12754340, 78}, {12754341, 241}, {12754342, 252}, {12754343, 69}},
			},
			want: cpuState{
				D:   [8]uint32{3322846783, 2301773415, 3097965220, 598260863, 3640771583, 1999808889, 36380249, 2084825944},
				A:   [7]uint32{2376813229, 1372505702, 306325296, 4110400587, 2377250960, 2627511076, 2732170484},
				PC:  12754344,
				SR:  793,
				USP: 6245492,
				SSP: 10228444,
				RAM: [][2]uint32{{12754338, 64}, {12754339, 68}, {12754340, 78}, {12754341, 241}, {12754342, 252}, {12754343, 69}},
				Cycles: 4,
			},
		},
		{
			name: "002 NEGX.w (A1)+ 4059",
			init: 			cpuState{
				D:   [8]uint32{1004192856, 412694302, 1807903973, 2393620110, 121933855, 3629248729, 1239400787, 1058046155},
				A:   [7]uint32{1275289458, 2775409870, 1336577812, 3179334759, 365311937, 2404985702, 1379096559},
				PC:  9345920,
				SR:  271,
				USP: 4393998,
				SSP: 9706566,
				RAM: [][2]uint32{{9345916, 64}, {9345917, 89}, {9345918, 212}, {9345919, 0}, {7169230, 171}, {7169231, 249}, {9345920, 168}, {9345921, 152}},
			},
			want: 			cpuState{
				D:   [8]uint32{1004192856, 412694302, 1807903973, 2393620110, 121933855, 3629248729, 1239400787, 1058046155},
				A:   [7]uint32{1275289458, 2775409872, 1336577812, 3179334759, 365311937, 2404985702, 1379096559},
				PC:  9345922,
				SR:  273,
				USP: 4393998,
				SSP: 9706566,
				RAM: [][2]uint32{{9345916, 64}, {9345917, 89}, {9345918, 212}, {9345919, 0}, {7169230, 84}, {7169231, 7}, {9345920, 168}, {9345921, 152}},
				Cycles: 12,
			},
		},
		{
			name: "249 NEGX.w D3 4043",
			init: 			cpuState{
				D:   [8]uint32{4193049750, 1187745360, 4294533212, 970524485, 2151939787, 954625469, 1936266585, 354264037},
				A:   [7]uint32{666625425, 3574210807, 4260896285, 2007617278, 1042479345, 408548891, 1569434075},
				PC:  16435174,
				SR:  281,
				USP: 16529252,
				SSP: 6232724,
				RAM: [][2]uint32{{16435170, 64}, {16435171, 67}, {16435172, 15}, {16435173, 109}, {16435174, 217}, {16435175, 23}},
			},
			want: 			cpuState{
				D:   [8]uint32{4193049750, 1187745360, 4294533212, 970586298, 2151939787, 954625469, 1936266585, 354264037},
				A:   [7]uint32{666625425, 3574210807, 4260896285, 2007617278, 1042479345, 408548891, 1569434075},
				PC:  16435176,
				SR:  281,
				USP: 16529252,
				SSP: 6232724,
				RAM: [][2]uint32{{16435170, 64}, {16435171, 67}, {16435172, 15}, {16435173, 109}, {16435174, 217}, {16435175, 23}},
				Cycles: 4,
			},
		},
		{
			name: "512 NEGX.w -(A1) 4061",
			init: 			cpuState{
				D:   [8]uint32{797645701, 3415957999, 3612392040, 1866579544, 2976115704, 2244198462, 2263110423, 3515702202},
				A:   [7]uint32{2991065981, 1995003148, 3366182905, 499357889, 2423799392, 16347952, 1781813496},
				PC:  62056,
				SR:  8964,
				USP: 7594372,
				SSP: 500934,
				RAM: [][2]uint32{{62052, 64}, {62053, 97}, {62054, 231}, {62055, 203}, {15291658, 166}, {15291659, 106}, {62056, 108}, {62057, 234}},
			},
			want: 			cpuState{
				D:   [8]uint32{797645701, 3415957999, 3612392040, 1866579544, 2976115704, 2244198462, 2263110423, 3515702202},
				A:   [7]uint32{2991065981, 1995003146, 3366182905, 499357889, 2423799392, 16347952, 1781813496},
				PC:  62058,
				SR:  8977,
				USP: 7594372,
				SSP: 500934,
				RAM: [][2]uint32{{62052, 64}, {62053, 97}, {62054, 231}, {62055, 203}, {15291658, 89}, {15291659, 150}, {62056, 108}, {62057, 234}},
				Cycles: 14,
			},
		},
		{
			name: "771 NEGX.w (d16, A3) 406b",
			init: 			cpuState{
				D:   [8]uint32{578241697, 2659550304, 4282658884, 790263632, 494116575, 2035829390, 1725858356, 134043776},
				A:   [7]uint32{782393357, 3235567824, 635183842, 2506596319, 3412384525, 2179810351, 108114021},
				PC:  6827302,
				SR:  8970,
				USP: 2138930,
				SSP: 16355154,
				RAM: [][2]uint32{{6827298, 64}, {6827299, 107}, {6827300, 194}, {6827301, 169}, {6827302, 221}, {6827303, 55}, {6775432, 160}, {6775433, 209}, {6827304, 165}, {6827305, 39}},
			},
			want: 			cpuState{
				D:   [8]uint32{578241697, 2659550304, 4282658884, 790263632, 494116575, 2035829390, 1725858356, 134043776},
				A:   [7]uint32{782393357, 3235567824, 635183842, 2506596319, 3412384525, 2179810351, 108114021},
				PC:  6827306,
				SR:  8977,
				USP: 2138930,
				SSP: 16355154,
				RAM: [][2]uint32{{6827298, 64}, {6827299, 107}, {6827300, 194}, {6827301, 169}, {6827302, 221}, {6827303, 55}, {6775432, 95}, {6775433, 47}, {6827304, 165}, {6827305, 39}},
				Cycles: 16,
			},
		},
		{
			name: "1076 NEGX.w -(A5) 4065",
			init: 			cpuState{
				D:   [8]uint32{1923632249, 1853985422, 4098700157, 1460978341, 2366139150, 1420528672, 2951637194, 3374773393},
				A:   [7]uint32{3355694439, 613461494, 1115885473, 2152537033, 2042767076, 1636828848, 2336094349},
				PC:  4484798,
				SR:  1548,
				USP: 5080758,
				SSP: 8718560,
				RAM: [][2]uint32{{4484794, 64}, {4484795, 101}, {4484796, 243}, {4484797, 210}, {9438894, 190}, {9438895, 84}, {4484798, 54}, {4484799, 52}},
			},
			want: 			cpuState{
				D:   [8]uint32{1923632249, 1853985422, 4098700157, 1460978341, 2366139150, 1420528672, 2951637194, 3374773393},
				A:   [7]uint32{3355694439, 613461494, 1115885473, 2152537033, 2042767076, 1636828846, 2336094349},
				PC:  4484800,
				SR:  1553,
				USP: 5080758,
				SSP: 8718560,
				RAM: [][2]uint32{{4484794, 64}, {4484795, 101}, {4484796, 243}, {4484797, 210}, {9438894, 65}, {9438895, 172}, {4484798, 54}, {4484799, 52}},
				Cycles: 14,
			},
		},
		{
			name: "1354 NEGX.w (A5) 4055",
			init: 			cpuState{
				D:   [8]uint32{1527794760, 505719915, 3100604498, 1276149782, 964509442, 1852237478, 3689318903, 2242259925},
				A:   [7]uint32{2797121502, 1043736950, 489225185, 4200008415, 2453955688, 1631954264, 746379057},
				PC:  4068996,
				SR:  8983,
				USP: 1935198,
				SSP: 701278,
				RAM: [][2]uint32{{4068992, 64}, {4068993, 85}, {4068994, 40}, {4068995, 191}, {4564312, 33}, {4564313, 237}, {4068996, 21}, {4068997, 132}},
			},
			want: 			cpuState{
				D:   [8]uint32{1527794760, 505719915, 3100604498, 1276149782, 964509442, 1852237478, 3689318903, 2242259925},
				A:   [7]uint32{2797121502, 1043736950, 489225185, 4200008415, 2453955688, 1631954264, 746379057},
				PC:  4068998,
				SR:  8985,
				USP: 1935198,
				SSP: 701278,
				RAM: [][2]uint32{{4068992, 64}, {4068993, 85}, {4068994, 40}, {4068995, 191}, {4564312, 222}, {4564313, 18}, {4068996, 21}, {4068997, 132}},
				Cycles: 12,
			},
		},
		{
			name: "1668 NEGX.w (A2) 4052",
			init: 			cpuState{
				D:   [8]uint32{2236860371, 889713172, 3454360784, 4099627010, 165639978, 4120853956, 342605577, 2627595098},
				A:   [7]uint32{30795582, 2926276502, 1393769606, 1562392292, 3797439999, 622684327, 4206299454},
				PC:  6439274,
				SR:  1303,
				USP: 15658164,
				SSP: 5824912,
				RAM: [][2]uint32{{6439270, 64}, {6439271, 82}, {6439272, 54}, {6439273, 42}, {1260678, 225}, {1260679, 143}, {6439274, 98}, {6439275, 122}},
			},
			want: 			cpuState{
				D:   [8]uint32{2236860371, 889713172, 3454360784, 4099627010, 165639978, 4120853956, 342605577, 2627595098},
				A:   [7]uint32{30795582, 2926276502, 1393769606, 1562392292, 3797439999, 622684327, 4206299454},
				PC:  6439276,
				SR:  1297,
				USP: 15658164,
				SSP: 5824912,
				RAM: [][2]uint32{{6439270, 64}, {6439271, 82}, {6439272, 54}, {6439273, 42}, {1260678, 30}, {1260679, 112}, {6439274, 98}, {6439275, 122}},
				Cycles: 12,
			},
		},
		{
			name: "1922 NEGX.w -(A4) 4064",
			init: 			cpuState{
				D:   [8]uint32{2811916179, 3457035954, 2512013799, 3645175162, 3206972373, 1275568772, 749311493, 2943187904},
				A:   [7]uint32{1781740455, 2509683364, 12616557, 1086349813, 244918994, 822572200, 1315143732},
				PC:  4018362,
				SR:  8475,
				USP: 1835154,
				SSP: 5107672,
				RAM: [][2]uint32{{4018358, 64}, {4018359, 100}, {4018360, 54}, {4018361, 153}, {10037968, 61}, {10037969, 98}, {4018362, 194}, {4018363, 0}},
			},
			want: 			cpuState{
				D:   [8]uint32{2811916179, 3457035954, 2512013799, 3645175162, 3206972373, 1275568772, 749311493, 2943187904},
				A:   [7]uint32{1781740455, 2509683364, 12616557, 1086349813, 244918992, 822572200, 1315143732},
				PC:  4018364,
				SR:  8473,
				USP: 1835154,
				SSP: 5107672,
				RAM: [][2]uint32{{4018358, 64}, {4018359, 100}, {4018360, 54}, {4018361, 153}, {10037968, 194}, {10037969, 157}, {4018362, 194}, {4018363, 0}},
				Cycles: 14,
			},
		},
		{
			name: "2196 NEGX.w D7 4047",
			init: 			cpuState{
				D:   [8]uint32{4201669071, 3389663449, 1240683914, 2382531493, 883454944, 3894952813, 3814618333, 3078590020},
				A:   [7]uint32{3610415074, 3014341935, 3813791502, 1169924892, 4059491013, 91311510, 4014458561},
				PC:  11661552,
				SR:  539,
				USP: 6826920,
				SSP: 3192024,
				RAM: [][2]uint32{{11661548, 64}, {11661549, 71}, {11661550, 32}, {11661551, 215}, {11661552, 107}, {11661553, 167}},
			},
			want: 			cpuState{
				D:   [8]uint32{4201669071, 3389663449, 1240683914, 2382531493, 883454944, 3894952813, 3814618333, 3078582715},
				A:   [7]uint32{3610415074, 3014341935, 3813791502, 1169924892, 4059491013, 91311510, 4014458561},
				PC:  11661554,
				SR:  529,
				USP: 6826920,
				SSP: 3192024,
				RAM: [][2]uint32{{11661548, 64}, {11661549, 71}, {11661550, 32}, {11661551, 215}, {11661552, 107}, {11661553, 167}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNEGX_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NEGX.l (A6)+ 409e",
			init: cpuState{
				D:   [8]uint32{4240857964, 1679385175, 3055850285, 2316363324, 2224790394, 85715596, 1509275769, 3288733101},
				A:   [7]uint32{1789172564, 2353643390, 2311147913, 3267304612, 3706756269, 3816240940, 2746850424},
				PC:  4880902,
				SR:  8222,
				USP: 4986334,
				SSP: 7780692,
				RAM: [][2]uint32{{4880898, 64}, {4880899, 158}, {4880900, 186}, {4880901, 132}, {12164216, 30}, {12164217, 54}, {12164218, 29}, {12164219, 250}, {4880902, 149}, {4880903, 215}},
			},
			want: cpuState{
				D:   [8]uint32{4240857964, 1679385175, 3055850285, 2316363324, 2224790394, 85715596, 1509275769, 3288733101},
				A:   [7]uint32{1789172564, 2353643390, 2311147913, 3267304612, 3706756269, 3816240940, 2746850428},
				PC:  4880904,
				SR:  8217,
				USP: 4986334,
				SSP: 7780692,
				RAM: [][2]uint32{{4880898, 64}, {4880899, 158}, {4880900, 186}, {4880901, 132}, {12164216, 225}, {12164217, 201}, {12164218, 226}, {12164219, 5}, {4880902, 149}, {4880903, 215}},
				Cycles: 20,
			},
		},
		{
			name: "500 NEGX.l D0 4080",
			init: cpuState{
				D:   [8]uint32{1028292963, 3888977925, 927288569, 606827059, 3506466882, 2436069606, 3367663369, 3807993776},
				A:   [7]uint32{170729621, 1755868974, 1591706618, 579617635, 2930088736, 1413302687, 2977931232},
				PC:  9491808,
				SR:  1308,
				USP: 12507300,
				SSP: 8365796,
				RAM: [][2]uint32{{9491804, 64}, {9491805, 128}, {9491806, 20}, {9491807, 65}, {9491808, 64}, {9491809, 23}},
			},
			want: cpuState{
				D:   [8]uint32{3266674332, 3888977925, 927288569, 606827059, 3506466882, 2436069606, 3367663369, 3807993776},
				A:   [7]uint32{170729621, 1755868974, 1591706618, 579617635, 2930088736, 1413302687, 2977931232},
				PC:  9491810,
				SR:  1305,
				USP: 12507300,
				SSP: 8365796,
				RAM: [][2]uint32{{9491804, 64}, {9491805, 128}, {9491806, 20}, {9491807, 65}, {9491808, 64}, {9491809, 23}},
				Cycles: 6,
			},
		},
		{
			name: "1000 NEGX.l D3 4083",
			init: cpuState{
				D:   [8]uint32{1282700620, 200846980, 1317557413, 1266262493, 625261358, 3631873799, 4257740204, 4271767421},
				A:   [7]uint32{4046120622, 4237388774, 45118112, 92172885, 2833000261, 871258928, 2188318111},
				PC:  1727590,
				SR:  531,
				USP: 8826766,
				SSP: 9212558,
				RAM: [][2]uint32{{1727586, 64}, {1727587, 131}, {1727588, 125}, {1727589, 136}, {1727590, 156}, {1727591, 254}},
			},
			want: cpuState{
				D:   [8]uint32{1282700620, 200846980, 1317557413, 3028704802, 625261358, 3631873799, 4257740204, 4271767421},
				A:   [7]uint32{4046120622, 4237388774, 45118112, 92172885, 2833000261, 871258928, 2188318111},
				PC:  1727592,
				SR:  537,
				USP: 8826766,
				SSP: 9212558,
				RAM: [][2]uint32{{1727586, 64}, {1727587, 131}, {1727588, 125}, {1727589, 136}, {1727590, 156}, {1727591, 254}},
				Cycles: 6,
			},
		},
		{
			name: "1500 NEGX.l (A7) 4097",
			init: cpuState{
				D:   [8]uint32{2608453345, 3169214991, 2448554872, 2975448585, 1963750723, 656202000, 3772950400, 1482845607},
				A:   [7]uint32{4196114662, 4202382138, 394648055, 3541570277, 3346200569, 3275516632, 3230502465},
				PC:  13027680,
				SR:  42773,
				USP: 4731840,
				SSP: 13508120,
				RAM: [][2]uint32{{13027676, 64}, {13027677, 151}, {13027678, 253}, {13027679, 241}, {13508120, 53}, {13508121, 117}, {13508122, 215}, {13508123, 103}, {13027680, 241}, {13027681, 116}},
			},
			want: cpuState{
				D:   [8]uint32{2608453345, 3169214991, 2448554872, 2975448585, 1963750723, 656202000, 3772950400, 1482845607},
				A:   [7]uint32{4196114662, 4202382138, 394648055, 3541570277, 3346200569, 3275516632, 3230502465},
				PC:  13027682,
				SR:  42777,
				USP: 4731840,
				SSP: 13508120,
				RAM: [][2]uint32{{13027676, 64}, {13027677, 151}, {13027678, 253}, {13027679, 241}, {13508120, 202}, {13508121, 138}, {13508122, 40}, {13508123, 152}, {13027680, 241}, {13027681, 116}},
				Cycles: 20,
			},
		},
		{
			name: "2000 NEGX.l -(A3) 40a3",
			init: cpuState{
				D:   [8]uint32{93941123, 2705081736, 4215729906, 780671896, 3329343442, 2263349083, 4028802248, 4006990731},
				A:   [7]uint32{561855232, 3693713646, 963574217, 491910599, 1574843593, 3285678042, 1871124792},
				PC:  9318520,
				SR:  1802,
				USP: 2873848,
				SSP: 9189338,
				RAM: [][2]uint32{{9318516, 64}, {9318517, 163}, {9318518, 252}, {9318519, 239}, {12, 233}, {13, 180}, {14, 32}, {15, 46}, {11804718, 183}, {11804719, 88}, {11804720, 24}, {11804721, 247}},
			},
			want: cpuState{
				D:      [8]uint32{93941123, 2705081736, 4215729906, 780671896, 3329343442, 2263349083, 4028802248, 4006990731},
				A:      [7]uint32{561855232, 3693713646, 963574217, 491910595, 1574843593, 3285678042, 1871124792},
				PC:     3920896050,
				SR:     9994,
				USP:    2873848,
				SSP:    9189324,
				RAM:    [][2]uint32{{9318516, 64}, {9318517, 163}, {9318518, 252}, {9318519, 239}, {9189336, 48}, {9189337, 118}, {9189332, 7}, {9189333, 10}, {9189334, 0}, {9189335, 142}, {9189330, 64}, {9189331, 163}, {9189328, 245}, {9189329, 195}, {9189324, 64}, {9189325, 177}, {9189326, 29}, {9189327, 81}, {12, 233}, {13, 180}, {14, 32}, {15, 46}, {11804718, 183}, {11804719, 88}, {11804720, 24}, {11804721, 247}},
				Halted: true,
			},
		},
		{
			name: "002 NEGX.l (d16, A7) 40af",
			init: 			cpuState{
				D:   [8]uint32{683925772, 3244640216, 1760153204, 1926778702, 3705856319, 3634767302, 894991788, 344053431},
				A:   [7]uint32{12735352, 1376838711, 2725203668, 1948621259, 510279146, 2401899929, 4021397454},
				PC:  2385766,
				SR:  8479,
				USP: 5659552,
				SSP: 5945788,
				RAM: [][2]uint32{{2385762, 64}, {2385763, 175}, {2385764, 94}, {2385765, 142}, {2385766, 10}, {2385767, 112}, {5969994, 171}, {5969995, 237}, {5969996, 146}, {5969997, 220}, {2385768, 29}, {2385769, 15}},
			},
			want: 			cpuState{
				D:   [8]uint32{683925772, 3244640216, 1760153204, 1926778702, 3705856319, 3634767302, 894991788, 344053431},
				A:   [7]uint32{12735352, 1376838711, 2725203668, 1948621259, 510279146, 2401899929, 4021397454},
				PC:  2385770,
				SR:  8465,
				USP: 5659552,
				SSP: 5945788,
				RAM: [][2]uint32{{2385762, 64}, {2385763, 175}, {2385764, 94}, {2385765, 142}, {2385766, 10}, {2385767, 112}, {5969994, 84}, {5969995, 18}, {5969996, 109}, {5969997, 35}, {2385768, 29}, {2385769, 15}},
				Cycles: 24,
			},
		},
		{
			name: "334 NEGX.l (A1)+ 4099",
			init: 			cpuState{
				D:   [8]uint32{3635965649, 4289415345, 3298952216, 198606247, 3403474228, 422721441, 1355928144, 900052106},
				A:   [7]uint32{782075257, 2536896024, 48419013, 3702631423, 1424909153, 3916331942, 1881579635},
				PC:  10373976,
				SR:  524,
				USP: 6468362,
				SSP: 12642444,
				RAM: [][2]uint32{{10373972, 64}, {10373973, 153}, {10373974, 212}, {10373975, 19}, {3536408, 254}, {3536409, 100}, {3536410, 34}, {3536411, 145}, {10373976, 25}, {10373977, 255}},
			},
			want: 			cpuState{
				D:   [8]uint32{3635965649, 4289415345, 3298952216, 198606247, 3403474228, 422721441, 1355928144, 900052106},
				A:   [7]uint32{782075257, 2536896028, 48419013, 3702631423, 1424909153, 3916331942, 1881579635},
				PC:  10373978,
				SR:  529,
				USP: 6468362,
				SSP: 12642444,
				RAM: [][2]uint32{{10373972, 64}, {10373973, 153}, {10373974, 212}, {10373975, 19}, {3536408, 1}, {3536409, 155}, {3536410, 221}, {3536411, 111}, {10373976, 25}, {10373977, 255}},
				Cycles: 20,
			},
		},
		{
			name: "579 NEGX.l (d8, A3, Xn) 40b3",
			init: 			cpuState{
				D:   [8]uint32{3060133023, 3943405214, 2343885111, 663851539, 2371698513, 308646292, 471836906, 4020457689},
				A:   [7]uint32{11931697, 1447377620, 2856822090, 2530175737, 1660520692, 1420968679, 3948149221},
				PC:  13329866,
				SR:  1031,
				USP: 3202618,
				SSP: 9905412,
				RAM: [][2]uint32{{13329862, 64}, {13329863, 179}, {13329864, 38}, {13329865, 66}, {13329866, 58}, {13329867, 82}, {13583474, 147}, {13583475, 197}, {13583476, 181}, {13583477, 94}, {13329868, 221}, {13329869, 34}},
			},
			want: 			cpuState{
				D:   [8]uint32{3060133023, 3943405214, 2343885111, 663851539, 2371698513, 308646292, 471836906, 4020457689},
				A:   [7]uint32{11931697, 1447377620, 2856822090, 2530175737, 1660520692, 1420968679, 3948149221},
				PC:  13329870,
				SR:  1041,
				USP: 3202618,
				SSP: 9905412,
				RAM: [][2]uint32{{13329862, 64}, {13329863, 179}, {13329864, 38}, {13329865, 66}, {13329866, 58}, {13329867, 82}, {13583474, 108}, {13583475, 58}, {13583476, 74}, {13583477, 162}, {13329868, 221}, {13329869, 34}},
				Cycles: 26,
			},
		},
		{
			name: "882 NEGX.l (d8, A6, Xn) 40b6",
			init: 			cpuState{
				D:   [8]uint32{767706779, 324173122, 2135500469, 1441209261, 1103867006, 4027749818, 3378181616, 3310416357},
				A:   [7]uint32{4161653104, 868991695, 397396440, 972436733, 3006824245, 4063046709, 2899307071},
				PC:  8346820,
				SR:  8974,
				USP: 13668670,
				SSP: 6903482,
				RAM: [][2]uint32{{8346816, 64}, {8346817, 182}, {8346818, 95}, {8346819, 89}, {8346820, 251}, {8346821, 145}, {14843986, 106}, {14843987, 74}, {14843988, 84}, {14843989, 184}, {8346822, 140}, {8346823, 177}},
			},
			want: 			cpuState{
				D:   [8]uint32{767706779, 324173122, 2135500469, 1441209261, 1103867006, 4027749818, 3378181616, 3310416357},
				A:   [7]uint32{4161653104, 868991695, 397396440, 972436733, 3006824245, 4063046709, 2899307071},
				PC:  8346824,
				SR:  8985,
				USP: 13668670,
				SSP: 6903482,
				RAM: [][2]uint32{{8346816, 64}, {8346817, 182}, {8346818, 95}, {8346819, 89}, {8346820, 251}, {8346821, 145}, {14843986, 149}, {14843987, 181}, {14843988, 171}, {14843989, 72}, {8346822, 140}, {8346823, 177}},
				Cycles: 26,
			},
		},
		{
			name: "1133 NEGX.l D6 4086",
			init: 			cpuState{
				D:   [8]uint32{1989226009, 4144522584, 4040222093, 3504937202, 1129323842, 2067472657, 3811695340, 960685837},
				A:   [7]uint32{3032364723, 4078067737, 1511189803, 2990551882, 1173879303, 1806989166, 433361500},
				PC:  566608,
				SR:  797,
				USP: 16260720,
				SSP: 7681232,
				RAM: [][2]uint32{{566604, 64}, {566605, 134}, {566606, 245}, {566607, 207}, {566608, 125}, {566609, 65}},
			},
			want: 			cpuState{
				D:   [8]uint32{1989226009, 4144522584, 4040222093, 3504937202, 1129323842, 2067472657, 483271955, 960685837},
				A:   [7]uint32{3032364723, 4078067737, 1511189803, 2990551882, 1173879303, 1806989166, 433361500},
				PC:  566610,
				SR:  785,
				USP: 16260720,
				SSP: 7681232,
				RAM: [][2]uint32{{566604, 64}, {566605, 134}, {566606, 245}, {566607, 207}, {566608, 125}, {566609, 65}},
				Cycles: 6,
			},
		},
		{
			name: "1413 NEGX.l (d16, A2) 40aa",
			init: 			cpuState{
				D:   [8]uint32{1176370454, 2430116445, 1398873870, 3379334462, 1782914391, 1112622701, 1867276938, 4214481796},
				A:   [7]uint32{2700332954, 2866185680, 402700282, 3938917661, 3662322318, 2387403572, 2258450266},
				PC:  12391810,
				SR:  783,
				USP: 10993028,
				SSP: 1801944,
				RAM: [][2]uint32{{12391806, 64}, {12391807, 170}, {12391808, 138}, {12391809, 142}, {12391810, 35}, {12391811, 245}, {17032, 190}, {17033, 83}, {17034, 38}, {17035, 52}, {12391812, 137}, {12391813, 44}},
			},
			want: 			cpuState{
				D:   [8]uint32{1176370454, 2430116445, 1398873870, 3379334462, 1782914391, 1112622701, 1867276938, 4214481796},
				A:   [7]uint32{2700332954, 2866185680, 402700282, 3938917661, 3662322318, 2387403572, 2258450266},
				PC:  12391814,
				SR:  785,
				USP: 10993028,
				SSP: 1801944,
				RAM: [][2]uint32{{12391806, 64}, {12391807, 170}, {12391808, 138}, {12391809, 142}, {12391810, 35}, {12391811, 245}, {17032, 65}, {17033, 172}, {17034, 217}, {17035, 204}, {12391812, 137}, {12391813, 44}},
				Cycles: 24,
			},
		},
		{
			name: "1676 NEGX.l -(A3) 40a3",
			init: 			cpuState{
				D:   [8]uint32{1351701241, 1511012905, 1414412304, 3086067221, 78677513, 2161639136, 3757637027, 3210946580},
				A:   [7]uint32{3358008598, 1454220375, 2310012359, 155506876, 1660039573, 2592022536, 3682868212},
				PC:  6633732,
				SR:  9744,
				USP: 7884960,
				SSP: 766428,
				RAM: [][2]uint32{{6633728, 64}, {6633729, 163}, {6633730, 184}, {6633731, 143}, {4511928, 11}, {4511929, 58}, {4511930, 33}, {4511931, 112}, {6633732, 78}, {6633733, 207}},
			},
			want: 			cpuState{
				D:   [8]uint32{1351701241, 1511012905, 1414412304, 3086067221, 78677513, 2161639136, 3757637027, 3210946580},
				A:   [7]uint32{3358008598, 1454220375, 2310012359, 155506872, 1660039573, 2592022536, 3682868212},
				PC:  6633734,
				SR:  9753,
				USP: 7884960,
				SSP: 766428,
				RAM: [][2]uint32{{6633728, 64}, {6633729, 163}, {6633730, 184}, {6633731, 143}, {4511928, 244}, {4511929, 197}, {4511930, 222}, {4511931, 143}, {6633732, 78}, {6633733, 207}},
				Cycles: 22,
			},
		},
		{
			name: "1924 NEGX.l -(A7) 40a7",
			init: 			cpuState{
				D:   [8]uint32{3703623044, 131771461, 66544289, 3443137888, 145660610, 2291908169, 4085883412, 1595764672},
				A:   [7]uint32{413704686, 2909062683, 4183128946, 4217768033, 1703476820, 1249787134, 2559613391},
				PC:  11219786,
				SR:  8714,
				USP: 1688070,
				SSP: 9799746,
				RAM: [][2]uint32{{11219782, 64}, {11219783, 167}, {11219784, 223}, {11219785, 213}, {9799742, 208}, {9799743, 137}, {9799744, 0}, {9799745, 245}, {11219786, 186}, {11219787, 9}},
			},
			want: 			cpuState{
				D:   [8]uint32{3703623044, 131771461, 66544289, 3443137888, 145660610, 2291908169, 4085883412, 1595764672},
				A:   [7]uint32{413704686, 2909062683, 4183128946, 4217768033, 1703476820, 1249787134, 2559613391},
				PC:  11219788,
				SR:  8721,
				USP: 1688070,
				SSP: 9799742,
				RAM: [][2]uint32{{11219782, 64}, {11219783, 167}, {11219784, 223}, {11219785, 213}, {9799742, 47}, {9799743, 118}, {9799744, 255}, {9799745, 11}, {11219786, 186}, {11219787, 9}},
				Cycles: 22,
			},
		},
		{
			name: "2222 NEGX.l (d16, A2) 40aa",
			init: 			cpuState{
				D:   [8]uint32{1101851276, 208422440, 1054117294, 2576555841, 2572092249, 3812213552, 2971003302, 1481528328},
				A:   [7]uint32{533448609, 2443687530, 2384261875, 125626974, 3705364117, 1834219991, 3765236052},
				PC:  8481964,
				SR:  287,
				USP: 8925652,
				SSP: 9012540,
				RAM: [][2]uint32{{8481960, 64}, {8481961, 170}, {8481962, 201}, {8481963, 35}, {8481964, 56}, {8481965, 79}, {1883158, 92}, {1883159, 41}, {1883160, 78}, {1883161, 160}, {8481966, 219}, {8481967, 93}},
			},
			want: 			cpuState{
				D:   [8]uint32{1101851276, 208422440, 1054117294, 2576555841, 2572092249, 3812213552, 2971003302, 1481528328},
				A:   [7]uint32{533448609, 2443687530, 2384261875, 125626974, 3705364117, 1834219991, 3765236052},
				PC:  8481968,
				SR:  281,
				USP: 8925652,
				SSP: 9012540,
				RAM: [][2]uint32{{8481960, 64}, {8481961, 170}, {8481962, 201}, {8481963, 35}, {8481964, 56}, {8481965, 79}, {1883158, 163}, {1883159, 214}, {1883160, 177}, {1883161, 95}, {8481966, 219}, {8481967, 93}},
				Cycles: 24,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestCLR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 CLR.b (A4) 4214",
			init: cpuState{
				D:   [8]uint32{542462093, 2134690401, 1123704793, 2392395773, 758553190, 1953436813, 3741710315, 23122916},
				A:   [7]uint32{3860978724, 2240138486, 2915247362, 3439621469, 83669039, 456444398, 466748201},
				PC:  16153094,
				SR:  1815,
				USP: 12914376,
				SSP: 877856,
				RAM: [][2]uint32{{16153090, 66}, {16153091, 20}, {16153092, 65}, {16153093, 28}, {16560174, 179}, {16560175, 115}, {16153094, 236}, {16153095, 207}},
			},
			want: cpuState{
				D:   [8]uint32{542462093, 2134690401, 1123704793, 2392395773, 758553190, 1953436813, 3741710315, 23122916},
				A:   [7]uint32{3860978724, 2240138486, 2915247362, 3439621469, 83669039, 456444398, 466748201},
				PC:  16153096,
				SR:  1812,
				USP: 12914376,
				SSP: 877856,
				RAM: [][2]uint32{{16153090, 66}, {16153091, 20}, {16153092, 65}, {16153093, 28}, {16560174, 179}, {16560175, 0}, {16153094, 236}, {16153095, 207}},
				Cycles: 12,
			},
		},
		{
			name: "500 CLR.b (A6) 4216",
			init: cpuState{
				D:   [8]uint32{2367719273, 2935267536, 1074006132, 1937300076, 1304958457, 2756250844, 4137078402, 577241723},
				A:   [7]uint32{2921521288, 1014768886, 2676417057, 4149789395, 3345851856, 690175411, 2280357477},
				PC:  10397158,
				SR:  785,
				USP: 6511188,
				SSP: 2896438,
				RAM: [][2]uint32{{10397154, 66}, {10397155, 22}, {10397156, 73}, {10397157, 61}, {15433316, 215}, {15433317, 98}, {10397158, 170}, {10397159, 48}},
			},
			want: cpuState{
				D:   [8]uint32{2367719273, 2935267536, 1074006132, 1937300076, 1304958457, 2756250844, 4137078402, 577241723},
				A:   [7]uint32{2921521288, 1014768886, 2676417057, 4149789395, 3345851856, 690175411, 2280357477},
				PC:  10397160,
				SR:  788,
				USP: 6511188,
				SSP: 2896438,
				RAM: [][2]uint32{{10397154, 66}, {10397155, 22}, {10397156, 73}, {10397157, 61}, {15433316, 215}, {15433317, 0}, {10397158, 170}, {10397159, 48}},
				Cycles: 12,
			},
		},
		{
			name: "1000 CLR.b (d16, A2) 422a",
			init: cpuState{
				D:   [8]uint32{4043790270, 2818088851, 2588194572, 538883084, 3954146836, 4123230870, 4112056519, 2218111710},
				A:   [7]uint32{287295431, 135867941, 3577171, 1793819204, 2357152170, 1647431975, 703397921},
				PC:  6012048,
				SR:  41992,
				USP: 15608570,
				SSP: 4466114,
				RAM: [][2]uint32{{6012044, 66}, {6012045, 42}, {6012046, 197}, {6012047, 100}, {6012048, 228}, {6012049, 86}, {3562166, 5}, {3562167, 41}, {6012050, 70}, {6012051, 14}},
			},
			want: cpuState{
				D:   [8]uint32{4043790270, 2818088851, 2588194572, 538883084, 3954146836, 4123230870, 4112056519, 2218111710},
				A:   [7]uint32{287295431, 135867941, 3577171, 1793819204, 2357152170, 1647431975, 703397921},
				PC:  6012052,
				SR:  41988,
				USP: 15608570,
				SSP: 4466114,
				RAM: [][2]uint32{{6012044, 66}, {6012045, 42}, {6012046, 197}, {6012047, 100}, {6012048, 228}, {6012049, 86}, {3562166, 5}, {3562167, 0}, {6012050, 70}, {6012051, 14}},
				Cycles: 16,
			},
		},
		{
			name: "1500 CLR.b D6 4206",
			init: cpuState{
				D:   [8]uint32{4174188352, 216060503, 1753916560, 3566326877, 4209704889, 2058941594, 2022948727, 76017636},
				A:   [7]uint32{3011286317, 3285849291, 2703673719, 1527835334, 406716476, 1197740173, 220881388},
				PC:  2254826,
				SR:  42762,
				USP: 11231908,
				SSP: 575128,
				RAM: [][2]uint32{{2254822, 66}, {2254823, 6}, {2254824, 226}, {2254825, 179}, {2254826, 63}, {2254827, 111}},
			},
			want: cpuState{
				D:   [8]uint32{4174188352, 216060503, 1753916560, 3566326877, 4209704889, 2058941594, 2022948608, 76017636},
				A:   [7]uint32{3011286317, 3285849291, 2703673719, 1527835334, 406716476, 1197740173, 220881388},
				PC:  2254828,
				SR:  42756,
				USP: 11231908,
				SSP: 575128,
				RAM: [][2]uint32{{2254822, 66}, {2254823, 6}, {2254824, 226}, {2254825, 179}, {2254826, 63}, {2254827, 111}},
				Cycles: 4,
			},
		},
		{
			name: "2000 CLR.b D5 4205",
			init: cpuState{
				D:   [8]uint32{3558727290, 1797688069, 1415234489, 2532428581, 833435361, 3883578420, 1171598142, 4054809566},
				A:   [7]uint32{4213554266, 1920306162, 3505835412, 3269053452, 2712898693, 1444871961, 2559101095},
				PC:  4865812,
				SR:  8710,
				USP: 2883162,
				SSP: 12229152,
				RAM: [][2]uint32{{4865808, 66}, {4865809, 5}, {4865810, 89}, {4865811, 92}, {4865812, 63}, {4865813, 19}},
			},
			want: cpuState{
				D:   [8]uint32{3558727290, 1797688069, 1415234489, 2532428581, 833435361, 3883578368, 1171598142, 4054809566},
				A:   [7]uint32{4213554266, 1920306162, 3505835412, 3269053452, 2712898693, 1444871961, 2559101095},
				PC:  4865814,
				SR:  8708,
				USP: 2883162,
				SSP: 12229152,
				RAM: [][2]uint32{{4865808, 66}, {4865809, 5}, {4865810, 89}, {4865811, 92}, {4865812, 63}, {4865813, 19}},
				Cycles: 4,
			},
		},
		{
			name: "001 CLR.b (d8, A2, Xn) 4232",
			init: 			cpuState{
				D:   [8]uint32{1816555772, 418310705, 539858850, 377278236, 1816935381, 3503134126, 2966777215, 574784707},
				A:   [7]uint32{813817518, 2816827591, 942018911, 3009567081, 880099689, 1622858762, 1874071022},
				PC:  13440968,
				SR:  9998,
				USP: 12957942,
				SSP: 959192,
				RAM: [][2]uint32{{13440964, 66}, {13440965, 50}, {13440966, 167}, {13440967, 58}, {13440968, 188}, {13440969, 123}, {2499320, 52}, {2499321, 239}, {13440970, 15}, {13440971, 15}},
			},
			want: 			cpuState{
				D:   [8]uint32{1816555772, 418310705, 539858850, 377278236, 1816935381, 3503134126, 2966777215, 574784707},
				A:   [7]uint32{813817518, 2816827591, 942018911, 3009567081, 880099689, 1622858762, 1874071022},
				PC:  13440972,
				SR:  9988,
				USP: 12957942,
				SSP: 959192,
				RAM: [][2]uint32{{13440964, 66}, {13440965, 50}, {13440966, 167}, {13440967, 58}, {13440968, 188}, {13440969, 123}, {2499320, 0}, {2499321, 239}, {13440970, 15}, {13440971, 15}},
				Cycles: 18,
			},
		},
		{
			name: "303 CLR.b (A1)+ 4219",
			init: 			cpuState{
				D:   [8]uint32{3068571354, 277842113, 1689284924, 608244084, 3544568182, 2762058984, 2126768588, 1339785841},
				A:   [7]uint32{1716161387, 3135687934, 2212666516, 3893236621, 1366760702, 2672480183, 1851978563},
				PC:  1893084,
				SR:  1311,
				USP: 7807900,
				SSP: 13417368,
				RAM: [][2]uint32{{1893080, 66}, {1893081, 25}, {1893082, 233}, {1893083, 40}, {15125758, 192}, {15125759, 127}, {1893084, 133}, {1893085, 86}},
			},
			want: 			cpuState{
				D:   [8]uint32{3068571354, 277842113, 1689284924, 608244084, 3544568182, 2762058984, 2126768588, 1339785841},
				A:   [7]uint32{1716161387, 3135687935, 2212666516, 3893236621, 1366760702, 2672480183, 1851978563},
				PC:  1893086,
				SR:  1300,
				USP: 7807900,
				SSP: 13417368,
				RAM: [][2]uint32{{1893080, 66}, {1893081, 25}, {1893082, 233}, {1893083, 40}, {15125758, 0}, {15125759, 127}, {1893084, 133}, {1893085, 86}},
				Cycles: 12,
			},
		},
		{
			name: "587 CLR.b (d16, A6) 422e",
			init: 			cpuState{
				D:   [8]uint32{1188608446, 2203188165, 1330183819, 4210021648, 4265079881, 1401729035, 3926246700, 2311724436},
				A:   [7]uint32{2151499290, 4240257289, 598234698, 1508053641, 1015553788, 4193811913, 590180125},
				PC:  5427194,
				SR:  776,
				USP: 4752058,
				SSP: 197570,
				RAM: [][2]uint32{{5427190, 66}, {5427191, 46}, {5427192, 104}, {5427193, 5}, {5427194, 181}, {5427195, 182}, {3004194, 162}, {3004195, 104}, {5427196, 176}, {5427197, 110}},
			},
			want: 			cpuState{
				D:   [8]uint32{1188608446, 2203188165, 1330183819, 4210021648, 4265079881, 1401729035, 3926246700, 2311724436},
				A:   [7]uint32{2151499290, 4240257289, 598234698, 1508053641, 1015553788, 4193811913, 590180125},
				PC:  5427198,
				SR:  772,
				USP: 4752058,
				SSP: 197570,
				RAM: [][2]uint32{{5427190, 66}, {5427191, 46}, {5427192, 104}, {5427193, 5}, {5427194, 181}, {5427195, 182}, {3004194, 0}, {3004195, 104}, {5427196, 176}, {5427197, 110}},
				Cycles: 16,
			},
		},
		{
			name: "874 CLR.b (A3)+ 421b",
			init: 			cpuState{
				D:   [8]uint32{2141274984, 3997392858, 2666739604, 674353929, 1500936968, 2742381531, 2844212369, 4135127450},
				A:   [7]uint32{1838660700, 841768125, 1209004514, 3699245411, 4106211543, 361588963, 280067218},
				PC:  2220804,
				SR:  8718,
				USP: 10706360,
				SSP: 7463774,
				RAM: [][2]uint32{{2220800, 66}, {2220801, 27}, {2220802, 59}, {2220803, 37}, {8257890, 98}, {8257891, 180}, {2220804, 197}, {2220805, 194}},
			},
			want: 			cpuState{
				D:   [8]uint32{2141274984, 3997392858, 2666739604, 674353929, 1500936968, 2742381531, 2844212369, 4135127450},
				A:   [7]uint32{1838660700, 841768125, 1209004514, 3699245412, 4106211543, 361588963, 280067218},
				PC:  2220806,
				SR:  8708,
				USP: 10706360,
				SSP: 7463774,
				RAM: [][2]uint32{{2220800, 66}, {2220801, 27}, {2220802, 59}, {2220803, 37}, {8257890, 98}, {8257891, 0}, {2220804, 197}, {2220805, 194}},
				Cycles: 12,
			},
		},
		{
			name: "1155 CLR.b (d8, A1, Xn) 4231",
			init: 			cpuState{
				D:   [8]uint32{774771458, 1282124806, 2464872898, 3007651453, 1850824755, 725390224, 1076245759, 4190480147},
				A:   [7]uint32{3948990971, 279670519, 3092174517, 4256591453, 525349834, 3927650572, 1760879602},
				PC:  16756080,
				SR:  10002,
				USP: 2237526,
				SSP: 7682266,
				RAM: [][2]uint32{{16756076, 66}, {16756077, 49}, {16756078, 60}, {16756079, 203}, {16756080, 193}, {16756081, 122}, {15764798, 146}, {15764799, 0}, {16756082, 96}, {16756083, 76}},
			},
			want: 			cpuState{
				D:   [8]uint32{774771458, 1282124806, 2464872898, 3007651453, 1850824755, 725390224, 1076245759, 4190480147},
				A:   [7]uint32{3948990971, 279670519, 3092174517, 4256591453, 525349834, 3927650572, 1760879602},
				PC:  16756084,
				SR:  10004,
				USP: 2237526,
				SSP: 7682266,
				RAM: [][2]uint32{{16756076, 66}, {16756077, 49}, {16756078, 60}, {16756079, 203}, {16756080, 193}, {16756081, 122}, {15764798, 146}, {15764799, 0}, {16756082, 96}, {16756083, 76}},
				Cycles: 18,
			},
		},
		{
			name: "1409 CLR.b -(A0) 4220",
			init: 			cpuState{
				D:   [8]uint32{292251151, 1935217127, 3085073350, 4118701257, 4213499611, 640076906, 1496640053, 569868627},
				A:   [7]uint32{3313752232, 3325775803, 3813246742, 3635410618, 592032270, 3341035839, 2854008258},
				PC:  3283798,
				SR:  799,
				USP: 4779186,
				SSP: 15873784,
				RAM: [][2]uint32{{3283794, 66}, {3283795, 32}, {3283796, 207}, {3283797, 142}, {8640678, 93}, {8640679, 198}, {3283798, 240}, {3283799, 49}},
			},
			want: 			cpuState{
				D:   [8]uint32{292251151, 1935217127, 3085073350, 4118701257, 4213499611, 640076906, 1496640053, 569868627},
				A:   [7]uint32{3313752231, 3325775803, 3813246742, 3635410618, 592032270, 3341035839, 2854008258},
				PC:  3283800,
				SR:  788,
				USP: 4779186,
				SSP: 15873784,
				RAM: [][2]uint32{{3283794, 66}, {3283795, 32}, {3283796, 207}, {3283797, 142}, {8640678, 93}, {8640679, 0}, {3283798, 240}, {3283799, 49}},
				Cycles: 14,
			},
		},
		{
			name: "1719 CLR.b (d8, A7, Xn) 4237",
			init: 			cpuState{
				D:   [8]uint32{3079432243, 66556432, 3770108900, 3453986055, 2720691441, 2613061547, 3174546613, 3971962457},
				A:   [7]uint32{2027457493, 4033235725, 2478754280, 2754905774, 1139032312, 3685773555, 2414463088},
				PC:  12471236,
				SR:  792,
				USP: 14525904,
				SSP: 4174336,
				RAM: [][2]uint32{{12471232, 66}, {12471233, 55}, {12471234, 110}, {12471235, 137}, {12471236, 109}, {12471237, 140}, {1401358, 87}, {1401359, 102}, {12471238, 132}, {12471239, 52}},
			},
			want: 			cpuState{
				D:   [8]uint32{3079432243, 66556432, 3770108900, 3453986055, 2720691441, 2613061547, 3174546613, 3971962457},
				A:   [7]uint32{2027457493, 4033235725, 2478754280, 2754905774, 1139032312, 3685773555, 2414463088},
				PC:  12471240,
				SR:  788,
				USP: 14525904,
				SSP: 4174336,
				RAM: [][2]uint32{{12471232, 66}, {12471233, 55}, {12471234, 110}, {12471235, 137}, {12471236, 109}, {12471237, 140}, {1401358, 0}, {1401359, 102}, {12471238, 132}, {12471239, 52}},
				Cycles: 18,
			},
		},
		{
			name: "1985 CLR.b D6 4206",
			init: 			cpuState{
				D:   [8]uint32{766506600, 823323480, 298138646, 1283883991, 3707293464, 4277727119, 3187320845, 3194158805},
				A:   [7]uint32{3759791736, 4209293375, 340018736, 880230927, 4161464761, 2492331218, 3341103302},
				PC:  5201046,
				SR:  1557,
				USP: 2949912,
				SSP: 13088528,
				RAM: [][2]uint32{{5201042, 66}, {5201043, 6}, {5201044, 169}, {5201045, 227}, {5201046, 243}, {5201047, 43}},
			},
			want: 			cpuState{
				D:   [8]uint32{766506600, 823323480, 298138646, 1283883991, 3707293464, 4277727119, 3187320832, 3194158805},
				A:   [7]uint32{3759791736, 4209293375, 340018736, 880230927, 4161464761, 2492331218, 3341103302},
				PC:  5201048,
				SR:  1556,
				USP: 2949912,
				SSP: 13088528,
				RAM: [][2]uint32{{5201042, 66}, {5201043, 6}, {5201044, 169}, {5201045, 227}, {5201046, 243}, {5201047, 43}},
				Cycles: 4,
			},
		},
		{
			name: "2234 CLR.b (d16, A7) 422f",
			init: 			cpuState{
				D:   [8]uint32{3596674309, 708528689, 3993834363, 1310998729, 1128535976, 3942812152, 3985120748, 1115812149},
				A:   [7]uint32{3716865054, 1536101463, 745198871, 2527719226, 4046122410, 1011918522, 2919992315},
				PC:  7849600,
				SR:  1795,
				USP: 11587648,
				SSP: 6869388,
				RAM: [][2]uint32{{7849596, 66}, {7849597, 47}, {7849598, 179}, {7849599, 238}, {7849600, 19}, {7849601, 145}, {11568174, 254}, {11568175, 144}, {7849602, 154}, {7849603, 79}},
			},
			want: 			cpuState{
				D:   [8]uint32{3596674309, 708528689, 3993834363, 1310998729, 1128535976, 3942812152, 3985120748, 1115812149},
				A:   [7]uint32{3716865054, 1536101463, 745198871, 2527719226, 4046122410, 1011918522, 2919992315},
				PC:  7849604,
				SR:  1796,
				USP: 11587648,
				SSP: 6869388,
				RAM: [][2]uint32{{7849596, 66}, {7849597, 47}, {7849598, 179}, {7849599, 238}, {7849600, 19}, {7849601, 145}, {11568174, 0}, {11568175, 144}, {7849602, 154}, {7849603, 79}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestCLR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 CLR.w D2 4242",
			init: cpuState{
				D:   [8]uint32{247709150, 2989687714, 1271176990, 3510861373, 1462957905, 1214298931, 898893479, 3629596489},
				A:   [7]uint32{986890596, 546202386, 1239535990, 3840628796, 322801797, 3892186327, 2538260593},
				PC:  16331162,
				SR:  33286,
				USP: 5263440,
				SSP: 1684324,
				RAM: [][2]uint32{{16331158, 66}, {16331159, 66}, {16331160, 231}, {16331161, 58}, {16331162, 91}, {16331163, 34}},
			},
			want: cpuState{
				D:   [8]uint32{247709150, 2989687714, 1271136256, 3510861373, 1462957905, 1214298931, 898893479, 3629596489},
				A:   [7]uint32{986890596, 546202386, 1239535990, 3840628796, 322801797, 3892186327, 2538260593},
				PC:  16331164,
				SR:  33284,
				USP: 5263440,
				SSP: 1684324,
				RAM: [][2]uint32{{16331158, 66}, {16331159, 66}, {16331160, 231}, {16331161, 58}, {16331162, 91}, {16331163, 34}},
				Cycles: 4,
			},
		},
		{
			name: "500 CLR.w (A1) 4251",
			init: cpuState{
				D:   [8]uint32{3041134975, 619927195, 455679472, 616348039, 676966442, 3759168515, 4132559661, 899751483},
				A:   [7]uint32{3654440679, 3299587987, 881081507, 3905665912, 3977063869, 761466378, 80998878},
				PC:  3502052,
				SR:  518,
				USP: 2250414,
				SSP: 7009766,
				RAM: [][2]uint32{{3502048, 66}, {3502049, 81}, {3502050, 139}, {3502051, 55}, {12, 200}, {13, 18}, {14, 7}, {15, 210}, {1181650, 0}, {1181651, 150}, {1181652, 110}, {1181653, 135}},
			},
			want: cpuState{
				D:      [8]uint32{3041134975, 619927195, 455679472, 616348039, 676966442, 3759168515, 4132559661, 899751483},
				A:      [7]uint32{3654440679, 3299587987, 881081507, 3905665912, 3977063869, 761466378, 80998878},
				PC:     3356624854,
				SR:     8710,
				USP:    2250414,
				SSP:    7009752,
				RAM:    [][2]uint32{{3502048, 66}, {3502049, 81}, {3502050, 139}, {3502051, 55}, {7009764, 111}, {7009765, 226}, {7009760, 2}, {7009761, 6}, {7009762, 0}, {7009763, 53}, {7009758, 66}, {7009759, 81}, {7009756, 183}, {7009757, 147}, {7009752, 66}, {7009753, 81}, {7009754, 196}, {7009755, 171}, {12, 200}, {13, 18}, {14, 7}, {15, 210}, {1181650, 0}, {1181651, 150}, {1181652, 110}, {1181653, 135}},
				Halted: true,
			},
		},
		{
			name: "1000 CLR.w (A7)+ 425f",
			init: cpuState{
				D:   [8]uint32{3493535317, 1328703997, 4087566758, 730907590, 1341825527, 2098700332, 3767427253, 3905471177},
				A:   [7]uint32{3082000248, 2241506887, 845786349, 1314798024, 951535837, 1927011618, 2683773968},
				PC:  5006682,
				SR:  33564,
				USP: 14092912,
				SSP: 6301284,
				RAM: [][2]uint32{{5006678, 66}, {5006679, 95}, {5006680, 116}, {5006681, 232}, {14092912, 228}, {14092913, 130}, {5006682, 74}, {5006683, 13}},
			},
			want: cpuState{
				D:   [8]uint32{3493535317, 1328703997, 4087566758, 730907590, 1341825527, 2098700332, 3767427253, 3905471177},
				A:   [7]uint32{3082000248, 2241506887, 845786349, 1314798024, 951535837, 1927011618, 2683773968},
				PC:  5006684,
				SR:  33556,
				USP: 14092914,
				SSP: 6301284,
				RAM: [][2]uint32{{5006678, 66}, {5006679, 95}, {5006680, 116}, {5006681, 232}, {14092912, 0}, {14092913, 0}, {5006682, 74}, {5006683, 13}},
				Cycles: 12,
			},
		},
		{
			name: "1500 CLR.w (A4) 4254",
			init: cpuState{
				D:   [8]uint32{2896565739, 3076345286, 2655497447, 390565713, 2877380110, 3970568900, 3694603600, 84658276},
				A:   [7]uint32{1786688504, 1055503422, 1136458042, 611010879, 1875277675, 2487906714, 429223861},
				PC:  7351372,
				SR:  42777,
				USP: 6291014,
				SSP: 9227022,
				RAM: [][2]uint32{{7351368, 66}, {7351369, 84}, {7351370, 202}, {7351371, 201}, {12, 93}, {13, 166}, {14, 36}, {15, 220}, {10888412, 82}, {10888413, 202}, {10888414, 12}, {10888415, 22}},
			},
			want: cpuState{
				D:      [8]uint32{2896565739, 3076345286, 2655497447, 390565713, 2877380110, 3970568900, 3694603600, 84658276},
				A:      [7]uint32{1786688504, 1055503422, 1136458042, 611010879, 1875277675, 2487906714, 429223861},
				PC:     1571169504,
				SR:     10009,
				USP:    6291014,
				SSP:    9227008,
				RAM:    [][2]uint32{{7351368, 66}, {7351369, 84}, {7351370, 202}, {7351371, 201}, {9227020, 44}, {9227021, 74}, {9227016, 167}, {9227017, 25}, {9227018, 0}, {9227019, 112}, {9227014, 66}, {9227015, 84}, {9227012, 119}, {9227013, 107}, {9227008, 66}, {9227009, 85}, {9227010, 111}, {9227011, 198}, {12, 93}, {13, 166}, {14, 36}, {15, 220}, {10888412, 82}, {10888413, 202}, {10888414, 12}, {10888415, 22}},
				Halted: true,
			},
		},
		{
			name: "2000 CLR.w (d8, A4, Xn) 4274",
			init: cpuState{
				D:   [8]uint32{224110873, 1800340085, 3971891236, 2464684371, 3351005794, 3333422142, 1688094349, 3767663999},
				A:   [7]uint32{4072552275, 3374003887, 108066808, 3656477495, 3613464847, 1614756257, 2433830451},
				PC:  16048910,
				SR:  9496,
				USP: 4271470,
				SSP: 595708,
				RAM: [][2]uint32{{16048906, 66}, {16048907, 116}, {16048908, 58}, {16048909, 89}, {16048910, 206}, {16048911, 42}, {12, 51}, {13, 198}, {14, 188}, {15, 76}, {13024332, 161}, {13024333, 225}, {13024334, 85}, {13024335, 168}},
			},
			want: cpuState{
				D:      [8]uint32{224110873, 1800340085, 3971891236, 2464684371, 3351005794, 3333422142, 1688094349, 3767663999},
				A:      [7]uint32{4072552275, 3374003887, 108066808, 3656477495, 3613464847, 1614756257, 2433830451},
				PC:     868662352,
				SR:     9496,
				USP:    4271470,
				SSP:    595694,
				RAM:    [][2]uint32{{16048906, 66}, {16048907, 116}, {16048908, 58}, {16048909, 89}, {16048910, 206}, {16048911, 42}, {595706, 227}, {595707, 12}, {595702, 37}, {595703, 24}, {595704, 0}, {595705, 244}, {595700, 66}, {595701, 116}, {595698, 50}, {595699, 187}, {595694, 66}, {595695, 117}, {595696, 106}, {595697, 73}, {12, 51}, {13, 198}, {14, 188}, {15, 76}, {13024332, 161}, {13024333, 225}, {13024334, 85}, {13024335, 168}},
				Halted: true,
			},
		},
		{
			name: "005 CLR.w -(A5) 4265",
			init: 			cpuState{
				D:   [8]uint32{2657837817, 1524061826, 3529932998, 2430036143, 3899588257, 1397013153, 3078489559, 138711491},
				A:   [7]uint32{49695959, 534191680, 2043677950, 1230999935, 3816917963, 315024208, 1209571354},
				PC:  7417298,
				SR:  10012,
				USP: 13882372,
				SSP: 10485198,
				RAM: [][2]uint32{{7417294, 66}, {7417295, 101}, {7417296, 136}, {7417297, 106}, {13034318, 29}, {13034319, 216}, {7417298, 170}, {7417299, 128}},
			},
			want: 			cpuState{
				D:   [8]uint32{2657837817, 1524061826, 3529932998, 2430036143, 3899588257, 1397013153, 3078489559, 138711491},
				A:   [7]uint32{49695959, 534191680, 2043677950, 1230999935, 3816917963, 315024206, 1209571354},
				PC:  7417300,
				SR:  10004,
				USP: 13882372,
				SSP: 10485198,
				RAM: [][2]uint32{{7417294, 66}, {7417295, 101}, {7417296, 136}, {7417297, 106}, {13034318, 0}, {13034319, 0}, {7417298, 170}, {7417299, 128}},
				Cycles: 14,
			},
		},
		{
			name: "299 CLR.w (d8, A4, Xn) 4274",
			init: 			cpuState{
				D:   [8]uint32{148530139, 1881854395, 3548744537, 1880882628, 425522897, 1853265406, 2913916744, 2765206246},
				A:   [7]uint32{2577083199, 2175351099, 2120329876, 1079498074, 1112631288, 2401079971, 1741785424},
				PC:  10818800,
				SR:  787,
				USP: 5679838,
				SSP: 3489888,
				RAM: [][2]uint32{{10818796, 66}, {10818797, 116}, {10818798, 171}, {10818799, 184}, {10818800, 102}, {10818801, 44}, {11735620, 106}, {11735621, 14}, {10818802, 198}, {10818803, 148}},
			},
			want: 			cpuState{
				D:   [8]uint32{148530139, 1881854395, 3548744537, 1880882628, 425522897, 1853265406, 2913916744, 2765206246},
				A:   [7]uint32{2577083199, 2175351099, 2120329876, 1079498074, 1112631288, 2401079971, 1741785424},
				PC:  10818804,
				SR:  788,
				USP: 5679838,
				SSP: 3489888,
				RAM: [][2]uint32{{10818796, 66}, {10818797, 116}, {10818798, 171}, {10818799, 184}, {10818800, 102}, {10818801, 44}, {11735620, 0}, {11735621, 0}, {10818802, 198}, {10818803, 148}},
				Cycles: 18,
			},
		},
		{
			name: "562 CLR.w -(A0) 4260",
			init: 			cpuState{
				D:   [8]uint32{2372235065, 1008228375, 424766382, 2917424782, 3714018996, 2467851873, 1424750600, 3619585360},
				A:   [7]uint32{784970088, 443068625, 2990475191, 2206250366, 1066645836, 1086032182, 1699573893},
				PC:  11582640,
				SR:  523,
				USP: 11099500,
				SSP: 7488082,
				RAM: [][2]uint32{{11582636, 66}, {11582637, 96}, {11582638, 131}, {11582639, 117}, {13218150, 70}, {13218151, 125}, {11582640, 48}, {11582641, 173}},
			},
			want: 			cpuState{
				D:   [8]uint32{2372235065, 1008228375, 424766382, 2917424782, 3714018996, 2467851873, 1424750600, 3619585360},
				A:   [7]uint32{784970086, 443068625, 2990475191, 2206250366, 1066645836, 1086032182, 1699573893},
				PC:  11582642,
				SR:  516,
				USP: 11099500,
				SSP: 7488082,
				RAM: [][2]uint32{{11582636, 66}, {11582637, 96}, {11582638, 131}, {11582639, 117}, {13218150, 0}, {13218151, 0}, {11582640, 48}, {11582641, 173}},
				Cycles: 14,
			},
		},
		{
			name: "822 CLR.w D6 4246",
			init: 			cpuState{
				D:   [8]uint32{1597405762, 2397230614, 2116462000, 1596833079, 916451057, 3798095671, 2728555297, 2665493221},
				A:   [7]uint32{4256771011, 3295287637, 251219053, 1092005143, 3935630737, 1974612231, 4160751932},
				PC:  1115554,
				SR:  8716,
				USP: 13891868,
				SSP: 8550750,
				RAM: [][2]uint32{{1115550, 66}, {1115551, 70}, {1115552, 247}, {1115553, 0}, {1115554, 192}, {1115555, 232}},
			},
			want: 			cpuState{
				D:   [8]uint32{1597405762, 2397230614, 2116462000, 1596833079, 916451057, 3798095671, 2728525824, 2665493221},
				A:   [7]uint32{4256771011, 3295287637, 251219053, 1092005143, 3935630737, 1974612231, 4160751932},
				PC:  1115556,
				SR:  8708,
				USP: 13891868,
				SSP: 8550750,
				RAM: [][2]uint32{{1115550, 66}, {1115551, 70}, {1115552, 247}, {1115553, 0}, {1115554, 192}, {1115555, 232}},
				Cycles: 4,
			},
		},
		{
			name: "1075 CLR.w (d16, A4) 426c",
			init: 			cpuState{
				D:   [8]uint32{3463476693, 2828736953, 832019217, 1098920082, 4111657064, 1135871671, 4021752446, 979025729},
				A:   [7]uint32{2974405247, 744323057, 3977364050, 55674667, 1911748941, 227813680, 2794241178},
				PC:  6143968,
				SR:  8459,
				USP: 15904670,
				SSP: 2850972,
				RAM: [][2]uint32{{6143964, 66}, {6143965, 108}, {6143966, 233}, {6143967, 147}, {6143968, 88}, {6143969, 246}, {15917792, 231}, {15917793, 235}, {6143970, 12}, {6143971, 30}},
			},
			want: 			cpuState{
				D:   [8]uint32{3463476693, 2828736953, 832019217, 1098920082, 4111657064, 1135871671, 4021752446, 979025729},
				A:   [7]uint32{2974405247, 744323057, 3977364050, 55674667, 1911748941, 227813680, 2794241178},
				PC:  6143972,
				SR:  8452,
				USP: 15904670,
				SSP: 2850972,
				RAM: [][2]uint32{{6143964, 66}, {6143965, 108}, {6143966, 233}, {6143967, 147}, {6143968, 88}, {6143969, 246}, {15917792, 0}, {15917793, 0}, {6143970, 12}, {6143971, 30}},
				Cycles: 16,
			},
		},
		{
			name: "1360 CLR.w (A1) 4251",
			init: 			cpuState{
				D:   [8]uint32{1455483127, 4291787509, 3944973234, 1135537356, 4181130625, 3559751644, 906936207, 432543614},
				A:   [7]uint32{104701995, 3892350616, 4011721307, 1429213137, 1674094427, 1421540762, 2538598697},
				PC:  16023278,
				SR:  9481,
				USP: 2338014,
				SSP: 6724064,
				RAM: [][2]uint32{{16023274, 66}, {16023275, 81}, {16023276, 99}, {16023277, 92}, {36504, 98}, {36505, 111}, {16023278, 255}, {16023279, 93}},
			},
			want: 			cpuState{
				D:   [8]uint32{1455483127, 4291787509, 3944973234, 1135537356, 4181130625, 3559751644, 906936207, 432543614},
				A:   [7]uint32{104701995, 3892350616, 4011721307, 1429213137, 1674094427, 1421540762, 2538598697},
				PC:  16023280,
				SR:  9476,
				USP: 2338014,
				SSP: 6724064,
				RAM: [][2]uint32{{16023274, 66}, {16023275, 81}, {16023276, 99}, {16023277, 92}, {36504, 0}, {36505, 0}, {16023278, 255}, {16023279, 93}},
				Cycles: 12,
			},
		},
		{
			name: "1667 CLR.w (A7)+ 425f",
			init: 			cpuState{
				D:   [8]uint32{221075130, 3437311335, 1861736674, 823187620, 4222775247, 3590008203, 3677005864, 192010376},
				A:   [7]uint32{2813159343, 335991576, 2989474442, 4276843749, 1198129256, 2967676392, 1384252961},
				PC:  15441800,
				SR:  1797,
				USP: 10994708,
				SSP: 15940448,
				RAM: [][2]uint32{{15441796, 66}, {15441797, 95}, {15441798, 16}, {15441799, 106}, {10994708, 251}, {10994709, 159}, {15441800, 206}, {15441801, 166}},
			},
			want: 			cpuState{
				D:   [8]uint32{221075130, 3437311335, 1861736674, 823187620, 4222775247, 3590008203, 3677005864, 192010376},
				A:   [7]uint32{2813159343, 335991576, 2989474442, 4276843749, 1198129256, 2967676392, 1384252961},
				PC:  15441802,
				SR:  1796,
				USP: 10994710,
				SSP: 15940448,
				RAM: [][2]uint32{{15441796, 66}, {15441797, 95}, {15441798, 16}, {15441799, 106}, {10994708, 0}, {10994709, 0}, {15441800, 206}, {15441801, 166}},
				Cycles: 12,
			},
		},
		{
			name: "1937 CLR.w -(A5) 4265",
			init: 			cpuState{
				D:   [8]uint32{2263469925, 625550271, 2479140760, 3278777799, 1326469088, 2943742501, 97337437, 4231303104},
				A:   [7]uint32{1060329435, 3524805726, 386247927, 2528512881, 13384845, 533444492, 3503875809},
				PC:  14264632,
				SR:  1546,
				USP: 7807216,
				SSP: 13409142,
				RAM: [][2]uint32{{14264628, 66}, {14264629, 101}, {14264630, 108}, {14264631, 22}, {13350794, 155}, {13350795, 67}, {14264632, 22}, {14264633, 163}},
			},
			want: 			cpuState{
				D:   [8]uint32{2263469925, 625550271, 2479140760, 3278777799, 1326469088, 2943742501, 97337437, 4231303104},
				A:   [7]uint32{1060329435, 3524805726, 386247927, 2528512881, 13384845, 533444490, 3503875809},
				PC:  14264634,
				SR:  1540,
				USP: 7807216,
				SSP: 13409142,
				RAM: [][2]uint32{{14264628, 66}, {14264629, 101}, {14264630, 108}, {14264631, 22}, {13350794, 0}, {13350795, 0}, {14264632, 22}, {14264633, 163}},
				Cycles: 14,
			},
		},
		{
			name: "2197 CLR.w -(A1) 4261",
			init: 			cpuState{
				D:   [8]uint32{682444487, 1453687133, 3521577467, 1193385112, 4010520276, 2547014515, 2956459965, 3476318532},
				A:   [7]uint32{3454518655, 3326225126, 3185134070, 2135939930, 1753005663, 1427742492, 1162627472},
				PC:  3909546,
				SR:  9746,
				USP: 2591876,
				SSP: 15437404,
				RAM: [][2]uint32{{3909542, 66}, {3909543, 97}, {3909544, 214}, {3909545, 16}, {4336356, 244}, {4336357, 196}, {3909546, 47}, {3909547, 7}},
			},
			want: 			cpuState{
				D:   [8]uint32{682444487, 1453687133, 3521577467, 1193385112, 4010520276, 2547014515, 2956459965, 3476318532},
				A:   [7]uint32{3454518655, 3326225124, 3185134070, 2135939930, 1753005663, 1427742492, 1162627472},
				PC:  3909548,
				SR:  9748,
				USP: 2591876,
				SSP: 15437404,
				RAM: [][2]uint32{{3909542, 66}, {3909543, 97}, {3909544, 214}, {3909545, 16}, {4336356, 0}, {4336357, 0}, {3909546, 47}, {3909547, 7}},
				Cycles: 14,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestCLR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 CLR.l (A3)+ 429b",
			init: cpuState{
				D:   [8]uint32{2422470949, 2352751603, 3310642392, 2557582276, 380119850, 920096879, 3616229318, 1779579187},
				A:   [7]uint32{2692427444, 1322854950, 1696773387, 2211182001, 787681578, 2580602796, 847691825},
				PC:  359476,
				SR:  524,
				USP: 1864286,
				SSP: 16661754,
				RAM: [][2]uint32{{359472, 66}, {359473, 155}, {359474, 139}, {359475, 57}, {12, 13}, {13, 70}, {14, 176}, {15, 194}, {4632770, 1}, {4632771, 18}, {4632772, 109}, {4632773, 176}},
			},
			want: cpuState{
				D:      [8]uint32{2422470949, 2352751603, 3310642392, 2557582276, 380119850, 920096879, 3616229318, 1779579187},
				A:      [7]uint32{2692427444, 1322854950, 1696773387, 2211182001, 787681578, 2580602796, 847691825},
				PC:     222736582,
				SR:     8716,
				USP:    1864286,
				SSP:    16661740,
				RAM:    [][2]uint32{{359472, 66}, {359473, 155}, {359474, 139}, {359475, 57}, {16661752, 124}, {16661753, 50}, {16661748, 2}, {16661749, 12}, {16661750, 0}, {16661751, 5}, {16661746, 66}, {16661747, 155}, {16661744, 245}, {16661745, 177}, {16661740, 66}, {16661741, 145}, {16661742, 131}, {16661743, 203}, {12, 13}, {13, 70}, {14, 176}, {15, 194}, {4632770, 1}, {4632771, 18}, {4632772, 109}, {4632773, 176}},
				Halted: true,
			},
		},
		{
			name: "500 CLR.l (A2) 4292",
			init: cpuState{
				D:   [8]uint32{1320146185, 466617488, 3787594080, 264785890, 2208218129, 1304777018, 850086501, 1633749877},
				A:   [7]uint32{718505777, 2311097494, 3988530849, 3198524845, 2188655873, 3440972885, 3617184241},
				PC:  141340,
				SR:  42266,
				USP: 13595982,
				SSP: 7228832,
				RAM: [][2]uint32{{141336, 66}, {141337, 146}, {141338, 160}, {141339, 68}, {12, 218}, {13, 34}, {14, 205}, {15, 100}, {2280804, 84}, {2280805, 22}, {2280806, 7}, {2280807, 248}},
			},
			want: cpuState{
				D:      [8]uint32{1320146185, 466617488, 3787594080, 264785890, 2208218129, 1304777018, 850086501, 1633749877},
				A:      [7]uint32{718505777, 2311097494, 3988530849, 3198524845, 2188655873, 3440972885, 3617184241},
				PC:     3659713896,
				SR:     9498,
				USP:    13595982,
				SSP:    7228818,
				RAM:    [][2]uint32{{141336, 66}, {141337, 146}, {141338, 160}, {141339, 68}, {7228830, 40}, {7228831, 26}, {7228826, 165}, {7228827, 26}, {7228828, 0}, {7228829, 2}, {7228824, 66}, {7228825, 146}, {7228822, 38}, {7228823, 161}, {7228818, 66}, {7228819, 149}, {7228820, 237}, {7228821, 188}, {12, 218}, {13, 34}, {14, 205}, {15, 100}, {2280804, 84}, {2280805, 22}, {2280806, 7}, {2280807, 248}},
				Halted: true,
			},
		},
		{
			name: "1000 CLR.l (d8, A5, Xn) 42b5",
			init: cpuState{
				D:   [8]uint32{1752226657, 1937529842, 1652178587, 4205885453, 1807083091, 4246316356, 2048834473, 473648662},
				A:   [7]uint32{2880357910, 1816404564, 515188618, 1442634717, 4094794215, 493503083, 3103062867},
				PC:  11196974,
				SR:  41479,
				USP: 11796638,
				SSP: 11191354,
				RAM: [][2]uint32{{11196970, 66}, {11196971, 181}, {11196972, 102}, {11196973, 7}, {11196974, 29}, {11196975, 49}, {12, 26}, {13, 118}, {14, 215}, {15, 108}, {7788396, 193}, {7788397, 50}, {7788398, 16}, {7788399, 117}},
			},
			want: cpuState{
				D:      [8]uint32{1752226657, 1937529842, 1652178587, 4205885453, 1807083091, 4246316356, 2048834473, 473648662},
				A:      [7]uint32{2880357910, 1816404564, 515188618, 1442634717, 4094794215, 493503083, 3103062867},
				PC:     443996016,
				SR:     8711,
				USP:    11796638,
				SSP:    11191340,
				RAM:    [][2]uint32{{11196970, 66}, {11196971, 181}, {11196972, 102}, {11196973, 7}, {11196974, 29}, {11196975, 49}, {11191352, 218}, {11191353, 44}, {11191348, 162}, {11191349, 7}, {11191350, 0}, {11191351, 170}, {11191346, 66}, {11191347, 181}, {11191344, 254}, {11191345, 27}, {11191340, 66}, {11191341, 181}, {11191342, 29}, {11191343, 105}, {12, 26}, {13, 118}, {14, 215}, {15, 108}, {7788396, 193}, {7788397, 50}, {7788398, 16}, {7788399, 117}},
				Halted: true,
			},
		},
		{
			name: "1500 CLR.l D6 4286",
			init: cpuState{
				D:   [8]uint32{531473246, 1932733682, 3623131195, 4138712934, 220087100, 3205440486, 520156068, 2961258776},
				A:   [7]uint32{1814743922, 284323712, 2200151911, 383872054, 2299882749, 544533189, 2756642758},
				PC:  14096652,
				SR:  8976,
				USP: 319754,
				SSP: 14415242,
				RAM: [][2]uint32{{14096648, 66}, {14096649, 134}, {14096650, 78}, {14096651, 15}, {14096652, 52}, {14096653, 1}},
			},
			want: cpuState{
				D:   [8]uint32{531473246, 1932733682, 3623131195, 4138712934, 220087100, 3205440486, 0, 2961258776},
				A:   [7]uint32{1814743922, 284323712, 2200151911, 383872054, 2299882749, 544533189, 2756642758},
				PC:  14096654,
				SR:  8980,
				USP: 319754,
				SSP: 14415242,
				RAM: [][2]uint32{{14096648, 66}, {14096649, 134}, {14096650, 78}, {14096651, 15}, {14096652, 52}, {14096653, 1}},
				Cycles: 6,
			},
		},
		{
			name: "2000 CLR.l D6 4286",
			init: cpuState{
				D:   [8]uint32{1222276151, 663092673, 2729074655, 3020377776, 495466853, 3443400666, 2557851554, 2881707184},
				A:   [7]uint32{3663383233, 960436745, 1968358415, 824766223, 3098363430, 1153634215, 3038400131},
				PC:  14175970,
				SR:  32797,
				USP: 1039972,
				SSP: 874904,
				RAM: [][2]uint32{{14175966, 66}, {14175967, 134}, {14175968, 252}, {14175969, 195}, {14175970, 85}, {14175971, 41}},
			},
			want: cpuState{
				D:   [8]uint32{1222276151, 663092673, 2729074655, 3020377776, 495466853, 3443400666, 0, 2881707184},
				A:   [7]uint32{3663383233, 960436745, 1968358415, 824766223, 3098363430, 1153634215, 3038400131},
				PC:  14175972,
				SR:  32788,
				USP: 1039972,
				SSP: 874904,
				RAM: [][2]uint32{{14175966, 66}, {14175967, 134}, {14175968, 252}, {14175969, 195}, {14175970, 85}, {14175971, 41}},
				Cycles: 6,
			},
		},
		{
			name: "008 CLR.l D2 4282",
			init: 			cpuState{
				D:   [8]uint32{2079141230, 3079199995, 4075901442, 2984616076, 3247724322, 4058839671, 3857637396, 1849182786},
				A:   [7]uint32{2437353072, 3747345903, 212595647, 2524811303, 888598052, 644968757, 2055046931},
				PC:  3223204,
				SR:  6,
				USP: 16213078,
				SSP: 10636516,
				RAM: [][2]uint32{{3223200, 66}, {3223201, 130}, {3223202, 48}, {3223203, 17}, {3223204, 137}, {3223205, 9}},
			},
			want: 			cpuState{
				D:   [8]uint32{2079141230, 3079199995, 0, 2984616076, 3247724322, 4058839671, 3857637396, 1849182786},
				A:   [7]uint32{2437353072, 3747345903, 212595647, 2524811303, 888598052, 644968757, 2055046931},
				PC:  3223206,
				SR:  4,
				USP: 16213078,
				SSP: 10636516,
				RAM: [][2]uint32{{3223200, 66}, {3223201, 130}, {3223202, 48}, {3223203, 17}, {3223204, 137}, {3223205, 9}},
				Cycles: 6,
			},
		},
		{
			name: "286 CLR.l D7 4287",
			init: 			cpuState{
				D:   [8]uint32{688512737, 1247815985, 1762562728, 3742747717, 2893928977, 3276709451, 1554196486, 270153106},
				A:   [7]uint32{2041774116, 124901170, 3510292956, 346358588, 57749114, 1555979061, 2004842786},
				PC:  58180,
				SR:  9753,
				USP: 8979282,
				SSP: 11076996,
				RAM: [][2]uint32{{58176, 66}, {58177, 135}, {58178, 27}, {58179, 3}, {58180, 173}, {58181, 159}},
			},
			want: 			cpuState{
				D:   [8]uint32{688512737, 1247815985, 1762562728, 3742747717, 2893928977, 3276709451, 1554196486, 0},
				A:   [7]uint32{2041774116, 124901170, 3510292956, 346358588, 57749114, 1555979061, 2004842786},
				PC:  58182,
				SR:  9748,
				USP: 8979282,
				SSP: 11076996,
				RAM: [][2]uint32{{58176, 66}, {58177, 135}, {58178, 27}, {58179, 3}, {58180, 173}, {58181, 159}},
				Cycles: 6,
			},
		},
		{
			name: "582 CLR.l D4 4284",
			init: 			cpuState{
				D:   [8]uint32{3257032167, 1544898167, 577723933, 1757341516, 2240337942, 782498521, 2161423683, 2135948456},
				A:   [7]uint32{3968244854, 1428893147, 2890190666, 482209957, 3349532096, 922075244, 3668682499},
				PC:  3312516,
				SR:  1549,
				USP: 6129944,
				SSP: 15993186,
				RAM: [][2]uint32{{3312512, 66}, {3312513, 132}, {3312514, 216}, {3312515, 192}, {3312516, 111}, {3312517, 241}},
			},
			want: 			cpuState{
				D:   [8]uint32{3257032167, 1544898167, 577723933, 1757341516, 0, 782498521, 2161423683, 2135948456},
				A:   [7]uint32{3968244854, 1428893147, 2890190666, 482209957, 3349532096, 922075244, 3668682499},
				PC:  3312518,
				SR:  1540,
				USP: 6129944,
				SSP: 15993186,
				RAM: [][2]uint32{{3312512, 66}, {3312513, 132}, {3312514, 216}, {3312515, 192}, {3312516, 111}, {3312517, 241}},
				Cycles: 6,
			},
		},
		{
			name: "852 CLR.l (d8, A7, Xn) 42b7",
			init: 			cpuState{
				D:   [8]uint32{605690513, 2541952931, 1787068986, 3483127272, 3962362846, 604306834, 1370410497, 801499899},
				A:   [7]uint32{1071657605, 137964057, 2569900599, 1499631978, 2330822071, 2873880257, 3431602516},
				PC:  11044118,
				SR:  1035,
				USP: 11571042,
				SSP: 2533996,
				RAM: [][2]uint32{{11044114, 66}, {11044115, 183}, {11044116, 37}, {11044117, 94}, {11044118, 165}, {11044119, 39}, {11538938, 193}, {11538939, 194}, {11538940, 231}, {11538941, 97}, {11044120, 135}, {11044121, 59}},
			},
			want: 			cpuState{
				D:   [8]uint32{605690513, 2541952931, 1787068986, 3483127272, 3962362846, 604306834, 1370410497, 801499899},
				A:   [7]uint32{1071657605, 137964057, 2569900599, 1499631978, 2330822071, 2873880257, 3431602516},
				PC:  11044122,
				SR:  1028,
				USP: 11571042,
				SSP: 2533996,
				RAM: [][2]uint32{{11044114, 66}, {11044115, 183}, {11044116, 37}, {11044117, 94}, {11044118, 165}, {11044119, 39}, {11538938, 0}, {11538939, 0}, {11538940, 0}, {11538941, 0}, {11044120, 135}, {11044121, 59}},
				Cycles: 26,
			},
		},
		{
			name: "1131 CLR.l (d8, A7, Xn) 42b7",
			init: 			cpuState{
				D:   [8]uint32{3720678195, 847652554, 1560196922, 1189564856, 2175518571, 2811928201, 339359783, 2184372369},
				A:   [7]uint32{3257188546, 3764691455, 622735951, 1052730540, 3795303351, 2610778129, 3529971126},
				PC:  13752394,
				SR:  541,
				USP: 6162916,
				SSP: 332034,
				RAM: [][2]uint32{{13752390, 66}, {13752391, 183}, {13752392, 147}, {13752393, 161}, {13752394, 92}, {13752395, 65}, {6138756, 232}, {6138757, 108}, {6138758, 116}, {6138759, 76}, {13752396, 131}, {13752397, 4}},
			},
			want: 			cpuState{
				D:   [8]uint32{3720678195, 847652554, 1560196922, 1189564856, 2175518571, 2811928201, 339359783, 2184372369},
				A:   [7]uint32{3257188546, 3764691455, 622735951, 1052730540, 3795303351, 2610778129, 3529971126},
				PC:  13752398,
				SR:  532,
				USP: 6162916,
				SSP: 332034,
				RAM: [][2]uint32{{13752390, 66}, {13752391, 183}, {13752392, 147}, {13752393, 161}, {13752394, 92}, {13752395, 65}, {6138756, 0}, {6138757, 0}, {6138758, 0}, {6138759, 0}, {13752396, 131}, {13752397, 4}},
				Cycles: 26,
			},
		},
		{
			name: "1435 CLR.l -(A2) 42a2",
			init: 			cpuState{
				D:   [8]uint32{892392824, 503661270, 3151209985, 4263212524, 2033313251, 342195204, 1124384035, 23945310},
				A:   [7]uint32{132769680, 3100957919, 2143768204, 3135178802, 2148855402, 1471439138, 167403362},
				PC:  14674644,
				SR:  774,
				USP: 15887582,
				SSP: 2422396,
				RAM: [][2]uint32{{14674640, 66}, {14674641, 162}, {14674642, 25}, {14674643, 103}, {13061768, 146}, {13061769, 16}, {13061770, 106}, {13061771, 189}, {14674644, 231}, {14674645, 34}},
			},
			want: 			cpuState{
				D:   [8]uint32{892392824, 503661270, 3151209985, 4263212524, 2033313251, 342195204, 1124384035, 23945310},
				A:   [7]uint32{132769680, 3100957919, 2143768200, 3135178802, 2148855402, 1471439138, 167403362},
				PC:  14674646,
				SR:  772,
				USP: 15887582,
				SSP: 2422396,
				RAM: [][2]uint32{{14674640, 66}, {14674641, 162}, {14674642, 25}, {14674643, 103}, {13061768, 0}, {13061769, 0}, {13061770, 0}, {13061771, 0}, {14674644, 231}, {14674645, 34}},
				Cycles: 22,
			},
		},
		{
			name: "1667 CLR.l (d16, A5) 42ad",
			init: 			cpuState{
				D:   [8]uint32{1686795352, 3724563441, 3717175916, 2487852411, 2343183754, 1881054016, 3545673567, 2823131118},
				A:   [7]uint32{1357759027, 3422797883, 1920837690, 2182150305, 868286965, 1573830417, 433209321},
				PC:  16423288,
				SR:  1799,
				USP: 1756708,
				SSP: 15514288,
				RAM: [][2]uint32{{16423284, 66}, {16423285, 173}, {16423286, 187}, {16423287, 19}, {16423288, 180}, {16423289, 120}, {13531684, 11}, {13531685, 204}, {13531686, 250}, {13531687, 92}, {16423290, 117}, {16423291, 40}},
			},
			want: 			cpuState{
				D:   [8]uint32{1686795352, 3724563441, 3717175916, 2487852411, 2343183754, 1881054016, 3545673567, 2823131118},
				A:   [7]uint32{1357759027, 3422797883, 1920837690, 2182150305, 868286965, 1573830417, 433209321},
				PC:  16423292,
				SR:  1796,
				USP: 1756708,
				SSP: 15514288,
				RAM: [][2]uint32{{16423284, 66}, {16423285, 173}, {16423286, 187}, {16423287, 19}, {16423288, 180}, {16423289, 120}, {13531684, 0}, {13531685, 0}, {13531686, 0}, {13531687, 0}, {16423290, 117}, {16423291, 40}},
				Cycles: 24,
			},
		},
		{
			name: "1934 CLR.l (A1)+ 4299",
			init: 			cpuState{
				D:   [8]uint32{3906036831, 3721591455, 3386512651, 2060615178, 155148043, 3426614183, 546842965, 3741455177},
				A:   [7]uint32{1378838822, 2007639722, 1454072940, 2610827601, 866830576, 3331606012, 4173282173},
				PC:  1297250,
				SR:  8194,
				USP: 7770094,
				SSP: 6788562,
				RAM: [][2]uint32{{1297246, 66}, {1297247, 153}, {1297248, 33}, {1297249, 147}, {11151018, 12}, {11151019, 122}, {11151020, 41}, {11151021, 241}, {1297250, 104}, {1297251, 177}},
			},
			want: 			cpuState{
				D:   [8]uint32{3906036831, 3721591455, 3386512651, 2060615178, 155148043, 3426614183, 546842965, 3741455177},
				A:   [7]uint32{1378838822, 2007639726, 1454072940, 2610827601, 866830576, 3331606012, 4173282173},
				PC:  1297252,
				SR:  8196,
				USP: 7770094,
				SSP: 6788562,
				RAM: [][2]uint32{{1297246, 66}, {1297247, 153}, {1297248, 33}, {1297249, 147}, {11151018, 0}, {11151019, 0}, {11151020, 0}, {11151021, 0}, {1297250, 104}, {1297251, 177}},
				Cycles: 20,
			},
		},
		{
			name: "2206 CLR.l -(A6) 42a6",
			init: 			cpuState{
				D:   [8]uint32{438411309, 398403197, 608874203, 453233124, 1828572004, 2325939180, 3956236557, 298735125},
				A:   [7]uint32{4138866441, 2736538880, 3799263859, 858307429, 3309284542, 3927815631, 3307408566},
				PC:  2646150,
				SR:  8968,
				USP: 2712162,
				SSP: 5891730,
				RAM: [][2]uint32{{2646146, 66}, {2646147, 166}, {2646148, 118}, {2646149, 254}, {2297010, 23}, {2297011, 161}, {2297012, 136}, {2297013, 89}, {2646150, 92}, {2646151, 234}},
			},
			want: 			cpuState{
				D:   [8]uint32{438411309, 398403197, 608874203, 453233124, 1828572004, 2325939180, 3956236557, 298735125},
				A:   [7]uint32{4138866441, 2736538880, 3799263859, 858307429, 3309284542, 3927815631, 3307408562},
				PC:  2646152,
				SR:  8964,
				USP: 2712162,
				SSP: 5891730,
				RAM: [][2]uint32{{2646146, 66}, {2646147, 166}, {2646148, 118}, {2646149, 254}, {2297010, 0}, {2297011, 0}, {2297012, 0}, {2297013, 0}, {2646150, 92}, {2646151, 234}},
				Cycles: 22,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEXT_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EXT.w D2 4882",
			init: cpuState{
				D:   [8]uint32{3819345852, 1802571790, 2247905797, 3018080418, 1989524333, 3317799016, 113612003, 2306054450},
				A:   [7]uint32{884290329, 3066226699, 4172221593, 3709084570, 1373732245, 1684373549, 2131941452},
				PC:  2338694,
				SR:  40982,
				USP: 1893728,
				SSP: 12735908,
				RAM: [][2]uint32{{2338690, 72}, {2338691, 130}, {2338692, 197}, {2338693, 87}, {2338694, 129}, {2338695, 219}},
			},
			want: cpuState{
				D:   [8]uint32{3819345852, 1802571790, 2247884805, 3018080418, 1989524333, 3317799016, 113612003, 2306054450},
				A:   [7]uint32{884290329, 3066226699, 4172221593, 3709084570, 1373732245, 1684373549, 2131941452},
				PC:  2338696,
				SR:  40976,
				USP: 1893728,
				SSP: 12735908,
				RAM: [][2]uint32{{2338690, 72}, {2338691, 130}, {2338692, 197}, {2338693, 87}, {2338694, 129}, {2338695, 219}},
				Cycles: 4,
			},
		},
		{
			name: "500 EXT.w D5 4885",
			init: cpuState{
				D:   [8]uint32{4022647521, 3542130543, 3465617827, 1974683050, 2855788256, 3091434338, 2303640923, 2126186426},
				A:   [7]uint32{3904236432, 1091743845, 3978858177, 1432668968, 1153633097, 1637282368, 2647490777},
				PC:  392152,
				SR:  42753,
				USP: 2040814,
				SSP: 9677088,
				RAM: [][2]uint32{{392148, 72}, {392149, 133}, {392150, 188}, {392151, 246}, {392152, 122}, {392153, 96}},
			},
			want: cpuState{
				D:   [8]uint32{4022647521, 3542130543, 3465617827, 1974683050, 2855788256, 3091398754, 2303640923, 2126186426},
				A:   [7]uint32{3904236432, 1091743845, 3978858177, 1432668968, 1153633097, 1637282368, 2647490777},
				PC:  392154,
				SR:  42752,
				USP: 2040814,
				SSP: 9677088,
				RAM: [][2]uint32{{392148, 72}, {392149, 133}, {392150, 188}, {392151, 246}, {392152, 122}, {392153, 96}},
				Cycles: 4,
			},
		},
		{
			name: "1000 EXT.w D4 4884",
			init: cpuState{
				D:   [8]uint32{3901642289, 1703664621, 1832260669, 3188899412, 13485890, 2939534652, 1585071063, 656086677},
				A:   [7]uint32{1843651544, 3692292217, 435112452, 1843711332, 3675657677, 3698003732, 2153828628},
				PC:  8883120,
				SR:  29,
				USP: 12134908,
				SSP: 15901242,
				RAM: [][2]uint32{{8883116, 72}, {8883117, 132}, {8883118, 229}, {8883119, 6}, {8883120, 69}, {8883121, 209}},
			},
			want: cpuState{
				D:   [8]uint32{3901642289, 1703664621, 1832260669, 3188899412, 13434946, 2939534652, 1585071063, 656086677},
				A:   [7]uint32{1843651544, 3692292217, 435112452, 1843711332, 3675657677, 3698003732, 2153828628},
				PC:  8883122,
				SR:  16,
				USP: 12134908,
				SSP: 15901242,
				RAM: [][2]uint32{{8883116, 72}, {8883117, 132}, {8883118, 229}, {8883119, 6}, {8883120, 69}, {8883121, 209}},
				Cycles: 4,
			},
		},
		{
			name: "1500 EXT.w D4 4884",
			init: cpuState{
				D:   [8]uint32{2910233987, 2624070919, 2425374423, 1536797924, 2148572118, 3504614670, 3878097228, 2293603482},
				A:   [7]uint32{4043443979, 3791164823, 2792267647, 854973601, 1888013027, 2753931827, 3743145796},
				PC:  306286,
				SR:  521,
				USP: 4376558,
				SSP: 15182520,
				RAM: [][2]uint32{{306282, 72}, {306283, 132}, {306284, 154}, {306285, 125}, {306286, 210}, {306287, 183}},
			},
			want: cpuState{
				D:   [8]uint32{2910233987, 2624070919, 2425374423, 1536797924, 2148597718, 3504614670, 3878097228, 2293603482},
				A:   [7]uint32{4043443979, 3791164823, 2792267647, 854973601, 1888013027, 2753931827, 3743145796},
				PC:  306288,
				SR:  520,
				USP: 4376558,
				SSP: 15182520,
				RAM: [][2]uint32{{306282, 72}, {306283, 132}, {306284, 154}, {306285, 125}, {306286, 210}, {306287, 183}},
				Cycles: 4,
			},
		},
		{
			name: "2000 EXT.w D7 4887",
			init: cpuState{
				D:   [8]uint32{2872006757, 2610292493, 1012789506, 947532185, 3244430392, 2406098955, 2773013171, 3267513964},
				A:   [7]uint32{2187455143, 3562221732, 173513855, 909586707, 3185955736, 641510580, 390340544},
				PC:  183042,
				SR:  9758,
				USP: 7917812,
				SSP: 12667980,
				RAM: [][2]uint32{{183038, 72}, {183039, 135}, {183040, 184}, {183041, 241}, {183042, 74}, {183043, 116}},
			},
			want: cpuState{
				D:   [8]uint32{2872006757, 2610292493, 1012789506, 947532185, 3244430392, 2406098955, 2773013171, 3267493996},
				A:   [7]uint32{2187455143, 3562221732, 173513855, 909586707, 3185955736, 641510580, 390340544},
				PC:  183044,
				SR:  9744,
				USP: 7917812,
				SSP: 12667980,
				RAM: [][2]uint32{{183038, 72}, {183039, 135}, {183040, 184}, {183041, 241}, {183042, 74}, {183043, 116}},
				Cycles: 4,
			},
		},
		{
			name: "001 EXT.w D0 4880",
			init: 			cpuState{
				D:   [8]uint32{1111886379, 3653213632, 1923607819, 3306724444, 1089892789, 3459238458, 503093272, 609338756},
				A:   [7]uint32{200492426, 3113876213, 1139877842, 1802459568, 4107336994, 2811932507, 1917882612},
				PC:  6736174,
				SR:  1814,
				USP: 2011324,
				SSP: 6222310,
				RAM: [][2]uint32{{6736170, 72}, {6736171, 128}, {6736172, 209}, {6736173, 115}, {6736174, 101}, {6736175, 133}},
			},
			want: 			cpuState{
				D:   [8]uint32{1111883819, 3653213632, 1923607819, 3306724444, 1089892789, 3459238458, 503093272, 609338756},
				A:   [7]uint32{200492426, 3113876213, 1139877842, 1802459568, 4107336994, 2811932507, 1917882612},
				PC:  6736176,
				SR:  1808,
				USP: 2011324,
				SSP: 6222310,
				RAM: [][2]uint32{{6736170, 72}, {6736171, 128}, {6736172, 209}, {6736173, 115}, {6736174, 101}, {6736175, 133}},
				Cycles: 4,
			},
		},
		{
			name: "258 EXT.w D0 4880",
			init: 			cpuState{
				D:   [8]uint32{3207123059, 4246298688, 1636396807, 491131326, 4192749945, 3362971704, 3584479135, 1895426178},
				A:   [7]uint32{4226353787, 1578739299, 1073967935, 1393610505, 701622842, 2245996577, 2992796373},
				PC:  7824366,
				SR:  8991,
				USP: 12288576,
				SSP: 4063466,
				RAM: [][2]uint32{{7824362, 72}, {7824363, 128}, {7824364, 110}, {7824365, 238}, {7824366, 167}, {7824367, 80}},
			},
			want: 			cpuState{
				D:   [8]uint32{3207069811, 4246298688, 1636396807, 491131326, 4192749945, 3362971704, 3584479135, 1895426178},
				A:   [7]uint32{4226353787, 1578739299, 1073967935, 1393610505, 701622842, 2245996577, 2992796373},
				PC:  7824368,
				SR:  8976,
				USP: 12288576,
				SSP: 4063466,
				RAM: [][2]uint32{{7824362, 72}, {7824363, 128}, {7824364, 110}, {7824365, 238}, {7824366, 167}, {7824367, 80}},
				Cycles: 4,
			},
		},
		{
			name: "529 EXT.w D1 4881",
			init: 			cpuState{
				D:   [8]uint32{491667551, 2561328936, 1563591607, 1851420577, 1814963400, 93425483, 1144317359, 2511275688},
				A:   [7]uint32{1364881283, 3969435892, 1579788187, 3782480228, 948016383, 1959117460, 2363613454},
				PC:  14438558,
				SR:  1292,
				USP: 11827804,
				SSP: 8778422,
				RAM: [][2]uint32{{14438554, 72}, {14438555, 129}, {14438556, 205}, {14438557, 55}, {14438558, 25}, {14438559, 146}},
			},
			want: 			cpuState{
				D:   [8]uint32{491667551, 2561277992, 1563591607, 1851420577, 1814963400, 93425483, 1144317359, 2511275688},
				A:   [7]uint32{1364881283, 3969435892, 1579788187, 3782480228, 948016383, 1959117460, 2363613454},
				PC:  14438560,
				SR:  1280,
				USP: 11827804,
				SSP: 8778422,
				RAM: [][2]uint32{{14438554, 72}, {14438555, 129}, {14438556, 205}, {14438557, 55}, {14438558, 25}, {14438559, 146}},
				Cycles: 4,
			},
		},
		{
			name: "804 EXT.w D2 4882",
			init: 			cpuState{
				D:   [8]uint32{288655524, 1503030834, 3047557915, 3315820692, 895741438, 3333975302, 3985956423, 764115879},
				A:   [7]uint32{4009416313, 981996572, 1588100812, 1933057832, 3191952025, 3080504843, 2981058526},
				PC:  10900036,
				SR:  8985,
				USP: 9997828,
				SSP: 5866342,
				RAM: [][2]uint32{{10900032, 72}, {10900033, 130}, {10900034, 75}, {10900035, 200}, {10900036, 116}, {10900037, 106}},
			},
			want: 			cpuState{
				D:   [8]uint32{288655524, 1503030834, 3047555099, 3315820692, 895741438, 3333975302, 3985956423, 764115879},
				A:   [7]uint32{4009416313, 981996572, 1588100812, 1933057832, 3191952025, 3080504843, 2981058526},
				PC:  10900038,
				SR:  8976,
				USP: 9997828,
				SSP: 5866342,
				RAM: [][2]uint32{{10900032, 72}, {10900033, 130}, {10900034, 75}, {10900035, 200}, {10900036, 116}, {10900037, 106}},
				Cycles: 4,
			},
		},
		{
			name: "1074 EXT.w D3 4883",
			init: 			cpuState{
				D:   [8]uint32{309707124, 2390180148, 1511130383, 1376811180, 1852738175, 3933817707, 3343924827, 298085462},
				A:   [7]uint32{1318018701, 717267740, 3032834394, 2378610936, 3800084089, 3828312271, 2283855714},
				PC:  11154064,
				SR:  8467,
				USP: 12778120,
				SSP: 2655204,
				RAM: [][2]uint32{{11154060, 72}, {11154061, 131}, {11154062, 154}, {11154063, 39}, {11154064, 148}, {11154065, 99}},
			},
			want: 			cpuState{
				D:   [8]uint32{309707124, 2390180148, 1511130383, 1376845740, 1852738175, 3933817707, 3343924827, 298085462},
				A:   [7]uint32{1318018701, 717267740, 3032834394, 2378610936, 3800084089, 3828312271, 2283855714},
				PC:  11154066,
				SR:  8472,
				USP: 12778120,
				SSP: 2655204,
				RAM: [][2]uint32{{11154060, 72}, {11154061, 131}, {11154062, 154}, {11154063, 39}, {11154064, 148}, {11154065, 99}},
				Cycles: 4,
			},
		},
		{
			name: "1340 EXT.w D4 4884",
			init: 			cpuState{
				D:   [8]uint32{3470851255, 2871780644, 985597355, 2700279678, 2260992850, 2936427763, 4063016609, 4191434469},
				A:   [7]uint32{3285964403, 4156475699, 2293198375, 4046035603, 1962187915, 3137987762, 3597914728},
				PC:  1666666,
				SR:  9236,
				USP: 3675760,
				SSP: 5628546,
				RAM: [][2]uint32{{1666662, 72}, {1666663, 132}, {1666664, 248}, {1666665, 101}, {1666666, 84}, {1666667, 88}},
			},
			want: 			cpuState{
				D:   [8]uint32{3470851255, 2871780644, 985597355, 2700279678, 2260992082, 2936427763, 4063016609, 4191434469},
				A:   [7]uint32{3285964403, 4156475699, 2293198375, 4046035603, 1962187915, 3137987762, 3597914728},
				PC:  1666668,
				SR:  9232,
				USP: 3675760,
				SSP: 5628546,
				RAM: [][2]uint32{{1666662, 72}, {1666663, 132}, {1666664, 248}, {1666665, 101}, {1666666, 84}, {1666667, 88}},
				Cycles: 4,
			},
		},
		{
			name: "1644 EXT.w D2 4882",
			init: 			cpuState{
				D:   [8]uint32{53742543, 3547534796, 1774675016, 3324878957, 55281213, 968867368, 3616616529, 1801640055},
				A:   [7]uint32{2594095328, 3646877486, 1516092331, 3396405649, 4105400436, 485407502, 1880924374},
				PC:  15968368,
				SR:  26,
				USP: 8332208,
				SSP: 646600,
				RAM: [][2]uint32{{15968364, 72}, {15968365, 130}, {15968366, 229}, {15968367, 1}, {15968368, 34}, {15968369, 126}},
			},
			want: 			cpuState{
				D:   [8]uint32{53742543, 3547534796, 1774649416, 3324878957, 55281213, 968867368, 3616616529, 1801640055},
				A:   [7]uint32{2594095328, 3646877486, 1516092331, 3396405649, 4105400436, 485407502, 1880924374},
				PC:  15968370,
				SR:  16,
				USP: 8332208,
				SSP: 646600,
				RAM: [][2]uint32{{15968364, 72}, {15968365, 130}, {15968366, 229}, {15968367, 1}, {15968368, 34}, {15968369, 126}},
				Cycles: 4,
			},
		},
		{
			name: "1951 EXT.w D7 4887",
			init: 			cpuState{
				D:   [8]uint32{2876666753, 1747790746, 555312619, 735725923, 2894996453, 1626670928, 2511320212, 3221066763},
				A:   [7]uint32{805367542, 2541316086, 2567205966, 1592677717, 1187337117, 680525514, 3240376869},
				PC:  1417950,
				SR:  9485,
				USP: 15275528,
				SSP: 1669598,
				RAM: [][2]uint32{{1417946, 72}, {1417947, 135}, {1417948, 221}, {1417949, 163}, {1417950, 144}, {1417951, 218}},
			},
			want: 			cpuState{
				D:   [8]uint32{2876666753, 1747790746, 555312619, 735725923, 2894996453, 1626670928, 2511320212, 3221028875},
				A:   [7]uint32{805367542, 2541316086, 2567205966, 1592677717, 1187337117, 680525514, 3240376869},
				PC:  1417952,
				SR:  9472,
				USP: 15275528,
				SSP: 1669598,
				RAM: [][2]uint32{{1417946, 72}, {1417947, 135}, {1417948, 221}, {1417949, 163}, {1417950, 144}, {1417951, 218}},
				Cycles: 4,
			},
		},
		{
			name: "2214 EXT.w D2 4882",
			init: 			cpuState{
				D:   [8]uint32{2518933714, 4088818973, 2365235721, 1046193963, 3741247885, 3960859402, 2141217080, 2503916925},
				A:   [7]uint32{3445370348, 1609568517, 1974543622, 37388745, 1128767490, 133661225, 2461232461},
				PC:  1977934,
				SR:  8206,
				USP: 11101186,
				SSP: 1100748,
				RAM: [][2]uint32{{1977930, 72}, {1977931, 130}, {1977932, 156}, {1977933, 18}, {1977934, 16}, {1977935, 111}},
			},
			want: 			cpuState{
				D:   [8]uint32{2518933714, 4088818973, 2365194249, 1046193963, 3741247885, 3960859402, 2141217080, 2503916925},
				A:   [7]uint32{3445370348, 1609568517, 1974543622, 37388745, 1128767490, 133661225, 2461232461},
				PC:  1977936,
				SR:  8192,
				USP: 11101186,
				SSP: 1100748,
				RAM: [][2]uint32{{1977930, 72}, {1977931, 130}, {1977932, 156}, {1977933, 18}, {1977934, 16}, {1977935, 111}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEXT_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EXT.l D1 48c1",
			init: cpuState{
				D:   [8]uint32{1084095360, 439979344, 2598479884, 1927068663, 75468569, 3995372392, 3097123319, 2894407397},
				A:   [7]uint32{1004573750, 3335198915, 3766419635, 2643193439, 1513236470, 760830537, 3298629203},
				PC:  5540374,
				SR:  3,
				USP: 16459498,
				SSP: 14796920,
				RAM: [][2]uint32{{5540370, 72}, {5540371, 193}, {5540372, 245}, {5540373, 96}, {5540374, 23}, {5540375, 224}},
			},
			want: cpuState{
				D:   [8]uint32{1084095360, 4294937936, 2598479884, 1927068663, 75468569, 3995372392, 3097123319, 2894407397},
				A:   [7]uint32{1004573750, 3335198915, 3766419635, 2643193439, 1513236470, 760830537, 3298629203},
				PC:  5540376,
				SR:  8,
				USP: 16459498,
				SSP: 14796920,
				RAM: [][2]uint32{{5540370, 72}, {5540371, 193}, {5540372, 245}, {5540373, 96}, {5540374, 23}, {5540375, 224}},
				Cycles: 4,
			},
		},
		{
			name: "500 EXT.l D7 48c7",
			init: cpuState{
				D:   [8]uint32{3433296788, 3421773441, 3556189535, 3983039166, 2618204519, 941376959, 2206888639, 2181067495},
				A:   [7]uint32{1832748102, 4098606774, 573148560, 3239373399, 2620573444, 3557882264, 427439480},
				PC:  590868,
				SR:  8451,
				USP: 3210036,
				SSP: 7089550,
				RAM: [][2]uint32{{590864, 72}, {590865, 199}, {590866, 108}, {590867, 33}, {590868, 148}, {590869, 153}},
			},
			want: cpuState{
				D:   [8]uint32{3433296788, 3421773441, 3556189535, 3983039166, 2618204519, 941376959, 2206888639, 29415},
				A:   [7]uint32{1832748102, 4098606774, 573148560, 3239373399, 2620573444, 3557882264, 427439480},
				PC:  590870,
				SR:  8448,
				USP: 3210036,
				SSP: 7089550,
				RAM: [][2]uint32{{590864, 72}, {590865, 199}, {590866, 108}, {590867, 33}, {590868, 148}, {590869, 153}},
				Cycles: 4,
			},
		},
		{
			name: "1000 EXT.l D2 48c2",
			init: cpuState{
				D:   [8]uint32{525947097, 2856038383, 2143227186, 3842247773, 4258139931, 3223102284, 1006563338, 1854890671},
				A:   [7]uint32{4109825276, 3950931703, 1096697731, 1355962463, 3233335713, 2920295141, 1564106476},
				PC:  2595668,
				SR:  42007,
				USP: 7726130,
				SSP: 687524,
				RAM: [][2]uint32{{2595664, 72}, {2595665, 194}, {2595666, 213}, {2595667, 255}, {2595668, 161}, {2595669, 66}},
			},
			want: cpuState{
				D:   [8]uint32{525947097, 2856038383, 3378, 3842247773, 4258139931, 3223102284, 1006563338, 1854890671},
				A:   [7]uint32{4109825276, 3950931703, 1096697731, 1355962463, 3233335713, 2920295141, 1564106476},
				PC:  2595670,
				SR:  42000,
				USP: 7726130,
				SSP: 687524,
				RAM: [][2]uint32{{2595664, 72}, {2595665, 194}, {2595666, 213}, {2595667, 255}, {2595668, 161}, {2595669, 66}},
				Cycles: 4,
			},
		},
		{
			name: "1500 EXT.l D2 48c2",
			init: cpuState{
				D:   [8]uint32{4043106240, 3526014149, 458960308, 845570143, 3294968084, 3288504914, 2485706285, 4161800075},
				A:   [7]uint32{365557972, 4252299903, 138900851, 3360277243, 2303379061, 4146650210, 4150696651},
				PC:  11357626,
				SR:  40960,
				USP: 16107722,
				SSP: 4351566,
				RAM: [][2]uint32{{11357622, 72}, {11357623, 194}, {11357624, 158}, {11357625, 57}, {11357626, 73}, {11357627, 216}},
			},
			want: cpuState{
				D:   [8]uint32{4043106240, 3526014149, 11700, 845570143, 3294968084, 3288504914, 2485706285, 4161800075},
				A:   [7]uint32{365557972, 4252299903, 138900851, 3360277243, 2303379061, 4146650210, 4150696651},
				PC:  11357628,
				SR:  40960,
				USP: 16107722,
				SSP: 4351566,
				RAM: [][2]uint32{{11357622, 72}, {11357623, 194}, {11357624, 158}, {11357625, 57}, {11357626, 73}, {11357627, 216}},
				Cycles: 4,
			},
		},
		{
			name: "2000 EXT.l D4 48c4",
			init: cpuState{
				D:   [8]uint32{2112691038, 504353881, 3023695606, 1196041321, 1990541583, 786792290, 1534241876, 1354215896},
				A:   [7]uint32{2372434353, 2405806343, 3551249176, 3821860152, 4082547358, 2952760681, 4206655259},
				PC:  15351286,
				SR:  41229,
				USP: 16628022,
				SSP: 12447724,
				RAM: [][2]uint32{{15351282, 72}, {15351283, 196}, {15351284, 174}, {15351285, 106}, {15351286, 130}, {15351287, 164}},
			},
			want: cpuState{
				D:   [8]uint32{2112691038, 504353881, 3023695606, 1196041321, 16655, 786792290, 1534241876, 1354215896},
				A:   [7]uint32{2372434353, 2405806343, 3551249176, 3821860152, 4082547358, 2952760681, 4206655259},
				PC:  15351288,
				SR:  41216,
				USP: 16628022,
				SSP: 12447724,
				RAM: [][2]uint32{{15351282, 72}, {15351283, 196}, {15351284, 174}, {15351285, 106}, {15351286, 130}, {15351287, 164}},
				Cycles: 4,
			},
		},
		{
			name: "001 EXT.l D5 48c5",
			init: 			cpuState{
				D:   [8]uint32{2063401048, 3198551052, 1446319874, 2201883255, 3939228517, 704818689, 58472231, 3597424325},
				A:   [7]uint32{2864533793, 4187436929, 3048022164, 3199114408, 3354255174, 323697457, 1220804867},
				PC:  14394266,
				SR:  9218,
				USP: 6280506,
				SSP: 2253014,
				RAM: [][2]uint32{{14394262, 72}, {14394263, 197}, {14394264, 135}, {14394265, 108}, {14394266, 110}, {14394267, 44}},
			},
			want: 			cpuState{
				D:   [8]uint32{2063401048, 3198551052, 1446319874, 2201883255, 3939228517, 4294946305, 58472231, 3597424325},
				A:   [7]uint32{2864533793, 4187436929, 3048022164, 3199114408, 3354255174, 323697457, 1220804867},
				PC:  14394268,
				SR:  9224,
				USP: 6280506,
				SSP: 2253014,
				RAM: [][2]uint32{{14394262, 72}, {14394263, 197}, {14394264, 135}, {14394265, 108}, {14394266, 110}, {14394267, 44}},
				Cycles: 4,
			},
		},
		{
			name: "252 EXT.l D7 48c7",
			init: 			cpuState{
				D:   [8]uint32{2468833941, 1150010109, 2052456008, 550447984, 2668826082, 3785317876, 4046324239, 1732466244},
				A:   [7]uint32{2212947884, 619181103, 1246252045, 771440920, 1786777567, 3558535402, 2649284550},
				PC:  9659986,
				SR:  792,
				USP: 6575548,
				SSP: 14797440,
				RAM: [][2]uint32{{9659982, 72}, {9659983, 199}, {9659984, 104}, {9659985, 97}, {9659986, 217}, {9659987, 175}},
			},
			want: 			cpuState{
				D:   [8]uint32{2468833941, 1150010109, 2052456008, 550447984, 2668826082, 3785317876, 4046324239, 22084},
				A:   [7]uint32{2212947884, 619181103, 1246252045, 771440920, 1786777567, 3558535402, 2649284550},
				PC:  9659988,
				SR:  784,
				USP: 6575548,
				SSP: 14797440,
				RAM: [][2]uint32{{9659982, 72}, {9659983, 199}, {9659984, 104}, {9659985, 97}, {9659986, 217}, {9659987, 175}},
				Cycles: 4,
			},
		},
		{
			name: "538 EXT.l D2 48c2",
			init: 			cpuState{
				D:   [8]uint32{147901246, 3279661459, 18140655, 2206684950, 3258033194, 2340534515, 2664872061, 326177478},
				A:   [7]uint32{3787471893, 3574811105, 183232498, 1738301891, 569010360, 2695252483, 263702564},
				PC:  6475564,
				SR:  271,
				USP: 13122314,
				SSP: 6773556,
				RAM: [][2]uint32{{6475560, 72}, {6475561, 194}, {6475562, 112}, {6475563, 80}, {6475564, 233}, {6475565, 120}},
			},
			want: 			cpuState{
				D:   [8]uint32{147901246, 3279661459, 4294954479, 2206684950, 3258033194, 2340534515, 2664872061, 326177478},
				A:   [7]uint32{3787471893, 3574811105, 183232498, 1738301891, 569010360, 2695252483, 263702564},
				PC:  6475566,
				SR:  264,
				USP: 13122314,
				SSP: 6773556,
				RAM: [][2]uint32{{6475560, 72}, {6475561, 194}, {6475562, 112}, {6475563, 80}, {6475564, 233}, {6475565, 120}},
				Cycles: 4,
			},
		},
		{
			name: "821 EXT.l D3 48c3",
			init: 			cpuState{
				D:   [8]uint32{3804854733, 2957078720, 4210281902, 3752168339, 709367986, 120244871, 4200520421, 3105420870},
				A:   [7]uint32{1806974408, 3947226716, 3461350851, 3869759419, 3247243472, 4112060069, 1463692117},
				PC:  14137936,
				SR:  8717,
				USP: 8683722,
				SSP: 1509474,
				RAM: [][2]uint32{{14137932, 72}, {14137933, 195}, {14137934, 110}, {14137935, 18}, {14137936, 143}, {14137937, 39}},
			},
			want: 			cpuState{
				D:   [8]uint32{3804854733, 2957078720, 4210281902, 4294937491, 709367986, 120244871, 4200520421, 3105420870},
				A:   [7]uint32{1806974408, 3947226716, 3461350851, 3869759419, 3247243472, 4112060069, 1463692117},
				PC:  14137938,
				SR:  8712,
				USP: 8683722,
				SSP: 1509474,
				RAM: [][2]uint32{{14137932, 72}, {14137933, 195}, {14137934, 110}, {14137935, 18}, {14137936, 143}, {14137937, 39}},
				Cycles: 4,
			},
		},
		{
			name: "1108 EXT.l D3 48c3",
			init: 			cpuState{
				D:   [8]uint32{2179133508, 3782499167, 741245002, 1142319504, 2273314, 4293844555, 3088426035, 3525305367},
				A:   [7]uint32{3864455175, 318717752, 1010619005, 1718447391, 553287617, 2080855758, 583987978},
				PC:  4593454,
				SR:  9240,
				USP: 7074874,
				SSP: 8233210,
				RAM: [][2]uint32{{4593450, 72}, {4593451, 195}, {4593452, 34}, {4593453, 72}, {4593454, 12}, {4593455, 28}},
			},
			want: 			cpuState{
				D:   [8]uint32{2179133508, 3782499167, 741245002, 27024, 2273314, 4293844555, 3088426035, 3525305367},
				A:   [7]uint32{3864455175, 318717752, 1010619005, 1718447391, 553287617, 2080855758, 583987978},
				PC:  4593456,
				SR:  9232,
				USP: 7074874,
				SSP: 8233210,
				RAM: [][2]uint32{{4593450, 72}, {4593451, 195}, {4593452, 34}, {4593453, 72}, {4593454, 12}, {4593455, 28}},
				Cycles: 4,
			},
		},
		{
			name: "1411 EXT.l D5 48c5",
			init: 			cpuState{
				D:   [8]uint32{1535006068, 2536575265, 1963341542, 4173297297, 486046406, 3198232565, 209156296, 3404222387},
				A:   [7]uint32{501655492, 1380233590, 2007592005, 4140629957, 4247753679, 1677111296, 3364104492},
				PC:  9343044,
				SR:  1283,
				USP: 8683230,
				SSP: 7393118,
				RAM: [][2]uint32{{9343040, 72}, {9343041, 197}, {9343042, 30}, {9343043, 250}, {9343044, 61}, {9343045, 78}},
			},
			want: 			cpuState{
				D:   [8]uint32{1535006068, 2536575265, 1963341542, 4173297297, 486046406, 10229, 209156296, 3404222387},
				A:   [7]uint32{501655492, 1380233590, 2007592005, 4140629957, 4247753679, 1677111296, 3364104492},
				PC:  9343046,
				SR:  1280,
				USP: 8683230,
				SSP: 7393118,
				RAM: [][2]uint32{{9343040, 72}, {9343041, 197}, {9343042, 30}, {9343043, 250}, {9343044, 61}, {9343045, 78}},
				Cycles: 4,
			},
		},
		{
			name: "1691 EXT.l D4 48c4",
			init: 			cpuState{
				D:   [8]uint32{4157250842, 1342893037, 978794133, 3793017056, 1051891727, 3589266241, 3015110741, 1993664316},
				A:   [7]uint32{882460285, 1482625778, 2894638759, 1753211437, 2844818385, 2167568998, 3756499477},
				PC:  7245034,
				SR:  1030,
				USP: 14312452,
				SSP: 4230650,
				RAM: [][2]uint32{{7245030, 72}, {7245031, 196}, {7245032, 205}, {7245033, 255}, {7245034, 98}, {7245035, 35}},
			},
			want: 			cpuState{
				D:   [8]uint32{4157250842, 1342893037, 978794133, 3793017056, 4294940687, 3589266241, 3015110741, 1993664316},
				A:   [7]uint32{882460285, 1482625778, 2894638759, 1753211437, 2844818385, 2167568998, 3756499477},
				PC:  7245036,
				SR:  1032,
				USP: 14312452,
				SSP: 4230650,
				RAM: [][2]uint32{{7245030, 72}, {7245031, 196}, {7245032, 205}, {7245033, 255}, {7245034, 98}, {7245035, 35}},
				Cycles: 4,
			},
		},
		{
			name: "1971 EXT.l D6 48c6",
			init: 			cpuState{
				D:   [8]uint32{909313767, 2699161440, 1175837036, 1766976274, 3805692212, 4276041945, 3652210829, 1980197644},
				A:   [7]uint32{1185995961, 3910871193, 386632560, 2992447029, 1280023246, 2153478138, 2729569111},
				PC:  1862494,
				SR:  1300,
				USP: 3953322,
				SSP: 6770232,
				RAM: [][2]uint32{{1862490, 72}, {1862491, 198}, {1862492, 154}, {1862493, 215}, {1862494, 124}, {1862495, 198}},
			},
			want: 			cpuState{
				D:   [8]uint32{909313767, 2699161440, 1175837036, 1766976274, 3805692212, 4276041945, 20621, 1980197644},
				A:   [7]uint32{1185995961, 3910871193, 386632560, 2992447029, 1280023246, 2153478138, 2729569111},
				PC:  1862496,
				SR:  1296,
				USP: 3953322,
				SSP: 6770232,
				RAM: [][2]uint32{{1862490, 72}, {1862491, 198}, {1862492, 154}, {1862493, 215}, {1862494, 124}, {1862495, 198}},
				Cycles: 4,
			},
		},
		{
			name: "2233 EXT.l D7 48c7",
			init: 			cpuState{
				D:   [8]uint32{117018674, 1188731606, 303930978, 3016935449, 2771202711, 3740425971, 1488599211, 3410810381},
				A:   [7]uint32{657487670, 3028083011, 2500423959, 846246767, 3076779181, 4220594555, 157392510},
				PC:  8972164,
				SR:  1307,
				USP: 7817306,
				SSP: 9274858,
				RAM: [][2]uint32{{8972160, 72}, {8972161, 199}, {8972162, 98}, {8972163, 155}, {8972164, 172}, {8972165, 128}},
			},
			want: 			cpuState{
				D:   [8]uint32{117018674, 1188731606, 303930978, 3016935449, 2771202711, 3740425971, 1488599211, 4294956557},
				A:   [7]uint32{657487670, 3028083011, 2500423959, 846246767, 3076779181, 4220594555, 157392510},
				PC:  8972166,
				SR:  1304,
				USP: 7817306,
				SSP: 9274858,
				RAM: [][2]uint32{{8972160, 72}, {8972161, 199}, {8972162, 98}, {8972163, 155}, {8972164, 172}, {8972165, 128}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestCHK(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 CHK D2, D6 4d82",
			init: cpuState{
				D:   [8]uint32{1093139940, 3229618212, 2916979269, 30567346, 377616289, 3682892879, 1066143283, 4054575747},
				A:   [7]uint32{2332478783, 1687551685, 4067523350, 1440976318, 2531329268, 1056890715, 2838602126},
				PC:  16476360,
				SR:  533,
				USP: 8875980,
				SSP: 1000916,
				RAM: [][2]uint32{{16476356, 77}, {16476357, 130}, {16476358, 144}, {16476359, 84}, {24, 30}, {25, 86}, {26, 243}, {27, 236}, {5698540, 245}, {5698541, 16}, {5698542, 27}, {5698543, 140}},
			},
			want: cpuState{
				D:   [8]uint32{1093139940, 3229618212, 2916979269, 30567346, 377616289, 3682892879, 1066143283, 4054575747},
				A:   [7]uint32{2332478783, 1687551685, 4067523350, 1440976318, 2531329268, 1056890715, 2838602126},
				PC:  509015024,
				SR:  8720,
				USP: 8875980,
				SSP: 1000910,
				RAM: [][2]uint32{{16476356, 77}, {16476357, 130}, {16476358, 144}, {16476359, 84}, {1000914, 104}, {1000915, 198}, {1000910, 2}, {1000911, 16}, {1000912, 0}, {1000913, 251}, {24, 30}, {25, 86}, {26, 243}, {27, 236}, {5698540, 245}, {5698541, 16}, {5698542, 27}, {5698543, 140}},
				// CHK trap: uses fixed 34-cycle exception cost.
				// Cycles: 38,
			},
		},
		{
			name: "500 CHK (A7)+, D0 419f",
			init: cpuState{
				D:   [8]uint32{3523711714, 4239009988, 248448306, 334338384, 3041536728, 2194808353, 3754844762, 2501061804},
				A:   [7]uint32{3500690370, 2992759930, 2527148736, 1205025397, 700081165, 2621323504, 2647546657},
				PC:  10825216,
				SR:  541,
				USP: 12575608,
				SSP: 1984114,
				RAM: [][2]uint32{{10825212, 65}, {10825213, 159}, {10825214, 21}, {10825215, 175}, {12575608, 155}, {12575609, 69}, {24, 25}, {25, 214}, {26, 66}, {27, 18}, {14041618, 141}, {14041619, 189}, {14041620, 53}, {14041621, 163}},
			},
			want: cpuState{
				D:   [8]uint32{3523711714, 4239009988, 248448306, 334338384, 3041536728, 2194808353, 3754844762, 2501061804},
				A:   [7]uint32{3500690370, 2992759930, 2527148736, 1205025397, 700081165, 2621323504, 2647546657},
				PC:  433472022,
				SR:  8728,
				USP: 12575610,
				SSP: 1984108,
				RAM: [][2]uint32{{10825212, 65}, {10825213, 159}, {10825214, 21}, {10825215, 175}, {12575608, 155}, {12575609, 69}, {1984112, 45}, {1984113, 254}, {1984108, 2}, {1984109, 24}, {1984110, 0}, {1984111, 165}, {24, 25}, {25, 214}, {26, 66}, {27, 18}, {14041618, 141}, {14041619, 189}, {14041620, 53}, {14041621, 163}},
				// CHK trap: uses fixed 34-cycle exception cost.
				// Cycles: 44,
			},
		},
		{
			name: "1000 CHK (d16, A7), D0 41af",
			init: cpuState{
				D:   [8]uint32{1141050504, 2183113177, 3223073363, 4252999950, 1242126627, 2715393486, 4253075158, 3204293395},
				A:   [7]uint32{2854607175, 1527540367, 1653101289, 1765386454, 3156707373, 258989678, 2856990996},
				PC:  11357270,
				SR:  42005,
				USP: 5832736,
				SSP: 4876650,
				RAM: [][2]uint32{{11357266, 65}, {11357267, 175}, {11357268, 186}, {11357269, 17}, {11357270, 18}, {11357271, 86}, {12, 115}, {13, 188}, {14, 214}, {15, 70}, {12375622, 33}, {12375623, 254}, {12375624, 179}, {12375625, 242}},
			},
			want: cpuState{
				D:      [8]uint32{1141050504, 2183113177, 3223073363, 4252999950, 1242126627, 2715393486, 4253075158, 3204293395},
				A:      [7]uint32{2854607175, 1527540367, 1653101289, 1765386454, 3156707373, 258989678, 2856990996},
				PC:     1941755466,
				SR:     9237,
				USP:    5832736,
				SSP:    4876636,
				RAM:    [][2]uint32{{11357266, 65}, {11357267, 175}, {11357268, 186}, {11357269, 17}, {11357270, 18}, {11357271, 86}, {4876648, 76}, {4876649, 84}, {4876644, 164}, {4876645, 21}, {4876646, 0}, {4876647, 173}, {4876642, 65}, {4876643, 175}, {4876640, 35}, {4876641, 123}, {4876636, 65}, {4876637, 181}, {4876638, 0}, {4876639, 74}, {12, 115}, {13, 188}, {14, 214}, {15, 70}, {12375622, 33}, {12375623, 254}, {12375624, 179}, {12375625, 242}},
				Halted: true,
			},
		},
		{
			name: "1500 CHK (A4)+, D6 4d9c",
			init: cpuState{
				D:   [8]uint32{520865729, 602560383, 1545489448, 4086163120, 4216977002, 1308921722, 3347776916, 3502874075},
				A:   [7]uint32{3422500212, 3680544159, 2183390143, 2142782103, 533566631, 3639130958, 2804153879},
				PC:  16306568,
				SR:  284,
				USP: 3795202,
				SSP: 5861422,
				RAM: [][2]uint32{{16306564, 77}, {16306565, 156}, {16306566, 213}, {16306567, 177}, {12, 181}, {13, 102}, {14, 128}, {15, 40}, {6717480, 30}, {6717481, 105}, {6717482, 75}, {6717483, 123}},
			},
			want: cpuState{
				D:      [8]uint32{520865729, 602560383, 1545489448, 4086163120, 4216977002, 1308921722, 3347776916, 3502874075},
				A:      [7]uint32{3422500212, 3680544159, 2183390143, 2142782103, 533566633, 3639130958, 2804153879},
				PC:     3043393580,
				SR:     8476,
				USP:    3795202,
				SSP:    5861408,
				RAM:    [][2]uint32{{16306564, 77}, {16306565, 156}, {16306566, 213}, {16306567, 177}, {5861420, 209}, {5861421, 134}, {5861416, 1}, {5861417, 28}, {5861418, 0}, {5861419, 248}, {5861414, 77}, {5861415, 156}, {5861412, 148}, {5861413, 167}, {5861408, 77}, {5861409, 145}, {5861410, 31}, {5861411, 205}, {12, 181}, {13, 102}, {14, 128}, {15, 40}, {6717480, 30}, {6717481, 105}, {6717482, 75}, {6717483, 123}},
				Halted: true,
			},
		},
		{
			name: "2000 CHK (d8, A2, Xn), D6 4db2",
			init: cpuState{
				D:   [8]uint32{1127505738, 3935778481, 2930275396, 4165391571, 3372435042, 1295481911, 1686386403, 2061767005},
				A:   [7]uint32{3397951727, 3731192102, 816769727, 822853660, 603488700, 839541561, 3044055307},
				PC:  2961980,
				SR:  535,
				USP: 13666592,
				SSP: 4955024,
				RAM: [][2]uint32{{2961976, 77}, {2961977, 178}, {2961978, 155}, {2961979, 194}, {2961980, 235}, {2961981, 217}, {12, 155}, {13, 146}, {14, 231}, {15, 112}, {9627504, 10}, {9627505, 207}, {9627506, 216}, {9627507, 12}},
			},
			want: cpuState{
				D:      [8]uint32{1127505738, 3935778481, 2930275396, 4165391571, 3372435042, 1295481911, 1686386403, 2061767005},
				A:      [7]uint32{3397951727, 3731192102, 816769727, 822853660, 603488700, 839541561, 3044055307},
				PC:     2610095988,
				SR:     8727,
				USP:    13666592,
				SSP:    4955010,
				RAM:    [][2]uint32{{2961976, 77}, {2961977, 178}, {2961978, 155}, {2961979, 194}, {2961980, 235}, {2961981, 217}, {4955022, 50}, {4955023, 58}, {4955018, 2}, {4955019, 23}, {4955020, 0}, {4955021, 45}, {4955016, 77}, {4955017, 178}, {4955014, 99}, {4955015, 167}, {4955010, 77}, {4955011, 177}, {4955012, 15}, {4955013, 20}, {12, 155}, {13, 146}, {14, 231}, {15, 112}, {9627504, 10}, {9627505, 207}, {9627506, 216}, {9627507, 12}},
				Halted: true,
			},
		},
		{
			name: "001 CHK -(A7), D5 4ba7",
			init: 			cpuState{
				D:   [8]uint32{1388865005, 914348983, 539888286, 3361804535, 767032238, 2370232027, 287907444, 2162468330},
				A:   [7]uint32{3565395433, 4249562985, 2801617642, 2969197689, 433405670, 556954343, 303643779},
				PC:  7854610,
				SR:  8733,
				USP: 12016180,
				SSP: 7585358,
				RAM: [][2]uint32{{7854606, 75}, {7854607, 167}, {7854608, 187}, {7854609, 218}, {7585356, 175}, {7585357, 191}, {24, 207}, {25, 236}, {26, 58}, {27, 138}, {15481482, 172}, {15481483, 227}, {15481484, 176}, {15481485, 50}},
			},
			want: 			cpuState{
				D:   [8]uint32{1388865005, 914348983, 539888286, 3361804535, 767032238, 2370232027, 287907444, 2162468330},
				A:   [7]uint32{3565395433, 4249562985, 2801617642, 2969197689, 433405670, 556954343, 303643779},
				PC:  3488365198,
				SR:  8728,
				USP: 12016180,
				SSP: 7585350,
				RAM: [][2]uint32{{7854606, 75}, {7854607, 167}, {7854608, 187}, {7854609, 218}, {7585356, 175}, {7585357, 191}, {7585354, 218}, {7585355, 16}, {7585350, 34}, {7585351, 24}, {7585352, 0}, {7585353, 119}, {24, 207}, {25, 236}, {26, 58}, {27, 138}, {15481482, 172}, {15481483, 227}, {15481484, 176}, {15481485, 50}},
				Cycles: 0,
			},
		},
		{
			name: "296 CHK -(A1), D2 45a1",
			init: 			cpuState{
				D:   [8]uint32{3111673503, 314436343, 86948796, 2322929065, 3759194648, 1655920950, 736758480, 1587877715},
				A:   [7]uint32{1832066136, 722825036, 704210778, 715241380, 1060286328, 4014419127, 2109700052},
				PC:  11573938,
				SR:  9240,
				USP: 52658,
				SSP: 3962298,
				RAM: [][2]uint32{{11573934, 69}, {11573935, 161}, {11573936, 182}, {11573937, 63}, {1404746, 99}, {1404747, 26}, {24, 215}, {25, 246}, {26, 153}, {27, 198}, {16161222, 145}, {16161223, 145}, {16161224, 237}, {16161225, 165}},
			},
			want: 			cpuState{
				D:   [8]uint32{3111673503, 314436343, 86948796, 2322929065, 3759194648, 1655920950, 736758480, 1587877715},
				A:   [7]uint32{1832066136, 722825034, 704210778, 715241380, 1060286328, 4014419127, 2109700052},
				PC:  3623262666,
				SR:  9240,
				USP: 52658,
				SSP: 3962292,
				RAM: [][2]uint32{{11573934, 69}, {11573935, 161}, {11573936, 182}, {11573937, 63}, {1404746, 99}, {1404747, 26}, {3962296, 154}, {3962297, 176}, {3962292, 36}, {3962293, 24}, {3962294, 0}, {3962295, 176}, {24, 215}, {25, 246}, {26, 153}, {27, 198}, {16161222, 145}, {16161223, 145}, {16161224, 237}, {16161225, 165}},
				Cycles: 0,
			},
		},
		{
			name: "592 CHK #, D3 47bc",
			init: 			cpuState{
				D:   [8]uint32{3258665275, 3389616516, 1088836006, 175064288, 1599335099, 2180514828, 2881048965, 313186384},
				A:   [7]uint32{834068434, 1361412471, 11409554, 3153849023, 3862562802, 1186559404, 2906760829},
				PC:  5963500,
				SR:  1548,
				USP: 4552846,
				SSP: 2676114,
				RAM: [][2]uint32{{5963496, 71}, {5963497, 188}, {5963498, 56}, {5963499, 194}, {5963500, 116}, {5963501, 183}, {24, 136}, {25, 80}, {26, 154}, {27, 220}, {5282524, 54}, {5282525, 41}, {5282526, 255}, {5282527, 65}},
			},
			want: 			cpuState{
				D:   [8]uint32{3258665275, 3389616516, 1088836006, 175064288, 1599335099, 2180514828, 2881048965, 313186384},
				A:   [7]uint32{834068434, 1361412471, 11409554, 3153849023, 3862562802, 1186559404, 2906760829},
				PC:  2286983904,
				SR:  9728,
				USP: 4552846,
				SSP: 2676108,
				RAM: [][2]uint32{{5963496, 71}, {5963497, 188}, {5963498, 56}, {5963499, 194}, {5963500, 116}, {5963501, 183}, {2676112, 254}, {2676113, 236}, {2676108, 6}, {2676109, 0}, {2676110, 0}, {2676111, 90}, {24, 136}, {25, 80}, {26, 154}, {27, 220}, {5282524, 54}, {5282525, 41}, {5282526, 255}, {5282527, 65}},
				Cycles: 0,
			},
		},
		{
			name: "882 CHK (d8, A2, Xn), D2 45b2",
			init: 			cpuState{
				D:   [8]uint32{4116273350, 327828957, 2960577137, 2438451599, 1148379709, 12353173, 2042788178, 1278615601},
				A:   [7]uint32{3055843590, 263782067, 3892147875, 653398613, 1957624006, 2095206967, 2229515148},
				PC:  16377688,
				SR:  8213,
				USP: 6178288,
				SSP: 7851368,
				RAM: [][2]uint32{{16377684, 69}, {16377685, 178}, {16377686, 77}, {16377687, 228}, {16377688, 192}, {16377689, 24}, {7362756, 63}, {7362757, 121}, {24, 94}, {25, 234}, {26, 157}, {27, 174}, {15375790, 60}, {15375791, 144}, {15375792, 198}, {15375793, 196}},
			},
			want: 			cpuState{
				D:   [8]uint32{4116273350, 327828957, 2960577137, 2438451599, 1148379709, 12353173, 2042788178, 1278615601},
				A:   [7]uint32{3055843590, 263782067, 3892147875, 653398613, 1957624006, 2095206967, 2229515148},
				PC:  1592434098,
				SR:  8216,
				USP: 6178288,
				SSP: 7851362,
				RAM: [][2]uint32{{16377684, 69}, {16377685, 178}, {16377686, 77}, {16377687, 228}, {16377688, 192}, {16377689, 24}, {7362756, 63}, {7362757, 121}, {7851366, 231}, {7851367, 88}, {7851362, 32}, {7851363, 24}, {7851364, 0}, {7851365, 249}, {24, 94}, {25, 234}, {26, 157}, {27, 174}, {15375790, 60}, {15375791, 144}, {15375792, 198}, {15375793, 196}},
				Cycles: 0,
			},
		},
		{
			name: "1133 CHK (A1), D1 4391",
			init: 			cpuState{
				D:   [8]uint32{1363618957, 3339330464, 56141266, 563804466, 3673823990, 172714773, 2742461720, 208694577},
				A:   [7]uint32{1103063340, 1316483994, 2395258208, 2458763766, 3531083509, 3978320921, 3915317443},
				PC:  6080708,
				SR:  15,
				USP: 5997906,
				SSP: 13789718,
				RAM: [][2]uint32{{6080704, 67}, {6080705, 145}, {6080706, 156}, {6080707, 48}, {7861146, 46}, {7861147, 48}, {6080708, 123}, {6080709, 153}},
			},
			want: 			cpuState{
				D:   [8]uint32{1363618957, 3339330464, 56141266, 563804466, 3673823990, 172714773, 2742461720, 208694577},
				A:   [7]uint32{1103063340, 1316483994, 2395258208, 2458763766, 3531083509, 3978320921, 3915317443},
				PC:  6080710,
				SR:  0,
				USP: 5997906,
				SSP: 13789718,
				RAM: [][2]uint32{{6080704, 67}, {6080705, 145}, {6080706, 156}, {6080707, 48}, {7861146, 46}, {7861147, 48}, {6080708, 123}, {6080709, 153}},
				Cycles: 0,
			},
		},
		{
			name: "1412 CHK (d8, A2, Xn), D0 41b2",
			init: 			cpuState{
				D:   [8]uint32{1240665360, 19168964, 3571353229, 3893426228, 418844917, 3485721456, 4176899582, 3160958093},
				A:   [7]uint32{2433820200, 1947611178, 2602436299, 3920273295, 443264842, 3662470821, 202973733},
				PC:  13595166,
				SR:  1291,
				USP: 6812478,
				SSP: 5643204,
				RAM: [][2]uint32{{13595162, 65}, {13595163, 178}, {13595164, 174}, {13595165, 182}, {13595166, 157}, {13595167, 58}, {3935564, 52}, {3935565, 75}, {13595168, 226}, {13595169, 1}},
			},
			want: 			cpuState{
				D:   [8]uint32{1240665360, 19168964, 3571353229, 3893426228, 418844917, 3485721456, 4176899582, 3160958093},
				A:   [7]uint32{2433820200, 1947611178, 2602436299, 3920273295, 443264842, 3662470821, 202973733},
				PC:  13595170,
				SR:  1280,
				USP: 6812478,
				SSP: 5643204,
				RAM: [][2]uint32{{13595162, 65}, {13595163, 178}, {13595164, 174}, {13595165, 182}, {13595166, 157}, {13595167, 58}, {3935564, 52}, {3935565, 75}, {13595168, 226}, {13595169, 1}},
				Cycles: 0,
			},
		},
		{
			name: "1667 CHK (A4), D4 4994",
			init: 			cpuState{
				D:   [8]uint32{84868225, 1148773371, 422343686, 2968905592, 2976155342, 1225257987, 2671997801, 188172345},
				A:   [7]uint32{3746434011, 1063449783, 3890653111, 307500077, 1158698760, 1943895630, 1139254253},
				PC:  9218720,
				SR:  1821,
				USP: 3107258,
				SSP: 1042128,
				RAM: [][2]uint32{{9218716, 73}, {9218717, 148}, {9218718, 131}, {9218719, 225}, {1070856, 177}, {1070857, 39}, {24, 157}, {25, 194}, {26, 242}, {27, 148}, {12776084, 250}, {12776085, 126}, {12776086, 116}, {12776087, 155}},
			},
			want: 			cpuState{
				D:   [8]uint32{84868225, 1148773371, 422343686, 2968905592, 2976155342, 1225257987, 2671997801, 188172345},
				A:   [7]uint32{3746434011, 1063449783, 3890653111, 307500077, 1158698760, 1943895630, 1139254253},
				PC:  2646799000,
				SR:  10008,
				USP: 3107258,
				SSP: 1042122,
				RAM: [][2]uint32{{9218716, 73}, {9218717, 148}, {9218718, 131}, {9218719, 225}, {1070856, 177}, {1070857, 39}, {1042126, 170}, {1042127, 158}, {1042122, 7}, {1042123, 24}, {1042124, 0}, {1042125, 140}, {24, 157}, {25, 194}, {26, 242}, {27, 148}, {12776084, 250}, {12776085, 126}, {12776086, 116}, {12776087, 155}},
				Cycles: 0,
			},
		},
		{
			name: "1925 CHK (A4)+, D5 4b9c",
			init: 			cpuState{
				D:   [8]uint32{305480514, 2961534901, 1247552600, 4146438586, 3338686529, 1666966298, 3883396373, 583341152},
				A:   [7]uint32{3192120180, 4034493447, 2461608776, 3265639810, 3229316010, 1429442918, 3552226288},
				PC:  5225648,
				SR:  8719,
				USP: 11457674,
				SSP: 14532530,
				RAM: [][2]uint32{{5225644, 75}, {5225645, 156}, {5225646, 177}, {5225647, 114}, {8090538, 136}, {8090539, 155}, {24, 104}, {25, 154}, {26, 173}, {27, 192}, {10137024, 21}, {10137025, 144}, {10137026, 198}, {10137027, 143}},
			},
			want: 			cpuState{
				D:   [8]uint32{305480514, 2961534901, 1247552600, 4146438586, 3338686529, 1666966298, 3883396373, 583341152},
				A:   [7]uint32{3192120180, 4034493447, 2461608776, 3265639810, 3229316012, 1429442918, 3552226288},
				PC:  1754967492,
				SR:  8712,
				USP: 11457674,
				SSP: 14532524,
				RAM: [][2]uint32{{5225644, 75}, {5225645, 156}, {5225646, 177}, {5225647, 114}, {8090538, 136}, {8090539, 155}, {14532528, 188}, {14532529, 174}, {14532524, 34}, {14532525, 8}, {14532526, 0}, {14532527, 79}, {24, 104}, {25, 154}, {26, 173}, {27, 192}, {10137024, 21}, {10137025, 144}, {10137026, 198}, {10137027, 143}},
				Cycles: 0,
			},
		},
		{
			name: "2217 CHK #, D4 49bc",
			init: 			cpuState{
				D:   [8]uint32{1618480882, 3919085607, 1765848025, 218633667, 2910891421, 2039511803, 2198120979, 2543555388},
				A:   [7]uint32{2796130990, 3295510707, 2836186410, 1663474499, 2433960989, 3915016421, 1822503220},
				PC:  11436784,
				SR:  8477,
				USP: 15872936,
				SSP: 4613460,
				RAM: [][2]uint32{{11436780, 73}, {11436781, 188}, {11436782, 96}, {11436783, 180}, {11436784, 182}, {11436785, 100}, {24, 86}, {25, 124}, {26, 186}, {27, 46}, {8174126, 226}, {8174127, 9}, {8174128, 201}, {8174129, 20}},
			},
			want: 			cpuState{
				D:   [8]uint32{1618480882, 3919085607, 1765848025, 218633667, 2910891421, 2039511803, 2198120979, 2543555388},
				A:   [7]uint32{2796130990, 3295510707, 2836186410, 1663474499, 2433960989, 3915016421, 1822503220},
				PC:  1451014706,
				SR:  8472,
				USP: 15872936,
				SSP: 4613454,
				RAM: [][2]uint32{{11436780, 73}, {11436781, 188}, {11436782, 96}, {11436783, 180}, {11436784, 182}, {11436785, 100}, {4613458, 130}, {4613459, 240}, {4613454, 33}, {4613455, 24}, {4613456, 0}, {4613457, 174}, {24, 86}, {25, 124}, {26, 186}, {27, 46}, {8174126, 226}, {8174127, 9}, {8174128, 201}, {8174129, 20}},
				Cycles: 0,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}
