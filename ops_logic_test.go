package m68k

import "testing"

func TestAND_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 AND.b D6, (A1) cd11",
			init: cpuState{
				D:   [8]uint32{1410882485, 2524850606, 3640704972, 3188579189, 2123281346, 2336967668, 631222683, 1838937900},
				A:   [7]uint32{3602543972, 239596797, 3487352494, 115237367, 4045880333, 2428669306, 4202824057},
				PC:  14124544,
				SR:  28,
				USP: 1363352,
				SSP: 9697978,
				RAM: [][2]uint32{{14124540, 205}, {14124541, 17}, {14124542, 69}, {14124543, 174}, {4715772, 104}, {4715773, 44}, {14124544, 216}, {14124545, 52}},
			},
			want: cpuState{
				D:   [8]uint32{1410882485, 2524850606, 3640704972, 3188579189, 2123281346, 2336967668, 631222683, 1838937900},
				A:   [7]uint32{3602543972, 239596797, 3487352494, 115237367, 4045880333, 2428669306, 4202824057},
				PC:  14124546,
				SR:  16,
				USP: 1363352,
				SSP: 9697978,
				RAM: [][2]uint32{{14124540, 205}, {14124541, 17}, {14124542, 69}, {14124543, 174}, {4715772, 104}, {4715773, 8}, {14124544, 216}, {14124545, 52}},
				Cycles: 12,
			},
		},
		{
			name: "500 AND.b (A7), D5 ca17",
			init: cpuState{
				D:   [8]uint32{665009293, 10341520, 1412029180, 257007063, 1471609027, 296964206, 3237549832, 512478877},
				A:   [7]uint32{3192725326, 1013870033, 1763432924, 362924035, 2110987850, 597189186, 3917093906},
				PC:  1620864,
				SR:  41734,
				USP: 10820588,
				SSP: 14636380,
				RAM: [][2]uint32{{1620860, 202}, {1620861, 23}, {1620862, 252}, {1620863, 186}, {14636380, 180}, {14636381, 236}, {1620864, 161}, {1620865, 65}},
			},
			want: cpuState{
				D:   [8]uint32{665009293, 10341520, 1412029180, 257007063, 1471609027, 296964132, 3237549832, 512478877},
				A:   [7]uint32{3192725326, 1013870033, 1763432924, 362924035, 2110987850, 597189186, 3917093906},
				PC:  1620866,
				SR:  41728,
				USP: 10820588,
				SSP: 14636380,
				RAM: [][2]uint32{{1620860, 202}, {1620861, 23}, {1620862, 252}, {1620863, 186}, {14636380, 180}, {14636381, 236}, {1620864, 161}, {1620865, 65}},
				Cycles: 8,
			},
		},
		{
			name: "1000 AND.b (d8, A4, Xn), D3 c634",
			init: cpuState{
				D:   [8]uint32{3864294484, 2443144357, 4195059840, 3514388992, 4246891523, 729382144, 3845878703, 88601686},
				A:   [7]uint32{3228949829, 155906899, 3992290268, 2534360503, 328515602, 2785727778, 2203154425},
				PC:  843474,
				SR:  19,
				USP: 15084840,
				SSP: 13851130,
				RAM: [][2]uint32{{843470, 198}, {843471, 52}, {843472, 225}, {843473, 214}, {843474, 56}, {843475, 53}, {9779168, 238}, {9779169, 68}, {843476, 26}, {843477, 215}},
			},
			want: cpuState{
				D:   [8]uint32{3864294484, 2443144357, 4195059840, 3514388992, 4246891523, 729382144, 3845878703, 88601686},
				A:   [7]uint32{3228949829, 155906899, 3992290268, 2534360503, 328515602, 2785727778, 2203154425},
				PC:  843478,
				SR:  20,
				USP: 15084840,
				SSP: 13851130,
				RAM: [][2]uint32{{843470, 198}, {843471, 52}, {843472, 225}, {843473, 214}, {843474, 56}, {843475, 53}, {9779168, 238}, {9779169, 68}, {843476, 26}, {843477, 215}},
				Cycles: 14,
			},
		},
		{
			name: "1500 AND.b D6, -(A6) cd26",
			init: cpuState{
				D:   [8]uint32{576842073, 1901360494, 3380224760, 2493141862, 2890056087, 742800212, 3710461005, 4163375625},
				A:   [7]uint32{1912586904, 1525429464, 1575157120, 1974902591, 3095954787, 2718806702, 2499010058},
				PC:  6838936,
				SR:  9751,
				USP: 14018920,
				SSP: 10153490,
				RAM: [][2]uint32{{6838932, 205}, {6838933, 38}, {6838934, 223}, {6838935, 176}, {15982088, 7}, {15982089, 101}, {6838936, 240}, {6838937, 80}},
			},
			want: cpuState{
				D:   [8]uint32{576842073, 1901360494, 3380224760, 2493141862, 2890056087, 742800212, 3710461005, 4163375625},
				A:   [7]uint32{1912586904, 1525429464, 1575157120, 1974902591, 3095954787, 2718806702, 2499010057},
				PC:  6838938,
				SR:  9744,
				USP: 14018920,
				SSP: 10153490,
				RAM: [][2]uint32{{6838932, 205}, {6838933, 38}, {6838934, 223}, {6838935, 176}, {15982088, 7}, {15982089, 69}, {6838936, 240}, {6838937, 80}},
				Cycles: 14,
			},
		},
		{
			name: "2000 AND.b (d16, PC), D3 c63a",
			init: cpuState{
				D:   [8]uint32{2581827329, 2155904581, 864498891, 3846916136, 2716630524, 2179358202, 2241121971, 365241658},
				A:   [7]uint32{626236893, 1636465730, 3464688346, 231481766, 260212428, 1036339533, 1943619228},
				PC:  3630660,
				SR:  27,
				USP: 7008708,
				SSP: 14823128,
				RAM: [][2]uint32{{3630656, 198}, {3630657, 58}, {3630658, 100}, {3630659, 59}, {3630660, 250}, {3630661, 152}, {3656316, 152}, {3656317, 195}, {3630662, 251}, {3630663, 34}},
			},
			want: cpuState{
				D:   [8]uint32{2581827329, 2155904581, 864498891, 3846916096, 2716630524, 2179358202, 2241121971, 365241658},
				A:   [7]uint32{626236893, 1636465730, 3464688346, 231481766, 260212428, 1036339533, 1943619228},
				PC:  3630664,
				SR:  20,
				USP: 7008708,
				SSP: 14823128,
				RAM: [][2]uint32{{3630656, 198}, {3630657, 58}, {3630658, 100}, {3630659, 59}, {3630660, 250}, {3630661, 152}, {3656316, 152}, {3656317, 195}, {3630662, 251}, {3630663, 34}},
				Cycles: 12,
			},
		},
		{
			name: "001 AND.b D7, -(A3) cf23",
			init: 			cpuState{
				D:   [8]uint32{2216047117, 3981288001, 3673816827, 4119102179, 4188716941, 3074823836, 1209720401, 668571887},
				A:   [7]uint32{2031049165, 923630683, 3066257497, 58436580, 3776984362, 721609114, 738325107},
				PC:  12530752,
				SR:  1297,
				USP: 9050152,
				SSP: 4127600,
				RAM: [][2]uint32{{12530748, 207}, {12530749, 35}, {12530750, 115}, {12530751, 165}, {8104930, 165}, {8104931, 59}, {12530752, 253}, {12530753, 220}},
			},
			want: 			cpuState{
				D:   [8]uint32{2216047117, 3981288001, 3673816827, 4119102179, 4188716941, 3074823836, 1209720401, 668571887},
				A:   [7]uint32{2031049165, 923630683, 3066257497, 58436579, 3776984362, 721609114, 738325107},
				PC:  12530754,
				SR:  1296,
				USP: 9050152,
				SSP: 4127600,
				RAM: [][2]uint32{{12530748, 207}, {12530749, 35}, {12530750, 115}, {12530751, 165}, {8104930, 165}, {8104931, 43}, {12530752, 253}, {12530753, 220}},
				Cycles: 14,
			},
		},
		{
			name: "307 AND.b D0, (A1)+ c119",
			init: 			cpuState{
				D:   [8]uint32{417518270, 3116477384, 4142249294, 801972552, 3780683638, 2371683133, 3213845112, 723051580},
				A:   [7]uint32{1066278286, 3426224357, 3362288026, 1648665271, 3404712663, 3898974927, 2207519129},
				PC:  345232,
				SR:  20,
				USP: 9110048,
				SSP: 10389842,
				RAM: [][2]uint32{{345228, 193}, {345229, 25}, {345230, 111}, {345231, 155}, {3672292, 190}, {3672293, 212}, {345232, 227}, {345233, 250}},
			},
			want: 			cpuState{
				D:   [8]uint32{417518270, 3116477384, 4142249294, 801972552, 3780683638, 2371683133, 3213845112, 723051580},
				A:   [7]uint32{1066278286, 3426224358, 3362288026, 1648665271, 3404712663, 3898974927, 2207519129},
				PC:  345234,
				SR:  24,
				USP: 9110048,
				SSP: 10389842,
				RAM: [][2]uint32{{345228, 193}, {345229, 25}, {345230, 111}, {345231, 155}, {3672292, 190}, {3672293, 148}, {345232, 227}, {345233, 250}},
				Cycles: 12,
			},
		},
		{
			name: "586 AND.b D3, (d8, A1, Xn) c731",
			init: 			cpuState{
				D:   [8]uint32{49935650, 1189221573, 3644807757, 2214423991, 4256504468, 1688286218, 2831731474, 1654489616},
				A:   [7]uint32{725971473, 2520681953, 3634529523, 3571317830, 945242002, 2643843497, 4046864754},
				PC:  1941898,
				SR:  1296,
				USP: 11380514,
				SSP: 11532854,
				RAM: [][2]uint32{{1941894, 199}, {1941895, 49}, {1941896, 175}, {1941897, 99}, {1941898, 93}, {1941899, 97}, {14750518, 133}, {14750519, 65}, {1941900, 190}, {1941901, 162}},
			},
			want: 			cpuState{
				D:   [8]uint32{49935650, 1189221573, 3644807757, 2214423991, 4256504468, 1688286218, 2831731474, 1654489616},
				A:   [7]uint32{725971473, 2520681953, 3634529523, 3571317830, 945242002, 2643843497, 4046864754},
				PC:  1941902,
				SR:  1296,
				USP: 11380514,
				SSP: 11532854,
				RAM: [][2]uint32{{1941894, 199}, {1941895, 49}, {1941896, 175}, {1941897, 99}, {1941898, 93}, {1941899, 97}, {14750518, 133}, {14750519, 1}, {1941900, 190}, {1941901, 162}},
				Cycles: 18,
			},
		},
		{
			name: "872 AND.b D6, (d16, A6) cd2e",
			init: 			cpuState{
				D:   [8]uint32{3889681543, 4120438454, 4014544353, 2441437572, 3934534636, 3006821525, 4149433608, 2858733506},
				A:   [7]uint32{1169928508, 112474988, 3545662729, 4092928397, 3202231617, 2797169705, 3527569114},
				PC:  12164536,
				SR:  9244,
				USP: 1139566,
				SSP: 13731006,
				RAM: [][2]uint32{{12164532, 205}, {12164533, 46}, {12164534, 152}, {12164535, 77}, {12164536, 209}, {12164537, 89}, {4327206, 82}, {4327207, 126}, {12164538, 23}, {12164539, 197}},
			},
			want: 			cpuState{
				D:   [8]uint32{3889681543, 4120438454, 4014544353, 2441437572, 3934534636, 3006821525, 4149433608, 2858733506},
				A:   [7]uint32{1169928508, 112474988, 3545662729, 4092928397, 3202231617, 2797169705, 3527569114},
				PC:  12164540,
				SR:  9232,
				USP: 1139566,
				SSP: 13731006,
				RAM: [][2]uint32{{12164532, 205}, {12164533, 46}, {12164534, 152}, {12164535, 77}, {12164536, 209}, {12164537, 89}, {4327206, 82}, {4327207, 8}, {12164538, 23}, {12164539, 197}},
				Cycles: 16,
			},
		},
		{
			name: "1146 AND.b (xxx).l, D4 c839",
			init: 			cpuState{
				D:   [8]uint32{425865629, 3116095736, 321459252, 2284117730, 3886116523, 2504667144, 3951354766, 1338193200},
				A:   [7]uint32{2190533772, 4208591602, 4141804736, 1817704712, 2430308953, 874838358, 4014799323},
				PC:  15650936,
				SR:  8219,
				USP: 8629140,
				SSP: 2868074,
				RAM: [][2]uint32{{15650932, 200}, {15650933, 57}, {15650934, 170}, {15650935, 69}, {15650936, 14}, {15650937, 81}, {15650938, 169}, {15650939, 11}, {4525648, 166}, {4525649, 119}, {15650940, 105}, {15650941, 198}},
			},
			want: 			cpuState{
				D:   [8]uint32{425865629, 3116095736, 321459252, 2284117730, 3886116387, 2504667144, 3951354766, 1338193200},
				A:   [7]uint32{2190533772, 4208591602, 4141804736, 1817704712, 2430308953, 874838358, 4014799323},
				PC:  15650942,
				SR:  8208,
				USP: 8629140,
				SSP: 2868074,
				RAM: [][2]uint32{{15650932, 200}, {15650933, 57}, {15650934, 170}, {15650935, 69}, {15650936, 14}, {15650937, 81}, {15650938, 169}, {15650939, 11}, {4525648, 166}, {4525649, 119}, {15650940, 105}, {15650941, 198}},
				Cycles: 16,
			},
		},
		{
			name: "1419 AND.b -(A5), D5 ca25",
			init: 			cpuState{
				D:   [8]uint32{958286147, 1482869447, 688573038, 4165323123, 1700486877, 2523160396, 110761330, 2608293930},
				A:   [7]uint32{2566827894, 388342313, 408894778, 1824424479, 3654283002, 50466510, 3753390490},
				PC:  4183862,
				SR:  9741,
				USP: 10604430,
				SSP: 10171362,
				RAM: [][2]uint32{{4183858, 202}, {4183859, 37}, {4183860, 170}, {4183861, 44}, {134860, 194}, {134861, 45}, {4183862, 220}, {4183863, 214}},
			},
			want: 			cpuState{
				D:   [8]uint32{958286147, 1482869447, 688573038, 4165323123, 1700486877, 2523160332, 110761330, 2608293930},
				A:   [7]uint32{2566827894, 388342313, 408894778, 1824424479, 3654283002, 50466509, 3753390490},
				PC:  4183864,
				SR:  9728,
				USP: 10604430,
				SSP: 10171362,
				RAM: [][2]uint32{{4183858, 202}, {4183859, 37}, {4183860, 170}, {4183861, 44}, {134860, 194}, {134861, 45}, {4183862, 220}, {4183863, 214}},
				Cycles: 10,
			},
		},
		{
			name: "1704 AND.b D6, (d16, A7) cd2f",
			init: 			cpuState{
				D:   [8]uint32{1786021011, 597484652, 1055078717, 4269640562, 3230507655, 848750185, 356525725, 1231500252},
				A:   [7]uint32{2067436135, 926111562, 2670952527, 3381995513, 4107749019, 2300270104, 3773231233},
				PC:  2999828,
				SR:  30,
				USP: 5518406,
				SSP: 509146,
				RAM: [][2]uint32{{2999824, 205}, {2999825, 47}, {2999826, 69}, {2999827, 166}, {2999828, 249}, {2999829, 37}, {5536236, 168}, {5536237, 57}, {2999830, 67}, {2999831, 103}},
			},
			want: 			cpuState{
				D:   [8]uint32{1786021011, 597484652, 1055078717, 4269640562, 3230507655, 848750185, 356525725, 1231500252},
				A:   [7]uint32{2067436135, 926111562, 2670952527, 3381995513, 4107749019, 2300270104, 3773231233},
				PC:  2999832,
				SR:  24,
				USP: 5518406,
				SSP: 509146,
				RAM: [][2]uint32{{2999824, 205}, {2999825, 47}, {2999826, 69}, {2999827, 166}, {2999828, 249}, {2999829, 37}, {5536236, 136}, {5536237, 57}, {2999830, 67}, {2999831, 103}},
				Cycles: 16,
			},
		},
		{
			name: "1945 AND.b D5, (d8, A2, Xn) cb32",
			init: 			cpuState{
				D:   [8]uint32{4178787283, 2917119309, 1134854963, 1926447800, 3556270125, 2087608846, 2457571734, 773396609},
				A:   [7]uint32{2571816321, 3762457085, 176966782, 496997242, 2859115612, 2214368392, 2449529238},
				PC:  5709678,
				SR:  8479,
				USP: 13048042,
				SSP: 11538534,
				RAM: [][2]uint32{{5709674, 203}, {5709675, 50}, {5709676, 144}, {5709677, 135}, {5709678, 42}, {5709679, 204}, {9164290, 75}, {9164291, 229}, {5709680, 41}, {5709681, 158}},
			},
			want: 			cpuState{
				D:   [8]uint32{4178787283, 2917119309, 1134854963, 1926447800, 3556270125, 2087608846, 2457571734, 773396609},
				A:   [7]uint32{2571816321, 3762457085, 176966782, 496997242, 2859115612, 2214368392, 2449529238},
				PC:  5709682,
				SR:  8464,
				USP: 13048042,
				SSP: 11538534,
				RAM: [][2]uint32{{5709674, 203}, {5709675, 50}, {5709676, 144}, {5709677, 135}, {5709678, 42}, {5709679, 204}, {9164290, 10}, {9164291, 229}, {5709680, 41}, {5709681, 158}},
				Cycles: 18,
			},
		},
		{
			name: "2216 AND.b D0, -(A4) c124",
			init: 			cpuState{
				D:   [8]uint32{2776794571, 3185768365, 938764688, 301433201, 1428666429, 4247114113, 1476267758, 1369115441},
				A:   [7]uint32{599555945, 271095486, 3148085101, 3029674530, 2705739535, 2232632587, 1379473002},
				PC:  1498682,
				SR:  8465,
				USP: 13286276,
				SSP: 3754104,
				RAM: [][2]uint32{{1498678, 193}, {1498679, 36}, {1498680, 162}, {1498681, 126}, {4607758, 97}, {4607759, 216}, {1498682, 237}, {1498683, 190}},
			},
			want: 			cpuState{
				D:   [8]uint32{2776794571, 3185768365, 938764688, 301433201, 1428666429, 4247114113, 1476267758, 1369115441},
				A:   [7]uint32{599555945, 271095486, 3148085101, 3029674530, 2705739534, 2232632587, 1379473002},
				PC:  1498684,
				SR:  8464,
				USP: 13286276,
				SSP: 3754104,
				RAM: [][2]uint32{{1498678, 193}, {1498679, 36}, {1498680, 162}, {1498681, 126}, {4607758, 65}, {4607759, 216}, {1498682, 237}, {1498683, 190}},
				Cycles: 14,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestAND_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 AND.w D7, (A5)+ cf5d",
			init: cpuState{
				D:   [8]uint32{470065230, 1049833943, 2713507205, 4027026699, 1011506597, 831025574, 534664186, 3778570442},
				A:   [7]uint32{3796506931, 4050348046, 2257111017, 4223211533, 289411888, 2630226893, 500238866},
				PC:  8783112,
				SR:  42770,
				USP: 13863642,
				SSP: 10408596,
				RAM: [][2]uint32{{8783108, 207}, {8783109, 93}, {8783110, 158}, {8783111, 200}, {12, 19}, {13, 96}, {14, 51}, {15, 72}, {6304584, 231}, {6304585, 177}, {6304586, 152}, {6304587, 148}},
			},
			want: cpuState{
				D:      [8]uint32{470065230, 1049833943, 2713507205, 4027026699, 1011506597, 831025574, 534664186, 3778570442},
				A:      [7]uint32{3796506931, 4050348046, 2257111017, 4223211533, 289411888, 2630226895, 500238866},
				PC:     325071692,
				SR:     10002,
				USP:    13863642,
				SSP:    10408582,
				RAM:    [][2]uint32{{8783108, 207}, {8783109, 93}, {8783110, 158}, {8783111, 200}, {10408594, 5}, {10408595, 6}, {10408590, 167}, {10408591, 18}, {10408592, 0}, {10408593, 134}, {10408588, 207}, {10408589, 93}, {10408586, 19}, {10408587, 205}, {10408582, 207}, {10408583, 85}, {10408584, 156}, {10408585, 198}, {12, 19}, {13, 96}, {14, 51}, {15, 72}, {6304584, 231}, {6304585, 177}, {6304586, 152}, {6304587, 148}},
				Halted: true,
			},
		},
		{
			name: "500 AND.w -(A3), D1 c263",
			init: cpuState{
				D:   [8]uint32{3237672932, 2497974499, 1011561061, 2818748472, 1093815801, 2551522671, 484787115, 2385968650},
				A:   [7]uint32{2967734522, 1937496187, 357918864, 3778251766, 2978257039, 3765229279, 3622448206},
				PC:  9275802,
				SR:  1566,
				USP: 1627640,
				SSP: 15384926,
				RAM: [][2]uint32{{9275798, 194}, {9275799, 99}, {9275800, 160}, {9275801, 60}, {3378164, 72}, {3378165, 250}, {9275802, 23}, {9275803, 20}},
			},
			want: cpuState{
				D:   [8]uint32{3237672932, 2497970402, 1011561061, 2818748472, 1093815801, 2551522671, 484787115, 2385968650},
				A:   [7]uint32{2967734522, 1937496187, 357918864, 3778251764, 2978257039, 3765229279, 3622448206},
				PC:  9275804,
				SR:  1552,
				USP: 1627640,
				SSP: 15384926,
				RAM: [][2]uint32{{9275798, 194}, {9275799, 99}, {9275800, 160}, {9275801, 60}, {3378164, 72}, {3378165, 250}, {9275802, 23}, {9275803, 20}},
				Cycles: 10,
			},
		},
		{
			name: "1000 AND.w D5, (xxx).l cb79",
			init: cpuState{
				D:   [8]uint32{186630710, 710298477, 2687373351, 1238606941, 3472660398, 1540823946, 3179322033, 1854781418},
				A:   [7]uint32{3142960061, 2112506775, 1711742499, 1284278902, 1597599654, 1924328042, 297792844},
				PC:  11621642,
				SR:  34064,
				USP: 10810090,
				SSP: 8886750,
				RAM: [][2]uint32{{11621638, 203}, {11621639, 121}, {11621640, 233}, {11621641, 136}, {11621642, 192}, {11621643, 202}, {11621644, 134}, {11621645, 121}, {8962250, 236}, {8962251, 232}, {11621646, 171}, {11621647, 214}},
			},
			want: cpuState{
				D:   [8]uint32{186630710, 710298477, 2687373351, 1238606941, 3472660398, 1540823946, 3179322033, 1854781418},
				A:   [7]uint32{3142960061, 2112506775, 1711742499, 1284278902, 1597599654, 1924328042, 297792844},
				PC:  11621648,
				SR:  34064,
				USP: 10810090,
				SSP: 8886750,
				RAM: [][2]uint32{{11621638, 203}, {11621639, 121}, {11621640, 233}, {11621641, 136}, {11621642, 192}, {11621643, 202}, {11621644, 134}, {11621645, 121}, {8962250, 8}, {8962251, 136}, {11621646, 171}, {11621647, 214}},
				Cycles: 20,
			},
		},
		{
			name: "1500 AND.w D6, (A2) cd52",
			init: cpuState{
				D:   [8]uint32{965445852, 3059477021, 384626001, 677221587, 4245617613, 3171547404, 3229343101, 1053693608},
				A:   [7]uint32{3200224482, 2965686966, 3532994587, 1664120884, 3647757899, 4033192082, 2565757293},
				PC:  3121326,
				SR:  32798,
				USP: 11771192,
				SSP: 525442,
				RAM: [][2]uint32{{3121322, 205}, {3121323, 82}, {3121324, 163}, {3121325, 121}, {12, 93}, {13, 56}, {14, 121}, {15, 14}, {3701006, 62}, {3701007, 249}, {3701008, 97}, {3701009, 164}},
			},
			want: cpuState{
				D:      [8]uint32{965445852, 3059477021, 384626001, 677221587, 4245617613, 3171547404, 3229343101, 1053693608},
				A:      [7]uint32{3200224482, 2965686966, 3532994587, 1664120884, 3647757899, 4033192082, 2565757293},
				PC:     1563982098,
				SR:     8222,
				USP:    11771192,
				SSP:    525428,
				RAM:    [][2]uint32{{3121322, 205}, {3121323, 82}, {3121324, 163}, {3121325, 121}, {525440, 160}, {525441, 172}, {525436, 128}, {525437, 30}, {525438, 0}, {525439, 47}, {525434, 205}, {525435, 82}, {525432, 56}, {525433, 27}, {525428, 205}, {525429, 81}, {525430, 210}, {525431, 149}, {12, 93}, {13, 56}, {14, 121}, {15, 14}, {3701006, 62}, {3701007, 249}, {3701008, 97}, {3701009, 164}},
				Halted: true,
			},
		},
		{
			name: "2000 AND.w D4, (d16, A4) c96c",
			init: cpuState{
				D:   [8]uint32{887504428, 601670536, 3850289262, 4007043790, 2595667755, 1227611464, 4174156296, 228656571},
				A:   [7]uint32{1682546185, 663505525, 1642568163, 23923254, 1829486994, 3945886464, 3633958038},
				PC:  15583236,
				SR:  271,
				USP: 4355428,
				SSP: 16099788,
				RAM: [][2]uint32{{15583232, 201}, {15583233, 108}, {15583234, 47}, {15583235, 136}, {15583236, 211}, {15583237, 118}, {782618, 250}, {782619, 62}, {15583238, 38}, {15583239, 230}},
			},
			want: cpuState{
				D:   [8]uint32{887504428, 601670536, 3850289262, 4007043790, 2595667755, 1227611464, 4174156296, 228656571},
				A:   [7]uint32{1682546185, 663505525, 1642568163, 23923254, 1829486994, 3945886464, 3633958038},
				PC:  15583240,
				SR:  264,
				USP: 4355428,
				SSP: 16099788,
				RAM: [][2]uint32{{15583232, 201}, {15583233, 108}, {15583234, 47}, {15583235, 136}, {15583236, 211}, {15583237, 118}, {782618, 186}, {782619, 42}, {15583238, 38}, {15583239, 230}},
				Cycles: 16,
			},
		},
		{
			name: "002 AND.w D0, D3 c640",
			init: 			cpuState{
				D:   [8]uint32{3326993895, 633087900, 2194643015, 464173392, 1794820613, 1806801382, 799385516, 262106341},
				A:   [7]uint32{3565058932, 1557670762, 2391895231, 2292460633, 2195095832, 3678649140, 339174398},
				PC:  14994540,
				SR:  775,
				USP: 8150594,
				SSP: 13657306,
				RAM: [][2]uint32{{14994536, 198}, {14994537, 64}, {14994538, 154}, {14994539, 16}, {14994540, 120}, {14994541, 180}},
			},
			want: 			cpuState{
				D:   [8]uint32{3326993895, 633087900, 2194643015, 464167232, 1794820613, 1806801382, 799385516, 262106341},
				A:   [7]uint32{3565058932, 1557670762, 2391895231, 2292460633, 2195095832, 3678649140, 339174398},
				PC:  14994542,
				SR:  776,
				USP: 8150594,
				SSP: 13657306,
				RAM: [][2]uint32{{14994536, 198}, {14994537, 64}, {14994538, 154}, {14994539, 16}, {14994540, 120}, {14994541, 180}},
				Cycles: 4,
			},
		},
		{
			name: "300 AND.w -(A7), D3 c667",
			init: 			cpuState{
				D:   [8]uint32{2882897596, 159414751, 4227703075, 1773421614, 1573998927, 2636165346, 1487574875, 114509787},
				A:   [7]uint32{4105418604, 2046621704, 327579522, 639302638, 3019972451, 1449993868, 2347705208},
				PC:  7885574,
				SR:  1029,
				USP: 8341610,
				SSP: 787908,
				RAM: [][2]uint32{{7885570, 198}, {7885571, 103}, {7885572, 187}, {7885573, 51}, {8341608, 43}, {8341609, 117}, {7885574, 32}, {7885575, 50}},
			},
			want: 			cpuState{
				D:   [8]uint32{2882897596, 159414751, 4227703075, 1773404196, 1573998927, 2636165346, 1487574875, 114509787},
				A:   [7]uint32{4105418604, 2046621704, 327579522, 639302638, 3019972451, 1449993868, 2347705208},
				PC:  7885576,
				SR:  1024,
				USP: 8341608,
				SSP: 787908,
				RAM: [][2]uint32{{7885570, 198}, {7885571, 103}, {7885572, 187}, {7885573, 51}, {8341608, 43}, {8341609, 117}, {7885574, 32}, {7885575, 50}},
				Cycles: 10,
			},
		},
		{
			name: "549 AND.w D4, (d16, A3) c96b",
			init: 			cpuState{
				D:   [8]uint32{29618899, 228390519, 435914604, 1612438187, 3986404623, 3306228407, 1767389718, 2777115787},
				A:   [7]uint32{889184783, 4052757839, 3099535994, 310507449, 626616650, 457299811, 812634220},
				PC:  4043178,
				SR:  1036,
				USP: 16044638,
				SSP: 9106442,
				RAM: [][2]uint32{{4043174, 201}, {4043175, 107}, {4043176, 92}, {4043177, 9}, {4043178, 158}, {4043179, 37}, {8541122, 202}, {8541123, 164}, {4043180, 172}, {4043181, 8}},
			},
			want: 			cpuState{
				D:   [8]uint32{29618899, 228390519, 435914604, 1612438187, 3986404623, 3306228407, 1767389718, 2777115787},
				A:   [7]uint32{889184783, 4052757839, 3099535994, 310507449, 626616650, 457299811, 812634220},
				PC:  4043182,
				SR:  1032,
				USP: 16044638,
				SSP: 9106442,
				RAM: [][2]uint32{{4043174, 201}, {4043175, 107}, {4043176, 92}, {4043177, 9}, {4043178, 158}, {4043179, 37}, {8541122, 128}, {8541123, 4}, {4043180, 172}, {4043181, 8}},
				Cycles: 16,
			},
		},
		{
			name: "805 AND.w D0, (A0) c150",
			init: 			cpuState{
				D:   [8]uint32{3022709639, 2634712400, 3901958701, 413808786, 178687667, 2520896917, 2688666283, 3418414860},
				A:   [7]uint32{1050734574, 2240896321, 4161576215, 497635751, 231776011, 359867903, 2013962454},
				PC:  4744796,
				SR:  799,
				USP: 10955136,
				SSP: 12011836,
				RAM: [][2]uint32{{4744792, 193}, {4744793, 80}, {4744794, 3}, {4744795, 15}, {10547182, 101}, {10547183, 232}, {4744796, 244}, {4744797, 95}},
			},
			want: 			cpuState{
				D:   [8]uint32{3022709639, 2634712400, 3901958701, 413808786, 178687667, 2520896917, 2688666283, 3418414860},
				A:   [7]uint32{1050734574, 2240896321, 4161576215, 497635751, 231776011, 359867903, 2013962454},
				PC:  4744798,
				SR:  784,
				USP: 10955136,
				SSP: 12011836,
				RAM: [][2]uint32{{4744792, 193}, {4744793, 80}, {4744794, 3}, {4744795, 15}, {10547182, 97}, {10547183, 128}, {4744796, 244}, {4744797, 95}},
				Cycles: 12,
			},
		},
		{
			name: "1068 AND.w D4, D1 c244",
			init: 			cpuState{
				D:   [8]uint32{146829983, 2147297600, 4184893480, 1610141253, 3983414733, 3631838659, 2998909671, 3034583268},
				A:   [7]uint32{51380719, 1584868594, 3611557936, 4048174653, 1620049253, 1791543288, 3816364530},
				PC:  4963366,
				SR:  9985,
				USP: 3490022,
				SSP: 7623794,
				RAM: [][2]uint32{{4963362, 194}, {4963363, 68}, {4963364, 213}, {4963365, 22}, {4963366, 48}, {4963367, 40}},
			},
			want: 			cpuState{
				D:   [8]uint32{146829983, 2147287360, 4184893480, 1610141253, 3983414733, 3631838659, 2998909671, 3034583268},
				A:   [7]uint32{51380719, 1584868594, 3611557936, 4048174653, 1620049253, 1791543288, 3816364530},
				PC:  4963368,
				SR:  9984,
				USP: 3490022,
				SSP: 7623794,
				RAM: [][2]uint32{{4963362, 194}, {4963363, 68}, {4963364, 213}, {4963365, 22}, {4963366, 48}, {4963367, 40}},
				Cycles: 4,
			},
		},
		{
			name: "1372 AND.w (xxx).w, D0 c078",
			init: 			cpuState{
				D:   [8]uint32{2904185721, 3216147387, 1489025451, 3498010454, 2240165398, 4145023490, 2463059882, 3888602065},
				A:   [7]uint32{1745847273, 3450956015, 2319846587, 2679529876, 3391191589, 1206632592, 1752075844},
				PC:  13913786,
				SR:  780,
				USP: 8445730,
				SSP: 1269902,
				RAM: [][2]uint32{{13913782, 192}, {13913783, 120}, {13913784, 215}, {13913785, 150}, {13913786, 173}, {13913787, 71}, {16766870, 112}, {16766871, 233}, {13913788, 190}, {13913789, 80}},
			},
			want: 			cpuState{
				D:   [8]uint32{2904182889, 3216147387, 1489025451, 3498010454, 2240165398, 4145023490, 2463059882, 3888602065},
				A:   [7]uint32{1745847273, 3450956015, 2319846587, 2679529876, 3391191589, 1206632592, 1752075844},
				PC:  13913790,
				SR:  768,
				USP: 8445730,
				SSP: 1269902,
				RAM: [][2]uint32{{13913782, 192}, {13913783, 120}, {13913784, 215}, {13913785, 150}, {13913786, 173}, {13913787, 71}, {16766870, 112}, {16766871, 233}, {13913788, 190}, {13913789, 80}},
				Cycles: 12,
			},
		},
		{
			name: "1625 AND.w (A0)+, D1 c258",
			init: 			cpuState{
				D:   [8]uint32{2918116032, 2375942204, 4161473699, 399838052, 2165196474, 2076576656, 773534187, 1421066974},
				A:   [7]uint32{3469021370, 3037095931, 986468093, 1528828838, 1900131090, 379903302, 3073270072},
				PC:  3401460,
				SR:  1035,
				USP: 5615690,
				SSP: 12730540,
				RAM: [][2]uint32{{3401456, 194}, {3401457, 88}, {3401458, 191}, {3401459, 123}, {12914874, 176}, {12914875, 246}, {3401460, 227}, {3401461, 245}},
			},
			want: 			cpuState{
				D:   [8]uint32{2918116032, 2375942196, 4161473699, 399838052, 2165196474, 2076576656, 773534187, 1421066974},
				A:   [7]uint32{3469021372, 3037095931, 986468093, 1528828838, 1900131090, 379903302, 3073270072},
				PC:  3401462,
				SR:  1024,
				USP: 5615690,
				SSP: 12730540,
				RAM: [][2]uint32{{3401456, 194}, {3401457, 88}, {3401458, 191}, {3401459, 123}, {12914874, 176}, {12914875, 246}, {3401460, 227}, {3401461, 245}},
				Cycles: 8,
			},
		},
		{
			name: "1884 AND.w D0, (A3)+ c15b",
			init: 			cpuState{
				D:   [8]uint32{1295561802, 2264289673, 892980130, 3410661892, 3482687942, 2886867951, 2736106034, 1328074932},
				A:   [7]uint32{3338362957, 934183709, 721866441, 3345116616, 3981958131, 1201728031, 2695547930},
				PC:  1791618,
				SR:  1298,
				USP: 4106636,
				SSP: 9676246,
				RAM: [][2]uint32{{1791614, 193}, {1791615, 91}, {1791616, 111}, {1791617, 206}, {6450632, 4}, {6450633, 219}, {1791618, 201}, {1791619, 237}},
			},
			want: 			cpuState{
				D:   [8]uint32{1295561802, 2264289673, 892980130, 3410661892, 3482687942, 2886867951, 2736106034, 1328074932},
				A:   [7]uint32{3338362957, 934183709, 721866441, 3345116618, 3981958131, 1201728031, 2695547930},
				PC:  1791620,
				SR:  1296,
				USP: 4106636,
				SSP: 9676246,
				RAM: [][2]uint32{{1791614, 193}, {1791615, 91}, {1791616, 111}, {1791617, 206}, {6450632, 4}, {6450633, 74}, {1791618, 201}, {1791619, 237}},
				Cycles: 12,
			},
		},
		{
			name: "2193 AND.w D2, D6 cc42",
			init: 			cpuState{
				D:   [8]uint32{3391435916, 382928639, 3358828417, 1057030083, 3921361390, 797886236, 3182163717, 1565146898},
				A:   [7]uint32{3496344177, 2560589159, 3203186639, 3352043891, 216685722, 4275067578, 3469310267},
				PC:  5214518,
				SR:  8215,
				USP: 7134056,
				SSP: 974556,
				RAM: [][2]uint32{{5214514, 204}, {5214515, 66}, {5214516, 216}, {5214517, 27}, {5214518, 136}, {5214519, 62}},
			},
			want: 			cpuState{
				D:   [8]uint32{3391435916, 382928639, 3358828417, 1057030083, 3921361390, 797886236, 3182143233, 1565146898},
				A:   [7]uint32{3496344177, 2560589159, 3203186639, 3352043891, 216685722, 4275067578, 3469310267},
				PC:  5214520,
				SR:  8216,
				USP: 7134056,
				SSP: 974556,
				RAM: [][2]uint32{{5214514, 204}, {5214515, 66}, {5214516, 216}, {5214517, 27}, {5214518, 136}, {5214519, 62}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestAND_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 AND.l D5, (A4)+ cb9c",
			init: cpuState{
				D:   [8]uint32{922200166, 1634731057, 1384255826, 4165284375, 3986156178, 156727417, 2291521453, 2079116780},
				A:   [7]uint32{1072804380, 2242832998, 1816450483, 1691735783, 3362939947, 2127193698, 2507654371},
				PC:  478070,
				SR:  32791,
				USP: 2858110,
				SSP: 9784714,
				RAM: [][2]uint32{{478066, 203}, {478067, 156}, {478068, 134}, {478069, 182}, {12, 121}, {13, 20}, {14, 142}, {15, 24}, {1347096, 82}, {1347097, 127}, {1347098, 132}, {1347099, 50}},
			},
			want: cpuState{
				D:      [8]uint32{922200166, 1634731057, 1384255826, 4165284375, 3986156178, 156727417, 2291521453, 2079116780},
				A:      [7]uint32{1072804380, 2242832998, 1816450483, 1691735783, 3362939947, 2127193698, 2507654371},
				PC:     2031390236,
				SR:     8215,
				USP:    2858110,
				SSP:    9784700,
				RAM:    [][2]uint32{{478066, 203}, {478067, 156}, {478068, 134}, {478069, 182}, {9784712, 75}, {9784713, 116}, {9784708, 128}, {9784709, 23}, {9784710, 0}, {9784711, 7}, {9784706, 203}, {9784707, 156}, {9784704, 100}, {9784705, 43}, {9784700, 203}, {9784701, 145}, {9784702, 200}, {9784703, 114}, {12, 121}, {13, 20}, {14, 142}, {15, 24}, {1347096, 82}, {1347097, 127}, {1347098, 132}, {1347099, 50}},
				Halted: true,
			},
		},
		{
			name: "500 AND.l D2, D5 ca82",
			init: cpuState{
				D:   [8]uint32{89631080, 2591633052, 3175151427, 2089778363, 2309986153, 1124918604, 150987641, 833260207},
				A:   [7]uint32{864219277, 1774530954, 615508631, 2692222502, 51098179, 3098996461, 4031098634},
				PC:  5098258,
				SR:  1280,
				USP: 10858140,
				SSP: 8933874,
				RAM: [][2]uint32{{5098254, 202}, {5098255, 130}, {5098256, 139}, {5098257, 139}, {5098258, 216}, {5098259, 187}},
			},
			want: cpuState{
				D:   [8]uint32{89631080, 2591633052, 3175151427, 2089778363, 2309986153, 16835904, 150987641, 833260207},
				A:   [7]uint32{864219277, 1774530954, 615508631, 2692222502, 51098179, 3098996461, 4031098634},
				PC:  5098260,
				SR:  1280,
				USP: 10858140,
				SSP: 8933874,
				RAM: [][2]uint32{{5098254, 202}, {5098255, 130}, {5098256, 139}, {5098257, 139}, {5098258, 216}, {5098259, 187}},
				Cycles: 8,
			},
		},
		{
			name: "1000 AND.l (d8, A4, Xn), D6 ccb4",
			init: cpuState{
				D:   [8]uint32{2189815023, 3204245924, 1312679599, 3635032639, 1081541678, 1542705011, 2947695039, 4080095917},
				A:   [7]uint32{3469149985, 1260780375, 2095156553, 1370494942, 623144067, 2287133115, 251076975},
				PC:  1109872,
				SR:  34325,
				USP: 6502936,
				SSP: 6746582,
				RAM: [][2]uint32{{1109868, 204}, {1109869, 180}, {1109870, 72}, {1109871, 192}, {1109872, 198}, {1109873, 246}, {12, 95}, {13, 208}, {14, 203}, {15, 92}, {13683548, 75}, {13683549, 212}, {13683550, 147}, {13683551, 228}},
			},
			want: cpuState{
				D:      [8]uint32{2189815023, 3204245924, 1312679599, 3635032639, 1081541678, 1542705011, 2947695039, 4080095917},
				A:      [7]uint32{3469149985, 1260780375, 2095156553, 1370494942, 623144067, 2287133115, 251076975},
				PC:     1607519072,
				SR:     9749,
				USP:    6502936,
				SSP:    6746568,
				RAM:    [][2]uint32{{1109868, 204}, {1109869, 180}, {1109870, 72}, {1109871, 192}, {1109872, 198}, {1109873, 246}, {6746580, 239}, {6746581, 110}, {6746576, 134}, {6746577, 21}, {6746578, 0}, {6746579, 16}, {6746574, 204}, {6746575, 180}, {6746572, 112}, {6746573, 113}, {6746568, 204}, {6746569, 177}, {6746570, 101}, {6746571, 155}, {12, 95}, {13, 208}, {14, 203}, {15, 92}, {13683548, 75}, {13683549, 212}, {13683550, 147}, {13683551, 228}},
				Halted: true,
			},
		},
		{
			name: "1500 AND.l (A7)+, D2 c49f",
			init: cpuState{
				D:   [8]uint32{833105693, 3868083965, 3610840310, 3656255125, 929898330, 837531064, 834255254, 42179301},
				A:   [7]uint32{1429973882, 3575224595, 660706940, 427558059, 1251731896, 574864352, 288281972},
				PC:  14891870,
				SR:  524,
				USP: 8518562,
				SSP: 3781332,
				RAM: [][2]uint32{{14891866, 196}, {14891867, 159}, {14891868, 225}, {14891869, 209}, {8518562, 55}, {8518563, 66}, {8518564, 140}, {8518565, 89}, {14891870, 113}, {14891871, 135}},
			},
			want: cpuState{
				D:   [8]uint32{833105693, 3868083965, 385879120, 3656255125, 929898330, 837531064, 834255254, 42179301},
				A:   [7]uint32{1429973882, 3575224595, 660706940, 427558059, 1251731896, 574864352, 288281972},
				PC:  14891872,
				SR:  512,
				USP: 8518566,
				SSP: 3781332,
				RAM: [][2]uint32{{14891866, 196}, {14891867, 159}, {14891868, 225}, {14891869, 209}, {8518562, 55}, {8518563, 66}, {8518564, 140}, {8518565, 89}, {14891870, 113}, {14891871, 135}},
				Cycles: 14,
			},
		},
		{
			name: "2000 AND.l D0, (A1) c191",
			init: cpuState{
				D:   [8]uint32{3586022064, 1869811600, 2134224306, 1572504590, 1762925672, 1081431194, 3256730341, 1109104672},
				A:   [7]uint32{457868840, 117980121, 850650083, 3212723232, 4110374314, 3939455308, 3470628073},
				PC:  6446190,
				SR:  285,
				USP: 7845056,
				SSP: 7062390,
				RAM: [][2]uint32{{6446186, 193}, {6446187, 145}, {6446188, 231}, {6446189, 6}, {12, 249}, {13, 238}, {14, 203}, {15, 232}, {15649768, 37}, {15649769, 87}, {15649770, 60}, {15649771, 236}},
			},
			want: cpuState{
				D:      [8]uint32{3586022064, 1869811600, 2134224306, 1572504590, 1762925672, 1081431194, 3256730341, 1109104672},
				A:      [7]uint32{457868840, 117980121, 850650083, 3212723232, 4110374314, 3939455308, 3470628073},
				PC:     4193176556,
				SR:     8477,
				USP:    7845056,
				SSP:    7062376,
				RAM:    [][2]uint32{{6446186, 193}, {6446187, 145}, {6446188, 231}, {6446189, 6}, {7062388, 92}, {7062389, 108}, {7062384, 1}, {7062385, 29}, {7062386, 0}, {7062387, 98}, {7062382, 193}, {7062383, 145}, {7062380, 59}, {7062381, 217}, {7062376, 193}, {7062377, 145}, {7062378, 7}, {7062379, 8}, {12, 249}, {13, 238}, {14, 203}, {15, 232}, {15649768, 37}, {15649769, 87}, {15649770, 60}, {15649771, 236}},
				Halted: true,
			},
		},
		{
			name: "012 AND.l D1, D7 ce81",
			init: 			cpuState{
				D:   [8]uint32{4011779676, 3148500769, 2755826513, 327150021, 3067833918, 4198189247, 3331098514, 364094119},
				A:   [7]uint32{1418708262, 3842212443, 131749984, 3251411501, 2755698895, 2164804139, 2556899887},
				PC:  1092448,
				SR:  8468,
				USP: 12799124,
				SSP: 14193740,
				RAM: [][2]uint32{{1092444, 206}, {1092445, 129}, {1092446, 237}, {1092447, 163}, {1092448, 127}, {1092449, 227}},
			},
			want: 			cpuState{
				D:   [8]uint32{4011779676, 3148500769, 2755826513, 327150021, 3067833918, 4198189247, 3331098514, 295830049},
				A:   [7]uint32{1418708262, 3842212443, 131749984, 3251411501, 2755698895, 2164804139, 2556899887},
				PC:  1092450,
				SR:  8464,
				USP: 12799124,
				SSP: 14193740,
				RAM: [][2]uint32{{1092444, 206}, {1092445, 129}, {1092446, 237}, {1092447, 163}, {1092448, 127}, {1092449, 227}},
				Cycles: 8,
			},
		},
		{
			name: "285 AND.l D0, D6 cc80",
			init: 			cpuState{
				D:   [8]uint32{776203715, 1972656384, 3547042228, 3462620234, 2725209465, 1226998965, 4237839423, 2415576972},
				A:   [7]uint32{3007349801, 2445688126, 3204440855, 601166882, 970244691, 1124452398, 1904279930},
				PC:  5093608,
				SR:  771,
				USP: 13014196,
				SSP: 9334702,
				RAM: [][2]uint32{{5093604, 204}, {5093605, 128}, {5093606, 126}, {5093607, 2}, {5093608, 186}, {5093609, 239}},
			},
			want: 			cpuState{
				D:   [8]uint32{776203715, 1972656384, 3547042228, 3462620234, 2725209465, 1226998965, 738216963, 2415576972},
				A:   [7]uint32{3007349801, 2445688126, 3204440855, 601166882, 970244691, 1124452398, 1904279930},
				PC:  5093610,
				SR:  768,
				USP: 13014196,
				SSP: 9334702,
				RAM: [][2]uint32{{5093604, 204}, {5093605, 128}, {5093606, 126}, {5093607, 2}, {5093608, 186}, {5093609, 239}},
				Cycles: 8,
			},
		},
		{
			name: "610 AND.l D7, (A4) cf94",
			init: 			cpuState{
				D:   [8]uint32{1735039314, 2754796304, 2634346589, 1887713373, 4205024232, 893636605, 130881939, 3562590641},
				A:   [7]uint32{631744785, 3096285731, 164579257, 1892418697, 2587454364, 1369003575, 1405210578},
				PC:  13217696,
				SR:  8470,
				USP: 16325084,
				SSP: 5467078,
				RAM: [][2]uint32{{13217692, 207}, {13217693, 148}, {13217694, 186}, {13217695, 130}, {3763100, 240}, {3763101, 119}, {3763102, 126}, {3763103, 158}, {13217696, 78}, {13217697, 199}},
			},
			want: 			cpuState{
				D:   [8]uint32{1735039314, 2754796304, 2634346589, 1887713373, 4205024232, 893636605, 130881939, 3562590641},
				A:   [7]uint32{631744785, 3096285731, 164579257, 1892418697, 2587454364, 1369003575, 1405210578},
				PC:  13217698,
				SR:  8472,
				USP: 16325084,
				SSP: 5467078,
				RAM: [][2]uint32{{13217692, 207}, {13217693, 148}, {13217694, 186}, {13217695, 130}, {3763100, 208}, {3763101, 80}, {3763102, 80}, {3763103, 144}, {13217696, 78}, {13217697, 199}},
				Cycles: 20,
			},
		},
		{
			name: "896 AND.l D3, -(A7) c7a7",
			init: 			cpuState{
				D:   [8]uint32{972129193, 927158399, 2249389070, 1046088747, 252468980, 2429181443, 1195717502, 191529353},
				A:   [7]uint32{2950725581, 3252088256, 1849961462, 258419812, 3287145288, 10520456, 1438193370},
				PC:  3573120,
				SR:  10010,
				USP: 11199528,
				SSP: 7502884,
				RAM: [][2]uint32{{3573116, 199}, {3573117, 167}, {3573118, 78}, {3573119, 248}, {7502880, 179}, {7502881, 215}, {7502882, 4}, {7502883, 37}, {3573120, 159}, {3573121, 153}},
			},
			want: 			cpuState{
				D:   [8]uint32{972129193, 927158399, 2249389070, 1046088747, 252468980, 2429181443, 1195717502, 191529353},
				A:   [7]uint32{2950725581, 3252088256, 1849961462, 258419812, 3287145288, 10520456, 1438193370},
				PC:  3573122,
				SR:  10000,
				USP: 11199528,
				SSP: 7502880,
				RAM: [][2]uint32{{3573116, 199}, {3573117, 167}, {3573118, 78}, {3573119, 248}, {7502880, 50}, {7502881, 82}, {7502882, 4}, {7502883, 33}, {3573120, 159}, {3573121, 153}},
				Cycles: 22,
			},
		},
		{
			name: "1148 AND.l D7, (xxx).w cfb8",
			init: 			cpuState{
				D:   [8]uint32{3408685155, 1064761861, 4268628678, 3682060678, 2454699599, 3677733919, 133337793, 3785738752},
				A:   [7]uint32{148468316, 1968972234, 756243189, 3923075252, 2510144937, 2841100919, 1092045946},
				PC:  828080,
				SR:  9500,
				USP: 11155748,
				SSP: 14057732,
				RAM: [][2]uint32{{828076, 207}, {828077, 184}, {828078, 111}, {828079, 44}, {828080, 148}, {828081, 110}, {28460, 207}, {28461, 212}, {28462, 219}, {28463, 87}, {828082, 60}, {828083, 88}},
			},
			want: 			cpuState{
				D:   [8]uint32{3408685155, 1064761861, 4268628678, 3682060678, 2454699599, 3677733919, 133337793, 3785738752},
				A:   [7]uint32{148468316, 1968972234, 756243189, 3923075252, 2510144937, 2841100919, 1092045946},
				PC:  828084,
				SR:  9496,
				USP: 11155748,
				SSP: 14057732,
				RAM: [][2]uint32{{828076, 207}, {828077, 184}, {828078, 111}, {828079, 44}, {828080, 148}, {828081, 110}, {28460, 193}, {28461, 132}, {28462, 202}, {28463, 0}, {828082, 60}, {828083, 88}},
				Cycles: 24,
			},
		},
		{
			name: "1423 AND.l (A6), D2 c496",
			init: 			cpuState{
				D:   [8]uint32{3534706637, 3138579641, 3495921283, 3617716759, 4070142535, 95242372, 3509719100, 1544165716},
				A:   [7]uint32{3134658784, 2962834815, 3197008998, 3434908738, 2998717694, 2111392893, 2848710386},
				PC:  7385208,
				SR:  773,
				USP: 4787780,
				SSP: 6946346,
				RAM: [][2]uint32{{7385204, 196}, {7385205, 150}, {7385206, 81}, {7385207, 149}, {13360882, 157}, {13360883, 4}, {13360884, 91}, {13360885, 161}, {7385208, 193}, {7385209, 41}},
			},
			want: 			cpuState{
				D:   [8]uint32{3534706637, 3138579641, 2416181889, 3617716759, 4070142535, 95242372, 3509719100, 1544165716},
				A:   [7]uint32{3134658784, 2962834815, 3197008998, 3434908738, 2998717694, 2111392893, 2848710386},
				PC:  7385210,
				SR:  776,
				USP: 4787780,
				SSP: 6946346,
				RAM: [][2]uint32{{7385204, 196}, {7385205, 150}, {7385206, 81}, {7385207, 149}, {13360882, 157}, {13360883, 4}, {13360884, 91}, {13360885, 161}, {7385208, 193}, {7385209, 41}},
				Cycles: 14,
			},
		},
		{
			name: "1705 AND.l (d8, A5, Xn), D3 c6b5",
			init: 			cpuState{
				D:   [8]uint32{986939857, 1981314220, 2322682563, 2313029287, 1601546268, 1920248785, 2981380961, 14267083},
				A:   [7]uint32{1488153413, 2666497395, 3469839233, 1058998454, 2062215346, 3697594335, 3623491442},
				PC:  14997342,
				SR:  1044,
				USP: 5900706,
				SSP: 3968636,
				RAM: [][2]uint32{{14997338, 198}, {14997339, 181}, {14997340, 71}, {14997341, 149}, {14997342, 249}, {14997343, 157}, {6584208, 215}, {6584209, 52}, {6584210, 105}, {6584211, 184}, {14997344, 200}, {14997345, 176}},
			},
			want: 			cpuState{
				D:   [8]uint32{986939857, 1981314220, 2322682563, 2165571744, 1601546268, 1920248785, 2981380961, 14267083},
				A:   [7]uint32{1488153413, 2666497395, 3469839233, 1058998454, 2062215346, 3697594335, 3623491442},
				PC:  14997346,
				SR:  1048,
				USP: 5900706,
				SSP: 3968636,
				RAM: [][2]uint32{{14997338, 198}, {14997339, 181}, {14997340, 71}, {14997341, 149}, {14997342, 249}, {14997343, 157}, {6584208, 215}, {6584209, 52}, {6584210, 105}, {6584211, 184}, {14997344, 200}, {14997345, 176}},
				Cycles: 20,
			},
		},
		{
			name: "1962 AND.l D7, (A1)+ cf99",
			init: 			cpuState{
				D:   [8]uint32{2802747534, 3967372531, 2232794844, 1254056000, 3798890383, 3278213912, 350870399, 612752454},
				A:   [7]uint32{1866223368, 2382413982, 3539968903, 4279529547, 2955162080, 3343506596, 1272792900},
				PC:  14535818,
				SR:  18,
				USP: 13348648,
				SSP: 11697210,
				RAM: [][2]uint32{{14535814, 207}, {14535815, 153}, {14535816, 214}, {14535817, 214}, {49310, 122}, {49311, 160}, {49312, 64}, {49313, 174}, {14535818, 31}, {14535819, 181}},
			},
			want: 			cpuState{
				D:   [8]uint32{2802747534, 3967372531, 2232794844, 1254056000, 3798890383, 3278213912, 350870399, 612752454},
				A:   [7]uint32{1866223368, 2382413986, 3539968903, 4279529547, 2955162080, 3343506596, 1272792900},
				PC:  14535820,
				SR:  16,
				USP: 13348648,
				SSP: 11697210,
				RAM: [][2]uint32{{14535814, 207}, {14535815, 153}, {14535816, 214}, {14535817, 214}, {49310, 32}, {49311, 128}, {49312, 64}, {49313, 6}, {14535818, 31}, {14535819, 181}},
				Cycles: 20,
			},
		},
		{
			name: "2244 AND.l D0, (d8, A7, Xn) c1b7",
			init: 			cpuState{
				D:   [8]uint32{2996879824, 3295664764, 2820707389, 900723952, 3059291544, 4248935377, 3411655769, 1321908066},
				A:   [7]uint32{1560357342, 3143842039, 3491140332, 2727345214, 3039631884, 4213443289, 2553603246},
				PC:  13257824,
				SR:  8713,
				USP: 13504664,
				SSP: 8499730,
				RAM: [][2]uint32{{13257820, 193}, {13257821, 183}, {13257822, 75}, {13257823, 6}, {13257824, 37}, {13257825, 173}, {14337968, 238}, {14337969, 16}, {14337970, 250}, {14337971, 181}, {13257826, 10}, {13257827, 85}},
			},
			want: 			cpuState{
				D:   [8]uint32{2996879824, 3295664764, 2820707389, 900723952, 3059291544, 4248935377, 3411655769, 1321908066},
				A:   [7]uint32{1560357342, 3143842039, 3491140332, 2727345214, 3039631884, 4213443289, 2553603246},
				PC:  13257828,
				SR:  8712,
				USP: 13504664,
				SSP: 8499730,
				RAM: [][2]uint32{{13257820, 193}, {13257821, 183}, {13257822, 75}, {13257823, 6}, {13257824, 37}, {13257825, 173}, {14337968, 162}, {14337969, 0}, {14337970, 192}, {14337971, 144}, {13257826, 10}, {13257827, 85}},
				Cycles: 26,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestOR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 OR.b -(A2), D0 8022",
			init: cpuState{
				D:   [8]uint32{1464886001, 422299933, 2061943005, 2014634987, 1578524256, 28073932, 3805994012, 147848747},
				A:   [7]uint32{891510178, 3370414180, 1621082086, 3960798794, 2962935417, 2540983209, 3063807864},
				PC:  16120692,
				SR:  543,
				USP: 15445762,
				SSP: 13322440,
				RAM: [][2]uint32{{16120688, 128}, {16120689, 34}, {16120690, 102}, {16120691, 213}, {10469348, 21}, {10469349, 172}, {16120692, 4}, {16120693, 149}},
			},
			want: cpuState{
				D:   [8]uint32{1464886013, 422299933, 2061943005, 2014634987, 1578524256, 28073932, 3805994012, 147848747},
				A:   [7]uint32{891510178, 3370414180, 1621082085, 3960798794, 2962935417, 2540983209, 3063807864},
				PC:  16120694,
				SR:  536,
				USP: 15445762,
				SSP: 13322440,
				RAM: [][2]uint32{{16120688, 128}, {16120689, 34}, {16120690, 102}, {16120691, 213}, {10469348, 21}, {10469349, 172}, {16120692, 4}, {16120693, 149}},
				Cycles: 10,
			},
		},
		{
			name: "500 OR.b #, -(A3) 0023",
			init: cpuState{
				D:   [8]uint32{2159019827, 2923809159, 2076855419, 679804200, 604735235, 3889630941, 3501335164, 1193109961},
				A:   [7]uint32{4185909881, 1227301791, 4198559042, 3451823745, 994728712, 2740826082, 3413916965},
				PC:  7262182,
				SR:  42526,
				USP: 6349288,
				SSP: 14133810,
				RAM: [][2]uint32{{7262178, 0}, {7262179, 35}, {7262180, 175}, {7262181, 143}, {7262182, 60}, {7262183, 140}, {12494464, 203}, {12494465, 78}, {7262184, 4}, {7262185, 12}},
			},
			want: cpuState{
				D:   [8]uint32{2159019827, 2923809159, 2076855419, 679804200, 604735235, 3889630941, 3501335164, 1193109961},
				A:   [7]uint32{4185909881, 1227301791, 4198559042, 3451823744, 994728712, 2740826082, 3413916965},
				PC:  7262186,
				SR:  42520,
				USP: 6349288,
				SSP: 14133810,
				RAM: [][2]uint32{{7262178, 0}, {7262179, 35}, {7262180, 175}, {7262181, 143}, {7262182, 60}, {7262183, 140}, {12494464, 207}, {12494465, 78}, {7262184, 4}, {7262185, 12}},
				Cycles: 18,
			},
		},
		{
			name: "1000 OR.b (d8, PC, Xn), D2 843b",
			init: cpuState{
				D:   [8]uint32{1008465004, 565654395, 3014457300, 4200457247, 3499226907, 2067109071, 1537380564, 3576729133},
				A:   [7]uint32{2954305718, 799989559, 1969384523, 585204769, 3081445438, 523659975, 2441992117},
				PC:  13571424,
				SR:  41740,
				USP: 7741646,
				SSP: 11035856,
				RAM: [][2]uint32{{13571420, 132}, {13571421, 59}, {13571422, 141}, {13571423, 149}, {13571424, 221}, {13571425, 245}, {15087016, 131}, {15087017, 191}, {13571426, 35}, {13571427, 113}},
			},
			want: cpuState{
				D:   [8]uint32{1008465004, 565654395, 3014457343, 4200457247, 3499226907, 2067109071, 1537380564, 3576729133},
				A:   [7]uint32{2954305718, 799989559, 1969384523, 585204769, 3081445438, 523659975, 2441992117},
				PC:  13571428,
				SR:  41736,
				USP: 7741646,
				SSP: 11035856,
				RAM: [][2]uint32{{13571420, 132}, {13571421, 59}, {13571422, 141}, {13571423, 149}, {13571424, 221}, {13571425, 245}, {15087016, 131}, {15087017, 191}, {13571426, 35}, {13571427, 113}},
				Cycles: 14,
			},
		},
		{
			name: "1500 OR.b D6, D3 8606",
			init: cpuState{
				D:   [8]uint32{3954948865, 1108348728, 1897355846, 3851781480, 443051093, 3009050904, 1015182097, 518329263},
				A:   [7]uint32{1912353017, 3013660754, 1185738472, 1515503709, 205605898, 1609494155, 401588752},
				PC:  15126554,
				SR:  9737,
				USP: 10867420,
				SSP: 5964438,
				RAM: [][2]uint32{{15126550, 134}, {15126551, 6}, {15126552, 203}, {15126553, 56}, {15126554, 156}, {15126555, 210}},
			},
			want: cpuState{
				D:   [8]uint32{3954948865, 1108348728, 1897355846, 3851781497, 443051093, 3009050904, 1015182097, 518329263},
				A:   [7]uint32{1912353017, 3013660754, 1185738472, 1515503709, 205605898, 1609494155, 401588752},
				PC:  15126556,
				SR:  9728,
				USP: 10867420,
				SSP: 5964438,
				RAM: [][2]uint32{{15126550, 134}, {15126551, 6}, {15126552, 203}, {15126553, 56}, {15126554, 156}, {15126555, 210}},
				Cycles: 4,
			},
		},
		{
			name: "2000 OR.b D0, (d16, A2) 812a",
			init: cpuState{
				D:   [8]uint32{4278630301, 3632017265, 3373182402, 222910286, 2512778869, 2788498895, 102558576, 935383500},
				A:   [7]uint32{4135287344, 4010487698, 3025332135, 3467473665, 1454258917, 24542654, 458674039},
				PC:  478736,
				SR:  33283,
				USP: 14716492,
				SSP: 2553602,
				RAM: [][2]uint32{{478732, 129}, {478733, 42}, {478734, 58}, {478735, 203}, {478736, 199}, {478737, 107}, {5448306, 29}, {5448307, 119}, {478738, 240}, {478739, 178}},
			},
			want: cpuState{
				D:   [8]uint32{4278630301, 3632017265, 3373182402, 222910286, 2512778869, 2788498895, 102558576, 935383500},
				A:   [7]uint32{4135287344, 4010487698, 3025332135, 3467473665, 1454258917, 24542654, 458674039},
				PC:  478740,
				SR:  33288,
				USP: 14716492,
				SSP: 2553602,
				RAM: [][2]uint32{{478732, 129}, {478733, 42}, {478734, 58}, {478735, 203}, {478736, 199}, {478737, 107}, {5448306, 157}, {5448307, 119}, {478738, 240}, {478739, 178}},
				Cycles: 16,
			},
		},
		{
			name: "001 OR.b D3, D1 8203",
			init: 			cpuState{
				D:   [8]uint32{1651319411, 2119498725, 660358539, 437517659, 1175122783, 4268516259, 602560416, 697887696},
				A:   [7]uint32{3331017155, 756064101, 628879992, 4164982032, 4017760317, 634519026, 3357704150},
				PC:  2868016,
				SR:  8984,
				USP: 9312770,
				SSP: 13987136,
				RAM: [][2]uint32{{2868012, 130}, {2868013, 3}, {2868014, 29}, {2868015, 20}, {2868016, 46}, {2868017, 207}},
			},
			want: 			cpuState{
				D:   [8]uint32{1651319411, 2119498751, 660358539, 437517659, 1175122783, 4268516259, 602560416, 697887696},
				A:   [7]uint32{3331017155, 756064101, 628879992, 4164982032, 4017760317, 634519026, 3357704150},
				PC:  2868018,
				SR:  8984,
				USP: 9312770,
				SSP: 13987136,
				RAM: [][2]uint32{{2868012, 130}, {2868013, 3}, {2868014, 29}, {2868015, 20}, {2868016, 46}, {2868017, 207}},
				Cycles: 4,
			},
		},
		{
			name: "283 OR.b D5, (A6) 8b16",
			init: 			cpuState{
				D:   [8]uint32{306803720, 105212724, 2091434233, 2141723221, 1267717005, 3130202855, 1385234298, 3346815016},
				A:   [7]uint32{396407977, 3299659450, 3769325292, 2094403324, 1382071372, 300079504, 2106969214},
				PC:  12919284,
				SR:  25,
				USP: 1712642,
				SSP: 13867960,
				RAM: [][2]uint32{{12919280, 139}, {12919281, 22}, {12919282, 145}, {12919283, 175}, {9817214, 31}, {9817215, 112}, {12919284, 162}, {12919285, 96}},
			},
			want: 			cpuState{
				D:   [8]uint32{306803720, 105212724, 2091434233, 2141723221, 1267717005, 3130202855, 1385234298, 3346815016},
				A:   [7]uint32{396407977, 3299659450, 3769325292, 2094403324, 1382071372, 300079504, 2106969214},
				PC:  12919286,
				SR:  24,
				USP: 1712642,
				SSP: 13867960,
				RAM: [][2]uint32{{12919280, 139}, {12919281, 22}, {12919282, 145}, {12919283, 175}, {9817214, 255}, {9817215, 112}, {12919284, 162}, {12919285, 96}},
				Cycles: 12,
			},
		},
		{
			name: "569 OR.b D6, (A3) 8d13",
			init: 			cpuState{
				D:   [8]uint32{1456336900, 1912828607, 3665564931, 671750156, 1780438696, 1741393354, 1034438931, 565859046},
				A:   [7]uint32{751802958, 3120039128, 2715245645, 3431314475, 1250937477, 1688917277, 3928631742},
				PC:  11630474,
				SR:  9732,
				USP: 4206750,
				SSP: 15666522,
				RAM: [][2]uint32{{11630470, 141}, {11630471, 19}, {11630472, 254}, {11630473, 30}, {8762410, 122}, {8762411, 172}, {11630474, 114}, {11630475, 230}},
			},
			want: 			cpuState{
				D:   [8]uint32{1456336900, 1912828607, 3665564931, 671750156, 1780438696, 1741393354, 1034438931, 565859046},
				A:   [7]uint32{751802958, 3120039128, 2715245645, 3431314475, 1250937477, 1688917277, 3928631742},
				PC:  11630476,
				SR:  9736,
				USP: 4206750,
				SSP: 15666522,
				RAM: [][2]uint32{{11630470, 141}, {11630471, 19}, {11630472, 254}, {11630473, 30}, {8762410, 122}, {8762411, 191}, {11630474, 114}, {11630475, 230}},
				Cycles: 12,
			},
		},
		{
			name: "825 OR.b D4, (A4)+ 891c",
			init: 			cpuState{
				D:   [8]uint32{1534961349, 964112825, 457313485, 2298224863, 1099330700, 2237953377, 722554252, 378863416},
				A:   [7]uint32{1430943965, 1643618383, 240751567, 1539589467, 3336882068, 988136374, 2397710448},
				PC:  8271610,
				SR:  8714,
				USP: 12617496,
				SSP: 4137434,
				RAM: [][2]uint32{{8271606, 137}, {8271607, 28}, {8271608, 159}, {8271609, 117}, {14993300, 109}, {14993301, 197}, {8271610, 169}, {8271611, 16}},
			},
			want: 			cpuState{
				D:   [8]uint32{1534961349, 964112825, 457313485, 2298224863, 1099330700, 2237953377, 722554252, 378863416},
				A:   [7]uint32{1430943965, 1643618383, 240751567, 1539589467, 3336882069, 988136374, 2397710448},
				PC:  8271612,
				SR:  8712,
				USP: 12617496,
				SSP: 4137434,
				RAM: [][2]uint32{{8271606, 137}, {8271607, 28}, {8271608, 159}, {8271609, 117}, {14993300, 237}, {14993301, 197}, {8271610, 169}, {8271611, 16}},
				Cycles: 12,
			},
		},
		{
			name: "1107 OR.b #, -(A4) 0024",
			init: 			cpuState{
				D:   [8]uint32{3628885432, 4226833024, 4081366771, 1644718374, 4011114315, 3790625227, 3676187932, 1403010590},
				A:   [7]uint32{3324686301, 3616769759, 1902227372, 1237671052, 179216261, 3035785302, 3210463464},
				PC:  9287340,
				SR:  9999,
				USP: 8607802,
				SSP: 9424846,
				RAM: [][2]uint32{{9287336, 0}, {9287337, 36}, {9287338, 251}, {9287339, 125}, {9287340, 139}, {9287341, 25}, {11444100, 226}, {11444101, 242}, {9287342, 234}, {9287343, 77}},
			},
			want: 			cpuState{
				D:   [8]uint32{3628885432, 4226833024, 4081366771, 1644718374, 4011114315, 3790625227, 3676187932, 1403010590},
				A:   [7]uint32{3324686301, 3616769759, 1902227372, 1237671052, 179216260, 3035785302, 3210463464},
				PC:  9287344,
				SR:  9992,
				USP: 8607802,
				SSP: 9424846,
				RAM: [][2]uint32{{9287336, 0}, {9287337, 36}, {9287338, 251}, {9287339, 125}, {9287340, 139}, {9287341, 25}, {11444100, 255}, {11444101, 242}, {9287342, 234}, {9287343, 77}},
				Cycles: 18,
			},
		},
		{
			name: "1389 OR.b (xxx).l, D5 8a39",
			init: 			cpuState{
				D:   [8]uint32{116751203, 3587550999, 2368094808, 2161989409, 3407127464, 63909084, 3620149222, 96707978},
				A:   [7]uint32{4244113201, 3280477109, 590792290, 3315408683, 2262032185, 3262892707, 4200183944},
				PC:  4951256,
				SR:  8217,
				USP: 6710846,
				SSP: 8280962,
				RAM: [][2]uint32{{4951252, 138}, {4951253, 57}, {4951254, 10}, {4951255, 105}, {4951256, 121}, {4951257, 157}, {4951258, 190}, {4951259, 189}, {6912412, 10}, {6912413, 4}, {4951260, 246}, {4951261, 101}},
			},
			want: 			cpuState{
				D:   [8]uint32{116751203, 3587550999, 2368094808, 2161989409, 3407127464, 63909084, 3620149222, 96707978},
				A:   [7]uint32{4244113201, 3280477109, 590792290, 3315408683, 2262032185, 3262892707, 4200183944},
				PC:  4951262,
				SR:  8216,
				USP: 6710846,
				SSP: 8280962,
				RAM: [][2]uint32{{4951252, 138}, {4951253, 57}, {4951254, 10}, {4951255, 105}, {4951256, 121}, {4951257, 157}, {4951258, 190}, {4951259, 189}, {6912412, 10}, {6912413, 4}, {4951260, 246}, {4951261, 101}},
				Cycles: 16,
			},
		},
		{
			name: "1663 OR.b -(A0), D2 8420",
			init: 			cpuState{
				D:   [8]uint32{834401252, 3321593230, 1249478005, 1002445485, 3623286490, 205507951, 2876701169, 508536543},
				A:   [7]uint32{1288215236, 266621063, 3848299125, 1949468416, 3700887516, 2918856286, 295443118},
				PC:  4013156,
				SR:  1822,
				USP: 12113366,
				SSP: 1995098,
				RAM: [][2]uint32{{4013152, 132}, {4013153, 32}, {4013154, 104}, {4013155, 104}, {13146818, 81}, {13146819, 123}, {4013156, 220}, {4013157, 215}},
			},
			want: 			cpuState{
				D:   [8]uint32{834401252, 3321593230, 1249478015, 1002445485, 3623286490, 205507951, 2876701169, 508536543},
				A:   [7]uint32{1288215235, 266621063, 3848299125, 1949468416, 3700887516, 2918856286, 295443118},
				PC:  4013158,
				SR:  1808,
				USP: 12113366,
				SSP: 1995098,
				RAM: [][2]uint32{{4013152, 132}, {4013153, 32}, {4013154, 104}, {4013155, 104}, {13146818, 81}, {13146819, 123}, {4013156, 220}, {4013157, 215}},
				Cycles: 10,
			},
		},
		{
			name: "1968 OR.b D7, (A7)+ 8f1f",
			init: 			cpuState{
				D:   [8]uint32{434332001, 1570530439, 44301605, 1675493519, 26909114, 1852370224, 2369215778, 1364589250},
				A:   [7]uint32{83362478, 2263056949, 4065527375, 3049742769, 1084685382, 282488260, 1385713135},
				PC:  16773576,
				SR:  31,
				USP: 4177762,
				SSP: 4235656,
				RAM: [][2]uint32{{16773572, 143}, {16773573, 31}, {16773574, 142}, {16773575, 111}, {4177762, 128}, {4177763, 123}, {16773576, 194}, {16773577, 3}},
			},
			want: 			cpuState{
				D:   [8]uint32{434332001, 1570530439, 44301605, 1675493519, 26909114, 1852370224, 2369215778, 1364589250},
				A:   [7]uint32{83362478, 2263056949, 4065527375, 3049742769, 1084685382, 282488260, 1385713135},
				PC:  16773578,
				SR:  24,
				USP: 4177764,
				SSP: 4235656,
				RAM: [][2]uint32{{16773572, 143}, {16773573, 31}, {16773574, 142}, {16773575, 111}, {4177762, 194}, {4177763, 123}, {16773576, 194}, {16773577, 3}},
				Cycles: 12,
			},
		},
		{
			name: "2237 OR.b D4, (A4) 8914",
			init: 			cpuState{
				D:   [8]uint32{1423361833, 1144411178, 335235972, 2401610109, 513679559, 85883966, 3257128261, 3926870228},
				A:   [7]uint32{1003786709, 215373759, 1546967761, 1674473543, 3488073275, 1509426177, 3028023382},
				PC:  1926732,
				SR:  8204,
				USP: 12588192,
				SSP: 2552438,
				RAM: [][2]uint32{{1926728, 137}, {1926729, 20}, {1926730, 144}, {1926731, 199}, {15189562, 248}, {15189563, 58}, {1926732, 89}, {1926733, 84}},
			},
			want: 			cpuState{
				D:   [8]uint32{1423361833, 1144411178, 335235972, 2401610109, 513679559, 85883966, 3257128261, 3926870228},
				A:   [7]uint32{1003786709, 215373759, 1546967761, 1674473543, 3488073275, 1509426177, 3028023382},
				PC:  1926734,
				SR:  8200,
				USP: 12588192,
				SSP: 2552438,
				RAM: [][2]uint32{{1926728, 137}, {1926729, 20}, {1926730, 144}, {1926731, 199}, {15189562, 248}, {15189563, 255}, {1926732, 89}, {1926733, 84}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestOR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 OR.w -(A4), D0 8064",
			init: cpuState{
				D:   [8]uint32{3915457295, 1721067667, 2626242074, 2408546718, 3384892705, 3381734479, 2468666473, 2881617210},
				A:   [7]uint32{1130281266, 2303216642, 1783045862, 437447299, 1203664122, 430460605, 47693689},
				PC:  10243544,
				SR:  42268,
				USP: 2483622,
				SSP: 16328982,
				RAM: [][2]uint32{{10243540, 128}, {10243541, 100}, {10243542, 116}, {10243543, 155}, {12481784, 205}, {12481785, 22}, {10243544, 117}, {10243545, 37}},
			},
			want: cpuState{
				D:   [8]uint32{3915509535, 1721067667, 2626242074, 2408546718, 3384892705, 3381734479, 2468666473, 2881617210},
				A:   [7]uint32{1130281266, 2303216642, 1783045862, 437447299, 1203664120, 430460605, 47693689},
				PC:  10243546,
				SR:  42264,
				USP: 2483622,
				SSP: 16328982,
				RAM: [][2]uint32{{10243540, 128}, {10243541, 100}, {10243542, 116}, {10243543, 155}, {12481784, 205}, {12481785, 22}, {10243544, 117}, {10243545, 37}},
				Cycles: 10,
			},
		},
		{
			name: "500 OR.w D2, (A7)+ 855f",
			init: cpuState{
				D:   [8]uint32{321577514, 2239320060, 754847473, 2492794913, 593799045, 1312791170, 3583763312, 3872158869},
				A:   [7]uint32{2800405726, 4172282214, 4239655050, 2524440140, 1667682329, 218138763, 2043475047},
				PC:  16650616,
				SR:  2,
				USP: 830784,
				SSP: 12842360,
				RAM: [][2]uint32{{16650612, 133}, {16650613, 95}, {16650614, 60}, {16650615, 210}, {830784, 164}, {830785, 150}, {16650616, 247}, {16650617, 254}},
			},
			want: cpuState{
				D:   [8]uint32{321577514, 2239320060, 754847473, 2492794913, 593799045, 1312791170, 3583763312, 3872158869},
				A:   [7]uint32{2800405726, 4172282214, 4239655050, 2524440140, 1667682329, 218138763, 2043475047},
				PC:  16650618,
				SR:  8,
				USP: 830786,
				SSP: 12842360,
				RAM: [][2]uint32{{16650612, 133}, {16650613, 95}, {16650614, 60}, {16650615, 210}, {830784, 174}, {830785, 247}, {16650616, 247}, {16650617, 254}},
				Cycles: 12,
			},
		},
		{
			name: "1000 OR.w (A2)+, D5 8a5a",
			init: cpuState{
				D:   [8]uint32{83734341, 1934129117, 2831606052, 591412242, 171901009, 2136296524, 3593942737, 560009553},
				A:   [7]uint32{3100644133, 4154625645, 2792823997, 3464296240, 1692682072, 3386279769, 1817036328},
				PC:  10075266,
				SR:  33557,
				USP: 11890692,
				SSP: 10641134,
				RAM: [][2]uint32{{10075262, 138}, {10075263, 90}, {10075264, 152}, {10075265, 65}, {12, 220}, {13, 88}, {14, 3}, {15, 188}, {5768124, 190}, {5768125, 40}, {5768126, 102}, {5768127, 168}},
			},
			want: cpuState{
				D:      [8]uint32{83734341, 1934129117, 2831606052, 591412242, 171901009, 2136296524, 3593942737, 560009553},
				A:      [7]uint32{3100644133, 4154625645, 2792823999, 3464296240, 1692682072, 3386279769, 1817036328},
				PC:     3696755648,
				SR:     8981,
				USP:    11890692,
				SSP:    10641120,
				RAM:    [][2]uint32{{10075262, 138}, {10075263, 90}, {10075264, 152}, {10075265, 65}, {10641132, 188}, {10641133, 128}, {10641128, 131}, {10641129, 21}, {10641130, 0}, {10641131, 153}, {10641126, 138}, {10641127, 90}, {10641124, 28}, {10641125, 189}, {10641120, 138}, {10641121, 81}, {10641122, 166}, {10641123, 119}, {12, 220}, {13, 88}, {14, 3}, {15, 188}, {5768124, 190}, {5768125, 40}, {5768126, 102}, {5768127, 168}},
				Halted: true,
			},
		},
		{
			name: "1500 OR.w (A0), D0 8050",
			init: cpuState{
				D:   [8]uint32{4146066535, 3236021954, 3043732966, 960678392, 181286597, 3377134363, 1335806840, 1668827300},
				A:   [7]uint32{1065728912, 2638828595, 747302996, 3416806805, 1259311796, 247224203, 3355967552},
				PC:  3847342,
				SR:  1819,
				USP: 10434968,
				SSP: 594882,
				RAM: [][2]uint32{{3847338, 128}, {3847339, 80}, {3847340, 245}, {3847341, 95}, {8764304, 31}, {8764305, 109}, {3847342, 135}, {3847343, 123}},
			},
			want: cpuState{
				D:   [8]uint32{4146069359, 3236021954, 3043732966, 960678392, 181286597, 3377134363, 1335806840, 1668827300},
				A:   [7]uint32{1065728912, 2638828595, 747302996, 3416806805, 1259311796, 247224203, 3355967552},
				PC:  3847344,
				SR:  1816,
				USP: 10434968,
				SSP: 594882,
				RAM: [][2]uint32{{3847338, 128}, {3847339, 80}, {3847340, 245}, {3847341, 95}, {8764304, 31}, {8764305, 109}, {3847342, 135}, {3847343, 123}},
				Cycles: 8,
			},
		},
		{
			name: "2000 OR.w -(A3), D2 8463",
			init: cpuState{
				D:   [8]uint32{1106116852, 2212416777, 2223062022, 2248171998, 3659442629, 432504354, 2282524369, 1180174114},
				A:   [7]uint32{817052675, 1326552185, 141388016, 2036882750, 1175768030, 3772885538, 3622480399},
				PC:  11385664,
				SR:  41749,
				USP: 7648,
				SSP: 15289572,
				RAM: [][2]uint32{{11385660, 132}, {11385661, 99}, {11385662, 248}, {11385663, 40}, {6839612, 179}, {6839613, 197}, {11385664, 66}, {11385665, 161}},
			},
			want: cpuState{
				D:   [8]uint32{1106116852, 2212416777, 2223095751, 2248171998, 3659442629, 432504354, 2282524369, 1180174114},
				A:   [7]uint32{817052675, 1326552185, 141388016, 2036882748, 1175768030, 3772885538, 3622480399},
				PC:  11385666,
				SR:  41752,
				USP: 7648,
				SSP: 15289572,
				RAM: [][2]uint32{{11385660, 132}, {11385661, 99}, {11385662, 248}, {11385663, 40}, {6839612, 179}, {6839613, 197}, {11385664, 66}, {11385665, 161}},
				Cycles: 10,
			},
		},
		{
			name: "001 OR.w (d8, PC, Xn), D0 807b",
			init: 			cpuState{
				D:   [8]uint32{3940925936, 2208388606, 57030874, 1908169660, 3424655698, 10064849, 2456173713, 12135725},
				A:   [7]uint32{1243038749, 2511077995, 2071446114, 3680151086, 2362543261, 3552029788, 1884627767},
				PC:  11800510,
				SR:  1800,
				USP: 6756284,
				SSP: 13245188,
				RAM: [][2]uint32{{11800506, 128}, {11800507, 123}, {11800508, 245}, {11800509, 102}, {11800510, 232}, {11800511, 47}, {11806686, 196}, {11806687, 194}, {11800512, 95}, {11800513, 23}},
			},
			want: 			cpuState{
				D:   [8]uint32{3940926962, 2208388606, 57030874, 1908169660, 3424655698, 10064849, 2456173713, 12135725},
				A:   [7]uint32{1243038749, 2511077995, 2071446114, 3680151086, 2362543261, 3552029788, 1884627767},
				PC:  11800514,
				SR:  1800,
				USP: 6756284,
				SSP: 13245188,
				RAM: [][2]uint32{{11800506, 128}, {11800507, 123}, {11800508, 245}, {11800509, 102}, {11800510, 232}, {11800511, 47}, {11806686, 196}, {11806687, 194}, {11800512, 95}, {11800513, 23}},
				Cycles: 14,
			},
		},
		{
			name: "310 OR.w D5, (A2)+ 8b5a",
			init: 			cpuState{
				D:   [8]uint32{3261064617, 2514396916, 1034601912, 1792971908, 4248784651, 1959078879, 2302436362, 746418709},
				A:   [7]uint32{382069397, 3644314781, 1618441968, 3713054487, 868219114, 1589778785, 3494462469},
				PC:  4426438,
				SR:  9481,
				USP: 14382996,
				SSP: 3447518,
				RAM: [][2]uint32{{4426434, 139}, {4426435, 90}, {4426436, 226}, {4426437, 233}, {7829232, 157}, {7829233, 162}, {4426438, 98}, {4426439, 81}},
			},
			want: 			cpuState{
				D:   [8]uint32{3261064617, 2514396916, 1034601912, 1792971908, 4248784651, 1959078879, 2302436362, 746418709},
				A:   [7]uint32{382069397, 3644314781, 1618441970, 3713054487, 868219114, 1589778785, 3494462469},
				PC:  4426440,
				SR:  9480,
				USP: 14382996,
				SSP: 3447518,
				RAM: [][2]uint32{{4426434, 139}, {4426435, 90}, {4426436, 226}, {4426437, 233}, {7829232, 191}, {7829233, 255}, {4426438, 98}, {4426439, 81}},
				Cycles: 12,
			},
		},
		{
			name: "563 OR.w D3, -(A6) 8766",
			init: 			cpuState{
				D:   [8]uint32{1430678747, 1943849667, 2374924476, 3644512205, 3697504603, 315700060, 3516552933, 3956222229},
				A:   [7]uint32{2400169141, 22331001, 4094010006, 3391632920, 2180319645, 3270821586, 719330440},
				PC:  12791282,
				SR:  1550,
				USP: 5982192,
				SSP: 16247230,
				RAM: [][2]uint32{{12791278, 135}, {12791279, 102}, {12791280, 147}, {12791281, 248}, {14687366, 8}, {14687367, 219}, {12791282, 155}, {12791283, 166}},
			},
			want: 			cpuState{
				D:   [8]uint32{1430678747, 1943849667, 2374924476, 3644512205, 3697504603, 315700060, 3516552933, 3956222229},
				A:   [7]uint32{2400169141, 22331001, 4094010006, 3391632920, 2180319645, 3270821586, 719330438},
				PC:  12791284,
				SR:  1544,
				USP: 5982192,
				SSP: 16247230,
				RAM: [][2]uint32{{12791278, 135}, {12791279, 102}, {12791280, 147}, {12791281, 248}, {14687366, 223}, {14687367, 223}, {12791282, 155}, {12791283, 166}},
				Cycles: 14,
			},
		},
		{
			name: "841 OR.w D2, (A7) 8557",
			init: 			cpuState{
				D:   [8]uint32{37402029, 114843058, 2567632984, 366625555, 1103433938, 3157300760, 3945683307, 1968057073},
				A:   [7]uint32{957146687, 3355223832, 3671161225, 4254578550, 1303121660, 2049123376, 2143714655},
				PC:  15557640,
				SR:  8962,
				USP: 9460730,
				SSP: 10355138,
				RAM: [][2]uint32{{15557636, 133}, {15557637, 87}, {15557638, 32}, {15557639, 11}, {10355138, 197}, {10355139, 90}, {15557640, 71}, {15557641, 178}},
			},
			want: 			cpuState{
				D:   [8]uint32{37402029, 114843058, 2567632984, 366625555, 1103433938, 3157300760, 3945683307, 1968057073},
				A:   [7]uint32{957146687, 3355223832, 3671161225, 4254578550, 1303121660, 2049123376, 2143714655},
				PC:  15557642,
				SR:  8968,
				USP: 9460730,
				SSP: 10355138,
				RAM: [][2]uint32{{15557636, 133}, {15557637, 87}, {15557638, 32}, {15557639, 11}, {10355138, 253}, {10355139, 90}, {15557640, 71}, {15557641, 178}},
				Cycles: 12,
			},
		},
		{
			name: "1080 OR.w D4, D0 8044",
			init: 			cpuState{
				D:   [8]uint32{1989271750, 3764082937, 299934174, 668990200, 636569144, 1368743672, 604724510, 3155742576},
				A:   [7]uint32{311708545, 958404605, 1794751575, 1454153552, 176737364, 3596776349, 526877412},
				PC:  1465730,
				SR:  1028,
				USP: 2823152,
				SSP: 2577960,
				RAM: [][2]uint32{{1465726, 128}, {1465727, 68}, {1465728, 196}, {1465729, 255}, {1465730, 112}, {1465731, 204}},
			},
			want: 			cpuState{
				D:   [8]uint32{1989273342, 3764082937, 299934174, 668990200, 636569144, 1368743672, 604724510, 3155742576},
				A:   [7]uint32{311708545, 958404605, 1794751575, 1454153552, 176737364, 3596776349, 526877412},
				PC:  1465732,
				SR:  1032,
				USP: 2823152,
				SSP: 2577960,
				RAM: [][2]uint32{{1465726, 128}, {1465727, 68}, {1465728, 196}, {1465729, 255}, {1465730, 112}, {1465731, 204}},
				Cycles: 4,
			},
		},
		{
			name: "1314 OR.w (A7), D7 8e57",
			init: 			cpuState{
				D:   [8]uint32{2933240609, 2247367173, 2203781799, 561519183, 792051143, 1070211159, 695185375, 522868123},
				A:   [7]uint32{3344229123, 1992005179, 3995668423, 1015162472, 2219904755, 4271767268, 1527672488},
				PC:  11536168,
				SR:  9746,
				USP: 10865592,
				SSP: 14902338,
				RAM: [][2]uint32{{11536164, 142}, {11536165, 87}, {11536166, 172}, {11536167, 112}, {14902338, 176}, {14902339, 49}, {11536168, 50}, {11536169, 5}},
			},
			want: 			cpuState{
				D:   [8]uint32{2933240609, 2247367173, 2203781799, 561519183, 792051143, 1070211159, 695185375, 522909115},
				A:   [7]uint32{3344229123, 1992005179, 3995668423, 1015162472, 2219904755, 4271767268, 1527672488},
				PC:  11536170,
				SR:  9752,
				USP: 10865592,
				SSP: 14902338,
				RAM: [][2]uint32{{11536164, 142}, {11536165, 87}, {11536166, 172}, {11536167, 112}, {14902338, 176}, {14902339, 49}, {11536168, 50}, {11536169, 5}},
				Cycles: 8,
			},
		},
		{
			name: "1614 OR.w (d16, A3), D4 886b",
			init: 			cpuState{
				D:   [8]uint32{371219022, 2905973750, 2758730801, 2226017890, 2934569417, 206424104, 1962949035, 1478993409},
				A:   [7]uint32{1976554726, 933183915, 3761206914, 2185522363, 1397917, 1492217948, 1897124741},
				PC:  3935992,
				SR:  518,
				USP: 9428228,
				SSP: 2075908,
				RAM: [][2]uint32{{3935988, 136}, {3935989, 107}, {3935990, 41}, {3935991, 177}, {3935992, 39}, {3935993, 23}, {4494956, 62}, {4494957, 172}, {3935994, 223}, {3935995, 80}},
			},
			want: 			cpuState{
				D:   [8]uint32{371219022, 2905973750, 2758730801, 2226017890, 2934570989, 206424104, 1962949035, 1478993409},
				A:   [7]uint32{1976554726, 933183915, 3761206914, 2185522363, 1397917, 1492217948, 1897124741},
				PC:  3935996,
				SR:  520,
				USP: 9428228,
				SSP: 2075908,
				RAM: [][2]uint32{{3935988, 136}, {3935989, 107}, {3935990, 41}, {3935991, 177}, {3935992, 39}, {3935993, 23}, {4494956, 62}, {4494957, 172}, {3935994, 223}, {3935995, 80}},
				Cycles: 12,
			},
		},
		{
			name: "1952 OR.w #, D2 847c",
			init: 			cpuState{
				D:   [8]uint32{85108791, 3770320469, 3906405614, 2622775590, 3970025029, 1576331583, 2289360941, 531174762},
				A:   [7]uint32{4284677717, 1339328591, 1687965756, 1231571356, 855973404, 767178904, 642779070},
				PC:  15370632,
				SR:  1033,
				USP: 1389942,
				SSP: 5580168,
				RAM: [][2]uint32{{15370628, 132}, {15370629, 124}, {15370630, 142}, {15370631, 218}, {15370632, 171}, {15370633, 228}, {15370634, 37}, {15370635, 125}},
			},
			want: 			cpuState{
				D:   [8]uint32{85108791, 3770320469, 3906440958, 2622775590, 3970025029, 1576331583, 2289360941, 531174762},
				A:   [7]uint32{4284677717, 1339328591, 1687965756, 1231571356, 855973404, 767178904, 642779070},
				PC:  15370636,
				SR:  1032,
				USP: 1389942,
				SSP: 5580168,
				RAM: [][2]uint32{{15370628, 132}, {15370629, 124}, {15370630, 142}, {15370631, 218}, {15370632, 171}, {15370633, 228}, {15370634, 37}, {15370635, 125}},
				Cycles: 8,
			},
		},
		{
			name: "2229 OR.w D1, (d8, A5, Xn) 8375",
			init: 			cpuState{
				D:   [8]uint32{1706188936, 4166988906, 278488204, 3717322163, 492614984, 2881471809, 2636802145, 4126971616},
				A:   [7]uint32{500503383, 129866130, 182490091, 1136912544, 1923830793, 2573132398, 715335166},
				PC:  9531538,
				SR:  542,
				USP: 3097628,
				SSP: 3677910,
				RAM: [][2]uint32{{9531534, 131}, {9531535, 117}, {9531536, 176}, {9531537, 108}, {9531538, 106}, {9531539, 228}, {6212474, 221}, {6212475, 245}, {9531540, 69}, {9531541, 117}},
			},
			want: 			cpuState{
				D:   [8]uint32{1706188936, 4166988906, 278488204, 3717322163, 492614984, 2881471809, 2636802145, 4126971616},
				A:   [7]uint32{500503383, 129866130, 182490091, 1136912544, 1923830793, 2573132398, 715335166},
				PC:  9531542,
				SR:  536,
				USP: 3097628,
				SSP: 3677910,
				RAM: [][2]uint32{{9531534, 131}, {9531535, 117}, {9531536, 176}, {9531537, 108}, {9531538, 106}, {9531539, 228}, {6212474, 253}, {6212475, 255}, {9531540, 69}, {9531541, 117}},
				Cycles: 18,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestOR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 OR.l D6, (d16, A1) 8da9",
			init: cpuState{
				D:   [8]uint32{1564502885, 522926018, 1277966409, 3131410043, 4105120248, 3545769245, 1918636838, 1061832603},
				A:   [7]uint32{2368253171, 1228958648, 1411119444, 2133901995, 1073622201, 855036054, 108252896},
				PC:  5802578,
				SR:  1818,
				USP: 12460134,
				SSP: 14092348,
				RAM: [][2]uint32{{5802574, 141}, {5802575, 169}, {5802576, 36}, {5802577, 76}, {5802578, 201}, {5802579, 150}, {4231172, 100}, {4231173, 66}, {4231174, 247}, {4231175, 101}, {5802580, 237}, {5802581, 111}},
			},
			want: cpuState{
				D:   [8]uint32{1564502885, 522926018, 1277966409, 3131410043, 4105120248, 3545769245, 1918636838, 1061832603},
				A:   [7]uint32{2368253171, 1228958648, 1411119444, 2133901995, 1073622201, 855036054, 108252896},
				PC:  5802582,
				SR:  1808,
				USP: 12460134,
				SSP: 14092348,
				RAM: [][2]uint32{{5802574, 141}, {5802575, 169}, {5802576, 36}, {5802577, 76}, {5802578, 201}, {5802579, 150}, {4231172, 118}, {4231173, 94}, {4231174, 247}, {4231175, 103}, {5802580, 237}, {5802581, 111}},
				Cycles: 24,
			},
		},
		{
			name: "500 OR.l D4, (A6) 8996",
			init: cpuState{
				D:   [8]uint32{2634106044, 3238176658, 4055786570, 1882697531, 516048875, 673187567, 1715496973, 944537433},
				A:   [7]uint32{3070822987, 3267290900, 2814168436, 2637748765, 486365393, 3149234560, 831387210},
				PC:  10706648,
				SR:  1049,
				USP: 9163868,
				SSP: 7306020,
				RAM: [][2]uint32{{10706644, 137}, {10706645, 150}, {10706646, 81}, {10706647, 5}, {9303626, 2}, {9303627, 249}, {9303628, 91}, {9303629, 229}, {10706648, 153}, {10706649, 109}},
			},
			want: cpuState{
				D:   [8]uint32{2634106044, 3238176658, 4055786570, 1882697531, 516048875, 673187567, 1715496973, 944537433},
				A:   [7]uint32{3070822987, 3267290900, 2814168436, 2637748765, 486365393, 3149234560, 831387210},
				PC:  10706650,
				SR:  1040,
				USP: 9163868,
				SSP: 7306020,
				RAM: [][2]uint32{{10706644, 137}, {10706645, 150}, {10706646, 81}, {10706647, 5}, {9303626, 30}, {9303627, 251}, {9303628, 95}, {9303629, 239}, {10706648, 153}, {10706649, 109}},
				Cycles: 20,
			},
		},
		{
			name: "1000 OR.l (A0), D6 8c90",
			init: cpuState{
				D:   [8]uint32{2559127952, 397569079, 2268734089, 2113032836, 128404139, 3061897520, 2066853033, 2588400843},
				A:   [7]uint32{3228252744, 3838330075, 2433278643, 2968991629, 2795966815, 1224384411, 388670456},
				PC:  13463296,
				SR:  40965,
				USP: 1879478,
				SSP: 3257934,
				RAM: [][2]uint32{{13463292, 140}, {13463293, 144}, {13463294, 238}, {13463295, 187}, {7027272, 156}, {7027273, 86}, {7027274, 230}, {7027275, 138}, {13463296, 86}, {13463297, 51}},
			},
			want: cpuState{
				D:   [8]uint32{2559127952, 397569079, 2268734089, 2113032836, 128404139, 3061897520, 4286049963, 2588400843},
				A:   [7]uint32{3228252744, 3838330075, 2433278643, 2968991629, 2795966815, 1224384411, 388670456},
				PC:  13463298,
				SR:  40968,
				USP: 1879478,
				SSP: 3257934,
				RAM: [][2]uint32{{13463292, 140}, {13463293, 144}, {13463294, 238}, {13463295, 187}, {7027272, 156}, {7027273, 86}, {7027274, 230}, {7027275, 138}, {13463296, 86}, {13463297, 51}},
				Cycles: 14,
			},
		},
		{
			name: "1500 OR.l (d8, A0, Xn), D6 8cb0",
			init: cpuState{
				D:   [8]uint32{428784209, 2224703451, 841549742, 66083813, 541563657, 3274052991, 2785596487, 2933910587},
				A:   [7]uint32{3328312238, 1355926436, 2565847930, 1528518985, 3930793393, 3270877970, 4235750307},
				PC:  15179218,
				SR:  33792,
				USP: 5467056,
				SSP: 11827978,
				RAM: [][2]uint32{{15179214, 140}, {15179215, 176}, {15179216, 38}, {15179217, 182}, {15179218, 196}, {15179219, 131}, {6425362, 86}, {6425363, 180}, {6425364, 180}, {6425365, 211}, {15179220, 59}, {15179221, 48}},
			},
			want: cpuState{
				D:   [8]uint32{428784209, 2224703451, 841549742, 66083813, 541563657, 3274052991, 4139578583, 2933910587},
				A:   [7]uint32{3328312238, 1355926436, 2565847930, 1528518985, 3930793393, 3270877970, 4235750307},
				PC:  15179222,
				SR:  33800,
				USP: 5467056,
				SSP: 11827978,
				RAM: [][2]uint32{{15179214, 140}, {15179215, 176}, {15179216, 38}, {15179217, 182}, {15179218, 196}, {15179219, 131}, {6425362, 86}, {6425363, 180}, {6425364, 180}, {6425365, 211}, {15179220, 59}, {15179221, 48}},
				Cycles: 20,
			},
		},
		{
			name: "2000 OR.l D2, -(A3) 85a3",
			init: cpuState{
				D:   [8]uint32{2287264723, 2698719875, 3393124438, 117069084, 3255219775, 3886171928, 1113168993, 1329161553},
				A:   [7]uint32{1780419681, 1762454791, 1479354099, 3868954621, 1062544871, 1130166040, 788444851},
				PC:  281200,
				SR:  1053,
				USP: 1894772,
				SSP: 2525694,
				RAM: [][2]uint32{{281196, 133}, {281197, 163}, {281198, 154}, {281199, 148}, {12, 141}, {13, 98}, {14, 110}, {15, 192}, {6450880, 130}, {6450881, 225}, {6450882, 176}, {6450883, 3}},
			},
			want: cpuState{
				D:      [8]uint32{2287264723, 2698719875, 3393124438, 117069084, 3255219775, 3886171928, 1113168993, 1329161553},
				A:      [7]uint32{1780419681, 1762454791, 1479354099, 3868954617, 1062544871, 1130166040, 788444851},
				PC:     2372038340,
				SR:     9245,
				USP:    1894772,
				SSP:    2525680,
				RAM:    [][2]uint32{{281196, 133}, {281197, 163}, {281198, 154}, {281199, 148}, {2525692, 74}, {2525693, 110}, {2525688, 4}, {2525689, 29}, {2525690, 0}, {2525691, 4}, {2525686, 133}, {2525687, 163}, {2525684, 143}, {2525685, 249}, {2525680, 133}, {2525681, 177}, {2525682, 230}, {2525683, 155}, {12, 141}, {13, 98}, {14, 110}, {15, 192}, {6450880, 130}, {6450881, 225}, {6450882, 176}, {6450883, 3}},
				Halted: true,
			},
		},
		{
			name: "002 OR.l D2, (d8, A4, Xn) 85b4",
			init: 			cpuState{
				D:   [8]uint32{3251327061, 3938313772, 2571104375, 213103821, 856858365, 1503693776, 1424048795, 2771199480},
				A:   [7]uint32{3992672884, 1723276654, 636687075, 3341993508, 2804341278, 2126958068, 664997563},
				PC:  762920,
				SR:  268,
				USP: 11423456,
				SSP: 4027442,
				RAM: [][2]uint32{{762916, 133}, {762917, 180}, {762918, 152}, {762919, 62}, {762920, 101}, {762921, 184}, {14546890, 201}, {14546891, 32}, {14546892, 75}, {14546893, 83}, {762922, 6}, {762923, 115}},
			},
			want: 			cpuState{
				D:   [8]uint32{3251327061, 3938313772, 2571104375, 213103821, 856858365, 1503693776, 1424048795, 2771199480},
				A:   [7]uint32{3992672884, 1723276654, 636687075, 3341993508, 2804341278, 2126958068, 664997563},
				PC:  762924,
				SR:  264,
				USP: 11423456,
				SSP: 4027442,
				RAM: [][2]uint32{{762916, 133}, {762917, 180}, {762918, 152}, {762919, 62}, {762920, 101}, {762921, 184}, {14546890, 217}, {14546891, 63}, {14546892, 251}, {14546893, 119}, {762922, 6}, {762923, 115}},
				Cycles: 26,
			},
		},
		{
			name: "285 OR.l (d8, PC, Xn), D3 86bb",
			init: 			cpuState{
				D:   [8]uint32{58079066, 3561461852, 1262006193, 64996891, 2903102621, 4092508373, 1108018086, 973074096},
				A:   [7]uint32{1255587598, 3450581493, 1166752287, 2437926458, 1109717996, 776212226, 3038235737},
				PC:  16253052,
				SR:  258,
				USP: 5161080,
				SSP: 3064448,
				RAM: [][2]uint32{{16253048, 134}, {16253049, 187}, {16253050, 207}, {16253051, 112}, {16253052, 91}, {16253053, 223}, {1897686, 226}, {1897687, 185}, {1897688, 30}, {1897689, 202}, {16253054, 195}, {16253055, 238}},
			},
			want: 			cpuState{
				D:   [8]uint32{58079066, 3561461852, 1262006193, 3825196763, 2903102621, 4092508373, 1108018086, 973074096},
				A:   [7]uint32{1255587598, 3450581493, 1166752287, 2437926458, 1109717996, 776212226, 3038235737},
				PC:  16253056,
				SR:  264,
				USP: 5161080,
				SSP: 3064448,
				RAM: [][2]uint32{{16253048, 134}, {16253049, 187}, {16253050, 207}, {16253051, 112}, {16253052, 91}, {16253053, 223}, {1897686, 226}, {1897687, 185}, {1897688, 30}, {1897689, 202}, {16253054, 195}, {16253055, 238}},
				Cycles: 20,
			},
		},
		{
			name: "612 OR.l D4, (A7) 8997",
			init: 			cpuState{
				D:   [8]uint32{918173782, 866912436, 3248473299, 2862856184, 2032900660, 3678584498, 2162051663, 3512522638},
				A:   [7]uint32{3020388235, 267283532, 3862495048, 2753704426, 1450675308, 4018298086, 3239554180},
				PC:  172948,
				SR:  1053,
				USP: 1930442,
				SSP: 1741834,
				RAM: [][2]uint32{{172944, 137}, {172945, 151}, {172946, 234}, {172947, 186}, {1930442, 159}, {1930443, 181}, {1930444, 222}, {1930445, 211}, {172948, 179}, {172949, 61}},
			},
			want: 			cpuState{
				D:   [8]uint32{918173782, 866912436, 3248473299, 2862856184, 2032900660, 3678584498, 2162051663, 3512522638},
				A:   [7]uint32{3020388235, 267283532, 3862495048, 2753704426, 1450675308, 4018298086, 3239554180},
				PC:  172950,
				SR:  1048,
				USP: 1930442,
				SSP: 1741834,
				RAM: [][2]uint32{{172944, 137}, {172945, 151}, {172946, 234}, {172947, 186}, {1930442, 255}, {1930443, 191}, {1930444, 222}, {1930445, 247}, {172948, 179}, {172949, 61}},
				Cycles: 20,
			},
		},
		{
			name: "878 OR.l D1, D4 8881",
			init: 			cpuState{
				D:   [8]uint32{1393042561, 1500478806, 4202919615, 2042613341, 2386875949, 3408618130, 2614823629, 4070064073},
				A:   [7]uint32{3165826134, 3789900814, 2039942865, 3036358523, 3525916573, 2969348061, 3676673889},
				PC:  2003242,
				SR:  8730,
				USP: 11435032,
				SSP: 5093894,
				RAM: [][2]uint32{{2003238, 136}, {2003239, 129}, {2003240, 34}, {2003241, 37}, {2003242, 10}, {2003243, 13}},
			},
			want: 			cpuState{
				D:   [8]uint32{1393042561, 1500478806, 4202919615, 2042613341, 3748659071, 3408618130, 2614823629, 4070064073},
				A:   [7]uint32{3165826134, 3789900814, 2039942865, 3036358523, 3525916573, 2969348061, 3676673889},
				PC:  2003244,
				SR:  8728,
				USP: 11435032,
				SSP: 5093894,
				RAM: [][2]uint32{{2003238, 136}, {2003239, 129}, {2003240, 34}, {2003241, 37}, {2003242, 10}, {2003243, 13}},
				Cycles: 8,
			},
		},
		{
			name: "1137 OR.l (d8, A6, Xn), D3 86b6",
			init: 			cpuState{
				D:   [8]uint32{3533585029, 2562782350, 2903999769, 3831363683, 3783718634, 2721393408, 3951938886, 4118205376},
				A:   [7]uint32{478114942, 2061461736, 1084316884, 1948258769, 864861634, 588136444, 797733525},
				PC:  15166614,
				SR:  9219,
				USP: 13869000,
				SSP: 12880342,
				RAM: [][2]uint32{{15166610, 134}, {15166611, 182}, {15166612, 172}, {15166613, 247}, {15166614, 44}, {15166615, 101}, {3002208, 116}, {3002209, 233}, {3002210, 82}, {3002211, 89}, {15166616, 172}, {15166617, 225}},
			},
			want: 			cpuState{
				D:   [8]uint32{3533585029, 2562782350, 2903999769, 4110285435, 3783718634, 2721393408, 3951938886, 4118205376},
				A:   [7]uint32{478114942, 2061461736, 1084316884, 1948258769, 864861634, 588136444, 797733525},
				PC:  15166618,
				SR:  9224,
				USP: 13869000,
				SSP: 12880342,
				RAM: [][2]uint32{{15166610, 134}, {15166611, 182}, {15166612, 172}, {15166613, 247}, {15166614, 44}, {15166615, 101}, {3002208, 116}, {3002209, 233}, {3002210, 82}, {3002211, 89}, {15166616, 172}, {15166617, 225}},
				Cycles: 20,
			},
		},
		{
			name: "1370 OR.l -(A0), D1 82a0",
			init: 			cpuState{
				D:   [8]uint32{622072449, 2620049299, 168227926, 76174885, 1300917, 3388586061, 2761220987, 3216495580},
				A:   [7]uint32{2095839920, 784100142, 3274382982, 1747026448, 1638675478, 26076688, 3209484889},
				PC:  10566794,
				SR:  287,
				USP: 15771382,
				SSP: 13108204,
				RAM: [][2]uint32{{10566790, 130}, {10566791, 160}, {10566792, 92}, {10566793, 62}, {15465132, 248}, {15465133, 94}, {15465134, 168}, {15465135, 152}, {10566794, 15}, {10566795, 186}},
			},
			want: 			cpuState{
				D:   [8]uint32{622072449, 4236177307, 168227926, 76174885, 1300917, 3388586061, 2761220987, 3216495580},
				A:   [7]uint32{2095839916, 784100142, 3274382982, 1747026448, 1638675478, 26076688, 3209484889},
				PC:  10566796,
				SR:  280,
				USP: 15771382,
				SSP: 13108204,
				RAM: [][2]uint32{{10566790, 130}, {10566791, 160}, {10566792, 92}, {10566793, 62}, {15465132, 248}, {15465133, 94}, {15465134, 168}, {15465135, 152}, {10566794, 15}, {10566795, 186}},
				Cycles: 16,
			},
		},
		{
			name: "1625 OR.l #, D7 8ebc",
			init: 			cpuState{
				D:   [8]uint32{2854531393, 2860947305, 3745878418, 465016058, 896733141, 526149594, 3070528534, 3344550607},
				A:   [7]uint32{2549341702, 2210475999, 286173141, 691754470, 1677506491, 2392243833, 1930368480},
				PC:  47022,
				SR:  27,
				USP: 12239408,
				SSP: 14671038,
				RAM: [][2]uint32{{47018, 142}, {47019, 188}, {47020, 28}, {47021, 98}, {47022, 120}, {47023, 97}, {47024, 22}, {47025, 78}, {47026, 21}, {47027, 224}},
			},
			want: 			cpuState{
				D:   [8]uint32{2854531393, 2860947305, 3745878418, 465016058, 896733141, 526149594, 3070528534, 3749444335},
				A:   [7]uint32{2549341702, 2210475999, 286173141, 691754470, 1677506491, 2392243833, 1930368480},
				PC:  47028,
				SR:  24,
				USP: 12239408,
				SSP: 14671038,
				RAM: [][2]uint32{{47018, 142}, {47019, 188}, {47020, 28}, {47021, 98}, {47022, 120}, {47023, 97}, {47024, 22}, {47025, 78}, {47026, 21}, {47027, 224}},
				Cycles: 16,
			},
		},
		{
			name: "1916 OR.l D7, D5 8a87",
			init: 			cpuState{
				D:   [8]uint32{1548477, 1745664486, 3587350718, 3001053868, 1640630566, 3000101430, 148739810, 3233836513},
				A:   [7]uint32{2101089151, 3421176249, 2975604184, 1009268265, 1012105976, 2332614310, 1455717629},
				PC:  4438784,
				SR:  1545,
				USP: 11930194,
				SSP: 2704630,
				RAM: [][2]uint32{{4438780, 138}, {4438781, 135}, {4438782, 54}, {4438783, 129}, {4438784, 21}, {4438785, 241}},
			},
			want: 			cpuState{
				D:   [8]uint32{1548477, 1745664486, 3587350718, 3001053868, 1640630566, 4073844727, 148739810, 3233836513},
				A:   [7]uint32{2101089151, 3421176249, 2975604184, 1009268265, 1012105976, 2332614310, 1455717629},
				PC:  4438786,
				SR:  1544,
				USP: 11930194,
				SSP: 2704630,
				RAM: [][2]uint32{{4438780, 138}, {4438781, 135}, {4438782, 54}, {4438783, 129}, {4438784, 21}, {4438785, 241}},
				Cycles: 8,
			},
		},
		{
			name: "2196 OR.l #, (A7)+ 009f",
			init: 			cpuState{
				D:   [8]uint32{1896344827, 3591200636, 520164217, 1314898417, 3852052215, 755627984, 3054836509, 417152418},
				A:   [7]uint32{2823022990, 3382060476, 2827628951, 1515346528, 1594000996, 2285171441, 2992573132},
				PC:  12059516,
				SR:  516,
				USP: 13082634,
				SSP: 12907528,
				RAM: [][2]uint32{{12059512, 0}, {12059513, 159}, {12059514, 2}, {12059515, 48}, {12059516, 52}, {12059517, 153}, {12059518, 194}, {12059519, 3}, {13082634, 41}, {13082635, 214}, {13082636, 115}, {13082637, 174}, {12059520, 101}, {12059521, 253}},
			},
			want: 			cpuState{
				D:   [8]uint32{1896344827, 3591200636, 520164217, 1314898417, 3852052215, 755627984, 3054836509, 417152418},
				A:   [7]uint32{2823022990, 3382060476, 2827628951, 1515346528, 1594000996, 2285171441, 2992573132},
				PC:  12059522,
				SR:  512,
				USP: 13082638,
				SSP: 12907528,
				RAM: [][2]uint32{{12059512, 0}, {12059513, 159}, {12059514, 2}, {12059515, 48}, {12059516, 52}, {12059517, 153}, {12059518, 194}, {12059519, 3}, {13082634, 43}, {13082635, 246}, {13082636, 119}, {13082637, 191}, {12059520, 101}, {12059521, 253}},
				Cycles: 28,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEOR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EOR.b D1, (d8, A0, Xn) b330",
			init: cpuState{
				D:   [8]uint32{322243750, 2165232778, 2100007715, 4237342435, 2572068118, 2875607722, 1503358159, 3668045673},
				A:   [7]uint32{295339817, 68187332, 509124303, 2875758993, 4210229374, 3978168128, 3190833285},
				PC:  14813566,
				SR:  33034,
				USP: 14749924,
				SSP: 8164118,
				RAM: [][2]uint32{{14813562, 179}, {14813563, 48}, {14813564, 162}, {14813565, 89}, {14813566, 105}, {14813567, 67}, {10102352, 41}, {10102353, 241}, {14813568, 167}, {14813569, 23}},
			},
			want: cpuState{
				D:   [8]uint32{322243750, 2165232778, 2100007715, 4237342435, 2572068118, 2875607722, 1503358159, 3668045673},
				A:   [7]uint32{295339817, 68187332, 509124303, 2875758993, 4210229374, 3978168128, 3190833285},
				PC:  14813570,
				SR:  33024,
				USP: 14749924,
				SSP: 8164118,
				RAM: [][2]uint32{{14813562, 179}, {14813563, 48}, {14813564, 162}, {14813565, 89}, {14813566, 105}, {14813567, 67}, {10102352, 41}, {10102353, 123}, {14813568, 167}, {14813569, 23}},
				Cycles: 18,
			},
		},
		{
			name: "500 EOR.b D1, -(A6) b326",
			init: cpuState{
				D:   [8]uint32{3689008217, 4241317280, 1793249237, 1744674556, 3559945183, 3763629746, 1567338833, 2623165809},
				A:   [7]uint32{2412182805, 4029234144, 1064661884, 3466627907, 2547062843, 3211700370, 286988422},
				PC:  10882548,
				SR:  10011,
				USP: 12534606,
				SSP: 4680362,
				RAM: [][2]uint32{{10882544, 179}, {10882545, 38}, {10882546, 140}, {10882547, 2}, {1775748, 103}, {1775749, 80}, {10882548, 230}, {10882549, 94}},
			},
			want: cpuState{
				D:   [8]uint32{3689008217, 4241317280, 1793249237, 1744674556, 3559945183, 3763629746, 1567338833, 2623165809},
				A:   [7]uint32{2412182805, 4029234144, 1064661884, 3466627907, 2547062843, 3211700370, 286988421},
				PC:  10882550,
				SR:  10008,
				USP: 12534606,
				SSP: 4680362,
				RAM: [][2]uint32{{10882544, 179}, {10882545, 38}, {10882546, 140}, {10882547, 2}, {1775748, 103}, {1775749, 240}, {10882548, 230}, {10882549, 94}},
				Cycles: 14,
			},
		},
		{
			name: "1000 EOR.b D5, (d8, A0, Xn) bb30",
			init: cpuState{
				D:   [8]uint32{2691012587, 4207882718, 2940771023, 591772051, 2351212467, 1031269893, 3984493838, 3913411197},
				A:   [7]uint32{2374530340, 460292557, 2445359654, 2679952575, 3703109387, 3532090278, 1960419250},
				PC:  477638,
				SR:  34050,
				USP: 10034140,
				SSP: 12768692,
				RAM: [][2]uint32{{477634, 187}, {477635, 48}, {477636, 108}, {477637, 167}, {477638, 32}, {477639, 169}, {459224, 189}, {459225, 98}, {477640, 137}, {477641, 63}},
			},
			want: cpuState{
				D:   [8]uint32{2691012587, 4207882718, 2940771023, 591772051, 2351212467, 1031269893, 3984493838, 3913411197},
				A:   [7]uint32{2374530340, 460292557, 2445359654, 2679952575, 3703109387, 3532090278, 1960419250},
				PC:  477642,
				SR:  34048,
				USP: 10034140,
				SSP: 12768692,
				RAM: [][2]uint32{{477634, 187}, {477635, 48}, {477636, 108}, {477637, 167}, {477638, 32}, {477639, 169}, {459224, 189}, {459225, 103}, {477640, 137}, {477641, 63}},
				Cycles: 18,
			},
		},
		{
			name: "1500 EOR.b D0, -(A4) b124",
			init: cpuState{
				D:   [8]uint32{1955633209, 3373003984, 1618176985, 1435083168, 2443017061, 2059381897, 610152313, 130079289},
				A:   [7]uint32{3435039532, 3329239339, 4036601606, 3684028338, 3129802781, 453160064, 1391627713},
				PC:  8323772,
				SR:  42498,
				USP: 7996678,
				SSP: 419740,
				RAM: [][2]uint32{{8323768, 177}, {8323769, 36}, {8323770, 124}, {8323771, 154}, {9240604, 109}, {9240605, 21}, {8323772, 244}, {8323773, 251}},
			},
			want: cpuState{
				D:   [8]uint32{1955633209, 3373003984, 1618176985, 1435083168, 2443017061, 2059381897, 610152313, 130079289},
				A:   [7]uint32{3435039532, 3329239339, 4036601606, 3684028338, 3129802780, 453160064, 1391627713},
				PC:  8323774,
				SR:  42496,
				USP: 7996678,
				SSP: 419740,
				RAM: [][2]uint32{{8323768, 177}, {8323769, 36}, {8323770, 124}, {8323771, 154}, {9240604, 84}, {9240605, 21}, {8323772, 244}, {8323773, 251}},
				Cycles: 14,
			},
		},
		{
			name: "2000 EOR.b #, (d16, A2) 0a2a",
			init: cpuState{
				D:   [8]uint32{869295349, 1349727603, 1179963511, 3572034944, 1598942221, 2502861199, 3054896122, 3565335401},
				A:   [7]uint32{2717661304, 3643204295, 3619196007, 2413028210, 4119000966, 1349532300, 3428324189},
				PC:  3462450,
				SR:  41743,
				USP: 176880,
				SSP: 16704212,
				RAM: [][2]uint32{{3462446, 10}, {3462447, 42}, {3462448, 32}, {3462449, 50}, {3462450, 154}, {3462451, 169}, {3462452, 176}, {3462453, 143}, {12068624, 83}, {12068625, 28}, {3462454, 29}, {3462455, 52}},
			},
			want: cpuState{
				D:   [8]uint32{869295349, 1349727603, 1179963511, 3572034944, 1598942221, 2502861199, 3054896122, 3565335401},
				A:   [7]uint32{2717661304, 3643204295, 3619196007, 2413028210, 4119000966, 1349532300, 3428324189},
				PC:  3462456,
				SR:  41728,
				USP: 176880,
				SSP: 16704212,
				RAM: [][2]uint32{{3462446, 10}, {3462447, 42}, {3462448, 32}, {3462449, 50}, {3462450, 154}, {3462451, 169}, {3462452, 176}, {3462453, 143}, {12068624, 97}, {12068625, 28}, {3462454, 29}, {3462455, 52}},
				Cycles: 20,
			},
		},
		{
			name: "001 EOR.b D1, (d8, A7, Xn) b337",
			init: 			cpuState{
				D:   [8]uint32{3791088911, 583872329, 3482425318, 2563402364, 3543892958, 28401104, 3301090054, 3740486941},
				A:   [7]uint32{3502638801, 1050867534, 184851443, 2819443447, 3484133620, 1017079068, 1040671575},
				PC:  3602236,
				SR:  1548,
				USP: 12324354,
				SSP: 9356438,
				RAM: [][2]uint32{{3602232, 179}, {3602233, 55}, {3602234, 254}, {3602235, 49}, {3602236, 55}, {3602237, 217}, {7871540, 227}, {7871541, 6}, {3602238, 1}, {3602239, 13}},
			},
			want: 			cpuState{
				D:   [8]uint32{3791088911, 583872329, 3482425318, 2563402364, 3543892958, 28401104, 3301090054, 3740486941},
				A:   [7]uint32{3502638801, 1050867534, 184851443, 2819443447, 3484133620, 1017079068, 1040671575},
				PC:  3602240,
				SR:  1536,
				USP: 12324354,
				SSP: 9356438,
				RAM: [][2]uint32{{3602232, 179}, {3602233, 55}, {3602234, 254}, {3602235, 49}, {3602236, 55}, {3602237, 217}, {7871540, 227}, {7871541, 79}, {3602238, 1}, {3602239, 13}},
				Cycles: 18,
			},
		},
		{
			name: "247 EOR.b D4, (A4) b914",
			init: 			cpuState{
				D:   [8]uint32{4159186696, 1006328019, 4083062838, 4128745767, 455783097, 1819497943, 3765797964, 790737018},
				A:   [7]uint32{111038514, 895254852, 2112034119, 331999196, 3708423362, 2469846609, 1577310439},
				PC:  16538708,
				SR:  1816,
				USP: 12667282,
				SSP: 932066,
				RAM: [][2]uint32{{16538704, 185}, {16538705, 20}, {16538706, 255}, {16538707, 238}, {658626, 56}, {658627, 219}, {16538708, 255}, {16538709, 174}},
			},
			want: 			cpuState{
				D:   [8]uint32{4159186696, 1006328019, 4083062838, 4128745767, 455783097, 1819497943, 3765797964, 790737018},
				A:   [7]uint32{111038514, 895254852, 2112034119, 331999196, 3708423362, 2469846609, 1577310439},
				PC:  16538710,
				SR:  1816,
				USP: 12667282,
				SSP: 932066,
				RAM: [][2]uint32{{16538704, 185}, {16538705, 20}, {16538706, 255}, {16538707, 238}, {658626, 129}, {658627, 219}, {16538708, 255}, {16538709, 174}},
				Cycles: 12,
			},
		},
		{
			name: "544 EOR.b D4, (d16, A3) b92b",
			init: 			cpuState{
				D:   [8]uint32{2219669892, 2408691139, 3784025222, 183186528, 930550766, 419131016, 1834650770, 2584007818},
				A:   [7]uint32{2041167624, 439179388, 1878129177, 3592373762, 2618667300, 2222429555, 3417699576},
				PC:  788252,
				SR:  9496,
				USP: 9337026,
				SSP: 12622290,
				RAM: [][2]uint32{{788248, 185}, {788249, 43}, {788250, 206}, {788251, 53}, {788252, 226}, {788253, 239}, {2036790, 178}, {2036791, 120}, {788254, 163}, {788255, 15}},
			},
			want: 			cpuState{
				D:   [8]uint32{2219669892, 2408691139, 3784025222, 183186528, 930550766, 419131016, 1834650770, 2584007818},
				A:   [7]uint32{2041167624, 439179388, 1878129177, 3592373762, 2618667300, 2222429555, 3417699576},
				PC:  788256,
				SR:  9496,
				USP: 9337026,
				SSP: 12622290,
				RAM: [][2]uint32{{788248, 185}, {788249, 43}, {788250, 206}, {788251, 53}, {788252, 226}, {788253, 239}, {2036790, 178}, {2036791, 150}, {788254, 163}, {788255, 15}},
				Cycles: 16,
			},
		},
		{
			name: "828 EOR.b D5, D5 bb05",
			init: 			cpuState{
				D:   [8]uint32{155887796, 4096562201, 3261147958, 814416489, 2551441707, 4208291734, 2783736639, 3649994091},
				A:   [7]uint32{1284263843, 2160720422, 3759868277, 2299537991, 1454838512, 1187686230, 3259122727},
				PC:  16087376,
				SR:  23,
				USP: 3174938,
				SSP: 8504320,
				RAM: [][2]uint32{{16087372, 187}, {16087373, 5}, {16087374, 36}, {16087375, 228}, {16087376, 20}, {16087377, 170}},
			},
			want: 			cpuState{
				D:   [8]uint32{155887796, 4096562201, 3261147958, 814416489, 2551441707, 4208291584, 2783736639, 3649994091},
				A:   [7]uint32{1284263843, 2160720422, 3759868277, 2299537991, 1454838512, 1187686230, 3259122727},
				PC:  16087378,
				SR:  20,
				USP: 3174938,
				SSP: 8504320,
				RAM: [][2]uint32{{16087372, 187}, {16087373, 5}, {16087374, 36}, {16087375, 228}, {16087376, 20}, {16087377, 170}},
				Cycles: 4,
			},
		},
		{
			name: "1105 EOR.b D5, (d16, A4) bb2c",
			init: 			cpuState{
				D:   [8]uint32{3723289730, 1500280202, 1320191639, 3911191054, 1767513429, 3461909175, 2162486655, 84959097},
				A:   [7]uint32{1999731512, 330017012, 1859578890, 2043990852, 2617906214, 1965200953, 813963536},
				PC:  4403402,
				SR:  264,
				USP: 10757272,
				SSP: 9739518,
				RAM: [][2]uint32{{4403398, 187}, {4403399, 44}, {4403400, 236}, {4403401, 168}, {4403402, 153}, {4403403, 119}, {655566, 215}, {655567, 48}, {4403404, 172}, {4403405, 35}},
			},
			want: 			cpuState{
				D:   [8]uint32{3723289730, 1500280202, 1320191639, 3911191054, 1767513429, 3461909175, 2162486655, 84959097},
				A:   [7]uint32{1999731512, 330017012, 1859578890, 2043990852, 2617906214, 1965200953, 813963536},
				PC:  4403406,
				SR:  256,
				USP: 10757272,
				SSP: 9739518,
				RAM: [][2]uint32{{4403398, 187}, {4403399, 44}, {4403400, 236}, {4403401, 168}, {4403402, 153}, {4403403, 119}, {655566, 96}, {655567, 48}, {4403404, 172}, {4403405, 35}},
				Cycles: 16,
			},
		},
		{
			name: "1354 EOR.b D5, (d16, A0) bb28",
			init: 			cpuState{
				D:   [8]uint32{2868567846, 309645012, 1327006825, 3231057141, 603071534, 3848009235, 3987549845, 2046566674},
				A:   [7]uint32{2092874699, 1491231624, 2427892981, 3894415809, 2055120596, 951603939, 2475623941},
				PC:  13065072,
				SR:  1309,
				USP: 10480938,
				SSP: 14516668,
				RAM: [][2]uint32{{13065068, 187}, {13065069, 40}, {13065070, 97}, {13065071, 26}, {13065072, 51}, {13065073, 17}, {12524772, 95}, {12524773, 99}, {13065074, 203}, {13065075, 27}},
			},
			want: 			cpuState{
				D:   [8]uint32{2868567846, 309645012, 1327006825, 3231057141, 603071534, 3848009235, 3987549845, 2046566674},
				A:   [7]uint32{2092874699, 1491231624, 2427892981, 3894415809, 2055120596, 951603939, 2475623941},
				PC:  13065076,
				SR:  1296,
				USP: 10480938,
				SSP: 14516668,
				RAM: [][2]uint32{{13065068, 187}, {13065069, 40}, {13065070, 97}, {13065071, 26}, {13065072, 51}, {13065073, 17}, {12524772, 95}, {12524773, 112}, {13065074, 203}, {13065075, 27}},
				Cycles: 16,
			},
		},
		{
			name: "1617 EOR.b D6, (d8, A6, Xn) bd36",
			init: 			cpuState{
				D:   [8]uint32{3589192985, 3493338467, 1387047422, 2555195956, 671598266, 155044910, 89954497, 3461390268},
				A:   [7]uint32{2688759173, 1077439760, 4289735070, 3315449228, 641701180, 1307030585, 1704081335},
				PC:  7889294,
				SR:  530,
				USP: 10332890,
				SSP: 9763286,
				RAM: [][2]uint32{{7889290, 189}, {7889291, 54}, {7889292, 48}, {7889293, 219}, {7889294, 50}, {7889295, 232}, {9595334, 55}, {9595335, 153}, {7889296, 203}, {7889297, 205}},
			},
			want: 			cpuState{
				D:   [8]uint32{3589192985, 3493338467, 1387047422, 2555195956, 671598266, 155044910, 89954497, 3461390268},
				A:   [7]uint32{2688759173, 1077439760, 4289735070, 3315449228, 641701180, 1307030585, 1704081335},
				PC:  7889298,
				SR:  536,
				USP: 10332890,
				SSP: 9763286,
				RAM: [][2]uint32{{7889290, 189}, {7889291, 54}, {7889292, 48}, {7889293, 219}, {7889294, 50}, {7889295, 232}, {9595334, 246}, {9595335, 153}, {7889296, 203}, {7889297, 205}},
				Cycles: 18,
			},
		},
		{
			name: "1954 EOR.b D2, (d16, A4) b52c",
			init: 			cpuState{
				D:   [8]uint32{4126721504, 2805480394, 1549240015, 2942582170, 1747012502, 728285130, 241572622, 1434963326},
				A:   [7]uint32{1739805216, 1056439540, 1483124934, 1067658198, 2204103651, 2741417008, 917253091},
				PC:  5399062,
				SR:  1055,
				USP: 10420824,
				SSP: 15395098,
				RAM: [][2]uint32{{5399058, 181}, {5399059, 44}, {5399060, 60}, {5399061, 65}, {5399062, 34}, {5399063, 188}, {6303780, 108}, {6303781, 171}, {5399064, 120}, {5399065, 164}},
			},
			want: 			cpuState{
				D:   [8]uint32{4126721504, 2805480394, 1549240015, 2942582170, 1747012502, 728285130, 241572622, 1434963326},
				A:   [7]uint32{1739805216, 1056439540, 1483124934, 1067658198, 2204103651, 2741417008, 917253091},
				PC:  5399066,
				SR:  1048,
				USP: 10420824,
				SSP: 15395098,
				RAM: [][2]uint32{{5399058, 181}, {5399059, 44}, {5399060, 60}, {5399061, 65}, {5399062, 34}, {5399063, 188}, {6303780, 163}, {6303781, 171}, {5399064, 120}, {5399065, 164}},
				Cycles: 16,
			},
		},
		{
			name: "2233 EOR.b D1, (A4) b314",
			init: 			cpuState{
				D:   [8]uint32{1434342211, 2432667172, 700705360, 1673136256, 1218343481, 1924272907, 3344179877, 1803732052},
				A:   [7]uint32{580355080, 2303821985, 131316628, 2573243541, 1561076830, 3818883396, 2820317572},
				PC:  15104640,
				SR:  1561,
				USP: 4201794,
				SSP: 13657666,
				RAM: [][2]uint32{{15104636, 179}, {15104637, 20}, {15104638, 174}, {15104639, 41}, {795742, 93}, {795743, 245}, {15104640, 189}, {15104641, 234}},
			},
			want: 			cpuState{
				D:   [8]uint32{1434342211, 2432667172, 700705360, 1673136256, 1218343481, 1924272907, 3344179877, 1803732052},
				A:   [7]uint32{580355080, 2303821985, 131316628, 2573243541, 1561076830, 3818883396, 2820317572},
				PC:  15104642,
				SR:  1552,
				USP: 4201794,
				SSP: 13657666,
				RAM: [][2]uint32{{15104636, 179}, {15104637, 20}, {15104638, 174}, {15104639, 41}, {795742, 121}, {795743, 245}, {15104640, 189}, {15104641, 234}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEOR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EOR.w D7, (d16, A7) bf6f",
			init: cpuState{
				D:   [8]uint32{3609744020, 3243748271, 831628684, 3294858570, 1071185854, 3478528025, 3099394745, 3061239256},
				A:   [7]uint32{3164450235, 93867188, 28156141, 1247932394, 2342496308, 3240447034, 180936924},
				PC:  4034242,
				SR:  525,
				USP: 2715370,
				SSP: 1668710,
				RAM: [][2]uint32{{4034238, 191}, {4034239, 111}, {4034240, 10}, {4034241, 171}, {4034242, 106}, {4034243, 196}, {12, 150}, {13, 124}, {14, 136}, {15, 226}, {8161506, 112}, {8161507, 225}, {8161508, 27}, {8161509, 185}},
			},
			want: cpuState{
				D:      [8]uint32{3609744020, 3243748271, 831628684, 3294858570, 1071185854, 3478528025, 3099394745, 3061239256},
				A:      [7]uint32{3164450235, 93867188, 28156141, 1247932394, 2342496308, 3240447034, 180936924},
				PC:     2524743910,
				SR:     8717,
				USP:    2715370,
				SSP:    1668696,
				RAM:    [][2]uint32{{4034238, 191}, {4034239, 111}, {4034240, 10}, {4034241, 171}, {4034242, 106}, {4034243, 196}, {1668708, 142}, {1668709, 192}, {1668704, 2}, {1668705, 13}, {1668706, 0}, {1668707, 61}, {1668702, 191}, {1668703, 111}, {1668700, 121}, {1668701, 149}, {1668696, 191}, {1668697, 113}, {1668698, 0}, {1668699, 41}, {12, 150}, {13, 124}, {14, 136}, {15, 226}, {8161506, 112}, {8161507, 225}, {8161508, 27}, {8161509, 185}},
				Halted: true,
			},
		},
		{
			name: "500 EOR.w D6, (A5)+ bd5d",
			init: cpuState{
				D:   [8]uint32{3253739069, 1016237945, 1899332519, 1322283532, 3923941416, 1952334611, 282346117, 2460766521},
				A:   [7]uint32{530895866, 3610253951, 2857707890, 3860346981, 1600845410, 1324270158, 728266933},
				PC:  16563834,
				SR:  34070,
				USP: 10744442,
				SSP: 13114000,
				RAM: [][2]uint32{{16563830, 189}, {16563831, 93}, {16563832, 161}, {16563833, 64}, {15647310, 3}, {15647311, 107}, {16563834, 117}, {16563835, 184}},
			},
			want: cpuState{
				D:   [8]uint32{3253739069, 1016237945, 1899332519, 1322283532, 3923941416, 1952334611, 282346117, 2460766521},
				A:   [7]uint32{530895866, 3610253951, 2857707890, 3860346981, 1600845410, 1324270160, 728266933},
				PC:  16563836,
				SR:  34064,
				USP: 10744442,
				SSP: 13114000,
				RAM: [][2]uint32{{16563830, 189}, {16563831, 93}, {16563832, 161}, {16563833, 64}, {15647310, 65}, {15647311, 238}, {16563834, 117}, {16563835, 184}},
				Cycles: 12,
			},
		},
		{
			name: "1000 EOR.w D3, (A1) b751",
			init: cpuState{
				D:   [8]uint32{3483076068, 522034624, 2413393896, 3837583993, 66594823, 2467453692, 3805897304, 3594019511},
				A:   [7]uint32{3880728526, 3336101260, 592565634, 2298699075, 2757430404, 3240065136, 192394142},
				PC:  3067180,
				SR:  8474,
				USP: 2586544,
				SSP: 16509648,
				RAM: [][2]uint32{{3067176, 183}, {3067177, 81}, {3067178, 224}, {3067179, 92}, {14212492, 118}, {14212493, 51}, {3067180, 61}, {3067181, 208}},
			},
			want: cpuState{
				D:   [8]uint32{3483076068, 522034624, 2413393896, 3837583993, 66594823, 2467453692, 3805897304, 3594019511},
				A:   [7]uint32{3880728526, 3336101260, 592565634, 2298699075, 2757430404, 3240065136, 192394142},
				PC:  3067182,
				SR:  8472,
				USP: 2586544,
				SSP: 16509648,
				RAM: [][2]uint32{{3067176, 183}, {3067177, 81}, {3067178, 224}, {3067179, 92}, {14212492, 148}, {14212493, 74}, {3067180, 61}, {3067181, 208}},
				Cycles: 12,
			},
		},
		{
			name: "1500 EOR.w D4, (d8, A0, Xn) b970",
			init: cpuState{
				D:   [8]uint32{3486670160, 2815118054, 4098693459, 3853517730, 1236613792, 2686835090, 2980720871, 2081804604},
				A:   [7]uint32{3382448150, 980317758, 2072580157, 2427303804, 4096808058, 2638282619, 1529531342},
				PC:  1570756,
				SR:  42517,
				USP: 13184758,
				SSP: 13930674,
				RAM: [][2]uint32{{1570752, 185}, {1570753, 112}, {1570754, 30}, {1570755, 170}, {1570756, 31}, {1570757, 112}, {6773414, 209}, {6773415, 154}, {1570758, 79}, {1570759, 241}},
			},
			want: cpuState{
				D:   [8]uint32{3486670160, 2815118054, 4098693459, 3853517730, 1236613792, 2686835090, 2980720871, 2081804604},
				A:   [7]uint32{3382448150, 980317758, 2072580157, 2427303804, 4096808058, 2638282619, 1529531342},
				PC:  1570760,
				SR:  42520,
				USP: 13184758,
				SSP: 13930674,
				RAM: [][2]uint32{{1570752, 185}, {1570753, 112}, {1570754, 30}, {1570755, 170}, {1570756, 31}, {1570757, 112}, {6773414, 235}, {6773415, 58}, {1570758, 79}, {1570759, 241}},
				Cycles: 18,
			},
		},
		{
			name: "2000 EOR.w D3, -(A4) b764",
			init: cpuState{
				D:   [8]uint32{1450344888, 3736443276, 1094624571, 679603623, 1955856304, 1424936195, 4289738525, 3526994095},
				A:   [7]uint32{2830495985, 554052876, 1678986477, 2456165572, 1845575815, 1298528518, 3483365963},
				PC:  6602226,
				SR:  32794,
				USP: 1715314,
				SSP: 7051804,
				RAM: [][2]uint32{{6602222, 183}, {6602223, 100}, {6602224, 52}, {6602225, 22}, {12, 49}, {13, 126}, {14, 129}, {15, 82}, {8290642, 141}, {8290643, 95}, {8290644, 229}, {8290645, 62}},
			},
			want: cpuState{
				D:      [8]uint32{1450344888, 3736443276, 1094624571, 679603623, 1955856304, 1424936195, 4289738525, 3526994095},
				A:      [7]uint32{2830495985, 554052876, 1678986477, 2456165572, 1845575813, 1298528518, 3483365963},
				PC:     830374230,
				SR:     8218,
				USP:    1715314,
				SSP:    7051790,
				RAM:    [][2]uint32{{6602222, 183}, {6602223, 100}, {6602224, 52}, {6602225, 22}, {7051802, 189}, {7051803, 242}, {7051798, 128}, {7051799, 26}, {7051800, 0}, {7051801, 100}, {7051796, 183}, {7051797, 100}, {7051794, 64}, {7051795, 133}, {7051790, 183}, {7051791, 113}, {7051792, 110}, {7051793, 1}, {12, 49}, {13, 126}, {14, 129}, {15, 82}, {8290642, 141}, {8290643, 95}, {8290644, 229}, {8290645, 62}},
				Halted: true,
			},
		},
		{
			name: "005 EOR.w D1, D5 b345",
			init: 			cpuState{
				D:   [8]uint32{4257401680, 1468524952, 3036191103, 179058678, 686185525, 285812573, 1944037133, 3574808147},
				A:   [7]uint32{4020626656, 4116450717, 949154631, 3068378292, 1723332333, 1941474069, 3594380001},
				PC:  10453696,
				SR:  1558,
				USP: 2942194,
				SSP: 10195026,
				RAM: [][2]uint32{{10453692, 179}, {10453693, 69}, {10453694, 61}, {10453695, 51}, {10453696, 161}, {10453697, 179}},
			},
			want: 			cpuState{
				D:   [8]uint32{4257401680, 1468524952, 3036191103, 179058678, 686185525, 285855429, 1944037133, 3574808147},
				A:   [7]uint32{4020626656, 4116450717, 949154631, 3068378292, 1723332333, 1941474069, 3594380001},
				PC:  10453698,
				SR:  1560,
				USP: 2942194,
				SSP: 10195026,
				RAM: [][2]uint32{{10453692, 179}, {10453693, 69}, {10453694, 61}, {10453695, 51}, {10453696, 161}, {10453697, 179}},
				Cycles: 4,
			},
		},
		{
			name: "267 EOR.w D4, -(A7) b967",
			init: 			cpuState{
				D:   [8]uint32{2758051525, 2691455963, 3477645206, 443333541, 1215875926, 2196374801, 1393946432, 4112110532},
				A:   [7]uint32{2921490222, 4013923014, 2238619169, 2233673932, 1116536797, 3342335522, 2257168437},
				PC:  4949830,
				SR:  8970,
				USP: 16718574,
				SSP: 16615924,
				RAM: [][2]uint32{{4949826, 185}, {4949827, 103}, {4949828, 143}, {4949829, 135}, {16615922, 63}, {16615923, 69}, {4949830, 25}, {4949831, 195}},
			},
			want: 			cpuState{
				D:   [8]uint32{2758051525, 2691455963, 3477645206, 443333541, 1215875926, 2196374801, 1393946432, 4112110532},
				A:   [7]uint32{2921490222, 4013923014, 2238619169, 2233673932, 1116536797, 3342335522, 2257168437},
				PC:  4949832,
				SR:  8968,
				USP: 16718574,
				SSP: 16615922,
				RAM: [][2]uint32{{4949826, 185}, {4949827, 103}, {4949828, 143}, {4949829, 135}, {16615922, 244}, {16615923, 19}, {4949830, 25}, {4949831, 195}},
				Cycles: 14,
			},
		},
		{
			name: "529 EOR.w D1, (d8, A5, Xn) b375",
			init: 			cpuState{
				D:   [8]uint32{2505989535, 2428868111, 1296880318, 285826639, 113276808, 1497190466, 2779292525, 2213807423},
				A:   [7]uint32{1550068415, 477217372, 2694020438, 2351517193, 3608708612, 989052187, 1988431454},
				PC:  14818122,
				SR:  30,
				USP: 14693762,
				SSP: 12987344,
				RAM: [][2]uint32{{14818118, 179}, {14818119, 117}, {14818120, 42}, {14818121, 69}, {14818122, 50}, {14818123, 244}, {4231198, 225}, {4231199, 201}, {14818124, 1}, {14818125, 186}},
			},
			want: 			cpuState{
				D:   [8]uint32{2505989535, 2428868111, 1296880318, 285826639, 113276808, 1497190466, 2779292525, 2213807423},
				A:   [7]uint32{1550068415, 477217372, 2694020438, 2351517193, 3608708612, 989052187, 1988431454},
				PC:  14818126,
				SR:  16,
				USP: 14693762,
				SSP: 12987344,
				RAM: [][2]uint32{{14818118, 179}, {14818119, 117}, {14818120, 42}, {14818121, 69}, {14818122, 50}, {14818123, 244}, {4231198, 119}, {4231199, 198}, {14818124, 1}, {14818125, 186}},
				Cycles: 18,
			},
		},
		{
			name: "842 EOR.w D7, (xxx).w bf78",
			init: 			cpuState{
				D:   [8]uint32{287225189, 2691832438, 1378154243, 1550314874, 1422153498, 2894787624, 1627411592, 2124622528},
				A:   [7]uint32{3827413518, 1780996043, 4101689100, 579188712, 1537842182, 3441851107, 1861550037},
				PC:  13717430,
				SR:  1043,
				USP: 7294018,
				SSP: 15438672,
				RAM: [][2]uint32{{13717426, 191}, {13717427, 120}, {13717428, 194}, {13717429, 122}, {13717430, 84}, {13717431, 173}, {16761466, 122}, {16761467, 220}, {13717432, 133}, {13717433, 246}},
			},
			want: 			cpuState{
				D:   [8]uint32{287225189, 2691832438, 1378154243, 1550314874, 1422153498, 2894787624, 1627411592, 2124622528},
				A:   [7]uint32{3827413518, 1780996043, 4101689100, 579188712, 1537842182, 3441851107, 1861550037},
				PC:  13717434,
				SR:  1040,
				USP: 7294018,
				SSP: 15438672,
				RAM: [][2]uint32{{13717426, 191}, {13717427, 120}, {13717428, 194}, {13717429, 122}, {13717430, 84}, {13717431, 173}, {16761466, 80}, {16761467, 28}, {13717432, 133}, {13717433, 246}},
				Cycles: 16,
			},
		},
		{
			name: "1108 EOR.w D3, (A7)+ b75f",
			init: 			cpuState{
				D:   [8]uint32{3135116954, 3234627914, 4021507936, 2863205354, 40367135, 1617924024, 3054832866, 4147238696},
				A:   [7]uint32{3943099010, 1101176839, 2534037279, 3511458584, 593191484, 2161792653, 1288366864},
				PC:  12945718,
				SR:  785,
				USP: 10537296,
				SSP: 4056418,
				RAM: [][2]uint32{{12945714, 183}, {12945715, 95}, {12945716, 88}, {12945717, 200}, {10537296, 227}, {10537297, 165}, {12945718, 56}, {12945719, 180}},
			},
			want: 			cpuState{
				D:   [8]uint32{3135116954, 3234627914, 4021507936, 2863205354, 40367135, 1617924024, 3054832866, 4147238696},
				A:   [7]uint32{3943099010, 1101176839, 2534037279, 3511458584, 593191484, 2161792653, 1288366864},
				PC:  12945720,
				SR:  792,
				USP: 10537298,
				SSP: 4056418,
				RAM: [][2]uint32{{12945714, 183}, {12945715, 95}, {12945716, 88}, {12945717, 200}, {10537296, 232}, {10537297, 79}, {12945718, 56}, {12945719, 180}},
				Cycles: 12,
			},
		},
		{
			name: "1375 EOR.w D0, D5 b145",
			init: 			cpuState{
				D:   [8]uint32{3172485824, 1060140991, 534189453, 1253384230, 3554656561, 3642303703, 3227830747, 1400641713},
				A:   [7]uint32{3754312900, 90940914, 269370824, 3508354892, 3287395234, 644004090, 2368585989},
				PC:  10343220,
				SR:  517,
				USP: 15405016,
				SSP: 4822406,
				RAM: [][2]uint32{{10343216, 177}, {10343217, 69}, {10343218, 187}, {10343219, 151}, {10343220, 105}, {10343221, 64}},
			},
			want: 			cpuState{
				D:   [8]uint32{3172485824, 1060140991, 534189453, 1253384230, 3554656561, 3642322455, 3227830747, 1400641713},
				A:   [7]uint32{3754312900, 90940914, 269370824, 3508354892, 3287395234, 644004090, 2368585989},
				PC:  10343222,
				SR:  512,
				USP: 15405016,
				SSP: 4822406,
				RAM: [][2]uint32{{10343216, 177}, {10343217, 69}, {10343218, 187}, {10343219, 151}, {10343220, 105}, {10343221, 64}},
				Cycles: 4,
			},
		},
		{
			name: "1656 EOR.w D1, -(A6) b366",
			init: 			cpuState{
				D:   [8]uint32{3468152951, 547607960, 1583295521, 1378000503, 736698484, 3571546043, 1274462618, 559049296},
				A:   [7]uint32{547712038, 189646882, 834224075, 2410956133, 1793453209, 3002977295, 1011969338},
				PC:  1413502,
				SR:  8471,
				USP: 11179636,
				SSP: 772912,
				RAM: [][2]uint32{{1413498, 179}, {1413499, 102}, {1413500, 116}, {1413501, 69}, {5336376, 82}, {5336377, 201}, {1413502, 30}, {1413503, 109}},
			},
			want: 			cpuState{
				D:   [8]uint32{3468152951, 547607960, 1583295521, 1378000503, 736698484, 3571546043, 1274462618, 559049296},
				A:   [7]uint32{547712038, 189646882, 834224075, 2410956133, 1793453209, 3002977295, 1011969336},
				PC:  1413504,
				SR:  8472,
				USP: 11179636,
				SSP: 772912,
				RAM: [][2]uint32{{1413498, 179}, {1413499, 102}, {1413500, 116}, {1413501, 69}, {5336376, 135}, {5336377, 81}, {1413502, 30}, {1413503, 109}},
				Cycles: 14,
			},
		},
		{
			name: "1929 EOR.w D7, -(A1) bf61",
			init: 			cpuState{
				D:   [8]uint32{2028634954, 3049815604, 3076453312, 2164467412, 80376671, 3818415770, 2340860728, 1491724142},
				A:   [7]uint32{2883948968, 1874216706, 3695038470, 4281778049, 4246228983, 1671689084, 4048829010},
				PC:  2352516,
				SR:  9501,
				USP: 3814948,
				SSP: 10093172,
				RAM: [][2]uint32{{2352512, 191}, {2352513, 97}, {2352514, 4}, {2352515, 149}, {11945728, 65}, {11945729, 237}, {2352516, 62}, {2352517, 127}},
			},
			want: 			cpuState{
				D:   [8]uint32{2028634954, 3049815604, 3076453312, 2164467412, 80376671, 3818415770, 2340860728, 1491724142},
				A:   [7]uint32{2883948968, 1874216704, 3695038470, 4281778049, 4246228983, 1671689084, 4048829010},
				PC:  2352518,
				SR:  9496,
				USP: 3814948,
				SSP: 10093172,
				RAM: [][2]uint32{{2352512, 191}, {2352513, 97}, {2352514, 4}, {2352515, 149}, {11945728, 166}, {11945729, 131}, {2352516, 62}, {2352517, 127}},
				Cycles: 14,
			},
		},
		{
			name: "2218 EOR.w D7, (d16, A3) bf6b",
			init: 			cpuState{
				D:   [8]uint32{3195445384, 3112298685, 2854454553, 3863099649, 2074406752, 4279822662, 166452503, 4229323291},
				A:   [7]uint32{2801172524, 2714793795, 3860170176, 1623111978, 1700819597, 1106006440, 2899586478},
				PC:  11983246,
				SR:  9494,
				USP: 15051734,
				SSP: 156624,
				RAM: [][2]uint32{{11983242, 191}, {11983243, 107}, {11983244, 113}, {11983245, 188}, {11983246, 208}, {11983247, 207}, {12528358, 182}, {12528359, 214}, {11983248, 144}, {11983249, 211}},
			},
			want: 			cpuState{
				D:   [8]uint32{3195445384, 3112298685, 2854454553, 3863099649, 2074406752, 4279822662, 166452503, 4229323291},
				A:   [7]uint32{2801172524, 2714793795, 3860170176, 1623111978, 1700819597, 1106006440, 2899586478},
				PC:  11983250,
				SR:  9496,
				USP: 15051734,
				SSP: 156624,
				RAM: [][2]uint32{{11983242, 191}, {11983243, 107}, {11983244, 113}, {11983245, 188}, {11983246, 208}, {11983247, 207}, {12528358, 236}, {12528359, 205}, {11983248, 144}, {11983249, 211}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEOR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EOR.l D2, -(A5) b5a5",
			init: cpuState{
				D:   [8]uint32{3928778808, 2079352038, 2682923295, 3223726102, 1547726049, 749941974, 823179338, 1733805970},
				A:   [7]uint32{2821932698, 1563380308, 4179801688, 281515365, 3107417165, 3951753826, 3692718667},
				PC:  10013206,
				SR:  41499,
				USP: 8503530,
				SSP: 1862828,
				RAM: [][2]uint32{{10013202, 181}, {10013203, 165}, {10013204, 164}, {10013205, 217}, {9108062, 37}, {9108063, 88}, {9108064, 33}, {9108065, 30}, {10013206, 193}, {10013207, 224}},
			},
			want: cpuState{
				D:   [8]uint32{3928778808, 2079352038, 2682923295, 3223726102, 1547726049, 749941974, 823179338, 1733805970},
				A:   [7]uint32{2821932698, 1563380308, 4179801688, 281515365, 3107417165, 3951753822, 3692718667},
				PC:  10013208,
				SR:  41496,
				USP: 8503530,
				SSP: 1862828,
				RAM: [][2]uint32{{10013202, 181}, {10013203, 165}, {10013204, 164}, {10013205, 217}, {9108062, 186}, {9108063, 178}, {9108064, 8}, {9108065, 1}, {10013206, 193}, {10013207, 224}},
				Cycles: 22,
			},
		},
		{
			name: "500 EOR.l D1, (d8, A0, Xn) b3b0",
			init: cpuState{
				D:   [8]uint32{659716886, 136122778, 645524876, 3302195869, 423153222, 1063463254, 902374852, 1677817927},
				A:   [7]uint32{1475122244, 1218986610, 437689720, 3708222612, 4200796830, 2935002597, 1326491355},
				PC:  10863348,
				SR:  8981,
				USP: 11230308,
				SSP: 834730,
				RAM: [][2]uint32{{10863344, 179}, {10863345, 176}, {10863346, 29}, {10863347, 217}, {10863348, 183}, {10863349, 147}, {12, 73}, {13, 36}, {14, 102}, {15, 130}, {2385538, 23}, {2385539, 176}, {2385540, 24}, {2385541, 157}},
			},
			want: cpuState{
				D:      [8]uint32{659716886, 136122778, 645524876, 3302195869, 423153222, 1063463254, 902374852, 1677817927},
				A:      [7]uint32{1475122244, 1218986610, 437689720, 3708222612, 4200796830, 2935002597, 1326491355},
				PC:     1227122310,
				SR:     8981,
				USP:    11230308,
				SSP:    834716,
				RAM:    [][2]uint32{{10863344, 179}, {10863345, 176}, {10863346, 29}, {10863347, 217}, {10863348, 183}, {10863349, 147}, {834728, 194}, {834729, 242}, {834724, 35}, {834725, 21}, {834726, 0}, {834727, 165}, {834722, 179}, {834723, 176}, {834720, 165}, {834721, 183}, {834716, 179}, {834717, 181}, {834718, 96}, {834719, 9}, {12, 73}, {13, 36}, {14, 102}, {15, 130}, {2385538, 23}, {2385539, 176}, {2385540, 24}, {2385541, 157}},
				Halted: true,
			},
		},
		{
			name: "1000 EOR.l D1, (d16, A1) b3a9",
			init: cpuState{
				D:   [8]uint32{2195654947, 3804225568, 364787453, 2480535140, 3180147124, 4198870619, 247794665, 3688136090},
				A:   [7]uint32{2303401210, 1423325149, 2566389600, 384495469, 3356354022, 1644274341, 661788344},
				PC:  2935054,
				SR:  9221,
				USP: 3402242,
				SSP: 8304836,
				RAM: [][2]uint32{{2935050, 179}, {2935051, 169}, {2935052, 90}, {2935053, 197}, {2935054, 170}, {2935055, 83}, {14062242, 53}, {14062243, 59}, {14062244, 130}, {14062245, 58}, {2935056, 15}, {2935057, 7}},
			},
			want: cpuState{
				D:   [8]uint32{2195654947, 3804225568, 364787453, 2480535140, 3180147124, 4198870619, 247794665, 3688136090},
				A:   [7]uint32{2303401210, 1423325149, 2566389600, 384495469, 3356354022, 1644274341, 661788344},
				PC:  2935058,
				SR:  9224,
				USP: 3402242,
				SSP: 8304836,
				RAM: [][2]uint32{{2935050, 179}, {2935051, 169}, {2935052, 90}, {2935053, 197}, {2935054, 170}, {2935055, 83}, {14062242, 215}, {14062243, 132}, {14062244, 98}, {14062245, 26}, {2935056, 15}, {2935057, 7}},
				Cycles: 24,
			},
		},
		{
			name: "1500 EOR.l D7, (A6) bf96",
			init: cpuState{
				D:   [8]uint32{1302700381, 2493106134, 3001303510, 2854441445, 1807324955, 3915834692, 473164958, 2094801345},
				A:   [7]uint32{2384158045, 871918572, 921165313, 3673428061, 1154539197, 315689983, 2332765178},
				PC:  1231530,
				SR:  42255,
				USP: 10705264,
				SSP: 1070216,
				RAM: [][2]uint32{{1231526, 191}, {1231527, 150}, {1231528, 95}, {1231529, 136}, {732154, 41}, {732155, 7}, {732156, 179}, {732157, 4}, {1231530, 9}, {1231531, 122}},
			},
			want: cpuState{
				D:   [8]uint32{1302700381, 2493106134, 3001303510, 2854441445, 1807324955, 3915834692, 473164958, 2094801345},
				A:   [7]uint32{2384158045, 871918572, 921165313, 3673428061, 1154539197, 315689983, 2332765178},
				PC:  1231532,
				SR:  42240,
				USP: 10705264,
				SSP: 1070216,
				RAM: [][2]uint32{{1231526, 191}, {1231527, 150}, {1231528, 95}, {1231529, 136}, {732154, 85}, {732155, 219}, {732156, 146}, {732157, 197}, {1231530, 9}, {1231531, 122}},
				Cycles: 20,
			},
		},
		{
			name: "2000 EOR.l D3, D0 b780",
			init: cpuState{
				D:   [8]uint32{4055303072, 3701969532, 4204251732, 844725002, 3579406498, 4037590824, 181872260, 198086568},
				A:   [7]uint32{566631339, 842156694, 623943014, 1912019985, 3634910238, 3860547306, 3847017145},
				PC:  10086988,
				SR:  8971,
				USP: 16483720,
				SSP: 2652128,
				RAM: [][2]uint32{{10086984, 183}, {10086985, 128}, {10086986, 75}, {10086987, 85}, {10086988, 107}, {10086989, 48}},
			},
			want: cpuState{
				D:   [8]uint32{3287185578, 3701969532, 4204251732, 844725002, 3579406498, 4037590824, 181872260, 198086568},
				A:   [7]uint32{566631339, 842156694, 623943014, 1912019985, 3634910238, 3860547306, 3847017145},
				PC:  10086990,
				SR:  8968,
				USP: 16483720,
				SSP: 2652128,
				RAM: [][2]uint32{{10086984, 183}, {10086985, 128}, {10086986, 75}, {10086987, 85}, {10086988, 107}, {10086989, 48}},
				Cycles: 8,
			},
		},
		{
			name: "004 EOR.l D6, (A5) bd95",
			init: 			cpuState{
				D:   [8]uint32{2798740804, 1506092222, 1171837679, 2357011730, 1148611477, 2900787584, 3003684729, 3758573291},
				A:   [7]uint32{3343114716, 2617351411, 3040947865, 1761994319, 1037485677, 2501979388, 628671557},
				PC:  14255576,
				SR:  9219,
				USP: 14386872,
				SSP: 16315276,
				RAM: [][2]uint32{{14255572, 189}, {14255573, 149}, {14255574, 80}, {14255575, 1}, {2174204, 139}, {2174205, 159}, {2174206, 145}, {2174207, 26}, {14255576, 88}, {14255577, 171}},
			},
			want: 			cpuState{
				D:   [8]uint32{2798740804, 1506092222, 1171837679, 2357011730, 1148611477, 2900787584, 3003684729, 3758573291},
				A:   [7]uint32{3343114716, 2617351411, 3040947865, 1761994319, 1037485677, 2501979388, 628671557},
				PC:  14255578,
				SR:  9216,
				USP: 14386872,
				SSP: 16315276,
				RAM: [][2]uint32{{14255572, 189}, {14255573, 149}, {14255574, 80}, {14255575, 1}, {2174204, 56}, {2174205, 151}, {2174206, 6}, {2174207, 99}, {14255576, 88}, {14255577, 171}},
				Cycles: 20,
			},
		},
		{
			name: "272 EOR.l D6, (A6) bd96",
			init: 			cpuState{
				D:   [8]uint32{2253422476, 3928321617, 3791928697, 445711432, 1189836771, 2757464886, 64391037, 3239039688},
				A:   [7]uint32{4277229821, 3471643561, 2434241548, 3705109229, 2108627714, 301694949, 97249908},
				PC:  15989792,
				SR:  8976,
				USP: 7131190,
				SSP: 10672118,
				RAM: [][2]uint32{{15989788, 189}, {15989789, 150}, {15989790, 89}, {15989791, 74}, {13363828, 138}, {13363829, 33}, {13363830, 216}, {13363831, 122}, {15989792, 156}, {15989793, 118}},
			},
			want: 			cpuState{
				D:   [8]uint32{2253422476, 3928321617, 3791928697, 445711432, 1189836771, 2757464886, 64391037, 3239039688},
				A:   [7]uint32{4277229821, 3471643561, 2434241548, 3705109229, 2108627714, 301694949, 97249908},
				PC:  15989794,
				SR:  8984,
				USP: 7131190,
				SSP: 10672118,
				RAM: [][2]uint32{{15989788, 189}, {15989789, 150}, {15989790, 89}, {15989791, 74}, {13363828, 137}, {13363829, 247}, {13363830, 95}, {13363831, 7}, {15989792, 156}, {15989793, 118}},
				Cycles: 20,
			},
		},
		{
			name: "533 EOR.l D4, D0 b980",
			init: 			cpuState{
				D:   [8]uint32{3147601239, 3649376543, 1949530733, 1733855423, 2573398363, 2624029562, 2043788806, 71035451},
				A:   [7]uint32{1253650234, 3499607421, 1771695234, 1710011102, 1849204711, 2893918084, 247178779},
				PC:  2461654,
				SR:  9500,
				USP: 10515464,
				SSP: 1504924,
				RAM: [][2]uint32{{2461650, 185}, {2461651, 128}, {2461652, 195}, {2461653, 12}, {2461654, 251}, {2461655, 128}},
			},
			want: 			cpuState{
				D:   [8]uint32{587097100, 3649376543, 1949530733, 1733855423, 2573398363, 2624029562, 2043788806, 71035451},
				A:   [7]uint32{1253650234, 3499607421, 1771695234, 1710011102, 1849204711, 2893918084, 247178779},
				PC:  2461656,
				SR:  9488,
				USP: 10515464,
				SSP: 1504924,
				RAM: [][2]uint32{{2461650, 185}, {2461651, 128}, {2461652, 195}, {2461653, 12}, {2461654, 251}, {2461655, 128}},
				Cycles: 8,
			},
		},
		{
			name: "849 EOR.l D2, D5 b585",
			init: 			cpuState{
				D:   [8]uint32{3479113379, 2434251792, 3866295788, 1233459519, 2541075038, 3783756843, 2548698212, 950773034},
				A:   [7]uint32{1581116582, 835654585, 3902144243, 1544978925, 3629710387, 493506480, 3982958183},
				PC:  6820420,
				SR:  787,
				USP: 1477928,
				SSP: 7008638,
				RAM: [][2]uint32{{6820416, 181}, {6820417, 133}, {6820418, 197}, {6820419, 48}, {6820420, 93}, {6820421, 74}},
			},
			want: 			cpuState{
				D:   [8]uint32{3479113379, 2434251792, 3866295788, 1233459519, 2541075038, 133525959, 2548698212, 950773034},
				A:   [7]uint32{1581116582, 835654585, 3902144243, 1544978925, 3629710387, 493506480, 3982958183},
				PC:  6820422,
				SR:  784,
				USP: 1477928,
				SSP: 7008638,
				RAM: [][2]uint32{{6820416, 181}, {6820417, 133}, {6820418, 197}, {6820419, 48}, {6820420, 93}, {6820421, 74}},
				Cycles: 8,
			},
		},
		{
			name: "1128 EOR.l D3, (A1) b791",
			init: 			cpuState{
				D:   [8]uint32{3678410977, 885184932, 4127890794, 3134466092, 1174635682, 2701829192, 1983145739, 1351904132},
				A:   [7]uint32{2476481528, 5655802, 3235844675, 1725881674, 3146534500, 681708572, 3990204578},
				PC:  12498554,
				SR:  780,
				USP: 9399686,
				SSP: 6212396,
				RAM: [][2]uint32{{12498550, 183}, {12498551, 145}, {12498552, 77}, {12498553, 101}, {5655802, 163}, {5655803, 98}, {5655804, 80}, {5655805, 109}, {12498554, 165}, {12498555, 113}},
			},
			want: 			cpuState{
				D:   [8]uint32{3678410977, 885184932, 4127890794, 3134466092, 1174635682, 2701829192, 1983145739, 1351904132},
				A:   [7]uint32{2476481528, 5655802, 3235844675, 1725881674, 3146534500, 681708572, 3990204578},
				PC:  12498556,
				SR:  768,
				USP: 9399686,
				SSP: 6212396,
				RAM: [][2]uint32{{12498550, 183}, {12498551, 145}, {12498552, 77}, {12498553, 101}, {5655802, 25}, {5655803, 182}, {5655804, 120}, {5655805, 65}, {12498554, 165}, {12498555, 113}},
				Cycles: 20,
			},
		},
		{
			name: "1376 EOR.l D1, D6 b386",
			init: 			cpuState{
				D:   [8]uint32{1166096340, 569562493, 3938193128, 933602600, 3364282574, 2869628460, 1869030271, 2048758685},
				A:   [7]uint32{572124505, 312185795, 729603036, 908943235, 2708739672, 3100570202, 932260713},
				PC:  13389774,
				SR:  8209,
				USP: 4276302,
				SSP: 8744316,
				RAM: [][2]uint32{{13389770, 179}, {13389771, 134}, {13389772, 44}, {13389773, 6}, {13389774, 49}, {13389775, 232}},
			},
			want: 			cpuState{
				D:   [8]uint32{1166096340, 569562493, 3938193128, 933602600, 3364282574, 2869628460, 1318450690, 2048758685},
				A:   [7]uint32{572124505, 312185795, 729603036, 908943235, 2708739672, 3100570202, 932260713},
				PC:  13389776,
				SR:  8208,
				USP: 4276302,
				SSP: 8744316,
				RAM: [][2]uint32{{13389770, 179}, {13389771, 134}, {13389772, 44}, {13389773, 6}, {13389774, 49}, {13389775, 232}},
				Cycles: 8,
			},
		},
		{
			name: "1660 EOR.l D3, (d8, A1, Xn) b7b1",
			init: 			cpuState{
				D:   [8]uint32{3117622002, 2015825934, 3371753746, 1629764107, 2380984202, 2864247383, 292782595, 4201130544},
				A:   [7]uint32{3708811491, 1042073754, 24467883, 2445320962, 1226078504, 1269371918, 489005744},
				PC:  10134266,
				SR:  9997,
				USP: 5075236,
				SSP: 6438496,
				RAM: [][2]uint32{{10134262, 183}, {10134263, 177}, {10134264, 232}, {10134265, 22}, {10134266, 99}, {10134267, 193}, {4352864, 92}, {4352865, 228}, {4352866, 42}, {4352867, 217}, {10134268, 164}, {10134269, 210}},
			},
			want: 			cpuState{
				D:   [8]uint32{3117622002, 2015825934, 3371753746, 1629764107, 2380984202, 2864247383, 292782595, 4201130544},
				A:   [7]uint32{3708811491, 1042073754, 24467883, 2445320962, 1226078504, 1269371918, 489005744},
				PC:  10134270,
				SR:  9984,
				USP: 5075236,
				SSP: 6438496,
				RAM: [][2]uint32{{10134262, 183}, {10134263, 177}, {10134264, 232}, {10134265, 22}, {10134266, 99}, {10134267, 193}, {4352864, 61}, {4352865, 192}, {4352866, 16}, {4352867, 210}, {10134268, 164}, {10134269, 210}},
				Cycles: 26,
			},
		},
		{
			name: "1962 EOR.l D7, D4 bf84",
			init: 			cpuState{
				D:   [8]uint32{3767304534, 4174333950, 1124660110, 4199528032, 3854865793, 305943363, 1657521559, 4185258703},
				A:   [7]uint32{4087996767, 3059478102, 3819934288, 339669458, 555982354, 1121902300, 2518163857},
				PC:  2759612,
				SR:  257,
				USP: 1669768,
				SSP: 7449744,
				RAM: [][2]uint32{{2759608, 191}, {2759609, 132}, {2759610, 155}, {2759611, 172}, {2759612, 246}, {2759613, 153}},
			},
			want: 			cpuState{
				D:   [8]uint32{3767304534, 4174333950, 1124660110, 4199528032, 481390414, 305943363, 1657521559, 4185258703},
				A:   [7]uint32{4087996767, 3059478102, 3819934288, 339669458, 555982354, 1121902300, 2518163857},
				PC:  2759614,
				SR:  256,
				USP: 1669768,
				SSP: 7449744,
				RAM: [][2]uint32{{2759608, 191}, {2759609, 132}, {2759610, 155}, {2759611, 172}, {2759612, 246}, {2759613, 153}},
				Cycles: 8,
			},
		},
		{
			name: "2246 EOR.l D7, (A2)+ bf9a",
			init: 			cpuState{
				D:   [8]uint32{3346124569, 1197543549, 57011151, 1729061200, 3778957035, 3737464454, 598749875, 3325915030},
				A:   [7]uint32{4020747325, 3949862002, 1875025352, 3713458746, 1784477821, 1224024751, 3961561215},
				PC:  14613878,
				SR:  1819,
				USP: 1170562,
				SSP: 6459908,
				RAM: [][2]uint32{{14613874, 191}, {14613875, 154}, {14613876, 213}, {14613877, 111}, {12754376, 169}, {12754377, 225}, {12754378, 197}, {12754379, 81}, {14613878, 229}, {14613879, 255}},
			},
			want: 			cpuState{
				D:   [8]uint32{3346124569, 1197543549, 57011151, 1729061200, 3778957035, 3737464454, 598749875, 3325915030},
				A:   [7]uint32{4020747325, 3949862002, 1875025356, 3713458746, 1784477821, 1224024751, 3961561215},
				PC:  14613880,
				SR:  1808,
				USP: 1170562,
				SSP: 6459908,
				RAM: [][2]uint32{{14613874, 191}, {14613875, 154}, {14613876, 213}, {14613877, 111}, {12754376, 111}, {12754377, 220}, {12754378, 170}, {12754379, 199}, {14613878, 229}, {14613879, 255}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNOT_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NOT.b (A7) 4617",
			init: cpuState{
				D:   [8]uint32{2559601891, 2054041401, 97028455, 910044421, 85557167, 2632298684, 1700730959, 936216423},
				A:   [7]uint32{3811871237, 148047401, 3911004127, 3742298427, 1904513757, 811544757, 2425344126},
				PC:  6107794,
				SR:  41224,
				USP: 14768512,
				SSP: 4666216,
				RAM: [][2]uint32{{6107790, 70}, {6107791, 23}, {6107792, 132}, {6107793, 172}, {4666216, 216}, {4666217, 210}, {6107794, 50}, {6107795, 150}},
			},
			want: cpuState{
				D:   [8]uint32{2559601891, 2054041401, 97028455, 910044421, 85557167, 2632298684, 1700730959, 936216423},
				A:   [7]uint32{3811871237, 148047401, 3911004127, 3742298427, 1904513757, 811544757, 2425344126},
				PC:  6107796,
				SR:  41216,
				USP: 14768512,
				SSP: 4666216,
				RAM: [][2]uint32{{6107790, 70}, {6107791, 23}, {6107792, 132}, {6107793, 172}, {4666216, 39}, {4666217, 210}, {6107794, 50}, {6107795, 150}},
				Cycles: 12,
			},
		},
		{
			name: "500 NOT.b D2 4602",
			init: cpuState{
				D:   [8]uint32{614397296, 1521408887, 1770091524, 1615477103, 480504239, 2079804599, 2863713853, 4113225314},
				A:   [7]uint32{2163824906, 3178835982, 3957082209, 83019313, 1704169768, 1549029593, 809412451},
				PC:  5249764,
				SR:  8706,
				USP: 10937828,
				SSP: 13234574,
				RAM: [][2]uint32{{5249760, 70}, {5249761, 2}, {5249762, 138}, {5249763, 174}, {5249764, 198}, {5249765, 73}},
			},
			want: cpuState{
				D:   [8]uint32{614397296, 1521408887, 1770091771, 1615477103, 480504239, 2079804599, 2863713853, 4113225314},
				A:   [7]uint32{2163824906, 3178835982, 3957082209, 83019313, 1704169768, 1549029593, 809412451},
				PC:  5249766,
				SR:  8712,
				USP: 10937828,
				SSP: 13234574,
				RAM: [][2]uint32{{5249760, 70}, {5249761, 2}, {5249762, 138}, {5249763, 174}, {5249764, 198}, {5249765, 73}},
				Cycles: 4,
			},
		},
		{
			name: "1000 NOT.b (d8, A5, Xn) 4635",
			init: cpuState{
				D:   [8]uint32{1592364749, 2683341569, 1267868757, 2389662490, 2376183540, 454447661, 4108907705, 834021319},
				A:   [7]uint32{3771783366, 3539283280, 3391083060, 3256185366, 4250647154, 730034015, 2508463719},
				PC:  10064204,
				SR:  8723,
				USP: 842864,
				SSP: 5473290,
				RAM: [][2]uint32{{10064200, 70}, {10064201, 53}, {10064202, 34}, {10064203, 40}, {10064204, 22}, {10064205, 79}, {8623068, 205}, {8623069, 245}, {10064206, 195}, {10064207, 167}},
			},
			want: cpuState{
				D:   [8]uint32{1592364749, 2683341569, 1267868757, 2389662490, 2376183540, 454447661, 4108907705, 834021319},
				A:   [7]uint32{3771783366, 3539283280, 3391083060, 3256185366, 4250647154, 730034015, 2508463719},
				PC:  10064208,
				SR:  8720,
				USP: 842864,
				SSP: 5473290,
				RAM: [][2]uint32{{10064200, 70}, {10064201, 53}, {10064202, 34}, {10064203, 40}, {10064204, 22}, {10064205, 79}, {8623068, 50}, {8623069, 245}, {10064206, 195}, {10064207, 167}},
				Cycles: 18,
			},
		},
		{
			name: "1500 NOT.b (d16, A4) 462c",
			init: cpuState{
				D:   [8]uint32{3104726469, 252598494, 3595659882, 3049728854, 996257110, 745342844, 3222254920, 1632674045},
				A:   [7]uint32{3615794881, 1919948253, 1025815855, 1719740259, 3004216106, 1001600716, 3298913584},
				PC:  3395134,
				SR:  1815,
				USP: 12282404,
				SSP: 2012822,
				RAM: [][2]uint32{{3395130, 70}, {3395131, 44}, {3395132, 56}, {3395133, 153}, {3395134, 157}, {3395135, 121}, {1108930, 65}, {1108931, 84}, {3395136, 99}, {3395137, 201}},
			},
			want: cpuState{
				D:   [8]uint32{3104726469, 252598494, 3595659882, 3049728854, 996257110, 745342844, 3222254920, 1632674045},
				A:   [7]uint32{3615794881, 1919948253, 1025815855, 1719740259, 3004216106, 1001600716, 3298913584},
				PC:  3395138,
				SR:  1816,
				USP: 12282404,
				SSP: 2012822,
				RAM: [][2]uint32{{3395130, 70}, {3395131, 44}, {3395132, 56}, {3395133, 153}, {3395134, 157}, {3395135, 121}, {1108930, 65}, {1108931, 171}, {3395136, 99}, {3395137, 201}},
				Cycles: 16,
			},
		},
		{
			name: "2000 NOT.b (d8, A4, Xn) 4634",
			init: cpuState{
				D:   [8]uint32{2232223304, 3583954217, 3176898865, 2832591899, 4242510460, 1934704136, 380321088, 2351906208},
				A:   [7]uint32{1532981860, 2746931288, 3477121466, 3417167760, 1331909220, 3634235563, 3101141982},
				PC:  7983732,
				SR:  42520,
				USP: 12594276,
				SSP: 3330858,
				RAM: [][2]uint32{{7983728, 70}, {7983729, 52}, {7983730, 36}, {7983731, 84}, {7983732, 162}, {7983733, 248}, {6484968, 201}, {6484969, 145}, {7983734, 162}, {7983735, 98}},
			},
			want: cpuState{
				D:   [8]uint32{2232223304, 3583954217, 3176898865, 2832591899, 4242510460, 1934704136, 380321088, 2351906208},
				A:   [7]uint32{1532981860, 2746931288, 3477121466, 3417167760, 1331909220, 3634235563, 3101141982},
				PC:  7983736,
				SR:  42512,
				USP: 12594276,
				SSP: 3330858,
				RAM: [][2]uint32{{7983728, 70}, {7983729, 52}, {7983730, 36}, {7983731, 84}, {7983732, 162}, {7983733, 248}, {6484968, 201}, {6484969, 110}, {7983734, 162}, {7983735, 98}},
				Cycles: 18,
			},
		},
		{
			name: "001 NOT.b (A1)+ 4619",
			init: 			cpuState{
				D:   [8]uint32{198253343, 1452803808, 704640480, 2235147834, 3729299967, 646458041, 559780980, 783108876},
				A:   [7]uint32{2902562430, 2535676174, 336924648, 2936721051, 1278858261, 650796374, 148016055},
				PC:  6346344,
				SR:  9219,
				USP: 7905636,
				SSP: 9110622,
				RAM: [][2]uint32{{6346340, 70}, {6346341, 25}, {6346342, 153}, {6346343, 18}, {2316558, 98}, {2316559, 254}, {6346344, 226}, {6346345, 92}},
			},
			want: 			cpuState{
				D:   [8]uint32{198253343, 1452803808, 704640480, 2235147834, 3729299967, 646458041, 559780980, 783108876},
				A:   [7]uint32{2902562430, 2535676175, 336924648, 2936721051, 1278858261, 650796374, 148016055},
				PC:  6346346,
				SR:  9224,
				USP: 7905636,
				SSP: 9110622,
				RAM: [][2]uint32{{6346340, 70}, {6346341, 25}, {6346342, 153}, {6346343, 18}, {2316558, 157}, {2316559, 254}, {6346344, 226}, {6346345, 92}},
				Cycles: 12,
			},
		},
		{
			name: "243 NOT.b (A0)+ 4618",
			init: 			cpuState{
				D:   [8]uint32{2912621749, 899780690, 2256787491, 1420952421, 2124973552, 2906834888, 3501008825, 730163269},
				A:   [7]uint32{2845136464, 3500384928, 3319213681, 1713890729, 2228376980, 1673398484, 951759111},
				PC:  8245872,
				SR:  9481,
				USP: 4326560,
				SSP: 14658000,
				RAM: [][2]uint32{{8245868, 70}, {8245869, 24}, {8245870, 90}, {8245871, 232}, {9786960, 241}, {9786961, 35}, {8245872, 97}, {8245873, 39}},
			},
			want: 			cpuState{
				D:   [8]uint32{2912621749, 899780690, 2256787491, 1420952421, 2124973552, 2906834888, 3501008825, 730163269},
				A:   [7]uint32{2845136465, 3500384928, 3319213681, 1713890729, 2228376980, 1673398484, 951759111},
				PC:  8245874,
				SR:  9472,
				USP: 4326560,
				SSP: 14658000,
				RAM: [][2]uint32{{8245868, 70}, {8245869, 24}, {8245870, 90}, {8245871, 232}, {9786960, 14}, {9786961, 35}, {8245872, 97}, {8245873, 39}},
				Cycles: 12,
			},
		},
		{
			name: "542 NOT.b (d16, A2) 462a",
			init: 			cpuState{
				D:   [8]uint32{1264461473, 1443413902, 2289434011, 3622815120, 664485632, 3684944125, 3893401936, 858026983},
				A:   [7]uint32{1804482028, 241205958, 2909219627, 4044988759, 1546618880, 1848145676, 711524679},
				PC:  8139836,
				SR:  10002,
				USP: 10161346,
				SSP: 8142396,
				RAM: [][2]uint32{{8139832, 70}, {8139833, 42}, {8139834, 183}, {8139835, 254}, {8139836, 221}, {8139837, 62}, {6742824, 51}, {6742825, 78}, {8139838, 17}, {8139839, 221}},
			},
			want: 			cpuState{
				D:   [8]uint32{1264461473, 1443413902, 2289434011, 3622815120, 664485632, 3684944125, 3893401936, 858026983},
				A:   [7]uint32{1804482028, 241205958, 2909219627, 4044988759, 1546618880, 1848145676, 711524679},
				PC:  8139840,
				SR:  10008,
				USP: 10161346,
				SSP: 8142396,
				RAM: [][2]uint32{{8139832, 70}, {8139833, 42}, {8139834, 183}, {8139835, 254}, {8139836, 221}, {8139837, 62}, {6742824, 51}, {6742825, 177}, {8139838, 17}, {8139839, 221}},
				Cycles: 16,
			},
		},
		{
			name: "837 NOT.b (A4) 4614",
			init: 			cpuState{
				D:   [8]uint32{1300698571, 3974513720, 337321155, 3738136025, 3057927571, 4165653521, 1332779876, 2518583461},
				A:   [7]uint32{2660672379, 3509201313, 4026837669, 2361229907, 1305846672, 2131403738, 2442199748},
				PC:  2005688,
				SR:  8211,
				USP: 7634658,
				SSP: 13324948,
				RAM: [][2]uint32{{2005684, 70}, {2005685, 20}, {2005686, 30}, {2005687, 12}, {14001040, 64}, {14001041, 106}, {2005688, 115}, {2005689, 226}},
			},
			want: 			cpuState{
				D:   [8]uint32{1300698571, 3974513720, 337321155, 3738136025, 3057927571, 4165653521, 1332779876, 2518583461},
				A:   [7]uint32{2660672379, 3509201313, 4026837669, 2361229907, 1305846672, 2131403738, 2442199748},
				PC:  2005690,
				SR:  8216,
				USP: 7634658,
				SSP: 13324948,
				RAM: [][2]uint32{{2005684, 70}, {2005685, 20}, {2005686, 30}, {2005687, 12}, {14001040, 191}, {14001041, 106}, {2005688, 115}, {2005689, 226}},
				Cycles: 12,
			},
		},
		{
			name: "1117 NOT.b (A3)+ 461b",
			init: 			cpuState{
				D:   [8]uint32{2425528867, 87854607, 1612648385, 1002034348, 1188685552, 808572854, 326469289, 2452541366},
				A:   [7]uint32{2151858755, 3640127025, 2619756202, 3168726102, 1470847598, 2062620973, 2645029852},
				PC:  7383104,
				SR:  265,
				USP: 12978290,
				SSP: 13341500,
				RAM: [][2]uint32{{7383100, 70}, {7383101, 27}, {7383102, 145}, {7383103, 4}, {14609494, 109}, {14609495, 173}, {7383104, 40}, {7383105, 173}},
			},
			want: 			cpuState{
				D:   [8]uint32{2425528867, 87854607, 1612648385, 1002034348, 1188685552, 808572854, 326469289, 2452541366},
				A:   [7]uint32{2151858755, 3640127025, 2619756202, 3168726103, 1470847598, 2062620973, 2645029852},
				PC:  7383106,
				SR:  264,
				USP: 12978290,
				SSP: 13341500,
				RAM: [][2]uint32{{7383100, 70}, {7383101, 27}, {7383102, 145}, {7383103, 4}, {14609494, 146}, {14609495, 173}, {7383104, 40}, {7383105, 173}},
				Cycles: 12,
			},
		},
		{
			name: "1393 NOT.b D0 4600",
			init: 			cpuState{
				D:   [8]uint32{705488192, 4164888158, 160468238, 4224510195, 304768468, 4022889778, 4238508413, 2019875250},
				A:   [7]uint32{855886817, 3577091471, 2132693137, 955375993, 1008316577, 1796650159, 57458989},
				PC:  13851666,
				SR:  9751,
				USP: 10344592,
				SSP: 5764788,
				RAM: [][2]uint32{{13851662, 70}, {13851663, 0}, {13851664, 170}, {13851665, 102}, {13851666, 109}, {13851667, 134}},
			},
			want: 			cpuState{
				D:   [8]uint32{705488319, 4164888158, 160468238, 4224510195, 304768468, 4022889778, 4238508413, 2019875250},
				A:   [7]uint32{855886817, 3577091471, 2132693137, 955375993, 1008316577, 1796650159, 57458989},
				PC:  13851668,
				SR:  9752,
				USP: 10344592,
				SSP: 5764788,
				RAM: [][2]uint32{{13851662, 70}, {13851663, 0}, {13851664, 170}, {13851665, 102}, {13851666, 109}, {13851667, 134}},
				Cycles: 4,
			},
		},
		{
			name: "1698 NOT.b (A1) 4611",
			init: 			cpuState{
				D:   [8]uint32{161206552, 2140355252, 3843327177, 2646883047, 3530860648, 2721475818, 2542941281, 369427559},
				A:   [7]uint32{1132288820, 4217939579, 592001853, 998676299, 4174832547, 1405134954, 505802942},
				PC:  10291654,
				SR:  27,
				USP: 8679286,
				SSP: 1258590,
				RAM: [][2]uint32{{10291650, 70}, {10291651, 17}, {10291652, 73}, {10291653, 252}, {6858362, 224}, {6858363, 26}, {10291654, 118}, {10291655, 64}},
			},
			want: 			cpuState{
				D:   [8]uint32{161206552, 2140355252, 3843327177, 2646883047, 3530860648, 2721475818, 2542941281, 369427559},
				A:   [7]uint32{1132288820, 4217939579, 592001853, 998676299, 4174832547, 1405134954, 505802942},
				PC:  10291656,
				SR:  24,
				USP: 8679286,
				SSP: 1258590,
				RAM: [][2]uint32{{10291650, 70}, {10291651, 17}, {10291652, 73}, {10291653, 252}, {6858362, 224}, {6858363, 229}, {10291654, 118}, {10291655, 64}},
				Cycles: 12,
			},
		},
		{
			name: "1949 NOT.b (A7)+ 461f",
			init: 			cpuState{
				D:   [8]uint32{162092883, 225280469, 1934524850, 112175188, 314893931, 776319994, 2926171190, 835617130},
				A:   [7]uint32{3988779017, 6569345, 1682121746, 1850880990, 191841306, 2526667062, 3357865165},
				PC:  6037490,
				SR:  8220,
				USP: 13947038,
				SSP: 10345682,
				RAM: [][2]uint32{{6037486, 70}, {6037487, 31}, {6037488, 63}, {6037489, 51}, {10345682, 137}, {10345683, 221}, {6037490, 161}, {6037491, 234}},
			},
			want: 			cpuState{
				D:   [8]uint32{162092883, 225280469, 1934524850, 112175188, 314893931, 776319994, 2926171190, 835617130},
				A:   [7]uint32{3988779017, 6569345, 1682121746, 1850880990, 191841306, 2526667062, 3357865165},
				PC:  6037492,
				SR:  8208,
				USP: 13947038,
				SSP: 10345684,
				RAM: [][2]uint32{{6037486, 70}, {6037487, 31}, {6037488, 63}, {6037489, 51}, {10345682, 118}, {10345683, 221}, {6037490, 161}, {6037491, 234}},
				Cycles: 12,
			},
		},
		{
			name: "2239 NOT.b (A3)+ 461b",
			init: 			cpuState{
				D:   [8]uint32{1157113322, 2570642073, 882893284, 2928329008, 2642889472, 1149423536, 4169213082, 363345046},
				A:   [7]uint32{782272130, 41120147, 1856879678, 3363467292, 3282645360, 372950491, 532102288},
				PC:  11878018,
				SR:  768,
				USP: 15154382,
				SSP: 15850720,
				RAM: [][2]uint32{{11878014, 70}, {11878015, 27}, {11878016, 252}, {11878017, 93}, {8024092, 154}, {8024093, 117}, {11878018, 154}, {11878019, 236}},
			},
			want: 			cpuState{
				D:   [8]uint32{1157113322, 2570642073, 882893284, 2928329008, 2642889472, 1149423536, 4169213082, 363345046},
				A:   [7]uint32{782272130, 41120147, 1856879678, 3363467293, 3282645360, 372950491, 532102288},
				PC:  11878020,
				SR:  768,
				USP: 15154382,
				SSP: 15850720,
				RAM: [][2]uint32{{11878014, 70}, {11878015, 27}, {11878016, 252}, {11878017, 93}, {8024092, 101}, {8024093, 117}, {11878018, 154}, {11878019, 236}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNOT_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NOT.w (d16, A3) 466b",
			init: cpuState{
				D:   [8]uint32{1430740577, 4121101999, 2402458249, 897543055, 3006047466, 1575273451, 2489879229, 3730751052},
				A:   [7]uint32{2592013990, 3065737031, 4273193, 2136333035, 2106646423, 3877979838, 3881938216},
				PC:  14585612,
				SR:  9502,
				USP: 1271544,
				SSP: 15526476,
				RAM: [][2]uint32{{14585608, 70}, {14585609, 107}, {14585610, 74}, {14585611, 101}, {14585612, 43}, {14585613, 31}, {5645648, 4}, {5645649, 214}, {14585614, 26}, {14585615, 246}},
			},
			want: cpuState{
				D:   [8]uint32{1430740577, 4121101999, 2402458249, 897543055, 3006047466, 1575273451, 2489879229, 3730751052},
				A:   [7]uint32{2592013990, 3065737031, 4273193, 2136333035, 2106646423, 3877979838, 3881938216},
				PC:  14585616,
				SR:  9496,
				USP: 1271544,
				SSP: 15526476,
				RAM: [][2]uint32{{14585608, 70}, {14585609, 107}, {14585610, 74}, {14585611, 101}, {14585612, 43}, {14585613, 31}, {5645648, 251}, {5645649, 41}, {14585614, 26}, {14585615, 246}},
				Cycles: 16,
			},
		},
		{
			name: "500 NOT.w (A7) 4657",
			init: cpuState{
				D:   [8]uint32{2975513371, 2033933189, 358872151, 3157097986, 3208244952, 3258146218, 3636602249, 1945313270},
				A:   [7]uint32{2555462427, 1672609932, 857233315, 1204697685, 1809710370, 2427329910, 1216296038},
				PC:  11159152,
				SR:  784,
				USP: 10681272,
				SSP: 1276750,
				RAM: [][2]uint32{{11159148, 70}, {11159149, 87}, {11159150, 235}, {11159151, 99}, {10681272, 251}, {10681273, 236}, {11159152, 187}, {11159153, 19}},
			},
			want: cpuState{
				D:   [8]uint32{2975513371, 2033933189, 358872151, 3157097986, 3208244952, 3258146218, 3636602249, 1945313270},
				A:   [7]uint32{2555462427, 1672609932, 857233315, 1204697685, 1809710370, 2427329910, 1216296038},
				PC:  11159154,
				SR:  784,
				USP: 10681272,
				SSP: 1276750,
				RAM: [][2]uint32{{11159148, 70}, {11159149, 87}, {11159150, 235}, {11159151, 99}, {10681272, 4}, {10681273, 19}, {11159152, 187}, {11159153, 19}},
				Cycles: 12,
			},
		},
		{
			name: "1000 NOT.w (d8, A5, Xn) 4675",
			init: cpuState{
				D:   [8]uint32{2242329005, 3010299599, 68563907, 3847555751, 3616553438, 180954621, 2478444693, 3639592330},
				A:   [7]uint32{3538526618, 1688814725, 358470144, 2274330874, 2305279033, 2211580593, 3268650126},
				PC:  12286666,
				SR:  10007,
				USP: 6005634,
				SSP: 1513176,
				RAM: [][2]uint32{{12286662, 70}, {12286663, 117}, {12286664, 141}, {12286665, 185}, {12286666, 173}, {12286667, 35}, {12299268, 13}, {12299269, 202}, {12286668, 210}, {12286669, 47}},
			},
			want: cpuState{
				D:   [8]uint32{2242329005, 3010299599, 68563907, 3847555751, 3616553438, 180954621, 2478444693, 3639592330},
				A:   [7]uint32{3538526618, 1688814725, 358470144, 2274330874, 2305279033, 2211580593, 3268650126},
				PC:  12286670,
				SR:  10008,
				USP: 6005634,
				SSP: 1513176,
				RAM: [][2]uint32{{12286662, 70}, {12286663, 117}, {12286664, 141}, {12286665, 185}, {12286666, 173}, {12286667, 35}, {12299268, 242}, {12299269, 53}, {12286668, 210}, {12286669, 47}},
				Cycles: 18,
			},
		},
		{
			name: "1500 NOT.w (d8, A5, Xn) 4675",
			init: cpuState{
				D:   [8]uint32{850430516, 4145376698, 900433269, 418270675, 3256449363, 3115785313, 148920985, 4145641141},
				A:   [7]uint32{2479644152, 1368040089, 2605453070, 1525968254, 3243237318, 1281377243, 169148644},
				PC:  11371618,
				SR:  8466,
				USP: 10341918,
				SSP: 4638980,
				RAM: [][2]uint32{{11371614, 70}, {11371615, 117}, {11371616, 80}, {11371617, 89}, {11371618, 52}, {11371619, 226}, {12, 45}, {13, 46}, {14, 232}, {15, 8}, {3074056, 214}, {3074057, 196}, {3074058, 19}, {3074059, 208}},
			},
			want: cpuState{
				D:      [8]uint32{850430516, 4145376698, 900433269, 418270675, 3256449363, 3115785313, 148920985, 4145641141},
				A:      [7]uint32{2479644152, 1368040089, 2605453070, 1525968254, 3243237318, 1281377243, 169148644},
				PC:     758048780,
				SR:     8466,
				USP:    10341918,
				SSP:    4638966,
				RAM:    [][2]uint32{{11371614, 70}, {11371615, 117}, {11371616, 80}, {11371617, 89}, {11371618, 52}, {11371619, 226}, {4638978, 132}, {4638979, 96}, {4638974, 33}, {4638975, 18}, {4638976, 0}, {4638977, 173}, {4638972, 70}, {4638973, 117}, {4638970, 96}, {4638971, 149}, {4638966, 70}, {4638967, 117}, {4638968, 76}, {4638969, 96}, {12, 45}, {13, 46}, {14, 232}, {15, 8}, {3074056, 214}, {3074057, 196}, {3074058, 19}, {3074059, 208}},
				Halted: true,
			},
		},
		{
			name: "2000 NOT.w (A6)+ 465e",
			init: cpuState{
				D:   [8]uint32{3859221000, 4252304118, 2859407010, 137627953, 1357080758, 2916797372, 3063376440, 2392681481},
				A:   [7]uint32{3944021602, 1263093144, 2846000954, 4078939836, 497226212, 2327033538, 3383353801},
				PC:  2802220,
				SR:  33296,
				USP: 16699528,
				SSP: 10259938,
				RAM: [][2]uint32{{2802216, 70}, {2802217, 94}, {2802218, 109}, {2802219, 137}, {12, 196}, {13, 74}, {14, 67}, {15, 164}, {4866980, 118}, {4866981, 46}, {4866982, 193}, {4866983, 76}},
			},
			want: cpuState{
				D:      [8]uint32{3859221000, 4252304118, 2859407010, 137627953, 1357080758, 2916797372, 3063376440, 2392681481},
				A:      [7]uint32{3944021602, 1263093144, 2846000954, 4078939836, 497226212, 2327033538, 3383353803},
				PC:     3293201320,
				SR:     8720,
				USP:    16699528,
				SSP:    10259924,
				RAM:    [][2]uint32{{2802216, 70}, {2802217, 94}, {2802218, 109}, {2802219, 137}, {10259936, 194}, {10259937, 42}, {10259932, 130}, {10259933, 16}, {10259934, 0}, {10259935, 42}, {10259930, 70}, {10259931, 94}, {10259928, 225}, {10259929, 201}, {10259924, 70}, {10259925, 81}, {10259926, 201}, {10259927, 169}, {12, 196}, {13, 74}, {14, 67}, {15, 164}, {4866980, 118}, {4866981, 46}, {4866982, 193}, {4866983, 76}},
				Halted: true,
			},
		},
		{
			name: "001 NOT.w (A1) 4651",
			init: 			cpuState{
				D:   [8]uint32{797594472, 3011681650, 1827022530, 828320215, 3634320722, 1884005597, 2062966051, 3668343280},
				A:   [7]uint32{2697883939, 1398197340, 680239903, 138961841, 3679613111, 1829185520, 1433635305},
				PC:  13598950,
				SR:  9245,
				USP: 7182138,
				SSP: 5823442,
				RAM: [][2]uint32{{13598946, 70}, {13598947, 81}, {13598948, 62}, {13598949, 41}, {5688412, 254}, {5688413, 169}, {13598950, 5}, {13598951, 12}},
			},
			want: 			cpuState{
				D:   [8]uint32{797594472, 3011681650, 1827022530, 828320215, 3634320722, 1884005597, 2062966051, 3668343280},
				A:   [7]uint32{2697883939, 1398197340, 680239903, 138961841, 3679613111, 1829185520, 1433635305},
				PC:  13598952,
				SR:  9232,
				USP: 7182138,
				SSP: 5823442,
				RAM: [][2]uint32{{13598946, 70}, {13598947, 81}, {13598948, 62}, {13598949, 41}, {5688412, 1}, {5688413, 86}, {13598950, 5}, {13598951, 12}},
				Cycles: 12,
			},
		},
		{
			name: "297 NOT.w (A4)+ 465c",
			init: 			cpuState{
				D:   [8]uint32{2818713980, 1592680792, 1898568918, 1472355864, 1850012579, 2018763822, 4041099979, 98774735},
				A:   [7]uint32{3027279948, 3739641443, 2078153670, 921197200, 4196570486, 2948068143, 2937035814},
				PC:  11830332,
				SR:  9472,
				USP: 13946276,
				SSP: 4066016,
				RAM: [][2]uint32{{11830328, 70}, {11830329, 92}, {11830330, 121}, {11830331, 2}, {2266486, 172}, {2266487, 7}, {11830332, 248}, {11830333, 217}},
			},
			want: 			cpuState{
				D:   [8]uint32{2818713980, 1592680792, 1898568918, 1472355864, 1850012579, 2018763822, 4041099979, 98774735},
				A:   [7]uint32{3027279948, 3739641443, 2078153670, 921197200, 4196570488, 2948068143, 2937035814},
				PC:  11830334,
				SR:  9472,
				USP: 13946276,
				SSP: 4066016,
				RAM: [][2]uint32{{11830328, 70}, {11830329, 92}, {11830330, 121}, {11830331, 2}, {2266486, 83}, {2266487, 248}, {11830332, 248}, {11830333, 217}},
				Cycles: 12,
			},
		},
		{
			name: "558 NOT.w (d16, A7) 466f",
			init: 			cpuState{
				D:   [8]uint32{1969589416, 1428487947, 2269744287, 1186745834, 113781548, 2322939859, 2443351603, 305240110},
				A:   [7]uint32{4039743970, 3355497770, 2780715526, 2607801858, 3052735038, 3706305379, 2523579163},
				PC:  8441798,
				SR:  8734,
				USP: 13744600,
				SSP: 13020618,
				RAM: [][2]uint32{{8441794, 70}, {8441795, 111}, {8441796, 118}, {8441797, 202}, {8441798, 112}, {8441799, 215}, {13051028, 109}, {13051029, 168}, {8441800, 68}, {8441801, 115}},
			},
			want: 			cpuState{
				D:   [8]uint32{1969589416, 1428487947, 2269744287, 1186745834, 113781548, 2322939859, 2443351603, 305240110},
				A:   [7]uint32{4039743970, 3355497770, 2780715526, 2607801858, 3052735038, 3706305379, 2523579163},
				PC:  8441802,
				SR:  8728,
				USP: 13744600,
				SSP: 13020618,
				RAM: [][2]uint32{{8441794, 70}, {8441795, 111}, {8441796, 118}, {8441797, 202}, {8441798, 112}, {8441799, 215}, {13051028, 146}, {13051029, 87}, {8441800, 68}, {8441801, 115}},
				Cycles: 16,
			},
		},
		{
			name: "850 NOT.w (A0)+ 4658",
			init: 			cpuState{
				D:   [8]uint32{1046046719, 3075485823, 1765337134, 761980313, 3478404608, 2821595016, 3669789342, 3106226795},
				A:   [7]uint32{3777055464, 4284311145, 581717089, 1347148145, 170202216, 2383582991, 2919329773},
				PC:  5550046,
				SR:  8983,
				USP: 1340282,
				SSP: 15442552,
				RAM: [][2]uint32{{5550042, 70}, {5550043, 88}, {5550044, 15}, {5550045, 70}, {2181864, 210}, {2181865, 6}, {5550046, 104}, {5550047, 109}},
			},
			want: 			cpuState{
				D:   [8]uint32{1046046719, 3075485823, 1765337134, 761980313, 3478404608, 2821595016, 3669789342, 3106226795},
				A:   [7]uint32{3777055466, 4284311145, 581717089, 1347148145, 170202216, 2383582991, 2919329773},
				PC:  5550048,
				SR:  8976,
				USP: 1340282,
				SSP: 15442552,
				RAM: [][2]uint32{{5550042, 70}, {5550043, 88}, {5550044, 15}, {5550045, 70}, {2181864, 45}, {2181865, 249}, {5550046, 104}, {5550047, 109}},
				Cycles: 12,
			},
		},
		{
			name: "1093 NOT.w D4 4644",
			init: 			cpuState{
				D:   [8]uint32{187441860, 2249915332, 3490564490, 1319725659, 2327342264, 559103146, 1184076227, 3463506615},
				A:   [7]uint32{60665814, 1088332697, 3652749969, 2550135748, 1633252668, 1223462954, 1044099337},
				PC:  4877124,
				SR:  23,
				USP: 8895820,
				SSP: 7941520,
				RAM: [][2]uint32{{4877120, 70}, {4877121, 68}, {4877122, 126}, {4877123, 36}, {4877124, 161}, {4877125, 204}},
			},
			want: 			cpuState{
				D:   [8]uint32{187441860, 2249915332, 3490564490, 1319725659, 2327352135, 559103146, 1184076227, 3463506615},
				A:   [7]uint32{60665814, 1088332697, 3652749969, 2550135748, 1633252668, 1223462954, 1044099337},
				PC:  4877126,
				SR:  24,
				USP: 8895820,
				SSP: 7941520,
				RAM: [][2]uint32{{4877120, 70}, {4877121, 68}, {4877122, 126}, {4877123, 36}, {4877124, 161}, {4877125, 204}},
				Cycles: 4,
			},
		},
		{
			name: "1347 NOT.w (d16, A1) 4669",
			init: 			cpuState{
				D:   [8]uint32{1201394459, 1525139830, 2962127597, 1732635844, 643097973, 2677233645, 431257686, 3575751446},
				A:   [7]uint32{4288610349, 181374083, 2376006691, 1858884808, 574450399, 3230620378, 517383748},
				PC:  669918,
				SR:  1822,
				USP: 13609852,
				SSP: 4812310,
				RAM: [][2]uint32{{669914, 70}, {669915, 105}, {669916, 21}, {669917, 5}, {669918, 41}, {669919, 41}, {13607304, 63}, {13607305, 189}, {669920, 148}, {669921, 34}},
			},
			want: 			cpuState{
				D:   [8]uint32{1201394459, 1525139830, 2962127597, 1732635844, 643097973, 2677233645, 431257686, 3575751446},
				A:   [7]uint32{4288610349, 181374083, 2376006691, 1858884808, 574450399, 3230620378, 517383748},
				PC:  669922,
				SR:  1816,
				USP: 13609852,
				SSP: 4812310,
				RAM: [][2]uint32{{669914, 70}, {669915, 105}, {669916, 21}, {669917, 5}, {669918, 41}, {669919, 41}, {13607304, 192}, {13607305, 66}, {669920, 148}, {669921, 34}},
				Cycles: 16,
			},
		},
		{
			name: "1613 NOT.w (xxx).l 4679",
			init: 			cpuState{
				D:   [8]uint32{1857994917, 1000816945, 3008029770, 2862620719, 3192759169, 2467078389, 2571746519, 1572464917},
				A:   [7]uint32{354072857, 2795488296, 4150956904, 311850126, 3226256743, 2884929113, 624153082},
				PC:  1396494,
				SR:  1566,
				USP: 7902678,
				SSP: 321838,
				RAM: [][2]uint32{{1396490, 70}, {1396491, 121}, {1396492, 248}, {1396493, 68}, {1396494, 226}, {1396495, 220}, {1396496, 77}, {1396497, 7}, {4514524, 188}, {4514525, 150}, {1396498, 165}, {1396499, 147}},
			},
			want: 			cpuState{
				D:   [8]uint32{1857994917, 1000816945, 3008029770, 2862620719, 3192759169, 2467078389, 2571746519, 1572464917},
				A:   [7]uint32{354072857, 2795488296, 4150956904, 311850126, 3226256743, 2884929113, 624153082},
				PC:  1396500,
				SR:  1552,
				USP: 7902678,
				SSP: 321838,
				RAM: [][2]uint32{{1396490, 70}, {1396491, 121}, {1396492, 248}, {1396493, 68}, {1396494, 226}, {1396495, 220}, {1396496, 77}, {1396497, 7}, {4514524, 67}, {4514525, 105}, {1396498, 165}, {1396499, 147}},
				Cycles: 20,
			},
		},
		{
			name: "1925 NOT.w D7 4647",
			init: 			cpuState{
				D:   [8]uint32{2183357064, 1482141112, 4095858624, 2844884348, 2670307835, 2601706167, 1464694107, 3761420268},
				A:   [7]uint32{3422012185, 4282503213, 3380682109, 2191806891, 1207142704, 3296515398, 2857303191},
				PC:  2338120,
				SR:  9479,
				USP: 5188480,
				SSP: 9250806,
				RAM: [][2]uint32{{2338116, 70}, {2338117, 71}, {2338118, 81}, {2338119, 195}, {2338120, 98}, {2338121, 77}},
			},
			want: 			cpuState{
				D:   [8]uint32{2183357064, 1482141112, 4095858624, 2844884348, 2670307835, 2601706167, 1464694107, 3761391635},
				A:   [7]uint32{3422012185, 4282503213, 3380682109, 2191806891, 1207142704, 3296515398, 2857303191},
				PC:  2338122,
				SR:  9472,
				USP: 5188480,
				SSP: 9250806,
				RAM: [][2]uint32{{2338116, 70}, {2338117, 71}, {2338118, 81}, {2338119, 195}, {2338120, 98}, {2338121, 77}},
				Cycles: 4,
			},
		},
		{
			name: "2211 NOT.w D1 4641",
			init: 			cpuState{
				D:   [8]uint32{3799661277, 1476789228, 1287219493, 3982967197, 1212137094, 432431109, 3018646143, 3359732194},
				A:   [7]uint32{3354421183, 564089046, 40490513, 2031182047, 4083203712, 1461186474, 2222644489},
				PC:  13870776,
				SR:  8212,
				USP: 9313914,
				SSP: 7300658,
				RAM: [][2]uint32{{13870772, 70}, {13870773, 65}, {13870774, 200}, {13870775, 57}, {13870776, 184}, {13870777, 112}},
			},
			want: 			cpuState{
				D:   [8]uint32{3799661277, 1476852755, 1287219493, 3982967197, 1212137094, 432431109, 3018646143, 3359732194},
				A:   [7]uint32{3354421183, 564089046, 40490513, 2031182047, 4083203712, 1461186474, 2222644489},
				PC:  13870778,
				SR:  8216,
				USP: 9313914,
				SSP: 7300658,
				RAM: [][2]uint32{{13870772, 70}, {13870773, 65}, {13870774, 200}, {13870775, 57}, {13870776, 184}, {13870777, 112}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNOT_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NOT.l D3 4683",
			init: cpuState{
				D:   [8]uint32{1579703622, 3647245374, 2292136252, 3363501296, 975048880, 2710219579, 2788478342, 1692537478},
				A:   [7]uint32{3842939765, 1654006570, 2299450896, 1487660210, 1492052198, 388120030, 246633220},
				PC:  12744490,
				SR:  33809,
				USP: 1691832,
				SSP: 8065156,
				RAM: [][2]uint32{{12744486, 70}, {12744487, 131}, {12744488, 184}, {12744489, 93}, {12744490, 53}, {12744491, 94}},
			},
			want: cpuState{
				D:   [8]uint32{1579703622, 3647245374, 2292136252, 931465999, 975048880, 2710219579, 2788478342, 1692537478},
				A:   [7]uint32{3842939765, 1654006570, 2299450896, 1487660210, 1492052198, 388120030, 246633220},
				PC:  12744492,
				SR:  33808,
				USP: 1691832,
				SSP: 8065156,
				RAM: [][2]uint32{{12744486, 70}, {12744487, 131}, {12744488, 184}, {12744489, 93}, {12744490, 53}, {12744491, 94}},
				Cycles: 6,
			},
		},
		{
			name: "500 NOT.l (A2) 4692",
			init: cpuState{
				D:   [8]uint32{192301078, 2948703445, 405392927, 3815715779, 3107947918, 1428493185, 3070425277, 1644291674},
				A:   [7]uint32{1034226651, 2786674089, 3005748791, 2962399385, 315062157, 1162953816, 2843322573},
				PC:  8577512,
				SR:  793,
				USP: 14201130,
				SSP: 7394472,
				RAM: [][2]uint32{{8577508, 70}, {8577509, 146}, {8577510, 67}, {8577511, 246}, {12, 174}, {13, 64}, {14, 92}, {15, 88}, {4217944, 197}, {4217945, 94}, {4217946, 202}, {4217947, 38}},
			},
			want: cpuState{
				D:      [8]uint32{192301078, 2948703445, 405392927, 3815715779, 3107947918, 1428493185, 3070425277, 1644291674},
				A:      [7]uint32{1034226651, 2786674089, 3005748791, 2962399385, 315062157, 1162953816, 2843322573},
				PC:     2923453532,
				SR:     8985,
				USP:    14201130,
				SSP:    7394458,
				RAM:    [][2]uint32{{8577508, 70}, {8577509, 146}, {8577510, 67}, {8577511, 246}, {7394470, 225}, {7394471, 230}, {7394466, 3}, {7394467, 25}, {7394468, 0}, {7394469, 130}, {7394464, 70}, {7394465, 146}, {7394462, 22}, {7394463, 55}, {7394458, 70}, {7394459, 145}, {7394460, 179}, {7394461, 40}, {12, 174}, {13, 64}, {14, 92}, {15, 88}, {4217944, 197}, {4217945, 94}, {4217946, 202}, {4217947, 38}},
				Halted: true,
			},
		},
		{
			name: "1000 NOT.l (d8, A7, Xn) 46b7",
			init: cpuState{
				D:   [8]uint32{4078624384, 1775144042, 569850184, 120493339, 3032376800, 588667469, 2282814542, 3888968914},
				A:   [7]uint32{3020906940, 3590003320, 2511113187, 2240151022, 11916609, 3860574581, 2149604097},
				PC:  13251496,
				SR:  9479,
				USP: 7215508,
				SSP: 11859574,
				RAM: [][2]uint32{{13251492, 70}, {13251493, 183}, {13251494, 207}, {13251495, 233}, {13251496, 20}, {13251497, 252}, {6998944, 181}, {6998945, 32}, {6998946, 54}, {6998947, 112}, {13251498, 58}, {13251499, 148}},
			},
			want: cpuState{
				D:   [8]uint32{4078624384, 1775144042, 569850184, 120493339, 3032376800, 588667469, 2282814542, 3888968914},
				A:   [7]uint32{3020906940, 3590003320, 2511113187, 2240151022, 11916609, 3860574581, 2149604097},
				PC:  13251500,
				SR:  9472,
				USP: 7215508,
				SSP: 11859574,
				RAM: [][2]uint32{{13251492, 70}, {13251493, 183}, {13251494, 207}, {13251495, 233}, {13251496, 20}, {13251497, 252}, {6998944, 74}, {6998945, 223}, {6998946, 201}, {6998947, 143}, {13251498, 58}, {13251499, 148}},
				Cycles: 26,
			},
		},
		{
			name: "1500 NOT.l (A6) 4696",
			init: cpuState{
				D:   [8]uint32{4081936339, 4069507926, 1874594715, 1865287255, 350619463, 161588247, 1080397321, 2517967424},
				A:   [7]uint32{3125674736, 847717005, 2155872764, 1081452602, 3603653779, 4046519233, 2881300326},
				PC:  6545778,
				SR:  34582,
				USP: 8167478,
				SSP: 4304042,
				RAM: [][2]uint32{{6545774, 70}, {6545775, 150}, {6545776, 35}, {6545777, 207}, {12396390, 68}, {12396391, 245}, {12396392, 58}, {12396393, 151}, {6545778, 165}, {6545779, 128}},
			},
			want: cpuState{
				D:   [8]uint32{4081936339, 4069507926, 1874594715, 1865287255, 350619463, 161588247, 1080397321, 2517967424},
				A:   [7]uint32{3125674736, 847717005, 2155872764, 1081452602, 3603653779, 4046519233, 2881300326},
				PC:  6545780,
				SR:  34584,
				USP: 8167478,
				SSP: 4304042,
				RAM: [][2]uint32{{6545774, 70}, {6545775, 150}, {6545776, 35}, {6545777, 207}, {12396390, 187}, {12396391, 10}, {12396392, 197}, {12396393, 104}, {6545778, 165}, {6545779, 128}},
				Cycles: 20,
			},
		},
		{
			name: "2000 NOT.l (d8, A2, Xn) 46b2",
			init: cpuState{
				D:   [8]uint32{381479299, 451667966, 3313824343, 347120840, 879128643, 2699068407, 481463158, 1582036580},
				A:   [7]uint32{4217085327, 3405869801, 2102970531, 2941082323, 1480740376, 2902449545, 1465970804},
				PC:  15739264,
				SR:  42011,
				USP: 665046,
				SSP: 14376736,
				RAM: [][2]uint32{{15739260, 70}, {15739261, 178}, {15739262, 38}, {15739263, 67}, {15739264, 37}, {15739265, 3}, {12, 12}, {13, 0}, {14, 173}, {15, 42}, {44330, 235}, {44331, 85}, {44332, 255}, {44333, 208}},
			},
			want: cpuState{
				D:      [8]uint32{381479299, 451667966, 3313824343, 347120840, 879128643, 2699068407, 481463158, 1582036580},
				A:      [7]uint32{4217085327, 3405869801, 2102970531, 2941082323, 1480740376, 2902449545, 1465970804},
				PC:     201370926,
				SR:     9243,
				USP:    665046,
				SSP:    14376722,
				RAM:    [][2]uint32{{15739260, 70}, {15739261, 178}, {15739262, 38}, {15739263, 67}, {15739264, 37}, {15739265, 3}, {14376734, 41}, {14376735, 126}, {14376730, 164}, {14376731, 27}, {14376732, 0}, {14376733, 240}, {14376728, 70}, {14376729, 178}, {14376726, 187}, {14376727, 61}, {14376722, 70}, {14376723, 181}, {14376724, 125}, {14376725, 88}, {12, 12}, {13, 0}, {14, 173}, {15, 42}, {44330, 235}, {44331, 85}, {44332, 255}, {44333, 208}},
				Halted: true,
			},
		},
		{
			name: "001 NOT.l -(A3) 46a3",
			init: 			cpuState{
				D:   [8]uint32{2963322326, 3650610547, 1705422536, 1071666542, 2912974029, 2829673802, 2232729176, 2042224980},
				A:   [7]uint32{1655357896, 2414107260, 1732286624, 670619986, 4171316760, 2538295677, 3173010789},
				PC:  2627290,
				SR:  1820,
				USP: 15691190,
				SSP: 11095348,
				RAM: [][2]uint32{{2627286, 70}, {2627287, 163}, {2627288, 111}, {2627289, 179}, {16308558, 219}, {16308559, 234}, {16308560, 151}, {16308561, 238}, {2627290, 124}, {2627291, 233}},
			},
			want: 			cpuState{
				D:   [8]uint32{2963322326, 3650610547, 1705422536, 1071666542, 2912974029, 2829673802, 2232729176, 2042224980},
				A:   [7]uint32{1655357896, 2414107260, 1732286624, 670619982, 4171316760, 2538295677, 3173010789},
				PC:  2627292,
				SR:  1808,
				USP: 15691190,
				SSP: 11095348,
				RAM: [][2]uint32{{2627286, 70}, {2627287, 163}, {2627288, 111}, {2627289, 179}, {16308558, 36}, {16308559, 21}, {16308560, 104}, {16308561, 17}, {2627290, 124}, {2627291, 233}},
				Cycles: 22,
			},
		},
		{
			name: "289 NOT.l (d8, A7, Xn) 46b7",
			init: 			cpuState{
				D:   [8]uint32{1426436147, 3262180424, 2591565394, 414134861, 2206014493, 82730167, 3793286266, 2206146657},
				A:   [7]uint32{1445492655, 1083981906, 1843956433, 4256464188, 389718881, 3815494439, 1097208116},
				PC:  3410430,
				SR:  789,
				USP: 11936620,
				SSP: 9125874,
				RAM: [][2]uint32{{3410426, 70}, {3410427, 183}, {3410428, 137}, {3410429, 107}, {3410430, 103}, {3410431, 93}, {14588806, 6}, {14588807, 177}, {14588808, 94}, {14588809, 136}, {3410432, 187}, {3410433, 79}},
			},
			want: 			cpuState{
				D:   [8]uint32{1426436147, 3262180424, 2591565394, 414134861, 2206014493, 82730167, 3793286266, 2206146657},
				A:   [7]uint32{1445492655, 1083981906, 1843956433, 4256464188, 389718881, 3815494439, 1097208116},
				PC:  3410434,
				SR:  792,
				USP: 11936620,
				SSP: 9125874,
				RAM: [][2]uint32{{3410426, 70}, {3410427, 183}, {3410428, 137}, {3410429, 107}, {3410430, 103}, {3410431, 93}, {14588806, 249}, {14588807, 78}, {14588808, 161}, {14588809, 119}, {3410432, 187}, {3410433, 79}},
				Cycles: 26,
			},
		},
		{
			name: "522 NOT.l (A3) 4693",
			init: 			cpuState{
				D:   [8]uint32{1117474648, 2749039822, 3312054604, 2302261925, 753471296, 3636430508, 1823770665, 208938135},
				A:   [7]uint32{415874724, 4162209668, 3476162052, 1927354586, 2844569850, 883926687, 1354382907},
				PC:  9000752,
				SR:  778,
				USP: 16338644,
				SSP: 13796658,
				RAM: [][2]uint32{{9000748, 70}, {9000749, 147}, {9000750, 182}, {9000751, 166}, {14751962, 107}, {14751963, 160}, {14751964, 134}, {14751965, 156}, {9000752, 95}, {9000753, 45}},
			},
			want: 			cpuState{
				D:   [8]uint32{1117474648, 2749039822, 3312054604, 2302261925, 753471296, 3636430508, 1823770665, 208938135},
				A:   [7]uint32{415874724, 4162209668, 3476162052, 1927354586, 2844569850, 883926687, 1354382907},
				PC:  9000754,
				SR:  776,
				USP: 16338644,
				SSP: 13796658,
				RAM: [][2]uint32{{9000748, 70}, {9000749, 147}, {9000750, 182}, {9000751, 166}, {14751962, 148}, {14751963, 95}, {14751964, 121}, {14751965, 99}, {9000752, 95}, {9000753, 45}},
				Cycles: 20,
			},
		},
		{
			name: "779 NOT.l (A5) 4695",
			init: 			cpuState{
				D:   [8]uint32{4242061955, 1885427430, 1982482500, 172050477, 3166227210, 1705621347, 1099903051, 148066837},
				A:   [7]uint32{1843916029, 2195860916, 2184249050, 3204985947, 2797830439, 1064272590, 927044680},
				PC:  780242,
				SR:  1556,
				USP: 9764516,
				SSP: 12391874,
				RAM: [][2]uint32{{780238, 70}, {780239, 149}, {780240, 208}, {780241, 103}, {7307982, 76}, {7307983, 197}, {7307984, 21}, {7307985, 20}, {780242, 136}, {780243, 37}},
			},
			want: 			cpuState{
				D:   [8]uint32{4242061955, 1885427430, 1982482500, 172050477, 3166227210, 1705621347, 1099903051, 148066837},
				A:   [7]uint32{1843916029, 2195860916, 2184249050, 3204985947, 2797830439, 1064272590, 927044680},
				PC:  780244,
				SR:  1560,
				USP: 9764516,
				SSP: 12391874,
				RAM: [][2]uint32{{780238, 70}, {780239, 149}, {780240, 208}, {780241, 103}, {7307982, 179}, {7307983, 58}, {7307984, 234}, {7307985, 235}, {780242, 136}, {780243, 37}},
				Cycles: 20,
			},
		},
		{
			name: "1060 NOT.l (A3) 4693",
			init: 			cpuState{
				D:   [8]uint32{1662186281, 290882559, 4239867302, 1719314149, 3134596439, 2472492718, 2017133851, 973962780},
				A:   [7]uint32{3744393888, 3884523653, 3233280612, 3916079734, 4011631680, 1465201082, 1350884824},
				PC:  16646416,
				SR:  1555,
				USP: 9708184,
				SSP: 14039406,
				RAM: [][2]uint32{{16646412, 70}, {16646413, 147}, {16646414, 123}, {16646415, 96}, {6988406, 28}, {6988407, 182}, {6988408, 66}, {6988409, 170}, {16646416, 204}, {16646417, 40}},
			},
			want: 			cpuState{
				D:   [8]uint32{1662186281, 290882559, 4239867302, 1719314149, 3134596439, 2472492718, 2017133851, 973962780},
				A:   [7]uint32{3744393888, 3884523653, 3233280612, 3916079734, 4011631680, 1465201082, 1350884824},
				PC:  16646418,
				SR:  1560,
				USP: 9708184,
				SSP: 14039406,
				RAM: [][2]uint32{{16646412, 70}, {16646413, 147}, {16646414, 123}, {16646415, 96}, {6988406, 227}, {6988407, 73}, {6988408, 189}, {6988409, 85}, {16646416, 204}, {16646417, 40}},
				Cycles: 20,
			},
		},
		{
			name: "1358 NOT.l -(A3) 46a3",
			init: 			cpuState{
				D:   [8]uint32{1282020183, 1542525821, 3372899108, 2517980075, 2805694254, 640077020, 1362015666, 3580371671},
				A:   [7]uint32{4038257035, 3097053512, 2070983841, 2853678392, 74840170, 1051006495, 2336633153},
				PC:  2474290,
				SR:  1289,
				USP: 897272,
				SSP: 2003698,
				RAM: [][2]uint32{{2474286, 70}, {2474287, 163}, {2474288, 46}, {2474289, 127}, {1551668, 116}, {1551669, 72}, {1551670, 56}, {1551671, 228}, {2474290, 157}, {2474291, 111}},
			},
			want: 			cpuState{
				D:   [8]uint32{1282020183, 1542525821, 3372899108, 2517980075, 2805694254, 640077020, 1362015666, 3580371671},
				A:   [7]uint32{4038257035, 3097053512, 2070983841, 2853678388, 74840170, 1051006495, 2336633153},
				PC:  2474292,
				SR:  1288,
				USP: 897272,
				SSP: 2003698,
				RAM: [][2]uint32{{2474286, 70}, {2474287, 163}, {2474288, 46}, {2474289, 127}, {1551668, 139}, {1551669, 183}, {1551670, 199}, {1551671, 27}, {2474290, 157}, {2474291, 111}},
				Cycles: 22,
			},
		},
		{
			name: "1647 NOT.l (A1)+ 4699",
			init: 			cpuState{
				D:   [8]uint32{196783273, 1710519142, 3977583279, 1771149331, 1622343677, 2457347614, 3134655124, 871640640},
				A:   [7]uint32{2077256600, 3689832642, 2388778297, 1650816732, 1128593446, 2005803169, 3441925068},
				PC:  6357346,
				SR:  268,
				USP: 3215314,
				SSP: 15547140,
				RAM: [][2]uint32{{6357342, 70}, {6357343, 153}, {6357344, 36}, {6357345, 86}, {15622338, 23}, {15622339, 227}, {15622340, 55}, {15622341, 74}, {6357346, 153}, {6357347, 57}},
			},
			want: 			cpuState{
				D:   [8]uint32{196783273, 1710519142, 3977583279, 1771149331, 1622343677, 2457347614, 3134655124, 871640640},
				A:   [7]uint32{2077256600, 3689832646, 2388778297, 1650816732, 1128593446, 2005803169, 3441925068},
				PC:  6357348,
				SR:  264,
				USP: 3215314,
				SSP: 15547140,
				RAM: [][2]uint32{{6357342, 70}, {6357343, 153}, {6357344, 36}, {6357345, 86}, {15622338, 232}, {15622339, 28}, {15622340, 200}, {15622341, 181}, {6357346, 153}, {6357347, 57}},
				Cycles: 20,
			},
		},
		{
			name: "1945 NOT.l (A1) 4691",
			init: 			cpuState{
				D:   [8]uint32{1015400964, 2604302939, 1778537808, 1737418975, 707994719, 2871976062, 3209991, 3223721677},
				A:   [7]uint32{3018053410, 1832358394, 1158757186, 2869451267, 2984695803, 1292776053, 2793030841},
				PC:  14076952,
				SR:  1300,
				USP: 5643960,
				SSP: 13145328,
				RAM: [][2]uint32{{14076948, 70}, {14076949, 145}, {14076950, 163}, {14076951, 246}, {3641850, 20}, {3641851, 183}, {3641852, 117}, {3641853, 217}, {14076952, 134}, {14076953, 94}},
			},
			want: 			cpuState{
				D:   [8]uint32{1015400964, 2604302939, 1778537808, 1737418975, 707994719, 2871976062, 3209991, 3223721677},
				A:   [7]uint32{3018053410, 1832358394, 1158757186, 2869451267, 2984695803, 1292776053, 2793030841},
				PC:  14076954,
				SR:  1304,
				USP: 5643960,
				SSP: 13145328,
				RAM: [][2]uint32{{14076948, 70}, {14076949, 145}, {14076950, 163}, {14076951, 246}, {3641850, 235}, {3641851, 72}, {3641852, 138}, {3641853, 38}, {14076952, 134}, {14076953, 94}},
				Cycles: 20,
			},
		},
		{
			name: "2211 NOT.l D5 4685",
			init: 			cpuState{
				D:   [8]uint32{3882170229, 2647230378, 154384153, 3360912532, 1246406553, 3125321005, 1158648772, 2087600608},
				A:   [7]uint32{3398431058, 4266605577, 830332912, 2472876938, 998551045, 1807546605, 1048158259},
				PC:  7307606,
				SR:  1042,
				USP: 2894388,
				SSP: 8572028,
				RAM: [][2]uint32{{7307602, 70}, {7307603, 133}, {7307604, 189}, {7307605, 48}, {7307606, 34}, {7307607, 2}},
			},
			want: 			cpuState{
				D:   [8]uint32{3882170229, 2647230378, 154384153, 3360912532, 1246406553, 1169646290, 1158648772, 2087600608},
				A:   [7]uint32{3398431058, 4266605577, 830332912, 2472876938, 998551045, 1807546605, 1048158259},
				PC:  7307608,
				SR:  1040,
				USP: 2894388,
				SSP: 8572028,
				RAM: [][2]uint32{{7307602, 70}, {7307603, 133}, {7307604, 189}, {7307605, 48}, {7307606, 34}, {7307607, 2}},
				Cycles: 6,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTST_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TST.b D5 4a05",
			init: cpuState{
				D:   [8]uint32{846714821, 646404932, 3022754438, 2410866885, 3580684883, 1697763789, 3779951095, 1665669656},
				A:   [7]uint32{3887929160, 2583917214, 2491831459, 3744447675, 462312535, 3262836416, 1146829190},
				PC:  15316282,
				SR:  8718,
				USP: 9280610,
				SSP: 3889344,
				RAM: [][2]uint32{{15316278, 74}, {15316279, 5}, {15316280, 48}, {15316281, 62}, {15316282, 118}, {15316283, 242}},
			},
			want: cpuState{
				D:   [8]uint32{846714821, 646404932, 3022754438, 2410866885, 3580684883, 1697763789, 3779951095, 1665669656},
				A:   [7]uint32{3887929160, 2583917214, 2491831459, 3744447675, 462312535, 3262836416, 1146829190},
				PC:  15316284,
				SR:  8712,
				USP: 9280610,
				SSP: 3889344,
				RAM: [][2]uint32{{15316278, 74}, {15316279, 5}, {15316280, 48}, {15316281, 62}, {15316282, 118}, {15316283, 242}},
				Cycles: 4,
			},
		},
		{
			name: "500 TST.b -(A6) 4a26",
			init: cpuState{
				D:   [8]uint32{2050499491, 1622638113, 237943403, 2863009495, 794908350, 3552023109, 2456849696, 4099111455},
				A:   [7]uint32{129545788, 2710872769, 1081044753, 339385425, 1059403425, 3035601736, 334115886},
				PC:  11264872,
				SR:  34055,
				USP: 125196,
				SSP: 5476072,
				RAM: [][2]uint32{{11264868, 74}, {11264869, 38}, {11264870, 59}, {11264871, 207}, {15348780, 228}, {15348781, 82}, {11264872, 105}, {11264873, 156}},
			},
			want: cpuState{
				D:   [8]uint32{2050499491, 1622638113, 237943403, 2863009495, 794908350, 3552023109, 2456849696, 4099111455},
				A:   [7]uint32{129545788, 2710872769, 1081044753, 339385425, 1059403425, 3035601736, 334115885},
				PC:  11264874,
				SR:  34048,
				USP: 125196,
				SSP: 5476072,
				RAM: [][2]uint32{{11264868, 74}, {11264869, 38}, {11264870, 59}, {11264871, 207}, {15348780, 228}, {15348781, 82}, {11264872, 105}, {11264873, 156}},
				Cycles: 10,
			},
		},
		{
			name: "1000 TST.b (A5)+ 4a1d",
			init: cpuState{
				D:   [8]uint32{1326270302, 138193945, 3769916709, 620890219, 2923938314, 3686239656, 2510371410, 3120738069},
				A:   [7]uint32{2076284935, 2779000921, 412437247, 2209445082, 4145007600, 1518305186, 2896579074},
				PC:  15505346,
				SR:  9742,
				USP: 3784902,
				SSP: 3788088,
				RAM: [][2]uint32{{15505342, 74}, {15505343, 29}, {15505344, 223}, {15505345, 3}, {8355746, 33}, {8355747, 244}, {15505346, 189}, {15505347, 124}},
			},
			want: cpuState{
				D:   [8]uint32{1326270302, 138193945, 3769916709, 620890219, 2923938314, 3686239656, 2510371410, 3120738069},
				A:   [7]uint32{2076284935, 2779000921, 412437247, 2209445082, 4145007600, 1518305187, 2896579074},
				PC:  15505348,
				SR:  9728,
				USP: 3784902,
				SSP: 3788088,
				RAM: [][2]uint32{{15505342, 74}, {15505343, 29}, {15505344, 223}, {15505345, 3}, {8355746, 33}, {8355747, 244}, {15505346, 189}, {15505347, 124}},
				Cycles: 8,
			},
		},
		{
			name: "1500 TST.b D0 4a00",
			init: cpuState{
				D:   [8]uint32{959543294, 2198274938, 921019127, 4185072736, 3645082287, 3659424624, 3093861902, 573260461},
				A:   [7]uint32{3367038132, 3293938994, 1220462862, 164509657, 1300226975, 488025081, 1212909862},
				PC:  11210204,
				SR:  41490,
				USP: 6533690,
				SSP: 15604696,
				RAM: [][2]uint32{{11210200, 74}, {11210201, 0}, {11210202, 231}, {11210203, 208}, {11210204, 123}, {11210205, 178}},
			},
			want: cpuState{
				D:   [8]uint32{959543294, 2198274938, 921019127, 4185072736, 3645082287, 3659424624, 3093861902, 573260461},
				A:   [7]uint32{3367038132, 3293938994, 1220462862, 164509657, 1300226975, 488025081, 1212909862},
				PC:  11210206,
				SR:  41496,
				USP: 6533690,
				SSP: 15604696,
				RAM: [][2]uint32{{11210200, 74}, {11210201, 0}, {11210202, 231}, {11210203, 208}, {11210204, 123}, {11210205, 178}},
				Cycles: 4,
			},
		},
		{
			name: "2000 TST.b -(A4) 4a24",
			init: cpuState{
				D:   [8]uint32{4012376908, 819470209, 3495364337, 178943219, 312725095, 3576633512, 2941929555, 4223042332},
				A:   [7]uint32{4146844344, 1255422383, 688730124, 2660413563, 2089104047, 1594422682, 319763238},
				PC:  7585610,
				SR:  9728,
				USP: 3224694,
				SSP: 15159150,
				RAM: [][2]uint32{{7585606, 74}, {7585607, 36}, {7585608, 176}, {7585609, 195}, {8729262, 173}, {8729263, 7}, {7585610, 44}, {7585611, 143}},
			},
			want: cpuState{
				D:   [8]uint32{4012376908, 819470209, 3495364337, 178943219, 312725095, 3576633512, 2941929555, 4223042332},
				A:   [7]uint32{4146844344, 1255422383, 688730124, 2660413563, 2089104046, 1594422682, 319763238},
				PC:  7585612,
				SR:  9736,
				USP: 3224694,
				SSP: 15159150,
				RAM: [][2]uint32{{7585606, 74}, {7585607, 36}, {7585608, 176}, {7585609, 195}, {8729262, 173}, {8729263, 7}, {7585610, 44}, {7585611, 143}},
				Cycles: 10,
			},
		},
		{
			name: "001 TST.b D3 4a03",
			init: 			cpuState{
				D:   [8]uint32{3653478192, 4270069338, 3021428198, 996370356, 706472226, 4081505101, 939363309, 1390247191},
				A:   [7]uint32{375600615, 3947954587, 460293041, 2091232588, 1569275036, 1288948268, 629785221},
				PC:  1852530,
				SR:  1559,
				USP: 4966152,
				SSP: 15634576,
				RAM: [][2]uint32{{1852526, 74}, {1852527, 3}, {1852528, 8}, {1852529, 235}, {1852530, 109}, {1852531, 218}},
			},
			want: 			cpuState{
				D:   [8]uint32{3653478192, 4270069338, 3021428198, 996370356, 706472226, 4081505101, 939363309, 1390247191},
				A:   [7]uint32{375600615, 3947954587, 460293041, 2091232588, 1569275036, 1288948268, 629785221},
				PC:  1852532,
				SR:  1560,
				USP: 4966152,
				SSP: 15634576,
				RAM: [][2]uint32{{1852526, 74}, {1852527, 3}, {1852528, 8}, {1852529, 235}, {1852530, 109}, {1852531, 218}},
				Cycles: 4,
			},
		},
		{
			name: "283 TST.b (A3) 4a13",
			init: 			cpuState{
				D:   [8]uint32{533805454, 51696866, 1909752402, 1116181448, 1389124202, 2267028560, 3089081174, 469243444},
				A:   [7]uint32{1175054005, 2851508263, 335832088, 48091617, 865043441, 1736903901, 1123938659},
				PC:  12231502,
				SR:  785,
				USP: 5745346,
				SSP: 15252404,
				RAM: [][2]uint32{{12231498, 74}, {12231499, 19}, {12231500, 198}, {12231501, 127}, {14537184, 56}, {14537185, 157}, {12231502, 158}, {12231503, 174}},
			},
			want: 			cpuState{
				D:   [8]uint32{533805454, 51696866, 1909752402, 1116181448, 1389124202, 2267028560, 3089081174, 469243444},
				A:   [7]uint32{1175054005, 2851508263, 335832088, 48091617, 865043441, 1736903901, 1123938659},
				PC:  12231504,
				SR:  792,
				USP: 5745346,
				SSP: 15252404,
				RAM: [][2]uint32{{12231498, 74}, {12231499, 19}, {12231500, 198}, {12231501, 127}, {14537184, 56}, {14537185, 157}, {12231502, 158}, {12231503, 174}},
				Cycles: 8,
			},
		},
		{
			name: "567 TST.b (A0) 4a10",
			init: 			cpuState{
				D:   [8]uint32{3456337188, 736467844, 66639333, 241629459, 1319263542, 1139072065, 2888774674, 1662231553},
				A:   [7]uint32{3165474155, 1021515973, 2776950293, 1711053147, 1371909641, 74106328, 3649215991},
				PC:  3826376,
				SR:  1799,
				USP: 13338120,
				SSP: 15348522,
				RAM: [][2]uint32{{3826372, 74}, {3826373, 16}, {3826374, 155}, {3826375, 214}, {11357546, 129}, {11357547, 190}, {3826376, 135}, {3826377, 162}},
			},
			want: 			cpuState{
				D:   [8]uint32{3456337188, 736467844, 66639333, 241629459, 1319263542, 1139072065, 2888774674, 1662231553},
				A:   [7]uint32{3165474155, 1021515973, 2776950293, 1711053147, 1371909641, 74106328, 3649215991},
				PC:  3826378,
				SR:  1800,
				USP: 13338120,
				SSP: 15348522,
				RAM: [][2]uint32{{3826372, 74}, {3826373, 16}, {3826374, 155}, {3826375, 214}, {11357546, 129}, {11357547, 190}, {3826376, 135}, {3826377, 162}},
				Cycles: 8,
			},
		},
		{
			name: "835 TST.b -(A6) 4a26",
			init: 			cpuState{
				D:   [8]uint32{3534361009, 1852050150, 1545199600, 3610156393, 1373105701, 4276796846, 3350250122, 2987984206},
				A:   [7]uint32{252559590, 2179635922, 3974263602, 2346837341, 2974299986, 3534365925, 3659052220},
				PC:  13005180,
				SR:  1817,
				USP: 2837536,
				SSP: 10698348,
				RAM: [][2]uint32{{13005176, 74}, {13005177, 38}, {13005178, 193}, {13005179, 27}, {1619130, 20}, {1619131, 198}, {13005180, 240}, {13005181, 6}},
			},
			want: 			cpuState{
				D:   [8]uint32{3534361009, 1852050150, 1545199600, 3610156393, 1373105701, 4276796846, 3350250122, 2987984206},
				A:   [7]uint32{252559590, 2179635922, 3974263602, 2346837341, 2974299986, 3534365925, 3659052219},
				PC:  13005182,
				SR:  1816,
				USP: 2837536,
				SSP: 10698348,
				RAM: [][2]uint32{{13005176, 74}, {13005177, 38}, {13005178, 193}, {13005179, 27}, {1619130, 20}, {1619131, 198}, {13005180, 240}, {13005181, 6}},
				Cycles: 10,
			},
		},
		{
			name: "1094 TST.b (A7) 4a17",
			init: 			cpuState{
				D:   [8]uint32{675528556, 1791224675, 1671213289, 993595073, 3697312177, 1879457483, 3484970306, 3026723006},
				A:   [7]uint32{1336816926, 2163773605, 3682497991, 2462089130, 2144928436, 727103210, 4128839660},
				PC:  9595432,
				SR:  768,
				USP: 1802550,
				SSP: 14204446,
				RAM: [][2]uint32{{9595428, 74}, {9595429, 23}, {9595430, 157}, {9595431, 38}, {1802550, 116}, {1802551, 193}, {9595432, 72}, {9595433, 226}},
			},
			want: 			cpuState{
				D:   [8]uint32{675528556, 1791224675, 1671213289, 993595073, 3697312177, 1879457483, 3484970306, 3026723006},
				A:   [7]uint32{1336816926, 2163773605, 3682497991, 2462089130, 2144928436, 727103210, 4128839660},
				PC:  9595434,
				SR:  768,
				USP: 1802550,
				SSP: 14204446,
				RAM: [][2]uint32{{9595428, 74}, {9595429, 23}, {9595430, 157}, {9595431, 38}, {1802550, 116}, {1802551, 193}, {9595432, 72}, {9595433, 226}},
				Cycles: 8,
			},
		},
		{
			name: "1375 TST.b (d16, A2) 4a2a",
			init: 			cpuState{
				D:   [8]uint32{3954221867, 1087723797, 2967875236, 1052364992, 4251851620, 1551713191, 148505678, 3943282906},
				A:   [7]uint32{1188084660, 3581185812, 3022351063, 382070601, 2504601525, 4166707914, 2213354363},
				PC:  2504024,
				SR:  1288,
				USP: 16671332,
				SSP: 16740796,
				RAM: [][2]uint32{{2504020, 74}, {2504021, 42}, {2504022, 101}, {2504023, 65}, {2504024, 232}, {2504025, 66}, {2478104, 144}, {2478105, 241}, {2504026, 178}, {2504027, 192}},
			},
			want: 			cpuState{
				D:   [8]uint32{3954221867, 1087723797, 2967875236, 1052364992, 4251851620, 1551713191, 148505678, 3943282906},
				A:   [7]uint32{1188084660, 3581185812, 3022351063, 382070601, 2504601525, 4166707914, 2213354363},
				PC:  2504028,
				SR:  1288,
				USP: 16671332,
				SSP: 16740796,
				RAM: [][2]uint32{{2504020, 74}, {2504021, 42}, {2504022, 101}, {2504023, 65}, {2504024, 232}, {2504025, 66}, {2478104, 144}, {2478105, 241}, {2504026, 178}, {2504027, 192}},
				Cycles: 12,
			},
		},
		{
			name: "1663 TST.b -(A3) 4a23",
			init: 			cpuState{
				D:   [8]uint32{2842733465, 1464015047, 3875135208, 3987032264, 868789884, 1466613721, 2971852224, 3895342601},
				A:   [7]uint32{2755787511, 751434407, 1234758962, 3054557614, 2262958587, 2368427898, 4289815975},
				PC:  8320578,
				SR:  1542,
				USP: 16686902,
				SSP: 11022538,
				RAM: [][2]uint32{{8320574, 74}, {8320575, 35}, {8320576, 179}, {8320577, 214}, {1104300, 210}, {1104301, 196}, {8320578, 233}, {8320579, 64}},
			},
			want: 			cpuState{
				D:   [8]uint32{2842733465, 1464015047, 3875135208, 3987032264, 868789884, 1466613721, 2971852224, 3895342601},
				A:   [7]uint32{2755787511, 751434407, 1234758962, 3054557613, 2262958587, 2368427898, 4289815975},
				PC:  8320580,
				SR:  1544,
				USP: 16686902,
				SSP: 11022538,
				RAM: [][2]uint32{{8320574, 74}, {8320575, 35}, {8320576, 179}, {8320577, 214}, {1104300, 210}, {1104301, 196}, {8320578, 233}, {8320579, 64}},
				Cycles: 10,
			},
		},
		{
			name: "1926 TST.b (d8, A1, Xn) 4a31",
			init: 			cpuState{
				D:   [8]uint32{2175988422, 4291947481, 3914101489, 2818632996, 512639861, 1958521069, 609043101, 1607096249},
				A:   [7]uint32{4120425062, 3388871629, 3009131203, 1258557391, 407335155, 3554223949, 325609413},
				PC:  8763896,
				SR:  9238,
				USP: 8624204,
				SSP: 7098780,
				RAM: [][2]uint32{{8763892, 74}, {8763893, 49}, {8763894, 0}, {8763895, 17}, {8763896, 251}, {8763897, 145}, {16647844, 153}, {16647845, 82}, {8763898, 81}, {8763899, 45}},
			},
			want: 			cpuState{
				D:   [8]uint32{2175988422, 4291947481, 3914101489, 2818632996, 512639861, 1958521069, 609043101, 1607096249},
				A:   [7]uint32{4120425062, 3388871629, 3009131203, 1258557391, 407335155, 3554223949, 325609413},
				PC:  8763900,
				SR:  9240,
				USP: 8624204,
				SSP: 7098780,
				RAM: [][2]uint32{{8763892, 74}, {8763893, 49}, {8763894, 0}, {8763895, 17}, {8763896, 251}, {8763897, 145}, {16647844, 153}, {16647845, 82}, {8763898, 81}, {8763899, 45}},
				Cycles: 14,
			},
		},
		{
			name: "2232 TST.b -(A7) 4a27",
			init: 			cpuState{
				D:   [8]uint32{42625912, 1519012041, 1623649786, 4068874560, 3192101850, 2526301231, 1250705667, 2595662391},
				A:   [7]uint32{2346194571, 3800241088, 1486507406, 1130238615, 773009000, 2475556094, 2219684288},
				PC:  8073312,
				SR:  8470,
				USP: 261390,
				SSP: 5005866,
				RAM: [][2]uint32{{8073308, 74}, {8073309, 39}, {8073310, 148}, {8073311, 111}, {5005864, 206}, {5005865, 186}, {8073312, 125}, {8073313, 18}},
			},
			want: 			cpuState{
				D:   [8]uint32{42625912, 1519012041, 1623649786, 4068874560, 3192101850, 2526301231, 1250705667, 2595662391},
				A:   [7]uint32{2346194571, 3800241088, 1486507406, 1130238615, 773009000, 2475556094, 2219684288},
				PC:  8073314,
				SR:  8472,
				USP: 261390,
				SSP: 5005864,
				RAM: [][2]uint32{{8073308, 74}, {8073309, 39}, {8073310, 148}, {8073311, 111}, {5005864, 206}, {5005865, 186}, {8073312, 125}, {8073313, 18}},
				Cycles: 10,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTST_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TST.w -(A3) 4a63",
			init: cpuState{
				D:   [8]uint32{2608745888, 650933816, 1727878412, 877554046, 3158028444, 1391447430, 3774481428, 3624241845},
				A:   [7]uint32{4207237481, 1039397942, 1154057725, 3728533086, 3565609677, 2848513006, 2484841022},
				PC:  2419882,
				SR:  8972,
				USP: 12356562,
				SSP: 15882620,
				RAM: [][2]uint32{{2419878, 74}, {2419879, 99}, {2419880, 238}, {2419881, 146}, {3991132, 168}, {3991133, 196}, {2419882, 123}, {2419883, 214}},
			},
			want: cpuState{
				D:   [8]uint32{2608745888, 650933816, 1727878412, 877554046, 3158028444, 1391447430, 3774481428, 3624241845},
				A:   [7]uint32{4207237481, 1039397942, 1154057725, 3728533084, 3565609677, 2848513006, 2484841022},
				PC:  2419884,
				SR:  8968,
				USP: 12356562,
				SSP: 15882620,
				RAM: [][2]uint32{{2419878, 74}, {2419879, 99}, {2419880, 238}, {2419881, 146}, {3991132, 168}, {3991133, 196}, {2419882, 123}, {2419883, 214}},
				Cycles: 10,
			},
		},
		{
			name: "500 TST.w (A6)+ 4a5e",
			init: cpuState{
				D:   [8]uint32{3585410267, 2512736982, 1776797516, 1232310018, 3804110970, 298421658, 1432006706, 593847971},
				A:   [7]uint32{1325917020, 2919848112, 3929573053, 2669685500, 2287110912, 548091140, 2908348528},
				PC:  15951730,
				SR:  1557,
				USP: 7349708,
				SSP: 10880578,
				RAM: [][2]uint32{{15951726, 74}, {15951727, 94}, {15951728, 188}, {15951729, 236}, {5890160, 128}, {5890161, 71}, {15951730, 198}, {15951731, 221}},
			},
			want: cpuState{
				D:   [8]uint32{3585410267, 2512736982, 1776797516, 1232310018, 3804110970, 298421658, 1432006706, 593847971},
				A:   [7]uint32{1325917020, 2919848112, 3929573053, 2669685500, 2287110912, 548091140, 2908348530},
				PC:  15951732,
				SR:  1560,
				USP: 7349708,
				SSP: 10880578,
				RAM: [][2]uint32{{15951726, 74}, {15951727, 94}, {15951728, 188}, {15951729, 236}, {5890160, 128}, {5890161, 71}, {15951730, 198}, {15951731, 221}},
				Cycles: 8,
			},
		},
		{
			name: "1000 TST.w D2 4a42",
			init: cpuState{
				D:   [8]uint32{3543789600, 26596668, 1391474110, 22422274, 1568422884, 3989946168, 3432712420, 130253235},
				A:   [7]uint32{2689036098, 487454869, 3054686259, 383239470, 1155513823, 3986831689, 2524704090},
				PC:  10167770,
				SR:  8987,
				USP: 16669326,
				SSP: 15841760,
				RAM: [][2]uint32{{10167766, 74}, {10167767, 66}, {10167768, 154}, {10167769, 167}, {10167770, 63}, {10167771, 246}},
			},
			want: cpuState{
				D:   [8]uint32{3543789600, 26596668, 1391474110, 22422274, 1568422884, 3989946168, 3432712420, 130253235},
				A:   [7]uint32{2689036098, 487454869, 3054686259, 383239470, 1155513823, 3986831689, 2524704090},
				PC:  10167772,
				SR:  8976,
				USP: 16669326,
				SSP: 15841760,
				RAM: [][2]uint32{{10167766, 74}, {10167767, 66}, {10167768, 154}, {10167769, 167}, {10167770, 63}, {10167771, 246}},
				Cycles: 4,
			},
		},
		{
			name: "1500 TST.w (A7) 4a57",
			init: cpuState{
				D:   [8]uint32{1154346775, 1873789327, 498437845, 3915551194, 556190953, 3748665294, 2324308769, 337463912},
				A:   [7]uint32{1885831679, 381864868, 2921424140, 3772375150, 3116516471, 840938876, 1724713200},
				PC:  9157224,
				SR:  42245,
				USP: 6043532,
				SSP: 13565906,
				RAM: [][2]uint32{{9157220, 74}, {9157221, 87}, {9157222, 103}, {9157223, 143}, {13565906, 232}, {13565907, 142}, {9157224, 33}, {9157225, 15}},
			},
			want: cpuState{
				D:   [8]uint32{1154346775, 1873789327, 498437845, 3915551194, 556190953, 3748665294, 2324308769, 337463912},
				A:   [7]uint32{1885831679, 381864868, 2921424140, 3772375150, 3116516471, 840938876, 1724713200},
				PC:  9157226,
				SR:  42248,
				USP: 6043532,
				SSP: 13565906,
				RAM: [][2]uint32{{9157220, 74}, {9157221, 87}, {9157222, 103}, {9157223, 143}, {13565906, 232}, {13565907, 142}, {9157224, 33}, {9157225, 15}},
				Cycles: 8,
			},
		},
		{
			name: "2000 TST.w D2 4a42",
			init: cpuState{
				D:   [8]uint32{3500582587, 4184572673, 499450437, 4160193178, 429999251, 591687535, 3927137846, 1412749203},
				A:   [7]uint32{3603871705, 2878136463, 755665821, 530830060, 755104194, 3568312777, 4240731294},
				PC:  14722868,
				SR:  41988,
				USP: 11828152,
				SSP: 7647792,
				RAM: [][2]uint32{{14722864, 74}, {14722865, 66}, {14722866, 103}, {14722867, 48}, {14722868, 180}, {14722869, 203}},
			},
			want: cpuState{
				D:   [8]uint32{3500582587, 4184572673, 499450437, 4160193178, 429999251, 591687535, 3927137846, 1412749203},
				A:   [7]uint32{3603871705, 2878136463, 755665821, 530830060, 755104194, 3568312777, 4240731294},
				PC:  14722870,
				SR:  41984,
				USP: 11828152,
				SSP: 7647792,
				RAM: [][2]uint32{{14722864, 74}, {14722865, 66}, {14722866, 103}, {14722867, 48}, {14722868, 180}, {14722869, 203}},
				Cycles: 4,
			},
		},
		{
			name: "001 TST.w -(A2) 4a62",
			init: 			cpuState{
				D:   [8]uint32{3809938717, 2386442440, 4222854340, 2835803689, 2807040865, 3656798672, 1176679537, 794827023},
				A:   [7]uint32{3699428299, 972340928, 1255284594, 2621062735, 2960453301, 4159211116, 1854217545},
				PC:  3314402,
				SR:  8201,
				USP: 5741448,
				SSP: 7535850,
				RAM: [][2]uint32{{3314398, 74}, {3314399, 98}, {3314400, 131}, {3314401, 6}, {13770608, 242}, {13770609, 50}, {3314402, 201}, {3314403, 209}},
			},
			want: 			cpuState{
				D:   [8]uint32{3809938717, 2386442440, 4222854340, 2835803689, 2807040865, 3656798672, 1176679537, 794827023},
				A:   [7]uint32{3699428299, 972340928, 1255284592, 2621062735, 2960453301, 4159211116, 1854217545},
				PC:  3314404,
				SR:  8200,
				USP: 5741448,
				SSP: 7535850,
				RAM: [][2]uint32{{3314398, 74}, {3314399, 98}, {3314400, 131}, {3314401, 6}, {13770608, 242}, {13770609, 50}, {3314402, 201}, {3314403, 209}},
				Cycles: 10,
			},
		},
		{
			name: "286 TST.w D2 4a42",
			init: 			cpuState{
				D:   [8]uint32{3660258003, 3439192698, 3929708326, 1966906126, 3323585140, 3268321909, 1357865186, 382325072},
				A:   [7]uint32{1392699516, 2217179036, 3665292468, 1654714698, 2523106436, 1762396853, 2100002505},
				PC:  13392970,
				SR:  9481,
				USP: 9656330,
				SSP: 10624990,
				RAM: [][2]uint32{{13392966, 74}, {13392967, 66}, {13392968, 66}, {13392969, 188}, {13392970, 91}, {13392971, 223}},
			},
			want: 			cpuState{
				D:   [8]uint32{3660258003, 3439192698, 3929708326, 1966906126, 3323585140, 3268321909, 1357865186, 382325072},
				A:   [7]uint32{1392699516, 2217179036, 3665292468, 1654714698, 2523106436, 1762396853, 2100002505},
				PC:  13392972,
				SR:  9480,
				USP: 9656330,
				SSP: 10624990,
				RAM: [][2]uint32{{13392966, 74}, {13392967, 66}, {13392968, 66}, {13392969, 188}, {13392970, 91}, {13392971, 223}},
				Cycles: 4,
			},
		},
		{
			name: "568 TST.w -(A4) 4a64",
			init: 			cpuState{
				D:   [8]uint32{3597383957, 1636211956, 2530756963, 2867425160, 2267867322, 1826662376, 523844793, 1076421853},
				A:   [7]uint32{93584430, 3770991589, 2671093730, 280349496, 3566591324, 996735714, 2931616421},
				PC:  10128294,
				SR:  8720,
				USP: 9814314,
				SSP: 13600562,
				RAM: [][2]uint32{{10128290, 74}, {10128291, 100}, {10128292, 106}, {10128293, 36}, {9821530, 46}, {9821531, 118}, {10128294, 174}, {10128295, 248}},
			},
			want: 			cpuState{
				D:   [8]uint32{3597383957, 1636211956, 2530756963, 2867425160, 2267867322, 1826662376, 523844793, 1076421853},
				A:   [7]uint32{93584430, 3770991589, 2671093730, 280349496, 3566591322, 996735714, 2931616421},
				PC:  10128296,
				SR:  8720,
				USP: 9814314,
				SSP: 13600562,
				RAM: [][2]uint32{{10128290, 74}, {10128291, 100}, {10128292, 106}, {10128293, 36}, {9821530, 46}, {9821531, 118}, {10128294, 174}, {10128295, 248}},
				Cycles: 10,
			},
		},
		{
			name: "839 TST.w -(A7) 4a67",
			init: 			cpuState{
				D:   [8]uint32{304890090, 1975697549, 2446397168, 621921764, 3259602415, 3418492986, 75056810, 4212795251},
				A:   [7]uint32{2357471363, 3115152985, 234679666, 2299287166, 1761712959, 4012717688, 3264119981},
				PC:  5404208,
				SR:  275,
				USP: 6352950,
				SSP: 13636370,
				RAM: [][2]uint32{{5404204, 74}, {5404205, 103}, {5404206, 156}, {5404207, 201}, {6352948, 77}, {6352949, 47}, {5404208, 150}, {5404209, 114}},
			},
			want: 			cpuState{
				D:   [8]uint32{304890090, 1975697549, 2446397168, 621921764, 3259602415, 3418492986, 75056810, 4212795251},
				A:   [7]uint32{2357471363, 3115152985, 234679666, 2299287166, 1761712959, 4012717688, 3264119981},
				PC:  5404210,
				SR:  272,
				USP: 6352948,
				SSP: 13636370,
				RAM: [][2]uint32{{5404204, 74}, {5404205, 103}, {5404206, 156}, {5404207, 201}, {6352948, 77}, {6352949, 47}, {5404208, 150}, {5404209, 114}},
				Cycles: 10,
			},
		},
		{
			name: "1099 TST.w -(A5) 4a65",
			init: 			cpuState{
				D:   [8]uint32{761926882, 1094566187, 2469445288, 2894065682, 253067397, 3968628117, 2655269878, 2309413026},
				A:   [7]uint32{1449015500, 2053989876, 3832085607, 777961552, 1511154691, 1317391474, 2649148309},
				PC:  10179890,
				SR:  9749,
				USP: 15921920,
				SSP: 433988,
				RAM: [][2]uint32{{10179886, 74}, {10179887, 101}, {10179888, 211}, {10179889, 53}, {8768624, 141}, {8768625, 232}, {10179890, 225}, {10179891, 143}},
			},
			want: 			cpuState{
				D:   [8]uint32{761926882, 1094566187, 2469445288, 2894065682, 253067397, 3968628117, 2655269878, 2309413026},
				A:   [7]uint32{1449015500, 2053989876, 3832085607, 777961552, 1511154691, 1317391472, 2649148309},
				PC:  10179892,
				SR:  9752,
				USP: 15921920,
				SSP: 433988,
				RAM: [][2]uint32{{10179886, 74}, {10179887, 101}, {10179888, 211}, {10179889, 53}, {8768624, 141}, {8768625, 232}, {10179890, 225}, {10179891, 143}},
				Cycles: 10,
			},
		},
		{
			name: "1404 TST.w -(A4) 4a64",
			init: 			cpuState{
				D:   [8]uint32{3990100755, 1597548630, 3302105187, 891706438, 1110425894, 1089701055, 1211128948, 2391703669},
				A:   [7]uint32{2337440882, 175091445, 203270601, 2291027771, 4218007462, 1644723525, 1495187524},
				PC:  2555426,
				SR:  1298,
				USP: 7625488,
				SSP: 16746362,
				RAM: [][2]uint32{{2555422, 74}, {2555423, 100}, {2555424, 234}, {2555425, 93}, {6926244, 105}, {6926245, 246}, {2555426, 242}, {2555427, 82}},
			},
			want: 			cpuState{
				D:   [8]uint32{3990100755, 1597548630, 3302105187, 891706438, 1110425894, 1089701055, 1211128948, 2391703669},
				A:   [7]uint32{2337440882, 175091445, 203270601, 2291027771, 4218007460, 1644723525, 1495187524},
				PC:  2555428,
				SR:  1296,
				USP: 7625488,
				SSP: 16746362,
				RAM: [][2]uint32{{2555422, 74}, {2555423, 100}, {2555424, 234}, {2555425, 93}, {6926244, 105}, {6926245, 246}, {2555426, 242}, {2555427, 82}},
				Cycles: 10,
			},
		},
		{
			name: "1707 TST.w (A5) 4a55",
			init: 			cpuState{
				D:   [8]uint32{1508724431, 3355855706, 856113129, 2139408100, 360794992, 1508682366, 3885914657, 953868829},
				A:   [7]uint32{2681245510, 3027168180, 2557397992, 2325999061, 3262736661, 444165048, 492328415},
				PC:  7866392,
				SR:  9738,
				USP: 4689356,
				SSP: 5438306,
				RAM: [][2]uint32{{7866388, 74}, {7866389, 85}, {7866390, 205}, {7866391, 140}, {7957432, 105}, {7957433, 185}, {7866392, 27}, {7866393, 44}},
			},
			want: 			cpuState{
				D:   [8]uint32{1508724431, 3355855706, 856113129, 2139408100, 360794992, 1508682366, 3885914657, 953868829},
				A:   [7]uint32{2681245510, 3027168180, 2557397992, 2325999061, 3262736661, 444165048, 492328415},
				PC:  7866394,
				SR:  9728,
				USP: 4689356,
				SSP: 5438306,
				RAM: [][2]uint32{{7866388, 74}, {7866389, 85}, {7866390, 205}, {7866391, 140}, {7957432, 105}, {7957433, 185}, {7866392, 27}, {7866393, 44}},
				Cycles: 8,
			},
		},
		{
			name: "1980 TST.w (d16, A1) 4a69",
			init: 			cpuState{
				D:   [8]uint32{1641281732, 3765809757, 4129959690, 4220738203, 2084277169, 1234553612, 3202898945, 2664742834},
				A:   [7]uint32{1976092211, 4261846721, 3755225594, 1703276472, 1721048890, 4168538961, 2451663812},
				PC:  15472120,
				SR:  9475,
				USP: 8567630,
				SSP: 8430690,
				RAM: [][2]uint32{{15472116, 74}, {15472117, 105}, {15472118, 223}, {15472119, 67}, {15472120, 47}, {15472121, 226}, {425476, 134}, {425477, 67}, {15472122, 3}, {15472123, 168}},
			},
			want: 			cpuState{
				D:   [8]uint32{1641281732, 3765809757, 4129959690, 4220738203, 2084277169, 1234553612, 3202898945, 2664742834},
				A:   [7]uint32{1976092211, 4261846721, 3755225594, 1703276472, 1721048890, 4168538961, 2451663812},
				PC:  15472124,
				SR:  9480,
				USP: 8567630,
				SSP: 8430690,
				RAM: [][2]uint32{{15472116, 74}, {15472117, 105}, {15472118, 223}, {15472119, 67}, {15472120, 47}, {15472121, 226}, {425476, 134}, {425477, 67}, {15472122, 3}, {15472123, 168}},
				Cycles: 12,
			},
		},
		{
			name: "2268 TST.w D6 4a46",
			init: 			cpuState{
				D:   [8]uint32{4121494250, 3256370406, 1674957064, 1685267024, 2292414933, 2070699879, 1448362063, 2186585784},
				A:   [7]uint32{1717167353, 3767277890, 4027282172, 2376404629, 697431513, 73810340, 283666647},
				PC:  6011236,
				SR:  8965,
				USP: 8685122,
				SSP: 1623006,
				RAM: [][2]uint32{{6011232, 74}, {6011233, 70}, {6011234, 169}, {6011235, 55}, {6011236, 184}, {6011237, 89}},
			},
			want: 			cpuState{
				D:   [8]uint32{4121494250, 3256370406, 1674957064, 1685267024, 2292414933, 2070699879, 1448362063, 2186585784},
				A:   [7]uint32{1717167353, 3767277890, 4027282172, 2376404629, 697431513, 73810340, 283666647},
				PC:  6011238,
				SR:  8960,
				USP: 8685122,
				SSP: 1623006,
				RAM: [][2]uint32{{6011232, 74}, {6011233, 70}, {6011234, 169}, {6011235, 55}, {6011236, 184}, {6011237, 89}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTST_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TST.l (A3)+ 4a9b",
			init: cpuState{
				D:   [8]uint32{392338856, 575745694, 1285145668, 2889595002, 1934093247, 624730210, 2551632161, 128177730},
				A:   [7]uint32{3651211208, 65103521, 510446476, 2480339192, 4174934748, 34041163, 3484523032},
				PC:  538048,
				SR:  266,
				USP: 15138578,
				SSP: 16253590,
				RAM: [][2]uint32{{538044, 74}, {538045, 155}, {538046, 51}, {538047, 219}, {14088440, 216}, {14088441, 228}, {14088442, 63}, {14088443, 15}, {538048, 39}, {538049, 177}},
			},
			want: cpuState{
				D:   [8]uint32{392338856, 575745694, 1285145668, 2889595002, 1934093247, 624730210, 2551632161, 128177730},
				A:   [7]uint32{3651211208, 65103521, 510446476, 2480339196, 4174934748, 34041163, 3484523032},
				PC:  538050,
				SR:  264,
				USP: 15138578,
				SSP: 16253590,
				RAM: [][2]uint32{{538044, 74}, {538045, 155}, {538046, 51}, {538047, 219}, {14088440, 216}, {14088441, 228}, {14088442, 63}, {14088443, 15}, {538048, 39}, {538049, 177}},
				Cycles: 12,
			},
		},
		{
			name: "500 TST.l (A4)+ 4a9c",
			init: cpuState{
				D:   [8]uint32{1541533400, 366337260, 495035572, 1339442496, 2074111443, 3237308231, 134789519, 700881213},
				A:   [7]uint32{1170022116, 3693685539, 632105546, 2232408333, 2299379293, 2697427698, 1404834479},
				PC:  1903154,
				SR:  34314,
				USP: 51168,
				SSP: 7769490,
				RAM: [][2]uint32{{1903150, 74}, {1903151, 156}, {1903152, 77}, {1903153, 206}, {12, 204}, {13, 22}, {14, 0}, {15, 78}, {1441870, 144}, {1441871, 64}, {1441872, 97}, {1441873, 103}},
			},
			want: cpuState{
				D:      [8]uint32{1541533400, 366337260, 495035572, 1339442496, 2074111443, 3237308231, 134789519, 700881213},
				A:      [7]uint32{1170022116, 3693685539, 632105546, 2232408333, 2299379293, 2697427698, 1404834479},
				PC:     3423993938,
				SR:     9738,
				USP:    51168,
				SSP:    7769476,
				RAM:    [][2]uint32{{1903150, 74}, {1903151, 156}, {1903152, 77}, {1903153, 206}, {7769488, 10}, {7769489, 48}, {7769484, 134}, {7769485, 10}, {7769486, 0}, {7769487, 29}, {7769482, 74}, {7769483, 156}, {7769480, 190}, {7769481, 93}, {7769476, 74}, {7769477, 145}, {7769478, 137}, {7769479, 13}, {12, 204}, {13, 22}, {14, 0}, {15, 78}, {1441870, 144}, {1441871, 64}, {1441872, 97}, {1441873, 103}},
				Halted: true,
			},
		},
		{
			name: "1000 TST.l (d8, A2, Xn) 4ab2",
			init: cpuState{
				D:   [8]uint32{4028359215, 910667542, 1186374698, 1999638695, 3796833560, 3579536216, 43818076, 3380038896},
				A:   [7]uint32{3164226988, 747015698, 2050837628, 4238160995, 497279810, 808869613, 414893530},
				PC:  11603594,
				SR:  41482,
				USP: 16550424,
				SSP: 2370568,
				RAM: [][2]uint32{{11603590, 74}, {11603591, 178}, {11603592, 160}, {11603593, 131}, {11603594, 250}, {11603595, 30}, {12, 249}, {13, 92}, {14, 157}, {15, 6}, {6069510, 160}, {6069511, 60}, {6069512, 47}, {6069513, 98}},
			},
			want: cpuState{
				D:      [8]uint32{4028359215, 910667542, 1186374698, 1999638695, 3796833560, 3579536216, 43818076, 3380038896},
				A:      [7]uint32{3164226988, 747015698, 2050837628, 4238160995, 497279810, 808869613, 414893530},
				PC:     4183596298,
				SR:     8714,
				USP:    16550424,
				SSP:    2370554,
				RAM:    [][2]uint32{{11603590, 74}, {11603591, 178}, {11603592, 160}, {11603593, 131}, {11603594, 250}, {11603595, 30}, {2370566, 14}, {2370567, 136}, {2370562, 162}, {2370563, 10}, {2370564, 0}, {2370565, 177}, {2370560, 74}, {2370561, 178}, {2370558, 152}, {2370559, 123}, {2370554, 74}, {2370555, 181}, {2370556, 122}, {2370557, 61}, {12, 249}, {13, 92}, {14, 157}, {15, 6}, {6069510, 160}, {6069511, 60}, {6069512, 47}, {6069513, 98}},
				Halted: true,
			},
		},
		{
			name: "1500 TST.l (A0) 4a90",
			init: cpuState{
				D:   [8]uint32{1484345786, 1179190168, 67852079, 1708721554, 2789247177, 2361600578, 3971813293, 3141332511},
				A:   [7]uint32{1491387384, 3569545193, 4253301744, 2091682973, 2743499370, 2569068160, 1269938440},
				PC:  10853574,
				SR:  33301,
				USP: 6463968,
				SSP: 3015496,
				RAM: [][2]uint32{{10853570, 74}, {10853571, 144}, {10853572, 124}, {10853573, 31}, {14992376, 53}, {14992377, 137}, {14992378, 188}, {14992379, 97}, {10853574, 37}, {10853575, 252}},
			},
			want: cpuState{
				D:   [8]uint32{1484345786, 1179190168, 67852079, 1708721554, 2789247177, 2361600578, 3971813293, 3141332511},
				A:   [7]uint32{1491387384, 3569545193, 4253301744, 2091682973, 2743499370, 2569068160, 1269938440},
				PC:  10853576,
				SR:  33296,
				USP: 6463968,
				SSP: 3015496,
				RAM: [][2]uint32{{10853570, 74}, {10853571, 144}, {10853572, 124}, {10853573, 31}, {14992376, 53}, {14992377, 137}, {14992378, 188}, {14992379, 97}, {10853574, 37}, {10853575, 252}},
				Cycles: 12,
			},
		},
		{
			name: "2000 TST.l (A3) 4a93",
			init: cpuState{
				D:   [8]uint32{759308172, 1816863587, 2523437302, 2884034688, 2610667906, 1277506688, 3816107819, 3759890551},
				A:   [7]uint32{4271701043, 1575272675, 4266023303, 2323563765, 1297297449, 3754936381, 3114992177},
				PC:  6865088,
				SR:  33823,
				USP: 10892300,
				SSP: 12625086,
				RAM: [][2]uint32{{6865084, 74}, {6865085, 147}, {6865086, 19}, {6865087, 194}, {12, 192}, {13, 70}, {14, 151}, {15, 84}, {4626260, 124}, {4626261, 221}, {4626262, 183}, {4626263, 94}},
			},
			want: cpuState{
				D:      [8]uint32{759308172, 1816863587, 2523437302, 2884034688, 2610667906, 1277506688, 3816107819, 3759890551},
				A:      [7]uint32{4271701043, 1575272675, 4266023303, 2323563765, 1297297449, 3754936381, 3114992177},
				PC:     3225851736,
				SR:     9247,
				USP:    10892300,
				SSP:    12625072,
				RAM:    [][2]uint32{{6865084, 74}, {6865085, 147}, {6865086, 19}, {6865087, 194}, {12625084, 192}, {12625085, 190}, {12625080, 132}, {12625081, 31}, {12625082, 0}, {12625083, 104}, {12625078, 74}, {12625079, 147}, {12625076, 196}, {12625077, 245}, {12625072, 74}, {12625073, 145}, {12625074, 138}, {12625075, 126}, {12, 192}, {13, 70}, {14, 151}, {15, 84}, {4626260, 124}, {4626261, 221}, {4626262, 183}, {4626263, 94}},
				Halted: true,
			},
		},
		{
			name: "002 TST.l D7 4a87",
			init: 			cpuState{
				D:   [8]uint32{3059869349, 1692362417, 967670932, 3667550651, 4287322083, 4292350814, 3955534833, 3506751493},
				A:   [7]uint32{2593509768, 3724711234, 230712715, 2164643981, 2768779244, 3793620501, 4145778478},
				PC:  15437560,
				SR:  8968,
				USP: 14635976,
				SSP: 5212890,
				RAM: [][2]uint32{{15437556, 74}, {15437557, 135}, {15437558, 168}, {15437559, 87}, {15437560, 166}, {15437561, 197}},
			},
			want: 			cpuState{
				D:   [8]uint32{3059869349, 1692362417, 967670932, 3667550651, 4287322083, 4292350814, 3955534833, 3506751493},
				A:   [7]uint32{2593509768, 3724711234, 230712715, 2164643981, 2768779244, 3793620501, 4145778478},
				PC:  15437562,
				SR:  8968,
				USP: 14635976,
				SSP: 5212890,
				RAM: [][2]uint32{{15437556, 74}, {15437557, 135}, {15437558, 168}, {15437559, 87}, {15437560, 166}, {15437561, 197}},
				Cycles: 4,
			},
		},
		{
			name: "323 TST.l (d16, A1) 4aa9",
			init: 			cpuState{
				D:   [8]uint32{1296983677, 3602567047, 3711062937, 234160621, 3425482546, 165042265, 2688167027, 4162667143},
				A:   [7]uint32{1195127179, 2386613718, 2117848088, 707567862, 2042334363, 3632997484, 741532626},
				PC:  4811464,
				SR:  10013,
				USP: 4709134,
				SSP: 14858726,
				RAM: [][2]uint32{{4811460, 74}, {4811461, 169}, {4811462, 96}, {4811463, 248}, {4811464, 55}, {4811465, 56}, {4273870, 21}, {4273871, 243}, {4273872, 110}, {4273873, 75}, {4811466, 254}, {4811467, 206}},
			},
			want: 			cpuState{
				D:   [8]uint32{1296983677, 3602567047, 3711062937, 234160621, 3425482546, 165042265, 2688167027, 4162667143},
				A:   [7]uint32{1195127179, 2386613718, 2117848088, 707567862, 2042334363, 3632997484, 741532626},
				PC:  4811468,
				SR:  10000,
				USP: 4709134,
				SSP: 14858726,
				RAM: [][2]uint32{{4811460, 74}, {4811461, 169}, {4811462, 96}, {4811463, 248}, {4811464, 55}, {4811465, 56}, {4273870, 21}, {4273871, 243}, {4273872, 110}, {4273873, 75}, {4811466, 254}, {4811467, 206}},
				Cycles: 16,
			},
		},
		{
			name: "563 TST.l (xxx).w 4ab8",
			init: 			cpuState{
				D:   [8]uint32{3324666961, 3420643485, 2007858520, 903633377, 1397481454, 617883999, 4096881258, 2718659807},
				A:   [7]uint32{860438041, 2798799026, 3571851515, 3312994401, 498577693, 2727046543, 1014547643},
				PC:  14694276,
				SR:  8729,
				USP: 8597122,
				SSP: 10622044,
				RAM: [][2]uint32{{14694272, 74}, {14694273, 184}, {14694274, 161}, {14694275, 98}, {14694276, 237}, {14694277, 66}, {16752994, 123}, {16752995, 216}, {16752996, 238}, {16752997, 152}, {14694278, 177}, {14694279, 6}},
			},
			want: 			cpuState{
				D:   [8]uint32{3324666961, 3420643485, 2007858520, 903633377, 1397481454, 617883999, 4096881258, 2718659807},
				A:   [7]uint32{860438041, 2798799026, 3571851515, 3312994401, 498577693, 2727046543, 1014547643},
				PC:  14694280,
				SR:  8720,
				USP: 8597122,
				SSP: 10622044,
				RAM: [][2]uint32{{14694272, 74}, {14694273, 184}, {14694274, 161}, {14694275, 98}, {14694276, 237}, {14694277, 66}, {16752994, 123}, {16752995, 216}, {16752996, 238}, {16752997, 152}, {14694278, 177}, {14694279, 6}},
				Cycles: 16,
			},
		},
		{
			name: "824 TST.l (d16, A3) 4aab",
			init: 			cpuState{
				D:   [8]uint32{932192793, 2624112654, 1765756743, 112269165, 2466780672, 2899279278, 2242228070, 1998401620},
				A:   [7]uint32{1243715941, 895373919, 2811304132, 1663981568, 2955333151, 404215276, 3643325310},
				PC:  1048722,
				SR:  8987,
				USP: 1960648,
				SSP: 8690032,
				RAM: [][2]uint32{{1048718, 74}, {1048719, 171}, {1048720, 14}, {1048721, 114}, {1048722, 95}, {1048723, 217}, {3040882, 110}, {3040883, 10}, {3040884, 42}, {3040885, 116}, {1048724, 164}, {1048725, 78}},
			},
			want: 			cpuState{
				D:   [8]uint32{932192793, 2624112654, 1765756743, 112269165, 2466780672, 2899279278, 2242228070, 1998401620},
				A:   [7]uint32{1243715941, 895373919, 2811304132, 1663981568, 2955333151, 404215276, 3643325310},
				PC:  1048726,
				SR:  8976,
				USP: 1960648,
				SSP: 8690032,
				RAM: [][2]uint32{{1048718, 74}, {1048719, 171}, {1048720, 14}, {1048721, 114}, {1048722, 95}, {1048723, 217}, {3040882, 110}, {3040883, 10}, {3040884, 42}, {3040885, 116}, {1048724, 164}, {1048725, 78}},
				Cycles: 16,
			},
		},
		{
			name: "1123 TST.l (d8, A6, Xn) 4ab6",
			init: 			cpuState{
				D:   [8]uint32{3867977430, 2766925523, 3296674715, 1534606720, 2023922000, 2147993614, 2995455728, 2861814980},
				A:   [7]uint32{1106307563, 2820485995, 2449462808, 964952210, 710311421, 2822862455, 3737013338},
				PC:  10418868,
				SR:  8472,
				USP: 12053006,
				SSP: 15693066,
				RAM: [][2]uint32{{10418864, 74}, {10418865, 182}, {10418866, 192}, {10418867, 245}, {10418868, 18}, {10418869, 129}, {12503628, 91}, {12503629, 159}, {12503630, 37}, {12503631, 241}, {10418870, 75}, {10418871, 139}},
			},
			want: 			cpuState{
				D:   [8]uint32{3867977430, 2766925523, 3296674715, 1534606720, 2023922000, 2147993614, 2995455728, 2861814980},
				A:   [7]uint32{1106307563, 2820485995, 2449462808, 964952210, 710311421, 2822862455, 3737013338},
				PC:  10418872,
				SR:  8464,
				USP: 12053006,
				SSP: 15693066,
				RAM: [][2]uint32{{10418864, 74}, {10418865, 182}, {10418866, 192}, {10418867, 245}, {10418868, 18}, {10418869, 129}, {12503628, 91}, {12503629, 159}, {12503630, 37}, {12503631, 241}, {10418870, 75}, {10418871, 139}},
				Cycles: 18,
			},
		},
		{
			name: "1400 TST.l D0 4a80",
			init: 			cpuState{
				D:   [8]uint32{2870968207, 2594809262, 2342984105, 3408150513, 3057023825, 3878532317, 3959028749, 3395950665},
				A:   [7]uint32{3644376351, 221101077, 3661729237, 76645255, 1306045050, 2562282928, 1102472872},
				PC:  929020,
				SR:  9485,
				USP: 13546860,
				SSP: 103148,
				RAM: [][2]uint32{{929016, 74}, {929017, 128}, {929018, 188}, {929019, 142}, {929020, 34}, {929021, 232}},
			},
			want: 			cpuState{
				D:   [8]uint32{2870968207, 2594809262, 2342984105, 3408150513, 3057023825, 3878532317, 3959028749, 3395950665},
				A:   [7]uint32{3644376351, 221101077, 3661729237, 76645255, 1306045050, 2562282928, 1102472872},
				PC:  929022,
				SR:  9480,
				USP: 13546860,
				SSP: 103148,
				RAM: [][2]uint32{{929016, 74}, {929017, 128}, {929018, 188}, {929019, 142}, {929020, 34}, {929021, 232}},
				Cycles: 4,
			},
		},
		{
			name: "1659 TST.l (d16, A4) 4aac",
			init: 			cpuState{
				D:   [8]uint32{791208936, 4181761400, 2784475485, 3974892876, 2610617347, 8577041, 562124742, 2607269658},
				A:   [7]uint32{22525582, 984503427, 4259801112, 306086686, 1445677236, 1536231471, 4184879133},
				PC:  2081998,
				SR:  256,
				USP: 9342446,
				SSP: 9501306,
				RAM: [][2]uint32{{2081994, 74}, {2081995, 172}, {2081996, 173}, {2081997, 170}, {2081998, 17}, {2081999, 18}, {2815582, 228}, {2815583, 140}, {2815584, 17}, {2815585, 219}, {2082000, 155}, {2082001, 252}},
			},
			want: 			cpuState{
				D:   [8]uint32{791208936, 4181761400, 2784475485, 3974892876, 2610617347, 8577041, 562124742, 2607269658},
				A:   [7]uint32{22525582, 984503427, 4259801112, 306086686, 1445677236, 1536231471, 4184879133},
				PC:  2082002,
				SR:  264,
				USP: 9342446,
				SSP: 9501306,
				RAM: [][2]uint32{{2081994, 74}, {2081995, 172}, {2081996, 173}, {2081997, 170}, {2081998, 17}, {2081999, 18}, {2815582, 228}, {2815583, 140}, {2815584, 17}, {2815585, 219}, {2082000, 155}, {2082001, 252}},
				Cycles: 16,
			},
		},
		{
			name: "1925 TST.l -(A6) 4aa6",
			init: 			cpuState{
				D:   [8]uint32{3266107761, 1404622134, 1673776767, 3851001859, 2175853877, 2698791296, 120697287, 2524026259},
				A:   [7]uint32{399302681, 2600096865, 274893921, 3351335774, 4057259335, 944978385, 3346990622},
				PC:  12933822,
				SR:  6,
				USP: 13637036,
				SSP: 12864202,
				RAM: [][2]uint32{{12933818, 74}, {12933819, 166}, {12933820, 36}, {12933821, 34}, {8324634, 26}, {8324635, 32}, {8324636, 119}, {8324637, 231}, {12933822, 58}, {12933823, 235}},
			},
			want: 			cpuState{
				D:   [8]uint32{3266107761, 1404622134, 1673776767, 3851001859, 2175853877, 2698791296, 120697287, 2524026259},
				A:   [7]uint32{399302681, 2600096865, 274893921, 3351335774, 4057259335, 944978385, 3346990618},
				PC:  12933824,
				SR:  0,
				USP: 13637036,
				SSP: 12864202,
				RAM: [][2]uint32{{12933818, 74}, {12933819, 166}, {12933820, 36}, {12933821, 34}, {8324634, 26}, {8324635, 32}, {8324636, 119}, {8324637, 231}, {12933822, 58}, {12933823, 235}},
				Cycles: 14,
			},
		},
		{
			name: "2208 TST.l D3 4a83",
			init: 			cpuState{
				D:   [8]uint32{3281988497, 48461370, 2579016150, 3609504731, 508260016, 1234881181, 1749584110, 2897052990},
				A:   [7]uint32{236505558, 3514499383, 1896360207, 2547985924, 906457258, 1902317611, 1259891858},
				PC:  10557978,
				SR:  779,
				USP: 4878172,
				SSP: 13732640,
				RAM: [][2]uint32{{10557974, 74}, {10557975, 131}, {10557976, 78}, {10557977, 30}, {10557978, 68}, {10557979, 81}},
			},
			want: 			cpuState{
				D:   [8]uint32{3281988497, 48461370, 2579016150, 3609504731, 508260016, 1234881181, 1749584110, 2897052990},
				A:   [7]uint32{236505558, 3514499383, 1896360207, 2547985924, 906457258, 1902317611, 1259891858},
				PC:  10557980,
				SR:  776,
				USP: 4878172,
				SSP: 13732640,
				RAM: [][2]uint32{{10557974, 74}, {10557975, 131}, {10557976, 78}, {10557977, 30}, {10557978, 68}, {10557979, 81}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTAS(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TAS (A1) 4ad1",
			init: cpuState{
				D:   [8]uint32{977090634, 3701951921, 3445948972, 996719339, 2754339530, 3223994515, 197781903, 1390960277},
				A:   [7]uint32{2913762112, 3294663737, 3257528816, 3479158592, 1183975623, 398401328, 953502955},
				PC:  10918948,
				SR:  34054,
				USP: 10356042,
				SSP: 7233526,
				RAM: [][2]uint32{{10918944, 74}, {10918945, 209}, {10918946, 148}, {10918947, 66}, {6329400, 226}, {6329401, 222}, {10918948, 181}, {10918949, 68}},
			},
			want: cpuState{
				D:   [8]uint32{977090634, 3701951921, 3445948972, 996719339, 2754339530, 3223994515, 197781903, 1390960277},
				A:   [7]uint32{2913762112, 3294663737, 3257528816, 3479158592, 1183975623, 398401328, 953502955},
				PC:  10918950,
				SR:  34056,
				USP: 10356042,
				SSP: 7233526,
				RAM: [][2]uint32{{10918944, 74}, {10918945, 209}, {10918946, 148}, {10918947, 66}, {6329400, 226}, {6329401, 222}, {10918948, 181}, {10918949, 68}},
				Cycles: 14,
			},
		},
		{
			name: "500 TAS (xxx).w 4af8",
			init: cpuState{
				D:   [8]uint32{3264331379, 988200499, 46255467, 2031825539, 3813943470, 2608200143, 1948048841, 10015486},
				A:   [7]uint32{2851274113, 4176400581, 3609501432, 4225604774, 3844858849, 1286962977, 237391758},
				PC:  13367938,
				SR:  8209,
				USP: 13978038,
				SSP: 934682,
				RAM: [][2]uint32{{13367934, 74}, {13367935, 248}, {13367936, 28}, {13367937, 131}, {13367938, 200}, {13367939, 51}, {7298, 87}, {7299, 210}, {13367940, 20}, {13367941, 242}},
			},
			want: cpuState{
				D:   [8]uint32{3264331379, 988200499, 46255467, 2031825539, 3813943470, 2608200143, 1948048841, 10015486},
				A:   [7]uint32{2851274113, 4176400581, 3609501432, 4225604774, 3844858849, 1286962977, 237391758},
				PC:  13367942,
				SR:  8216,
				USP: 13978038,
				SSP: 934682,
				RAM: [][2]uint32{{13367934, 74}, {13367935, 248}, {13367936, 28}, {13367937, 131}, {13367938, 200}, {13367939, 51}, {7298, 87}, {7299, 210}, {13367940, 20}, {13367941, 242}},
				Cycles: 18,
			},
		},
		{
			name: "1000 TAS D1 4ac1",
			init: cpuState{
				D:   [8]uint32{2445892461, 1102641132, 2071963560, 1043659441, 1665066934, 1372284160, 2868424407, 82388987},
				A:   [7]uint32{3176606760, 52286722, 1562505406, 899996673, 3313430884, 294632420, 525916301},
				PC:  1348884,
				SR:  41987,
				USP: 728080,
				SSP: 15970852,
				RAM: [][2]uint32{{1348880, 74}, {1348881, 193}, {1348882, 66}, {1348883, 119}, {1348884, 55}, {1348885, 156}},
			},
			want: cpuState{
				D:   [8]uint32{2445892461, 1102641132, 2071963560, 1043659441, 1665066934, 1372284160, 2868424407, 82388987},
				A:   [7]uint32{3176606760, 52286722, 1562505406, 899996673, 3313430884, 294632420, 525916301},
				PC:  1348886,
				SR:  41992,
				USP: 728080,
				SSP: 15970852,
				RAM: [][2]uint32{{1348880, 74}, {1348881, 193}, {1348882, 66}, {1348883, 119}, {1348884, 55}, {1348885, 156}},
				Cycles: 4,
			},
		},
		{
			name: "1500 TAS (xxx).l 4af9",
			init: cpuState{
				D:   [8]uint32{4126556488, 2144218795, 2377097410, 3794780528, 3718904629, 1886831092, 2063303128, 2152114569},
				A:   [7]uint32{876504997, 668870911, 1995792002, 425146594, 917859250, 3640535218, 2617089080},
				PC:  8661832,
				SR:  42777,
				USP: 273750,
				SSP: 16287024,
				RAM: [][2]uint32{{8661828, 74}, {8661829, 249}, {8661830, 195}, {8661831, 110}, {8661832, 202}, {8661833, 235}, {8661834, 86}, {8661835, 241}, {7260906, 46}, {7260907, 254}, {8661836, 40}, {8661837, 39}},
			},
			want: cpuState{
				D:   [8]uint32{4126556488, 2144218795, 2377097410, 3794780528, 3718904629, 1886831092, 2063303128, 2152114569},
				A:   [7]uint32{876504997, 668870911, 1995792002, 425146594, 917859250, 3640535218, 2617089080},
				PC:  8661838,
				SR:  42776,
				USP: 273750,
				SSP: 16287024,
				RAM: [][2]uint32{{8661828, 74}, {8661829, 249}, {8661830, 195}, {8661831, 110}, {8661832, 202}, {8661833, 235}, {8661834, 86}, {8661835, 241}, {7260906, 46}, {7260907, 254}, {8661836, 40}, {8661837, 39}},
				Cycles: 22,
			},
		},
		{
			name: "2000 TAS -(A3) 4ae3",
			init: cpuState{
				D:   [8]uint32{4210547180, 2720205237, 3874562504, 1275066947, 2988877637, 426192815, 2382565168, 113434844},
				A:   [7]uint32{939167760, 3973310128, 3070898759, 990343217, 3083450047, 2502331836, 900985158},
				PC:  1438300,
				SR:  42260,
				USP: 2710416,
				SSP: 15232256,
				RAM: [][2]uint32{{1438296, 74}, {1438297, 227}, {1438298, 196}, {1438299, 160}, {487472, 60}, {487473, 196}, {1438300, 12}, {1438301, 172}},
			},
			want: cpuState{
				D:   [8]uint32{4210547180, 2720205237, 3874562504, 1275066947, 2988877637, 426192815, 2382565168, 113434844},
				A:   [7]uint32{939167760, 3973310128, 3070898759, 990343216, 3083450047, 2502331836, 900985158},
				PC:  1438302,
				SR:  42256,
				USP: 2710416,
				SSP: 15232256,
				RAM: [][2]uint32{{1438296, 74}, {1438297, 227}, {1438298, 196}, {1438299, 160}, {487472, 188}, {487473, 196}, {1438300, 12}, {1438301, 172}},
				Cycles: 16,
			},
		},
		{
			name: "006 TAS (A2)+ 4ada",
			init: 			cpuState{
				D:   [8]uint32{1781330078, 1468248034, 444748982, 2567936981, 2542144049, 1646720310, 2968587477, 3709415846},
				A:   [7]uint32{2816009400, 2101569103, 2124451084, 1193434085, 2469549073, 3334305352, 977864190},
				PC:  14386496,
				SR:  9247,
				USP: 11550056,
				SSP: 2398666,
				RAM: [][2]uint32{{14386492, 74}, {14386493, 218}, {14386494, 31}, {14386495, 254}, {10521868, 158}, {10521869, 78}, {14386496, 145}, {14386497, 118}},
			},
			want: 			cpuState{
				D:   [8]uint32{1781330078, 1468248034, 444748982, 2567936981, 2542144049, 1646720310, 2968587477, 3709415846},
				A:   [7]uint32{2816009400, 2101569103, 2124451085, 1193434085, 2469549073, 3334305352, 977864190},
				PC:  14386498,
				SR:  9240,
				USP: 11550056,
				SSP: 2398666,
				RAM: [][2]uint32{{14386492, 74}, {14386493, 218}, {14386494, 31}, {14386495, 254}, {10521868, 158}, {10521869, 78}, {14386496, 145}, {14386497, 118}},
				Cycles: 14,
			},
		},
		{
			name: "323 TAS (A0)+ 4ad8",
			init: 			cpuState{
				D:   [8]uint32{2734057062, 344882086, 1486538210, 1934212184, 4264249693, 2669577621, 384426043, 2903502399},
				A:   [7]uint32{2555930707, 3680818865, 2357567978, 3365973832, 1078029736, 409478672, 3181395522},
				PC:  4806094,
				SR:  10010,
				USP: 14153062,
				SSP: 2650604,
				RAM: [][2]uint32{{4806090, 74}, {4806091, 216}, {4806092, 210}, {4806093, 222}, {5793874, 93}, {5793875, 87}, {4806094, 45}, {4806095, 222}},
			},
			want: 			cpuState{
				D:   [8]uint32{2734057062, 344882086, 1486538210, 1934212184, 4264249693, 2669577621, 384426043, 2903502399},
				A:   [7]uint32{2555930708, 3680818865, 2357567978, 3365973832, 1078029736, 409478672, 3181395522},
				PC:  4806096,
				SR:  10000,
				USP: 14153062,
				SSP: 2650604,
				RAM: [][2]uint32{{4806090, 74}, {4806091, 216}, {4806092, 210}, {4806093, 222}, {5793874, 93}, {5793875, 215}, {4806094, 45}, {4806095, 222}},
				Cycles: 14,
			},
		},
		{
			name: "595 TAS -(A2) 4ae2",
			init: 			cpuState{
				D:   [8]uint32{3332053077, 2979975765, 521548093, 2673913421, 650596717, 3002924211, 1372224878, 3964264312},
				A:   [7]uint32{1535735624, 904435944, 999266385, 3811427964, 575472260, 3200728257, 1782021647},
				PC:  3041650,
				SR:  8733,
				USP: 16407346,
				SSP: 13578418,
				RAM: [][2]uint32{{3041646, 74}, {3041647, 226}, {3041648, 226}, {3041649, 58}, {9410640, 131}, {9410641, 194}, {3041650, 12}, {3041651, 183}},
			},
			want: 			cpuState{
				D:   [8]uint32{3332053077, 2979975765, 521548093, 2673913421, 650596717, 3002924211, 1372224878, 3964264312},
				A:   [7]uint32{1535735624, 904435944, 999266384, 3811427964, 575472260, 3200728257, 1782021647},
				PC:  3041652,
				SR:  8728,
				USP: 16407346,
				SSP: 13578418,
				RAM: [][2]uint32{{3041646, 74}, {3041647, 226}, {3041648, 226}, {3041649, 58}, {9410640, 131}, {9410641, 194}, {3041650, 12}, {3041651, 183}},
				Cycles: 16,
			},
		},
		{
			name: "876 TAS -(A2) 4ae2",
			init: 			cpuState{
				D:   [8]uint32{2290506129, 2868815557, 127601230, 2784570348, 1925393997, 492220761, 3582698295, 3253040100},
				A:   [7]uint32{3258002521, 4009195790, 713876722, 2325914005, 193403126, 1556622425, 2903251810},
				PC:  6931154,
				SR:  275,
				USP: 3138974,
				SSP: 6376762,
				RAM: [][2]uint32{{6931150, 74}, {6931151, 226}, {6931152, 238}, {6931153, 123}, {9233648, 42}, {9233649, 22}, {6931154, 43}, {6931155, 64}},
			},
			want: 			cpuState{
				D:   [8]uint32{2290506129, 2868815557, 127601230, 2784570348, 1925393997, 492220761, 3582698295, 3253040100},
				A:   [7]uint32{3258002521, 4009195790, 713876721, 2325914005, 193403126, 1556622425, 2903251810},
				PC:  6931156,
				SR:  272,
				USP: 3138974,
				SSP: 6376762,
				RAM: [][2]uint32{{6931150, 74}, {6931151, 226}, {6931152, 238}, {6931153, 123}, {9233648, 42}, {9233649, 150}, {6931154, 43}, {6931155, 64}},
				Cycles: 16,
			},
		},
		{
			name: "1129 TAS (d8, A2, Xn) 4af2",
			init: 			cpuState{
				D:   [8]uint32{2101097519, 3630933105, 147402401, 3140382326, 147115190, 1093859320, 2264055117, 3956540067},
				A:   [7]uint32{3211617201, 3312769867, 3007525540, 4224281614, 4059646407, 2558252024, 3293439005},
				PC:  7353300,
				SR:  9752,
				USP: 11883830,
				SSP: 4217190,
				RAM: [][2]uint32{{7353296, 74}, {7353297, 242}, {7353298, 197}, {7353299, 121}, {7353300, 54}, {7353301, 1}, {4422884, 37}, {4422885, 197}, {7353302, 114}, {7353303, 26}},
			},
			want: 			cpuState{
				D:   [8]uint32{2101097519, 3630933105, 147402401, 3140382326, 147115190, 1093859320, 2264055117, 3956540067},
				A:   [7]uint32{3211617201, 3312769867, 3007525540, 4224281614, 4059646407, 2558252024, 3293439005},
				PC:  7353304,
				SR:  9744,
				USP: 11883830,
				SSP: 4217190,
				RAM: [][2]uint32{{7353296, 74}, {7353297, 242}, {7353298, 197}, {7353299, 121}, {7353300, 54}, {7353301, 1}, {4422884, 165}, {4422885, 197}, {7353302, 114}, {7353303, 26}},
				Cycles: 20,
			},
		},
		{
			name: "1402 TAS (d16, A1) 4ae9",
			init: 			cpuState{
				D:   [8]uint32{2813586711, 4184812214, 3878394197, 1168362210, 1289064298, 1180021104, 3115054955, 2103938723},
				A:   [7]uint32{1542578283, 2957113806, 2761915592, 2694190575, 1877052059, 2244433884, 2920747588},
				PC:  10799638,
				SR:  8972,
				USP: 3076008,
				SSP: 5764174,
				RAM: [][2]uint32{{10799634, 74}, {10799635, 233}, {10799636, 105}, {10799637, 231}, {10799638, 51}, {10799639, 254}, {4350900, 34}, {4350901, 156}, {10799640, 138}, {10799641, 71}},
			},
			want: 			cpuState{
				D:   [8]uint32{2813586711, 4184812214, 3878394197, 1168362210, 1289064298, 1180021104, 3115054955, 2103938723},
				A:   [7]uint32{1542578283, 2957113806, 2761915592, 2694190575, 1877052059, 2244433884, 2920747588},
				PC:  10799642,
				SR:  8968,
				USP: 3076008,
				SSP: 5764174,
				RAM: [][2]uint32{{10799634, 74}, {10799635, 233}, {10799636, 105}, {10799637, 231}, {10799638, 51}, {10799639, 254}, {4350900, 34}, {4350901, 156}, {10799640, 138}, {10799641, 71}},
				Cycles: 18,
			},
		},
		{
			name: "1661 TAS (xxx).w 4af8",
			init: 			cpuState{
				D:   [8]uint32{3045404764, 4255849924, 3234251181, 1364103443, 2325228500, 2323727793, 2787041552, 1769656154},
				A:   [7]uint32{2734133130, 2235939704, 3873213397, 3758208818, 1508386593, 4037793690, 3966651130},
				PC:  15148180,
				SR:  9746,
				USP: 4194590,
				SSP: 14513584,
				RAM: [][2]uint32{{15148176, 74}, {15148177, 248}, {15148178, 150}, {15148179, 2}, {15148180, 83}, {15148181, 237}, {16750082, 167}, {16750083, 67}, {15148182, 76}, {15148183, 210}},
			},
			want: 			cpuState{
				D:   [8]uint32{3045404764, 4255849924, 3234251181, 1364103443, 2325228500, 2323727793, 2787041552, 1769656154},
				A:   [7]uint32{2734133130, 2235939704, 3873213397, 3758208818, 1508386593, 4037793690, 3966651130},
				PC:  15148184,
				SR:  9752,
				USP: 4194590,
				SSP: 14513584,
				RAM: [][2]uint32{{15148176, 74}, {15148177, 248}, {15148178, 150}, {15148179, 2}, {15148180, 83}, {15148181, 237}, {16750082, 167}, {16750083, 67}, {15148182, 76}, {15148183, 210}},
				Cycles: 18,
			},
		},
		{
			name: "1948 TAS (d8, A5, Xn) 4af5",
			init: 			cpuState{
				D:   [8]uint32{442811541, 3497331804, 3336332236, 1260957963, 3766619483, 3529779909, 75321032, 1609517809},
				A:   [7]uint32{6371743, 3248920974, 3669701005, 2727008527, 2816054104, 2043380584, 1311556979},
				PC:  7540832,
				SR:  1556,
				USP: 15080994,
				SSP: 11804432,
				RAM: [][2]uint32{{7540828, 74}, {7540829, 245}, {7540830, 145}, {7540831, 63}, {7540832, 109}, {7540833, 125}, {13311284, 133}, {13311285, 250}, {7540834, 122}, {7540835, 61}},
			},
			want: 			cpuState{
				D:   [8]uint32{442811541, 3497331804, 3336332236, 1260957963, 3766619483, 3529779909, 75321032, 1609517809},
				A:   [7]uint32{6371743, 3248920974, 3669701005, 2727008527, 2816054104, 2043380584, 1311556979},
				PC:  7540836,
				SR:  1560,
				USP: 15080994,
				SSP: 11804432,
				RAM: [][2]uint32{{7540828, 74}, {7540829, 245}, {7540830, 145}, {7540831, 63}, {7540832, 109}, {7540833, 125}, {13311284, 133}, {13311285, 250}, {7540834, 122}, {7540835, 61}},
				Cycles: 20,
			},
		},
		{
			name: "2248 TAS (d16, A4) 4aec",
			init: 			cpuState{
				D:   [8]uint32{2999129214, 349180250, 2875540857, 1009670097, 2823609168, 3965906490, 2014473227, 3365981024},
				A:   [7]uint32{2324172837, 3296427920, 299308091, 3315500357, 867606610, 580104645, 2730520504},
				PC:  11729376,
				SR:  9730,
				USP: 2560506,
				SSP: 7869230,
				RAM: [][2]uint32{{11729372, 74}, {11729373, 236}, {11729374, 82}, {11729375, 186}, {11729376, 141}, {11729377, 206}, {11989772, 68}, {11989773, 165}, {11729378, 25}, {11729379, 190}},
			},
			want: 			cpuState{
				D:   [8]uint32{2999129214, 349180250, 2875540857, 1009670097, 2823609168, 3965906490, 2014473227, 3365981024},
				A:   [7]uint32{2324172837, 3296427920, 299308091, 3315500357, 867606610, 580104645, 2730520504},
				PC:  11729380,
				SR:  9728,
				USP: 2560506,
				SSP: 7869230,
				RAM: [][2]uint32{{11729372, 74}, {11729373, 236}, {11729374, 82}, {11729375, 186}, {11729376, 141}, {11729377, 206}, {11989772, 196}, {11989773, 165}, {11729378, 25}, {11729379, 190}},
				Cycles: 18,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASL_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASL.b 1, D2 e302",
			init: cpuState{
				D:   [8]uint32{875122622, 4111649065, 1754384516, 392181203, 3680896859, 2161660848, 3697039902, 3045704204},
				A:   [7]uint32{445143942, 1442374805, 1099806095, 1182746079, 2955049898, 1151481773, 3019223192},
				PC:  16273272,
				SR:  1792,
				USP: 11073950,
				SSP: 16297356,
				RAM: [][2]uint32{{16273268, 227}, {16273269, 2}, {16273270, 126}, {16273271, 173}, {16273272, 255}, {16273273, 135}},
			},
			want: cpuState{
				D:   [8]uint32{875122622, 4111649065, 1754384392, 392181203, 3680896859, 2161660848, 3697039902, 3045704204},
				A:   [7]uint32{445143942, 1442374805, 1099806095, 1182746079, 2955049898, 1151481773, 3019223192},
				PC:  16273274,
				SR:  1811,
				USP: 11073950,
				SSP: 16297356,
				RAM: [][2]uint32{{16273268, 227}, {16273269, 2}, {16273270, 126}, {16273271, 173}, {16273272, 255}, {16273273, 135}},
				Cycles: 8,
			},
		},
		{
			name: "500 ASL.b 8, D0 e100",
			init: cpuState{
				D:   [8]uint32{673363832, 1993553946, 1472174388, 472367546, 95326562, 2137670768, 2573278204, 2334569608},
				A:   [7]uint32{1976378004, 1577976583, 81391573, 3037850526, 2307021931, 3082485992, 2318219166},
				PC:  12821334,
				SR:  9495,
				USP: 13854126,
				SSP: 4728506,
				RAM: [][2]uint32{{12821330, 225}, {12821331, 0}, {12821332, 111}, {12821333, 31}, {12821334, 158}, {12821335, 165}},
			},
			want: cpuState{
				D:   [8]uint32{673363712, 1993553946, 1472174388, 472367546, 95326562, 2137670768, 2573278204, 2334569608},
				A:   [7]uint32{1976378004, 1577976583, 81391573, 3037850526, 2307021931, 3082485992, 2318219166},
				PC:  12821336,
				SR:  9478,
				USP: 13854126,
				SSP: 4728506,
				RAM: [][2]uint32{{12821330, 225}, {12821331, 0}, {12821332, 111}, {12821333, 31}, {12821334, 158}, {12821335, 165}},
				Cycles: 22,
			},
		},
		{
			name: "1000 ASL.b 4, D7 e907",
			init: cpuState{
				D:   [8]uint32{3150777779, 1735826715, 1532529704, 1810020561, 2118263218, 1021692324, 2005573281, 1030099778},
				A:   [7]uint32{2456376930, 70475776, 2612981882, 644034903, 1881967461, 2591800828, 2537137491},
				PC:  7070286,
				SR:  9237,
				USP: 16745226,
				SSP: 7120282,
				RAM: [][2]uint32{{7070282, 233}, {7070283, 7}, {7070284, 74}, {7070285, 171}, {7070286, 11}, {7070287, 88}},
			},
			want: cpuState{
				D:   [8]uint32{3150777779, 1735826715, 1532529704, 1810020561, 2118263218, 1021692324, 2005573281, 1030099744},
				A:   [7]uint32{2456376930, 70475776, 2612981882, 644034903, 1881967461, 2591800828, 2537137491},
				PC:  7070288,
				SR:  9218,
				USP: 16745226,
				SSP: 7120282,
				RAM: [][2]uint32{{7070282, 233}, {7070283, 7}, {7070284, 74}, {7070285, 171}, {7070286, 11}, {7070287, 88}},
				Cycles: 14,
			},
		},
		{
			name: "1500 ASL.b D0, D4 e124",
			init: cpuState{
				D:   [8]uint32{3038561655, 2698003617, 3922631168, 1869561148, 1939375905, 3245064430, 3189622093, 1316050872},
				A:   [7]uint32{195230606, 829271525, 1272691395, 1146993499, 2684657812, 1642100042, 3751314201},
				PC:  7153904,
				SR:  42520,
				USP: 855908,
				SSP: 4145578,
				RAM: [][2]uint32{{7153900, 225}, {7153901, 36}, {7153902, 253}, {7153903, 181}, {7153904, 35}, {7153905, 235}},
			},
			want: cpuState{
				D:   [8]uint32{3038561655, 2698003617, 3922631168, 1869561148, 1939375872, 3245064430, 3189622093, 1316050872},
				A:   [7]uint32{195230606, 829271525, 1272691395, 1146993499, 2684657812, 1642100042, 3751314201},
				PC:  7153906,
				SR:  42502,
				USP: 855908,
				SSP: 4145578,
				RAM: [][2]uint32{{7153900, 225}, {7153901, 36}, {7153902, 253}, {7153903, 181}, {7153904, 35}, {7153905, 235}},
				Cycles: 116,
			},
		},
		{
			name: "2000 ASL.b 4, D5 e905",
			init: cpuState{
				D:   [8]uint32{673261894, 2484618920, 754659243, 2875158429, 148509987, 554133818, 4229442805, 3057099833},
				A:   [7]uint32{3437205811, 3726691622, 2964354284, 3167931945, 3739329545, 379718803, 1068304398},
				PC:  9855416,
				SR:  8967,
				USP: 16090328,
				SSP: 12062992,
				RAM: [][2]uint32{{9855412, 233}, {9855413, 5}, {9855414, 231}, {9855415, 14}, {9855416, 149}, {9855417, 210}},
			},
			want: cpuState{
				D:   [8]uint32{673261894, 2484618920, 754659243, 2875158429, 148509987, 554133920, 4229442805, 3057099833},
				A:   [7]uint32{3437205811, 3726691622, 2964354284, 3167931945, 3739329545, 379718803, 1068304398},
				PC:  9855418,
				SR:  8987,
				USP: 16090328,
				SSP: 12062992,
				RAM: [][2]uint32{{9855412, 233}, {9855413, 5}, {9855414, 231}, {9855415, 14}, {9855416, 149}, {9855417, 210}},
				Cycles: 14,
			},
		},
		{
			name: "002 ASL.b 1, D7 e307",
			init: 			cpuState{
				D:   [8]uint32{1597770583, 4025836866, 711038017, 1901274242, 3571016029, 3029954991, 3040580514, 630737688},
				A:   [7]uint32{1575690797, 797902699, 2212508197, 269857002, 2038733373, 3853998130, 1793792447},
				PC:  7336566,
				SR:  1048,
				USP: 16479092,
				SSP: 2851026,
				RAM: [][2]uint32{{7336562, 227}, {7336563, 7}, {7336564, 203}, {7336565, 98}, {7336566, 191}, {7336567, 144}},
			},
			want: 			cpuState{
				D:   [8]uint32{1597770583, 4025836866, 711038017, 1901274242, 3571016029, 3029954991, 3040580514, 630737712},
				A:   [7]uint32{1575690797, 797902699, 2212508197, 269857002, 2038733373, 3853998130, 1793792447},
				PC:  7336568,
				SR:  1024,
				USP: 16479092,
				SSP: 2851026,
				RAM: [][2]uint32{{7336562, 227}, {7336563, 7}, {7336564, 203}, {7336565, 98}, {7336566, 191}, {7336567, 144}},
				Cycles: 8,
			},
		},
		{
			name: "307 ASL.b 6, D1 ed01",
			init: 			cpuState{
				D:   [8]uint32{102737531, 4242642441, 3643086454, 2612447849, 2107989576, 3719694543, 2663035295, 3536320023},
				A:   [7]uint32{1132041441, 1441409205, 2122139041, 1051598564, 708294123, 2668329680, 3577538547},
				PC:  10101234,
				SR:  9758,
				USP: 5934778,
				SSP: 1839322,
				RAM: [][2]uint32{{10101230, 237}, {10101231, 1}, {10101232, 249}, {10101233, 9}, {10101234, 173}, {10101235, 87}},
			},
			want: 			cpuState{
				D:   [8]uint32{102737531, 4242642496, 3643086454, 2612447849, 2107989576, 3719694543, 2663035295, 3536320023},
				A:   [7]uint32{1132041441, 1441409205, 2122139041, 1051598564, 708294123, 2668329680, 3577538547},
				PC:  10101236,
				SR:  9730,
				USP: 5934778,
				SSP: 1839322,
				RAM: [][2]uint32{{10101230, 237}, {10101231, 1}, {10101232, 249}, {10101233, 9}, {10101234, 173}, {10101235, 87}},
				Cycles: 18,
			},
		},
		{
			name: "604 ASL.b D4, D0 e920",
			init: 			cpuState{
				D:   [8]uint32{1669297650, 316182939, 2536919652, 2554091092, 2682972595, 3237853581, 2956312607, 1817563944},
				A:   [7]uint32{3817906815, 3663471947, 3310003462, 744605963, 3492207626, 4237952106, 4173869086},
				PC:  13252612,
				SR:  258,
				USP: 6586360,
				SSP: 5460554,
				RAM: [][2]uint32{{13252608, 233}, {13252609, 32}, {13252610, 137}, {13252611, 214}, {13252612, 239}, {13252613, 137}},
			},
			want: 			cpuState{
				D:   [8]uint32{1669297408, 316182939, 2536919652, 2554091092, 2682972595, 3237853581, 2956312607, 1817563944},
				A:   [7]uint32{3817906815, 3663471947, 3310003462, 744605963, 3492207626, 4237952106, 4173869086},
				PC:  13252614,
				SR:  262,
				USP: 6586360,
				SSP: 5460554,
				RAM: [][2]uint32{{13252608, 233}, {13252609, 32}, {13252610, 137}, {13252611, 214}, {13252612, 239}, {13252613, 137}},
				Cycles: 108,
			},
		},
		{
			name: "900 ASL.b D6, D3 ed23",
			init: 			cpuState{
				D:   [8]uint32{3575451392, 1990853273, 4112958638, 2273248363, 3120527594, 2041851395, 4233617712, 1576283163},
				A:   [7]uint32{4080076947, 78401869, 3961169333, 318378203, 2856768388, 3744530379, 545724702},
				PC:  3992180,
				SR:  1552,
				USP: 1806216,
				SSP: 4515368,
				RAM: [][2]uint32{{3992176, 237}, {3992177, 35}, {3992178, 85}, {3992179, 197}, {3992180, 183}, {3992181, 180}},
			},
			want: 			cpuState{
				D:   [8]uint32{3575451392, 1990853273, 4112958638, 2273248256, 3120527594, 2041851395, 4233617712, 1576283163},
				A:   [7]uint32{4080076947, 78401869, 3961169333, 318378203, 2856768388, 3744530379, 545724702},
				PC:  3992182,
				SR:  1542,
				USP: 1806216,
				SSP: 4515368,
				RAM: [][2]uint32{{3992176, 237}, {3992177, 35}, {3992178, 85}, {3992179, 197}, {3992180, 183}, {3992181, 180}},
				Cycles: 102,
			},
		},
		{
			name: "1184 ASL.b D7, D1 ef21",
			init: 			cpuState{
				D:   [8]uint32{765007297, 2019916232, 176045278, 2020570488, 3442210563, 1313949661, 2790295719, 975180524},
				A:   [7]uint32{3243538046, 2243689219, 2059790441, 169596567, 2791636051, 3772383416, 1959961689},
				PC:  13833490,
				SR:  770,
				USP: 2732774,
				SSP: 1472546,
				RAM: [][2]uint32{{13833486, 239}, {13833487, 33}, {13833488, 10}, {13833489, 112}, {13833490, 239}, {13833491, 105}},
			},
			want: 			cpuState{
				D:   [8]uint32{765007297, 2019916032, 176045278, 2020570488, 3442210563, 1313949661, 2790295719, 975180524},
				A:   [7]uint32{3243538046, 2243689219, 2059790441, 169596567, 2791636051, 3772383416, 1959961689},
				PC:  13833492,
				SR:  774,
				USP: 2732774,
				SSP: 1472546,
				RAM: [][2]uint32{{13833486, 239}, {13833487, 33}, {13833488, 10}, {13833489, 112}, {13833490, 239}, {13833491, 105}},
				Cycles: 94,
			},
		},
		{
			name: "1451 ASL.b 8, D4 e104",
			init: 			cpuState{
				D:   [8]uint32{431167854, 2704997462, 1008417308, 3204856185, 4169317170, 1116005176, 968480421, 2312351613},
				A:   [7]uint32{4241690952, 2676680901, 3410788458, 683296383, 1133227929, 420294959, 858392402},
				PC:  14857710,
				SR:  9984,
				USP: 14530924,
				SSP: 7962400,
				RAM: [][2]uint32{{14857706, 225}, {14857707, 4}, {14857708, 50}, {14857709, 105}, {14857710, 51}, {14857711, 242}},
			},
			want: 			cpuState{
				D:   [8]uint32{431167854, 2704997462, 1008417308, 3204856185, 4169317120, 1116005176, 968480421, 2312351613},
				A:   [7]uint32{4241690952, 2676680901, 3410788458, 683296383, 1133227929, 420294959, 858392402},
				PC:  14857712,
				SR:  9990,
				USP: 14530924,
				SSP: 7962400,
				RAM: [][2]uint32{{14857706, 225}, {14857707, 4}, {14857708, 50}, {14857709, 105}, {14857710, 51}, {14857711, 242}},
				Cycles: 22,
			},
		},
		{
			name: "1723 ASL.b D1, D2 e322",
			init: 			cpuState{
				D:   [8]uint32{125573891, 59039414, 2540392943, 2852755211, 2813218111, 2268151036, 3848525419, 2528465313},
				A:   [7]uint32{190002102, 2022870779, 636390121, 1903905065, 554365790, 1923854297, 3424986587},
				PC:  4246874,
				SR:  538,
				USP: 5979160,
				SSP: 931002,
				RAM: [][2]uint32{{4246870, 227}, {4246871, 34}, {4246872, 118}, {4246873, 124}, {4246874, 184}, {4246875, 181}},
			},
			want: 			cpuState{
				D:   [8]uint32{125573891, 59039414, 2540392704, 2852755211, 2813218111, 2268151036, 3848525419, 2528465313},
				A:   [7]uint32{190002102, 2022870779, 636390121, 1903905065, 554365790, 1923854297, 3424986587},
				PC:  4246876,
				SR:  518,
				USP: 5979160,
				SSP: 931002,
				RAM: [][2]uint32{{4246870, 227}, {4246871, 34}, {4246872, 118}, {4246873, 124}, {4246874, 184}, {4246875, 181}},
				Cycles: 114,
			},
		},
		{
			name: "1993 ASL.b D5, D3 eb23",
			init: 			cpuState{
				D:   [8]uint32{2125052707, 3899799888, 1453216769, 216544843, 2686782617, 3908777585, 3511723422, 2940592841},
				A:   [7]uint32{258645293, 780657774, 3157855692, 2260352904, 2042336775, 2556988064, 4232677707},
				PC:  16488272,
				SR:  537,
				USP: 12743732,
				SSP: 14159862,
				RAM: [][2]uint32{{16488268, 235}, {16488269, 35}, {16488270, 130}, {16488271, 102}, {16488272, 157}, {16488273, 125}},
			},
			want: 			cpuState{
				D:   [8]uint32{2125052707, 3899799888, 1453216769, 216544768, 2686782617, 3908777585, 3511723422, 2940592841},
				A:   [7]uint32{258645293, 780657774, 3157855692, 2260352904, 2042336775, 2556988064, 4232677707},
				PC:  16488274,
				SR:  518,
				USP: 12743732,
				SSP: 14159862,
				RAM: [][2]uint32{{16488268, 235}, {16488269, 35}, {16488270, 130}, {16488271, 102}, {16488272, 157}, {16488273, 125}},
				Cycles: 104,
			},
		},
		{
			name: "2255 ASL.b 5, D5 eb05",
			init: 			cpuState{
				D:   [8]uint32{1389031692, 452091276, 1452348020, 342980513, 339828088, 2739057890, 3493433566, 3998275187},
				A:   [7]uint32{4053655129, 1802141410, 2468555782, 679864883, 2432050107, 3976455046, 3267729441},
				PC:  14803298,
				SR:  9482,
				USP: 8492242,
				SSP: 4954016,
				RAM: [][2]uint32{{14803294, 235}, {14803295, 5}, {14803296, 57}, {14803297, 138}, {14803298, 82}, {14803299, 102}},
			},
			want: 			cpuState{
				D:   [8]uint32{1389031692, 452091276, 1452348020, 342980513, 339828088, 2739057728, 3493433566, 3998275187},
				A:   [7]uint32{4053655129, 1802141410, 2468555782, 679864883, 2432050107, 3976455046, 3267729441},
				PC:  14803300,
				SR:  9474,
				USP: 8492242,
				SSP: 4954016,
				RAM: [][2]uint32{{14803294, 235}, {14803295, 5}, {14803296, 57}, {14803297, 138}, {14803298, 82}, {14803299, 102}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASL_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASL.w D5, D0 eb60",
			init: cpuState{
				D:   [8]uint32{539159205, 1202972415, 1760886831, 2020840429, 745339187, 2945258589, 3163311252, 1696235226},
				A:   [7]uint32{2902778343, 432696657, 4208285870, 3029119350, 803463438, 2960705152, 4130681196},
				PC:  5324164,
				SR:  8195,
				USP: 12337110,
				SSP: 8421566,
				RAM: [][2]uint32{{5324160, 235}, {5324161, 96}, {5324162, 134}, {5324163, 254}, {5324164, 153}, {5324165, 31}},
			},
			want: cpuState{
				D:   [8]uint32{539099136, 1202972415, 1760886831, 2020840429, 745339187, 2945258589, 3163311252, 1696235226},
				A:   [7]uint32{2902778343, 432696657, 4208285870, 3029119350, 803463438, 2960705152, 4130681196},
				PC:  5324166,
				SR:  8198,
				USP: 12337110,
				SSP: 8421566,
				RAM: [][2]uint32{{5324160, 235}, {5324161, 96}, {5324162, 134}, {5324163, 254}, {5324164, 153}, {5324165, 31}},
				Cycles: 64,
			},
		},
		{
			name: "500 ASL.w D2, D5 e565",
			init: cpuState{
				D:   [8]uint32{2443348151, 239698236, 2472801233, 3290802018, 1505723894, 3566917740, 3404557678, 1462880053},
				A:   [7]uint32{91578042, 3445264485, 1417601859, 2017286878, 4203496097, 3499681620, 745472717},
				PC:  7657320,
				SR:  34330,
				USP: 8456762,
				SSP: 5580446,
				RAM: [][2]uint32{{7657316, 229}, {7657317, 101}, {7657318, 144}, {7657319, 140}, {7657320, 117}, {7657321, 79}},
			},
			want: cpuState{
				D:   [8]uint32{2443348151, 239698236, 2472801233, 3290802018, 1505723894, 3566862336, 3404557678, 1462880053},
				A:   [7]uint32{91578042, 3445264485, 1417601859, 2017286878, 4203496097, 3499681620, 745472717},
				PC:  7657322,
				SR:  34310,
				USP: 8456762,
				SSP: 5580446,
				RAM: [][2]uint32{{7657316, 229}, {7657317, 101}, {7657318, 144}, {7657319, 140}, {7657320, 117}, {7657321, 79}},
				Cycles: 40,
			},
		},
		{
			name: "1000 ASL.w D4, D2 e962",
			init: cpuState{
				D:   [8]uint32{1400751805, 594940556, 660139233, 2688838918, 4253667950, 2729790547, 2824616381, 1101188300},
				A:   [7]uint32{1459531919, 83035182, 3936258490, 3395440469, 1475188992, 1573944542, 3976942288},
				PC:  10813322,
				SR:  42770,
				USP: 16244440,
				SSP: 4729766,
				RAM: [][2]uint32{{10813318, 233}, {10813319, 98}, {10813320, 44}, {10813321, 126}, {10813322, 113}, {10813323, 130}},
			},
			want: cpuState{
				D:   [8]uint32{1400751805, 594940556, 660078592, 2688838918, 4253667950, 2729790547, 2824616381, 1101188300},
				A:   [7]uint32{1459531919, 83035182, 3936258490, 3395440469, 1475188992, 1573944542, 3976942288},
				PC:  10813324,
				SR:  42758,
				USP: 16244440,
				SSP: 4729766,
				RAM: [][2]uint32{{10813318, 233}, {10813319, 98}, {10813320, 44}, {10813321, 126}, {10813322, 113}, {10813323, 130}},
				Cycles: 98,
			},
		},
		{
			name: "1500 ASL.w D1, D1 e361",
			init: cpuState{
				D:   [8]uint32{3666789643, 1226891360, 2066906508, 2430558429, 3784255303, 2960781086, 587753782, 3215490847},
				A:   [7]uint32{2420226123, 495740418, 356355805, 1799993087, 792674289, 1369516552, 3236422977},
				PC:  10609462,
				SR:  8459,
				USP: 16666626,
				SSP: 11326658,
				RAM: [][2]uint32{{10609458, 227}, {10609459, 97}, {10609460, 209}, {10609461, 24}, {10609462, 163}, {10609463, 8}},
			},
			want: cpuState{
				D:   [8]uint32{3666789643, 1226833920, 2066906508, 2430558429, 3784255303, 2960781086, 587753782, 3215490847},
				A:   [7]uint32{2420226123, 495740418, 356355805, 1799993087, 792674289, 1369516552, 3236422977},
				PC:  10609464,
				SR:  8454,
				USP: 16666626,
				SSP: 11326658,
				RAM: [][2]uint32{{10609458, 227}, {10609459, 97}, {10609460, 209}, {10609461, 24}, {10609462, 163}, {10609463, 8}},
				Cycles: 70,
			},
		},
		{
			name: "2000 ASL.w D3, D3 e763",
			init: cpuState{
				D:   [8]uint32{328502899, 3910851602, 568107334, 1847075312, 1497163261, 3799814321, 3040708348, 2964973670},
				A:   [7]uint32{1527148525, 1132465856, 619813685, 4144486560, 603163528, 1486687062, 2607866933},
				PC:  6044604,
				SR:  33793,
				USP: 16132034,
				SSP: 1238522,
				RAM: [][2]uint32{{6044600, 231}, {6044601, 99}, {6044602, 165}, {6044603, 203}, {6044604, 25}, {6044605, 79}},
			},
			want: cpuState{
				D:   [8]uint32{328502899, 3910851602, 568107334, 1847066624, 1497163261, 3799814321, 3040708348, 2964973670},
				A:   [7]uint32{1527148525, 1132465856, 619813685, 4144486560, 603163528, 1486687062, 2607866933},
				PC:  6044606,
				SR:  33798,
				USP: 16132034,
				SSP: 1238522,
				RAM: [][2]uint32{{6044600, 231}, {6044601, 99}, {6044602, 165}, {6044603, 203}, {6044604, 25}, {6044605, 79}},
				Cycles: 102,
			},
		},
		{
			name: "006 ASL.w D0, D3 e163",
			init: 			cpuState{
				D:   [8]uint32{2863606749, 917844242, 2488522343, 1301704346, 1054373816, 1133455484, 2306983646, 2758142394},
				A:   [7]uint32{1611868598, 4114068307, 3691429117, 3027354935, 1702842494, 2990770826, 1242386665},
				PC:  15281392,
				SR:  8976,
				USP: 4212468,
				SSP: 778040,
				RAM: [][2]uint32{{15281388, 225}, {15281389, 99}, {15281390, 59}, {15281391, 223}, {15281392, 233}, {15281393, 214}},
			},
			want: 			cpuState{
				D:   [8]uint32{2863606749, 917844242, 2488522343, 1301676032, 1054373816, 1133455484, 2306983646, 2758142394},
				A:   [7]uint32{1611868598, 4114068307, 3691429117, 3027354935, 1702842494, 2990770826, 1242386665},
				PC:  15281394,
				SR:  8966,
				USP: 4212468,
				SSP: 778040,
				RAM: [][2]uint32{{15281388, 225}, {15281389, 99}, {15281390, 59}, {15281391, 223}, {15281392, 233}, {15281393, 214}},
				Cycles: 64,
			},
		},
		{
			name: "291 ASL.w (A5) e1d5",
			init: 			cpuState{
				D:   [8]uint32{2018927774, 805431265, 3371228088, 2118685335, 3073292131, 1641956992, 3551187641, 561461500},
				A:   [7]uint32{2497228232, 1239858459, 430554527, 3019547497, 2542436420, 2150514008, 3974277696},
				PC:  11113732,
				SR:  9240,
				USP: 13355860,
				SSP: 11925804,
				RAM: [][2]uint32{{11113728, 225}, {11113729, 213}, {11113730, 46}, {11113731, 240}, {3030360, 31}, {3030361, 93}, {11113732, 208}, {11113733, 234}},
			},
			want: 			cpuState{
				D:   [8]uint32{2018927774, 805431265, 3371228088, 2118685335, 3073292131, 1641956992, 3551187641, 561461500},
				A:   [7]uint32{2497228232, 1239858459, 430554527, 3019547497, 2542436420, 2150514008, 3974277696},
				PC:  11113734,
				SR:  9216,
				USP: 13355860,
				SSP: 11925804,
				RAM: [][2]uint32{{11113728, 225}, {11113729, 213}, {11113730, 46}, {11113731, 240}, {3030360, 62}, {3030361, 186}, {11113732, 208}, {11113733, 234}},
				Cycles: 12,
			},
		},
		{
			name: "570 ASL.w D4, D5 e965",
			init: 			cpuState{
				D:   [8]uint32{3842186365, 777260458, 3705400791, 47947024, 384155935, 17749968, 929206981, 2166321168},
				A:   [7]uint32{2668610875, 3815995834, 2151825589, 2007242721, 4183001086, 1810612320, 3254857570},
				PC:  2008006,
				SR:  9479,
				USP: 10596164,
				SSP: 11815078,
				RAM: [][2]uint32{{2008002, 233}, {2008003, 101}, {2008004, 215}, {2008005, 62}, {2008006, 77}, {2008007, 227}},
			},
			want: 			cpuState{
				D:   [8]uint32{3842186365, 777260458, 3705400791, 47947024, 384155935, 17694720, 929206981, 2166321168},
				A:   [7]uint32{2668610875, 3815995834, 2151825589, 2007242721, 4183001086, 1810612320, 3254857570},
				PC:  2008008,
				SR:  9478,
				USP: 10596164,
				SSP: 11815078,
				RAM: [][2]uint32{{2008002, 233}, {2008003, 101}, {2008004, 215}, {2008005, 62}, {2008006, 77}, {2008007, 227}},
				Cycles: 68,
			},
		},
		{
			name: "842 ASL.w -(A3) e1e3",
			init: 			cpuState{
				D:   [8]uint32{665034039, 4276959070, 3269059991, 1202235734, 2021660809, 2141397432, 22442713, 2310841441},
				A:   [7]uint32{264447502, 1955978178, 676551287, 703062468, 1903666547, 3376283910, 1096916165},
				PC:  14300648,
				SR:  8714,
				USP: 6498772,
				SSP: 7079080,
				RAM: [][2]uint32{{14300644, 225}, {14300645, 227}, {14300646, 171}, {14300647, 222}, {15196610, 33}, {15196611, 11}, {14300648, 210}, {14300649, 233}},
			},
			want: 			cpuState{
				D:   [8]uint32{665034039, 4276959070, 3269059991, 1202235734, 2021660809, 2141397432, 22442713, 2310841441},
				A:   [7]uint32{264447502, 1955978178, 676551287, 703062466, 1903666547, 3376283910, 1096916165},
				PC:  14300650,
				SR:  8704,
				USP: 6498772,
				SSP: 7079080,
				RAM: [][2]uint32{{14300644, 225}, {14300645, 227}, {14300646, 171}, {14300647, 222}, {15196610, 66}, {15196611, 22}, {14300648, 210}, {14300649, 233}},
				Cycles: 14,
			},
		},
		{
			name: "1085 ASL.w 3, D6 e746",
			init: 			cpuState{
				D:   [8]uint32{2194639868, 4099141813, 794453120, 3004024159, 548905456, 3119160947, 2658366665, 3568718846},
				A:   [7]uint32{904599548, 425227090, 703013915, 473802008, 1103042774, 3012653164, 694953626},
				PC:  5604482,
				SR:  1819,
				USP: 8211694,
				SSP: 10794690,
				RAM: [][2]uint32{{5604478, 231}, {5604479, 70}, {5604480, 35}, {5604481, 85}, {5604482, 91}, {5604483, 111}},
			},
			want: 			cpuState{
				D:   [8]uint32{2194639868, 4099141813, 794453120, 3004024159, 548905456, 3119160947, 2658379336, 3568718846},
				A:   [7]uint32{904599548, 425227090, 703013915, 473802008, 1103042774, 3012653164, 694953626},
				PC:  5604484,
				SR:  1819,
				USP: 8211694,
				SSP: 10794690,
				RAM: [][2]uint32{{5604478, 231}, {5604479, 70}, {5604480, 35}, {5604481, 85}, {5604482, 91}, {5604483, 111}},
				Cycles: 12,
			},
		},
		{
			name: "1364 ASL.w D4, D2 e962",
			init: 			cpuState{
				D:   [8]uint32{1850657302, 2191246048, 3382450051, 3538227001, 4210196856, 4252259932, 622001868, 3581667917},
				A:   [7]uint32{1019118885, 3249847234, 362705697, 3448080082, 3668940692, 2363840257, 2363123943},
				PC:  13301834,
				SR:  10002,
				USP: 5767564,
				SSP: 1753210,
				RAM: [][2]uint32{{13301830, 233}, {13301831, 98}, {13301832, 206}, {13301833, 5}, {13301834, 157}, {13301835, 54}},
			},
			want: 			cpuState{
				D:   [8]uint32{1850657302, 2191246048, 3382444032, 3538227001, 4210196856, 4252259932, 622001868, 3581667917},
				A:   [7]uint32{1019118885, 3249847234, 362705697, 3448080082, 3668940692, 2363840257, 2363123943},
				PC:  13301836,
				SR:  9990,
				USP: 5767564,
				SSP: 1753210,
				RAM: [][2]uint32{{13301830, 233}, {13301831, 98}, {13301832, 206}, {13301833, 5}, {13301834, 157}, {13301835, 54}},
				Cycles: 118,
			},
		},
		{
			name: "1652 ASL.w 6, D4 ed44",
			init: 			cpuState{
				D:   [8]uint32{308311524, 1837416043, 1881927127, 456890405, 1426458525, 3474368000, 1231100003, 3555539119},
				A:   [7]uint32{1304146002, 3845544232, 3434804996, 1602953962, 3174519638, 2735749909, 1818943675},
				PC:  16616382,
				SR:  270,
				USP: 10435656,
				SSP: 13818798,
				RAM: [][2]uint32{{16616378, 237}, {16616379, 68}, {16616380, 242}, {16616381, 41}, {16616382, 140}, {16616383, 218}},
			},
			want: 			cpuState{
				D:   [8]uint32{308311524, 1837416043, 1881927127, 456890405, 1426515776, 3474368000, 1231100003, 3555539119},
				A:   [7]uint32{1304146002, 3845544232, 3434804996, 1602953962, 3174519638, 2735749909, 1818943675},
				PC:  16616384,
				SR:  283,
				USP: 10435656,
				SSP: 13818798,
				RAM: [][2]uint32{{16616378, 237}, {16616379, 68}, {16616380, 242}, {16616381, 41}, {16616382, 140}, {16616383, 218}},
				Cycles: 18,
			},
		},
		{
			name: "1922 ASL.w 2, D4 e544",
			init: 			cpuState{
				D:   [8]uint32{1881444959, 1621558203, 3709168621, 760589983, 243700497, 897033056, 2647480418, 3776246795},
				A:   [7]uint32{2816881050, 3778329350, 3984264991, 1046490542, 458532618, 4110284018, 2689729333},
				PC:  5357884,
				SR:  8469,
				USP: 6001882,
				SSP: 12963154,
				RAM: [][2]uint32{{5357880, 229}, {5357881, 68}, {5357882, 163}, {5357883, 107}, {5357884, 49}, {5357885, 174}},
			},
			want: 			cpuState{
				D:   [8]uint32{1881444959, 1621558203, 3709168621, 760589983, 243682372, 897033056, 2647480418, 3776246795},
				A:   [7]uint32{2816881050, 3778329350, 3984264991, 1046490542, 458532618, 4110284018, 2689729333},
				PC:  5357886,
				SR:  8450,
				USP: 6001882,
				SSP: 12963154,
				RAM: [][2]uint32{{5357880, 229}, {5357881, 68}, {5357882, 163}, {5357883, 107}, {5357884, 49}, {5357885, 174}},
				Cycles: 10,
			},
		},
		{
			name: "2186 ASL.w (d8, A4, Xn) e1f4",
			init: 			cpuState{
				D:   [8]uint32{3334007136, 1244704652, 2039922091, 629072475, 742009157, 505483529, 3178306, 243471255},
				A:   [7]uint32{1674915065, 640186358, 3782648342, 637537745, 815025916, 3373565506, 3400141127},
				PC:  7686878,
				SR:  785,
				USP: 8643928,
				SSP: 4124754,
				RAM: [][2]uint32{{7686874, 225}, {7686875, 244}, {7686876, 118}, {7686877, 195}, {7686878, 195}, {7686879, 183}, {9724502, 34}, {9724503, 158}, {7686880, 180}, {7686881, 103}},
			},
			want: 			cpuState{
				D:   [8]uint32{3334007136, 1244704652, 2039922091, 629072475, 742009157, 505483529, 3178306, 243471255},
				A:   [7]uint32{1674915065, 640186358, 3782648342, 637537745, 815025916, 3373565506, 3400141127},
				PC:  7686882,
				SR:  768,
				USP: 8643928,
				SSP: 4124754,
				RAM: [][2]uint32{{7686874, 225}, {7686875, 244}, {7686876, 118}, {7686877, 195}, {7686878, 195}, {7686879, 183}, {9724502, 69}, {9724503, 60}, {7686880, 180}, {7686881, 103}},
				Cycles: 18,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASL_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASL.l D0, D2 e1a2",
			init: cpuState{
				D:   [8]uint32{1665132295, 1860274445, 3303770356, 4143754377, 454961395, 458750985, 2367911195, 3867835807},
				A:   [7]uint32{1144095669, 1041785141, 2806714504, 3148796705, 2516974797, 2240758846, 2352976153},
				PC:  13618272,
				SR:  32771,
				USP: 6826106,
				SSP: 10380388,
				RAM: [][2]uint32{{13618268, 225}, {13618269, 162}, {13618270, 80}, {13618271, 17}, {13618272, 204}, {13618273, 14}},
			},
			want: cpuState{
				D:   [8]uint32{1665132295, 1860274445, 1975810560, 4143754377, 454961395, 458750985, 2367911195, 3867835807},
				A:   [7]uint32{1144095669, 1041785141, 2806714504, 3148796705, 2516974797, 2240758846, 2352976153},
				PC:  13618274,
				SR:  32770,
				USP: 6826106,
				SSP: 10380388,
				RAM: [][2]uint32{{13618268, 225}, {13618269, 162}, {13618270, 80}, {13618271, 17}, {13618272, 204}, {13618273, 14}},
				Cycles: 22,
			},
		},
		{
			name: "500 ASL.l 7, D7 ef87",
			init: cpuState{
				D:   [8]uint32{404779666, 296217818, 2704717968, 1260287972, 3176918976, 748041646, 1187834193, 2067544173},
				A:   [7]uint32{2177251666, 3727557955, 2307637815, 541344241, 1234253005, 987412938, 2856530764},
				PC:  8143236,
				SR:  42516,
				USP: 837632,
				SSP: 6186906,
				RAM: [][2]uint32{{8143232, 239}, {8143233, 135}, {8143234, 141}, {8143235, 116}, {8143236, 244}, {8143237, 229}},
			},
			want: cpuState{
				D:   [8]uint32{404779666, 296217818, 2704717968, 1260287972, 3176918976, 748041646, 1187834193, 2652649088},
				A:   [7]uint32{2177251666, 3727557955, 2307637815, 541344241, 1234253005, 987412938, 2856530764},
				PC:  8143238,
				SR:  42523,
				USP: 837632,
				SSP: 6186906,
				RAM: [][2]uint32{{8143232, 239}, {8143233, 135}, {8143234, 141}, {8143235, 116}, {8143236, 244}, {8143237, 229}},
				Cycles: 22,
			},
		},
		{
			name: "1000 ASL.l 7, D2 ef82",
			init: cpuState{
				D:   [8]uint32{739164447, 2686864923, 2136906476, 2522239544, 1060082978, 3486907074, 821434634, 431893418},
				A:   [7]uint32{3203843411, 1737874464, 991317726, 1054015091, 2936015421, 2553313349, 3300406635},
				PC:  147148,
				SR:  778,
				USP: 9744184,
				SSP: 211366,
				RAM: [][2]uint32{{147144, 239}, {147145, 130}, {147146, 11}, {147147, 5}, {147148, 206}, {147149, 132}},
			},
			want: cpuState{
				D:   [8]uint32{739164447, 2686864923, 2941089280, 2522239544, 1060082978, 3486907074, 821434634, 431893418},
				A:   [7]uint32{3203843411, 1737874464, 991317726, 1054015091, 2936015421, 2553313349, 3300406635},
				PC:  147150,
				SR:  795,
				USP: 9744184,
				SSP: 211366,
				RAM: [][2]uint32{{147144, 239}, {147145, 130}, {147146, 11}, {147147, 5}, {147148, 206}, {147149, 132}},
				Cycles: 22,
			},
		},
		{
			name: "1500 ASL.l D6, D7 eda7",
			init: cpuState{
				D:   [8]uint32{2427529023, 232044591, 3867538374, 424555813, 2200596835, 1350761448, 3669412470, 546531122},
				A:   [7]uint32{3916547678, 260721217, 2343570511, 1119419926, 1857698416, 32918402, 3068661539},
				PC:  10768186,
				SR:  271,
				USP: 11761830,
				SSP: 10642526,
				RAM: [][2]uint32{{10768182, 237}, {10768183, 167}, {10768184, 105}, {10768185, 209}, {10768186, 240}, {10768187, 243}},
			},
			want: cpuState{
				D:   [8]uint32{2427529023, 232044591, 3867538374, 424555813, 2200596835, 1350761448, 3669412470, 0},
				A:   [7]uint32{3916547678, 260721217, 2343570511, 1119419926, 1857698416, 32918402, 3068661539},
				PC:  10768188,
				SR:  262,
				USP: 11761830,
				SSP: 10642526,
				RAM: [][2]uint32{{10768182, 237}, {10768183, 167}, {10768184, 105}, {10768185, 209}, {10768186, 240}, {10768187, 243}},
				Cycles: 116,
			},
		},
		{
			name: "2000 ASL.l 1, D0 e380",
			init: cpuState{
				D:   [8]uint32{3597923443, 469392294, 4265791421, 208005571, 2135026273, 2680589637, 92959639, 2590558638},
				A:   [7]uint32{1870343538, 2677459105, 431819122, 2553928912, 354969791, 5499345, 1826672023},
				PC:  15432490,
				SR:  41992,
				USP: 3043598,
				SSP: 11207334,
				RAM: [][2]uint32{{15432486, 227}, {15432487, 128}, {15432488, 29}, {15432489, 62}, {15432490, 250}, {15432491, 151}},
			},
			want: cpuState{
				D:   [8]uint32{2900879590, 469392294, 4265791421, 208005571, 2135026273, 2680589637, 92959639, 2590558638},
				A:   [7]uint32{1870343538, 2677459105, 431819122, 2553928912, 354969791, 5499345, 1826672023},
				PC:  15432492,
				SR:  42009,
				USP: 3043598,
				SSP: 11207334,
				RAM: [][2]uint32{{15432486, 227}, {15432487, 128}, {15432488, 29}, {15432489, 62}, {15432490, 250}, {15432491, 151}},
				Cycles: 10,
			},
		},
		{
			name: "001 ASL.l D1, D7 e3a7",
			init: 			cpuState{
				D:   [8]uint32{118938210, 3874305214, 1871586357, 3581154771, 1361513862, 638281366, 863423066, 879221767},
				A:   [7]uint32{856260020, 3151941051, 1940340433, 4273493068, 681521456, 2782818922, 797756874},
				PC:  12814326,
				SR:  10004,
				USP: 5472434,
				SSP: 2075018,
				RAM: [][2]uint32{{12814322, 227}, {12814323, 167}, {12814324, 25}, {12814325, 203}, {12814326, 74}, {12814327, 107}},
			},
			want: 			cpuState{
				D:   [8]uint32{118938210, 3874305214, 1871586357, 3581154771, 1361513862, 638281366, 863423066, 0},
				A:   [7]uint32{856260020, 3151941051, 1940340433, 4273493068, 681521456, 2782818922, 797756874},
				PC:  12814328,
				SR:  9990,
				USP: 5472434,
				SSP: 2075018,
				RAM: [][2]uint32{{12814322, 227}, {12814323, 167}, {12814324, 25}, {12814325, 203}, {12814326, 74}, {12814327, 107}},
				Cycles: 132,
			},
		},
		{
			name: "283 ASL.l D0, D4 e1a4",
			init: 			cpuState{
				D:   [8]uint32{2955654958, 241279057, 2144651601, 2322903605, 2404537778, 333078051, 1385766639, 987728303},
				A:   [7]uint32{4015801666, 4102614254, 1861641188, 1972421973, 2910729307, 546234933, 2899813032},
				PC:  14282710,
				SR:  1558,
				USP: 8903494,
				SSP: 11757920,
				RAM: [][2]uint32{{14282706, 225}, {14282707, 164}, {14282708, 13}, {14282709, 140}, {14282710, 123}, {14282711, 170}},
			},
			want: 			cpuState{
				D:   [8]uint32{2955654958, 241279057, 2144651601, 2322903605, 0, 333078051, 1385766639, 987728303},
				A:   [7]uint32{4015801666, 4102614254, 1861641188, 1972421973, 2910729307, 546234933, 2899813032},
				PC:  14282712,
				SR:  1542,
				USP: 8903494,
				SSP: 11757920,
				RAM: [][2]uint32{{14282706, 225}, {14282707, 164}, {14282708, 13}, {14282709, 140}, {14282710, 123}, {14282711, 170}},
				Cycles: 100,
			},
		},
		{
			name: "576 ASL.l 3, D6 e786",
			init: 			cpuState{
				D:   [8]uint32{628262155, 231651491, 1599343924, 1508509208, 83343183, 834472777, 3720717037, 691513634},
				A:   [7]uint32{1395514943, 654600935, 3945594926, 3251765057, 4141323486, 2917085328, 1145645247},
				PC:  13312448,
				SR:  794,
				USP: 6706072,
				SSP: 12427574,
				RAM: [][2]uint32{{13312444, 231}, {13312445, 134}, {13312446, 190}, {13312447, 190}, {13312448, 11}, {13312449, 231}},
			},
			want: 			cpuState{
				D:   [8]uint32{628262155, 231651491, 1599343924, 1508509208, 83343183, 834472777, 3995932520, 691513634},
				A:   [7]uint32{1395514943, 654600935, 3945594926, 3251765057, 4141323486, 2917085328, 1145645247},
				PC:  13312450,
				SR:  778,
				USP: 6706072,
				SSP: 12427574,
				RAM: [][2]uint32{{13312444, 231}, {13312445, 134}, {13312446, 190}, {13312447, 190}, {13312448, 11}, {13312449, 231}},
				Cycles: 14,
			},
		},
		{
			name: "857 ASL.l 5, D1 eb81",
			init: 			cpuState{
				D:   [8]uint32{3424604770, 156380595, 1434443988, 2539294879, 1133133938, 1620216772, 2132058331, 3204497813},
				A:   [7]uint32{3168363910, 2972134113, 3734245047, 116796491, 3521133845, 1095874900, 3438945731},
				PC:  15137850,
				SR:  10000,
				USP: 5006586,
				SSP: 4035126,
				RAM: [][2]uint32{{15137846, 235}, {15137847, 129}, {15137848, 209}, {15137849, 127}, {15137850, 229}, {15137851, 196}},
			},
			want: 			cpuState{
				D:   [8]uint32{3424604770, 709211744, 1434443988, 2539294879, 1133133938, 1620216772, 2132058331, 3204497813},
				A:   [7]uint32{3168363910, 2972134113, 3734245047, 116796491, 3521133845, 1095874900, 3438945731},
				PC:  15137852,
				SR:  10003,
				USP: 5006586,
				SSP: 4035126,
				RAM: [][2]uint32{{15137846, 235}, {15137847, 129}, {15137848, 209}, {15137849, 127}, {15137850, 229}, {15137851, 196}},
				Cycles: 18,
			},
		},
		{
			name: "1155 ASL.l D7, D4 efa4",
			init: 			cpuState{
				D:   [8]uint32{2304198094, 3153130197, 1028051773, 1405028589, 905535284, 3680755624, 2815466724, 4009446182},
				A:   [7]uint32{2546845752, 3632283409, 1926363272, 3286726573, 744083586, 619851270, 498911980},
				PC:  11517870,
				SR:  1560,
				USP: 1312156,
				SSP: 7657416,
				RAM: [][2]uint32{{11517866, 239}, {11517867, 164}, {11517868, 86}, {11517869, 225}, {11517870, 216}, {11517871, 153}},
			},
			want: 			cpuState{
				D:   [8]uint32{2304198094, 3153130197, 1028051773, 1405028589, 0, 3680755624, 2815466724, 4009446182},
				A:   [7]uint32{2546845752, 3632283409, 1926363272, 3286726573, 744083586, 619851270, 498911980},
				PC:  11517872,
				SR:  1542,
				USP: 1312156,
				SSP: 7657416,
				RAM: [][2]uint32{{11517866, 239}, {11517867, 164}, {11517868, 86}, {11517869, 225}, {11517870, 216}, {11517871, 153}},
				Cycles: 84,
			},
		},
		{
			name: "1452 ASL.l D6, D6 eda6",
			init: 			cpuState{
				D:   [8]uint32{982808991, 2715327627, 349348555, 2987488589, 3443015576, 1209530140, 3850151515, 3781728440},
				A:   [7]uint32{3987344799, 3929443203, 898563762, 1828646888, 1187318869, 4119332227, 2637457279},
				PC:  7893478,
				SR:  514,
				USP: 14206706,
				SSP: 1462268,
				RAM: [][2]uint32{{7893474, 237}, {7893475, 166}, {7893476, 121}, {7893477, 248}, {7893478, 247}, {7893479, 106}},
			},
			want: 			cpuState{
				D:   [8]uint32{982808991, 2715327627, 349348555, 2987488589, 3443015576, 1209530140, 3623878656, 3781728440},
				A:   [7]uint32{3987344799, 3929443203, 898563762, 1828646888, 1187318869, 4119332227, 2637457279},
				PC:  7893480,
				SR:  522,
				USP: 14206706,
				SSP: 1462268,
				RAM: [][2]uint32{{7893474, 237}, {7893475, 166}, {7893476, 121}, {7893477, 248}, {7893478, 247}, {7893479, 106}},
				Cycles: 62,
			},
		},
		{
			name: "1730 ASL.l D5, D4 eba4",
			init: 			cpuState{
				D:   [8]uint32{2221991010, 3363727476, 2315193032, 183589419, 672364459, 3232764485, 3940612272, 1385699496},
				A:   [7]uint32{1610508402, 1370872799, 735826584, 2244832045, 1928829401, 2880226854, 2913350400},
				PC:  4724254,
				SR:  261,
				USP: 13982986,
				SSP: 4666686,
				RAM: [][2]uint32{{4724250, 235}, {4724251, 164}, {4724252, 38}, {4724253, 161}, {4724254, 240}, {4724255, 200}},
			},
			want: 			cpuState{
				D:   [8]uint32{2221991010, 3363727476, 2315193032, 183589419, 40826208, 3232764485, 3940612272, 1385699496},
				A:   [7]uint32{1610508402, 1370872799, 735826584, 2244832045, 1928829401, 2880226854, 2913350400},
				PC:  4724256,
				SR:  275,
				USP: 13982986,
				SSP: 4666686,
				RAM: [][2]uint32{{4724250, 235}, {4724251, 164}, {4724252, 38}, {4724253, 161}, {4724254, 240}, {4724255, 200}},
				Cycles: 18,
			},
		},
		{
			name: "1972 ASL.l 3, D4 e784",
			init: 			cpuState{
				D:   [8]uint32{1826109605, 424442068, 1118644894, 454109974, 3185492578, 2756859188, 1841614081, 1828808028},
				A:   [7]uint32{81510344, 2227276157, 3260298867, 2871623933, 2008732201, 4125512250, 3556161248},
				PC:  15372396,
				SR:  1808,
				USP: 6576876,
				SSP: 286410,
				RAM: [][2]uint32{{15372392, 231}, {15372393, 132}, {15372394, 132}, {15372395, 86}, {15372396, 84}, {15372397, 94}},
			},
			want: 			cpuState{
				D:   [8]uint32{1826109605, 424442068, 1118644894, 454109974, 4009104144, 2756859188, 1841614081, 1828808028},
				A:   [7]uint32{81510344, 2227276157, 3260298867, 2871623933, 2008732201, 4125512250, 3556161248},
				PC:  15372398,
				SR:  1819,
				USP: 6576876,
				SSP: 286410,
				RAM: [][2]uint32{{15372392, 231}, {15372393, 132}, {15372394, 132}, {15372395, 86}, {15372396, 84}, {15372397, 94}},
				Cycles: 14,
			},
		},
		{
			name: "2240 ASL.l 5, D7 eb87",
			init: 			cpuState{
				D:   [8]uint32{699833577, 3657606460, 4100948818, 1896114405, 2717771514, 774411472, 363277289, 2665845815},
				A:   [7]uint32{60554564, 37245303, 1318264241, 397580304, 730109519, 2346951397, 2491038236},
				PC:  7080270,
				SR:  8204,
				USP: 14711142,
				SSP: 15565690,
				RAM: [][2]uint32{{7080266, 235}, {7080267, 135}, {7080268, 27}, {7080269, 69}, {7080270, 205}, {7080271, 26}},
			},
			want: 			cpuState{
				D:   [8]uint32{699833577, 3657606460, 4100948818, 1896114405, 2717771514, 774411472, 363277289, 3702687456},
				A:   [7]uint32{60554564, 37245303, 1318264241, 397580304, 730109519, 2346951397, 2491038236},
				PC:  7080272,
				SR:  8219,
				USP: 14711142,
				SSP: 15565690,
				RAM: [][2]uint32{{7080266, 235}, {7080267, 135}, {7080268, 27}, {7080269, 69}, {7080270, 205}, {7080271, 26}},
				Cycles: 18,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASR.b 6, D7 ec07",
			init: cpuState{
				D:   [8]uint32{3230747358, 2027848517, 4233688550, 3253514341, 3686450787, 1571467791, 612264886, 1909330689},
				A:   [7]uint32{49415762, 90675800, 617236057, 330260100, 4032526352, 1920135402, 3948925200},
				PC:  16129048,
				SR:  41749,
				USP: 7408808,
				SSP: 9172340,
				RAM: [][2]uint32{{16129044, 236}, {16129045, 7}, {16129046, 169}, {16129047, 8}, {16129048, 58}, {16129049, 44}},
			},
			want: cpuState{
				D:   [8]uint32{3230747358, 2027848517, 4233688550, 3253514341, 3686450787, 1571467791, 612264886, 1909330688},
				A:   [7]uint32{49415762, 90675800, 617236057, 330260100, 4032526352, 1920135402, 3948925200},
				PC:  16129050,
				SR:  41732,
				USP: 7408808,
				SSP: 9172340,
				RAM: [][2]uint32{{16129044, 236}, {16129045, 7}, {16129046, 169}, {16129047, 8}, {16129048, 58}, {16129049, 44}},
				Cycles: 18,
			},
		},
		{
			name: "500 ASR.b 4, D4 e804",
			init: cpuState{
				D:   [8]uint32{1739394794, 2845298601, 85805233, 1918442744, 2377569476, 4049368412, 485655956, 247881715},
				A:   [7]uint32{3890685522, 3845805654, 1727618085, 3254819017, 4148826429, 1264370799, 61654133},
				PC:  88944,
				SR:  41484,
				USP: 16235120,
				SSP: 13949624,
				RAM: [][2]uint32{{88940, 232}, {88941, 4}, {88942, 158}, {88943, 4}, {88944, 70}, {88945, 234}},
			},
			want: cpuState{
				D:   [8]uint32{1739394794, 2845298601, 85805233, 1918442744, 2377569532, 4049368412, 485655956, 247881715},
				A:   [7]uint32{3890685522, 3845805654, 1727618085, 3254819017, 4148826429, 1264370799, 61654133},
				PC:  88946,
				SR:  41480,
				USP: 16235120,
				SSP: 13949624,
				RAM: [][2]uint32{{88940, 232}, {88941, 4}, {88942, 158}, {88943, 4}, {88944, 70}, {88945, 234}},
				Cycles: 14,
			},
		},
		{
			name: "1000 ASR.b 8, D0 e000",
			init: cpuState{
				D:   [8]uint32{3456319252, 76271016, 3525261165, 102314857, 23377941, 3530452043, 3608600125, 767336213},
				A:   [7]uint32{2878447403, 3782187020, 3960700332, 2636577976, 1063448868, 909710570, 1956569659},
				PC:  4420898,
				SR:  9735,
				USP: 16483566,
				SSP: 6507088,
				RAM: [][2]uint32{{4420894, 224}, {4420895, 0}, {4420896, 121}, {4420897, 43}, {4420898, 61}, {4420899, 21}},
			},
			want: cpuState{
				D:   [8]uint32{3456319232, 76271016, 3525261165, 102314857, 23377941, 3530452043, 3608600125, 767336213},
				A:   [7]uint32{2878447403, 3782187020, 3960700332, 2636577976, 1063448868, 909710570, 1956569659},
				PC:  4420900,
				SR:  9732,
				USP: 16483566,
				SSP: 6507088,
				RAM: [][2]uint32{{4420894, 224}, {4420895, 0}, {4420896, 121}, {4420897, 43}, {4420898, 61}, {4420899, 21}},
				Cycles: 22,
			},
		},
		{
			name: "1500 ASR.b 4, D6 e806",
			init: cpuState{
				D:   [8]uint32{1871070317, 2789910106, 194646039, 4267900130, 418463314, 2013088078, 608295103, 144280806},
				A:   [7]uint32{2573704883, 2600361087, 196918259, 3700371095, 4175445721, 569156096, 2256702004},
				PC:  1441264,
				SR:  10013,
				USP: 1284738,
				SSP: 1870792,
				RAM: [][2]uint32{{1441260, 232}, {1441261, 6}, {1441262, 215}, {1441263, 17}, {1441264, 239}, {1441265, 170}},
			},
			want: cpuState{
				D:   [8]uint32{1871070317, 2789910106, 194646039, 4267900130, 418463314, 2013088078, 608295163, 144280806},
				A:   [7]uint32{2573704883, 2600361087, 196918259, 3700371095, 4175445721, 569156096, 2256702004},
				PC:  1441266,
				SR:  10009,
				USP: 1284738,
				SSP: 1870792,
				RAM: [][2]uint32{{1441260, 232}, {1441261, 6}, {1441262, 215}, {1441263, 17}, {1441264, 239}, {1441265, 170}},
				Cycles: 14,
			},
		},
		{
			name: "2000 ASR.b 1, D0 e200",
			init: cpuState{
				D:   [8]uint32{3589350621, 4017855110, 1006782619, 3183118594, 3848062786, 1292701905, 155709841, 1429402257},
				A:   [7]uint32{24871113, 257148562, 4164476198, 2973080348, 646841500, 2294361280, 2735332233},
				PC:  6576288,
				SR:  10001,
				USP: 4414182,
				SSP: 7004338,
				RAM: [][2]uint32{{6576284, 226}, {6576285, 0}, {6576286, 176}, {6576287, 206}, {6576288, 202}, {6576289, 87}},
			},
			want: cpuState{
				D:   [8]uint32{3589350638, 4017855110, 1006782619, 3183118594, 3848062786, 1292701905, 155709841, 1429402257},
				A:   [7]uint32{24871113, 257148562, 4164476198, 2973080348, 646841500, 2294361280, 2735332233},
				PC:  6576290,
				SR:  10009,
				USP: 4414182,
				SSP: 7004338,
				RAM: [][2]uint32{{6576284, 226}, {6576285, 0}, {6576286, 176}, {6576287, 206}, {6576288, 202}, {6576289, 87}},
				Cycles: 8,
			},
		},
		{
			name: "002 ASR.b D3, D6 e626",
			init: 			cpuState{
				D:   [8]uint32{663839192, 3540745705, 1309699383, 1947940503, 1787925872, 3343296537, 3888940092, 884430840},
				A:   [7]uint32{1234233427, 724919623, 3910535641, 3163313466, 511054986, 2156903172, 1179706603},
				PC:  16697924,
				SR:  9241,
				USP: 12489374,
				SSP: 13715002,
				RAM: [][2]uint32{{16697920, 230}, {16697921, 38}, {16697922, 110}, {16697923, 29}, {16697924, 188}, {16697925, 158}},
			},
			want: 			cpuState{
				D:   [8]uint32{663839192, 3540745705, 1309699383, 1947940503, 1787925872, 3343296537, 3888940032, 884430840},
				A:   [7]uint32{1234233427, 724919623, 3910535641, 3163313466, 511054986, 2156903172, 1179706603},
				PC:  16697926,
				SR:  9220,
				USP: 12489374,
				SSP: 13715002,
				RAM: [][2]uint32{{16697920, 230}, {16697921, 38}, {16697922, 110}, {16697923, 29}, {16697924, 188}, {16697925, 158}},
				Cycles: 52,
			},
		},
		{
			name: "281 ASR.b 7, D7 ee07",
			init: 			cpuState{
				D:   [8]uint32{3773658449, 2113195018, 3076234104, 765702319, 2904845807, 2050245006, 1904081469, 769784048},
				A:   [7]uint32{3499065723, 1057410742, 3168810747, 887593068, 3868550053, 376285556, 1604418580},
				PC:  16172826,
				SR:  9494,
				USP: 1649538,
				SSP: 7999240,
				RAM: [][2]uint32{{16172822, 238}, {16172823, 7}, {16172824, 146}, {16172825, 236}, {16172826, 93}, {16172827, 102}},
			},
			want: 			cpuState{
				D:   [8]uint32{3773658449, 2113195018, 3076234104, 765702319, 2904845807, 2050245006, 1904081469, 769784063},
				A:   [7]uint32{3499065723, 1057410742, 3168810747, 887593068, 3868550053, 376285556, 1604418580},
				PC:  16172828,
				SR:  9497,
				USP: 1649538,
				SSP: 7999240,
				RAM: [][2]uint32{{16172822, 238}, {16172823, 7}, {16172824, 146}, {16172825, 236}, {16172826, 93}, {16172827, 102}},
				Cycles: 20,
			},
		},
		{
			name: "549 ASR.b 6, D2 ec02",
			init: 			cpuState{
				D:   [8]uint32{1745586603, 2732158208, 4223354303, 3008318074, 919347200, 3395820236, 3045302357, 911043639},
				A:   [7]uint32{2668925962, 2689963585, 2799369433, 1066851869, 3088645218, 938140313, 2909691613},
				PC:  13450150,
				SR:  8729,
				USP: 2527348,
				SSP: 7814948,
				RAM: [][2]uint32{{13450146, 236}, {13450147, 2}, {13450148, 97}, {13450149, 42}, {13450150, 254}, {13450151, 20}},
			},
			want: 			cpuState{
				D:   [8]uint32{1745586603, 2732158208, 4223354366, 3008318074, 919347200, 3395820236, 3045302357, 911043639},
				A:   [7]uint32{2668925962, 2689963585, 2799369433, 1066851869, 3088645218, 938140313, 2909691613},
				PC:  13450152,
				SR:  8729,
				USP: 2527348,
				SSP: 7814948,
				RAM: [][2]uint32{{13450146, 236}, {13450147, 2}, {13450148, 97}, {13450149, 42}, {13450150, 254}, {13450151, 20}},
				Cycles: 18,
			},
		},
		{
			name: "823 ASR.b D7, D3 ee23",
			init: 			cpuState{
				D:   [8]uint32{105420906, 2795399690, 4057221144, 3423573342, 551271897, 3557418858, 3528625364, 90107347},
				A:   [7]uint32{1878140896, 560833486, 4148641152, 1432298190, 4115127721, 3132534396, 78471836},
				PC:  14779732,
				SR:  8983,
				USP: 9180062,
				SSP: 10761244,
				RAM: [][2]uint32{{14779728, 238}, {14779729, 35}, {14779730, 206}, {14779731, 1}, {14779732, 73}, {14779733, 72}},
			},
			want: 			cpuState{
				D:   [8]uint32{105420906, 2795399690, 4057221144, 3423573248, 551271897, 3557418858, 3528625364, 90107347},
				A:   [7]uint32{1878140896, 560833486, 4148641152, 1432298190, 4115127721, 3132534396, 78471836},
				PC:  14779734,
				SR:  8964,
				USP: 9180062,
				SSP: 10761244,
				RAM: [][2]uint32{{14779728, 238}, {14779729, 35}, {14779730, 206}, {14779731, 1}, {14779732, 73}, {14779733, 72}},
				Cycles: 44,
			},
		},
		{
			name: "1074 ASR.b D7, D1 ee21",
			init: 			cpuState{
				D:   [8]uint32{2532049481, 2761696824, 2231771693, 3093536286, 2226032444, 3631899951, 938213679, 1073294798},
				A:   [7]uint32{887400222, 1629488550, 1709811800, 3166074309, 3254122084, 44963464, 262227244},
				PC:  594814,
				SR:  8214,
				USP: 3451650,
				SSP: 3022060,
				RAM: [][2]uint32{{594810, 238}, {594811, 33}, {594812, 141}, {594813, 120}, {594814, 161}, {594815, 59}},
			},
			want: 			cpuState{
				D:   [8]uint32{2532049481, 2761696768, 2231771693, 3093536286, 2226032444, 3631899951, 938213679, 1073294798},
				A:   [7]uint32{887400222, 1629488550, 1709811800, 3166074309, 3254122084, 44963464, 262227244},
				PC:  594816,
				SR:  8196,
				USP: 3451650,
				SSP: 3022060,
				RAM: [][2]uint32{{594810, 238}, {594811, 33}, {594812, 141}, {594813, 120}, {594814, 161}, {594815, 59}},
				Cycles: 34,
			},
		},
		{
			name: "1357 ASR.b D1, D4 e224",
			init: 			cpuState{
				D:   [8]uint32{172289883, 3531454393, 1603985072, 1039073514, 58001715, 2492691573, 1707719270, 505951759},
				A:   [7]uint32{4001075677, 2527381860, 2731808283, 3453344898, 1260286793, 1034854047, 549721241},
				PC:  13053158,
				SR:  8990,
				USP: 7152978,
				SSP: 6942262,
				RAM: [][2]uint32{{13053154, 226}, {13053155, 36}, {13053156, 6}, {13053157, 181}, {13053158, 124}, {13053159, 104}},
			},
			want: 			cpuState{
				D:   [8]uint32{172289883, 3531454393, 1603985072, 1039073514, 58001664, 2492691573, 1707719270, 505951759},
				A:   [7]uint32{4001075677, 2527381860, 2731808283, 3453344898, 1260286793, 1034854047, 549721241},
				PC:  13053160,
				SR:  8964,
				USP: 7152978,
				SSP: 6942262,
				RAM: [][2]uint32{{13053154, 226}, {13053155, 36}, {13053156, 6}, {13053157, 181}, {13053158, 124}, {13053159, 104}},
				Cycles: 120,
			},
		},
		{
			name: "1647 ASR.b D6, D4 ec24",
			init: 			cpuState{
				D:   [8]uint32{58888129, 1662888911, 1308640140, 1490199986, 2836742412, 2992020074, 2096738373, 3790120350},
				A:   [7]uint32{3160906377, 1487341536, 368963072, 3677953422, 3101695001, 225468580, 2178968429},
				PC:  5795364,
				SR:  1294,
				USP: 8167966,
				SSP: 15513116,
				RAM: [][2]uint32{{5795360, 236}, {5795361, 36}, {5795362, 121}, {5795363, 44}, {5795364, 88}, {5795365, 21}},
			},
			want: 			cpuState{
				D:   [8]uint32{58888129, 1662888911, 1308640140, 1490199986, 2836742400, 2992020074, 2096738373, 3790120350},
				A:   [7]uint32{3160906377, 1487341536, 368963072, 3677953422, 3101695001, 225468580, 2178968429},
				PC:  5795366,
				SR:  1284,
				USP: 8167966,
				SSP: 15513116,
				RAM: [][2]uint32{{5795360, 236}, {5795361, 36}, {5795362, 121}, {5795363, 44}, {5795364, 88}, {5795365, 21}},
				Cycles: 16,
			},
		},
		{
			name: "1916 ASR.b D2, D6 e426",
			init: 			cpuState{
				D:   [8]uint32{819576087, 2770992837, 2792637937, 3065997304, 3822361937, 3307075104, 2789551404, 2279194101},
				A:   [7]uint32{3316278030, 862977168, 3197872046, 1872704508, 3558861475, 253735889, 2894776936},
				PC:  7030658,
				SR:  1820,
				USP: 12512228,
				SSP: 14161524,
				RAM: [][2]uint32{{7030654, 228}, {7030655, 38}, {7030656, 24}, {7030657, 98}, {7030658, 104}, {7030659, 181}},
			},
			want: 			cpuState{
				D:   [8]uint32{819576087, 2770992837, 2792637937, 3065997304, 3822361937, 3307075104, 2789551360, 2279194101},
				A:   [7]uint32{3316278030, 862977168, 3197872046, 1872704508, 3558861475, 253735889, 2894776936},
				PC:  7030660,
				SR:  1796,
				USP: 12512228,
				SSP: 14161524,
				RAM: [][2]uint32{{7030654, 228}, {7030655, 38}, {7030656, 24}, {7030657, 98}, {7030658, 104}, {7030659, 181}},
				Cycles: 104,
			},
		},
		{
			name: "2202 ASR.b D1, D7 e227",
			init: 			cpuState{
				D:   [8]uint32{3727802584, 459115497, 651864127, 2033439800, 2975582871, 3920310850, 2446450894, 2769559677},
				A:   [7]uint32{1501770603, 3738407315, 1960927398, 3667181556, 2794491451, 3785857460, 44041927},
				PC:  15340208,
				SR:  10011,
				USP: 4184902,
				SSP: 417754,
				RAM: [][2]uint32{{15340204, 226}, {15340205, 39}, {15340206, 242}, {15340207, 36}, {15340208, 174}, {15340209, 118}},
			},
			want: 			cpuState{
				D:   [8]uint32{3727802584, 459115497, 651864127, 2033439800, 2975582871, 3920310850, 2446450894, 2769559552},
				A:   [7]uint32{1501770603, 3738407315, 1960927398, 3667181556, 2794491451, 3785857460, 44041927},
				PC:  15340210,
				SR:  9988,
				USP: 4184902,
				SSP: 417754,
				RAM: [][2]uint32{{15340204, 226}, {15340205, 39}, {15340206, 242}, {15340207, 36}, {15340208, 174}, {15340209, 118}},
				Cycles: 88,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASR.w D7, D7 ee67",
			init: cpuState{
				D:   [8]uint32{2140892700, 2465781122, 3992243120, 1827657398, 2728141166, 384994615, 1441370795, 3538539163},
				A:   [7]uint32{3279986970, 1101559859, 845518070, 1390080585, 1491296396, 2114812570, 2889532608},
				PC:  7131636,
				SR:  42002,
				USP: 1434316,
				SSP: 14536022,
				RAM: [][2]uint32{{7131632, 238}, {7131633, 103}, {7131634, 31}, {7131635, 181}, {7131636, 38}, {7131637, 208}},
			},
			want: cpuState{
				D:   [8]uint32{2140892700, 2465781122, 3992243120, 1827657398, 2728141166, 384994615, 1441370795, 3538550783},
				A:   [7]uint32{3279986970, 1101559859, 845518070, 1390080585, 1491296396, 2114812570, 2889532608},
				PC:  7131638,
				SR:  42009,
				USP: 1434316,
				SSP: 14536022,
				RAM: [][2]uint32{{7131632, 238}, {7131633, 103}, {7131634, 31}, {7131635, 181}, {7131636, 38}, {7131637, 208}},
				Cycles: 60,
			},
		},
		{
			name: "500 ASR.w D1, D5 e265",
			init: cpuState{
				D:   [8]uint32{3628040184, 478971299, 891365418, 4137746025, 1778465532, 1275930550, 546062528, 3860638617},
				A:   [7]uint32{4265557415, 3389053222, 2933897914, 586041371, 723338513, 3449980425, 4176922254},
				PC:  10360414,
				SR:  34331,
				USP: 366060,
				SSP: 8402216,
				RAM: [][2]uint32{{10360410, 226}, {10360411, 101}, {10360412, 248}, {10360413, 178}, {10360414, 34}, {10360415, 35}},
			},
			want: cpuState{
				D:   [8]uint32{3628040184, 478971299, 891365418, 4137746025, 1778465532, 1275920384, 546062528, 3860638617},
				A:   [7]uint32{4265557415, 3389053222, 2933897914, 586041371, 723338513, 3449980425, 4176922254},
				PC:  10360416,
				SR:  34308,
				USP: 366060,
				SSP: 8402216,
				RAM: [][2]uint32{{10360410, 226}, {10360411, 101}, {10360412, 248}, {10360413, 178}, {10360414, 34}, {10360415, 35}},
				Cycles: 76,
			},
		},
		{
			name: "1000 ASR.w D7, D3 ee63",
			init: cpuState{
				D:   [8]uint32{1841096544, 3934899226, 2909584113, 38225111, 4080219181, 543749075, 2874427749, 811232789},
				A:   [7]uint32{3290079922, 392342413, 3753083047, 1488256708, 2598391886, 3851039468, 54362338},
				PC:  6174722,
				SR:  33284,
				USP: 6306686,
				SSP: 4655622,
				RAM: [][2]uint32{{6174718, 238}, {6174719, 99}, {6174720, 71}, {6174721, 116}, {6174722, 119}, {6174723, 216}},
			},
			want: cpuState{
				D:   [8]uint32{1841096544, 3934899226, 2909584113, 38207488, 4080219181, 543749075, 2874427749, 811232789},
				A:   [7]uint32{3290079922, 392342413, 3753083047, 1488256708, 2598391886, 3851039468, 54362338},
				PC:  6174724,
				SR:  33284,
				USP: 6306686,
				SSP: 4655622,
				RAM: [][2]uint32{{6174718, 238}, {6174719, 99}, {6174720, 71}, {6174721, 116}, {6174722, 119}, {6174723, 216}},
				Cycles: 48,
			},
		},
		{
			name: "1500 ASR.w (d8, A4, Xn) e0f4",
			init: cpuState{
				D:   [8]uint32{4193058800, 4125521749, 1893473976, 3453498458, 4210194436, 2947372099, 2907672120, 2344792134},
				A:   [7]uint32{898654184, 1515254897, 202682949, 2931605055, 3561736284, 2701201033, 1076138602},
				PC:  7837402,
				SR:  33036,
				USP: 6773530,
				SSP: 14041444,
				RAM: [][2]uint32{{7837398, 224}, {7837399, 244}, {7837400, 111}, {7837401, 182}, {7837402, 83}, {7837403, 232}, {10180170, 14}, {10180171, 250}, {7837404, 192}, {7837405, 188}},
			},
			want: cpuState{
				D:   [8]uint32{4193058800, 4125521749, 1893473976, 3453498458, 4210194436, 2947372099, 2907672120, 2344792134},
				A:   [7]uint32{898654184, 1515254897, 202682949, 2931605055, 3561736284, 2701201033, 1076138602},
				PC:  7837406,
				SR:  33024,
				USP: 6773530,
				SSP: 14041444,
				RAM: [][2]uint32{{7837398, 224}, {7837399, 244}, {7837400, 111}, {7837401, 182}, {7837402, 83}, {7837403, 232}, {10180170, 7}, {10180171, 125}, {7837404, 192}, {7837405, 188}},
				Cycles: 18,
			},
		},
		{
			name: "2000 ASR.w D7, D3 ee63",
			init: cpuState{
				D:   [8]uint32{1247444347, 4122154250, 3705892827, 2050874130, 1106930726, 449426586, 3191285014, 126269127},
				A:   [7]uint32{3154958178, 1564375313, 2770667061, 3900620568, 3078532999, 1782183082, 4143717858},
				PC:  56558,
				SR:  41989,
				USP: 4120630,
				SSP: 9868632,
				RAM: [][2]uint32{{56554, 238}, {56555, 99}, {56556, 55}, {56557, 193}, {56558, 14}, {56559, 144}},
			},
			want: cpuState{
				D:   [8]uint32{1247444347, 4122154250, 3705892827, 2050883510, 1106930726, 449426586, 3191285014, 126269127},
				A:   [7]uint32{3154958178, 1564375313, 2770667061, 3900620568, 3078532999, 1782183082, 4143717858},
				PC:  56560,
				SR:  41992,
				USP: 4120630,
				SSP: 9868632,
				RAM: [][2]uint32{{56554, 238}, {56555, 99}, {56556, 55}, {56557, 193}, {56558, 14}, {56559, 144}},
				Cycles: 20,
			},
		},
		{
			name: "002 ASR.w (A1)+ e0d9",
			init: 			cpuState{
				D:   [8]uint32{2374568740, 1425912514, 1760245985, 2920100209, 649615497, 738531091, 323591614, 2508279825},
				A:   [7]uint32{2041037792, 2291484926, 2497367528, 3353603257, 1382074414, 2236975319, 1286003635},
				PC:  12405176,
				SR:  780,
				USP: 12376298,
				SSP: 5259260,
				RAM: [][2]uint32{{12405172, 224}, {12405173, 217}, {12405174, 181}, {12405175, 142}, {9783550, 221}, {9783551, 26}, {12405176, 255}, {12405177, 173}},
			},
			want: 			cpuState{
				D:   [8]uint32{2374568740, 1425912514, 1760245985, 2920100209, 649615497, 738531091, 323591614, 2508279825},
				A:   [7]uint32{2041037792, 2291484928, 2497367528, 3353603257, 1382074414, 2236975319, 1286003635},
				PC:  12405178,
				SR:  776,
				USP: 12376298,
				SSP: 5259260,
				RAM: [][2]uint32{{12405172, 224}, {12405173, 217}, {12405174, 181}, {12405175, 142}, {9783550, 238}, {9783551, 141}, {12405176, 255}, {12405177, 173}},
				Cycles: 12,
			},
		},
		{
			name: "298 ASR.w 5, D1 ea41",
			init: 			cpuState{
				D:   [8]uint32{2509926316, 1211541341, 4233233328, 2395289444, 201661950, 644469515, 1216480944, 2267409435},
				A:   [7]uint32{589643718, 933975391, 809806878, 4205327256, 3940572989, 2578063071, 2051753616},
				PC:  2512190,
				SR:  8967,
				USP: 13142328,
				SSP: 14683742,
				RAM: [][2]uint32{{2512186, 234}, {2512187, 65}, {2512188, 143}, {2512189, 63}, {2512190, 212}, {2512191, 23}},
			},
			want: 			cpuState{
				D:   [8]uint32{2509926316, 1211563322, 4233233328, 2395289444, 201661950, 644469515, 1216480944, 2267409435},
				A:   [7]uint32{589643718, 933975391, 809806878, 4205327256, 3940572989, 2578063071, 2051753616},
				PC:  2512192,
				SR:  8985,
				USP: 13142328,
				SSP: 14683742,
				RAM: [][2]uint32{{2512186, 234}, {2512187, 65}, {2512188, 143}, {2512189, 63}, {2512190, 212}, {2512191, 23}},
				Cycles: 16,
			},
		},
		{
			name: "546 ASR.w D0, D2 e062",
			init: 			cpuState{
				D:   [8]uint32{177614793, 3853980189, 1730860615, 3359729614, 3381888764, 3608391236, 101871171, 2954151198},
				A:   [7]uint32{2552697310, 4025232725, 5402905, 3019311430, 1596408069, 2556451884, 3727425065},
				PC:  13625968,
				SR:  9751,
				USP: 6514554,
				SSP: 10343252,
				RAM: [][2]uint32{{13625964, 224}, {13625965, 98}, {13625966, 144}, {13625967, 248}, {13625968, 56}, {13625969, 244}},
			},
			want: 			cpuState{
				D:   [8]uint32{177614793, 3853980189, 1730871275, 3359729614, 3381888764, 3608391236, 101871171, 2954151198},
				A:   [7]uint32{2552697310, 4025232725, 5402905, 3019311430, 1596408069, 2556451884, 3727425065},
				PC:  13625970,
				SR:  9736,
				USP: 6514554,
				SSP: 10343252,
				RAM: [][2]uint32{{13625964, 224}, {13625965, 98}, {13625966, 144}, {13625967, 248}, {13625968, 56}, {13625969, 244}},
				Cycles: 24,
			},
		},
		{
			name: "839 ASR.w 3, D7 e647",
			init: 			cpuState{
				D:   [8]uint32{1441798363, 1531763500, 2662872237, 1645229429, 2244944539, 3001733161, 2665898521, 3618188577},
				A:   [7]uint32{2497861318, 3877293874, 3697608297, 1320815736, 3407510373, 39679673, 1075298683},
				PC:  9758200,
				SR:  9236,
				USP: 2021998,
				SSP: 492458,
				RAM: [][2]uint32{{9758196, 230}, {9758197, 71}, {9758198, 219}, {9758199, 93}, {9758200, 250}, {9758201, 255}},
			},
			want: 			cpuState{
				D:   [8]uint32{1441798363, 1531763500, 2662872237, 1645229429, 2244944539, 3001733161, 2665898521, 3618178468},
				A:   [7]uint32{2497861318, 3877293874, 3697608297, 1320815736, 3407510373, 39679673, 1075298683},
				PC:  9758202,
				SR:  9216,
				USP: 2021998,
				SSP: 492458,
				RAM: [][2]uint32{{9758196, 230}, {9758197, 71}, {9758198, 219}, {9758199, 93}, {9758200, 250}, {9758201, 255}},
				Cycles: 12,
			},
		},
		{
			name: "1115 ASR.w 8, D1 e041",
			init: 			cpuState{
				D:   [8]uint32{610828851, 3979943287, 1947976908, 92493621, 3420560635, 2954883773, 2288331820, 175383056},
				A:   [7]uint32{4198684923, 1653982865, 2399592304, 3948931525, 2731296170, 2762545552, 233301375},
				PC:  15138444,
				SR:  9475,
				USP: 4528778,
				SSP: 5199086,
				RAM: [][2]uint32{{15138440, 224}, {15138441, 65}, {15138442, 217}, {15138443, 255}, {15138444, 105}, {15138445, 70}},
			},
			want: 			cpuState{
				D:   [8]uint32{610828851, 3979935773, 1947976908, 92493621, 3420560635, 2954883773, 2288331820, 175383056},
				A:   [7]uint32{4198684923, 1653982865, 2399592304, 3948931525, 2731296170, 2762545552, 233301375},
				PC:  15138446,
				SR:  9472,
				USP: 4528778,
				SSP: 5199086,
				RAM: [][2]uint32{{15138440, 224}, {15138441, 65}, {15138442, 217}, {15138443, 255}, {15138444, 105}, {15138445, 70}},
				Cycles: 22,
			},
		},
		{
			name: "1398 ASR.w D5, D0 ea60",
			init: 			cpuState{
				D:   [8]uint32{222759333, 549353181, 262302364, 3842094886, 3823905671, 1857130487, 3334774892, 343502549},
				A:   [7]uint32{4151242976, 3528670101, 3548531393, 1863113691, 1953436489, 3823909746, 3218056326},
				PC:  991142,
				SR:  527,
				USP: 9959996,
				SSP: 2049822,
				RAM: [][2]uint32{{991138, 234}, {991139, 96}, {991140, 101}, {991141, 148}, {991142, 87}, {991143, 45}},
			},
			want: 			cpuState{
				D:   [8]uint32{222756864, 549353181, 262302364, 3842094886, 3823905671, 1857130487, 3334774892, 343502549},
				A:   [7]uint32{4151242976, 3528670101, 3548531393, 1863113691, 1953436489, 3823909746, 3218056326},
				PC:  991144,
				SR:  516,
				USP: 9959996,
				SSP: 2049822,
				RAM: [][2]uint32{{991138, 234}, {991139, 96}, {991140, 101}, {991141, 148}, {991142, 87}, {991143, 45}},
				Cycles: 116,
			},
		},
		{
			name: "1692 ASR.w D3, D6 e666",
			init: 			cpuState{
				D:   [8]uint32{3772419128, 1795285707, 3204465789, 4100182179, 2755521334, 3879496697, 1579226007, 1002328899},
				A:   [7]uint32{1695101336, 543897777, 31691159, 1578422367, 678791573, 577537820, 1394446870},
				PC:  3624040,
				SR:  8468,
				USP: 329444,
				SSP: 8011808,
				RAM: [][2]uint32{{3624036, 230}, {3624037, 102}, {3624038, 182}, {3624039, 233}, {3624040, 175}, {3624041, 244}},
			},
			want: 			cpuState{
				D:   [8]uint32{3772419128, 1795285707, 3204465789, 4100182179, 2755521334, 3879496697, 1579220992, 1002328899},
				A:   [7]uint32{1695101336, 543897777, 31691159, 1578422367, 678791573, 577537820, 1394446870},
				PC:  3624042,
				SR:  8452,
				USP: 329444,
				SSP: 8011808,
				RAM: [][2]uint32{{3624036, 230}, {3624037, 102}, {3624038, 182}, {3624039, 233}, {3624040, 175}, {3624041, 244}},
				Cycles: 76,
			},
		},
		{
			name: "1940 ASR.w 8, D4 e044",
			init: 			cpuState{
				D:   [8]uint32{4058419585, 3743883620, 2192087931, 316124428, 633596641, 2293931875, 1054383568, 3328994186},
				A:   [7]uint32{725168695, 3700467409, 2884318264, 3635761979, 3724018222, 3881503181, 2454168706},
				PC:  11226824,
				SR:  269,
				USP: 15513868,
				SSP: 13489260,
				RAM: [][2]uint32{{11226820, 224}, {11226821, 68}, {11226822, 241}, {11226823, 69}, {11226824, 17}, {11226825, 108}},
			},
			want: 			cpuState{
				D:   [8]uint32{4058419585, 3743883620, 2192087931, 316124428, 633602026, 2293931875, 1054383568, 3328994186},
				A:   [7]uint32{725168695, 3700467409, 2884318264, 3635761979, 3724018222, 3881503181, 2454168706},
				PC:  11226826,
				SR:  281,
				USP: 15513868,
				SSP: 13489260,
				RAM: [][2]uint32{{11226820, 224}, {11226821, 68}, {11226822, 241}, {11226823, 69}, {11226824, 17}, {11226825, 108}},
				Cycles: 22,
			},
		},
		{
			name: "2204 ASR.w 6, D6 ec46",
			init: 			cpuState{
				D:   [8]uint32{3787787587, 4186456412, 345109239, 3123912336, 1886154029, 452078896, 1992001252, 2317111800},
				A:   [7]uint32{2630707491, 310064463, 273455861, 636978815, 1088006697, 1716312299, 2473738775},
				PC:  10051450,
				SR:  534,
				USP: 8855754,
				SSP: 2981862,
				RAM: [][2]uint32{{10051446, 236}, {10051447, 70}, {10051448, 25}, {10051449, 23}, {10051450, 170}, {10051451, 10}},
			},
			want: 			cpuState{
				D:   [8]uint32{3787787587, 4186456412, 345109239, 3123912336, 1886154029, 452078896, 1992031771, 2317111800},
				A:   [7]uint32{2630707491, 310064463, 273455861, 636978815, 1088006697, 1716312299, 2473738775},
				PC:  10051452,
				SR:  537,
				USP: 8855754,
				SSP: 2981862,
				RAM: [][2]uint32{{10051446, 236}, {10051447, 70}, {10051448, 25}, {10051449, 23}, {10051450, 170}, {10051451, 10}},
				Cycles: 18,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASR.l 1, D7 e287",
			init: cpuState{
				D:   [8]uint32{4219025827, 2540318018, 4022561933, 3988407213, 4254647945, 926753132, 1434393014, 1687202767},
				A:   [7]uint32{1049309671, 2556119619, 2951051429, 3965440634, 1865347610, 3978938027, 3432232794},
				PC:  13433298,
				SR:  33550,
				USP: 5800670,
				SSP: 10802408,
				RAM: [][2]uint32{{13433294, 226}, {13433295, 135}, {13433296, 166}, {13433297, 106}, {13433298, 141}, {13433299, 59}},
			},
			want: cpuState{
				D:   [8]uint32{4219025827, 2540318018, 4022561933, 3988407213, 4254647945, 926753132, 1434393014, 843601383},
				A:   [7]uint32{1049309671, 2556119619, 2951051429, 3965440634, 1865347610, 3978938027, 3432232794},
				PC:  13433300,
				SR:  33553,
				USP: 5800670,
				SSP: 10802408,
				RAM: [][2]uint32{{13433294, 226}, {13433295, 135}, {13433296, 166}, {13433297, 106}, {13433298, 141}, {13433299, 59}},
				Cycles: 10,
			},
		},
		{
			name: "500 ASR.l D0, D0 e0a0",
			init: cpuState{
				D:   [8]uint32{1778769090, 3534880010, 1620392390, 3604988374, 2575560087, 3320743651, 308633308, 1254936416},
				A:   [7]uint32{3250098204, 1587147263, 829478014, 4117733772, 126380457, 3355574569, 1784695266},
				PC:  429448,
				SR:  33281,
				USP: 3423848,
				SSP: 16050820,
				RAM: [][2]uint32{{429444, 224}, {429445, 160}, {429446, 7}, {429447, 62}, {429448, 191}, {429449, 19}},
			},
			want: cpuState{
				D:   [8]uint32{444692272, 3534880010, 1620392390, 3604988374, 2575560087, 3320743651, 308633308, 1254936416},
				A:   [7]uint32{3250098204, 1587147263, 829478014, 4117733772, 126380457, 3355574569, 1784695266},
				PC:  429450,
				SR:  33297,
				USP: 3423848,
				SSP: 16050820,
				RAM: [][2]uint32{{429444, 224}, {429445, 160}, {429446, 7}, {429447, 62}, {429448, 191}, {429449, 19}},
				Cycles: 12,
			},
		},
		{
			name: "1000 ASR.l D7, D7 eea7",
			init: cpuState{
				D:   [8]uint32{3819587193, 2527156390, 126344482, 3618775720, 4133270541, 2057959974, 536006216, 2923497632},
				A:   [7]uint32{643677357, 1198308408, 1636403373, 3888624782, 628188416, 2416306181, 1444390977},
				PC:  5668024,
				SR:  8961,
				USP: 1855492,
				SSP: 14944066,
				RAM: [][2]uint32{{5668020, 238}, {5668021, 167}, {5668022, 120}, {5668023, 113}, {5668024, 168}, {5668025, 59}},
			},
			want: cpuState{
				D:   [8]uint32{3819587193, 2527156390, 126344482, 3618775720, 4133270541, 2057959974, 536006216, 4294967295},
				A:   [7]uint32{643677357, 1198308408, 1636403373, 3888624782, 628188416, 2416306181, 1444390977},
				PC:  5668026,
				SR:  8985,
				USP: 1855492,
				SSP: 14944066,
				RAM: [][2]uint32{{5668020, 238}, {5668021, 167}, {5668022, 120}, {5668023, 113}, {5668024, 168}, {5668025, 59}},
				Cycles: 72,
			},
		},
		{
			name: "1500 ASR.l D4, D1 e8a1",
			init: cpuState{
				D:   [8]uint32{2590285325, 793582723, 3504250770, 715032601, 1584468866, 1495159, 3264501513, 3143898527},
				A:   [7]uint32{1254671539, 217048534, 764397649, 2684049050, 1109284797, 3084424878, 2202998543},
				PC:  14228066,
				SR:  41484,
				USP: 14125804,
				SSP: 11593104,
				RAM: [][2]uint32{{14228062, 232}, {14228063, 161}, {14228064, 39}, {14228065, 15}, {14228066, 228}, {14228067, 51}},
			},
			want: cpuState{
				D:   [8]uint32{2590285325, 198395680, 3504250770, 715032601, 1584468866, 1495159, 3264501513, 3143898527},
				A:   [7]uint32{1254671539, 217048534, 764397649, 2684049050, 1109284797, 3084424878, 2202998543},
				PC:  14228068,
				SR:  41489,
				USP: 14125804,
				SSP: 11593104,
				RAM: [][2]uint32{{14228062, 232}, {14228063, 161}, {14228064, 39}, {14228065, 15}, {14228066, 228}, {14228067, 51}},
				Cycles: 12,
			},
		},
		{
			name: "2000 ASR.l 1, D6 e286",
			init: cpuState{
				D:   [8]uint32{2909956154, 1663350213, 2459965802, 2701756675, 3785329050, 2806861648, 3229233484, 850238063},
				A:   [7]uint32{4130615276, 1538582943, 4172299191, 3139128350, 2274623705, 577855242, 3555670148},
				PC:  3558514,
				SR:  10015,
				USP: 2259380,
				SSP: 4693302,
				RAM: [][2]uint32{{3558510, 226}, {3558511, 134}, {3558512, 87}, {3558513, 196}, {3558514, 96}, {3558515, 158}},
			},
			want: cpuState{
				D:   [8]uint32{2909956154, 1663350213, 2459965802, 2701756675, 3785329050, 2806861648, 3762100390, 850238063},
				A:   [7]uint32{4130615276, 1538582943, 4172299191, 3139128350, 2274623705, 577855242, 3555670148},
				PC:  3558516,
				SR:  9992,
				USP: 2259380,
				SSP: 4693302,
				RAM: [][2]uint32{{3558510, 226}, {3558511, 134}, {3558512, 87}, {3558513, 196}, {3558514, 96}, {3558515, 158}},
				Cycles: 10,
			},
		},
		{
			name: "001 ASR.l D2, D3 e4a3",
			init: 			cpuState{
				D:   [8]uint32{237175329, 889758890, 282180549, 4189751911, 2790423363, 1427765748, 1253685930, 3874871003},
				A:   [7]uint32{2836645193, 3055112176, 2471182979, 3912346504, 2813912489, 212583578, 626194313},
				PC:  12110366,
				SR:  9759,
				USP: 5443658,
				SSP: 15401038,
				RAM: [][2]uint32{{12110362, 228}, {12110363, 163}, {12110364, 141}, {12110365, 141}, {12110366, 227}, {12110367, 189}},
			},
			want: 			cpuState{
				D:   [8]uint32{237175329, 889758890, 282180549, 4291679315, 2790423363, 1427765748, 1253685930, 3874871003},
				A:   [7]uint32{2836645193, 3055112176, 2471182979, 3912346504, 2813912489, 212583578, 626194313},
				PC:  12110368,
				SR:  9736,
				USP: 5443658,
				SSP: 15401038,
				RAM: [][2]uint32{{12110362, 228}, {12110363, 163}, {12110364, 141}, {12110365, 141}, {12110366, 227}, {12110367, 189}},
				Cycles: 18,
			},
		},
		{
			name: "281 ASR.l D7, D2 eea2",
			init: 			cpuState{
				D:   [8]uint32{943080379, 4066124660, 3245351686, 2997329956, 3894824273, 289903854, 926316293, 532264948},
				A:   [7]uint32{1678560680, 3880899708, 3149626029, 3036422070, 1340149916, 3102654116, 2212112441},
				PC:  7475694,
				SR:  275,
				USP: 13528620,
				SSP: 16082536,
				RAM: [][2]uint32{{7475690, 238}, {7475691, 162}, {7475692, 222}, {7475693, 30}, {7475694, 53}, {7475695, 50}},
			},
			want: 			cpuState{
				D:   [8]uint32{943080379, 4066124660, 4294967295, 2997329956, 3894824273, 289903854, 926316293, 532264948},
				A:   [7]uint32{1678560680, 3880899708, 3149626029, 3036422070, 1340149916, 3102654116, 2212112441},
				PC:  7475696,
				SR:  281,
				USP: 13528620,
				SSP: 16082536,
				RAM: [][2]uint32{{7475690, 238}, {7475691, 162}, {7475692, 222}, {7475693, 30}, {7475694, 53}, {7475695, 50}},
				Cycles: 112,
			},
		},
		{
			name: "567 ASR.l D6, D2 eca2",
			init: 			cpuState{
				D:   [8]uint32{635867566, 1114473568, 1537983375, 3766541147, 2400921604, 550340654, 2227550330, 3326179438},
				A:   [7]uint32{1572471460, 1460569776, 1639948417, 790451047, 691121245, 4203952424, 4013764542},
				PC:  15908142,
				SR:  8458,
				USP: 5669188,
				SSP: 5413674,
				RAM: [][2]uint32{{15908138, 236}, {15908139, 162}, {15908140, 128}, {15908141, 21}, {15908142, 253}, {15908143, 32}},
			},
			want: 			cpuState{
				D:   [8]uint32{635867566, 1114473568, 0, 3766541147, 2400921604, 550340654, 2227550330, 3326179438},
				A:   [7]uint32{1572471460, 1460569776, 1639948417, 790451047, 691121245, 4203952424, 4013764542},
				PC:  15908144,
				SR:  8452,
				USP: 5669188,
				SSP: 5413674,
				RAM: [][2]uint32{{15908138, 236}, {15908139, 162}, {15908140, 128}, {15908141, 21}, {15908142, 253}, {15908143, 32}},
				Cycles: 124,
			},
		},
		{
			name: "833 ASR.l D2, D7 e4a7",
			init: 			cpuState{
				D:   [8]uint32{146823997, 3819328214, 2522281873, 3794456818, 2171895523, 3038836943, 1175353397, 3654149782},
				A:   [7]uint32{2217132877, 326478594, 3841385204, 3427042121, 441977822, 3945089706, 3014061882},
				PC:  5185656,
				SR:  780,
				USP: 6654754,
				SSP: 10246338,
				RAM: [][2]uint32{{5185652, 228}, {5185653, 167}, {5185654, 249}, {5185655, 108}, {5185656, 247}, {5185657, 217}},
			},
			want: 			cpuState{
				D:   [8]uint32{146823997, 3819328214, 2522281873, 3794456818, 2171895523, 3038836943, 1175353397, 4294962406},
				A:   [7]uint32{2217132877, 326478594, 3841385204, 3427042121, 441977822, 3945089706, 3014061882},
				PC:  5185658,
				SR:  793,
				USP: 6654754,
				SSP: 10246338,
				RAM: [][2]uint32{{5185652, 228}, {5185653, 167}, {5185654, 249}, {5185655, 108}, {5185656, 247}, {5185657, 217}},
				Cycles: 42,
			},
		},
		{
			name: "1099 ASR.l 8, D4 e084",
			init: 			cpuState{
				D:   [8]uint32{3735485998, 697949321, 2818919548, 3002491766, 293641983, 1048553639, 1771028570, 3506085523},
				A:   [7]uint32{2525997287, 3772768791, 1019800921, 2521305205, 3706461383, 627360045, 494599173},
				PC:  15510140,
				SR:  9496,
				USP: 2301660,
				SSP: 5216342,
				RAM: [][2]uint32{{15510136, 224}, {15510137, 132}, {15510138, 52}, {15510139, 91}, {15510140, 31}, {15510141, 121}},
			},
			want: 			cpuState{
				D:   [8]uint32{3735485998, 697949321, 2818919548, 3002491766, 1147038, 1048553639, 1771028570, 3506085523},
				A:   [7]uint32{2525997287, 3772768791, 1019800921, 2521305205, 3706461383, 627360045, 494599173},
				PC:  15510142,
				SR:  9489,
				USP: 2301660,
				SSP: 5216342,
				RAM: [][2]uint32{{15510136, 224}, {15510137, 132}, {15510138, 52}, {15510139, 91}, {15510140, 31}, {15510141, 121}},
				Cycles: 24,
			},
		},
		{
			name: "1384 ASR.l 1, D1 e281",
			init: 			cpuState{
				D:   [8]uint32{1617383060, 2206650049, 2469307318, 2922541463, 2738100361, 3243303482, 747434754, 2802223019},
				A:   [7]uint32{35998062, 16224962, 1476613702, 4225403657, 2953152611, 4181821878, 1086890306},
				PC:  13392772,
				SR:  8978,
				USP: 14934508,
				SSP: 16098162,
				RAM: [][2]uint32{{13392768, 226}, {13392769, 129}, {13392770, 221}, {13392771, 50}, {13392772, 167}, {13392773, 30}},
			},
			want: 			cpuState{
				D:   [8]uint32{1617383060, 3250808672, 2469307318, 2922541463, 2738100361, 3243303482, 747434754, 2802223019},
				A:   [7]uint32{35998062, 16224962, 1476613702, 4225403657, 2953152611, 4181821878, 1086890306},
				PC:  13392774,
				SR:  8985,
				USP: 14934508,
				SSP: 16098162,
				RAM: [][2]uint32{{13392768, 226}, {13392769, 129}, {13392770, 221}, {13392771, 50}, {13392772, 167}, {13392773, 30}},
				Cycles: 10,
			},
		},
		{
			name: "1657 ASR.l D6, D4 eca4",
			init: 			cpuState{
				D:   [8]uint32{2274861582, 1901566350, 3913170511, 3701816561, 1673786688, 3519722050, 1622901644, 2682250005},
				A:   [7]uint32{4226912249, 869509424, 4073552010, 3576165987, 2555390804, 387877774, 1780341451},
				PC:  13925066,
				SR:  1290,
				USP: 1626982,
				SSP: 7345560,
				RAM: [][2]uint32{{13925062, 236}, {13925063, 164}, {13925064, 126}, {13925065, 14}, {13925066, 78}, {13925067, 87}},
			},
			want: 			cpuState{
				D:   [8]uint32{2274861582, 1901566350, 3913170511, 3701816561, 408639, 3519722050, 1622901644, 2682250005},
				A:   [7]uint32{4226912249, 869509424, 4073552010, 3576165987, 2555390804, 387877774, 1780341451},
				PC:  13925068,
				SR:  1280,
				USP: 1626982,
				SSP: 7345560,
				RAM: [][2]uint32{{13925062, 236}, {13925063, 164}, {13925064, 126}, {13925065, 14}, {13925066, 78}, {13925067, 87}},
				Cycles: 32,
			},
		},
		{
			name: "1938 ASR.l 8, D3 e083",
			init: 			cpuState{
				D:   [8]uint32{3854803305, 1927475985, 1359969287, 2320580811, 2714907672, 2078683457, 2898893108, 1815794683},
				A:   [7]uint32{167468941, 872877814, 3441552269, 2395666139, 997748606, 3678885263, 2990877872},
				PC:  14946416,
				SR:  775,
				USP: 3848358,
				SSP: 7303938,
				RAM: [][2]uint32{{14946412, 224}, {14946413, 131}, {14946414, 161}, {14946415, 44}, {14946416, 215}, {14946417, 113}},
			},
			want: 			cpuState{
				D:   [8]uint32{3854803305, 1927475985, 1359969287, 4287254848, 2714907672, 2078683457, 2898893108, 1815794683},
				A:   [7]uint32{167468941, 872877814, 3441552269, 2395666139, 997748606, 3678885263, 2990877872},
				PC:  14946418,
				SR:  793,
				USP: 3848358,
				SSP: 7303938,
				RAM: [][2]uint32{{14946412, 224}, {14946413, 131}, {14946414, 161}, {14946415, 44}, {14946416, 215}, {14946417, 113}},
				Cycles: 24,
			},
		},
		{
			name: "2219 ASR.l 5, D7 ea87",
			init: 			cpuState{
				D:   [8]uint32{129125841, 1937650121, 2484117274, 2195330780, 3767503628, 2982265565, 2297904847, 741258547},
				A:   [7]uint32{2682935319, 2541988411, 2663202187, 1753782272, 3476202772, 2331641298, 214991081},
				PC:  7933088,
				SR:  8720,
				USP: 11848408,
				SSP: 5364640,
				RAM: [][2]uint32{{7933084, 234}, {7933085, 135}, {7933086, 41}, {7933087, 56}, {7933088, 99}, {7933089, 29}},
			},
			want: 			cpuState{
				D:   [8]uint32{129125841, 1937650121, 2484117274, 2195330780, 3767503628, 2982265565, 2297904847, 23164329},
				A:   [7]uint32{2682935319, 2541988411, 2663202187, 1753782272, 3476202772, 2331641298, 214991081},
				PC:  7933090,
				SR:  8721,
				USP: 11848408,
				SSP: 5364640,
				RAM: [][2]uint32{{7933084, 234}, {7933085, 135}, {7933086, 41}, {7933087, 56}, {7933088, 99}, {7933089, 29}},
				Cycles: 18,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSL_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSL.b 6, D0 ed08",
			init: cpuState{
				D:   [8]uint32{1992387442, 3472012941, 1621034574, 3444782784, 2285654641, 2767730766, 2674935476, 2414716882},
				A:   [7]uint32{1627331514, 3980198845, 3865730721, 756098789, 297213050, 329114438, 726582774},
				PC:  1122976,
				SR:  1027,
				USP: 1189786,
				SSP: 10571966,
				RAM: [][2]uint32{{1122972, 237}, {1122973, 8}, {1122974, 21}, {1122975, 154}, {1122976, 216}, {1122977, 31}},
			},
			want: cpuState{
				D:   [8]uint32{1992387456, 3472012941, 1621034574, 3444782784, 2285654641, 2767730766, 2674935476, 2414716882},
				A:   [7]uint32{1627331514, 3980198845, 3865730721, 756098789, 297213050, 329114438, 726582774},
				PC:  1122978,
				SR:  1032,
				USP: 1189786,
				SSP: 10571966,
				RAM: [][2]uint32{{1122972, 237}, {1122973, 8}, {1122974, 21}, {1122975, 154}, {1122976, 216}, {1122977, 31}},
				Cycles: 18,
			},
		},
		{
			name: "500 LSL.b D6, D4 ed2c",
			init: cpuState{
				D:   [8]uint32{1599171048, 2196521805, 3054125788, 3758524881, 2235607162, 228397225, 4004784534, 687957965},
				A:   [7]uint32{1392555770, 1380745058, 4163631302, 1144419425, 3268922448, 1877058319, 1113098029},
				PC:  10731740,
				SR:  33307,
				USP: 10436290,
				SSP: 9942458,
				RAM: [][2]uint32{{10731736, 237}, {10731737, 44}, {10731738, 232}, {10731739, 114}, {10731740, 7}, {10731741, 67}},
			},
			want: cpuState{
				D:   [8]uint32{1599171048, 2196521805, 3054125788, 3758524881, 2235607040, 228397225, 4004784534, 687957965},
				A:   [7]uint32{1392555770, 1380745058, 4163631302, 1144419425, 3268922448, 1877058319, 1113098029},
				PC:  10731742,
				SR:  33284,
				USP: 10436290,
				SSP: 9942458,
				RAM: [][2]uint32{{10731736, 237}, {10731737, 44}, {10731738, 232}, {10731739, 114}, {10731740, 7}, {10731741, 67}},
				Cycles: 50,
			},
		},
		{
			name: "1000 LSL.b 6, D3 ed0b",
			init: cpuState{
				D:   [8]uint32{879765760, 2688131140, 3063880167, 830036689, 209309840, 1979162255, 3552322735, 898053399},
				A:   [7]uint32{1394647907, 3995225778, 1990124010, 340156957, 2018556962, 1486385078, 3072270179},
				PC:  16511144,
				SR:  34570,
				USP: 14260774,
				SSP: 13868890,
				RAM: [][2]uint32{{16511140, 237}, {16511141, 11}, {16511142, 145}, {16511143, 65}, {16511144, 67}, {16511145, 88}},
			},
			want: cpuState{
				D:   [8]uint32{879765760, 2688131140, 3063880167, 830036544, 209309840, 1979162255, 3552322735, 898053399},
				A:   [7]uint32{1394647907, 3995225778, 1990124010, 340156957, 2018556962, 1486385078, 3072270179},
				PC:  16511146,
				SR:  34560,
				USP: 14260774,
				SSP: 13868890,
				RAM: [][2]uint32{{16511140, 237}, {16511141, 11}, {16511142, 145}, {16511143, 65}, {16511144, 67}, {16511145, 88}},
				Cycles: 18,
			},
		},
		{
			name: "1500 LSL.b D3, D0 e728",
			init: cpuState{
				D:   [8]uint32{680672205, 4042291778, 2841054725, 889443563, 1094784177, 546459348, 112687106, 2056094918},
				A:   [7]uint32{1399532838, 3942083665, 1653516753, 1381150069, 2418165356, 1704000852, 3018141759},
				PC:  14065040,
				SR:  1033,
				USP: 1437722,
				SSP: 2613914,
				RAM: [][2]uint32{{14065036, 231}, {14065037, 40}, {14065038, 146}, {14065039, 131}, {14065040, 239}, {14065041, 212}},
			},
			want: cpuState{
				D:   [8]uint32{680672000, 4042291778, 2841054725, 889443563, 1094784177, 546459348, 112687106, 2056094918},
				A:   [7]uint32{1399532838, 3942083665, 1653516753, 1381150069, 2418165356, 1704000852, 3018141759},
				PC:  14065042,
				SR:  1028,
				USP: 1437722,
				SSP: 2613914,
				RAM: [][2]uint32{{14065036, 231}, {14065037, 40}, {14065038, 146}, {14065039, 131}, {14065040, 239}, {14065041, 212}},
				Cycles: 92,
			},
		},
		{
			name: "2000 LSL.b 4, D0 e908",
			init: cpuState{
				D:   [8]uint32{3111992211, 2077214563, 2576123109, 2778800239, 932863965, 452035650, 1544498353, 3161883402},
				A:   [7]uint32{1602118372, 4121717196, 479198742, 749224206, 435748988, 3469302170, 1393352494},
				PC:  8694298,
				SR:  32778,
				USP: 7444304,
				SSP: 11445272,
				RAM: [][2]uint32{{8694294, 233}, {8694295, 8}, {8694296, 160}, {8694297, 18}, {8694298, 202}, {8694299, 78}},
			},
			want: cpuState{
				D:   [8]uint32{3111992112, 2077214563, 2576123109, 2778800239, 932863965, 452035650, 1544498353, 3161883402},
				A:   [7]uint32{1602118372, 4121717196, 479198742, 749224206, 435748988, 3469302170, 1393352494},
				PC:  8694300,
				SR:  32785,
				USP: 7444304,
				SSP: 11445272,
				RAM: [][2]uint32{{8694294, 233}, {8694295, 8}, {8694296, 160}, {8694297, 18}, {8694298, 202}, {8694299, 78}},
				Cycles: 14,
			},
		},
		{
			name: "003 LSL.b D4, D3 e92b",
			init: 			cpuState{
				D:   [8]uint32{1278711729, 1509221508, 1300067586, 1965606342, 402861976, 4067297514, 841173039, 1470895455},
				A:   [7]uint32{4162951484, 2173996118, 151178729, 1228423409, 3323396717, 535828908, 4217122923},
				PC:  6123058,
				SR:  8979,
				USP: 9473928,
				SSP: 12677132,
				RAM: [][2]uint32{{6123054, 233}, {6123055, 43}, {6123056, 216}, {6123057, 185}, {6123058, 244}, {6123059, 126}},
			},
			want: 			cpuState{
				D:   [8]uint32{1278711729, 1509221508, 1300067586, 1965606144, 402861976, 4067297514, 841173039, 1470895455},
				A:   [7]uint32{4162951484, 2173996118, 151178729, 1228423409, 3323396717, 535828908, 4217122923},
				PC:  6123060,
				SR:  8964,
				USP: 9473928,
				SSP: 12677132,
				RAM: [][2]uint32{{6123054, 233}, {6123055, 43}, {6123056, 216}, {6123057, 185}, {6123058, 244}, {6123059, 126}},
				Cycles: 54,
			},
		},
		{
			name: "264 LSL.b 4, D3 e90b",
			init: 			cpuState{
				D:   [8]uint32{2904854551, 1713817035, 1700747756, 4134295287, 1936533912, 338042486, 2349590577, 1940158239},
				A:   [7]uint32{815174355, 1790748722, 3865466783, 847231122, 3267442361, 1710062532, 4219783625},
				PC:  13814850,
				SR:  9741,
				USP: 11813730,
				SSP: 526546,
				RAM: [][2]uint32{{13814846, 233}, {13814847, 11}, {13814848, 143}, {13814849, 14}, {13814850, 161}, {13814851, 95}},
			},
			want: 			cpuState{
				D:   [8]uint32{2904854551, 1713817035, 1700747756, 4134295152, 1936533912, 338042486, 2349590577, 1940158239},
				A:   [7]uint32{815174355, 1790748722, 3865466783, 847231122, 3267442361, 1710062532, 4219783625},
				PC:  13814852,
				SR:  9745,
				USP: 11813730,
				SSP: 526546,
				RAM: [][2]uint32{{13814846, 233}, {13814847, 11}, {13814848, 143}, {13814849, 14}, {13814850, 161}, {13814851, 95}},
				Cycles: 14,
			},
		},
		{
			name: "561 LSL.b 3, D0 e708",
			init: 			cpuState{
				D:   [8]uint32{1990359332, 93771722, 1190555517, 3338603862, 2652546061, 1869466880, 1702424009, 632251192},
				A:   [7]uint32{2097772741, 3944312002, 937909114, 3552166115, 610039309, 3193810247, 2749548480},
				PC:  59404,
				SR:  9233,
				USP: 677626,
				SSP: 8938962,
				RAM: [][2]uint32{{59400, 231}, {59401, 8}, {59402, 66}, {59403, 113}, {59404, 190}, {59405, 198}},
			},
			want: 			cpuState{
				D:   [8]uint32{1990359328, 93771722, 1190555517, 3338603862, 2652546061, 1869466880, 1702424009, 632251192},
				A:   [7]uint32{2097772741, 3944312002, 937909114, 3552166115, 610039309, 3193810247, 2749548480},
				PC:  59406,
				SR:  9233,
				USP: 677626,
				SSP: 8938962,
				RAM: [][2]uint32{{59400, 231}, {59401, 8}, {59402, 66}, {59403, 113}, {59404, 190}, {59405, 198}},
				Cycles: 12,
			},
		},
		{
			name: "839 LSL.b D6, D6 ed2e",
			init: 			cpuState{
				D:   [8]uint32{2900814919, 1284542239, 3182108535, 959939719, 1947675492, 177000472, 901816286, 510255668},
				A:   [7]uint32{3373724082, 4232748390, 243656248, 2160967609, 3580326523, 4016777840, 1469965327},
				PC:  12182476,
				SR:  1050,
				USP: 4237172,
				SSP: 10430532,
				RAM: [][2]uint32{{12182472, 237}, {12182473, 46}, {12182474, 169}, {12182475, 186}, {12182476, 211}, {12182477, 190}},
			},
			want: 			cpuState{
				D:   [8]uint32{2900814919, 1284542239, 3182108535, 959939719, 1947675492, 177000472, 901816064, 510255668},
				A:   [7]uint32{3373724082, 4232748390, 243656248, 2160967609, 3580326523, 4016777840, 1469965327},
				PC:  12182478,
				SR:  1028,
				USP: 4237172,
				SSP: 10430532,
				RAM: [][2]uint32{{12182472, 237}, {12182473, 46}, {12182474, 169}, {12182475, 186}, {12182476, 211}, {12182477, 190}},
				Cycles: 66,
			},
		},
		{
			name: "1134 LSL.b 7, D2 ef0a",
			init: 			cpuState{
				D:   [8]uint32{974970175, 661589955, 3500633779, 130557157, 2496395429, 1812911040, 2373560266, 770389849},
				A:   [7]uint32{1886229130, 1929061451, 1956410997, 1229110511, 4243877259, 3121016118, 1144042257},
				PC:  16460816,
				SR:  8206,
				USP: 6329582,
				SSP: 2038056,
				RAM: [][2]uint32{{16460812, 239}, {16460813, 10}, {16460814, 15}, {16460815, 99}, {16460816, 180}, {16460817, 58}},
			},
			want: 			cpuState{
				D:   [8]uint32{974970175, 661589955, 3500633728, 130557157, 2496395429, 1812911040, 2373560266, 770389849},
				A:   [7]uint32{1886229130, 1929061451, 1956410997, 1229110511, 4243877259, 3121016118, 1144042257},
				PC:  16460818,
				SR:  8217,
				USP: 6329582,
				SSP: 2038056,
				RAM: [][2]uint32{{16460812, 239}, {16460813, 10}, {16460814, 15}, {16460815, 99}, {16460816, 180}, {16460817, 58}},
				Cycles: 20,
			},
		},
		{
			name: "1418 LSL.b D0, D7 e12f",
			init: 			cpuState{
				D:   [8]uint32{1819799317, 909121908, 714189933, 3006443311, 757817292, 258952267, 3155970723, 3687126702},
				A:   [7]uint32{659338306, 3776656200, 2432542996, 2739187879, 3013555796, 3251467326, 3515107719},
				PC:  15697500,
				SR:  1045,
				USP: 6549792,
				SSP: 13009974,
				RAM: [][2]uint32{{15697496, 225}, {15697497, 47}, {15697498, 226}, {15697499, 186}, {15697500, 101}, {15697501, 109}},
			},
			want: 			cpuState{
				D:   [8]uint32{1819799317, 909121908, 714189933, 3006443311, 757817292, 258952267, 3155970723, 3687126528},
				A:   [7]uint32{659338306, 3776656200, 2432542996, 2739187879, 3013555796, 3251467326, 3515107719},
				PC:  15697502,
				SR:  1028,
				USP: 6549792,
				SSP: 13009974,
				RAM: [][2]uint32{{15697496, 225}, {15697497, 47}, {15697498, 226}, {15697499, 186}, {15697500, 101}, {15697501, 109}},
				Cycles: 48,
			},
		},
		{
			name: "1711 LSL.b D0, D1 e129",
			init: 			cpuState{
				D:   [8]uint32{780571317, 931650724, 1643541511, 3840404922, 3464261367, 3880751734, 407412533, 2453100788},
				A:   [7]uint32{660132607, 4000141805, 1110544061, 3859374892, 2985192284, 362079452, 269515560},
				PC:  7992336,
				SR:  1822,
				USP: 2866440,
				SSP: 6537142,
				RAM: [][2]uint32{{7992332, 225}, {7992333, 41}, {7992334, 69}, {7992335, 162}, {7992336, 146}, {7992337, 93}},
			},
			want: 			cpuState{
				D:   [8]uint32{780571317, 931650560, 1643541511, 3840404922, 3464261367, 3880751734, 407412533, 2453100788},
				A:   [7]uint32{660132607, 4000141805, 1110544061, 3859374892, 2985192284, 362079452, 269515560},
				PC:  7992338,
				SR:  1796,
				USP: 2866440,
				SSP: 6537142,
				RAM: [][2]uint32{{7992332, 225}, {7992333, 41}, {7992334, 69}, {7992335, 162}, {7992336, 146}, {7992337, 93}},
				Cycles: 112,
			},
		},
		{
			name: "1955 LSL.b D2, D0 e528",
			init: 			cpuState{
				D:   [8]uint32{4006955261, 4185645053, 2576223899, 2799966962, 3200356499, 2539779156, 451777768, 1853524103},
				A:   [7]uint32{3717412387, 724030218, 1612686088, 665356174, 4204946185, 1760759548, 4225739148},
				PC:  1589524,
				SR:  9759,
				USP: 3247290,
				SSP: 10092268,
				RAM: [][2]uint32{{1589520, 229}, {1589521, 40}, {1589522, 140}, {1589523, 127}, {1589524, 115}, {1589525, 57}},
			},
			want: 			cpuState{
				D:   [8]uint32{4006955008, 4185645053, 2576223899, 2799966962, 3200356499, 2539779156, 451777768, 1853524103},
				A:   [7]uint32{3717412387, 724030218, 1612686088, 665356174, 4204946185, 1760759548, 4225739148},
				PC:  1589526,
				SR:  9732,
				USP: 3247290,
				SSP: 10092268,
				RAM: [][2]uint32{{1589520, 229}, {1589521, 40}, {1589522, 140}, {1589523, 127}, {1589524, 115}, {1589525, 57}},
				Cycles: 60,
			},
		},
		{
			name: "2212 LSL.b 5, D1 eb09",
			init: 			cpuState{
				D:   [8]uint32{1934457567, 1893818165, 3279424813, 1388077401, 426894347, 1777726353, 708037150, 190678131},
				A:   [7]uint32{2715660051, 2906964791, 345171994, 3772997723, 1775319030, 3800073316, 1834706608},
				PC:  7142048,
				SR:  9,
				USP: 10204256,
				SSP: 11632486,
				RAM: [][2]uint32{{7142044, 235}, {7142045, 9}, {7142046, 141}, {7142047, 165}, {7142048, 87}, {7142049, 67}},
			},
			want: 			cpuState{
				D:   [8]uint32{1934457567, 1893818272, 3279424813, 1388077401, 426894347, 1777726353, 708037150, 190678131},
				A:   [7]uint32{2715660051, 2906964791, 345171994, 3772997723, 1775319030, 3800073316, 1834706608},
				PC:  7142050,
				SR:  8,
				USP: 10204256,
				SSP: 11632486,
				RAM: [][2]uint32{{7142044, 235}, {7142045, 9}, {7142046, 141}, {7142047, 165}, {7142048, 87}, {7142049, 67}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSL_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSL.w 1, D3 e34b",
			init: cpuState{
				D:   [8]uint32{1118836171, 693315389, 2991842178, 4270755532, 1362240818, 3948461450, 418543815, 3197610565},
				A:   [7]uint32{1549106042, 2223112240, 3227626001, 2278141428, 2054966790, 2989827775, 1172029541},
				PC:  7046594,
				SR:  8449,
				USP: 10416842,
				SSP: 5916144,
				RAM: [][2]uint32{{7046590, 227}, {7046591, 75}, {7046592, 217}, {7046593, 76}, {7046594, 30}, {7046595, 115}},
			},
			want: cpuState{
				D:   [8]uint32{1118836171, 693315389, 2991842178, 4270726552, 1362240818, 3948461450, 418543815, 3197610565},
				A:   [7]uint32{1549106042, 2223112240, 3227626001, 2278141428, 2054966790, 2989827775, 1172029541},
				PC:  7046596,
				SR:  8465,
				USP: 10416842,
				SSP: 5916144,
				RAM: [][2]uint32{{7046590, 227}, {7046591, 75}, {7046592, 217}, {7046593, 76}, {7046594, 30}, {7046595, 115}},
				Cycles: 8,
			},
		},
		{
			name: "500 LSL.w 7, D3 ef4b",
			init: cpuState{
				D:   [8]uint32{4081543179, 4034743290, 2155877271, 459227949, 1094259221, 2453950253, 3214268488, 3364883639},
				A:   [7]uint32{2553268285, 2158242607, 792752194, 1322511529, 3905473925, 1244120398, 923449562},
				PC:  12237288,
				SR:  42245,
				USP: 14812994,
				SSP: 15066884,
				RAM: [][2]uint32{{12237284, 239}, {12237285, 75}, {12237286, 221}, {12237287, 53}, {12237288, 231}, {12237289, 122}},
			},
			want: cpuState{
				D:   [8]uint32{4081543179, 4034743290, 2155877271, 459249280, 1094259221, 2453950253, 3214268488, 3364883639},
				A:   [7]uint32{2553268285, 2158242607, 792752194, 1322511529, 3905473925, 1244120398, 923449562},
				PC:  12237290,
				SR:  42265,
				USP: 14812994,
				SSP: 15066884,
				RAM: [][2]uint32{{12237284, 239}, {12237285, 75}, {12237286, 221}, {12237287, 53}, {12237288, 231}, {12237289, 122}},
				Cycles: 20,
			},
		},
		{
			name: "1000 LSL.w 5, D6 eb4e",
			init: cpuState{
				D:   [8]uint32{3643983838, 3800566182, 3259089509, 775353568, 408271118, 2895638549, 4241384661, 2154083113},
				A:   [7]uint32{3699425381, 1526504485, 3746583901, 3047950263, 3430722079, 3579605029, 3735105101},
				PC:  12183244,
				SR:  1552,
				USP: 15368304,
				SSP: 9214052,
				RAM: [][2]uint32{{12183240, 235}, {12183241, 78}, {12183242, 162}, {12183243, 119}, {12183244, 251}, {12183245, 157}},
			},
			want: cpuState{
				D:   [8]uint32{3643983838, 3800566182, 3259089509, 775353568, 408271118, 2895638549, 4241398432, 2154083113},
				A:   [7]uint32{3699425381, 1526504485, 3746583901, 3047950263, 3430722079, 3579605029, 3735105101},
				PC:  12183246,
				SR:  1544,
				USP: 15368304,
				SSP: 9214052,
				RAM: [][2]uint32{{12183240, 235}, {12183241, 78}, {12183242, 162}, {12183243, 119}, {12183244, 251}, {12183245, 157}},
				Cycles: 16,
			},
		},
		{
			name: "1500 LSL.w D7, D3 ef6b",
			init: cpuState{
				D:   [8]uint32{3917822185, 3333680672, 2063279199, 4187302206, 199517200, 1631966235, 624217394, 2751624973},
				A:   [7]uint32{881941121, 167247932, 277544136, 2412030287, 2487026024, 2576917288, 3709132532},
				PC:  8160450,
				SR:  9759,
				USP: 7419170,
				SSP: 8534914,
				RAM: [][2]uint32{{8160446, 239}, {8160447, 107}, {8160448, 41}, {8160449, 184}, {8160450, 161}, {8160451, 26}},
			},
			want: cpuState{
				D:   [8]uint32{3917822185, 3333680672, 2063279199, 4187340800, 199517200, 1631966235, 624217394, 2751624973},
				A:   [7]uint32{881941121, 167247932, 277544136, 2412030287, 2487026024, 2576917288, 3709132532},
				PC:  8160452,
				SR:  9753,
				USP: 7419170,
				SSP: 8534914,
				RAM: [][2]uint32{{8160446, 239}, {8160447, 107}, {8160448, 41}, {8160449, 184}, {8160450, 161}, {8160451, 26}},
				Cycles: 32,
			},
		},
		{
			name: "2000 LSL.w D3, D0 e768",
			init: cpuState{
				D:   [8]uint32{1441720186, 3027774892, 3697584072, 220988956, 1968024498, 4054318018, 2568185072, 18734346},
				A:   [7]uint32{3349678785, 822780736, 362806047, 2273777691, 1778016412, 3382496960, 697162390},
				PC:  12280310,
				SR:  1800,
				USP: 16655444,
				SSP: 11290822,
				RAM: [][2]uint32{{12280306, 231}, {12280307, 104}, {12280308, 26}, {12280309, 225}, {12280310, 90}, {12280311, 76}},
			},
			want: cpuState{
				D:   [8]uint32{1441660928, 3027774892, 3697584072, 220988956, 1968024498, 4054318018, 2568185072, 18734346},
				A:   [7]uint32{3349678785, 822780736, 362806047, 2273777691, 1778016412, 3382496960, 697162390},
				PC:  12280312,
				SR:  1796,
				USP: 16655444,
				SSP: 11290822,
				RAM: [][2]uint32{{12280306, 231}, {12280307, 104}, {12280308, 26}, {12280309, 225}, {12280310, 90}, {12280311, 76}},
				Cycles: 62,
			},
		},
		{
			name: "001 LSL.w D6, D4 ed6c",
			init: 			cpuState{
				D:   [8]uint32{805976432, 1497926840, 2722619015, 3262126935, 3226701660, 2727857619, 1694870765, 303732879},
				A:   [7]uint32{4222040167, 3553239151, 1394185546, 2699442032, 2933082842, 3696520204, 3073891524},
				PC:  1354848,
				SR:  539,
				USP: 5972460,
				SSP: 3385360,
				RAM: [][2]uint32{{1354844, 237}, {1354845, 108}, {1354846, 153}, {1354847, 195}, {1354848, 5}, {1354849, 181}},
			},
			want: 			cpuState{
				D:   [8]uint32{805976432, 1497926840, 2722619015, 3262126935, 3226664960, 2727857619, 1694870765, 303732879},
				A:   [7]uint32{4222040167, 3553239151, 1394185546, 2699442032, 2933082842, 3696520204, 3073891524},
				PC:  1354850,
				SR:  516,
				USP: 5972460,
				SSP: 3385360,
				RAM: [][2]uint32{{1354844, 237}, {1354845, 108}, {1354846, 153}, {1354847, 195}, {1354848, 5}, {1354849, 181}},
				Cycles: 96,
			},
		},
		{
			name: "259 LSL.w D1, D6 e36e",
			init: 			cpuState{
				D:   [8]uint32{4048325777, 2500219577, 767553680, 1074872946, 2399245150, 2240418621, 1058794367, 3876735513},
				A:   [7]uint32{1307584761, 3852550199, 3756223519, 185644315, 1038685271, 2572705140, 2950640038},
				PC:  2512728,
				SR:  8197,
				USP: 12838964,
				SSP: 8882068,
				RAM: [][2]uint32{{2512724, 227}, {2512725, 110}, {2512726, 54}, {2512727, 40}, {2512728, 71}, {2512729, 20}},
			},
			want: 			cpuState{
				D:   [8]uint32{4048325777, 2500219577, 767553680, 1074872946, 2399245150, 2240418621, 1058734080, 3876735513},
				A:   [7]uint32{1307584761, 3852550199, 3756223519, 185644315, 1038685271, 2572705140, 2950640038},
				PC:  2512730,
				SR:  8196,
				USP: 12838964,
				SSP: 8882068,
				RAM: [][2]uint32{{2512724, 227}, {2512725, 110}, {2512726, 54}, {2512727, 40}, {2512728, 71}, {2512729, 20}},
				Cycles: 120,
			},
		},
		{
			name: "529 LSL.w (A7) e3d7",
			init: 			cpuState{
				D:   [8]uint32{1390795245, 2004231480, 837136976, 3405119076, 3171636244, 4096142042, 3238368917, 1096052531},
				A:   [7]uint32{1765159655, 1694271787, 1019631940, 2011109288, 2921040045, 3663606028, 3557568698},
				PC:  14589138,
				SR:  533,
				USP: 11408826,
				SSP: 5878010,
				RAM: [][2]uint32{{14589134, 227}, {14589135, 215}, {14589136, 95}, {14589137, 154}, {11408826, 85}, {11408827, 189}, {14589138, 177}, {14589139, 212}},
			},
			want: 			cpuState{
				D:   [8]uint32{1390795245, 2004231480, 837136976, 3405119076, 3171636244, 4096142042, 3238368917, 1096052531},
				A:   [7]uint32{1765159655, 1694271787, 1019631940, 2011109288, 2921040045, 3663606028, 3557568698},
				PC:  14589140,
				SR:  520,
				USP: 11408826,
				SSP: 5878010,
				RAM: [][2]uint32{{14589134, 227}, {14589135, 215}, {14589136, 95}, {14589137, 154}, {11408826, 171}, {11408827, 122}, {14589138, 177}, {14589139, 212}},
				Cycles: 12,
			},
		},
		{
			name: "794 LSL.w D3, D2 e76a",
			init: 			cpuState{
				D:   [8]uint32{3381725461, 3871661707, 3088638902, 3582633182, 1120651418, 2056715002, 4228593929, 3580190304},
				A:   [7]uint32{3152191187, 2662309209, 3581439602, 3615393279, 3276762985, 534652831, 765679613},
				PC:  9451678,
				SR:  9483,
				USP: 6701442,
				SSP: 4466252,
				RAM: [][2]uint32{{9451674, 231}, {9451675, 106}, {9451676, 239}, {9451677, 78}, {9451678, 180}, {9451679, 4}},
			},
			want: 			cpuState{
				D:   [8]uint32{3381725461, 3871661707, 3088580608, 3582633182, 1120651418, 2056715002, 4228593929, 3580190304},
				A:   [7]uint32{3152191187, 2662309209, 3581439602, 3615393279, 3276762985, 534652831, 765679613},
				PC:  9451680,
				SR:  9476,
				USP: 6701442,
				SSP: 4466252,
				RAM: [][2]uint32{{9451674, 231}, {9451675, 106}, {9451676, 239}, {9451677, 78}, {9451678, 180}, {9451679, 4}},
				Cycles: 66,
			},
		},
		{
			name: "1074 LSL.w D4, D7 e96f",
			init: 			cpuState{
				D:   [8]uint32{281619545, 4190164689, 2478435563, 4232437698, 1965608258, 328834353, 1205205890, 3275468471},
				A:   [7]uint32{2907214044, 1532092238, 4155738586, 801817987, 3986061961, 324435452, 3983098210},
				PC:  6776864,
				SR:  283,
				USP: 14875944,
				SSP: 2581376,
				RAM: [][2]uint32{{6776860, 233}, {6776861, 111}, {6776862, 142}, {6776863, 100}, {6776864, 90}, {6776865, 33}},
			},
			want: 			cpuState{
				D:   [8]uint32{281619545, 4190164689, 2478435563, 4232437698, 1965608258, 328834353, 1205205890, 3275471580},
				A:   [7]uint32{2907214044, 1532092238, 4155738586, 801817987, 3986061961, 324435452, 3983098210},
				PC:  6776866,
				SR:  264,
				USP: 14875944,
				SSP: 2581376,
				RAM: [][2]uint32{{6776860, 233}, {6776861, 111}, {6776862, 142}, {6776863, 100}, {6776864, 90}, {6776865, 33}},
				Cycles: 10,
			},
		},
		{
			name: "1321 LSL.w 5, D5 eb4d",
			init: 			cpuState{
				D:   [8]uint32{4017717483, 1259864235, 914384965, 3160470706, 513833760, 3359309059, 973541445, 1339111580},
				A:   [7]uint32{1244063030, 2861346635, 3035342179, 3015037260, 444513991, 2306398888, 3231743177},
				PC:  10182396,
				SR:  1053,
				USP: 4790582,
				SSP: 3752934,
				RAM: [][2]uint32{{10182392, 235}, {10182393, 77}, {10182394, 181}, {10182395, 250}, {10182396, 17}, {10182397, 238}},
			},
			want: 			cpuState{
				D:   [8]uint32{4017717483, 1259864235, 914384965, 3160470706, 513833760, 3359285344, 973541445, 1339111580},
				A:   [7]uint32{1244063030, 2861346635, 3035342179, 3015037260, 444513991, 2306398888, 3231743177},
				PC:  10182398,
				SR:  1049,
				USP: 4790582,
				SSP: 3752934,
				RAM: [][2]uint32{{10182392, 235}, {10182393, 77}, {10182394, 181}, {10182395, 250}, {10182396, 17}, {10182397, 238}},
				Cycles: 16,
			},
		},
		{
			name: "1619 LSL.w D6, D4 ed6c",
			init: 			cpuState{
				D:   [8]uint32{2636192676, 4119083503, 1448455233, 666507299, 2569678849, 820442434, 1550851712, 3234374496},
				A:   [7]uint32{782776936, 1913959978, 1959773458, 4241533509, 1312549779, 1007180400, 1773993284},
				PC:  2047268,
				SR:  8217,
				USP: 7684288,
				SSP: 7623036,
				RAM: [][2]uint32{{2047264, 237}, {2047265, 108}, {2047266, 55}, {2047267, 67}, {2047268, 53}, {2047269, 46}},
			},
			want: 			cpuState{
				D:   [8]uint32{2636192676, 4119083503, 1448455233, 666507299, 2569678849, 820442434, 1550851712, 3234374496},
				A:   [7]uint32{782776936, 1913959978, 1959773458, 4241533509, 1312549779, 1007180400, 1773993284},
				PC:  2047270,
				SR:  8208,
				USP: 7684288,
				SSP: 7623036,
				RAM: [][2]uint32{{2047264, 237}, {2047265, 108}, {2047266, 55}, {2047267, 67}, {2047268, 53}, {2047269, 46}},
				Cycles: 6,
			},
		},
		{
			name: "1906 LSL.w D4, D6 e96e",
			init: 			cpuState{
				D:   [8]uint32{4076951404, 4122454954, 2411131618, 1924805913, 3117165424, 1319958493, 162890241, 962403582},
				A:   [7]uint32{2855997073, 3453098750, 1096863216, 2964906733, 3726685911, 2347632485, 2459723131},
				PC:  10825030,
				SR:  1564,
				USP: 2263402,
				SSP: 3154950,
				RAM: [][2]uint32{{10825026, 233}, {10825027, 110}, {10825028, 131}, {10825029, 155}, {10825030, 7}, {10825031, 187}},
			},
			want: 			cpuState{
				D:   [8]uint32{4076951404, 4122454954, 2411131618, 1924805913, 3117165424, 1319958493, 162856960, 962403582},
				A:   [7]uint32{2855997073, 3453098750, 1096863216, 2964906733, 3726685911, 2347632485, 2459723131},
				PC:  10825032,
				SR:  1540,
				USP: 2263402,
				SSP: 3154950,
				RAM: [][2]uint32{{10825026, 233}, {10825027, 110}, {10825028, 131}, {10825029, 155}, {10825030, 7}, {10825031, 187}},
				Cycles: 102,
			},
		},
		{
			name: "2208 LSL.w D7, D1 ef69",
			init: 			cpuState{
				D:   [8]uint32{1940423810, 3476606136, 303234270, 24721997, 124279591, 442991105, 327311669, 2082993431},
				A:   [7]uint32{3599186537, 1885653408, 1241573591, 3780229608, 4052705532, 2949343287, 531364405},
				PC:  2238442,
				SR:  9987,
				USP: 9853516,
				SSP: 151984,
				RAM: [][2]uint32{{2238438, 239}, {2238439, 105}, {2238440, 187}, {2238441, 115}, {2238442, 58}, {2238443, 231}},
			},
			want: 			cpuState{
				D:   [8]uint32{1940423810, 3476553728, 303234270, 24721997, 124279591, 442991105, 327311669, 2082993431},
				A:   [7]uint32{3599186537, 1885653408, 1241573591, 3780229608, 4052705532, 2949343287, 531364405},
				PC:  2238444,
				SR:  9988,
				USP: 9853516,
				SSP: 151984,
				RAM: [][2]uint32{{2238438, 239}, {2238439, 105}, {2238440, 187}, {2238441, 115}, {2238442, 58}, {2238443, 231}},
				Cycles: 52,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSL_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSL.l 8, D3 e18b",
			init: cpuState{
				D:   [8]uint32{2062035981, 1007843109, 2879661634, 75316724, 1441372217, 11302036, 3265089506, 1935558358},
				A:   [7]uint32{241915969, 3874271221, 1138071793, 3842450313, 345828183, 3944270070, 1291001525},
				PC:  16369382,
				SR:  34061,
				USP: 5880452,
				SSP: 6353640,
				RAM: [][2]uint32{{16369378, 225}, {16369379, 139}, {16369380, 125}, {16369381, 254}, {16369382, 117}, {16369383, 189}},
			},
			want: cpuState{
				D:   [8]uint32{2062035981, 1007843109, 2879661634, 2101212160, 1441372217, 11302036, 3265089506, 1935558358},
				A:   [7]uint32{241915969, 3874271221, 1138071793, 3842450313, 345828183, 3944270070, 1291001525},
				PC:  16369384,
				SR:  34048,
				USP: 5880452,
				SSP: 6353640,
				RAM: [][2]uint32{{16369378, 225}, {16369379, 139}, {16369380, 125}, {16369381, 254}, {16369382, 117}, {16369383, 189}},
				Cycles: 24,
			},
		},
		{
			name: "500 LSL.l D3, D3 e7ab",
			init: cpuState{
				D:   [8]uint32{183531361, 3226543135, 2693468984, 1821978543, 1932803332, 1383292087, 1907795154, 219479},
				A:   [7]uint32{756569799, 64034866, 931342248, 1585034533, 1046929544, 709898264, 3756825934},
				PC:  989060,
				SR:  268,
				USP: 2970532,
				SSP: 3359662,
				RAM: [][2]uint32{{989056, 231}, {989057, 171}, {989058, 176}, {989059, 247}, {989060, 54}, {989061, 200}},
			},
			want: cpuState{
				D:   [8]uint32{183531361, 3226543135, 2693468984, 0, 1932803332, 1383292087, 1907795154, 219479},
				A:   [7]uint32{756569799, 64034866, 931342248, 1585034533, 1046929544, 709898264, 3756825934},
				PC:  989062,
				SR:  260,
				USP: 2970532,
				SSP: 3359662,
				RAM: [][2]uint32{{989056, 231}, {989057, 171}, {989058, 176}, {989059, 247}, {989060, 54}, {989061, 200}},
				Cycles: 102,
			},
		},
		{
			name: "1000 LSL.l D3, D5 e7ad",
			init: cpuState{
				D:   [8]uint32{4294443838, 3913131719, 2141878934, 1040821364, 1501720541, 3714039895, 3472189310, 2781550733},
				A:   [7]uint32{1252790205, 2895946362, 2588152769, 128787016, 2960821180, 4074403020, 1376802307},
				PC:  3261002,
				SR:  279,
				USP: 13355324,
				SSP: 127548,
				RAM: [][2]uint32{{3260998, 231}, {3260999, 173}, {3261000, 89}, {3261001, 152}, {3261002, 17}, {3261003, 36}},
			},
			want: cpuState{
				D:   [8]uint32{4294443838, 3913131719, 2141878934, 1040821364, 1501720541, 0, 3472189310, 2781550733},
				A:   [7]uint32{1252790205, 2895946362, 2588152769, 128787016, 2960821180, 4074403020, 1376802307},
				PC:  3261004,
				SR:  260,
				USP: 13355324,
				SSP: 127548,
				RAM: [][2]uint32{{3260998, 231}, {3260999, 173}, {3261000, 89}, {3261001, 152}, {3261002, 17}, {3261003, 36}},
				Cycles: 112,
			},
		},
		{
			name: "1500 LSL.l 8, D4 e18c",
			init: cpuState{
				D:   [8]uint32{2625305891, 3192625566, 3907226004, 840457508, 2735956019, 4095158911, 3933359824, 3242301410},
				A:   [7]uint32{1269635845, 3702329561, 2871381873, 548374897, 2259333925, 1823887321, 3582750735},
				PC:  14514362,
				SR:  9747,
				USP: 5914472,
				SSP: 10827524,
				RAM: [][2]uint32{{14514358, 225}, {14514359, 140}, {14514360, 229}, {14514361, 35}, {14514362, 49}, {14514363, 92}},
			},
			want: cpuState{
				D:   [8]uint32{2625305891, 3192625566, 3907226004, 840457508, 325071616, 4095158911, 3933359824, 3242301410},
				A:   [7]uint32{1269635845, 3702329561, 2871381873, 548374897, 2259333925, 1823887321, 3582750735},
				PC:  14514364,
				SR:  9745,
				USP: 5914472,
				SSP: 10827524,
				RAM: [][2]uint32{{14514358, 225}, {14514359, 140}, {14514360, 229}, {14514361, 35}, {14514362, 49}, {14514363, 92}},
				Cycles: 24,
			},
		},
		{
			name: "2000 LSL.l 5, D0 eb88",
			init: cpuState{
				D:   [8]uint32{1471013739, 329203410, 1195468896, 1999214153, 3680394409, 1598410181, 4011358852, 1918365627},
				A:   [7]uint32{2760835465, 3250060056, 2972388712, 1189066888, 2027628413, 3804210184, 317121153},
				PC:  10045298,
				SR:  33295,
				USP: 16245132,
				SSP: 12804686,
				RAM: [][2]uint32{{10045294, 235}, {10045295, 136}, {10045296, 210}, {10045297, 117}, {10045298, 198}, {10045299, 131}},
			},
			want: cpuState{
				D:   [8]uint32{4122766688, 329203410, 1195468896, 1999214153, 3680394409, 1598410181, 4011358852, 1918365627},
				A:   [7]uint32{2760835465, 3250060056, 2972388712, 1189066888, 2027628413, 3804210184, 317121153},
				PC:  10045300,
				SR:  33288,
				USP: 16245132,
				SSP: 12804686,
				RAM: [][2]uint32{{10045294, 235}, {10045295, 136}, {10045296, 210}, {10045297, 117}, {10045298, 198}, {10045299, 131}},
				Cycles: 18,
			},
		},
		{
			name: "003 LSL.l D3, D5 e7ad",
			init: 			cpuState{
				D:   [8]uint32{20553720, 2566227254, 1963479908, 2147995539, 4041502800, 429766055, 3296600544, 2714657360},
				A:   [7]uint32{720404420, 2227475909, 3120136703, 2924024426, 1440341508, 2678588416, 791936117},
				PC:  13579156,
				SR:  1820,
				USP: 9913472,
				SSP: 962354,
				RAM: [][2]uint32{{13579152, 231}, {13579153, 173}, {13579154, 187}, {13579155, 30}, {13579156, 168}, {13579157, 113}},
			},
			want: 			cpuState{
				D:   [8]uint32{20553720, 2566227254, 1963479908, 2147995539, 4041502800, 2906128384, 3296600544, 2714657360},
				A:   [7]uint32{720404420, 2227475909, 3120136703, 2924024426, 1440341508, 2678588416, 791936117},
				PC:  13579158,
				SR:  1817,
				USP: 9913472,
				SSP: 962354,
				RAM: [][2]uint32{{13579152, 231}, {13579153, 173}, {13579154, 187}, {13579155, 30}, {13579156, 168}, {13579157, 113}},
				Cycles: 46,
			},
		},
		{
			name: "288 LSL.l 8, D5 e18d",
			init: 			cpuState{
				D:   [8]uint32{2002147670, 1341634541, 1461503486, 3467280227, 4067737747, 3014427732, 1779142321, 945525139},
				A:   [7]uint32{274598078, 3726687737, 3877694557, 919578142, 3367619570, 3848754885, 1997101076},
				PC:  11165436,
				SR:  261,
				USP: 179916,
				SSP: 1497048,
				RAM: [][2]uint32{{11165432, 225}, {11165433, 141}, {11165434, 101}, {11165435, 158}, {11165436, 234}, {11165437, 190}},
			},
			want: 			cpuState{
				D:   [8]uint32{2002147670, 1341634541, 1461503486, 3467280227, 4067737747, 2894353408, 1779142321, 945525139},
				A:   [7]uint32{274598078, 3726687737, 3877694557, 919578142, 3367619570, 3848754885, 1997101076},
				PC:  11165438,
				SR:  281,
				USP: 179916,
				SSP: 1497048,
				RAM: [][2]uint32{{11165432, 225}, {11165433, 141}, {11165434, 101}, {11165435, 158}, {11165436, 234}, {11165437, 190}},
				Cycles: 24,
			},
		},
		{
			name: "572 LSL.l 1, D3 e38b",
			init: 			cpuState{
				D:   [8]uint32{2438200479, 1165653166, 3727058231, 388238580, 2734213910, 3246435147, 3829332903, 3039544630},
				A:   [7]uint32{3642542446, 2367860357, 705864, 128360637, 3569805036, 3618444520, 257299859},
				PC:  12088124,
				SR:  517,
				USP: 6500944,
				SSP: 10186858,
				RAM: [][2]uint32{{12088120, 227}, {12088121, 139}, {12088122, 227}, {12088123, 138}, {12088124, 26}, {12088125, 31}},
			},
			want: 			cpuState{
				D:   [8]uint32{2438200479, 1165653166, 3727058231, 776477160, 2734213910, 3246435147, 3829332903, 3039544630},
				A:   [7]uint32{3642542446, 2367860357, 705864, 128360637, 3569805036, 3618444520, 257299859},
				PC:  12088126,
				SR:  512,
				USP: 6500944,
				SSP: 10186858,
				RAM: [][2]uint32{{12088120, 227}, {12088121, 139}, {12088122, 227}, {12088123, 138}, {12088124, 26}, {12088125, 31}},
				Cycles: 10,
			},
		},
		{
			name: "859 LSL.l D0, D4 e1ac",
			init: 			cpuState{
				D:   [8]uint32{951891680, 1533282787, 2392571695, 2150537761, 1175369341, 127432378, 3174541270, 2261181466},
				A:   [7]uint32{2372024971, 2593390062, 1817183843, 1792245695, 2413609005, 2965748609, 2244158183},
				PC:  7240468,
				SR:  1308,
				USP: 9046518,
				SSP: 5622064,
				RAM: [][2]uint32{{7240464, 225}, {7240465, 172}, {7240466, 5}, {7240467, 120}, {7240468, 188}, {7240469, 124}},
			},
			want: 			cpuState{
				D:   [8]uint32{951891680, 1533282787, 2392571695, 2150537761, 0, 127432378, 3174541270, 2261181466},
				A:   [7]uint32{2372024971, 2593390062, 1817183843, 1792245695, 2413609005, 2965748609, 2244158183},
				PC:  7240470,
				SR:  1301,
				USP: 9046518,
				SSP: 5622064,
				RAM: [][2]uint32{{7240464, 225}, {7240465, 172}, {7240466, 5}, {7240467, 120}, {7240468, 188}, {7240469, 124}},
				Cycles: 72,
			},
		},
		{
			name: "1135 LSL.l 8, D1 e189",
			init: 			cpuState{
				D:   [8]uint32{1046653796, 668581061, 3737418917, 1967956807, 433277877, 1961036167, 929197207, 129022595},
				A:   [7]uint32{3266950160, 3484832826, 343639181, 716797346, 1047232073, 492311259, 2758568017},
				PC:  13063660,
				SR:  9994,
				USP: 3894316,
				SSP: 5309402,
				RAM: [][2]uint32{{13063656, 225}, {13063657, 137}, {13063658, 190}, {13063659, 132}, {13063660, 57}, {13063661, 85}},
			},
			want: 			cpuState{
				D:   [8]uint32{1046653796, 3653027072, 3737418917, 1967956807, 433277877, 1961036167, 929197207, 129022595},
				A:   [7]uint32{3266950160, 3484832826, 343639181, 716797346, 1047232073, 492311259, 2758568017},
				PC:  13063662,
				SR:  10009,
				USP: 3894316,
				SSP: 5309402,
				RAM: [][2]uint32{{13063656, 225}, {13063657, 137}, {13063658, 190}, {13063659, 132}, {13063660, 57}, {13063661, 85}},
				Cycles: 24,
			},
		},
		{
			name: "1404 LSL.l 2, D4 e58c",
			init: 			cpuState{
				D:   [8]uint32{3334307070, 4066330263, 32119804, 1439180090, 1365902931, 4240058931, 1188876604, 2348748513},
				A:   [7]uint32{3501657204, 2990264293, 3165784922, 3584855469, 358510676, 1728873357, 3228640988},
				PC:  14638660,
				SR:  9737,
				USP: 3202224,
				SSP: 15040188,
				RAM: [][2]uint32{{14638656, 229}, {14638657, 140}, {14638658, 55}, {14638659, 62}, {14638660, 243}, {14638661, 247}},
			},
			want: 			cpuState{
				D:   [8]uint32{3334307070, 4066330263, 32119804, 1439180090, 1168644428, 4240058931, 1188876604, 2348748513},
				A:   [7]uint32{3501657204, 2990264293, 3165784922, 3584855469, 358510676, 1728873357, 3228640988},
				PC:  14638662,
				SR:  9745,
				USP: 3202224,
				SSP: 15040188,
				RAM: [][2]uint32{{14638656, 229}, {14638657, 140}, {14638658, 55}, {14638659, 62}, {14638660, 243}, {14638661, 247}},
				Cycles: 12,
			},
		},
		{
			name: "1683 LSL.l 7, D6 ef8e",
			init: 			cpuState{
				D:   [8]uint32{804420092, 3473780218, 2624894954, 3049301354, 1748831919, 3714208920, 972442216, 1616594758},
				A:   [7]uint32{1942017353, 1409400499, 3900746463, 173555694, 3879747322, 763248750, 1115235886},
				PC:  1211026,
				SR:  8479,
				USP: 2400194,
				SSP: 3732510,
				RAM: [][2]uint32{{1211022, 239}, {1211023, 142}, {1211024, 200}, {1211025, 147}, {1211026, 17}, {1211027, 132}},
			},
			want: 			cpuState{
				D:   [8]uint32{804420092, 3473780218, 2624894954, 3049301354, 1748831919, 3714208920, 4213519360, 1616594758},
				A:   [7]uint32{1942017353, 1409400499, 3900746463, 173555694, 3879747322, 763248750, 1115235886},
				PC:  1211028,
				SR:  8456,
				USP: 2400194,
				SSP: 3732510,
				RAM: [][2]uint32{{1211022, 239}, {1211023, 142}, {1211024, 200}, {1211025, 147}, {1211026, 17}, {1211027, 132}},
				Cycles: 22,
			},
		},
		{
			name: "1976 LSL.l D5, D7 ebaf",
			init: 			cpuState{
				D:   [8]uint32{3441360220, 2553636556, 331385451, 1391187801, 3051676290, 2533513470, 4116367122, 1765700555},
				A:   [7]uint32{3055341827, 799840353, 1485272988, 1533018823, 3789919780, 3680929868, 351123561},
				PC:  12125426,
				SR:  9,
				USP: 6465662,
				SSP: 15404688,
				RAM: [][2]uint32{{12125422, 235}, {12125423, 175}, {12125424, 78}, {12125425, 228}, {12125426, 61}, {12125427, 209}},
			},
			want: 			cpuState{
				D:   [8]uint32{3441360220, 2553636556, 331385451, 1391187801, 3051676290, 2533513470, 4116367122, 0},
				A:   [7]uint32{3055341827, 799840353, 1485272988, 1533018823, 3789919780, 3680929868, 351123561},
				PC:  12125428,
				SR:  4,
				USP: 6465662,
				SSP: 15404688,
				RAM: [][2]uint32{{12125422, 235}, {12125423, 175}, {12125424, 78}, {12125425, 228}, {12125426, 61}, {12125427, 209}},
				Cycles: 132,
			},
		},
		{
			name: "2238 LSL.l D2, D4 e5ac",
			init: 			cpuState{
				D:   [8]uint32{3558438397, 761197155, 3832155974, 666505730, 2064228448, 1070872880, 3837538280, 2894299987},
				A:   [7]uint32{2791828291, 105417636, 2431234573, 4221866067, 1081803800, 438237456, 4194887791},
				PC:  2291440,
				SR:  8477,
				USP: 10948890,
				SSP: 13380658,
				RAM: [][2]uint32{{2291436, 229}, {2291437, 172}, {2291438, 194}, {2291439, 182}, {2291440, 207}, {2291441, 150}},
			},
			want: 			cpuState{
				D:   [8]uint32{3558438397, 761197155, 3832155974, 666505730, 3261601792, 1070872880, 3837538280, 2894299987},
				A:   [7]uint32{2791828291, 105417636, 2431234573, 4221866067, 1081803800, 438237456, 4194887791},
				PC:  2291442,
				SR:  8456,
				USP: 10948890,
				SSP: 13380658,
				RAM: [][2]uint32{{2291436, 229}, {2291437, 172}, {2291438, 194}, {2291439, 182}, {2291440, 207}, {2291441, 150}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSR.b 8, D7 e00f",
			init: cpuState{
				D:   [8]uint32{1215550759, 3916236074, 1883522580, 2038950719, 3543397630, 307680705, 1867975362, 3365224368},
				A:   [7]uint32{2421187846, 2670051108, 2235160250, 3904210919, 1894245102, 3859098353, 3866968172},
				PC:  11736540,
				SR:  34060,
				USP: 8512312,
				SSP: 15678138,
				RAM: [][2]uint32{{11736536, 224}, {11736537, 15}, {11736538, 147}, {11736539, 241}, {11736540, 64}, {11736541, 130}},
			},
			want: cpuState{
				D:   [8]uint32{1215550759, 3916236074, 1883522580, 2038950719, 3543397630, 307680705, 1867975362, 3365224192},
				A:   [7]uint32{2421187846, 2670051108, 2235160250, 3904210919, 1894245102, 3859098353, 3866968172},
				PC:  11736542,
				SR:  34069,
				USP: 8512312,
				SSP: 15678138,
				RAM: [][2]uint32{{11736536, 224}, {11736537, 15}, {11736538, 147}, {11736539, 241}, {11736540, 64}, {11736541, 130}},
				Cycles: 22,
			},
		},
		{
			name: "500 LSR.b 3, D0 e608",
			init: cpuState{
				D:   [8]uint32{1781079828, 415377636, 438571227, 1555149959, 836396857, 2326716094, 2187815708, 524257889},
				A:   [7]uint32{3185213068, 4209788353, 574070102, 1080724607, 2154425325, 2775106800, 2409615205},
				PC:  6095266,
				SR:  797,
				USP: 7955924,
				SSP: 10012228,
				RAM: [][2]uint32{{6095262, 230}, {6095263, 8}, {6095264, 161}, {6095265, 246}, {6095266, 244}, {6095267, 191}},
			},
			want: cpuState{
				D:   [8]uint32{1781079810, 415377636, 438571227, 1555149959, 836396857, 2326716094, 2187815708, 524257889},
				A:   [7]uint32{3185213068, 4209788353, 574070102, 1080724607, 2154425325, 2775106800, 2409615205},
				PC:  6095268,
				SR:  785,
				USP: 7955924,
				SSP: 10012228,
				RAM: [][2]uint32{{6095262, 230}, {6095263, 8}, {6095264, 161}, {6095265, 246}, {6095266, 244}, {6095267, 191}},
				Cycles: 12,
			},
		},
		{
			name: "1000 LSR.b D4, D5 e82d",
			init: cpuState{
				D:   [8]uint32{1730205390, 1395303421, 148099880, 100490504, 3644448450, 1382560647, 2928053183, 371080323},
				A:   [7]uint32{992682164, 3911168444, 3868503994, 3041916823, 1440380477, 9266496, 264206656},
				PC:  217396,
				SR:  9740,
				USP: 3943358,
				SSP: 4260374,
				RAM: [][2]uint32{{217392, 232}, {217393, 45}, {217394, 135}, {217395, 72}, {217396, 15}, {217397, 36}},
			},
			want: cpuState{
				D:   [8]uint32{1730205390, 1395303421, 148099880, 100490504, 3644448450, 1382560545, 2928053183, 371080323},
				A:   [7]uint32{992682164, 3911168444, 3868503994, 3041916823, 1440380477, 9266496, 264206656},
				PC:  217398,
				SR:  9745,
				USP: 3943358,
				SSP: 4260374,
				RAM: [][2]uint32{{217392, 232}, {217393, 45}, {217394, 135}, {217395, 72}, {217396, 15}, {217397, 36}},
				Cycles: 10,
			},
		},
		{
			name: "1500 LSR.b D6, D4 ec2c",
			init: cpuState{
				D:   [8]uint32{1156755878, 268624685, 1916383032, 1590052220, 1394497727, 2185201717, 2238056528, 2518929137},
				A:   [7]uint32{3538915954, 3129259283, 2283706249, 2798089595, 3768127843, 375360350, 3104709669},
				PC:  12148438,
				SR:  41218,
				USP: 5928194,
				SSP: 9100758,
				RAM: [][2]uint32{{12148434, 236}, {12148435, 44}, {12148436, 3}, {12148437, 154}, {12148438, 89}, {12148439, 134}},
			},
			want: cpuState{
				D:   [8]uint32{1156755878, 268624685, 1916383032, 1590052220, 1394497536, 2185201717, 2238056528, 2518929137},
				A:   [7]uint32{3538915954, 3129259283, 2283706249, 2798089595, 3768127843, 375360350, 3104709669},
				PC:  12148440,
				SR:  41220,
				USP: 5928194,
				SSP: 9100758,
				RAM: [][2]uint32{{12148434, 236}, {12148435, 44}, {12148436, 3}, {12148437, 154}, {12148438, 89}, {12148439, 134}},
				Cycles: 38,
			},
		},
		{
			name: "2000 LSR.b D2, D5 e42d",
			init: cpuState{
				D:   [8]uint32{4002403626, 3139135878, 3113196079, 1827995190, 3032738361, 865033943, 3933335178, 2042750218},
				A:   [7]uint32{518065969, 3919425501, 7236685, 2339952591, 1554375988, 572644951, 621430416},
				PC:  4901646,
				SR:  42524,
				USP: 6389194,
				SSP: 9765292,
				RAM: [][2]uint32{{4901642, 228}, {4901643, 45}, {4901644, 177}, {4901645, 153}, {4901646, 112}, {4901647, 230}},
			},
			want: cpuState{
				D:   [8]uint32{4002403626, 3139135878, 3113196079, 1827995190, 3032738361, 865033728, 3933335178, 2042750218},
				A:   [7]uint32{518065969, 3919425501, 7236685, 2339952591, 1554375988, 572644951, 621430416},
				PC:  4901648,
				SR:  42500,
				USP: 6389194,
				SSP: 9765292,
				RAM: [][2]uint32{{4901642, 228}, {4901643, 45}, {4901644, 177}, {4901645, 153}, {4901646, 112}, {4901647, 230}},
				Cycles: 100,
			},
		},
		{
			name: "001 LSR.b D2, D3 e42b",
			init: 			cpuState{
				D:   [8]uint32{3140005155, 2702677830, 2798444807, 3739515223, 469034349, 3869793669, 956031654, 3588036110},
				A:   [7]uint32{2077759022, 1261157774, 371157751, 1654148456, 2206970458, 3173379874, 1384336885},
				PC:  16610776,
				SR:  1545,
				USP: 4227590,
				SSP: 11558984,
				RAM: [][2]uint32{{16610772, 228}, {16610773, 43}, {16610774, 2}, {16610775, 46}, {16610776, 214}, {16610777, 92}},
			},
			want: 			cpuState{
				D:   [8]uint32{3140005155, 2702677830, 2798444807, 3739515136, 469034349, 3869793669, 956031654, 3588036110},
				A:   [7]uint32{2077759022, 1261157774, 371157751, 1654148456, 2206970458, 3173379874, 1384336885},
				PC:  16610778,
				SR:  1557,
				USP: 4227590,
				SSP: 11558984,
				RAM: [][2]uint32{{16610772, 228}, {16610773, 43}, {16610774, 2}, {16610775, 46}, {16610776, 214}, {16610777, 92}},
				Cycles: 20,
			},
		},
		{
			name: "283 LSR.b D4, D1 e829",
			init: 			cpuState{
				D:   [8]uint32{3010505534, 1419178684, 3437752498, 723417030, 4221981359, 2119413944, 700393100, 1790881156},
				A:   [7]uint32{247172805, 2508899072, 404829708, 3787498083, 2191516731, 2044601573, 1981298276},
				PC:  12267242,
				SR:  16,
				USP: 11927436,
				SSP: 14028952,
				RAM: [][2]uint32{{12267238, 232}, {12267239, 41}, {12267240, 141}, {12267241, 122}, {12267242, 51}, {12267243, 246}},
			},
			want: 			cpuState{
				D:   [8]uint32{3010505534, 1419178496, 3437752498, 723417030, 4221981359, 2119413944, 700393100, 1790881156},
				A:   [7]uint32{247172805, 2508899072, 404829708, 3787498083, 2191516731, 2044601573, 1981298276},
				PC:  12267244,
				SR:  4,
				USP: 11927436,
				SSP: 14028952,
				RAM: [][2]uint32{{12267238, 232}, {12267239, 41}, {12267240, 141}, {12267241, 122}, {12267242, 51}, {12267243, 246}},
				Cycles: 100,
			},
		},
		{
			name: "539 LSR.b D5, D1 ea29",
			init: 			cpuState{
				D:   [8]uint32{4160250986, 1104690895, 2786954175, 4099408451, 4120122576, 448267028, 1490173712, 11797822},
				A:   [7]uint32{2250326324, 3131994054, 3137053734, 1102921247, 766889289, 2414558419, 1451287646},
				PC:  16427900,
				SR:  8476,
				USP: 16615900,
				SSP: 12880804,
				RAM: [][2]uint32{{16427896, 234}, {16427897, 41}, {16427898, 47}, {16427899, 138}, {16427900, 7}, {16427901, 225}},
			},
			want: 			cpuState{
				D:   [8]uint32{4160250986, 1104690688, 2786954175, 4099408451, 4120122576, 448267028, 1490173712, 11797822},
				A:   [7]uint32{2250326324, 3131994054, 3137053734, 1102921247, 766889289, 2414558419, 1451287646},
				PC:  16427902,
				SR:  8452,
				USP: 16615900,
				SSP: 12880804,
				RAM: [][2]uint32{{16427896, 234}, {16427897, 41}, {16427898, 47}, {16427899, 138}, {16427900, 7}, {16427901, 225}},
				Cycles: 46,
			},
		},
		{
			name: "826 LSR.b D1, D4 e22c",
			init: 			cpuState{
				D:   [8]uint32{3652732492, 2857545133, 650766117, 2487788992, 789723637, 3287488757, 123702012, 895339334},
				A:   [7]uint32{821170539, 1472532196, 178989525, 3424065318, 2243001427, 7445890, 1368147927},
				PC:  1933366,
				SR:  8733,
				USP: 1401422,
				SSP: 6056634,
				RAM: [][2]uint32{{1933362, 226}, {1933363, 44}, {1933364, 143}, {1933365, 218}, {1933366, 132}, {1933367, 219}},
			},
			want: 			cpuState{
				D:   [8]uint32{3652732492, 2857545133, 650766117, 2487788992, 789723392, 3287488757, 123702012, 895339334},
				A:   [7]uint32{821170539, 1472532196, 178989525, 3424065318, 2243001427, 7445890, 1368147927},
				PC:  1933368,
				SR:  8708,
				USP: 1401422,
				SSP: 6056634,
				RAM: [][2]uint32{{1933362, 226}, {1933363, 44}, {1933364, 143}, {1933365, 218}, {1933366, 132}, {1933367, 219}},
				Cycles: 96,
			},
		},
		{
			name: "1117 LSR.b 3, D4 e60c",
			init: 			cpuState{
				D:   [8]uint32{1760570104, 2271539281, 524749447, 3550414027, 899124826, 2127714992, 1325105258, 2790398372},
				A:   [7]uint32{3728829630, 4252867550, 863955769, 4001844534, 3076012218, 3088319509, 2557981447},
				PC:  5534684,
				SR:  8705,
				USP: 13598214,
				SSP: 656650,
				RAM: [][2]uint32{{5534680, 230}, {5534681, 12}, {5534682, 236}, {5534683, 17}, {5534684, 8}, {5534685, 0}},
			},
			want: 			cpuState{
				D:   [8]uint32{1760570104, 2271539281, 524749447, 3550414027, 899124747, 2127714992, 1325105258, 2790398372},
				A:   [7]uint32{3728829630, 4252867550, 863955769, 4001844534, 3076012218, 3088319509, 2557981447},
				PC:  5534686,
				SR:  8704,
				USP: 13598214,
				SSP: 656650,
				RAM: [][2]uint32{{5534680, 230}, {5534681, 12}, {5534682, 236}, {5534683, 17}, {5534684, 8}, {5534685, 0}},
				Cycles: 12,
			},
		},
		{
			name: "1408 LSR.b 5, D6 ea0e",
			init: 			cpuState{
				D:   [8]uint32{2116742148, 2979964331, 879850779, 386952806, 177193951, 2823848779, 1086787526, 3588170775},
				A:   [7]uint32{1772235969, 277521171, 2901717681, 537513630, 1321723179, 1303782564, 4068009233},
				PC:  9031958,
				SR:  9244,
				USP: 4917132,
				SSP: 11131160,
				RAM: [][2]uint32{{9031954, 234}, {9031955, 14}, {9031956, 225}, {9031957, 48}, {9031958, 114}, {9031959, 83}},
			},
			want: 			cpuState{
				D:   [8]uint32{2116742148, 2979964331, 879850779, 386952806, 177193951, 2823848779, 1086787334, 3588170775},
				A:   [7]uint32{1772235969, 277521171, 2901717681, 537513630, 1321723179, 1303782564, 4068009233},
				PC:  9031960,
				SR:  9216,
				USP: 4917132,
				SSP: 11131160,
				RAM: [][2]uint32{{9031954, 234}, {9031955, 14}, {9031956, 225}, {9031957, 48}, {9031958, 114}, {9031959, 83}},
				Cycles: 16,
			},
		},
		{
			name: "1700 LSR.b D2, D6 e42e",
			init: 			cpuState{
				D:   [8]uint32{145962495, 1864111231, 1567326874, 277163628, 965786486, 3974444708, 4130834646, 418312103},
				A:   [7]uint32{842190027, 2619276737, 3370933247, 3272680157, 1353597722, 3302046322, 3099819902},
				PC:  6515720,
				SR:  9730,
				USP: 9872924,
				SSP: 12989292,
				RAM: [][2]uint32{{6515716, 228}, {6515717, 46}, {6515718, 3}, {6515719, 165}, {6515720, 201}, {6515721, 181}},
			},
			want: 			cpuState{
				D:   [8]uint32{145962495, 1864111231, 1567326874, 277163628, 965786486, 3974444708, 4130834432, 418312103},
				A:   [7]uint32{842190027, 2619276737, 3370933247, 3272680157, 1353597722, 3302046322, 3099819902},
				PC:  6515722,
				SR:  9732,
				USP: 9872924,
				SSP: 12989292,
				RAM: [][2]uint32{{6515716, 228}, {6515717, 46}, {6515718, 3}, {6515719, 165}, {6515720, 201}, {6515721, 181}},
				Cycles: 58,
			},
		},
		{
			name: "1960 LSR.b 5, D1 ea09",
			init: 			cpuState{
				D:   [8]uint32{735464695, 3375359001, 3110269094, 4289446524, 2424875962, 3326790712, 3360924082, 43952342},
				A:   [7]uint32{2226327471, 2360861976, 753339158, 1333340945, 3648953014, 1720482586, 1393124152},
				PC:  3202634,
				SR:  1538,
				USP: 7669074,
				SSP: 9406526,
				RAM: [][2]uint32{{3202630, 234}, {3202631, 9}, {3202632, 95}, {3202633, 85}, {3202634, 102}, {3202635, 127}},
			},
			want: 			cpuState{
				D:   [8]uint32{735464695, 3375358976, 3110269094, 4289446524, 2424875962, 3326790712, 3360924082, 43952342},
				A:   [7]uint32{2226327471, 2360861976, 753339158, 1333340945, 3648953014, 1720482586, 1393124152},
				PC:  3202636,
				SR:  1557,
				USP: 7669074,
				SSP: 9406526,
				RAM: [][2]uint32{{3202630, 234}, {3202631, 9}, {3202632, 95}, {3202633, 85}, {3202634, 102}, {3202635, 127}},
				Cycles: 16,
			},
		},
		{
			name: "2238 LSR.b 4, D3 e80b",
			init: 			cpuState{
				D:   [8]uint32{1453480480, 285525477, 18641439, 291672658, 3072251466, 264184129, 1266911265, 2117382017},
				A:   [7]uint32{3999902585, 3627667245, 3679276535, 4292950403, 3826690952, 2459327578, 1164533851},
				PC:  10452428,
				SR:  1040,
				USP: 375454,
				SSP: 15819438,
				RAM: [][2]uint32{{10452424, 232}, {10452425, 11}, {10452426, 193}, {10452427, 27}, {10452428, 222}, {10452429, 46}},
			},
			want: 			cpuState{
				D:   [8]uint32{1453480480, 285525477, 18641439, 291672581, 3072251466, 264184129, 1266911265, 2117382017},
				A:   [7]uint32{3999902585, 3627667245, 3679276535, 4292950403, 3826690952, 2459327578, 1164533851},
				PC:  10452430,
				SR:  1024,
				USP: 375454,
				SSP: 15819438,
				RAM: [][2]uint32{{10452424, 232}, {10452425, 11}, {10452426, 193}, {10452427, 27}, {10452428, 222}, {10452429, 46}},
				Cycles: 14,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSR.w D4, D2 e86a",
			init: cpuState{
				D:   [8]uint32{3613981479, 1950888893, 1502505187, 320882185, 2422289313, 3915343000, 2255352576, 3620703378},
				A:   [7]uint32{2446806331, 836741192, 92728229, 3595702912, 2953516710, 815619293, 926650486},
				PC:  7862364,
				SR:  42264,
				USP: 11189918,
				SSP: 7477314,
				RAM: [][2]uint32{{7862360, 232}, {7862361, 106}, {7862362, 236}, {7862363, 245}, {7862364, 197}, {7862365, 174}},
			},
			want: cpuState{
				D:   [8]uint32{3613981479, 1950888893, 1502478336, 320882185, 2422289313, 3915343000, 2255352576, 3620703378},
				A:   [7]uint32{2446806331, 836741192, 92728229, 3595702912, 2953516710, 815619293, 926650486},
				PC:  7862366,
				SR:  42244,
				USP: 11189918,
				SSP: 7477314,
				RAM: [][2]uint32{{7862360, 232}, {7862361, 106}, {7862362, 236}, {7862363, 245}, {7862364, 197}, {7862365, 174}},
				Cycles: 72,
			},
		},
		{
			name: "500 LSR.w 2, D4 e44c",
			init: cpuState{
				D:   [8]uint32{3626228409, 800183646, 2420740966, 4065063533, 1984076026, 1826192797, 2374624536, 3134751358},
				A:   [7]uint32{2564901367, 1698864187, 650088275, 14992976, 3278824679, 2219246730, 605274396},
				PC:  314820,
				SR:  8709,
				USP: 15514916,
				SSP: 13449538,
				RAM: [][2]uint32{{314816, 228}, {314817, 76}, {314818, 253}, {314819, 107}, {314820, 185}, {314821, 31}},
			},
			want: cpuState{
				D:   [8]uint32{3626228409, 800183646, 2420740966, 4065063533, 1984046654, 1826192797, 2374624536, 3134751358},
				A:   [7]uint32{2564901367, 1698864187, 650088275, 14992976, 3278824679, 2219246730, 605274396},
				PC:  314822,
				SR:  8721,
				USP: 15514916,
				SSP: 13449538,
				RAM: [][2]uint32{{314816, 228}, {314817, 76}, {314818, 253}, {314819, 107}, {314820, 185}, {314821, 31}},
				Cycles: 10,
			},
		},
		{
			name: "1000 LSR.w 4, D0 e848",
			init: cpuState{
				D:   [8]uint32{3108799998, 3287431003, 2035185714, 900574117, 1896489130, 3038461123, 3282389377, 3180718924},
				A:   [7]uint32{1753632315, 3755858383, 1093143316, 2228075297, 2050368856, 738481557, 3357784066},
				PC:  309684,
				SR:  11,
				USP: 3178194,
				SSP: 6026170,
				RAM: [][2]uint32{{309680, 232}, {309681, 72}, {309682, 110}, {309683, 176}, {309684, 79}, {309685, 196}},
			},
			want: cpuState{
				D:   [8]uint32{3108767839, 3287431003, 2035185714, 900574117, 1896489130, 3038461123, 3282389377, 3180718924},
				A:   [7]uint32{1753632315, 3755858383, 1093143316, 2228075297, 2050368856, 738481557, 3357784066},
				PC:  309686,
				SR:  17,
				USP: 3178194,
				SSP: 6026170,
				RAM: [][2]uint32{{309680, 232}, {309681, 72}, {309682, 110}, {309683, 176}, {309684, 79}, {309685, 196}},
				Cycles: 14,
			},
		},
		{
			name: "1500 LSR.w D5, D7 ea6f",
			init: cpuState{
				D:   [8]uint32{3069735091, 3839702420, 1945437488, 536154389, 3716272982, 1649072570, 2644467355, 4226800462},
				A:   [7]uint32{352936751, 2906661667, 3954910920, 2153707351, 444983731, 401651211, 180015307},
				PC:  2550518,
				SR:  9751,
				USP: 16520150,
				SSP: 6088246,
				RAM: [][2]uint32{{2550514, 234}, {2550515, 111}, {2550516, 67}, {2550517, 27}, {2550518, 103}, {2550519, 192}},
			},
			want: cpuState{
				D:   [8]uint32{3069735091, 3839702420, 1945437488, 536154389, 3716272982, 1649072570, 2644467355, 4226744320},
				A:   [7]uint32{352936751, 2906661667, 3954910920, 2153707351, 444983731, 401651211, 180015307},
				PC:  2550520,
				SR:  9732,
				USP: 16520150,
				SSP: 6088246,
				RAM: [][2]uint32{{2550514, 234}, {2550515, 111}, {2550516, 67}, {2550517, 27}, {2550518, 103}, {2550519, 192}},
				Cycles: 122,
			},
		},
		{
			name: "2000 LSR.w D6, D7 ec6f",
			init: cpuState{
				D:   [8]uint32{2884176492, 597377447, 1532598747, 568317382, 2108077745, 1291344248, 870817564, 1678464314},
				A:   [7]uint32{2658105120, 4161433829, 2804699912, 2475913253, 1675486850, 986510767, 843131793},
				PC:  4630376,
				SR:  1050,
				USP: 11226530,
				SSP: 15117396,
				RAM: [][2]uint32{{4630372, 236}, {4630373, 111}, {4630374, 168}, {4630375, 116}, {4630376, 31}, {4630377, 121}},
			},
			want: cpuState{
				D:   [8]uint32{2884176492, 597377447, 1532598747, 568317382, 2108077745, 1291344248, 870817564, 1678442496},
				A:   [7]uint32{2658105120, 4161433829, 2804699912, 2475913253, 1675486850, 986510767, 843131793},
				PC:  4630378,
				SR:  1028,
				USP: 11226530,
				SSP: 15117396,
				RAM: [][2]uint32{{4630372, 236}, {4630373, 111}, {4630374, 168}, {4630375, 116}, {4630376, 31}, {4630377, 121}},
				Cycles: 62,
			},
		},
		{
			name: "001 LSR.w 1, D6 e24e",
			init: 			cpuState{
				D:   [8]uint32{3271205083, 2638954767, 1707709208, 1339610584, 1932660923, 1972294183, 675314138, 92962455},
				A:   [7]uint32{1928408435, 4250577240, 2957528106, 601147322, 2620358404, 2021913579, 1557259892},
				PC:  5144530,
				SR:  1054,
				USP: 12024600,
				SSP: 1782020,
				RAM: [][2]uint32{{5144526, 226}, {5144527, 78}, {5144528, 92}, {5144529, 199}, {5144530, 193}, {5144531, 193}},
			},
			want: 			cpuState{
				D:   [8]uint32{3271205083, 2638954767, 1707709208, 1339610584, 1932660923, 1972294183, 675298541, 92962455},
				A:   [7]uint32{1928408435, 4250577240, 2957528106, 601147322, 2620358404, 2021913579, 1557259892},
				PC:  5144532,
				SR:  1024,
				USP: 12024600,
				SSP: 1782020,
				RAM: [][2]uint32{{5144526, 226}, {5144527, 78}, {5144528, 92}, {5144529, 199}, {5144530, 193}, {5144531, 193}},
				Cycles: 8,
			},
		},
		{
			name: "300 LSR.w D7, D0 ee68",
			init: 			cpuState{
				D:   [8]uint32{1111432723, 613430857, 3966446684, 2385505682, 1079192666, 3468541850, 1262989767, 3251935324},
				A:   [7]uint32{3585804621, 3182610751, 1838803239, 4269986615, 92866406, 667730463, 3028378412},
				PC:  11258128,
				SR:  1283,
				USP: 4525608,
				SSP: 5301154,
				RAM: [][2]uint32{{11258124, 238}, {11258125, 104}, {11258126, 120}, {11258127, 241}, {11258128, 36}, {11258129, 151}},
			},
			want: 			cpuState{
				D:   [8]uint32{1111425024, 613430857, 3966446684, 2385505682, 1079192666, 3468541850, 1262989767, 3251935324},
				A:   [7]uint32{3585804621, 3182610751, 1838803239, 4269986615, 92866406, 667730463, 3028378412},
				PC:  11258130,
				SR:  1284,
				USP: 4525608,
				SSP: 5301154,
				RAM: [][2]uint32{{11258124, 238}, {11258125, 104}, {11258126, 120}, {11258127, 241}, {11258128, 36}, {11258129, 151}},
				Cycles: 62,
			},
		},
		{
			name: "544 LSR.w D5, D2 ea6a",
			init: 			cpuState{
				D:   [8]uint32{2110996806, 3884192291, 2841150810, 2222620501, 2820505410, 1901395602, 2057116858, 1239770922},
				A:   [7]uint32{895912689, 1195277024, 3919672211, 1981217787, 1819121072, 2501736221, 3611562397},
				PC:  12237404,
				SR:  8708,
				USP: 14223328,
				SSP: 11336308,
				RAM: [][2]uint32{{12237400, 234}, {12237401, 106}, {12237402, 21}, {12237403, 185}, {12237404, 170}, {12237405, 224}},
			},
			want: 			cpuState{
				D:   [8]uint32{2110996806, 3884192291, 2841116672, 2222620501, 2820505410, 1901395602, 2057116858, 1239770922},
				A:   [7]uint32{895912689, 1195277024, 3919672211, 1981217787, 1819121072, 2501736221, 3611562397},
				PC:  12237406,
				SR:  8708,
				USP: 14223328,
				SSP: 11336308,
				RAM: [][2]uint32{{12237400, 234}, {12237401, 106}, {12237402, 21}, {12237403, 185}, {12237404, 170}, {12237405, 224}},
				Cycles: 42,
			},
		},
		{
			name: "830 LSR.w (d16, A6) e2ee",
			init: 			cpuState{
				D:   [8]uint32{3859615773, 2844308079, 277857905, 1648795777, 2605837527, 2925513936, 1347004208, 388346011},
				A:   [7]uint32{1589624852, 3499340989, 3394406560, 166477698, 3416068654, 1483756093, 238811327},
				PC:  13801884,
				SR:  9496,
				USP: 12290472,
				SSP: 12378450,
				RAM: [][2]uint32{{13801880, 226}, {13801881, 238}, {13801882, 99}, {13801883, 149}, {13801884, 120}, {13801885, 63}, {3955796, 71}, {3955797, 144}, {13801886, 27}, {13801887, 47}},
			},
			want: 			cpuState{
				D:   [8]uint32{3859615773, 2844308079, 277857905, 1648795777, 2605837527, 2925513936, 1347004208, 388346011},
				A:   [7]uint32{1589624852, 3499340989, 3394406560, 166477698, 3416068654, 1483756093, 238811327},
				PC:  13801888,
				SR:  9472,
				USP: 12290472,
				SSP: 12378450,
				RAM: [][2]uint32{{13801880, 226}, {13801881, 238}, {13801882, 99}, {13801883, 149}, {13801884, 120}, {13801885, 63}, {3955796, 35}, {3955797, 200}, {13801886, 27}, {13801887, 47}},
				Cycles: 16,
			},
		},
		{
			name: "1091 LSR.w D4, D0 e868",
			init: 			cpuState{
				D:   [8]uint32{2446415897, 1794504711, 3638236055, 725059927, 306737704, 2285343891, 3437860993, 3133799121},
				A:   [7]uint32{388968120, 4008533887, 3962539486, 3098929461, 3527524812, 2441975832, 2232584068},
				PC:  6092470,
				SR:  9475,
				USP: 11567942,
				SSP: 13056648,
				RAM: [][2]uint32{{6092466, 232}, {6092467, 104}, {6092468, 133}, {6092469, 36}, {6092470, 42}, {6092471, 240}},
			},
			want: 			cpuState{
				D:   [8]uint32{2446393344, 1794504711, 3638236055, 725059927, 306737704, 2285343891, 3437860993, 3133799121},
				A:   [7]uint32{388968120, 4008533887, 3962539486, 3098929461, 3527524812, 2441975832, 2232584068},
				PC:  6092472,
				SR:  9476,
				USP: 11567942,
				SSP: 13056648,
				RAM: [][2]uint32{{6092466, 232}, {6092467, 104}, {6092468, 133}, {6092469, 36}, {6092470, 42}, {6092471, 240}},
				Cycles: 86,
			},
		},
		{
			name: "1348 LSR.w (A2) e2d2",
			init: 			cpuState{
				D:   [8]uint32{857794768, 4063963182, 3863866845, 3653309086, 3977135105, 598232163, 2856145119, 398588719},
				A:   [7]uint32{3817681019, 3836018334, 4255493024, 774369672, 1834996421, 4281624897, 4099419113},
				PC:  190994,
				SR:  9216,
				USP: 7118588,
				SSP: 8732550,
				RAM: [][2]uint32{{190990, 226}, {190991, 210}, {190992, 38}, {190993, 121}, {10857376, 175}, {10857377, 34}, {190994, 56}, {190995, 240}},
			},
			want: 			cpuState{
				D:   [8]uint32{857794768, 4063963182, 3863866845, 3653309086, 3977135105, 598232163, 2856145119, 398588719},
				A:   [7]uint32{3817681019, 3836018334, 4255493024, 774369672, 1834996421, 4281624897, 4099419113},
				PC:  190996,
				SR:  9216,
				USP: 7118588,
				SSP: 8732550,
				RAM: [][2]uint32{{190990, 226}, {190991, 210}, {190992, 38}, {190993, 121}, {10857376, 87}, {10857377, 145}, {190994, 56}, {190995, 240}},
				Cycles: 12,
			},
		},
		{
			name: "1640 LSR.w (xxx).l e2f9",
			init: 			cpuState{
				D:   [8]uint32{3132260951, 586154188, 3740772832, 1774158106, 3082385520, 3715785098, 2430815455, 3157698674},
				A:   [7]uint32{4013488752, 392195217, 3557505127, 2806644281, 3474285414, 3450908001, 1398518568},
				PC:  3454424,
				SR:  1800,
				USP: 7268672,
				SSP: 1985420,
				RAM: [][2]uint32{{3454420, 226}, {3454421, 249}, {3454422, 102}, {3454423, 74}, {3454424, 25}, {3454425, 168}, {3454426, 59}, {3454427, 103}, {4856232, 46}, {4856233, 35}, {3454428, 63}, {3454429, 211}},
			},
			want: 			cpuState{
				D:   [8]uint32{3132260951, 586154188, 3740772832, 1774158106, 3082385520, 3715785098, 2430815455, 3157698674},
				A:   [7]uint32{4013488752, 392195217, 3557505127, 2806644281, 3474285414, 3450908001, 1398518568},
				PC:  3454430,
				SR:  1809,
				USP: 7268672,
				SSP: 1985420,
				RAM: [][2]uint32{{3454420, 226}, {3454421, 249}, {3454422, 102}, {3454423, 74}, {3454424, 25}, {3454425, 168}, {3454426, 59}, {3454427, 103}, {4856232, 23}, {4856233, 17}, {3454428, 63}, {3454429, 211}},
				Cycles: 20,
			},
		},
		{
			name: "1933 LSR.w D7, D4 ee6c",
			init: 			cpuState{
				D:   [8]uint32{2702172291, 3099972702, 3622567493, 856058016, 3606298086, 3188619644, 1082056295, 4054258868},
				A:   [7]uint32{61992164, 1675299169, 3609206381, 2921928792, 1166095545, 783312563, 3151706123},
				PC:  1840628,
				SR:  275,
				USP: 4139562,
				SSP: 10726516,
				RAM: [][2]uint32{{1840624, 238}, {1840625, 108}, {1840626, 178}, {1840627, 142}, {1840628, 87}, {1840629, 96}},
			},
			want: 			cpuState{
				D:   [8]uint32{2702172291, 3099972702, 3622567493, 856058016, 3606249472, 3188619644, 1082056295, 4054258868},
				A:   [7]uint32{61992164, 1675299169, 3609206381, 2921928792, 1166095545, 783312563, 3151706123},
				PC:  1840630,
				SR:  260,
				USP: 4139562,
				SSP: 10726516,
				RAM: [][2]uint32{{1840624, 238}, {1840625, 108}, {1840626, 178}, {1840627, 142}, {1840628, 87}, {1840629, 96}},
				Cycles: 110,
			},
		},
		{
			name: "2221 LSR.w 7, D5 ee4d",
			init: 			cpuState{
				D:   [8]uint32{2560359832, 505860907, 4115445789, 3316071169, 3304600250, 3401913710, 805485478, 3661204138},
				A:   [7]uint32{3938700187, 930720433, 3062242571, 947251806, 3999070775, 1311390078, 333277563},
				PC:  4472778,
				SR:  8977,
				USP: 4084132,
				SSP: 8641424,
				RAM: [][2]uint32{{4472774, 238}, {4472775, 77}, {4472776, 169}, {4472777, 178}, {4472778, 33}, {4472779, 223}},
			},
			want: 			cpuState{
				D:   [8]uint32{2560359832, 505860907, 4115445789, 3316071169, 3304600250, 3401908266, 805485478, 3661204138},
				A:   [7]uint32{3938700187, 930720433, 3062242571, 947251806, 3999070775, 1311390078, 333277563},
				PC:  4472780,
				SR:  8977,
				USP: 4084132,
				SSP: 8641424,
				RAM: [][2]uint32{{4472774, 238}, {4472775, 77}, {4472776, 169}, {4472777, 178}, {4472778, 33}, {4472779, 223}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSR.l D1, D2 e2aa",
			init: cpuState{
				D:   [8]uint32{1451886717, 2451518905, 2667325714, 1214704149, 82497301, 2794953732, 2302808131, 1821088266},
				A:   [7]uint32{1561357439, 4221139185, 3522782695, 2377701524, 3678414482, 518277178, 2313370385},
				PC:  16466092,
				SR:  8982,
				USP: 6516510,
				SSP: 15752052,
				RAM: [][2]uint32{{16466088, 226}, {16466089, 170}, {16466090, 168}, {16466091, 100}, {16466092, 67}, {16466093, 8}},
			},
			want: cpuState{
				D:   [8]uint32{1451886717, 2451518905, 0, 1214704149, 82497301, 2794953732, 2302808131, 1821088266},
				A:   [7]uint32{1561357439, 4221139185, 3522782695, 2377701524, 3678414482, 518277178, 2313370385},
				PC:  16466094,
				SR:  8964,
				USP: 6516510,
				SSP: 15752052,
				RAM: [][2]uint32{{16466088, 226}, {16466089, 170}, {16466090, 168}, {16466091, 100}, {16466092, 67}, {16466093, 8}},
				Cycles: 122,
			},
		},
		{
			name: "500 LSR.l D5, D5 eaad",
			init: cpuState{
				D:   [8]uint32{4156057625, 967758683, 4071710206, 1255422581, 674810595, 3617005885, 3632295405, 2566082588},
				A:   [7]uint32{3196840965, 3336682156, 959928, 1656638477, 1770987066, 1097140707, 513086003},
				PC:  16024618,
				SR:  1303,
				USP: 856748,
				SSP: 3084248,
				RAM: [][2]uint32{{16024614, 234}, {16024615, 173}, {16024616, 102}, {16024617, 32}, {16024618, 37}, {16024619, 68}},
			},
			want: cpuState{
				D:   [8]uint32{4156057625, 967758683, 4071710206, 1255422581, 674810595, 0, 3632295405, 2566082588},
				A:   [7]uint32{3196840965, 3336682156, 959928, 1656638477, 1770987066, 1097140707, 513086003},
				PC:  16024620,
				SR:  1284,
				USP: 856748,
				SSP: 3084248,
				RAM: [][2]uint32{{16024614, 234}, {16024615, 173}, {16024616, 102}, {16024617, 32}, {16024618, 37}, {16024619, 68}},
				Cycles: 130,
			},
		},
		{
			name: "1000 LSR.l 4, D1 e889",
			init: cpuState{
				D:   [8]uint32{1104847861, 4046433863, 4277522165, 1091658418, 2146756260, 3655775547, 2109882973, 2420647124},
				A:   [7]uint32{1906636481, 303480731, 1358445353, 544785334, 277247800, 31764468, 2787922151},
				PC:  11389720,
				SR:  41495,
				USP: 8677664,
				SSP: 7308872,
				RAM: [][2]uint32{{11389716, 232}, {11389717, 137}, {11389718, 212}, {11389719, 95}, {11389720, 184}, {11389721, 68}},
			},
			want: cpuState{
				D:   [8]uint32{1104847861, 252902116, 4277522165, 1091658418, 2146756260, 3655775547, 2109882973, 2420647124},
				A:   [7]uint32{1906636481, 303480731, 1358445353, 544785334, 277247800, 31764468, 2787922151},
				PC:  11389722,
				SR:  41472,
				USP: 8677664,
				SSP: 7308872,
				RAM: [][2]uint32{{11389716, 232}, {11389717, 137}, {11389718, 212}, {11389719, 95}, {11389720, 184}, {11389721, 68}},
				Cycles: 16,
			},
		},
		{
			name: "1500 LSR.l D7, D5 eead",
			init: cpuState{
				D:   [8]uint32{2497586492, 339398789, 301577150, 2391772452, 56842977, 422434016, 2243648768, 1753196857},
				A:   [7]uint32{2137862612, 3364311605, 3664977143, 3973239510, 4077483256, 3560074477, 730552932},
				PC:  1360968,
				SR:  9496,
				USP: 3413340,
				SSP: 1113984,
				RAM: [][2]uint32{{1360964, 238}, {1360965, 173}, {1360966, 68}, {1360967, 49}, {1360968, 176}, {1360969, 120}},
			},
			want: cpuState{
				D:   [8]uint32{2497586492, 339398789, 301577150, 2391772452, 56842977, 0, 2243648768, 1753196857},
				A:   [7]uint32{2137862612, 3364311605, 3664977143, 3973239510, 4077483256, 3560074477, 730552932},
				PC:  1360970,
				SR:  9476,
				USP: 3413340,
				SSP: 1113984,
				RAM: [][2]uint32{{1360964, 238}, {1360965, 173}, {1360966, 68}, {1360967, 49}, {1360968, 176}, {1360969, 120}},
				Cycles: 122,
			},
		},
		{
			name: "2000 LSR.l 7, D7 ee8f",
			init: cpuState{
				D:   [8]uint32{809575155, 2403836666, 2644235358, 2256367370, 945101437, 3774014029, 204222569, 1096069994},
				A:   [7]uint32{144328578, 3187771959, 1355445875, 3372497391, 825212903, 2958094253, 572758074},
				PC:  11311524,
				SR:  8218,
				USP: 1476814,
				SSP: 2604486,
				RAM: [][2]uint32{{11311520, 238}, {11311521, 143}, {11311522, 12}, {11311523, 38}, {11311524, 77}, {11311525, 37}},
			},
			want: cpuState{
				D:   [8]uint32{809575155, 2403836666, 2644235358, 2256367370, 945101437, 3774014029, 204222569, 8563046},
				A:   [7]uint32{144328578, 3187771959, 1355445875, 3372497391, 825212903, 2958094253, 572758074},
				PC:  11311526,
				SR:  8209,
				USP: 1476814,
				SSP: 2604486,
				RAM: [][2]uint32{{11311520, 238}, {11311521, 143}, {11311522, 12}, {11311523, 38}, {11311524, 77}, {11311525, 37}},
				Cycles: 22,
			},
		},
		{
			name: "003 LSR.l 4, D1 e889",
			init: 			cpuState{
				D:   [8]uint32{2275363788, 883427690, 2132787991, 3765765244, 1644687163, 530697120, 2008111783, 838642434},
				A:   [7]uint32{3648245082, 184015371, 3169597129, 1445360736, 3010773868, 3701024616, 994577373},
				PC:  16639490,
				SR:  8728,
				USP: 1093880,
				SSP: 13565162,
				RAM: [][2]uint32{{16639486, 232}, {16639487, 137}, {16639488, 67}, {16639489, 48}, {16639490, 111}, {16639491, 100}},
			},
			want: 			cpuState{
				D:   [8]uint32{2275363788, 55214230, 2132787991, 3765765244, 1644687163, 530697120, 2008111783, 838642434},
				A:   [7]uint32{3648245082, 184015371, 3169597129, 1445360736, 3010773868, 3701024616, 994577373},
				PC:  16639492,
				SR:  8721,
				USP: 1093880,
				SSP: 13565162,
				RAM: [][2]uint32{{16639486, 232}, {16639487, 137}, {16639488, 67}, {16639489, 48}, {16639490, 111}, {16639491, 100}},
				Cycles: 16,
			},
		},
		{
			name: "283 LSR.l 8, D4 e08c",
			init: 			cpuState{
				D:   [8]uint32{1818186431, 1448043639, 544142520, 657310191, 3893669140, 1799951077, 4083199785, 2070039852},
				A:   [7]uint32{3693501590, 1542900986, 2109618195, 2130600104, 3416172026, 3404100910, 1198700970},
				PC:  10514054,
				SR:  8208,
				USP: 16450160,
				SSP: 14911394,
				RAM: [][2]uint32{{10514050, 224}, {10514051, 140}, {10514052, 49}, {10514053, 26}, {10514054, 147}, {10514055, 221}},
			},
			want: 			cpuState{
				D:   [8]uint32{1818186431, 1448043639, 544142520, 657310191, 15209645, 1799951077, 4083199785, 2070039852},
				A:   [7]uint32{3693501590, 1542900986, 2109618195, 2130600104, 3416172026, 3404100910, 1198700970},
				PC:  10514056,
				SR:  8192,
				USP: 16450160,
				SSP: 14911394,
				RAM: [][2]uint32{{10514050, 224}, {10514051, 140}, {10514052, 49}, {10514053, 26}, {10514054, 147}, {10514055, 221}},
				Cycles: 24,
			},
		},
		{
			name: "561 LSR.l 6, D6 ec8e",
			init: 			cpuState{
				D:   [8]uint32{1561192930, 913516281, 287536117, 3039501324, 3511853427, 3830105527, 2096406789, 2148648820},
				A:   [7]uint32{1967471835, 1148552450, 2273930512, 1590695904, 2379630206, 2492851338, 1832042326},
				PC:  3777398,
				SR:  9988,
				USP: 3093200,
				SSP: 3446272,
				RAM: [][2]uint32{{3777394, 236}, {3777395, 142}, {3777396, 124}, {3777397, 193}, {3777398, 1}, {3777399, 93}},
			},
			want: 			cpuState{
				D:   [8]uint32{1561192930, 913516281, 287536117, 3039501324, 3511853427, 3830105527, 32756356, 2148648820},
				A:   [7]uint32{1967471835, 1148552450, 2273930512, 1590695904, 2379630206, 2492851338, 1832042326},
				PC:  3777400,
				SR:  9984,
				USP: 3093200,
				SSP: 3446272,
				RAM: [][2]uint32{{3777394, 236}, {3777395, 142}, {3777396, 124}, {3777397, 193}, {3777398, 1}, {3777399, 93}},
				Cycles: 20,
			},
		},
		{
			name: "827 LSR.l 6, D3 ec8b",
			init: 			cpuState{
				D:   [8]uint32{1074579053, 4085087359, 1008093316, 3973824686, 3740127476, 3406032560, 2647388598, 4143909544},
				A:   [7]uint32{2667883779, 2305682912, 2950374512, 3945534108, 600454179, 3838153430, 2365269235},
				PC:  14673876,
				SR:  10009,
				USP: 12721656,
				SSP: 10511330,
				RAM: [][2]uint32{{14673872, 236}, {14673873, 139}, {14673874, 71}, {14673875, 215}, {14673876, 236}, {14673877, 38}},
			},
			want: 			cpuState{
				D:   [8]uint32{1074579053, 4085087359, 1008093316, 62091010, 3740127476, 3406032560, 2647388598, 4143909544},
				A:   [7]uint32{2667883779, 2305682912, 2950374512, 3945534108, 600454179, 3838153430, 2365269235},
				PC:  14673878,
				SR:  10001,
				USP: 12721656,
				SSP: 10511330,
				RAM: [][2]uint32{{14673872, 236}, {14673873, 139}, {14673874, 71}, {14673875, 215}, {14673876, 236}, {14673877, 38}},
				Cycles: 20,
			},
		},
		{
			name: "1117 LSR.l 5, D7 ea8f",
			init: 			cpuState{
				D:   [8]uint32{1677586719, 1523381322, 417545985, 2018910758, 2466793826, 967152360, 3342986014, 499656686},
				A:   [7]uint32{2565025960, 1294925993, 215031469, 3141437135, 2664362517, 2431587787, 1675852131},
				PC:  2123648,
				SR:  768,
				USP: 12445150,
				SSP: 16063496,
				RAM: [][2]uint32{{2123644, 234}, {2123645, 143}, {2123646, 142}, {2123647, 192}, {2123648, 240}, {2123649, 173}},
			},
			want: 			cpuState{
				D:   [8]uint32{1677586719, 1523381322, 417545985, 2018910758, 2466793826, 967152360, 3342986014, 15614271},
				A:   [7]uint32{2565025960, 1294925993, 215031469, 3141437135, 2664362517, 2431587787, 1675852131},
				PC:  2123650,
				SR:  768,
				USP: 12445150,
				SSP: 16063496,
				RAM: [][2]uint32{{2123644, 234}, {2123645, 143}, {2123646, 142}, {2123647, 192}, {2123648, 240}, {2123649, 173}},
				Cycles: 18,
			},
		},
		{
			name: "1380 LSR.l D1, D6 e2ae",
			init: 			cpuState{
				D:   [8]uint32{4058820978, 3345272339, 183476756, 3921849622, 224081788, 1512407919, 2496623324, 721103115},
				A:   [7]uint32{2542903735, 2145550465, 2345946924, 4233711647, 3802982509, 4003907852, 2481333004},
				PC:  14323664,
				SR:  8204,
				USP: 5310138,
				SSP: 7069744,
				RAM: [][2]uint32{{14323660, 226}, {14323661, 174}, {14323662, 79}, {14323663, 203}, {14323664, 92}, {14323665, 226}},
			},
			want: 			cpuState{
				D:   [8]uint32{4058820978, 3345272339, 183476756, 3921849622, 224081788, 1512407919, 4761, 721103115},
				A:   [7]uint32{2542903735, 2145550465, 2345946924, 4233711647, 3802982509, 4003907852, 2481333004},
				PC:  14323666,
				SR:  8209,
				USP: 5310138,
				SSP: 7069744,
				RAM: [][2]uint32{{14323660, 226}, {14323661, 174}, {14323662, 79}, {14323663, 203}, {14323664, 92}, {14323665, 226}},
				Cycles: 46,
			},
		},
		{
			name: "1660 LSR.l 2, D6 e48e",
			init: 			cpuState{
				D:   [8]uint32{1870568537, 79840007, 1490918213, 1978786389, 2621663264, 3177352475, 4136872717, 1182177612},
				A:   [7]uint32{1797211475, 2158386454, 2372596837, 951672692, 3826547567, 2814009205, 2345559515},
				PC:  2865370,
				SR:  1039,
				USP: 10759430,
				SSP: 4429422,
				RAM: [][2]uint32{{2865366, 228}, {2865367, 142}, {2865368, 79}, {2865369, 188}, {2865370, 113}, {2865371, 246}},
			},
			want: 			cpuState{
				D:   [8]uint32{1870568537, 79840007, 1490918213, 1978786389, 2621663264, 3177352475, 1034218179, 1182177612},
				A:   [7]uint32{1797211475, 2158386454, 2372596837, 951672692, 3826547567, 2814009205, 2345559515},
				PC:  2865372,
				SR:  1024,
				USP: 10759430,
				SSP: 4429422,
				RAM: [][2]uint32{{2865366, 228}, {2865367, 142}, {2865368, 79}, {2865369, 188}, {2865370, 113}, {2865371, 246}},
				Cycles: 12,
			},
		},
		{
			name: "1929 LSR.l 4, D1 e889",
			init: 			cpuState{
				D:   [8]uint32{1308644511, 2690970557, 610453145, 3116153965, 2367890871, 98939260, 1305786676, 596235830},
				A:   [7]uint32{3209851361, 4194007049, 3746657277, 2919334312, 1960870434, 169609372, 1477718378},
				PC:  7411278,
				SR:  9493,
				USP: 3070600,
				SSP: 14614030,
				RAM: [][2]uint32{{7411274, 232}, {7411275, 137}, {7411276, 216}, {7411277, 195}, {7411278, 252}, {7411279, 197}},
			},
			want: 			cpuState{
				D:   [8]uint32{1308644511, 168185659, 610453145, 3116153965, 2367890871, 98939260, 1305786676, 596235830},
				A:   [7]uint32{3209851361, 4194007049, 3746657277, 2919334312, 1960870434, 169609372, 1477718378},
				PC:  7411280,
				SR:  9489,
				USP: 3070600,
				SSP: 14614030,
				RAM: [][2]uint32{{7411274, 232}, {7411275, 137}, {7411276, 216}, {7411277, 195}, {7411278, 252}, {7411279, 197}},
				Cycles: 16,
			},
		},
		{
			name: "2236 LSR.l 4, D3 e88b",
			init: 			cpuState{
				D:   [8]uint32{2370771037, 3519551751, 2814038279, 2273595652, 473802329, 2412537390, 10843622, 1754986043},
				A:   [7]uint32{1949573136, 2938800553, 410984298, 3060797685, 1620458487, 4251342779, 4045029894},
				PC:  4736026,
				SR:  516,
				USP: 1921598,
				SSP: 12780340,
				RAM: [][2]uint32{{4736022, 232}, {4736023, 139}, {4736024, 134}, {4736025, 104}, {4736026, 109}, {4736027, 105}},
			},
			want: 			cpuState{
				D:   [8]uint32{2370771037, 3519551751, 2814038279, 142099728, 473802329, 2412537390, 10843622, 1754986043},
				A:   [7]uint32{1949573136, 2938800553, 410984298, 3060797685, 1620458487, 4251342779, 4045029894},
				PC:  4736028,
				SR:  512,
				USP: 1921598,
				SSP: 12780340,
				RAM: [][2]uint32{{4736022, 232}, {4736023, 139}, {4736024, 134}, {4736025, 104}, {4736026, 109}, {4736027, 105}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROL_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROL.b 5, D4 eb1c",
			init: cpuState{
				D:   [8]uint32{2517272444, 2265450936, 1004140053, 1657010017, 2442098835, 2304893628, 1293499442, 986914619},
				A:   [7]uint32{2015161358, 4086230873, 3045446721, 3003015903, 323189962, 2814893831, 3927382775},
				PC:  3138276,
				SR:  40961,
				USP: 3430384,
				SSP: 16342792,
				RAM: [][2]uint32{{3138272, 235}, {3138273, 28}, {3138274, 123}, {3138275, 149}, {3138276, 195}, {3138277, 234}},
			},
			want: cpuState{
				D:   [8]uint32{2517272444, 2265450936, 1004140053, 1657010017, 2442098802, 2304893628, 1293499442, 986914619},
				A:   [7]uint32{2015161358, 4086230873, 3045446721, 3003015903, 323189962, 2814893831, 3927382775},
				PC:  3138278,
				SR:  40960,
				USP: 3430384,
				SSP: 16342792,
				RAM: [][2]uint32{{3138272, 235}, {3138273, 28}, {3138274, 123}, {3138275, 149}, {3138276, 195}, {3138277, 234}},
				Cycles: 16,
			},
		},
		{
			name: "500 ROL.b 1, D6 e31e",
			init: cpuState{
				D:   [8]uint32{525198450, 983442165, 1088757446, 2239522858, 984287708, 3658178191, 2725799762, 854376006},
				A:   [7]uint32{1867906472, 1317350956, 3484231797, 1061163657, 1681532631, 401186662, 1369844739},
				PC:  1174412,
				SR:  33546,
				USP: 6665188,
				SSP: 16697410,
				RAM: [][2]uint32{{1174408, 227}, {1174409, 30}, {1174410, 79}, {1174411, 216}, {1174412, 191}, {1174413, 143}},
			},
			want: cpuState{
				D:   [8]uint32{525198450, 983442165, 1088757446, 2239522858, 984287708, 3658178191, 2725799844, 854376006},
				A:   [7]uint32{1867906472, 1317350956, 3484231797, 1061163657, 1681532631, 401186662, 1369844739},
				PC:  1174414,
				SR:  33544,
				USP: 6665188,
				SSP: 16697410,
				RAM: [][2]uint32{{1174408, 227}, {1174409, 30}, {1174410, 79}, {1174411, 216}, {1174412, 191}, {1174413, 143}},
				Cycles: 8,
			},
		},
		{
			name: "1000 ROL.b D4, D0 e938",
			init: cpuState{
				D:   [8]uint32{1690767015, 2911249276, 1919302455, 1196508991, 1527133813, 2375975483, 3777783378, 2944613900},
				A:   [7]uint32{573856248, 4232937307, 848021126, 4188606726, 325531161, 2983219363, 8298591},
				PC:  11559190,
				SR:  34569,
				USP: 1266586,
				SSP: 1636108,
				RAM: [][2]uint32{{11559186, 233}, {11559187, 56}, {11559188, 148}, {11559189, 53}, {11559190, 101}, {11559191, 185}},
			},
			want: cpuState{
				D:   [8]uint32{1690767092, 2911249276, 1919302455, 1196508991, 1527133813, 2375975483, 3777783378, 2944613900},
				A:   [7]uint32{573856248, 4232937307, 848021126, 4188606726, 325531161, 2983219363, 8298591},
				PC:  11559192,
				SR:  34568,
				USP: 1266586,
				SSP: 1636108,
				RAM: [][2]uint32{{11559186, 233}, {11559187, 56}, {11559188, 148}, {11559189, 53}, {11559190, 101}, {11559191, 185}},
				Cycles: 112,
			},
		},
		{
			name: "1500 ROL.b 8, D6 e11e",
			init: cpuState{
				D:   [8]uint32{2785518625, 3230668493, 931390908, 2212184029, 333474099, 3895950692, 2705625962, 178809708},
				A:   [7]uint32{482237976, 3232404909, 3476004405, 3443534518, 875943416, 3130493875, 3187644400},
				PC:  18086,
				SR:  34586,
				USP: 5466856,
				SSP: 15774426,
				RAM: [][2]uint32{{18082, 225}, {18083, 30}, {18084, 97}, {18085, 135}, {18086, 125}, {18087, 156}},
			},
			want: cpuState{
				D:   [8]uint32{2785518625, 3230668493, 931390908, 2212184029, 333474099, 3895950692, 2705625962, 178809708},
				A:   [7]uint32{482237976, 3232404909, 3476004405, 3443534518, 875943416, 3130493875, 3187644400},
				PC:  18088,
				SR:  34576,
				USP: 5466856,
				SSP: 15774426,
				RAM: [][2]uint32{{18082, 225}, {18083, 30}, {18084, 97}, {18085, 135}, {18086, 125}, {18087, 156}},
				Cycles: 22,
			},
		},
		{
			name: "2000 ROL.b D3, D1 e739",
			init: cpuState{
				D:   [8]uint32{388038370, 3162153770, 2555931228, 290815116, 3877127290, 2365245123, 1036471570, 3858586854},
				A:   [7]uint32{3452052381, 4017547708, 3000879294, 26585159, 3674026563, 2521375970, 601292067},
				PC:  6273300,
				SR:  782,
				USP: 45738,
				SSP: 8276770,
				RAM: [][2]uint32{{6273296, 231}, {6273297, 57}, {6273298, 12}, {6273299, 98}, {6273300, 242}, {6273301, 45}},
			},
			want: cpuState{
				D:   [8]uint32{388038370, 3162153890, 2555931228, 290815116, 3877127290, 2365245123, 1036471570, 3858586854},
				A:   [7]uint32{3452052381, 4017547708, 3000879294, 26585159, 3674026563, 2521375970, 601292067},
				PC:  6273302,
				SR:  776,
				USP: 45738,
				SSP: 8276770,
				RAM: [][2]uint32{{6273296, 231}, {6273297, 57}, {6273298, 12}, {6273299, 98}, {6273300, 242}, {6273301, 45}},
				Cycles: 30,
			},
		},
		{
			name: "003 ROL.b 8, D6 e11e",
			init: 			cpuState{
				D:   [8]uint32{2033138896, 293671136, 3954826209, 3769569832, 111302545, 373917263, 95853994, 4223699348},
				A:   [7]uint32{116985440, 2213084231, 2693565169, 1825466444, 1814544839, 3417249895, 2186966446},
				PC:  14727636,
				SR:  9991,
				USP: 3768962,
				SSP: 1364376,
				RAM: [][2]uint32{{14727632, 225}, {14727633, 30}, {14727634, 207}, {14727635, 19}, {14727636, 95}, {14727637, 232}},
			},
			want: 			cpuState{
				D:   [8]uint32{2033138896, 293671136, 3954826209, 3769569832, 111302545, 373917263, 95853994, 4223699348},
				A:   [7]uint32{116985440, 2213084231, 2693565169, 1825466444, 1814544839, 3417249895, 2186966446},
				PC:  14727638,
				SR:  9992,
				USP: 3768962,
				SSP: 1364376,
				RAM: [][2]uint32{{14727632, 225}, {14727633, 30}, {14727634, 207}, {14727635, 19}, {14727636, 95}, {14727637, 232}},
				Cycles: 22,
			},
		},
		{
			name: "315 ROL.b D3, D1 e739",
			init: 			cpuState{
				D:   [8]uint32{905879082, 2414439766, 635577622, 175672816, 111270789, 3190968007, 318011987, 2248046939},
				A:   [7]uint32{1233654631, 2346970472, 1325671403, 1291586322, 1477246455, 2856242717, 3805742505},
				PC:  6796190,
				SR:  8973,
				USP: 10279650,
				SSP: 15095316,
				RAM: [][2]uint32{{6796186, 231}, {6796187, 57}, {6796188, 60}, {6796189, 68}, {6796190, 151}, {6796191, 69}},
			},
			want: 			cpuState{
				D:   [8]uint32{905879082, 2414439766, 635577622, 175672816, 111270789, 3190968007, 318011987, 2248046939},
				A:   [7]uint32{1233654631, 2346970472, 1325671403, 1291586322, 1477246455, 2856242717, 3805742505},
				PC:  6796192,
				SR:  8960,
				USP: 10279650,
				SSP: 15095316,
				RAM: [][2]uint32{{6796186, 231}, {6796187, 57}, {6796188, 60}, {6796189, 68}, {6796190, 151}, {6796191, 69}},
				Cycles: 102,
			},
		},
		{
			name: "600 ROL.b D2, D7 e53f",
			init: 			cpuState{
				D:   [8]uint32{3915771496, 1520332888, 558698312, 587793163, 3153171320, 2182269885, 3105184552, 3148171730},
				A:   [7]uint32{705322348, 1376662526, 851603652, 1273019566, 3295309761, 783799410, 1950263909},
				PC:  13935970,
				SR:  8704,
				USP: 7878078,
				SSP: 8819416,
				RAM: [][2]uint32{{13935966, 229}, {13935967, 63}, {13935968, 38}, {13935969, 30}, {13935970, 33}, {13935971, 1}},
			},
			want: 			cpuState{
				D:   [8]uint32{3915771496, 1520332888, 558698312, 587793163, 3153171320, 2182269885, 3105184552, 3148171730},
				A:   [7]uint32{705322348, 1376662526, 851603652, 1273019566, 3295309761, 783799410, 1950263909},
				PC:  13935972,
				SR:  8712,
				USP: 7878078,
				SSP: 8819416,
				RAM: [][2]uint32{{13935966, 229}, {13935967, 63}, {13935968, 38}, {13935969, 30}, {13935970, 33}, {13935971, 1}},
				Cycles: 22,
			},
		},
		{
			name: "886 ROL.b 4, D3 e91b",
			init: 			cpuState{
				D:   [8]uint32{4228131519, 190185643, 1743934952, 1222928852, 4037256702, 36428427, 3941137069, 205874109},
				A:   [7]uint32{3516437666, 3496080674, 3519958215, 3807001179, 4276787128, 574287054, 3949136780},
				PC:  11251094,
				SR:  521,
				USP: 5796234,
				SSP: 8917896,
				RAM: [][2]uint32{{11251090, 233}, {11251091, 27}, {11251092, 156}, {11251093, 246}, {11251094, 218}, {11251095, 14}},
			},
			want: 			cpuState{
				D:   [8]uint32{4228131519, 190185643, 1743934952, 1222928717, 4037256702, 36428427, 3941137069, 205874109},
				A:   [7]uint32{3516437666, 3496080674, 3519958215, 3807001179, 4276787128, 574287054, 3949136780},
				PC:  11251096,
				SR:  513,
				USP: 5796234,
				SSP: 8917896,
				RAM: [][2]uint32{{11251090, 233}, {11251091, 27}, {11251092, 156}, {11251093, 246}, {11251094, 218}, {11251095, 14}},
				Cycles: 14,
			},
		},
		{
			name: "1166 ROL.b D7, D4 ef3c",
			init: 			cpuState{
				D:   [8]uint32{3475534189, 3504692055, 400939794, 1321520553, 3823836987, 1722470580, 108052398, 380951997},
				A:   [7]uint32{826434859, 4113706353, 2977518142, 3639076494, 1998058454, 388279536, 1415241190},
				PC:  2240308,
				SR:  1548,
				USP: 13462690,
				SSP: 2799352,
				RAM: [][2]uint32{{2240304, 239}, {2240305, 60}, {2240306, 219}, {2240307, 89}, {2240308, 205}, {2240309, 206}},
			},
			want: 			cpuState{
				D:   [8]uint32{3475534189, 3504692055, 400939794, 1321520553, 3823837031, 1722470580, 108052398, 380951997},
				A:   [7]uint32{826434859, 4113706353, 2977518142, 3639076494, 1998058454, 388279536, 1415241190},
				PC:  2240310,
				SR:  1537,
				USP: 13462690,
				SSP: 2799352,
				RAM: [][2]uint32{{2240304, 239}, {2240305, 60}, {2240306, 219}, {2240307, 89}, {2240308, 205}, {2240309, 206}},
				Cycles: 128,
			},
		},
		{
			name: "1429 ROL.b D7, D0 ef38",
			init: 			cpuState{
				D:   [8]uint32{4159868996, 2209728717, 1611747700, 906530418, 329877299, 1206410835, 3166649875, 40924470},
				A:   [7]uint32{2649296910, 896951261, 235294391, 1519687455, 2091935075, 1642726220, 1950032714},
				PC:  9708134,
				SR:  8450,
				USP: 4618106,
				SSP: 12014322,
				RAM: [][2]uint32{{9708130, 239}, {9708131, 56}, {9708132, 218}, {9708133, 1}, {9708134, 127}, {9708135, 32}},
			},
			want: 			cpuState{
				D:   [8]uint32{4159868945, 2209728717, 1611747700, 906530418, 329877299, 1206410835, 3166649875, 40924470},
				A:   [7]uint32{2649296910, 896951261, 235294391, 1519687455, 2091935075, 1642726220, 1950032714},
				PC:  9708136,
				SR:  8449,
				USP: 4618106,
				SSP: 12014322,
				RAM: [][2]uint32{{9708130, 239}, {9708131, 56}, {9708132, 218}, {9708133, 1}, {9708134, 127}, {9708135, 32}},
				Cycles: 114,
			},
		},
		{
			name: "1701 ROL.b D6, D1 ed39",
			init: 			cpuState{
				D:   [8]uint32{3308980100, 2624536559, 1026380574, 3646161710, 1381154236, 1129762440, 2010649030, 2680584280},
				A:   [7]uint32{4108391472, 1060927739, 335292082, 2976868258, 1686492812, 918690593, 2041245773},
				PC:  15564978,
				SR:  8961,
				USP: 13694072,
				SSP: 7198150,
				RAM: [][2]uint32{{15564974, 237}, {15564975, 57}, {15564976, 104}, {15564977, 105}, {15564978, 78}, {15564979, 202}},
			},
			want: 			cpuState{
				D:   [8]uint32{3308980100, 2624536571, 1026380574, 3646161710, 1381154236, 1129762440, 2010649030, 2680584280},
				A:   [7]uint32{4108391472, 1060927739, 335292082, 2976868258, 1686492812, 918690593, 2041245773},
				PC:  15564980,
				SR:  8969,
				USP: 13694072,
				SSP: 7198150,
				RAM: [][2]uint32{{15564974, 237}, {15564975, 57}, {15564976, 104}, {15564977, 105}, {15564978, 78}, {15564979, 202}},
				Cycles: 18,
			},
		},
		{
			name: "1959 ROL.b 6, D7 ed1f",
			init: 			cpuState{
				D:   [8]uint32{2312931709, 1239340401, 2402402526, 2407638447, 1271833875, 1914815993, 1081866734, 1610423827},
				A:   [7]uint32{252833753, 171621948, 768484252, 2096952531, 1113213875, 1621119261, 485276159},
				PC:  4858988,
				SR:  9217,
				USP: 8492886,
				SSP: 580914,
				RAM: [][2]uint32{{4858984, 237}, {4858985, 31}, {4858986, 172}, {4858987, 88}, {4858988, 228}, {4858989, 101}},
			},
			want: 			cpuState{
				D:   [8]uint32{2312931709, 1239340401, 2402402526, 2407638447, 1271833875, 1914815993, 1081866734, 1610424004},
				A:   [7]uint32{252833753, 171621948, 768484252, 2096952531, 1113213875, 1621119261, 485276159},
				PC:  4858990,
				SR:  9224,
				USP: 8492886,
				SSP: 580914,
				RAM: [][2]uint32{{4858984, 237}, {4858985, 31}, {4858986, 172}, {4858987, 88}, {4858988, 228}, {4858989, 101}},
				Cycles: 18,
			},
		},
		{
			name: "2243 ROL.b 3, D5 e71d",
			init: 			cpuState{
				D:   [8]uint32{4030441909, 1604541073, 838512517, 1293485166, 3753336709, 1045329078, 157109252, 4225929004},
				A:   [7]uint32{3850698618, 2663500808, 1545823185, 3635962352, 1757881635, 2687805410, 2415849641},
				PC:  2089124,
				SR:  1551,
				USP: 859298,
				SSP: 14512854,
				RAM: [][2]uint32{{2089120, 231}, {2089121, 29}, {2089122, 39}, {2089123, 117}, {2089124, 153}, {2089125, 112}},
			},
			want: 			cpuState{
				D:   [8]uint32{4030441909, 1604541073, 838512517, 1293485166, 3753336709, 1045329077, 157109252, 4225929004},
				A:   [7]uint32{3850698618, 2663500808, 1545823185, 3635962352, 1757881635, 2687805410, 2415849641},
				PC:  2089126,
				SR:  1545,
				USP: 859298,
				SSP: 14512854,
				RAM: [][2]uint32{{2089120, 231}, {2089121, 29}, {2089122, 39}, {2089123, 117}, {2089124, 153}, {2089125, 112}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROL_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROL.w D5, D4 eb7c",
			init: cpuState{
				D:   [8]uint32{2505882384, 685705009, 3030064830, 3675247218, 1432694544, 4114921107, 1343220142, 3055279028},
				A:   [7]uint32{4027503539, 2731282429, 3534683800, 4009763471, 2776129223, 933891404, 1092129691},
				PC:  13341400,
				SR:  10002,
				USP: 14763484,
				SSP: 12832426,
				RAM: [][2]uint32{{13341396, 235}, {13341397, 124}, {13341398, 147}, {13341399, 10}, {13341400, 17}, {13341401, 214}},
			},
			want: cpuState{
				D:   [8]uint32{2505882384, 685705009, 3030064830, 3675247218, 1432713345, 4114921107, 1343220142, 3055279028},
				A:   [7]uint32{4027503539, 2731282429, 3534683800, 4009763471, 2776129223, 933891404, 1092129691},
				PC:  13341402,
				SR:  10001,
				USP: 14763484,
				SSP: 12832426,
				RAM: [][2]uint32{{13341396, 235}, {13341397, 124}, {13341398, 147}, {13341399, 10}, {13341400, 17}, {13341401, 214}},
				Cycles: 44,
			},
		},
		{
			name: "500 ROL.w 6, D3 ed5b",
			init: cpuState{
				D:   [8]uint32{655770968, 3691991410, 1627668811, 2054292670, 3244930468, 1832754842, 1782672908, 433969253},
				A:   [7]uint32{2054802838, 3268739599, 3113985221, 910846268, 650712069, 3430120178, 2429837566},
				PC:  13664038,
				SR:  8462,
				USP: 8378588,
				SSP: 11773974,
				RAM: [][2]uint32{{13664034, 237}, {13664035, 91}, {13664036, 134}, {13664037, 54}, {13664038, 14}, {13664039, 158}},
			},
			want: cpuState{
				D:   [8]uint32{655770968, 3691991410, 1627668811, 2054303617, 3244930468, 1832754842, 1782672908, 433969253},
				A:   [7]uint32{2054802838, 3268739599, 3113985221, 910846268, 650712069, 3430120178, 2429837566},
				PC:  13664040,
				SR:  8449,
				USP: 8378588,
				SSP: 11773974,
				RAM: [][2]uint32{{13664034, 237}, {13664035, 91}, {13664036, 134}, {13664037, 54}, {13664038, 14}, {13664039, 158}},
				Cycles: 18,
			},
		},
		{
			name: "1000 ROL.w 5, D2 eb5a",
			init: cpuState{
				D:   [8]uint32{4100750327, 217295128, 1624159517, 3744133661, 1815349090, 2329705411, 3263645590, 3958144869},
				A:   [7]uint32{4279370027, 3498919482, 3410734175, 1670676982, 1309440120, 1474374107, 2826690182},
				PC:  12729982,
				SR:  9244,
				USP: 14180484,
				SSP: 9091024,
				RAM: [][2]uint32{{12729978, 235}, {12729979, 90}, {12729980, 173}, {12729981, 69}, {12729982, 4}, {12729983, 123}},
			},
			want: cpuState{
				D:   [8]uint32{4100750327, 217295128, 1624155062, 3744133661, 1815349090, 2329705411, 3263645590, 3958144869},
				A:   [7]uint32{4279370027, 3498919482, 3410734175, 1670676982, 1309440120, 1474374107, 2826690182},
				PC:  12729984,
				SR:  9240,
				USP: 14180484,
				SSP: 9091024,
				RAM: [][2]uint32{{12729978, 235}, {12729979, 90}, {12729980, 173}, {12729981, 69}, {12729982, 4}, {12729983, 123}},
				Cycles: 16,
			},
		},
		{
			name: "1500 ROL.w D7, D2 ef7a",
			init: cpuState{
				D:   [8]uint32{1851922317, 2694208766, 392342241, 2203627858, 1767964058, 2664414603, 838653975, 2087067338},
				A:   [7]uint32{1837770238, 2368650546, 3704307740, 2171328217, 4012510328, 486012234, 1407683769},
				PC:  11226004,
				SR:  33303,
				USP: 2185988,
				SSP: 2430476,
				RAM: [][2]uint32{{11226000, 239}, {11226001, 122}, {11226002, 27}, {11226003, 141}, {11226004, 114}, {11226005, 42}},
			},
			want: cpuState{
				D:   [8]uint32{1851922317, 2694208766, 392332971, 2203627858, 1767964058, 2664414603, 838653975, 2087067338},
				A:   [7]uint32{1837770238, 2368650546, 3704307740, 2171328217, 4012510328, 486012234, 1407683769},
				PC:  11226006,
				SR:  33305,
				USP: 2185988,
				SSP: 2430476,
				RAM: [][2]uint32{{11226000, 239}, {11226001, 122}, {11226002, 27}, {11226003, 141}, {11226004, 114}, {11226005, 42}},
				Cycles: 26,
			},
		},
		{
			name: "2000 ROL.w D7, D2 ef7a",
			init: cpuState{
				D:   [8]uint32{3555407885, 1814430557, 861345995, 1676874006, 3396918028, 184878603, 3301044309, 3140299004},
				A:   [7]uint32{3014189570, 888327233, 3786983369, 439758804, 4152198053, 2291577213, 4144415127},
				PC:  16281574,
				SR:  41236,
				USP: 13250876,
				SSP: 6391296,
				RAM: [][2]uint32{{16281570, 239}, {16281571, 122}, {16281572, 37}, {16281573, 245}, {16281574, 25}, {16281575, 234}},
			},
			want: cpuState{
				D:   [8]uint32{3555407885, 1814430557, 861385100, 1676874006, 3396918028, 184878603, 3301044309, 3140299004},
				A:   [7]uint32{3014189570, 888327233, 3786983369, 439758804, 4152198053, 2291577213, 4144415127},
				PC:  16281576,
				SR:  41240,
				USP: 13250876,
				SSP: 6391296,
				RAM: [][2]uint32{{16281570, 239}, {16281571, 122}, {16281572, 37}, {16281573, 245}, {16281574, 25}, {16281575, 234}},
				Cycles: 126,
			},
		},
		{
			name: "002 ROL.w 2, D5 e55d",
			init: 			cpuState{
				D:   [8]uint32{4070597826, 1322758500, 2604232599, 764401482, 3254699035, 2034706092, 3550261998, 2144141054},
				A:   [7]uint32{2799204168, 2651266171, 3895768173, 1940896259, 896210995, 1829299673, 3993149882},
				PC:  14682338,
				SR:  9736,
				USP: 1197082,
				SSP: 14742348,
				RAM: [][2]uint32{{14682334, 229}, {14682335, 93}, {14682336, 25}, {14682337, 198}, {14682338, 239}, {14682339, 250}},
			},
			want: 			cpuState{
				D:   [8]uint32{4070597826, 1322758500, 2604232599, 764401482, 3254699035, 2034735792, 3550261998, 2144141054},
				A:   [7]uint32{2799204168, 2651266171, 3895768173, 1940896259, 896210995, 1829299673, 3993149882},
				PC:  14682340,
				SR:  9736,
				USP: 1197082,
				SSP: 14742348,
				RAM: [][2]uint32{{14682334, 229}, {14682335, 93}, {14682336, 25}, {14682337, 198}, {14682338, 239}, {14682339, 250}},
				Cycles: 10,
			},
		},
		{
			name: "281 ROL.w (d8, A0, Xn) e7f0",
			init: 			cpuState{
				D:   [8]uint32{2176573138, 947285545, 2068502366, 4211022391, 7087972, 2623743228, 933475935, 1510964466},
				A:   [7]uint32{1674733634, 1296844681, 2483419584, 3690895913, 2341234220, 1501602543, 3377964844},
				PC:  14687492,
				SR:  25,
				USP: 839432,
				SSP: 210018,
				RAM: [][2]uint32{{14687488, 231}, {14687489, 240}, {14687490, 124}, {14687491, 132}, {14687492, 147}, {14687493, 62}, {14804152, 237}, {14804153, 23}, {14687494, 110}, {14687495, 208}},
			},
			want: 			cpuState{
				D:   [8]uint32{2176573138, 947285545, 2068502366, 4211022391, 7087972, 2623743228, 933475935, 1510964466},
				A:   [7]uint32{1674733634, 1296844681, 2483419584, 3690895913, 2341234220, 1501602543, 3377964844},
				PC:  14687496,
				SR:  25,
				USP: 839432,
				SSP: 210018,
				RAM: [][2]uint32{{14687488, 231}, {14687489, 240}, {14687490, 124}, {14687491, 132}, {14687492, 147}, {14687493, 62}, {14804152, 218}, {14804153, 47}, {14687494, 110}, {14687495, 208}},
				Cycles: 18,
			},
		},
		{
			name: "581 ROL.w D6, D4 ed7c",
			init: 			cpuState{
				D:   [8]uint32{4232398205, 3735180929, 439326634, 3244090539, 411151488, 224819408, 3551355546, 486563628},
				A:   [7]uint32{3119622868, 1306251404, 920063704, 1407163663, 798257768, 3509757718, 3532993015},
				PC:  13030586,
				SR:  517,
				USP: 3891510,
				SSP: 8106274,
				RAM: [][2]uint32{{13030582, 237}, {13030583, 124}, {13030584, 68}, {13030585, 93}, {13030586, 207}, {13030587, 89}},
			},
			want: 			cpuState{
				D:   [8]uint32{4232398205, 3735180929, 439326634, 3244090539, 411108018, 224819408, 3551355546, 486563628},
				A:   [7]uint32{3119622868, 1306251404, 920063704, 1407163663, 798257768, 3509757718, 3532993015},
				PC:  13030588,
				SR:  512,
				USP: 3891510,
				SSP: 8106274,
				RAM: [][2]uint32{{13030582, 237}, {13030583, 124}, {13030584, 68}, {13030585, 93}, {13030586, 207}, {13030587, 89}},
				Cycles: 58,
			},
		},
		{
			name: "864 ROL.w -(A2) e7e2",
			init: 			cpuState{
				D:   [8]uint32{3614990938, 2874074373, 3179849368, 1232021152, 1190211420, 1994551244, 2131339014, 2304622181},
				A:   [7]uint32{3138571667, 447761841, 2029343198, 485481936, 2461939401, 4137290912, 1598405933},
				PC:  11536232,
				SR:  31,
				USP: 4931930,
				SSP: 13603496,
				RAM: [][2]uint32{{11536228, 231}, {11536229, 226}, {11536230, 115}, {11536231, 55}, {16077276, 200}, {16077277, 197}, {11536232, 47}, {11536233, 36}},
			},
			want: 			cpuState{
				D:   [8]uint32{3614990938, 2874074373, 3179849368, 1232021152, 1190211420, 1994551244, 2131339014, 2304622181},
				A:   [7]uint32{3138571667, 447761841, 2029343196, 485481936, 2461939401, 4137290912, 1598405933},
				PC:  11536234,
				SR:  25,
				USP: 4931930,
				SSP: 13603496,
				RAM: [][2]uint32{{11536228, 231}, {11536229, 226}, {11536230, 115}, {11536231, 55}, {16077276, 145}, {16077277, 139}, {11536232, 47}, {11536233, 36}},
				Cycles: 14,
			},
		},
		{
			name: "1114 ROL.w D2, D3 e57b",
			init: 			cpuState{
				D:   [8]uint32{837623469, 3835134668, 3560231676, 2918378416, 2587729190, 1230140326, 3271380603, 1515930528},
				A:   [7]uint32{1169644927, 2679472561, 3003524378, 2137345166, 787559204, 1320917193, 1353805454},
				PC:  5272752,
				SR:  9736,
				USP: 5263400,
				SSP: 7559936,
				RAM: [][2]uint32{{5272748, 229}, {5272749, 123}, {5272750, 178}, {5272751, 173}, {5272752, 154}, {5272753, 86}},
			},
			want: 			cpuState{
				D:   [8]uint32{837623469, 3835134668, 3560231676, 2918321851, 2587729190, 1230140326, 3271380603, 1515930528},
				A:   [7]uint32{1169644927, 2679472561, 3003524378, 2137345166, 787559204, 1320917193, 1353805454},
				PC:  5272754,
				SR:  9729,
				USP: 5263400,
				SSP: 7559936,
				RAM: [][2]uint32{{5272748, 229}, {5272749, 123}, {5272750, 178}, {5272751, 173}, {5272752, 154}, {5272753, 86}},
				Cycles: 126,
			},
		},
		{
			name: "1378 ROL.w D0, D7 e17f",
			init: 			cpuState{
				D:   [8]uint32{2670062982, 2055173747, 3585988962, 2587365157, 3399515104, 320567781, 1211017364, 636853014},
				A:   [7]uint32{3450995350, 4266840409, 1200019159, 466989433, 455635850, 2369554243, 1284356313},
				PC:  6822790,
				SR:  9220,
				USP: 3194862,
				SSP: 642446,
				RAM: [][2]uint32{{6822786, 225}, {6822787, 127}, {6822788, 127}, {6822789, 64}, {6822790, 67}, {6822791, 179}},
			},
			want: 			cpuState{
				D:   [8]uint32{2670062982, 2055173747, 3585988962, 2587365157, 3399515104, 320567781, 1211017364, 636863910},
				A:   [7]uint32{3450995350, 4266840409, 1200019159, 466989433, 455635850, 2369554243, 1284356313},
				PC:  6822792,
				SR:  9224,
				USP: 3194862,
				SSP: 642446,
				RAM: [][2]uint32{{6822786, 225}, {6822787, 127}, {6822788, 127}, {6822789, 64}, {6822790, 67}, {6822791, 179}},
				Cycles: 18,
			},
		},
		{
			name: "1674 ROL.w D2, D4 e57c",
			init: 			cpuState{
				D:   [8]uint32{4097807822, 239292884, 1782630306, 2497699173, 211898354, 2563023224, 1552789786, 2334355760},
				A:   [7]uint32{947421773, 4093733999, 3787807971, 3211010271, 1147852757, 258122638, 829308608},
				PC:  15564090,
				SR:  8213,
				USP: 11340728,
				SSP: 223306,
				RAM: [][2]uint32{{15564086, 229}, {15564087, 124}, {15564088, 189}, {15564089, 76}, {15564090, 129}, {15564091, 201}},
			},
			want: 			cpuState{
				D:   [8]uint32{4097807822, 239292884, 1782630306, 2497699173, 211894217, 2563023224, 1552789786, 2334355760},
				A:   [7]uint32{947421773, 4093733999, 3787807971, 3211010271, 1147852757, 258122638, 829308608},
				PC:  15564092,
				SR:  8209,
				USP: 11340728,
				SSP: 223306,
				RAM: [][2]uint32{{15564086, 229}, {15564087, 124}, {15564088, 189}, {15564089, 76}, {15564090, 129}, {15564091, 201}},
				Cycles: 74,
			},
		},
		{
			name: "1971 ROL.w 3, D1 e759",
			init: 			cpuState{
				D:   [8]uint32{2197066346, 2069373459, 2173129657, 4025102095, 717773278, 2076748305, 154403459, 428517494},
				A:   [7]uint32{1495755447, 1412446863, 1616977457, 3340624117, 1726082127, 1168885258, 1097859759},
				PC:  9393408,
				SR:  9479,
				USP: 3917222,
				SSP: 12651258,
				RAM: [][2]uint32{{9393404, 231}, {9393405, 89}, {9393406, 211}, {9393407, 12}, {9393408, 43}, {9393409, 178}},
			},
			want: 			cpuState{
				D:   [8]uint32{2197066346, 2069368985, 2173129657, 4025102095, 717773278, 2076748305, 154403459, 428517494},
				A:   [7]uint32{1495755447, 1412446863, 1616977457, 3340624117, 1726082127, 1168885258, 1097859759},
				PC:  9393410,
				SR:  9473,
				USP: 3917222,
				SSP: 12651258,
				RAM: [][2]uint32{{9393404, 231}, {9393405, 89}, {9393406, 211}, {9393407, 12}, {9393408, 43}, {9393409, 178}},
				Cycles: 12,
			},
		},
		{
			name: "2248 ROL.w D5, D2 eb7a",
			init: 			cpuState{
				D:   [8]uint32{2249343274, 3774191514, 3293252229, 1469987765, 3056148997, 4131976491, 3349369874, 2315970855},
				A:   [7]uint32{3717967276, 2449710596, 798495252, 3214620958, 2195856053, 3152939365, 1522760055},
				PC:  14457280,
				SR:  9494,
				USP: 3493460,
				SSP: 4255182,
				RAM: [][2]uint32{{14457276, 235}, {14457277, 122}, {14457278, 221}, {14457279, 31}, {14457280, 207}, {14457281, 12}},
			},
			want: 			cpuState{
				D:   [8]uint32{2249343274, 3774191514, 3293259860, 1469987765, 3056148997, 4131976491, 3349369874, 2315970855},
				A:   [7]uint32{3717967276, 2449710596, 798495252, 3214620958, 2195856053, 3152939365, 1522760055},
				PC:  14457282,
				SR:  9488,
				USP: 3493460,
				SSP: 4255182,
				RAM: [][2]uint32{{14457276, 235}, {14457277, 122}, {14457278, 221}, {14457279, 31}, {14457280, 207}, {14457281, 12}},
				Cycles: 92,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROL_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROL.l D7, D0 efb8",
			init: cpuState{
				D:   [8]uint32{295350685, 1290224561, 202247791, 2997091738, 2379467381, 951256509, 3876128624, 3840337621},
				A:   [7]uint32{1396228345, 1200069987, 3443579832, 2560296284, 2988992071, 2661556390, 1342203178},
				PC:  13780572,
				SR:  42514,
				USP: 10556802,
				SSP: 53978,
				RAM: [][2]uint32{{13780568, 239}, {13780569, 184}, {13780570, 249}, {13780571, 30}, {13780572, 248}, {13780573, 151}},
			},
			want: cpuState{
				D:   [8]uint32{866267990, 1290224561, 202247791, 2997091738, 2379467381, 951256509, 3876128624, 3840337621},
				A:   [7]uint32{1396228345, 1200069987, 3443579832, 2560296284, 2988992071, 2661556390, 1342203178},
				PC:  13780574,
				SR:  42512,
				USP: 10556802,
				SSP: 53978,
				RAM: [][2]uint32{{13780568, 239}, {13780569, 184}, {13780570, 249}, {13780571, 30}, {13780572, 248}, {13780573, 151}},
				Cycles: 50,
			},
		},
		{
			name: "500 ROL.l D3, D5 e7bd",
			init: cpuState{
				D:   [8]uint32{2483332442, 3766313178, 1178828620, 348440065, 380403517, 3957867825, 2741980313, 3127404373},
				A:   [7]uint32{1573219485, 1320143408, 3368563101, 2022700411, 4134067902, 3167194623, 3132289933},
				PC:  6467162,
				SR:  9752,
				USP: 8971192,
				SSP: 78060,
				RAM: [][2]uint32{{6467158, 231}, {6467159, 189}, {6467160, 59}, {6467161, 141}, {6467162, 29}, {6467163, 182}},
			},
			want: cpuState{
				D:   [8]uint32{2483332442, 3766313178, 1178828620, 348440065, 380403517, 3620768355, 2741980313, 3127404373},
				A:   [7]uint32{1573219485, 1320143408, 3368563101, 2022700411, 4134067902, 3167194623, 3132289933},
				PC:  6467164,
				SR:  9753,
				USP: 8971192,
				SSP: 78060,
				RAM: [][2]uint32{{6467158, 231}, {6467159, 189}, {6467160, 59}, {6467161, 141}, {6467162, 29}, {6467163, 182}},
				Cycles: 10,
			},
		},
		{
			name: "1000 ROL.l 8, D3 e19b",
			init: cpuState{
				D:   [8]uint32{3029220882, 2110876063, 2873439725, 1403579860, 2167148551, 225598169, 3726276757, 408639079},
				A:   [7]uint32{3861147860, 2639339833, 2874631903, 3323855726, 1381324249, 167261836, 1874674619},
				PC:  8628888,
				SR:  41225,
				USP: 15606080,
				SSP: 16713252,
				RAM: [][2]uint32{{8628884, 225}, {8628885, 155}, {8628886, 89}, {8628887, 225}, {8628888, 29}, {8628889, 59}},
			},
			want: cpuState{
				D:   [8]uint32{3029220882, 2110876063, 2873439725, 2834158675, 2167148551, 225598169, 3726276757, 408639079},
				A:   [7]uint32{3861147860, 2639339833, 2874631903, 3323855726, 1381324249, 167261836, 1874674619},
				PC:  8628890,
				SR:  41225,
				USP: 15606080,
				SSP: 16713252,
				RAM: [][2]uint32{{8628884, 225}, {8628885, 155}, {8628886, 89}, {8628887, 225}, {8628888, 29}, {8628889, 59}},
				Cycles: 24,
			},
		},
		{
			name: "1500 ROL.l D2, D7 e5bf",
			init: cpuState{
				D:   [8]uint32{2253782106, 737149875, 4273674890, 865167825, 4015861447, 4027163114, 1662341325, 2885132462},
				A:   [7]uint32{3638012439, 277237113, 867479731, 972908219, 1455078264, 2419495580, 2971085724},
				PC:  15553196,
				SR:  41991,
				USP: 7602458,
				SSP: 7797492,
				RAM: [][2]uint32{{15553192, 229}, {15553193, 191}, {15553194, 164}, {15553195, 201}, {15553196, 219}, {15553197, 161}},
			},
			want: cpuState{
				D:   [8]uint32{2253782106, 737149875, 4273674890, 865167825, 4015861447, 4027163114, 1662341325, 3733109423},
				A:   [7]uint32{3638012439, 277237113, 867479731, 972908219, 1455078264, 2419495580, 2971085724},
				PC:  15553198,
				SR:  41993,
				USP: 7602458,
				SSP: 7797492,
				RAM: [][2]uint32{{15553192, 229}, {15553193, 191}, {15553194, 164}, {15553195, 201}, {15553196, 219}, {15553197, 161}},
				Cycles: 28,
			},
		},
		{
			name: "2000 ROL.l D5, D6 ebbe",
			init: cpuState{
				D:   [8]uint32{1412189718, 69201572, 1425279619, 3272022042, 1412924640, 2201067626, 511401459, 2713412758},
				A:   [7]uint32{1626344863, 2613110879, 3370085688, 3020014427, 1523863605, 1901878954, 1095374341},
				PC:  3211150,
				SR:  1303,
				USP: 15172950,
				SSP: 10775196,
				RAM: [][2]uint32{{3211146, 235}, {3211147, 190}, {3211148, 149}, {3211149, 103}, {3211150, 165}, {3211151, 138}},
			},
			want: cpuState{
				D:   [8]uint32{1412189718, 69201572, 1425279619, 3272022042, 1412924640, 2201067626, 3984051321, 2713412758},
				A:   [7]uint32{1626344863, 2613110879, 3370085688, 3020014427, 1523863605, 1901878954, 1095374341},
				PC:  3211152,
				SR:  1305,
				USP: 15172950,
				SSP: 10775196,
				RAM: [][2]uint32{{3211146, 235}, {3211147, 190}, {3211148, 149}, {3211149, 103}, {3211150, 165}, {3211151, 138}},
				Cycles: 92,
			},
		},
		{
			name: "001 ROL.l D3, D5 e7bd",
			init: 			cpuState{
				D:   [8]uint32{4191420782, 467690294, 3000930876, 714533594, 3912049031, 3801835082, 2147659231, 4018753994},
				A:   [7]uint32{1517124845, 1829728849, 628612816, 1944057153, 1583612400, 558730882, 920210453},
				PC:  12669390,
				SR:  8978,
				USP: 12956534,
				SSP: 10720096,
				RAM: [][2]uint32{{12669386, 231}, {12669387, 189}, {12669388, 101}, {12669389, 165}, {12669390, 47}, {12669391, 148}},
			},
			want: 			cpuState{
				D:   [8]uint32{4191420782, 467690294, 3000930876, 714533594, 3912049031, 730492313, 2147659231, 4018753994},
				A:   [7]uint32{1517124845, 1829728849, 628612816, 1944057153, 1583612400, 558730882, 920210453},
				PC:  12669392,
				SR:  8977,
				USP: 12956534,
				SSP: 10720096,
				RAM: [][2]uint32{{12669386, 231}, {12669387, 189}, {12669388, 101}, {12669389, 165}, {12669390, 47}, {12669391, 148}},
				Cycles: 60,
			},
		},
		{
			name: "296 ROL.l D3, D3 e7bb",
			init: 			cpuState{
				D:   [8]uint32{125643033, 946693602, 1351975245, 2184282523, 1386413957, 140717027, 857395782, 3268914047},
				A:   [7]uint32{1055417062, 1244635397, 2302069787, 2636088479, 1752157956, 3221679786, 1198237839},
				PC:  15379648,
				SR:  8199,
				USP: 16279648,
				SSP: 11252450,
				RAM: [][2]uint32{{15379644, 231}, {15379645, 187}, {15379646, 41}, {15379647, 195}, {15379648, 95}, {15379649, 144}},
			},
			want: 			cpuState{
				D:   [8]uint32{125643033, 946693602, 1351975245, 3692137484, 1386413957, 140717027, 857395782, 3268914047},
				A:   [7]uint32{1055417062, 1244635397, 2302069787, 2636088479, 1752157956, 3221679786, 1198237839},
				PC:  15379650,
				SR:  8200,
				USP: 16279648,
				SSP: 11252450,
				RAM: [][2]uint32{{15379644, 231}, {15379645, 187}, {15379646, 41}, {15379647, 195}, {15379648, 95}, {15379649, 144}},
				Cycles: 62,
			},
		},
		{
			name: "582 ROL.l 1, D6 e39e",
			init: 			cpuState{
				D:   [8]uint32{2589990364, 1061554412, 3893529307, 318557053, 2944433584, 3535830742, 2872631022, 2268292414},
				A:   [7]uint32{2774593239, 3239616696, 3783478766, 4057171754, 676087062, 3083374257, 71632482},
				PC:  4121560,
				SR:  1554,
				USP: 705814,
				SSP: 5781880,
				RAM: [][2]uint32{{4121556, 227}, {4121557, 158}, {4121558, 101}, {4121559, 241}, {4121560, 124}, {4121561, 157}},
			},
			want: 			cpuState{
				D:   [8]uint32{2589990364, 1061554412, 3893529307, 318557053, 2944433584, 3535830742, 1450294749, 2268292414},
				A:   [7]uint32{2774593239, 3239616696, 3783478766, 4057171754, 676087062, 3083374257, 71632482},
				PC:  4121562,
				SR:  1553,
				USP: 705814,
				SSP: 5781880,
				RAM: [][2]uint32{{4121556, 227}, {4121557, 158}, {4121558, 101}, {4121559, 241}, {4121560, 124}, {4121561, 157}},
				Cycles: 10,
			},
		},
		{
			name: "837 ROL.l 3, D0 e798",
			init: 			cpuState{
				D:   [8]uint32{1233148901, 2875819413, 2765633186, 982226327, 1818409878, 3374283416, 2462699501, 1319199109},
				A:   [7]uint32{4144011932, 228709273, 1199008506, 517099754, 4028985998, 200493369, 3398202547},
				PC:  2792708,
				SR:  8469,
				USP: 3778032,
				SSP: 13015022,
				RAM: [][2]uint32{{2792704, 231}, {2792705, 152}, {2792706, 103}, {2792707, 7}, {2792708, 103}, {2792709, 234}},
			},
			want: 			cpuState{
				D:   [8]uint32{1275256618, 2875819413, 2765633186, 982226327, 1818409878, 3374283416, 2462699501, 1319199109},
				A:   [7]uint32{4144011932, 228709273, 1199008506, 517099754, 4028985998, 200493369, 3398202547},
				PC:  2792710,
				SR:  8464,
				USP: 3778032,
				SSP: 13015022,
				RAM: [][2]uint32{{2792704, 231}, {2792705, 152}, {2792706, 103}, {2792707, 7}, {2792708, 103}, {2792709, 234}},
				Cycles: 14,
			},
		},
		{
			name: "1112 ROL.l D4, D0 e9b8",
			init: 			cpuState{
				D:   [8]uint32{1487183047, 808983395, 3700307472, 683811372, 3553332365, 3677802937, 3843828777, 2383932409},
				A:   [7]uint32{1612991858, 1874458036, 1605835551, 2502217209, 2510145055, 2071014050, 1662975947},
				PC:  10725654,
				SR:  1297,
				USP: 15674630,
				SSP: 9656080,
				RAM: [][2]uint32{{10725650, 233}, {10725651, 184}, {10725652, 137}, {10725653, 169}, {10725654, 83}, {10725655, 195}},
			},
			want: 			cpuState{
				D:   [8]uint32{2476272404, 808983395, 3700307472, 683811372, 3553332365, 3677802937, 3843828777, 2383932409},
				A:   [7]uint32{1612991858, 1874458036, 1605835551, 2502217209, 2510145055, 2071014050, 1662975947},
				PC:  10725656,
				SR:  1304,
				USP: 15674630,
				SSP: 9656080,
				RAM: [][2]uint32{{10725650, 233}, {10725651, 184}, {10725652, 137}, {10725653, 169}, {10725654, 83}, {10725655, 195}},
				Cycles: 34,
			},
		},
		{
			name: "1403 ROL.l D6, D4 edbc",
			init: 			cpuState{
				D:   [8]uint32{2364289638, 4203284414, 437450620, 769958797, 1183643822, 527925871, 3090812886, 2212957841},
				A:   [7]uint32{908906603, 1184399524, 669605336, 2185055673, 2083009675, 2462514104, 2958211954},
				PC:  2166072,
				SR:  9230,
				USP: 9528604,
				SSP: 5983014,
				RAM: [][2]uint32{{2166068, 237}, {2166069, 188}, {2166070, 57}, {2166071, 40}, {2166072, 189}, {2166073, 151}},
			},
			want: 			cpuState{
				D:   [8]uint32{2364289638, 4203284414, 437450620, 769958797, 730964798, 527925871, 3090812886, 2212957841},
				A:   [7]uint32{908906603, 1184399524, 669605336, 2185055673, 2083009675, 2462514104, 2958211954},
				PC:  2166074,
				SR:  9216,
				USP: 9528604,
				SSP: 5983014,
				RAM: [][2]uint32{{2166068, 237}, {2166069, 188}, {2166070, 57}, {2166071, 40}, {2166072, 189}, {2166073, 151}},
				Cycles: 52,
			},
		},
		{
			name: "1682 ROL.l 4, D6 e99e",
			init: 			cpuState{
				D:   [8]uint32{2760556005, 485527891, 2914158842, 4065279951, 394514096, 475629406, 1133764513, 3967968113},
				A:   [7]uint32{4224796127, 776979287, 4211251280, 542252303, 2711910324, 1258751324, 1957488041},
				PC:  16338844,
				SR:  269,
				USP: 9338914,
				SSP: 841388,
				RAM: [][2]uint32{{16338840, 233}, {16338841, 158}, {16338842, 17}, {16338843, 6}, {16338844, 152}, {16338845, 41}},
			},
			want: 			cpuState{
				D:   [8]uint32{2760556005, 485527891, 2914158842, 4065279951, 394514096, 475629406, 960363028, 3967968113},
				A:   [7]uint32{4224796127, 776979287, 4211251280, 542252303, 2711910324, 1258751324, 1957488041},
				PC:  16338846,
				SR:  256,
				USP: 9338914,
				SSP: 841388,
				RAM: [][2]uint32{{16338840, 233}, {16338841, 158}, {16338842, 17}, {16338843, 6}, {16338844, 152}, {16338845, 41}},
				Cycles: 16,
			},
		},
		{
			name: "1965 ROL.l D1, D5 e3bd",
			init: 			cpuState{
				D:   [8]uint32{2286926944, 3275367717, 1514901002, 963997606, 3249630169, 1145998516, 1438760662, 4166185541},
				A:   [7]uint32{2551291089, 3653711563, 4252812800, 1702530256, 208794709, 390957463, 3288023057},
				PC:  11835184,
				SR:  1558,
				USP: 5064000,
				SSP: 283446,
				RAM: [][2]uint32{{11835180, 227}, {11835181, 189}, {11835182, 173}, {11835183, 60}, {11835184, 88}, {11835185, 132}},
			},
			want: 			cpuState{
				D:   [8]uint32{2286926944, 3275367717, 1514901002, 963997606, 3249630169, 2312214152, 1438760662, 4166185541},
				A:   [7]uint32{2551291089, 3653711563, 4252812800, 1702530256, 208794709, 390957463, 3288023057},
				PC:  11835186,
				SR:  1560,
				USP: 5064000,
				SSP: 283446,
				RAM: [][2]uint32{{11835180, 227}, {11835181, 189}, {11835182, 173}, {11835183, 60}, {11835184, 88}, {11835185, 132}},
				Cycles: 82,
			},
		},
		{
			name: "2230 ROL.l D4, D5 e9bd",
			init: 			cpuState{
				D:   [8]uint32{4282494101, 3531887641, 1277102784, 1797540989, 1791362625, 3628541310, 1405550599, 401652899},
				A:   [7]uint32{2442763998, 3741382935, 3220927078, 1687115561, 3494673177, 165003942, 2863485949},
				PC:  7841248,
				SR:  779,
				USP: 13215016,
				SSP: 15991596,
				RAM: [][2]uint32{{7841244, 233}, {7841245, 189}, {7841246, 100}, {7841247, 61}, {7841248, 67}, {7841249, 160}},
			},
			want: 			cpuState{
				D:   [8]uint32{4282494101, 3531887641, 1277102784, 1797540989, 1791362625, 2962115325, 1405550599, 401652899},
				A:   [7]uint32{2442763998, 3741382935, 3220927078, 1687115561, 3494673177, 165003942, 2863485949},
				PC:  7841250,
				SR:  777,
				USP: 13215016,
				SSP: 15991596,
				RAM: [][2]uint32{{7841244, 233}, {7841245, 189}, {7841246, 100}, {7841247, 61}, {7841248, 67}, {7841249, 160}},
				Cycles: 10,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROR.b D2, D7 e43f",
			init: cpuState{
				D:   [8]uint32{938820907, 1515088277, 3708817845, 2506402469, 1004564263, 2756647632, 2415828783, 960861207},
				A:   [7]uint32{714598688, 64111565, 2830271819, 4221314877, 656614737, 2026516189, 469208339},
				PC:  5496490,
				SR:  768,
				USP: 1115320,
				SSP: 8119602,
				RAM: [][2]uint32{{5496486, 228}, {5496487, 63}, {5496488, 39}, {5496489, 60}, {5496490, 165}, {5496491, 194}},
			},
			want: cpuState{
				D:   [8]uint32{938820907, 1515088277, 3708817845, 2506402469, 1004564263, 2756647632, 2415828783, 960861368},
				A:   [7]uint32{714598688, 64111565, 2830271819, 4221314877, 656614737, 2026516189, 469208339},
				PC:  5496492,
				SR:  777,
				USP: 1115320,
				SSP: 8119602,
				RAM: [][2]uint32{{5496486, 228}, {5496487, 63}, {5496488, 39}, {5496489, 60}, {5496490, 165}, {5496491, 194}},
				Cycles: 112,
			},
		},
		{
			name: "500 ROR.b D3, D4 e63c",
			init: cpuState{
				D:   [8]uint32{158705526, 673412537, 2485851177, 192535299, 801442153, 3168844387, 968758883, 3519451289},
				A:   [7]uint32{149563298, 4025417913, 211509840, 3921793794, 434416538, 3740045938, 3857974199},
				PC:  13348262,
				SR:  33031,
				USP: 11521540,
				SSP: 8584574,
				RAM: [][2]uint32{{13348258, 230}, {13348259, 60}, {13348260, 127}, {13348261, 73}, {13348262, 120}, {13348263, 20}},
			},
			want: cpuState{
				D:   [8]uint32{158705526, 673412537, 2485851177, 192535299, 801442093, 3168844387, 968758883, 3519451289},
				A:   [7]uint32{149563298, 4025417913, 211509840, 3921793794, 434416538, 3740045938, 3857974199},
				PC:  13348264,
				SR:  33024,
				USP: 11521540,
				SSP: 8584574,
				RAM: [][2]uint32{{13348258, 230}, {13348259, 60}, {13348260, 127}, {13348261, 73}, {13348262, 120}, {13348263, 20}},
				Cycles: 12,
			},
		},
		{
			name: "1000 ROR.b 3, D1 e619",
			init: cpuState{
				D:   [8]uint32{3635670563, 313263290, 3021912349, 1879008252, 4148491839, 3278672074, 3815483119, 812757996},
				A:   [7]uint32{1837332243, 3294154776, 414310313, 2020808964, 542759741, 844171455, 3218797941},
				PC:  13884740,
				SR:  9745,
				USP: 12497318,
				SSP: 12721830,
				RAM: [][2]uint32{{13884736, 230}, {13884737, 25}, {13884738, 100}, {13884739, 174}, {13884740, 136}, {13884741, 210}},
			},
			want: cpuState{
				D:   [8]uint32{3635670563, 313263191, 3021912349, 1879008252, 4148491839, 3278672074, 3815483119, 812757996},
				A:   [7]uint32{1837332243, 3294154776, 414310313, 2020808964, 542759741, 844171455, 3218797941},
				PC:  13884742,
				SR:  9744,
				USP: 12497318,
				SSP: 12721830,
				RAM: [][2]uint32{{13884736, 230}, {13884737, 25}, {13884738, 100}, {13884739, 174}, {13884740, 136}, {13884741, 210}},
				Cycles: 12,
			},
		},
		{
			name: "1500 ROR.b D6, D0 ec38",
			init: cpuState{
				D:   [8]uint32{3835500300, 3338531280, 158715761, 1182820410, 338908788, 3299353751, 1775356906, 2629496226},
				A:   [7]uint32{455855848, 2150862286, 3182415973, 337689196, 809226083, 3066454891, 1544438416},
				PC:  11342784,
				SR:  41752,
				USP: 15840816,
				SSP: 9436760,
				RAM: [][2]uint32{{11342780, 236}, {11342781, 56}, {11342782, 185}, {11342783, 245}, {11342784, 13}, {11342785, 101}},
			},
			want: cpuState{
				D:   [8]uint32{3835500291, 3338531280, 158715761, 1182820410, 338908788, 3299353751, 1775356906, 2629496226},
				A:   [7]uint32{455855848, 2150862286, 3182415973, 337689196, 809226083, 3066454891, 1544438416},
				PC:  11342786,
				SR:  41744,
				USP: 15840816,
				SSP: 9436760,
				RAM: [][2]uint32{{11342780, 236}, {11342781, 56}, {11342782, 185}, {11342783, 245}, {11342784, 13}, {11342785, 101}},
				Cycles: 90,
			},
		},
		{
			name: "2000 ROR.b 3, D4 e61c",
			init: cpuState{
				D:   [8]uint32{1673305482, 1959110684, 1430928225, 1296818593, 4063627594, 802635157, 1440580303, 72206861},
				A:   [7]uint32{474560963, 1828693886, 1012533870, 1991186618, 689526980, 2555260458, 2326555890},
				PC:  4523742,
				SR:  33052,
				USP: 11262972,
				SSP: 16654836,
				RAM: [][2]uint32{{4523738, 230}, {4523739, 28}, {4523740, 214}, {4523741, 73}, {4523742, 161}, {4523743, 43}},
			},
			want: cpuState{
				D:   [8]uint32{1673305482, 1959110684, 1430928225, 1296818593, 4063627593, 802635157, 1440580303, 72206861},
				A:   [7]uint32{474560963, 1828693886, 1012533870, 1991186618, 689526980, 2555260458, 2326555890},
				PC:  4523744,
				SR:  33040,
				USP: 11262972,
				SSP: 16654836,
				RAM: [][2]uint32{{4523738, 230}, {4523739, 28}, {4523740, 214}, {4523741, 73}, {4523742, 161}, {4523743, 43}},
				Cycles: 12,
			},
		},
		{
			name: "001 ROR.b 5, D0 ea18",
			init: 			cpuState{
				D:   [8]uint32{1318118034, 912639314, 3524891317, 1852095260, 1446792947, 2270725814, 2665380637, 3941658652},
				A:   [7]uint32{3635690657, 1684934312, 2447820435, 2709282239, 4181167793, 2502269528, 865942985},
				PC:  593968,
				SR:  1794,
				USP: 12645398,
				SSP: 6918628,
				RAM: [][2]uint32{{593964, 234}, {593965, 24}, {593966, 205}, {593967, 37}, {593968, 53}, {593969, 123}},
			},
			want: 			cpuState{
				D:   [8]uint32{1318118036, 912639314, 3524891317, 1852095260, 1446792947, 2270725814, 2665380637, 3941658652},
				A:   [7]uint32{3635690657, 1684934312, 2447820435, 2709282239, 4181167793, 2502269528, 865942985},
				PC:  593970,
				SR:  1801,
				USP: 12645398,
				SSP: 6918628,
				RAM: [][2]uint32{{593964, 234}, {593965, 24}, {593966, 205}, {593967, 37}, {593968, 53}, {593969, 123}},
				Cycles: 16,
			},
		},
		{
			name: "320 ROR.b 1, D3 e21b",
			init: 			cpuState{
				D:   [8]uint32{3393827836, 341225332, 1843682115, 3776380114, 2063173027, 530282219, 2670320438, 2964506209},
				A:   [7]uint32{3130751817, 2900314468, 861246523, 880383271, 4192684659, 224758507, 3028961131},
				PC:  1117286,
				SR:  8733,
				USP: 5842474,
				SSP: 5921924,
				RAM: [][2]uint32{{1117282, 226}, {1117283, 27}, {1117284, 78}, {1117285, 108}, {1117286, 100}, {1117287, 206}},
			},
			want: 			cpuState{
				D:   [8]uint32{3393827836, 341225332, 1843682115, 3776380009, 2063173027, 530282219, 2670320438, 2964506209},
				A:   [7]uint32{3130751817, 2900314468, 861246523, 880383271, 4192684659, 224758507, 3028961131},
				PC:  1117288,
				SR:  8720,
				USP: 5842474,
				SSP: 5921924,
				RAM: [][2]uint32{{1117282, 226}, {1117283, 27}, {1117284, 78}, {1117285, 108}, {1117286, 100}, {1117287, 206}},
				Cycles: 8,
			},
		},
		{
			name: "604 ROR.b 8, D0 e018",
			init: 			cpuState{
				D:   [8]uint32{3938116781, 3097027231, 2964866580, 3110695290, 2179060387, 791222849, 2181666094, 2977209512},
				A:   [7]uint32{4129450041, 1491413092, 956420544, 2315077497, 846156648, 1674294781, 3769509928},
				PC:  2380646,
				SR:  1797,
				USP: 15689900,
				SSP: 14258438,
				RAM: [][2]uint32{{2380642, 224}, {2380643, 24}, {2380644, 157}, {2380645, 80}, {2380646, 123}, {2380647, 223}},
			},
			want: 			cpuState{
				D:   [8]uint32{3938116781, 3097027231, 2964866580, 3110695290, 2179060387, 791222849, 2181666094, 2977209512},
				A:   [7]uint32{4129450041, 1491413092, 956420544, 2315077497, 846156648, 1674294781, 3769509928},
				PC:  2380648,
				SR:  1801,
				USP: 15689900,
				SSP: 14258438,
				RAM: [][2]uint32{{2380642, 224}, {2380643, 24}, {2380644, 157}, {2380645, 80}, {2380646, 123}, {2380647, 223}},
				Cycles: 22,
			},
		},
		{
			name: "874 ROR.b D5, D7 ea3f",
			init: 			cpuState{
				D:   [8]uint32{2549113331, 2782878796, 2199730892, 2312270583, 1783521330, 1849639734, 3445766009, 3604575416},
				A:   [7]uint32{218018432, 2602511377, 4125590940, 2484430832, 2866995680, 51731314, 1069733233},
				PC:  185244,
				SR:  9229,
				USP: 1001516,
				SSP: 9171820,
				RAM: [][2]uint32{{185240, 234}, {185241, 63}, {185242, 219}, {185243, 186}, {185244, 240}, {185245, 16}},
			},
			want: 			cpuState{
				D:   [8]uint32{2549113331, 2782878796, 2199730892, 2312270583, 1783521330, 1849639734, 3445766009, 3604575458},
				A:   [7]uint32{218018432, 2602511377, 4125590940, 2484430832, 2866995680, 51731314, 1069733233},
				PC:  185246,
				SR:  9225,
				USP: 1001516,
				SSP: 9171820,
				RAM: [][2]uint32{{185240, 234}, {185241, 63}, {185242, 219}, {185243, 186}, {185244, 240}, {185245, 16}},
				Cycles: 114,
			},
		},
		{
			name: "1161 ROR.b D7, D3 ee3b",
			init: 			cpuState{
				D:   [8]uint32{2249659580, 2216529531, 3169862895, 3979290054, 3053219532, 1379403937, 3005844772, 1645812901},
				A:   [7]uint32{4020212146, 1003713415, 1878603890, 1904660442, 1245445227, 2939226160, 837593466},
				PC:  8659932,
				SR:  1291,
				USP: 3705702,
				SSP: 2901966,
				RAM: [][2]uint32{{8659928, 238}, {8659929, 59}, {8659930, 133}, {8659931, 211}, {8659932, 22}, {8659933, 224}},
			},
			want: 			cpuState{
				D:   [8]uint32{2249659580, 2216529531, 3169862895, 3979289910, 3053219532, 1379403937, 3005844772, 1645812901},
				A:   [7]uint32{4020212146, 1003713415, 1878603890, 1904660442, 1245445227, 2939226160, 837593466},
				PC:  8659934,
				SR:  1280,
				USP: 3705702,
				SSP: 2901966,
				RAM: [][2]uint32{{8659928, 238}, {8659929, 59}, {8659930, 133}, {8659931, 211}, {8659932, 22}, {8659933, 224}},
				Cycles: 80,
			},
		},
		{
			name: "1421 ROR.b 2, D4 e41c",
			init: 			cpuState{
				D:   [8]uint32{4274457915, 1841303459, 1771126186, 620578102, 4259812605, 3536221765, 3920046678, 3326039558},
				A:   [7]uint32{2033110568, 879218039, 3287156553, 481081743, 1253717737, 302303635, 4234572376},
				PC:  12897764,
				SR:  281,
				USP: 4498398,
				SSP: 16466376,
				RAM: [][2]uint32{{12897760, 228}, {12897761, 28}, {12897762, 146}, {12897763, 67}, {12897764, 21}, {12897765, 236}},
			},
			want: 			cpuState{
				D:   [8]uint32{4274457915, 1841303459, 1771126186, 620578102, 4259812479, 3536221765, 3920046678, 3326039558},
				A:   [7]uint32{2033110568, 879218039, 3287156553, 481081743, 1253717737, 302303635, 4234572376},
				PC:  12897766,
				SR:  272,
				USP: 4498398,
				SSP: 16466376,
				RAM: [][2]uint32{{12897760, 228}, {12897761, 28}, {12897762, 146}, {12897763, 67}, {12897764, 21}, {12897765, 236}},
				Cycles: 10,
			},
		},
		{
			name: "1722 ROR.b D5, D3 ea3b",
			init: 			cpuState{
				D:   [8]uint32{2757859835, 244056686, 3225937938, 1774307567, 493158061, 1767680688, 1028921764, 1279969133},
				A:   [7]uint32{860496873, 2932361692, 228116170, 3072554059, 3790043805, 3044311251, 565737243},
				PC:  15680628,
				SR:  9481,
				USP: 11123100,
				SSP: 830052,
				RAM: [][2]uint32{{15680624, 234}, {15680625, 59}, {15680626, 222}, {15680627, 206}, {15680628, 137}, {15680629, 110}},
			},
			want: 			cpuState{
				D:   [8]uint32{2757859835, 244056686, 3225937938, 1774307567, 493158061, 1767680688, 1028921764, 1279969133},
				A:   [7]uint32{860496873, 2932361692, 228116170, 3072554059, 3790043805, 3044311251, 565737243},
				PC:  15680630,
				SR:  9481,
				USP: 11123100,
				SSP: 830052,
				RAM: [][2]uint32{{15680624, 234}, {15680625, 59}, {15680626, 222}, {15680627, 206}, {15680628, 137}, {15680629, 110}},
				Cycles: 102,
			},
		},
		{
			name: "1963 ROR.b 6, D5 ec1d",
			init: 			cpuState{
				D:   [8]uint32{1032163372, 3888155085, 1587693843, 3358839212, 1758385223, 1540587296, 4066095552, 616957566},
				A:   [7]uint32{2249094414, 3518630484, 2295915503, 808139679, 1024206908, 1678948854, 3724873583},
				PC:  8102586,
				SR:  8987,
				USP: 16646384,
				SSP: 14653104,
				RAM: [][2]uint32{{8102582, 236}, {8102583, 29}, {8102584, 93}, {8102585, 48}, {8102586, 23}, {8102587, 15}},
			},
			want: 			cpuState{
				D:   [8]uint32{1032163372, 3888155085, 1587693843, 3358839212, 1758385223, 1540587392, 4066095552, 616957566},
				A:   [7]uint32{2249094414, 3518630484, 2295915503, 808139679, 1024206908, 1678948854, 3724873583},
				PC:  8102588,
				SR:  8985,
				USP: 16646384,
				SSP: 14653104,
				RAM: [][2]uint32{{8102582, 236}, {8102583, 29}, {8102584, 93}, {8102585, 48}, {8102586, 23}, {8102587, 15}},
				Cycles: 18,
			},
		},
		{
			name: "2238 ROR.b 6, D5 ec1d",
			init: 			cpuState{
				D:   [8]uint32{2166364347, 1049079223, 317719394, 1291233176, 3451157928, 3386885986, 2518719250, 3075633319},
				A:   [7]uint32{1927327459, 3337470375, 3417272405, 4087093114, 1483264237, 4189946012, 1241590073},
				PC:  16474200,
				SR:  1794,
				USP: 13888704,
				SSP: 6851386,
				RAM: [][2]uint32{{16474196, 236}, {16474197, 29}, {16474198, 175}, {16474199, 216}, {16474200, 132}, {16474201, 186}},
			},
			want: 			cpuState{
				D:   [8]uint32{2166364347, 1049079223, 317719394, 1291233176, 3451157928, 3386886025, 2518719250, 3075633319},
				A:   [7]uint32{1927327459, 3337470375, 3417272405, 4087093114, 1483264237, 4189946012, 1241590073},
				PC:  16474202,
				SR:  1801,
				USP: 13888704,
				SSP: 6851386,
				RAM: [][2]uint32{{16474196, 236}, {16474197, 29}, {16474198, 175}, {16474199, 216}, {16474200, 132}, {16474201, 186}},
				Cycles: 18,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROR.w D4, D6 e87e",
			init: cpuState{
				D:   [8]uint32{690734105, 3676892, 941802545, 3235355852, 1423857177, 4279984995, 1253406463, 2433452530},
				A:   [7]uint32{3980864387, 2078453306, 3800170397, 260413823, 1210905091, 2630032364, 1471294024},
				PC:  8242006,
				SR:  40990,
				USP: 5724128,
				SSP: 13347118,
				RAM: [][2]uint32{{8242002, 232}, {8242003, 126}, {8242004, 29}, {8242005, 69}, {8242006, 144}, {8242007, 228}},
			},
			want: cpuState{
				D:   [8]uint32{690734105, 3676892, 941802545, 3235355852, 1423857177, 4279984995, 1253408699, 2433452530},
				A:   [7]uint32{3980864387, 2078453306, 3800170397, 260413823, 1210905091, 2630032364, 1471294024},
				PC:  8242008,
				SR:  40976,
				USP: 5724128,
				SSP: 13347118,
				RAM: [][2]uint32{{8242002, 232}, {8242003, 126}, {8242004, 29}, {8242005, 69}, {8242006, 144}, {8242007, 228}},
				Cycles: 56,
			},
		},
		{
			name: "500 ROR.w (xxx).l e6f9",
			init: cpuState{
				D:   [8]uint32{3602999141, 1013506157, 3738862774, 2427179377, 1001795172, 249234494, 1776984716, 3582429919},
				A:   [7]uint32{3621550820, 3746844677, 3469563172, 159910209, 2738470571, 2798836640, 3313564004},
				PC:  9657224,
				SR:  8221,
				USP: 9338140,
				SSP: 10729056,
				RAM: [][2]uint32{{9657220, 230}, {9657221, 249}, {9657222, 242}, {9657223, 10}, {9657224, 100}, {9657225, 80}, {9657226, 44}, {9657227, 90}, {681040, 25}, {681041, 134}, {9657228, 169}, {9657229, 252}},
			},
			want: cpuState{
				D:   [8]uint32{3602999141, 1013506157, 3738862774, 2427179377, 1001795172, 249234494, 1776984716, 3582429919},
				A:   [7]uint32{3621550820, 3746844677, 3469563172, 159910209, 2738470571, 2798836640, 3313564004},
				PC:  9657230,
				SR:  8208,
				USP: 9338140,
				SSP: 10729056,
				RAM: [][2]uint32{{9657220, 230}, {9657221, 249}, {9657222, 242}, {9657223, 10}, {9657224, 100}, {9657225, 80}, {9657226, 44}, {9657227, 90}, {681040, 12}, {681041, 195}, {9657228, 169}, {9657229, 252}},
				Cycles: 20,
			},
		},
		{
			name: "1000 ROR.w (d16, A2) e6ea",
			init: cpuState{
				D:   [8]uint32{1141107441, 1159196379, 1995006020, 2794193312, 688857601, 3622909966, 3463014773, 836898000},
				A:   [7]uint32{3114858915, 2481882052, 3296829709, 3071014225, 732749813, 3034296127, 1421080772},
				PC:  11352242,
				SR:  41991,
				USP: 11188848,
				SSP: 2598132,
				RAM: [][2]uint32{{11352238, 230}, {11352239, 234}, {11352240, 46}, {11352241, 69}, {11352242, 188}, {11352243, 129}, {8507218, 116}, {8507219, 2}, {11352244, 245}, {11352245, 83}},
			},
			want: cpuState{
				D:   [8]uint32{1141107441, 1159196379, 1995006020, 2794193312, 688857601, 3622909966, 3463014773, 836898000},
				A:   [7]uint32{3114858915, 2481882052, 3296829709, 3071014225, 732749813, 3034296127, 1421080772},
				PC:  11352246,
				SR:  41984,
				USP: 11188848,
				SSP: 2598132,
				RAM: [][2]uint32{{11352238, 230}, {11352239, 234}, {11352240, 46}, {11352241, 69}, {11352242, 188}, {11352243, 129}, {8507218, 58}, {8507219, 1}, {11352244, 245}, {11352245, 83}},
				Cycles: 16,
			},
		},
		{
			name: "1500 ROR.w 3, D7 e65f",
			init: cpuState{
				D:   [8]uint32{3877799049, 3269076379, 2930298438, 4129024050, 849393361, 1431161624, 1650364373, 224287479},
				A:   [7]uint32{3493043077, 267073808, 4125856047, 3166877361, 3630676677, 2498800809, 3564650071},
				PC:  5813912,
				SR:  8467,
				USP: 1443116,
				SSP: 15069912,
				RAM: [][2]uint32{{5813908, 230}, {5813909, 95}, {5813910, 37}, {5813911, 148}, {5813912, 130}, {5813913, 212}},
			},
			want: cpuState{
				D:   [8]uint32{3877799049, 3269076379, 2930298438, 4129024050, 849393361, 1431161624, 1650364373, 224324446},
				A:   [7]uint32{3493043077, 267073808, 4125856047, 3166877361, 3630676677, 2498800809, 3564650071},
				PC:  5813914,
				SR:  8473,
				USP: 1443116,
				SSP: 15069912,
				RAM: [][2]uint32{{5813908, 230}, {5813909, 95}, {5813910, 37}, {5813911, 148}, {5813912, 130}, {5813913, 212}},
				Cycles: 12,
			},
		},
		{
			name: "2000 ROR.w (d16, A6) e6ee",
			init: cpuState{
				D:   [8]uint32{1806189905, 1936544932, 2253819075, 4166975612, 290533509, 2710853715, 933643528, 1667977469},
				A:   [7]uint32{4248998968, 1659104091, 3211346819, 4058757946, 1593762188, 179400713, 3850348527},
				PC:  1573604,
				SR:  9231,
				USP: 11739050,
				SSP: 4381460,
				RAM: [][2]uint32{{1573600, 230}, {1573601, 238}, {1573602, 183}, {1573603, 127}, {1573604, 16}, {1573605, 249}, {8347502, 126}, {8347503, 82}, {1573606, 186}, {1573607, 201}},
			},
			want: cpuState{
				D:   [8]uint32{1806189905, 1936544932, 2253819075, 4166975612, 290533509, 2710853715, 933643528, 1667977469},
				A:   [7]uint32{4248998968, 1659104091, 3211346819, 4058757946, 1593762188, 179400713, 3850348527},
				PC:  1573608,
				SR:  9216,
				USP: 11739050,
				SSP: 4381460,
				RAM: [][2]uint32{{1573600, 230}, {1573601, 238}, {1573602, 183}, {1573603, 127}, {1573604, 16}, {1573605, 249}, {8347502, 63}, {8347503, 41}, {1573606, 186}, {1573607, 201}},
				Cycles: 16,
			},
		},
		{
			name: "001 ROR.w 5, D7 ea5f",
			init: 			cpuState{
				D:   [8]uint32{4264078083, 1968210655, 2938360070, 2690797858, 19283932, 3917402659, 2619466845, 1304490938},
				A:   [7]uint32{4214750110, 586608943, 2322335649, 3001515485, 2030930177, 3156453548, 1712887947},
				PC:  12808922,
				SR:  534,
				USP: 4589602,
				SSP: 7176076,
				RAM: [][2]uint32{{12808918, 234}, {12808919, 95}, {12808920, 137}, {12808921, 110}, {12808922, 86}, {12808923, 0}},
			},
			want: 			cpuState{
				D:   [8]uint32{4264078083, 1968210655, 2938360070, 2690797858, 19283932, 3917402659, 2619466845, 1304483741},
				A:   [7]uint32{4214750110, 586608943, 2322335649, 3001515485, 2030930177, 3156453548, 1712887947},
				PC:  12808924,
				SR:  537,
				USP: 4589602,
				SSP: 7176076,
				RAM: [][2]uint32{{12808918, 234}, {12808919, 95}, {12808920, 137}, {12808921, 110}, {12808922, 86}, {12808923, 0}},
				Cycles: 16,
			},
		},
		{
			name: "293 ROR.w 4, D7 e85f",
			init: 			cpuState{
				D:   [8]uint32{3777149098, 1952288287, 613688192, 3454903138, 2347007555, 1776752926, 2966038013, 800791983},
				A:   [7]uint32{889388207, 2700047158, 1967914654, 4262344320, 2352971275, 919722609, 3596588430},
				PC:  6666572,
				SR:  259,
				USP: 14911304,
				SSP: 9565672,
				RAM: [][2]uint32{{6666568, 232}, {6666569, 95}, {6666570, 81}, {6666571, 175}, {6666572, 55}, {6666573, 240}},
			},
			want: 			cpuState{
				D:   [8]uint32{3777149098, 1952288287, 613688192, 3454903138, 2347007555, 1776752926, 2966038013, 800846298},
				A:   [7]uint32{889388207, 2700047158, 1967914654, 4262344320, 2352971275, 919722609, 3596588430},
				PC:  6666574,
				SR:  265,
				USP: 14911304,
				SSP: 9565672,
				RAM: [][2]uint32{{6666568, 232}, {6666569, 95}, {6666570, 81}, {6666571, 175}, {6666572, 55}, {6666573, 240}},
				Cycles: 14,
			},
		},
		{
			name: "553 ROR.w 7, D1 ee59",
			init: 			cpuState{
				D:   [8]uint32{2631710271, 732795113, 863558182, 1733909203, 3476011259, 406560246, 3976095061, 2385917503},
				A:   [7]uint32{1130436501, 2845164010, 3503521223, 2717395424, 1331787483, 953060339, 1743827125},
				PC:  523942,
				SR:  9498,
				USP: 14419908,
				SSP: 3696012,
				RAM: [][2]uint32{{523938, 238}, {523939, 89}, {523940, 241}, {523941, 199}, {523942, 63}, {523943, 112}},
			},
			want: 			cpuState{
				D:   [8]uint32{2631710271, 732812065, 863558182, 1733909203, 3476011259, 406560246, 3976095061, 2385917503},
				A:   [7]uint32{1130436501, 2845164010, 3503521223, 2717395424, 1331787483, 953060339, 1743827125},
				PC:  523944,
				SR:  9497,
				USP: 14419908,
				SSP: 3696012,
				RAM: [][2]uint32{{523938, 238}, {523939, 89}, {523940, 241}, {523941, 199}, {523942, 63}, {523943, 112}},
				Cycles: 20,
			},
		},
		{
			name: "828 ROR.w (A7)+ e6df",
			init: 			cpuState{
				D:   [8]uint32{2126205588, 1106567748, 1174685784, 1081403319, 957760170, 1439834126, 2137232467, 3583197792},
				A:   [7]uint32{265783627, 3389430469, 2608459411, 532333778, 3308559179, 110290443, 903125003},
				PC:  6095188,
				SR:  1811,
				USP: 13208280,
				SSP: 12545722,
				RAM: [][2]uint32{{6095184, 230}, {6095185, 223}, {6095186, 227}, {6095187, 29}, {13208280, 149}, {13208281, 28}, {6095188, 169}, {6095189, 107}},
			},
			want: 			cpuState{
				D:   [8]uint32{2126205588, 1106567748, 1174685784, 1081403319, 957760170, 1439834126, 2137232467, 3583197792},
				A:   [7]uint32{265783627, 3389430469, 2608459411, 532333778, 3308559179, 110290443, 903125003},
				PC:  6095190,
				SR:  1808,
				USP: 13208282,
				SSP: 12545722,
				RAM: [][2]uint32{{6095184, 230}, {6095185, 223}, {6095186, 227}, {6095187, 29}, {13208280, 74}, {13208281, 142}, {6095188, 169}, {6095189, 107}},
				Cycles: 12,
			},
		},
		{
			name: "1061 ROR.w 4, D7 e85f",
			init: 			cpuState{
				D:   [8]uint32{3128459690, 2800460634, 1988751894, 203259896, 3335722606, 668983303, 1140257149, 2171176853},
				A:   [7]uint32{793691164, 4250686526, 3001237064, 4267882310, 1714738243, 1566278948, 1906339595},
				PC:  7128312,
				SR:  8712,
				USP: 3344338,
				SSP: 1875342,
				RAM: [][2]uint32{{7128308, 232}, {7128309, 95}, {7128310, 187}, {7128311, 165}, {7128312, 164}, {7128313, 234}},
			},
			want: 			cpuState{
				D:   [8]uint32{3128459690, 2800460634, 1988751894, 203259896, 3335722606, 668983303, 1140257149, 2171164793},
				A:   [7]uint32{793691164, 4250686526, 3001237064, 4267882310, 1714738243, 1566278948, 1906339595},
				PC:  7128314,
				SR:  8704,
				USP: 3344338,
				SSP: 1875342,
				RAM: [][2]uint32{{7128308, 232}, {7128309, 95}, {7128310, 187}, {7128311, 165}, {7128312, 164}, {7128313, 234}},
				Cycles: 14,
			},
		},
		{
			name: "1347 ROR.w 4, D5 e85d",
			init: 			cpuState{
				D:   [8]uint32{169992596, 1534239807, 1154040290, 2664297031, 3631626694, 3560920373, 3679814839, 2685058350},
				A:   [7]uint32{2063400016, 3008764388, 2664082388, 2666822226, 1615835786, 2005182547, 2039411094},
				PC:  5088422,
				SR:  31,
				USP: 5520266,
				SSP: 2611806,
				RAM: [][2]uint32{{5088418, 232}, {5088419, 93}, {5088420, 252}, {5088421, 189}, {5088422, 214}, {5088423, 206}},
			},
			want: 			cpuState{
				D:   [8]uint32{169992596, 1534239807, 1154040290, 2664297031, 3631626694, 3560920403, 3679814839, 2685058350},
				A:   [7]uint32{2063400016, 3008764388, 2664082388, 2666822226, 1615835786, 2005182547, 2039411094},
				PC:  5088424,
				SR:  16,
				USP: 5520266,
				SSP: 2611806,
				RAM: [][2]uint32{{5088418, 232}, {5088419, 93}, {5088420, 252}, {5088421, 189}, {5088422, 214}, {5088423, 206}},
				Cycles: 14,
			},
		},
		{
			name: "1635 ROR.w D5, D4 ea7c",
			init: 			cpuState{
				D:   [8]uint32{2934545925, 2046762117, 2276420984, 1964559277, 4048828008, 2755113490, 1574516386, 3504465826},
				A:   [7]uint32{35586102, 601265961, 1332896969, 4033439372, 3201469593, 880054556, 893575412},
				PC:  16445254,
				SR:  1298,
				USP: 1735894,
				SSP: 10786366,
				RAM: [][2]uint32{{16445250, 234}, {16445251, 124}, {16445252, 118}, {16445253, 148}, {16445254, 16}, {16445255, 72}},
			},
			want: 			cpuState{
				D:   [8]uint32{2934545925, 2046762117, 2276420984, 1964559277, 4048817562, 2755113490, 1574516386, 3504465826},
				A:   [7]uint32{35586102, 601265961, 1332896969, 4033439372, 3201469593, 880054556, 893575412},
				PC:  16445256,
				SR:  1296,
				USP: 1735894,
				SSP: 10786366,
				RAM: [][2]uint32{{16445250, 234}, {16445251, 124}, {16445252, 118}, {16445253, 148}, {16445254, 16}, {16445255, 72}},
				Cycles: 42,
			},
		},
		{
			name: "1908 ROR.w 3, D7 e65f",
			init: 			cpuState{
				D:   [8]uint32{991663288, 767600748, 3569318413, 3992146137, 2916416722, 1675758457, 1906953335, 3946639797},
				A:   [7]uint32{3581684061, 2847069925, 1733652240, 200835864, 1384606121, 2363535913, 1813136482},
				PC:  1136190,
				SR:  1304,
				USP: 5844074,
				SSP: 1595930,
				RAM: [][2]uint32{{1136186, 230}, {1136187, 95}, {1136188, 241}, {1136189, 114}, {1136190, 80}, {1136191, 86}},
			},
			want: 			cpuState{
				D:   [8]uint32{991663288, 767600748, 3569318413, 3992146137, 2916416722, 1675758457, 1906953335, 3946626614},
				A:   [7]uint32{3581684061, 2847069925, 1733652240, 200835864, 1384606121, 2363535913, 1813136482},
				PC:  1136192,
				SR:  1305,
				USP: 5844074,
				SSP: 1595930,
				RAM: [][2]uint32{{1136186, 230}, {1136187, 95}, {1136188, 241}, {1136189, 114}, {1136190, 80}, {1136191, 86}},
				Cycles: 12,
			},
		},
		{
			name: "2209 ROR.w (A5)+ e6dd",
			init: 			cpuState{
				D:   [8]uint32{1999646656, 1399003579, 69208745, 1699680845, 1675519007, 828083037, 3471814013, 3312609356},
				A:   [7]uint32{2127070593, 1179166304, 3200635282, 3664718099, 2584388563, 2665516454, 715790871},
				PC:  6953076,
				SR:  797,
				USP: 1125592,
				SSP: 5699614,
				RAM: [][2]uint32{{6953072, 230}, {6953073, 221}, {6953074, 98}, {6953075, 157}, {14716326, 188}, {14716327, 178}, {6953076, 56}, {6953077, 31}},
			},
			want: 			cpuState{
				D:   [8]uint32{1999646656, 1399003579, 69208745, 1699680845, 1675519007, 828083037, 3471814013, 3312609356},
				A:   [7]uint32{2127070593, 1179166304, 3200635282, 3664718099, 2584388563, 2665516456, 715790871},
				PC:  6953078,
				SR:  784,
				USP: 1125592,
				SSP: 5699614,
				RAM: [][2]uint32{{6953072, 230}, {6953073, 221}, {6953074, 98}, {6953075, 157}, {14716326, 94}, {14716327, 89}, {6953076, 56}, {6953077, 31}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROR.l 8, D7 e09f",
			init: cpuState{
				D:   [8]uint32{2524685064, 4113957086, 995541485, 52428502, 2827781911, 1326447816, 612819895, 4034337311},
				A:   [7]uint32{2655973454, 223370409, 333792192, 3637965723, 1602637634, 1216760314, 369516563},
				PC:  11946118,
				SR:  34078,
				USP: 9798282,
				SSP: 6026594,
				RAM: [][2]uint32{{11946114, 224}, {11946115, 159}, {11946116, 246}, {11946117, 250}, {11946118, 16}, {11946119, 110}},
			},
			want: cpuState{
				D:   [8]uint32{2524685064, 4113957086, 995541485, 52428502, 2827781911, 1326447816, 612819895, 535852826},
				A:   [7]uint32{2655973454, 223370409, 333792192, 3637965723, 1602637634, 1216760314, 369516563},
				PC:  11946120,
				SR:  34064,
				USP: 9798282,
				SSP: 6026594,
				RAM: [][2]uint32{{11946114, 224}, {11946115, 159}, {11946116, 246}, {11946117, 250}, {11946118, 16}, {11946119, 110}},
				Cycles: 24,
			},
		},
		{
			name: "500 ROR.l 1, D1 e299",
			init: cpuState{
				D:   [8]uint32{2922202245, 2041759849, 833896723, 1926105083, 3088400848, 4208246586, 537450674, 911140969},
				A:   [7]uint32{3491104020, 1546681717, 1726213927, 1408250068, 1643205213, 3700841183, 2903764632},
				PC:  1362668,
				SR:  41733,
				USP: 10495604,
				SSP: 7549260,
				RAM: [][2]uint32{{1362664, 226}, {1362665, 153}, {1362666, 208}, {1362667, 103}, {1362668, 181}, {1362669, 229}},
			},
			want: cpuState{
				D:   [8]uint32{2922202245, 3168363572, 833896723, 1926105083, 3088400848, 4208246586, 537450674, 911140969},
				A:   [7]uint32{3491104020, 1546681717, 1726213927, 1408250068, 1643205213, 3700841183, 2903764632},
				PC:  1362670,
				SR:  41737,
				USP: 10495604,
				SSP: 7549260,
				RAM: [][2]uint32{{1362664, 226}, {1362665, 153}, {1362666, 208}, {1362667, 103}, {1362668, 181}, {1362669, 229}},
				Cycles: 10,
			},
		},
		{
			name: "1000 ROR.l 3, D2 e69a",
			init: cpuState{
				D:   [8]uint32{763511447, 3988262877, 1407121522, 205477119, 1109150702, 501704758, 4049494661, 2596061461},
				A:   [7]uint32{413640780, 3331076188, 419745247, 1598349660, 2983642162, 4013909675, 1306642915},
				PC:  13668146,
				SR:  42767,
				USP: 4872634,
				SSP: 5118912,
				RAM: [][2]uint32{{13668142, 230}, {13668143, 154}, {13668144, 95}, {13668145, 85}, {13668146, 238}, {13668147, 229}},
			},
			want: cpuState{
				D:   [8]uint32{763511447, 3988262877, 1249632014, 205477119, 1109150702, 501704758, 4049494661, 2596061461},
				A:   [7]uint32{413640780, 3331076188, 419745247, 1598349660, 2983642162, 4013909675, 1306642915},
				PC:  13668148,
				SR:  42752,
				USP: 4872634,
				SSP: 5118912,
				RAM: [][2]uint32{{13668142, 230}, {13668143, 154}, {13668144, 95}, {13668145, 85}, {13668146, 238}, {13668147, 229}},
				Cycles: 14,
			},
		},
		{
			name: "1500 ROR.l 2, D2 e49a",
			init: cpuState{
				D:   [8]uint32{1979296610, 3423980325, 587024736, 3736041091, 3267289120, 346030452, 186326304, 530726175},
				A:   [7]uint32{1603290857, 2369078138, 697625453, 3181513537, 1048071802, 1399810329, 2169235999},
				PC:  10218442,
				SR:  9234,
				USP: 13969986,
				SSP: 9025556,
				RAM: [][2]uint32{{10218438, 228}, {10218439, 154}, {10218440, 209}, {10218441, 128}, {10218442, 41}, {10218443, 110}},
			},
			want: cpuState{
				D:   [8]uint32{1979296610, 3423980325, 146756184, 3736041091, 3267289120, 346030452, 186326304, 530726175},
				A:   [7]uint32{1603290857, 2369078138, 697625453, 3181513537, 1048071802, 1399810329, 2169235999},
				PC:  10218444,
				SR:  9232,
				USP: 13969986,
				SSP: 9025556,
				RAM: [][2]uint32{{10218438, 228}, {10218439, 154}, {10218440, 209}, {10218441, 128}, {10218442, 41}, {10218443, 110}},
				Cycles: 12,
			},
		},
		{
			name: "2000 ROR.l 4, D1 e899",
			init: cpuState{
				D:   [8]uint32{341284151, 2736211504, 4290097651, 191216060, 324597591, 1322998442, 215262125, 2420262599},
				A:   [7]uint32{372862239, 1948490673, 1421139240, 3107214702, 442165390, 930365179, 3432634207},
				PC:  8002744,
				SR:  31,
				USP: 1094964,
				SSP: 12448046,
				RAM: [][2]uint32{{8002740, 232}, {8002741, 153}, {8002742, 107}, {8002743, 53}, {8002744, 92}, {8002745, 23}},
			},
			want: cpuState{
				D:   [8]uint32{341284151, 171013219, 4290097651, 191216060, 324597591, 1322998442, 215262125, 2420262599},
				A:   [7]uint32{372862239, 1948490673, 1421139240, 3107214702, 442165390, 930365179, 3432634207},
				PC:  8002746,
				SR:  16,
				USP: 1094964,
				SSP: 12448046,
				RAM: [][2]uint32{{8002740, 232}, {8002741, 153}, {8002742, 107}, {8002743, 53}, {8002744, 92}, {8002745, 23}},
				Cycles: 16,
			},
		},
		{
			name: "003 ROR.l D2, D4 e4bc",
			init: 			cpuState{
				D:   [8]uint32{2409902084, 1490509839, 2424478005, 114781881, 653414805, 471610392, 1093829343, 1718401344},
				A:   [7]uint32{3239674756, 1366801629, 3305826598, 2295702340, 1666442515, 1739587210, 4164426496},
				PC:  1905982,
				SR:  9478,
				USP: 4249018,
				SSP: 5642038,
				RAM: [][2]uint32{{1905978, 228}, {1905979, 188}, {1905980, 7}, {1905981, 207}, {1905982, 143}, {1905983, 225}},
			},
			want: 			cpuState{
				D:   [8]uint32{2409902084, 1490509839, 2424478005, 114781881, 2458691895, 471610392, 1093829343, 1718401344},
				A:   [7]uint32{3239674756, 1366801629, 3305826598, 2295702340, 1666442515, 1739587210, 4164426496},
				PC:  1905984,
				SR:  9481,
				USP: 4249018,
				SSP: 5642038,
				RAM: [][2]uint32{{1905978, 228}, {1905979, 188}, {1905980, 7}, {1905981, 207}, {1905982, 143}, {1905983, 225}},
				Cycles: 114,
			},
		},
		{
			name: "280 ROR.l D3, D0 e6b8",
			init: 			cpuState{
				D:   [8]uint32{3849651280, 1284390521, 2883338057, 1603508283, 1010063694, 4088169667, 2544468075, 1655700406},
				A:   [7]uint32{1684428805, 2576253332, 4176935490, 3227483143, 2831311448, 8447621, 3503394428},
				PC:  10943968,
				SR:  17,
				USP: 10727054,
				SSP: 1830140,
				RAM: [][2]uint32{{10943964, 230}, {10943965, 184}, {10943966, 96}, {10943967, 253}, {10943968, 207}, {10943969, 75}},
			},
			want: 			cpuState{
				D:   [8]uint32{2929756700, 1284390521, 2883338057, 1603508283, 1010063694, 4088169667, 2544468075, 1655700406},
				A:   [7]uint32{1684428805, 2576253332, 4176935490, 3227483143, 2831311448, 8447621, 3503394428},
				PC:  10943970,
				SR:  25,
				USP: 10727054,
				SSP: 1830140,
				RAM: [][2]uint32{{10943964, 230}, {10943965, 184}, {10943966, 96}, {10943967, 253}, {10943968, 207}, {10943969, 75}},
				Cycles: 126,
			},
		},
		{
			name: "582 ROR.l 3, D2 e69a",
			init: 			cpuState{
				D:   [8]uint32{2044948437, 2189065787, 198964671, 2680781899, 1293744035, 3726527074, 3391377045, 2014586515},
				A:   [7]uint32{1443542718, 1742391117, 4163978769, 3777244124, 3496102217, 3083625478, 1705564179},
				PC:  831474,
				SR:  8960,
				USP: 10476784,
				SSP: 5764846,
				RAM: [][2]uint32{{831470, 230}, {831471, 154}, {831472, 126}, {831473, 179}, {831474, 213}, {831475, 125}},
			},
			want: 			cpuState{
				D:   [8]uint32{2044948437, 2189065787, 3782966967, 2680781899, 1293744035, 3726527074, 3391377045, 2014586515},
				A:   [7]uint32{1443542718, 1742391117, 4163978769, 3777244124, 3496102217, 3083625478, 1705564179},
				PC:  831476,
				SR:  8969,
				USP: 10476784,
				SSP: 5764846,
				RAM: [][2]uint32{{831470, 230}, {831471, 154}, {831472, 126}, {831473, 179}, {831474, 213}, {831475, 125}},
				Cycles: 14,
			},
		},
		{
			name: "858 ROR.l 2, D3 e49b",
			init: 			cpuState{
				D:   [8]uint32{3170719238, 2572440795, 4068915323, 4096559077, 3583116514, 3612009237, 1675576475, 2416370446},
				A:   [7]uint32{1528710624, 4200686509, 1048231826, 3417156832, 2631217463, 3580735530, 2097970209},
				PC:  13133716,
				SR:  785,
				USP: 1396600,
				SSP: 11725848,
				RAM: [][2]uint32{{13133712, 228}, {13133713, 155}, {13133714, 32}, {13133715, 64}, {13133716, 220}, {13133717, 27}},
			},
			want: 			cpuState{
				D:   [8]uint32{3170719238, 2572440795, 4068915323, 2097881593, 3583116514, 3612009237, 1675576475, 2416370446},
				A:   [7]uint32{1528710624, 4200686509, 1048231826, 3417156832, 2631217463, 3580735530, 2097970209},
				PC:  13133718,
				SR:  784,
				USP: 1396600,
				SSP: 11725848,
				RAM: [][2]uint32{{13133712, 228}, {13133713, 155}, {13133714, 32}, {13133715, 64}, {13133716, 220}, {13133717, 27}},
				Cycles: 12,
			},
		},
		{
			name: "1134 ROR.l 6, D3 ec9b",
			init: 			cpuState{
				D:   [8]uint32{4150929807, 2675115531, 4162725439, 2329047899, 3081816083, 1164476599, 2287016286, 3532799712},
				A:   [7]uint32{3830439010, 1371718931, 3703733609, 2996155846, 2783986046, 2095095973, 2035358480},
				PC:  15387952,
				SR:  9740,
				USP: 12242820,
				SSP: 12660326,
				RAM: [][2]uint32{{15387948, 236}, {15387949, 155}, {15387950, 220}, {15387951, 221}, {15387952, 99}, {15387953, 116}},
			},
			want: 			cpuState{
				D:   [8]uint32{4150929807, 2675115531, 4162725439, 1848330701, 3081816083, 1164476599, 2287016286, 3532799712},
				A:   [7]uint32{3830439010, 1371718931, 3703733609, 2996155846, 2783986046, 2095095973, 2035358480},
				PC:  15387954,
				SR:  9728,
				USP: 12242820,
				SSP: 12660326,
				RAM: [][2]uint32{{15387948, 236}, {15387949, 155}, {15387950, 220}, {15387951, 221}, {15387952, 99}, {15387953, 116}},
				Cycles: 20,
			},
		},
		{
			name: "1436 ROR.l 2, D5 e49d",
			init: 			cpuState{
				D:   [8]uint32{979622098, 1036325707, 2919311685, 599793737, 217814565, 3501370721, 2184347035, 1155727602},
				A:   [7]uint32{1616909697, 3282587928, 1546310617, 4029979726, 3000506, 2131793871, 3594848172},
				PC:  8147308,
				SR:  8203,
				USP: 14921370,
				SSP: 12978414,
				RAM: [][2]uint32{{8147304, 228}, {8147305, 157}, {8147306, 107}, {8147307, 170}, {8147308, 12}, {8147309, 6}},
			},
			want: 			cpuState{
				D:   [8]uint32{979622098, 1036325707, 2919311685, 599793737, 217814565, 1949084504, 2184347035, 1155727602},
				A:   [7]uint32{1616909697, 3282587928, 1546310617, 4029979726, 3000506, 2131793871, 3594848172},
				PC:  8147310,
				SR:  8192,
				USP: 14921370,
				SSP: 12978414,
				RAM: [][2]uint32{{8147304, 228}, {8147305, 157}, {8147306, 107}, {8147307, 170}, {8147308, 12}, {8147309, 6}},
				Cycles: 12,
			},
		},
		{
			name: "1701 ROR.l 2, D7 e49f",
			init: 			cpuState{
				D:   [8]uint32{3048313585, 3480151399, 773825333, 506804609, 1824386542, 2906145258, 2364106090, 3454611907},
				A:   [7]uint32{1954816685, 4278835974, 2019653213, 2872928354, 156499310, 4062579179, 4277724580},
				PC:  14598612,
				SR:  267,
				USP: 12840724,
				SSP: 11617878,
				RAM: [][2]uint32{{14598608, 228}, {14598609, 159}, {14598610, 36}, {14598611, 110}, {14598612, 68}, {14598613, 245}},
			},
			want: 			cpuState{
				D:   [8]uint32{3048313585, 3480151399, 773825333, 506804609, 1824386542, 2906145258, 2364106090, 4084878448},
				A:   [7]uint32{1954816685, 4278835974, 2019653213, 2872928354, 156499310, 4062579179, 4277724580},
				PC:  14598614,
				SR:  265,
				USP: 12840724,
				SSP: 11617878,
				RAM: [][2]uint32{{14598608, 228}, {14598609, 159}, {14598610, 36}, {14598611, 110}, {14598612, 68}, {14598613, 245}},
				Cycles: 12,
			},
		},
		{
			name: "1946 ROR.l 7, D3 ee9b",
			init: 			cpuState{
				D:   [8]uint32{3003894082, 1960890273, 153470872, 4056304575, 2711026655, 347452543, 1380141357, 4223860844},
				A:   [7]uint32{1851133670, 247695543, 3340349954, 2052284188, 2024792137, 2801279531, 4126277405},
				PC:  5246746,
				SR:  1296,
				USP: 4116648,
				SSP: 6511710,
				RAM: [][2]uint32{{5246742, 238}, {5246743, 155}, {5246744, 23}, {5246745, 88}, {5246746, 124}, {5246747, 42}},
			},
			want: 			cpuState{
				D:   [8]uint32{3003894082, 1960890273, 153470872, 2145619095, 2711026655, 347452543, 1380141357, 4223860844},
				A:   [7]uint32{1851133670, 247695543, 3340349954, 2052284188, 2024792137, 2801279531, 4126277405},
				PC:  5246748,
				SR:  1296,
				USP: 4116648,
				SSP: 6511710,
				RAM: [][2]uint32{{5246742, 238}, {5246743, 155}, {5246744, 23}, {5246745, 88}, {5246746, 124}, {5246747, 42}},
				Cycles: 22,
			},
		},
		{
			name: "2235 ROR.l 7, D0 ee98",
			init: 			cpuState{
				D:   [8]uint32{3778593384, 3273117294, 271379762, 1292258684, 3438107381, 3901842320, 2631791512, 2007376102},
				A:   [7]uint32{2735993648, 835329928, 3628235003, 3511554959, 365195917, 2725785941, 3263468482},
				PC:  3442966,
				SR:  784,
				USP: 7922124,
				SSP: 1820350,
				RAM: [][2]uint32{{3442962, 238}, {3442963, 152}, {3442964, 232}, {3442965, 136}, {3442966, 228}, {3442967, 232}},
			},
			want: 			cpuState{
				D:   [8]uint32{3519181188, 3273117294, 271379762, 1292258684, 3438107381, 3901842320, 2631791512, 2007376102},
				A:   [7]uint32{2735993648, 835329928, 3628235003, 3511554959, 365195917, 2725785941, 3263468482},
				PC:  3442968,
				SR:  793,
				USP: 7922124,
				SSP: 1820350,
				RAM: [][2]uint32{{3442962, 238}, {3442963, 152}, {3442964, 232}, {3442965, 136}, {3442966, 228}, {3442967, 232}},
				Cycles: 22,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXL_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXL.b 1, D0 e310",
			init: cpuState{
				D:   [8]uint32{3924855748, 194293367, 1650562615, 2093518686, 1819219859, 654038519, 115088476, 3329632326},
				A:   [7]uint32{1771164836, 2447407622, 3787725742, 1026487977, 4013075012, 1506547656, 3160114949},
				PC:  13305274,
				SR:  8201,
				USP: 7631224,
				SSP: 4506738,
				RAM: [][2]uint32{{13305270, 227}, {13305271, 16}, {13305272, 81}, {13305273, 83}, {13305274, 49}, {13305275, 195}},
			},
			want: cpuState{
				D:   [8]uint32{3924855688, 194293367, 1650562615, 2093518686, 1819219859, 654038519, 115088476, 3329632326},
				A:   [7]uint32{1771164836, 2447407622, 3787725742, 1026487977, 4013075012, 1506547656, 3160114949},
				PC:  13305276,
				SR:  8217,
				USP: 7631224,
				SSP: 4506738,
				RAM: [][2]uint32{{13305270, 227}, {13305271, 16}, {13305272, 81}, {13305273, 83}, {13305274, 49}, {13305275, 195}},
				Cycles: 8,
			},
		},
		{
			name: "500 ROXL.b 5, D1 eb11",
			init: cpuState{
				D:   [8]uint32{1888913356, 2221789377, 1994609211, 2706971263, 4031419226, 811450499, 2669375959, 2778654981},
				A:   [7]uint32{863748674, 2680153590, 381536844, 4168985368, 4126297276, 916121738, 3526149034},
				PC:  11694872,
				SR:  33542,
				USP: 13859128,
				SSP: 82244,
				RAM: [][2]uint32{{11694868, 235}, {11694869, 17}, {11694870, 35}, {11694871, 13}, {11694872, 66}, {11694873, 3}},
			},
			want: cpuState{
				D:   [8]uint32{1888913356, 2221789228, 1994609211, 2706971263, 4031419226, 811450499, 2669375959, 2778654981},
				A:   [7]uint32{863748674, 2680153590, 381536844, 4168985368, 4126297276, 916121738, 3526149034},
				PC:  11694874,
				SR:  33536,
				USP: 13859128,
				SSP: 82244,
				RAM: [][2]uint32{{11694868, 235}, {11694869, 17}, {11694870, 35}, {11694871, 13}, {11694872, 66}, {11694873, 3}},
				Cycles: 16,
			},
		},
		{
			name: "1000 ROXL.b 5, D2 eb12",
			init: cpuState{
				D:   [8]uint32{2846753559, 2219512329, 86505047, 4180304900, 3690120655, 2215221751, 24298556, 3577033584},
				A:   [7]uint32{4128795416, 2307917395, 133049003, 1553218119, 1950099045, 1147531985, 746993516},
				PC:  7765160,
				SR:  8214,
				USP: 7158886,
				SSP: 3075208,
				RAM: [][2]uint32{{7765156, 235}, {7765157, 18}, {7765158, 164}, {7765159, 72}, {7765160, 57}, {7765161, 192}},
			},
			want: cpuState{
				D:   [8]uint32{2846753559, 2219512329, 86505205, 4180304900, 3690120655, 2215221751, 24298556, 3577033584},
				A:   [7]uint32{4128795416, 2307917395, 133049003, 1553218119, 1950099045, 1147531985, 746993516},
				PC:  7765162,
				SR:  8200,
				USP: 7158886,
				SSP: 3075208,
				RAM: [][2]uint32{{7765156, 235}, {7765157, 18}, {7765158, 164}, {7765159, 72}, {7765160, 57}, {7765161, 192}},
				Cycles: 16,
			},
		},
		{
			name: "1500 ROXL.b 3, D4 e714",
			init: cpuState{
				D:   [8]uint32{2250556733, 1108186524, 136058335, 149028049, 2397235179, 1494275585, 3376126119, 3381913241},
				A:   [7]uint32{3967767348, 2556901511, 2012171021, 3051736555, 175789468, 758678020, 1992090082},
				PC:  3743484,
				SR:  1801,
				USP: 10316696,
				SSP: 8784560,
				RAM: [][2]uint32{{3743480, 231}, {3743481, 20}, {3743482, 26}, {3743483, 62}, {3743484, 156}, {3743485, 228}},
			},
			want: cpuState{
				D:   [8]uint32{2250556733, 1108186524, 136058335, 149028049, 2397235035, 1494275585, 3376126119, 3381913241},
				A:   [7]uint32{3967767348, 2556901511, 2012171021, 3051736555, 175789468, 758678020, 1992090082},
				PC:  3743486,
				SR:  1809,
				USP: 10316696,
				SSP: 8784560,
				RAM: [][2]uint32{{3743480, 231}, {3743481, 20}, {3743482, 26}, {3743483, 62}, {3743484, 156}, {3743485, 228}},
				Cycles: 12,
			},
		},
		{
			name: "2000 ROXL.b D2, D4 e534",
			init: cpuState{
				D:   [8]uint32{966613784, 807093539, 2092037604, 3669418517, 294050891, 4251739016, 247392496, 3746769542},
				A:   [7]uint32{2045043652, 718564768, 3858617924, 796278877, 2031918634, 1289925528, 606721971},
				PC:  8498152,
				SR:  42014,
				USP: 13622492,
				SSP: 14624870,
				RAM: [][2]uint32{{8498148, 229}, {8498149, 52}, {8498150, 17}, {8498151, 180}, {8498152, 60}, {8498153, 228}},
			},
			want: cpuState{
				D:   [8]uint32{966613784, 807093539, 2092037604, 3669418517, 294050891, 4251739016, 247392496, 3746769542},
				A:   [7]uint32{2045043652, 718564768, 3858617924, 796278877, 2031918634, 1289925528, 606721971},
				PC:  8498154,
				SR:  42001,
				USP: 13622492,
				SSP: 14624870,
				RAM: [][2]uint32{{8498148, 229}, {8498149, 52}, {8498150, 17}, {8498151, 180}, {8498152, 60}, {8498153, 228}},
				Cycles: 78,
			},
		},
		{
			name: "001 ROXL.b D0, D0 e130",
			init: 			cpuState{
				D:   [8]uint32{3798403999, 1459052370, 941593795, 920147724, 2792039824, 2921416633, 707991738, 2225204240},
				A:   [7]uint32{1189289816, 4045100993, 4232848767, 471078735, 3688028772, 720192483, 3379185612},
				PC:  8745740,
				SR:  541,
				USP: 11863176,
				SSP: 11913176,
				RAM: [][2]uint32{{8745736, 225}, {8745737, 48}, {8745738, 89}, {8745739, 17}, {8745740, 117}, {8745741, 7}},
			},
			want: 			cpuState{
				D:   [8]uint32{3798404092, 1459052370, 941593795, 920147724, 2792039824, 2921416633, 707991738, 2225204240},
				A:   [7]uint32{1189289816, 4045100993, 4232848767, 471078735, 3688028772, 720192483, 3379185612},
				PC:  8745742,
				SR:  537,
				USP: 11863176,
				SSP: 11913176,
				RAM: [][2]uint32{{8745736, 225}, {8745737, 48}, {8745738, 89}, {8745739, 17}, {8745740, 117}, {8745741, 7}},
				Cycles: 68,
			},
		},
		{
			name: "256 ROXL.b D5, D0 eb30",
			init: 			cpuState{
				D:   [8]uint32{579727099, 2664349804, 3354951886, 2826649564, 3567096947, 1143025624, 3955736215, 3055752699},
				A:   [7]uint32{3009759844, 3749614534, 3690323159, 4270609190, 1564285962, 3654147844, 2521012791},
				PC:  5490126,
				SR:  9479,
				USP: 4985672,
				SSP: 4903450,
				RAM: [][2]uint32{{5490122, 235}, {5490123, 48}, {5490124, 201}, {5490125, 64}, {5490126, 160}, {5490127, 31}},
			},
			want: 			cpuState{
				D:   [8]uint32{579727071, 2664349804, 3354951886, 2826649564, 3567096947, 1143025624, 3955736215, 3055752699},
				A:   [7]uint32{3009759844, 3749614534, 3690323159, 4270609190, 1564285962, 3654147844, 2521012791},
				PC:  5490128,
				SR:  9480,
				USP: 4985672,
				SSP: 4903450,
				RAM: [][2]uint32{{5490122, 235}, {5490123, 48}, {5490124, 201}, {5490125, 64}, {5490126, 160}, {5490127, 31}},
				Cycles: 54,
			},
		},
		{
			name: "534 ROXL.b 1, D3 e313",
			init: 			cpuState{
				D:   [8]uint32{3063685003, 3796066158, 3090662697, 421503706, 656348168, 3814159369, 2985104617, 1160825225},
				A:   [7]uint32{2311594610, 851124607, 665028683, 1106331695, 3504341888, 1729149367, 1609689973},
				PC:  997568,
				SR:  1557,
				USP: 7331838,
				SSP: 15721594,
				RAM: [][2]uint32{{997564, 227}, {997565, 19}, {997566, 31}, {997567, 129}, {997568, 199}, {997569, 23}},
			},
			want: 			cpuState{
				D:   [8]uint32{3063685003, 3796066158, 3090662697, 421503669, 656348168, 3814159369, 2985104617, 1160825225},
				A:   [7]uint32{2311594610, 851124607, 665028683, 1106331695, 3504341888, 1729149367, 1609689973},
				PC:  997570,
				SR:  1561,
				USP: 7331838,
				SSP: 15721594,
				RAM: [][2]uint32{{997564, 227}, {997565, 19}, {997566, 31}, {997567, 129}, {997568, 199}, {997569, 23}},
				Cycles: 8,
			},
		},
		{
			name: "837 ROXL.b 7, D7 ef17",
			init: 			cpuState{
				D:   [8]uint32{1945026124, 2136972464, 2722174439, 4198730749, 629209910, 535814531, 1716337636, 3165342893},
				A:   [7]uint32{1329581178, 2078890945, 85931090, 1780087162, 2731740451, 1099149559, 2874373831},
				PC:  8610640,
				SR:  9230,
				USP: 13678386,
				SSP: 8399228,
				RAM: [][2]uint32{{8610636, 239}, {8610637, 23}, {8610638, 240}, {8610639, 226}, {8610640, 108}, {8610641, 186}},
			},
			want: 			cpuState{
				D:   [8]uint32{1945026124, 2136972464, 2722174439, 4198730749, 629209910, 535814531, 1716337636, 3165342891},
				A:   [7]uint32{1329581178, 2078890945, 85931090, 1780087162, 2731740451, 1099149559, 2874373831},
				PC:  8610642,
				SR:  9224,
				USP: 13678386,
				SSP: 8399228,
				RAM: [][2]uint32{{8610636, 239}, {8610637, 23}, {8610638, 240}, {8610639, 226}, {8610640, 108}, {8610641, 186}},
				Cycles: 20,
			},
		},
		{
			name: "1111 ROXL.b D0, D3 e133",
			init: 			cpuState{
				D:   [8]uint32{1326534838, 1603730497, 4158009277, 2256685507, 1194461513, 4080164441, 2108444528, 3834692200},
				A:   [7]uint32{3674141450, 1459493557, 3109153296, 3696926529, 98992212, 534283870, 308953304},
				PC:  3699242,
				SR:  9218,
				USP: 2174286,
				SSP: 10221336,
				RAM: [][2]uint32{{3699238, 225}, {3699239, 51}, {3699240, 173}, {3699241, 36}, {3699242, 58}, {3699243, 95}},
			},
			want: 			cpuState{
				D:   [8]uint32{1326534838, 1603730497, 4158009277, 2256685507, 1194461513, 4080164441, 2108444528, 3834692200},
				A:   [7]uint32{3674141450, 1459493557, 3109153296, 3696926529, 98992212, 534283870, 308953304},
				PC:  3699244,
				SR:  9224,
				USP: 2174286,
				SSP: 10221336,
				RAM: [][2]uint32{{3699238, 225}, {3699239, 51}, {3699240, 173}, {3699241, 36}, {3699242, 58}, {3699243, 95}},
				Cycles: 114,
			},
		},
		{
			name: "1420 ROXL.b 8, D5 e115",
			init: 			cpuState{
				D:   [8]uint32{1454985917, 3650113599, 3896486547, 1545085434, 629841609, 1173244372, 2495022364, 2138761462},
				A:   [7]uint32{2454207649, 2701091394, 483161675, 3403571926, 2060710049, 3550710788, 3567000752},
				PC:  15495660,
				SR:  6,
				USP: 680204,
				SSP: 11551960,
				RAM: [][2]uint32{{15495656, 225}, {15495657, 21}, {15495658, 157}, {15495659, 10}, {15495660, 114}, {15495661, 170}},
			},
			want: 			cpuState{
				D:   [8]uint32{1454985917, 3650113599, 3896486547, 1545085434, 629841609, 1173244266, 2495022364, 2138761462},
				A:   [7]uint32{2454207649, 2701091394, 483161675, 3403571926, 2060710049, 3550710788, 3567000752},
				PC:  15495662,
				SR:  0,
				USP: 680204,
				SSP: 11551960,
				RAM: [][2]uint32{{15495656, 225}, {15495657, 21}, {15495658, 157}, {15495659, 10}, {15495660, 114}, {15495661, 170}},
				Cycles: 22,
			},
		},
		{
			name: "1687 ROXL.b D7, D0 ef30",
			init: 			cpuState{
				D:   [8]uint32{96307510, 3160914429, 1051238536, 3845229324, 1369260751, 3810097420, 2005706030, 3392699177},
				A:   [7]uint32{2990365242, 1231500925, 3330869760, 2978304111, 2813305905, 541175815, 12513765},
				PC:  9452764,
				SR:  8473,
				USP: 16001740,
				SSP: 10950280,
				RAM: [][2]uint32{{9452760, 239}, {9452761, 48}, {9452762, 6}, {9452763, 239}, {9452764, 8}, {9452765, 37}},
			},
			want: 			cpuState{
				D:   [8]uint32{96307667, 3160914429, 1051238536, 3845229324, 1369260751, 3810097420, 2005706030, 3392699177},
				A:   [7]uint32{2990365242, 1231500925, 3330869760, 2978304111, 2813305905, 541175815, 12513765},
				PC:  9452766,
				SR:  8456,
				USP: 16001740,
				SSP: 10950280,
				RAM: [][2]uint32{{9452760, 239}, {9452761, 48}, {9452762, 6}, {9452763, 239}, {9452764, 8}, {9452765, 37}},
				Cycles: 88,
			},
		},
		{
			name: "1946 ROXL.b 7, D4 ef14",
			init: 			cpuState{
				D:   [8]uint32{869816925, 2980380969, 1808373390, 1640048580, 3005018315, 1083074685, 1586940185, 1586167240},
				A:   [7]uint32{3200698777, 3696341293, 2999035509, 1868537441, 679234560, 1704968042, 3974960388},
				PC:  9605766,
				SR:  8459,
				USP: 4719736,
				SSP: 523246,
				RAM: [][2]uint32{{9605762, 239}, {9605763, 20}, {9605764, 55}, {9605765, 73}, {9605766, 183}, {9605767, 109}},
			},
			want: 			cpuState{
				D:   [8]uint32{869816925, 2980380969, 1808373390, 1640048580, 3005018290, 1083074685, 1586940185, 1586167240},
				A:   [7]uint32{3200698777, 3696341293, 2999035509, 1868537441, 679234560, 1704968042, 3974960388},
				PC:  9605768,
				SR:  8473,
				USP: 4719736,
				SSP: 523246,
				RAM: [][2]uint32{{9605762, 239}, {9605763, 20}, {9605764, 55}, {9605765, 73}, {9605766, 183}, {9605767, 109}},
				Cycles: 20,
			},
		},
		{
			name: "2221 ROXL.b 2, D3 e513",
			init: 			cpuState{
				D:   [8]uint32{2463881756, 3482251937, 3805770780, 2013845727, 1533884377, 4185392460, 3712341611, 3991948923},
				A:   [7]uint32{256054924, 15402348, 3755978328, 4104551697, 1023683299, 2890510773, 2085359147},
				PC:  15966688,
				SR:  1809,
				USP: 16344892,
				SSP: 1065664,
				RAM: [][2]uint32{{15966684, 229}, {15966685, 19}, {15966686, 139}, {15966687, 209}, {15966688, 186}, {15966689, 39}},
			},
			want: 			cpuState{
				D:   [8]uint32{2463881756, 3482251937, 3805770780, 2013845631, 1533884377, 4185392460, 3712341611, 3991948923},
				A:   [7]uint32{256054924, 15402348, 3755978328, 4104551697, 1023683299, 2890510773, 2085359147},
				PC:  15966690,
				SR:  1809,
				USP: 16344892,
				SSP: 1065664,
				RAM: [][2]uint32{{15966684, 229}, {15966685, 19}, {15966686, 139}, {15966687, 209}, {15966688, 186}, {15966689, 39}},
				Cycles: 10,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXL_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXL.w (d8, A2, Xn) e5f2",
			init: cpuState{
				D:   [8]uint32{2260854261, 341931546, 4203190097, 1774206491, 2532021109, 3422268167, 1197923652, 1256044278},
				A:   [7]uint32{3905986971, 1208596659, 2938361544, 2566779843, 2038703801, 3313804409, 2021619634},
				PC:  9117226,
				SR:  33804,
				USP: 12746910,
				SSP: 6791436,
				RAM: [][2]uint32{{9117222, 229}, {9117223, 242}, {9117224, 50}, {9117225, 197}, {9117226, 140}, {9117227, 98}, {2364584, 113}, {2364585, 127}, {9117228, 80}, {9117229, 11}},
			},
			want: cpuState{
				D:   [8]uint32{2260854261, 341931546, 4203190097, 1774206491, 2532021109, 3422268167, 1197923652, 1256044278},
				A:   [7]uint32{3905986971, 1208596659, 2938361544, 2566779843, 2038703801, 3313804409, 2021619634},
				PC:  9117230,
				SR:  33800,
				USP: 12746910,
				SSP: 6791436,
				RAM: [][2]uint32{{9117222, 229}, {9117223, 242}, {9117224, 50}, {9117225, 197}, {9117226, 140}, {9117227, 98}, {2364584, 226}, {2364585, 254}, {9117228, 80}, {9117229, 11}},
				Cycles: 18,
			},
		},
		{
			name: "500 ROXL.w 1, D2 e352",
			init: cpuState{
				D:   [8]uint32{19006894, 139792824, 2639858346, 2479695353, 1169619254, 3202944219, 662638222, 314117980},
				A:   [7]uint32{2872338218, 2634855286, 4270673978, 3703050614, 1189006450, 2260499704, 1478739966},
				PC:  7707504,
				SR:  41222,
				USP: 10774420,
				SSP: 625222,
				RAM: [][2]uint32{{7707500, 227}, {7707501, 82}, {7707502, 141}, {7707503, 126}, {7707504, 146}, {7707505, 248}},
			},
			want: cpuState{
				D:   [8]uint32{19006894, 139792824, 2639861076, 2479695353, 1169619254, 3202944219, 662638222, 314117980},
				A:   [7]uint32{2872338218, 2634855286, 4270673978, 3703050614, 1189006450, 2260499704, 1478739966},
				PC:  7707506,
				SR:  41216,
				USP: 10774420,
				SSP: 625222,
				RAM: [][2]uint32{{7707500, 227}, {7707501, 82}, {7707502, 141}, {7707503, 126}, {7707504, 146}, {7707505, 248}},
				Cycles: 8,
			},
		},
		{
			name: "1000 ROXL.w (A1)+ e5d9",
			init: cpuState{
				D:   [8]uint32{2176612331, 96201356, 1534010296, 4246056514, 2620412292, 1417509671, 4187354789, 4245779424},
				A:   [7]uint32{3841498265, 832564752, 329220317, 3699958165, 67276528, 1912995784, 1611943523},
				PC:  2648216,
				SR:  42524,
				USP: 3842098,
				SSP: 10442976,
				RAM: [][2]uint32{{2648212, 229}, {2648213, 217}, {2648214, 34}, {2648215, 197}, {10481168, 159}, {10481169, 173}, {2648216, 20}, {2648217, 104}},
			},
			want: cpuState{
				D:   [8]uint32{2176612331, 96201356, 1534010296, 4246056514, 2620412292, 1417509671, 4187354789, 4245779424},
				A:   [7]uint32{3841498265, 832564754, 329220317, 3699958165, 67276528, 1912995784, 1611943523},
				PC:  2648218,
				SR:  42513,
				USP: 3842098,
				SSP: 10442976,
				RAM: [][2]uint32{{2648212, 229}, {2648213, 217}, {2648214, 34}, {2648215, 197}, {10481168, 63}, {10481169, 91}, {2648216, 20}, {2648217, 104}},
				Cycles: 12,
			},
		},
		{
			name: "1500 ROXL.w (A5)+ e5dd",
			init: cpuState{
				D:   [8]uint32{1043140595, 4099151639, 783687567, 3892952963, 3313054071, 3905970271, 1787457655, 1272970525},
				A:   [7]uint32{463727686, 908548641, 2316848092, 1003663432, 3807411628, 3703170354, 3743949034},
				PC:  280788,
				SR:  799,
				USP: 2235886,
				SSP: 2692210,
				RAM: [][2]uint32{{280784, 229}, {280785, 221}, {280786, 20}, {280787, 47}, {12182834, 25}, {12182835, 196}, {280788, 244}, {280789, 102}},
			},
			want: cpuState{
				D:   [8]uint32{1043140595, 4099151639, 783687567, 3892952963, 3313054071, 3905970271, 1787457655, 1272970525},
				A:   [7]uint32{463727686, 908548641, 2316848092, 1003663432, 3807411628, 3703170356, 3743949034},
				PC:  280790,
				SR:  768,
				USP: 2235886,
				SSP: 2692210,
				RAM: [][2]uint32{{280784, 229}, {280785, 221}, {280786, 20}, {280787, 47}, {12182834, 51}, {12182835, 137}, {280788, 244}, {280789, 102}},
				Cycles: 12,
			},
		},
		{
			name: "2000 ROXL.w 7, D6 ef56",
			init: cpuState{
				D:   [8]uint32{2167312407, 221674835, 3222412609, 2031339348, 1936825596, 3673488182, 2366085503, 2450349549},
				A:   [7]uint32{2932800989, 3885046712, 245947825, 1776056193, 4098679327, 1994461401, 658971659},
				PC:  1129394,
				SR:  34056,
				USP: 5318992,
				SSP: 6132604,
				RAM: [][2]uint32{{1129390, 239}, {1129391, 86}, {1129392, 67}, {1129393, 66}, {1129394, 251}, {1129395, 55}},
			},
			want: cpuState{
				D:   [8]uint32{2167312407, 221674835, 3222412609, 2031339348, 1936825596, 3673488182, 2366095270, 2450349549},
				A:   [7]uint32{2932800989, 3885046712, 245947825, 1776056193, 4098679327, 1994461401, 658971659},
				PC:  1129396,
				SR:  34056,
				USP: 5318992,
				SSP: 6132604,
				RAM: [][2]uint32{{1129390, 239}, {1129391, 86}, {1129392, 67}, {1129393, 66}, {1129394, 251}, {1129395, 55}},
				Cycles: 20,
			},
		},
		{
			name: "004 ROXL.w 4, D7 e957",
			init: 			cpuState{
				D:   [8]uint32{1645116280, 305286549, 4093222136, 3975693892, 3612422162, 1339120908, 2257256773, 1491685356},
				A:   [7]uint32{2664364315, 2711552613, 1485216254, 2698705950, 3784950983, 2504018036, 707143393},
				PC:  13223772,
				SR:  9218,
				USP: 13378656,
				SSP: 2243694,
				RAM: [][2]uint32{{13223768, 233}, {13223769, 87}, {13223770, 61}, {13223771, 105}, {13223772, 76}, {13223773, 79}},
			},
			want: 			cpuState{
				D:   [8]uint32{1645116280, 305286549, 4093222136, 3975693892, 3612422162, 1339120908, 2257256773, 1491730114},
				A:   [7]uint32{2664364315, 2711552613, 1485216254, 2698705950, 3784950983, 2504018036, 707143393},
				PC:  13223774,
				SR:  9224,
				USP: 13378656,
				SSP: 2243694,
				RAM: [][2]uint32{{13223768, 233}, {13223769, 87}, {13223770, 61}, {13223771, 105}, {13223772, 76}, {13223773, 79}},
				Cycles: 14,
			},
		},
		{
			name: "271 ROXL.w (A3) e5d3",
			init: 			cpuState{
				D:   [8]uint32{2719186991, 1218972916, 994169647, 2810827213, 3091732021, 2608709554, 3597030052, 3879965643},
				A:   [7]uint32{1465768308, 2272059912, 1639645369, 1446022672, 2960742096, 878185883, 2678286807},
				PC:  11544408,
				SR:  10004,
				USP: 14572270,
				SSP: 4100852,
				RAM: [][2]uint32{{11544404, 229}, {11544405, 211}, {11544406, 219}, {11544407, 84}, {3182096, 91}, {3182097, 141}, {11544408, 195}, {11544409, 220}},
			},
			want: 			cpuState{
				D:   [8]uint32{2719186991, 1218972916, 994169647, 2810827213, 3091732021, 2608709554, 3597030052, 3879965643},
				A:   [7]uint32{1465768308, 2272059912, 1639645369, 1446022672, 2960742096, 878185883, 2678286807},
				PC:  11544410,
				SR:  9992,
				USP: 14572270,
				SSP: 4100852,
				RAM: [][2]uint32{{11544404, 229}, {11544405, 211}, {11544406, 219}, {11544407, 84}, {3182096, 183}, {3182097, 27}, {11544408, 195}, {11544409, 220}},
				Cycles: 12,
			},
		},
		{
			name: "533 ROXL.w D1, D0 e370",
			init: 			cpuState{
				D:   [8]uint32{623331466, 1002513649, 1739437241, 1362783586, 1999549666, 777630404, 702885349, 4028648287},
				A:   [7]uint32{2042560074, 984964082, 3133306498, 922429537, 2724398862, 3518616175, 3906831751},
				PC:  5446232,
				SR:  1280,
				USP: 11004430,
				SSP: 5538896,
				RAM: [][2]uint32{{5446228, 227}, {5446229, 112}, {5446230, 97}, {5446231, 87}, {5446232, 176}, {5446233, 89}},
			},
			want: 			cpuState{
				D:   [8]uint32{623317538, 1002513649, 1739437241, 1362783586, 1999549666, 777630404, 702885349, 4028648287},
				A:   [7]uint32{2042560074, 984964082, 3133306498, 922429537, 2724398862, 3518616175, 3906831751},
				PC:  5446234,
				SR:  1297,
				USP: 11004430,
				SSP: 5538896,
				RAM: [][2]uint32{{5446228, 227}, {5446229, 112}, {5446230, 97}, {5446231, 87}, {5446232, 176}, {5446233, 89}},
				Cycles: 104,
			},
		},
		{
			name: "807 ROXL.w 8, D2 e152",
			init: 			cpuState{
				D:   [8]uint32{924222991, 3802906779, 4232956703, 3745316620, 1077894080, 1610040845, 2985690903, 1149502156},
				A:   [7]uint32{1535823157, 4107802326, 4258816346, 1457935609, 4252297344, 2323011537, 1532690210},
				PC:  11557524,
				SR:  1041,
				USP: 9105804,
				SSP: 5015756,
				RAM: [][2]uint32{{11557520, 225}, {11557521, 82}, {11557522, 182}, {11557523, 3}, {11557524, 79}, {11557525, 16}},
			},
			want: 			cpuState{
				D:   [8]uint32{924222991, 3802906779, 4232912869, 3745316620, 1077894080, 1610040845, 2985690903, 1149502156},
				A:   [7]uint32{1535823157, 4107802326, 4258816346, 1457935609, 4252297344, 2323011537, 1532690210},
				PC:  11557526,
				SR:  1041,
				USP: 9105804,
				SSP: 5015756,
				RAM: [][2]uint32{{11557520, 225}, {11557521, 82}, {11557522, 182}, {11557523, 3}, {11557524, 79}, {11557525, 16}},
				Cycles: 22,
			},
		},
		{
			name: "1075 ROXL.w D1, D1 e371",
			init: 			cpuState{
				D:   [8]uint32{3188628364, 1569792233, 3388411568, 741313927, 2321728374, 2553712735, 1931999425, 614909670},
				A:   [7]uint32{4101424257, 107487985, 3347090187, 4256228641, 32582497, 1541673715, 3343518846},
				PC:  10360328,
				SR:  1807,
				USP: 7215238,
				SSP: 5725628,
				RAM: [][2]uint32{{10360324, 227}, {10360325, 113}, {10360326, 115}, {10360327, 120}, {10360328, 73}, {10360329, 20}},
			},
			want: 			cpuState{
				D:   [8]uint32{3188628364, 1569813640, 3388411568, 741313927, 2321728374, 2553712735, 1931999425, 614909670},
				A:   [7]uint32{4101424257, 107487985, 3347090187, 4256228641, 32582497, 1541673715, 3343518846},
				PC:  10360330,
				SR:  1792,
				USP: 7215238,
				SSP: 5725628,
				RAM: [][2]uint32{{10360324, 227}, {10360325, 113}, {10360326, 115}, {10360327, 120}, {10360328, 73}, {10360329, 20}},
				Cycles: 88,
			},
		},
		{
			name: "1326 ROXL.w 7, D5 ef55",
			init: 			cpuState{
				D:   [8]uint32{3770933803, 3455949530, 3850724698, 3578658304, 1057420934, 2073249483, 639402058, 2694654106},
				A:   [7]uint32{1375127266, 1530176772, 1099088547, 882304944, 2780577779, 1310529696, 3721616582},
				PC:  999324,
				SR:  9755,
				USP: 4001406,
				SSP: 8910178,
				RAM: [][2]uint32{{999320, 239}, {999321, 85}, {999322, 141}, {999323, 63}, {999324, 170}, {999325, 45}},
			},
			want: 			cpuState{
				D:   [8]uint32{3770933803, 3455949530, 3850724698, 3578658304, 1057420934, 2073257425, 639402058, 2694654106},
				A:   [7]uint32{1375127266, 1530176772, 1099088547, 882304944, 2780577779, 1310529696, 3721616582},
				PC:  999326,
				SR:  9745,
				USP: 4001406,
				SSP: 8910178,
				RAM: [][2]uint32{{999320, 239}, {999321, 85}, {999322, 141}, {999323, 63}, {999324, 170}, {999325, 45}},
				Cycles: 20,
			},
		},
		{
			name: "1639 ROXL.w 2, D2 e552",
			init: 			cpuState{
				D:   [8]uint32{3618521766, 2583373361, 3357657116, 1931169700, 2977600101, 4021443932, 3901878886, 1026388928},
				A:   [7]uint32{590694784, 737557349, 2453303489, 349671608, 1284984555, 866518375, 1708206454},
				PC:  6570948,
				SR:  1285,
				USP: 2784352,
				SSP: 5529270,
				RAM: [][2]uint32{{6570944, 229}, {6570945, 82}, {6570946, 2}, {6570947, 218}, {6570948, 100}, {6570949, 49}},
			},
			want: 			cpuState{
				D:   [8]uint32{3618521766, 2583373361, 3357614193, 1931169700, 2977600101, 4021443932, 3901878886, 1026388928},
				A:   [7]uint32{590694784, 737557349, 2453303489, 349671608, 1284984555, 866518375, 1708206454},
				PC:  6570950,
				SR:  1297,
				USP: 2784352,
				SSP: 5529270,
				RAM: [][2]uint32{{6570944, 229}, {6570945, 82}, {6570946, 2}, {6570947, 218}, {6570948, 100}, {6570949, 49}},
				Cycles: 10,
			},
		},
		{
			name: "1907 ROXL.w (A7) e5d7",
			init: 			cpuState{
				D:   [8]uint32{2739891978, 1500987178, 4038955874, 1425444647, 2875043410, 3436674475, 2467198717, 1733144185},
				A:   [7]uint32{2118813097, 760461084, 2454041877, 3948574105, 2829555865, 3933009844, 1775685961},
				PC:  14451450,
				SR:  28,
				USP: 16198328,
				SSP: 14807286,
				RAM: [][2]uint32{{14451446, 229}, {14451447, 215}, {14451448, 117}, {14451449, 57}, {16198328, 24}, {16198329, 135}, {14451450, 175}, {14451451, 218}},
			},
			want: 			cpuState{
				D:   [8]uint32{2739891978, 1500987178, 4038955874, 1425444647, 2875043410, 3436674475, 2467198717, 1733144185},
				A:   [7]uint32{2118813097, 760461084, 2454041877, 3948574105, 2829555865, 3933009844, 1775685961},
				PC:  14451452,
				SR:  0,
				USP: 16198328,
				SSP: 14807286,
				RAM: [][2]uint32{{14451446, 229}, {14451447, 215}, {14451448, 117}, {14451449, 57}, {16198328, 49}, {16198329, 15}, {14451450, 175}, {14451451, 218}},
				Cycles: 12,
			},
		},
		{
			name: "2196 ROXL.w D4, D2 e972",
			init: 			cpuState{
				D:   [8]uint32{3051662643, 898015842, 876889424, 311314747, 483084620, 536483534, 1265598833, 685798690},
				A:   [7]uint32{353947002, 1819238812, 2973954031, 4087542045, 1278154222, 3808836023, 1173150644},
				PC:  11612354,
				SR:  269,
				USP: 9870632,
				SSP: 6341024,
				RAM: [][2]uint32{{11612350, 233}, {11612351, 114}, {11612352, 125}, {11612353, 180}, {11612354, 16}, {11612355, 41}},
			},
			want: 			cpuState{
				D:   [8]uint32{3051662643, 898015842, 876872234, 311314747, 483084620, 536483534, 1265598833, 685798690},
				A:   [7]uint32{353947002, 1819238812, 2973954031, 4087542045, 1278154222, 3808836023, 1173150644},
				PC:  11612356,
				SR:  273,
				USP: 9870632,
				SSP: 6341024,
				RAM: [][2]uint32{{11612350, 233}, {11612351, 114}, {11612352, 125}, {11612353, 180}, {11612354, 16}, {11612355, 41}},
				Cycles: 30,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXL_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXL.l 3, D1 e791",
			init: cpuState{
				D:   [8]uint32{250172579, 1789076768, 773868069, 3443113245, 3317264784, 3546499369, 4130257380, 2442970974},
				A:   [7]uint32{1162712535, 1665159052, 3523798496, 3831773315, 2096837057, 2638812258, 654807390},
				PC:  8523922,
				SR:  10004,
				USP: 14666150,
				SSP: 16038206,
				RAM: [][2]uint32{{8523918, 231}, {8523919, 145}, {8523920, 102}, {8523921, 24}, {8523922, 150}, {8523923, 164}},
			},
			want: cpuState{
				D:   [8]uint32{250172579, 1427712261, 773868069, 3443113245, 3317264784, 3546499369, 4130257380, 2442970974},
				A:   [7]uint32{1162712535, 1665159052, 3523798496, 3831773315, 2096837057, 2638812258, 654807390},
				PC:  8523924,
				SR:  10001,
				USP: 14666150,
				SSP: 16038206,
				RAM: [][2]uint32{{8523918, 231}, {8523919, 145}, {8523920, 102}, {8523921, 24}, {8523922, 150}, {8523923, 164}},
				Cycles: 14,
			},
		},
		{
			name: "500 ROXL.l 4, D2 e992",
			init: cpuState{
				D:   [8]uint32{1973857222, 971621610, 483869836, 1833573508, 4114988816, 1441797307, 2160162247, 522922289},
				A:   [7]uint32{2837252878, 1790166901, 2116562903, 1885083660, 1243697417, 3034285637, 839381724},
				PC:  13117498,
				SR:  9739,
				USP: 12486540,
				SSP: 434550,
				RAM: [][2]uint32{{13117494, 233}, {13117495, 146}, {13117496, 22}, {13117497, 156}, {13117498, 131}, {13117499, 182}},
			},
			want: cpuState{
				D:   [8]uint32{1973857222, 971621610, 3446950080, 1833573508, 4114988816, 1441797307, 2160162247, 522922289},
				A:   [7]uint32{2837252878, 1790166901, 2116562903, 1885083660, 1243697417, 3034285637, 839381724},
				PC:  13117500,
				SR:  9753,
				USP: 12486540,
				SSP: 434550,
				RAM: [][2]uint32{{13117494, 233}, {13117495, 146}, {13117496, 22}, {13117497, 156}, {13117498, 131}, {13117499, 182}},
				Cycles: 16,
			},
		},
		{
			name: "1000 ROXL.l D2, D1 e5b1",
			init: cpuState{
				D:   [8]uint32{3771006633, 2695932164, 25762246, 652820173, 390127260, 3053138718, 2426087494, 1270238972},
				A:   [7]uint32{2391973038, 2838542898, 1964762418, 1821933371, 1967725165, 3220987633, 2102752118},
				PC:  8625472,
				SR:  1041,
				USP: 2290916,
				SSP: 8648726,
				RAM: [][2]uint32{{8625468, 229}, {8625469, 177}, {8625470, 138}, {8625471, 3}, {8625472, 11}, {8625473, 32}},
			},
			want: cpuState{
				D:   [8]uint32{3771006633, 740966708, 25762246, 652820173, 390127260, 3053138718, 2426087494, 1270238972},
				A:   [7]uint32{2391973038, 2838542898, 1964762418, 1821933371, 1967725165, 3220987633, 2102752118},
				PC:  8625474,
				SR:  1024,
				USP: 2290916,
				SSP: 8648726,
				RAM: [][2]uint32{{8625468, 229}, {8625469, 177}, {8625470, 138}, {8625471, 3}, {8625472, 11}, {8625473, 32}},
				Cycles: 20,
			},
		},
		{
			name: "1500 ROXL.l 2, D1 e591",
			init: cpuState{
				D:   [8]uint32{1043996094, 2582379947, 976545337, 1343690714, 3160670234, 4179755843, 88441740, 3384814374},
				A:   [7]uint32{1490861505, 4216224005, 2744127276, 2437567382, 1022677313, 1769890373, 2622470028},
				PC:  11377020,
				SR:  1540,
				USP: 16058410,
				SSP: 4366278,
				RAM: [][2]uint32{{11377016, 229}, {11377017, 145}, {11377018, 86}, {11377019, 252}, {11377020, 165}, {11377021, 177}},
			},
			want: cpuState{
				D:   [8]uint32{1043996094, 1739585197, 976545337, 1343690714, 3160670234, 4179755843, 88441740, 3384814374},
				A:   [7]uint32{1490861505, 4216224005, 2744127276, 2437567382, 1022677313, 1769890373, 2622470028},
				PC:  11377022,
				SR:  1536,
				USP: 16058410,
				SSP: 4366278,
				RAM: [][2]uint32{{11377016, 229}, {11377017, 145}, {11377018, 86}, {11377019, 252}, {11377020, 165}, {11377021, 177}},
				Cycles: 12,
			},
		},
		{
			name: "2000 ROXL.l 6, D1 ed91",
			init: cpuState{
				D:   [8]uint32{3727087683, 1666963230, 189962920, 1909390621, 4261032401, 858137925, 2379929508, 3062294540},
				A:   [7]uint32{4244197686, 2455071432, 2390974171, 1517016648, 3380750288, 1506926545, 329034429},
				PC:  8054890,
				SR:  8730,
				USP: 16544290,
				SSP: 6557420,
				RAM: [][2]uint32{{8054886, 237}, {8054887, 145}, {8054888, 239}, {8054889, 233}, {8054890, 206}, {8054891, 204}},
			},
			want: cpuState{
				D:   [8]uint32{3727087683, 3606431660, 189962920, 1909390621, 4261032401, 858137925, 2379929508, 3062294540},
				A:   [7]uint32{4244197686, 2455071432, 2390974171, 1517016648, 3380750288, 1506926545, 329034429},
				PC:  8054892,
				SR:  8712,
				USP: 16544290,
				SSP: 6557420,
				RAM: [][2]uint32{{8054886, 237}, {8054887, 145}, {8054888, 239}, {8054889, 233}, {8054890, 206}, {8054891, 204}},
				Cycles: 20,
			},
		},
		{
			name: "002 ROXL.l D5, D3 ebb3",
			init: 			cpuState{
				D:   [8]uint32{3849887591, 4090047993, 3857420828, 1530499959, 1996638121, 2482692102, 1476116376, 602643654},
				A:   [7]uint32{1170692394, 923438780, 1333796281, 2426320670, 2392488112, 1837953764, 3193666425},
				PC:  14046084,
				SR:  8968,
				USP: 13729208,
				SSP: 6550480,
				RAM: [][2]uint32{{14046080, 235}, {14046081, 179}, {14046082, 89}, {14046083, 60}, {14046084, 166}, {14046085, 4}},
			},
			want: 			cpuState{
				D:   [8]uint32{3849887591, 4090047993, 3857420828, 3462716875, 1996638121, 2482692102, 1476116376, 602643654},
				A:   [7]uint32{1170692394, 923438780, 1333796281, 2426320670, 2392488112, 1837953764, 3193666425},
				PC:  14046086,
				SR:  8968,
				USP: 13729208,
				SSP: 6550480,
				RAM: [][2]uint32{{14046080, 235}, {14046081, 179}, {14046082, 89}, {14046083, 60}, {14046084, 166}, {14046085, 4}},
				Cycles: 20,
			},
		},
		{
			name: "271 ROXL.l 6, D2 ed92",
			init: 			cpuState{
				D:   [8]uint32{3476232952, 3789830631, 2166713085, 3466757849, 2862376913, 250443697, 113045922, 2262951079},
				A:   [7]uint32{341712962, 867277269, 388748040, 2204101413, 2030505981, 881278372, 4015593951},
				PC:  2925674,
				SR:  1037,
				USP: 13591918,
				SSP: 5455186,
				RAM: [][2]uint32{{2925670, 237}, {2925671, 146}, {2925672, 43}, {2925673, 198}, {2925674, 214}, {2925675, 135}},
			},
			want: 			cpuState{
				D:   [8]uint32{3476232952, 3789830631, 1230683984, 3466757849, 2862376913, 250443697, 113045922, 2262951079},
				A:   [7]uint32{341712962, 867277269, 388748040, 2204101413, 2030505981, 881278372, 4015593951},
				PC:  2925676,
				SR:  1024,
				USP: 13591918,
				SSP: 5455186,
				RAM: [][2]uint32{{2925670, 237}, {2925671, 146}, {2925672, 43}, {2925673, 198}, {2925674, 214}, {2925675, 135}},
				Cycles: 20,
			},
		},
		{
			name: "556 ROXL.l D0, D7 e1b7",
			init: 			cpuState{
				D:   [8]uint32{1810821057, 4264065841, 1752277906, 2021925358, 3120934209, 3949513125, 2497100859, 2255559304},
				A:   [7]uint32{3914571060, 2995797966, 406089220, 1728110391, 2638918929, 2061394814, 3356358},
				PC:  16665630,
				SR:  8984,
				USP: 665614,
				SSP: 12028570,
				RAM: [][2]uint32{{16665626, 225}, {16665627, 183}, {16665628, 125}, {16665629, 21}, {16665630, 237}, {16665631, 221}},
			},
			want: 			cpuState{
				D:   [8]uint32{1810821057, 4264065841, 1752277906, 2021925358, 3120934209, 3949513125, 2497100859, 216151313},
				A:   [7]uint32{3914571060, 2995797966, 406089220, 1728110391, 2638918929, 2061394814, 3356358},
				PC:  16665632,
				SR:  8977,
				USP: 665614,
				SSP: 12028570,
				RAM: [][2]uint32{{16665626, 225}, {16665627, 183}, {16665628, 125}, {16665629, 21}, {16665630, 237}, {16665631, 221}},
				Cycles: 10,
			},
		},
		{
			name: "854 ROXL.l D0, D7 e1b7",
			init: 			cpuState{
				D:   [8]uint32{2392204582, 247716124, 2129142589, 2046885625, 2201059036, 779917347, 879209043, 758312649},
				A:   [7]uint32{2244966415, 1720445117, 2776359217, 1460802324, 1714517291, 3748622847, 3038401480},
				PC:  7262666,
				SR:  1296,
				USP: 15275168,
				SSP: 15391840,
				RAM: [][2]uint32{{7262662, 225}, {7262663, 183}, {7262664, 207}, {7262665, 91}, {7262666, 143}, {7262667, 216}},
			},
			want: 			cpuState{
				D:   [8]uint32{2392204582, 247716124, 2129142589, 2046885625, 2201059036, 779917347, 879209043, 2791168306},
				A:   [7]uint32{2244966415, 1720445117, 2776359217, 1460802324, 1714517291, 3748622847, 3038401480},
				PC:  7262668,
				SR:  1305,
				USP: 15275168,
				SSP: 15391840,
				RAM: [][2]uint32{{7262662, 225}, {7262663, 183}, {7262664, 207}, {7262665, 91}, {7262666, 143}, {7262667, 216}},
				Cycles: 84,
			},
		},
		{
			name: "1126 ROXL.l D4, D2 e9b2",
			init: 			cpuState{
				D:   [8]uint32{3073076825, 1173297086, 2230365198, 351075524, 3356327403, 1368024811, 3979528515, 525932979},
				A:   [7]uint32{3449714260, 3299275480, 3849479437, 1287740536, 1808387392, 2458824222, 1388653335},
				PC:  4098836,
				SR:  1281,
				USP: 3438926,
				SSP: 12628134,
				RAM: [][2]uint32{{4098832, 233}, {4098833, 178}, {4098834, 197}, {4098835, 121}, {4098836, 112}, {4098837, 155}},
			},
			want: 			cpuState{
				D:   [8]uint32{3073076825, 1173297086, 3266328841, 351075524, 3356327403, 1368024811, 3979528515, 525932979},
				A:   [7]uint32{3449714260, 3299275480, 3849479437, 1287740536, 1808387392, 2458824222, 1388653335},
				PC:  4098838,
				SR:  1305,
				USP: 3438926,
				SSP: 12628134,
				RAM: [][2]uint32{{4098832, 233}, {4098833, 178}, {4098834, 197}, {4098835, 121}, {4098836, 112}, {4098837, 155}},
				Cycles: 94,
			},
		},
		{
			name: "1413 ROXL.l 3, D0 e790",
			init: 			cpuState{
				D:   [8]uint32{2454067551, 1292951975, 402600988, 1146537251, 1091377031, 2877742728, 1176197684, 2986295915},
				A:   [7]uint32{1273767493, 3012550403, 3889338784, 2378942159, 3892379669, 2259740832, 829616626},
				PC:  10088466,
				SR:  9224,
				USP: 8832168,
				SSP: 9125850,
				RAM: [][2]uint32{{10088462, 231}, {10088463, 144}, {10088464, 197}, {10088465, 234}, {10088466, 74}, {10088467, 216}},
			},
			want: 			cpuState{
				D:   [8]uint32{2452671226, 1292951975, 402600988, 1146537251, 1091377031, 2877742728, 1176197684, 2986295915},
				A:   [7]uint32{1273767493, 3012550403, 3889338784, 2378942159, 3892379669, 2259740832, 829616626},
				PC:  10088468,
				SR:  9224,
				USP: 8832168,
				SSP: 9125850,
				RAM: [][2]uint32{{10088462, 231}, {10088463, 144}, {10088464, 197}, {10088465, 234}, {10088466, 74}, {10088467, 216}},
				Cycles: 14,
			},
		},
		{
			name: "1685 ROXL.l 5, D7 eb97",
			init: 			cpuState{
				D:   [8]uint32{3138141645, 272852729, 2157789709, 3805778406, 40740558, 1159659049, 3295352560, 757932235},
				A:   [7]uint32{1376200173, 3559759091, 1984596156, 1593789447, 1367187995, 2489706458, 992539034},
				PC:  10393672,
				SR:  524,
				USP: 9706580,
				SSP: 2504756,
				RAM: [][2]uint32{{10393668, 235}, {10393669, 151}, {10393670, 207}, {10393671, 48}, {10393672, 195}, {10393673, 19}},
			},
			want: 			cpuState{
				D:   [8]uint32{3138141645, 272852729, 2157789709, 3805778406, 40740558, 1159659049, 3295352560, 2778995042},
				A:   [7]uint32{1376200173, 3559759091, 1984596156, 1593789447, 1367187995, 2489706458, 992539034},
				PC:  10393674,
				SR:  537,
				USP: 9706580,
				SSP: 2504756,
				RAM: [][2]uint32{{10393668, 235}, {10393669, 151}, {10393670, 207}, {10393671, 48}, {10393672, 195}, {10393673, 19}},
				Cycles: 18,
			},
		},
		{
			name: "1955 ROXL.l D7, D5 efb5",
			init: 			cpuState{
				D:   [8]uint32{1157486339, 1171292971, 472872004, 698783852, 3879446862, 2785750346, 3681915800, 2659127892},
				A:   [7]uint32{3165481009, 3783020178, 1603832803, 45630904, 1691414612, 1641933955, 3763172384},
				PC:  11483710,
				SR:  517,
				USP: 5858138,
				SSP: 11046026,
				RAM: [][2]uint32{{11483706, 239}, {11483707, 181}, {11483708, 15}, {11483709, 231}, {11483710, 21}, {11483711, 176}},
			},
			want: 			cpuState{
				D:   [8]uint32{1157486339, 1171292971, 472872004, 698783852, 3879446862, 3567595609, 3681915800, 2659127892},
				A:   [7]uint32{3165481009, 3783020178, 1603832803, 45630904, 1691414612, 1641933955, 3763172384},
				PC:  11483712,
				SR:  520,
				USP: 5858138,
				SSP: 11046026,
				RAM: [][2]uint32{{11483706, 239}, {11483707, 181}, {11483708, 15}, {11483709, 231}, {11483710, 21}, {11483711, 176}},
				Cycles: 48,
			},
		},
		{
			name: "2235 ROXL.l D3, D6 e7b6",
			init: 			cpuState{
				D:   [8]uint32{3682055807, 1616959273, 395853116, 3275661608, 288741854, 1188719622, 512978654, 335898006},
				A:   [7]uint32{4000683399, 3799287382, 629561130, 1261186911, 1248157186, 264108517, 3241504075},
				PC:  1686652,
				SR:  8979,
				USP: 2640024,
				SSP: 3423708,
				RAM: [][2]uint32{{1686648, 231}, {1686649, 182}, {1686650, 67}, {1686651, 79}, {1686652, 125}, {1686653, 253}},
			},
			want: 			cpuState{
				D:   [8]uint32{3682055807, 1616959273, 395853116, 3275661608, 288741854, 1188719622, 1236758343, 335898006},
				A:   [7]uint32{4000683399, 3799287382, 629561130, 1261186911, 1248157186, 264108517, 3241504075},
				PC:  1686654,
				SR:  8977,
				USP: 2640024,
				SSP: 3423708,
				RAM: [][2]uint32{{1686648, 231}, {1686649, 182}, {1686650, 67}, {1686651, 79}, {1686652, 125}, {1686653, 253}},
				Cycles: 88,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXR.b D6, D1 ec31",
			init: cpuState{
				D:   [8]uint32{3623841440, 3198346320, 3386104119, 552690540, 4112752369, 2557529842, 1599728174, 1542238217},
				A:   [7]uint32{2158505195, 4052486220, 3152230173, 3850791191, 2370211014, 797637923, 2900650829},
				PC:  2163592,
				SR:  34306,
				USP: 4168450,
				SSP: 5012426,
				RAM: [][2]uint32{{2163588, 236}, {2163589, 49}, {2163590, 3}, {2163591, 63}, {2163592, 235}, {2163593, 177}},
			},
			want: cpuState{
				D:   [8]uint32{3623841440, 3198346280, 3386104119, 552690540, 4112752369, 2557529842, 1599728174, 1542238217},
				A:   [7]uint32{2158505195, 4052486220, 3152230173, 3850791191, 2370211014, 797637923, 2900650829},
				PC:  2163594,
				SR:  34304,
				USP: 4168450,
				SSP: 5012426,
				RAM: [][2]uint32{{2163588, 236}, {2163589, 49}, {2163590, 3}, {2163591, 63}, {2163592, 235}, {2163593, 177}},
				Cycles: 98,
			},
		},
		{
			name: "500 ROXR.b D4, D2 e832",
			init: cpuState{
				D:   [8]uint32{2782092444, 1222931083, 125472372, 3740530196, 796986648, 1634791739, 295085813, 1755345360},
				A:   [7]uint32{3303530064, 1926887908, 1304377090, 3398061506, 1165681538, 202488961, 2184507226},
				PC:  12746844,
				SR:  32798,
				USP: 474720,
				SSP: 16441932,
				RAM: [][2]uint32{{12746840, 232}, {12746841, 50}, {12746842, 223}, {12746843, 137}, {12746844, 14}, {12746845, 51}},
			},
			want: cpuState{
				D:   [8]uint32{2782092444, 1222931083, 125472421, 3740530196, 796986648, 1634791739, 295085813, 1755345360},
				A:   [7]uint32{3303530064, 1926887908, 1304377090, 3398061506, 1165681538, 202488961, 2184507226},
				PC:  12746846,
				SR:  32793,
				USP: 474720,
				SSP: 16441932,
				RAM: [][2]uint32{{12746840, 232}, {12746841, 50}, {12746842, 223}, {12746843, 137}, {12746844, 14}, {12746845, 51}},
				Cycles: 54,
			},
		},
		{
			name: "1000 ROXR.b D3, D7 e637",
			init: cpuState{
				D:   [8]uint32{1572493933, 1242746703, 2481842060, 3635134446, 3657187483, 2695904608, 3549775083, 1170509925},
				A:   [7]uint32{4176440638, 3632635470, 4214317626, 3987812813, 2698570862, 2071806792, 1048228260},
				PC:  2424474,
				SR:  34571,
				USP: 4322576,
				SSP: 13112656,
				RAM: [][2]uint32{{2424470, 230}, {2424471, 55}, {2424472, 241}, {2424473, 61}, {2424474, 212}, {2424475, 159}},
			},
			want: cpuState{
				D:   [8]uint32{1572493933, 1242746703, 2481842060, 3635134446, 3657187483, 2695904608, 3549775083, 1170509874},
				A:   [7]uint32{4176440638, 3632635470, 4214317626, 3987812813, 2698570862, 2071806792, 1048228260},
				PC:  2424476,
				SR:  34577,
				USP: 4322576,
				SSP: 13112656,
				RAM: [][2]uint32{{2424470, 230}, {2424471, 55}, {2424472, 241}, {2424473, 61}, {2424474, 212}, {2424475, 159}},
				Cycles: 98,
			},
		},
		{
			name: "1500 ROXR.b D2, D1 e431",
			init: cpuState{
				D:   [8]uint32{486877269, 1002087558, 990918967, 1468297591, 3375810292, 819847288, 2050381166, 2566453348},
				A:   [7]uint32{1406802376, 1635752358, 3352650593, 739460476, 3377594360, 4245348546, 185546116},
				PC:  561178,
				SR:  41244,
				USP: 9307870,
				SSP: 16508086,
				RAM: [][2]uint32{{561174, 228}, {561175, 49}, {561176, 181}, {561177, 146}, {561178, 185}, {561179, 71}},
			},
			want: cpuState{
				D:   [8]uint32{486877269, 1002087619, 990918967, 1468297591, 3375810292, 819847288, 2050381166, 2566453348},
				A:   [7]uint32{1406802376, 1635752358, 3352650593, 739460476, 3377594360, 4245348546, 185546116},
				PC:  561180,
				SR:  41224,
				USP: 9307870,
				SSP: 16508086,
				RAM: [][2]uint32{{561174, 228}, {561175, 49}, {561176, 181}, {561177, 146}, {561178, 185}, {561179, 71}},
				Cycles: 116,
			},
		},
		{
			name: "2000 ROXR.b 5, D2 ea12",
			init: cpuState{
				D:   [8]uint32{223056407, 860353106, 817485484, 444827187, 151254182, 1042365128, 4029887310, 2561820017},
				A:   [7]uint32{3428979474, 93286879, 2969653725, 321160559, 3099129752, 3281280617, 3496227334},
				PC:  4480148,
				SR:  33554,
				USP: 14648108,
				SSP: 4027144,
				RAM: [][2]uint32{{4480144, 234}, {4480145, 18}, {4480146, 51}, {4480147, 75}, {4480148, 120}, {4480149, 247}},
			},
			want: cpuState{
				D:   [8]uint32{223056407, 860353106, 817485517, 444827187, 151254182, 1042365128, 4029887310, 2561820017},
				A:   [7]uint32{3428979474, 93286879, 2969653725, 321160559, 3099129752, 3281280617, 3496227334},
				PC:  4480150,
				SR:  33544,
				USP: 14648108,
				SSP: 4027144,
				RAM: [][2]uint32{{4480144, 234}, {4480145, 18}, {4480146, 51}, {4480147, 75}, {4480148, 120}, {4480149, 247}},
				Cycles: 16,
			},
		},
		{
			name: "001 ROXR.b D3, D7 e637",
			init: 			cpuState{
				D:   [8]uint32{3955802285, 2873352649, 3896981049, 1712214939, 3867874357, 1521383477, 3818508784, 3713394239},
				A:   [7]uint32{3173452334, 1762441970, 3674935749, 2521918737, 1785518079, 2622116907, 2557469463},
				PC:  862790,
				SR:  8194,
				USP: 10029636,
				SSP: 1665662,
				RAM: [][2]uint32{{862786, 230}, {862787, 55}, {862788, 151}, {862789, 21}, {862790, 179}, {862791, 17}},
			},
			want: 			cpuState{
				D:   [8]uint32{3955802285, 2873352649, 3896981049, 1712214939, 3867874357, 1521383477, 3818508784, 3713394239},
				A:   [7]uint32{3173452334, 1762441970, 3674935749, 2521918737, 1785518079, 2622116907, 2557469463},
				PC:  862792,
				SR:  8192,
				USP: 10029636,
				SSP: 1665662,
				RAM: [][2]uint32{{862786, 230}, {862787, 55}, {862788, 151}, {862789, 21}, {862790, 179}, {862791, 17}},
				Cycles: 60,
			},
		},
		{
			name: "290 ROXR.b 8, D2 e012",
			init: 			cpuState{
				D:   [8]uint32{3148887687, 297978109, 1235246094, 328477243, 4054747075, 333058413, 3209022704, 2797061349},
				A:   [7]uint32{2304823345, 2027724989, 2186743265, 2062648496, 2480068777, 2435135471, 1690117773},
				PC:  10840298,
				SR:  1046,
				USP: 11102816,
				SSP: 4613142,
				RAM: [][2]uint32{{10840294, 224}, {10840295, 18}, {10840296, 79}, {10840297, 116}, {10840298, 124}, {10840299, 12}},
			},
			want: 			cpuState{
				D:   [8]uint32{3148887687, 297978109, 1235246109, 328477243, 4054747075, 333058413, 3209022704, 2797061349},
				A:   [7]uint32{2304823345, 2027724989, 2186743265, 2062648496, 2480068777, 2435135471, 1690117773},
				PC:  10840300,
				SR:  1024,
				USP: 11102816,
				SSP: 4613142,
				RAM: [][2]uint32{{10840294, 224}, {10840295, 18}, {10840296, 79}, {10840297, 116}, {10840298, 124}, {10840299, 12}},
				Cycles: 22,
			},
		},
		{
			name: "578 ROXR.b 6, D0 ec10",
			init: 			cpuState{
				D:   [8]uint32{3011973204, 1477115900, 3985649579, 3068413556, 3996277937, 2181415879, 2384378758, 1123675441},
				A:   [7]uint32{410764043, 1541759121, 398531520, 2260431572, 1132522105, 4262298861, 255001625},
				PC:  4066036,
				SR:  1803,
				USP: 9768042,
				SSP: 15007810,
				RAM: [][2]uint32{{4066032, 236}, {4066033, 16}, {4066034, 118}, {4066035, 243}, {4066036, 129}, {4066037, 153}},
			},
			want: 			cpuState{
				D:   [8]uint32{3011973281, 1477115900, 3985649579, 3068413556, 3996277937, 2181415879, 2384378758, 1123675441},
				A:   [7]uint32{410764043, 1541759121, 398531520, 2260431572, 1132522105, 4262298861, 255001625},
				PC:  4066038,
				SR:  1800,
				USP: 9768042,
				SSP: 15007810,
				RAM: [][2]uint32{{4066032, 236}, {4066033, 16}, {4066034, 118}, {4066035, 243}, {4066036, 129}, {4066037, 153}},
				Cycles: 18,
			},
		},
		{
			name: "877 ROXR.b 4, D3 e813",
			init: 			cpuState{
				D:   [8]uint32{3219964923, 1993409159, 149548948, 1595187628, 3121514255, 636347020, 4242218525, 2699775072},
				A:   [7]uint32{550252318, 4209152922, 2312843511, 1675905060, 347604025, 2538756076, 3955731779},
				PC:  859634,
				SR:  9238,
				USP: 8334406,
				SSP: 3780824,
				RAM: [][2]uint32{{859630, 232}, {859631, 19}, {859632, 102}, {859633, 225}, {859634, 29}, {859635, 221}},
			},
			want: 			cpuState{
				D:   [8]uint32{3219964923, 1993409159, 149548948, 1595187610, 3121514255, 636347020, 4242218525, 2699775072},
				A:   [7]uint32{550252318, 4209152922, 2312843511, 1675905060, 347604025, 2538756076, 3955731779},
				PC:  859636,
				SR:  9241,
				USP: 8334406,
				SSP: 3780824,
				RAM: [][2]uint32{{859630, 232}, {859631, 19}, {859632, 102}, {859633, 225}, {859634, 29}, {859635, 221}},
				Cycles: 14,
			},
		},
		{
			name: "1132 ROXR.b D1, D4 e234",
			init: 			cpuState{
				D:   [8]uint32{3586828743, 1975095537, 1659171641, 2249998142, 143328282, 3815256073, 598926207, 2724293670},
				A:   [7]uint32{3288507376, 2133646244, 2995356545, 166450479, 3057060502, 2712840053, 2036245310},
				PC:  10987694,
				SR:  9734,
				USP: 4366300,
				SSP: 16557638,
				RAM: [][2]uint32{{10987690, 226}, {10987691, 52}, {10987692, 198}, {10987693, 187}, {10987694, 225}, {10987695, 203}},
			},
			want: 			cpuState{
				D:   [8]uint32{3586828743, 1975095537, 1659171641, 2249998142, 143328321, 3815256073, 598926207, 2724293670},
				A:   [7]uint32{3288507376, 2133646244, 2995356545, 166450479, 3057060502, 2712840053, 2036245310},
				PC:  10987696,
				SR:  9745,
				USP: 4366300,
				SSP: 16557638,
				RAM: [][2]uint32{{10987690, 226}, {10987691, 52}, {10987692, 198}, {10987693, 187}, {10987694, 225}, {10987695, 203}},
				Cycles: 104,
			},
		},
		{
			name: "1404 ROXR.b 4, D1 e811",
			init: 			cpuState{
				D:   [8]uint32{2811851483, 1524709274, 3373757784, 1447027900, 3210821277, 141692176, 660706495, 917291758},
				A:   [7]uint32{414694658, 175611427, 2490295931, 2896422287, 1196199782, 373829717, 4013509090},
				PC:  5109010,
				SR:  8721,
				USP: 13984518,
				SSP: 5337960,
				RAM: [][2]uint32{{5109006, 232}, {5109007, 17}, {5109008, 19}, {5109009, 30}, {5109010, 146}, {5109011, 186}},
			},
			want: 			cpuState{
				D:   [8]uint32{2811851483, 1524709209, 3373757784, 1447027900, 3210821277, 141692176, 660706495, 917291758},
				A:   [7]uint32{414694658, 175611427, 2490295931, 2896422287, 1196199782, 373829717, 4013509090},
				PC:  5109012,
				SR:  8721,
				USP: 13984518,
				SSP: 5337960,
				RAM: [][2]uint32{{5109006, 232}, {5109007, 17}, {5109008, 19}, {5109009, 30}, {5109010, 146}, {5109011, 186}},
				Cycles: 14,
			},
		},
		{
			name: "1704 ROXR.b D2, D2 e432",
			init: 			cpuState{
				D:   [8]uint32{3327770128, 526943111, 2087303271, 3458654456, 4155767573, 4215639652, 3069919208, 2818114590},
				A:   [7]uint32{2064629452, 3248959382, 766716605, 3654660765, 3500435303, 3916304461, 950504488},
				PC:  5940706,
				SR:  1811,
				USP: 2331426,
				SSP: 2868750,
				RAM: [][2]uint32{{5940702, 228}, {5940703, 50}, {5940704, 239}, {5940705, 23}, {5940706, 165}, {5940707, 125}},
			},
			want: 			cpuState{
				D:   [8]uint32{3327770128, 526943111, 2087303404, 3458654456, 4155767573, 4215639652, 3069919208, 2818114590},
				A:   [7]uint32{2064629452, 3248959382, 766716605, 3654660765, 3500435303, 3916304461, 950504488},
				PC:  5940708,
				SR:  1817,
				USP: 2331426,
				SSP: 2868750,
				RAM: [][2]uint32{{5940702, 228}, {5940703, 50}, {5940704, 239}, {5940705, 23}, {5940706, 165}, {5940707, 125}},
				Cycles: 84,
			},
		},
		{
			name: "1991 ROXR.b 2, D1 e411",
			init: 			cpuState{
				D:   [8]uint32{1108801040, 2863252369, 2509614547, 758875158, 2824053061, 1530213628, 1197824509, 1632873156},
				A:   [7]uint32{1321230095, 3149022390, 790771914, 1894365019, 1587193840, 510516830, 615926201},
				PC:  3907034,
				SR:  1560,
				USP: 15117340,
				SSP: 6919908,
				RAM: [][2]uint32{{3907030, 228}, {3907031, 17}, {3907032, 98}, {3907033, 112}, {3907034, 88}, {3907035, 92}},
			},
			want: 			cpuState{
				D:   [8]uint32{1108801040, 2863252452, 2509614547, 758875158, 2824053061, 1530213628, 1197824509, 1632873156},
				A:   [7]uint32{1321230095, 3149022390, 790771914, 1894365019, 1587193840, 510516830, 615926201},
				PC:  3907036,
				SR:  1544,
				USP: 15117340,
				SSP: 6919908,
				RAM: [][2]uint32{{3907030, 228}, {3907031, 17}, {3907032, 98}, {3907033, 112}, {3907034, 88}, {3907035, 92}},
				Cycles: 10,
			},
		},
		{
			name: "2241 ROXR.b D2, D7 e437",
			init: 			cpuState{
				D:   [8]uint32{1636356336, 1583714899, 3721878626, 2012668691, 2466118541, 3947315571, 2925850494, 4243687435},
				A:   [7]uint32{2697439655, 3382811802, 4157168233, 4112256258, 149139413, 4185141100, 883453473},
				PC:  15040968,
				SR:  8968,
				USP: 6548950,
				SSP: 11577676,
				RAM: [][2]uint32{{15040964, 228}, {15040965, 55}, {15040966, 200}, {15040967, 208}, {15040968, 21}, {15040969, 107}},
			},
			want: 			cpuState{
				D:   [8]uint32{1636356336, 1583714899, 3721878626, 2012668691, 2466118541, 3947315571, 2925850494, 4243687468},
				A:   [7]uint32{2697439655, 3382811802, 4157168233, 4112256258, 149139413, 4185141100, 883453473},
				PC:  15040970,
				SR:  8960,
				USP: 6548950,
				SSP: 11577676,
				RAM: [][2]uint32{{15040964, 228}, {15040965, 55}, {15040966, 200}, {15040967, 208}, {15040968, 21}, {15040969, 107}},
				Cycles: 74,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXR.w D5, D3 ea73",
			init: cpuState{
				D:   [8]uint32{1329190401, 4074480233, 2494030275, 1192897080, 2067964349, 803052390, 3116563677, 2507272080},
				A:   [7]uint32{1200746960, 452131595, 1074516939, 2457237458, 1042184640, 606830823, 2499500178},
				PC:  14299874,
				SR:  33040,
				USP: 3748690,
				SSP: 1797242,
				RAM: [][2]uint32{{14299870, 234}, {14299871, 115}, {14299872, 89}, {14299873, 132}, {14299874, 215}, {14299875, 61}},
			},
			want: cpuState{
				D:   [8]uint32{1329190401, 4074480233, 2494030275, 1192891043, 2067964349, 803052390, 3116563677, 2507272080},
				A:   [7]uint32{1200746960, 452131595, 1074516939, 2457237458, 1042184640, 606830823, 2499500178},
				PC:  14299876,
				SR:  33041,
				USP: 3748690,
				SSP: 1797242,
				RAM: [][2]uint32{{14299870, 234}, {14299871, 115}, {14299872, 89}, {14299873, 132}, {14299874, 215}, {14299875, 61}},
				Cycles: 82,
			},
		},
		{
			name: "500 ROXR.w 1, D0 e250",
			init: cpuState{
				D:   [8]uint32{2739142725, 551171465, 1640601694, 2138938118, 2295062151, 4264828930, 628095856, 3851909396},
				A:   [7]uint32{4186578439, 2820120422, 2363731840, 1542132239, 1305989900, 3525764322, 2389130332},
				PC:  8803538,
				SR:  9240,
				USP: 13059780,
				SSP: 1519332,
				RAM: [][2]uint32{{8803534, 226}, {8803535, 80}, {8803536, 218}, {8803537, 104}, {8803538, 243}, {8803539, 201}},
			},
			want: cpuState{
				D:   [8]uint32{2739175458, 551171465, 1640601694, 2138938118, 2295062151, 4264828930, 628095856, 3851909396},
				A:   [7]uint32{4186578439, 2820120422, 2363731840, 1542132239, 1305989900, 3525764322, 2389130332},
				PC:  8803540,
				SR:  9241,
				USP: 13059780,
				SSP: 1519332,
				RAM: [][2]uint32{{8803534, 226}, {8803535, 80}, {8803536, 218}, {8803537, 104}, {8803538, 243}, {8803539, 201}},
				Cycles: 8,
			},
		},
		{
			name: "1000 ROXR.w D3, D5 e675",
			init: cpuState{
				D:   [8]uint32{2700543425, 1982586405, 1448541508, 2033317950, 2978989195, 3856332278, 1339320691, 3288724805},
				A:   [7]uint32{945415922, 3370685326, 2355392031, 2511591159, 255544016, 3969967034, 932609138},
				PC:  15223484,
				SR:  32786,
				USP: 15018920,
				SSP: 16311494,
				RAM: [][2]uint32{{15223480, 230}, {15223481, 117}, {15223482, 40}, {15223483, 77}, {15223484, 22}, {15223485, 209}},
			},
			want: cpuState{
				D:   [8]uint32{2700543425, 1982586405, 1448541508, 2033317950, 2978989195, 3856301502, 1339320691, 3288724805},
				A:   [7]uint32{945415922, 3370685326, 2355392031, 2511591159, 255544016, 3969967034, 932609138},
				PC:  15223486,
				SR:  32785,
				USP: 15018920,
				SSP: 16311494,
				RAM: [][2]uint32{{15223480, 230}, {15223481, 117}, {15223482, 40}, {15223483, 77}, {15223484, 22}, {15223485, 209}},
				Cycles: 130,
			},
		},
		{
			name: "1500 ROXR.w -(A4) e4e4",
			init: cpuState{
				D:   [8]uint32{2947562698, 187237743, 3648254640, 919608884, 676476048, 3993767519, 4220853451, 2535512199},
				A:   [7]uint32{762023324, 3083915446, 3200088376, 364639124, 2437462145, 1723522478, 785132740},
				PC:  15975640,
				SR:  1555,
				USP: 12443036,
				SSP: 8106004,
				RAM: [][2]uint32{{15975636, 228}, {15975637, 228}, {15975638, 140}, {15975639, 149}, {12, 147}, {13, 90}, {14, 43}, {15, 172}, {5909420, 134}, {5909421, 103}, {5909422, 34}, {5909423, 243}},
			},
			want: cpuState{
				D:      [8]uint32{2947562698, 187237743, 3648254640, 919608884, 676476048, 3993767519, 4220853451, 2535512199},
				A:      [7]uint32{762023324, 3083915446, 3200088376, 364639124, 2437462143, 1723522478, 785132740},
				PC:     2472160176,
				SR:     9747,
				USP:    12443036,
				SSP:    8105990,
				RAM:    [][2]uint32{{15975636, 228}, {15975637, 228}, {15975638, 140}, {15975639, 149}, {8106002, 196}, {8106003, 216}, {8105998, 6}, {8105999, 19}, {8106000, 0}, {8106001, 243}, {8105996, 228}, {8105997, 228}, {8105994, 184}, {8105995, 127}, {8105990, 228}, {8105991, 241}, {8105992, 145}, {8105993, 72}, {12, 147}, {13, 90}, {14, 43}, {15, 172}, {5909420, 134}, {5909421, 103}, {5909422, 34}, {5909423, 243}},
				Halted: true,
			},
		},
		{
			name: "2000 ROXR.w (d8, A7, Xn) e4f7",
			init: cpuState{
				D:   [8]uint32{2221296205, 3249843068, 1099897860, 1255220298, 1013862620, 2157686022, 1556306772, 1186902100},
				A:   [7]uint32{1866948341, 3244963754, 889163861, 1299200919, 375758170, 4292992949, 3641432100},
				PC:  14017340,
				SR:  9234,
				USP: 1060988,
				SSP: 9879920,
				RAM: [][2]uint32{{14017336, 228}, {14017337, 247}, {14017338, 42}, {14017339, 55}, {14017340, 149}, {14017341, 49}, {12, 101}, {13, 162}, {14, 57}, {15, 64}, {10631488, 66}, {10631489, 61}, {10631490, 170}, {10631491, 20}},
			},
			want: cpuState{
				D:      [8]uint32{2221296205, 3249843068, 1099897860, 1255220298, 1013862620, 2157686022, 1556306772, 1186902100},
				A:      [7]uint32{1866948341, 3244963754, 889163861, 1299200919, 375758170, 4292992949, 3641432100},
				PC:     1705130308,
				SR:     9234,
				USP:    1060988,
				SSP:    9879906,
				RAM:    [][2]uint32{{14017336, 228}, {14017337, 247}, {14017338, 42}, {14017339, 55}, {14017340, 149}, {14017341, 49}, {9879918, 227}, {9879919, 58}, {9879914, 36}, {9879915, 18}, {9879916, 0}, {9879917, 213}, {9879912, 228}, {9879913, 247}, {9879910, 221}, {9879911, 171}, {9879906, 228}, {9879907, 245}, {9879908, 66}, {9879909, 37}, {12, 101}, {13, 162}, {14, 57}, {15, 64}, {10631488, 66}, {10631489, 61}, {10631490, 170}, {10631491, 20}},
				Halted: true,
			},
		},
		{
			name: "001 ROXR.w 2, D3 e453",
			init: 			cpuState{
				D:   [8]uint32{50412554, 4293281272, 1547875058, 481290542, 2789339906, 639155023, 3267940637, 1037177560},
				A:   [7]uint32{3479905198, 2484195278, 1438167841, 1798630222, 2057581431, 2635449463, 2185652952},
				PC:  6684474,
				SR:  8474,
				USP: 13355018,
				SSP: 7007938,
				RAM: [][2]uint32{{6684470, 228}, {6684471, 83}, {6684472, 122}, {6684473, 248}, {6684474, 217}, {6684475, 33}},
			},
			want: 			cpuState{
				D:   [8]uint32{50412554, 4293281272, 1547875058, 481262155, 2789339906, 639155023, 3267940637, 1037177560},
				A:   [7]uint32{3479905198, 2484195278, 1438167841, 1798630222, 2057581431, 2635449463, 2185652952},
				PC:  6684476,
				SR:  8465,
				USP: 13355018,
				SSP: 7007938,
				RAM: [][2]uint32{{6684470, 228}, {6684471, 83}, {6684472, 122}, {6684473, 248}, {6684474, 217}, {6684475, 33}},
				Cycles: 10,
			},
		},
		{
			name: "261 ROXR.w D5, D2 ea72",
			init: 			cpuState{
				D:   [8]uint32{3846801202, 655539578, 2225213651, 722736500, 3964482546, 913964123, 1582596565, 3496267072},
				A:   [7]uint32{204229375, 3374798933, 2794742417, 1016673283, 3105320415, 1029666999, 3834185541},
				PC:  11951780,
				SR:  1794,
				USP: 2985794,
				SSP: 4910850,
				RAM: [][2]uint32{{11951776, 234}, {11951777, 114}, {11951778, 177}, {11951779, 230}, {11951780, 196}, {11951781, 113}},
			},
			want: 			cpuState{
				D:   [8]uint32{3846801202, 655539578, 2225236356, 722736500, 3964482546, 913964123, 1582596565, 3496267072},
				A:   [7]uint32{204229375, 3374798933, 2794742417, 1016673283, 3105320415, 1029666999, 3834185541},
				PC:  11951782,
				SR:  1792,
				USP: 2985794,
				SSP: 4910850,
				RAM: [][2]uint32{{11951776, 234}, {11951777, 114}, {11951778, 177}, {11951779, 230}, {11951780, 196}, {11951781, 113}},
				Cycles: 60,
			},
		},
		{
			name: "560 ROXR.w 1, D2 e252",
			init: 			cpuState{
				D:   [8]uint32{2481674626, 3462310787, 3090833424, 4157587842, 2233644092, 2470174306, 2088900391, 3998419599},
				A:   [7]uint32{3227913276, 2505776839, 1654509727, 4008762626, 592267269, 3939224299, 203883265},
				PC:  11755692,
				SR:  1287,
				USP: 14070258,
				SSP: 3070918,
				RAM: [][2]uint32{{11755688, 226}, {11755689, 82}, {11755690, 41}, {11755691, 116}, {11755692, 172}, {11755693, 157}},
			},
			want: 			cpuState{
				D:   [8]uint32{2481674626, 3462310787, 3090821128, 4157587842, 2233644092, 2470174306, 2088900391, 3998419599},
				A:   [7]uint32{3227913276, 2505776839, 1654509727, 4008762626, 592267269, 3939224299, 203883265},
				PC:  11755694,
				SR:  1280,
				USP: 14070258,
				SSP: 3070918,
				RAM: [][2]uint32{{11755688, 226}, {11755689, 82}, {11755690, 41}, {11755691, 116}, {11755692, 172}, {11755693, 157}},
				Cycles: 8,
			},
		},
		{
			name: "829 ROXR.w (d8, A0, Xn) e4f0",
			init: 			cpuState{
				D:   [8]uint32{3852692964, 1990948579, 3796252836, 1528101530, 1837382018, 1195826518, 3472320679, 2058178389},
				A:   [7]uint32{2557517560, 210427443, 1380058093, 371745120, 4134688528, 390636645, 472340718},
				PC:  3762642,
				SR:  8981,
				USP: 9760284,
				SSP: 4651270,
				RAM: [][2]uint32{{3762638, 228}, {3762639, 240}, {3762640, 142}, {3762641, 254}, {3762642, 18}, {3762643, 55}, {14761454, 179}, {14761455, 130}, {3762644, 189}, {3762645, 147}},
			},
			want: 			cpuState{
				D:   [8]uint32{3852692964, 1990948579, 3796252836, 1528101530, 1837382018, 1195826518, 3472320679, 2058178389},
				A:   [7]uint32{2557517560, 210427443, 1380058093, 371745120, 4134688528, 390636645, 472340718},
				PC:  3762646,
				SR:  8968,
				USP: 9760284,
				SSP: 4651270,
				RAM: [][2]uint32{{3762638, 228}, {3762639, 240}, {3762640, 142}, {3762641, 254}, {3762642, 18}, {3762643, 55}, {14761454, 217}, {14761455, 193}, {3762644, 189}, {3762645, 147}},
				Cycles: 18,
			},
		},
		{
			name: "1133 ROXR.w D7, D0 ee70",
			init: 			cpuState{
				D:   [8]uint32{421434220, 1709995670, 212979749, 1616715989, 3406735948, 1220243840, 379640530, 2031030415},
				A:   [7]uint32{2957748611, 2712673481, 1102918476, 1823108265, 395213024, 3496041128, 3313951900},
				PC:  15140954,
				SR:  1541,
				USP: 1236988,
				SSP: 435592,
				RAM: [][2]uint32{{15140950, 238}, {15140951, 112}, {15140952, 153}, {15140953, 219}, {15140954, 81}, {15140955, 143}},
			},
			want: 			cpuState{
				D:   [8]uint32{421416369, 1709995670, 212979749, 1616715989, 3406735948, 1220243840, 379640530, 2031030415},
				A:   [7]uint32{2957748611, 2712673481, 1102918476, 1823108265, 395213024, 3496041128, 3313951900},
				PC:  15140956,
				SR:  1536,
				USP: 1236988,
				SSP: 435592,
				RAM: [][2]uint32{{15140950, 238}, {15140951, 112}, {15140952, 153}, {15140953, 219}, {15140954, 81}, {15140955, 143}},
				Cycles: 36,
			},
		},
		{
			name: "1391 ROXR.w D1, D3 e273",
			init: 			cpuState{
				D:   [8]uint32{780671508, 2409361026, 2259302475, 1647123659, 1104381059, 4230953780, 3590378990, 2505778844},
				A:   [7]uint32{2786052666, 1266624374, 1339863774, 2700428754, 1036062489, 2368812945, 3284114246},
				PC:  2936464,
				SR:  778,
				USP: 3803710,
				SSP: 6070022,
				RAM: [][2]uint32{{2936460, 226}, {2936461, 115}, {2936462, 42}, {2936463, 196}, {2936464, 149}, {2936465, 137}},
			},
			want: 			cpuState{
				D:   [8]uint32{780671508, 2409361026, 2259302475, 1647150898, 1104381059, 4230953780, 3590378990, 2505778844},
				A:   [7]uint32{2786052666, 1266624374, 1339863774, 2700428754, 1036062489, 2368812945, 3284114246},
				PC:  2936466,
				SR:  793,
				USP: 3803710,
				SSP: 6070022,
				RAM: [][2]uint32{{2936460, 226}, {2936461, 115}, {2936462, 42}, {2936463, 196}, {2936464, 149}, {2936465, 137}},
				Cycles: 10,
			},
		},
		{
			name: "1650 ROXR.w D7, D1 ee71",
			init: 			cpuState{
				D:   [8]uint32{4237697015, 3212605904, 1536627534, 1908313884, 3454179293, 3602030662, 280545703, 662419359},
				A:   [7]uint32{15450173, 1834167322, 1739198460, 872831324, 3089278786, 3307302027, 3978423696},
				PC:  5830668,
				SR:  1307,
				USP: 16545336,
				SSP: 5154238,
				RAM: [][2]uint32{{5830664, 238}, {5830665, 113}, {5830666, 92}, {5830667, 179}, {5830668, 20}, {5830669, 100}},
			},
			want: 			cpuState{
				D:   [8]uint32{4237697015, 3212627589, 1536627534, 1908313884, 3454179293, 3602030662, 280545703, 662419359},
				A:   [7]uint32{15450173, 1834167322, 1739198460, 872831324, 3089278786, 3307302027, 3978423696},
				PC:  5830670,
				SR:  1305,
				USP: 16545336,
				SSP: 5154238,
				RAM: [][2]uint32{{5830664, 238}, {5830665, 113}, {5830666, 92}, {5830667, 179}, {5830668, 20}, {5830669, 100}},
				Cycles: 68,
			},
		},
		{
			name: "1929 ROXR.w 4, D4 e854",
			init: 			cpuState{
				D:   [8]uint32{1548784270, 591506299, 3765621261, 1472325214, 3763138897, 3161957012, 227065224, 1661678962},
				A:   [7]uint32{1644048389, 881354071, 1067902414, 4273892356, 2334616964, 102493816, 1506690972},
				PC:  408700,
				SR:  9747,
				USP: 12107446,
				SSP: 624514,
				RAM: [][2]uint32{{408696, 232}, {408697, 84}, {408698, 7}, {408699, 75}, {408700, 223}, {408701, 220}},
			},
			want: 			cpuState{
				D:   [8]uint32{1548784270, 591506299, 3765621261, 1472325214, 3763093269, 3161957012, 227065224, 1661678962},
				A:   [7]uint32{1644048389, 881354071, 1067902414, 4273892356, 2334616964, 102493816, 1506690972},
				PC:  408702,
				SR:  9728,
				USP: 12107446,
				SSP: 624514,
				RAM: [][2]uint32{{408696, 232}, {408697, 84}, {408698, 7}, {408699, 75}, {408700, 223}, {408701, 220}},
				Cycles: 14,
			},
		},
		{
			name: "2215 ROXR.w (xxx).l e4f9",
			init: 			cpuState{
				D:   [8]uint32{1073754080, 2193001953, 3368542354, 3341830866, 3954235493, 3429182751, 2435073868, 2236985981},
				A:   [7]uint32{237048264, 2500804046, 873294270, 2962715636, 940796412, 864358383, 1059812299},
				PC:  666194,
				SR:  1817,
				USP: 15828742,
				SSP: 11103304,
				RAM: [][2]uint32{{666190, 228}, {666191, 249}, {666192, 149}, {666193, 205}, {666194, 9}, {666195, 20}, {666196, 28}, {666197, 86}, {13437204, 8}, {13437205, 107}, {666198, 163}, {666199, 191}},
			},
			want: 			cpuState{
				D:   [8]uint32{1073754080, 2193001953, 3368542354, 3341830866, 3954235493, 3429182751, 2435073868, 2236985981},
				A:   [7]uint32{237048264, 2500804046, 873294270, 2962715636, 940796412, 864358383, 1059812299},
				PC:  666200,
				SR:  1817,
				USP: 15828742,
				SSP: 11103304,
				RAM: [][2]uint32{{666190, 228}, {666191, 249}, {666192, 149}, {666193, 205}, {666194, 9}, {666195, 20}, {666196, 28}, {666197, 86}, {13437204, 132}, {13437205, 53}, {666198, 163}, {666199, 191}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXR.l 2, D1 e491",
			init: cpuState{
				D:   [8]uint32{1626499950, 147021276, 1251612528, 1479115659, 2737996838, 2942975442, 1416156362, 3304479545},
				A:   [7]uint32{2914351705, 3084561235, 1112006070, 2808150222, 1688000459, 2420340494, 654370242},
				PC:  15965060,
				SR:  42251,
				USP: 8418114,
				SSP: 5936636,
				RAM: [][2]uint32{{15965056, 228}, {15965057, 145}, {15965058, 12}, {15965059, 33}, {15965060, 96}, {15965061, 120}},
			},
			want: cpuState{
				D:   [8]uint32{1626499950, 36755319, 1251612528, 1479115659, 2737996838, 2942975442, 1416156362, 3304479545},
				A:   [7]uint32{2914351705, 3084561235, 1112006070, 2808150222, 1688000459, 2420340494, 654370242},
				PC:  15965062,
				SR:  42240,
				USP: 8418114,
				SSP: 5936636,
				RAM: [][2]uint32{{15965056, 228}, {15965057, 145}, {15965058, 12}, {15965059, 33}, {15965060, 96}, {15965061, 120}},
				Cycles: 12,
			},
		},
		{
			name: "500 ROXR.l 5, D1 ea91",
			init: cpuState{
				D:   [8]uint32{217673091, 2047086554, 2827715803, 1397985621, 1082040501, 558223305, 3036396724, 2405679841},
				A:   [7]uint32{2426885075, 37792388, 3902575069, 1375239182, 2304328674, 1937238032, 2572089972},
				PC:  4088386,
				SR:  41987,
				USP: 3272914,
				SSP: 2540066,
				RAM: [][2]uint32{{4088382, 234}, {4088383, 145}, {4088384, 230}, {4088385, 87}, {4088386, 153}, {4088387, 95}},
			},
			want: cpuState{
				D:   [8]uint32{217673091, 2748326014, 2827715803, 1397985621, 1082040501, 558223305, 3036396724, 2405679841},
				A:   [7]uint32{2426885075, 37792388, 3902575069, 1375239182, 2304328674, 1937238032, 2572089972},
				PC:  4088388,
				SR:  42009,
				USP: 3272914,
				SSP: 2540066,
				RAM: [][2]uint32{{4088382, 234}, {4088383, 145}, {4088384, 230}, {4088385, 87}, {4088386, 153}, {4088387, 95}},
				Cycles: 18,
			},
		},
		{
			name: "1000 ROXR.l 3, D0 e690",
			init: cpuState{
				D:   [8]uint32{4258016937, 1686888417, 4064370312, 1905504411, 1811354974, 2448860787, 1961686684, 1985519408},
				A:   [7]uint32{383240575, 3188816768, 4101467563, 1054626229, 2018142216, 3923168104, 1373523313},
				PC:  13993818,
				SR:  10,
				USP: 6478126,
				SSP: 3343322,
				RAM: [][2]uint32{{13993814, 230}, {13993815, 144}, {13993816, 240}, {13993817, 18}, {13993818, 246}, {13993819, 73}},
			},
			want: cpuState{
				D:   [8]uint32{1605993941, 1686888417, 4064370312, 1905504411, 1811354974, 2448860787, 1961686684, 1985519408},
				A:   [7]uint32{383240575, 3188816768, 4101467563, 1054626229, 2018142216, 3923168104, 1373523313},
				PC:  13993820,
				SR:  0,
				USP: 6478126,
				SSP: 3343322,
				RAM: [][2]uint32{{13993814, 230}, {13993815, 144}, {13993816, 240}, {13993817, 18}, {13993818, 246}, {13993819, 73}},
				Cycles: 14,
			},
		},
		{
			name: "1500 ROXR.l 2, D3 e493",
			init: cpuState{
				D:   [8]uint32{2626493885, 3872568981, 2488597080, 3135332512, 3977031352, 76448100, 2531278970, 1131219027},
				A:   [7]uint32{2465585106, 3877281634, 1436145199, 1621472570, 1369017753, 1373026260, 3271330019},
				PC:  2358614,
				SR:  787,
				USP: 13678936,
				SSP: 3770536,
				RAM: [][2]uint32{{2358610, 228}, {2358611, 147}, {2358612, 116}, {2358613, 179}, {2358614, 50}, {2358615, 49}},
			},
			want: cpuState{
				D:   [8]uint32{2626493885, 3872568981, 2488597080, 1857574952, 3977031352, 76448100, 2531278970, 1131219027},
				A:   [7]uint32{2465585106, 3877281634, 1436145199, 1621472570, 1369017753, 1373026260, 3271330019},
				PC:  2358616,
				SR:  768,
				USP: 13678936,
				SSP: 3770536,
				RAM: [][2]uint32{{2358610, 228}, {2358611, 147}, {2358612, 116}, {2358613, 179}, {2358614, 50}, {2358615, 49}},
				Cycles: 12,
			},
		},
		{
			name: "2000 ROXR.l 6, D3 ec93",
			init: cpuState{
				D:   [8]uint32{4076003842, 444913946, 3551417328, 765155946, 676891064, 1824174519, 588451248, 2399082426},
				A:   [7]uint32{103345324, 2155767227, 2914944031, 2530526688, 3764854858, 1041764143, 1170845206},
				PC:  4074050,
				SR:  24,
				USP: 13157768,
				SSP: 12140022,
				RAM: [][2]uint32{{4074046, 236}, {4074047, 147}, {4074048, 118}, {4074049, 57}, {4074050, 209}, {4074051, 252}},
			},
			want: cpuState{
				D:   [8]uint32{4076003842, 444913946, 3551417328, 1421241705, 676891064, 1824174519, 588451248, 2399082426},
				A:   [7]uint32{103345324, 2155767227, 2914944031, 2530526688, 3764854858, 1041764143, 1170845206},
				PC:  4074052,
				SR:  17,
				USP: 13157768,
				SSP: 12140022,
				RAM: [][2]uint32{{4074046, 236}, {4074047, 147}, {4074048, 118}, {4074049, 57}, {4074050, 209}, {4074051, 252}},
				Cycles: 20,
			},
		},
		{
			name: "001 ROXR.l D1, D5 e2b5",
			init: 			cpuState{
				D:   [8]uint32{991317220, 2540418238, 806542493, 1900923686, 3395170519, 2849484149, 3229454956, 2263872114},
				A:   [7]uint32{3988497409, 2628620864, 273855156, 304092709, 1903195361, 4034219102, 1537799079},
				PC:  8448600,
				SR:  796,
				USP: 2728376,
				SSP: 2767172,
				RAM: [][2]uint32{{8448596, 226}, {8448597, 181}, {8448598, 9}, {8448599, 155}, {8448600, 20}, {8448601, 41}},
			},
			want: 			cpuState{
				D:   [8]uint32{991317220, 2540418238, 806542493, 1900923686, 3395170519, 2642073437, 3229454956, 2263872114},
				A:   [7]uint32{3988497409, 2628620864, 273855156, 304092709, 1903195361, 4034219102, 1537799079},
				PC:  8448602,
				SR:  776,
				USP: 2728376,
				SSP: 2767172,
				RAM: [][2]uint32{{8448596, 226}, {8448597, 181}, {8448598, 9}, {8448599, 155}, {8448600, 20}, {8448601, 41}},
				Cycles: 132,
			},
		},
		{
			name: "262 ROXR.l 6, D1 ec91",
			init: 			cpuState{
				D:   [8]uint32{1495345632, 446772988, 4032679666, 1886450757, 1710266821, 2176203194, 1805439656, 4250137804},
				A:   [7]uint32{25941387, 3155891355, 3223234489, 2344061296, 752944443, 1191399887, 3598671876},
				PC:  14542282,
				SR:  9228,
				USP: 7745836,
				SSP: 6325196,
				RAM: [][2]uint32{{14542278, 236}, {14542279, 145}, {14542280, 200}, {14542281, 196}, {14542282, 147}, {14542283, 12}},
			},
			want: 			cpuState{
				D:   [8]uint32{1495345632, 3765077211, 4032679666, 1886450757, 1710266821, 2176203194, 1805439656, 4250137804},
				A:   [7]uint32{25941387, 3155891355, 3223234489, 2344061296, 752944443, 1191399887, 3598671876},
				PC:  14542284,
				SR:  9241,
				USP: 7745836,
				SSP: 6325196,
				RAM: [][2]uint32{{14542278, 236}, {14542279, 145}, {14542280, 200}, {14542281, 196}, {14542282, 147}, {14542283, 12}},
				Cycles: 20,
			},
		},
		{
			name: "531 ROXR.l D7, D0 eeb0",
			init: 			cpuState{
				D:   [8]uint32{2562186400, 501886098, 3773576930, 357949088, 2942600046, 4281699838, 324670682, 1680649176},
				A:   [7]uint32{4154065563, 279830530, 3450977863, 62324837, 2474606292, 1134058348, 3173017954},
				PC:  4186196,
				SR:  528,
				USP: 1357536,
				SSP: 2073024,
				RAM: [][2]uint32{{4186192, 238}, {4186193, 176}, {4186194, 53}, {4186195, 171}, {4186196, 123}, {4186197, 165}},
			},
			want: 			cpuState{
				D:   [8]uint32{1874411928, 501886098, 3773576930, 357949088, 2942600046, 4281699838, 324670682, 1680649176},
				A:   [7]uint32{4154065563, 279830530, 3450977863, 62324837, 2474606292, 1134058348, 3173017954},
				PC:  4186198,
				SR:  529,
				USP: 1357536,
				SSP: 2073024,
				RAM: [][2]uint32{{4186192, 238}, {4186193, 176}, {4186194, 53}, {4186195, 171}, {4186196, 123}, {4186197, 165}},
				Cycles: 56,
			},
		},
		{
			name: "809 ROXR.l D6, D4 ecb4",
			init: 			cpuState{
				D:   [8]uint32{1288521540, 1216980396, 1017346325, 2153384147, 1295363782, 3652390686, 1544978819, 1768247999},
				A:   [7]uint32{1974919087, 1283807039, 3113408753, 2506247090, 1283485451, 260972013, 4247772031},
				PC:  10029054,
				SR:  1025,
				USP: 14171092,
				SSP: 10075020,
				RAM: [][2]uint32{{10029050, 236}, {10029051, 180}, {10029052, 37}, {10029053, 107}, {10029054, 79}, {10029055, 185}},
			},
			want: 			cpuState{
				D:   [8]uint32{1288521540, 1216980396, 1017346325, 2153384147, 2309404120, 3652390686, 1544978819, 1768247999},
				A:   [7]uint32{1974919087, 1283807039, 3113408753, 2506247090, 1283485451, 260972013, 4247772031},
				PC:  10029056,
				SR:  1049,
				USP: 14171092,
				SSP: 10075020,
				RAM: [][2]uint32{{10029050, 236}, {10029051, 180}, {10029052, 37}, {10029053, 107}, {10029054, 79}, {10029055, 185}},
				Cycles: 14,
			},
		},
		{
			name: "1091 ROXR.l 2, D6 e496",
			init: 			cpuState{
				D:   [8]uint32{1848043047, 4251180248, 2071070074, 2276676234, 415070672, 1916571476, 163094522, 2750717267},
				A:   [7]uint32{2732362837, 498305896, 3605046214, 3848611334, 892870980, 4260617159, 3133530992},
				PC:  9112148,
				SR:  1555,
				USP: 8414034,
				SSP: 14611976,
				RAM: [][2]uint32{{9112144, 228}, {9112145, 150}, {9112146, 230}, {9112147, 212}, {9112148, 105}, {9112149, 70}},
			},
			want: 			cpuState{
				D:   [8]uint32{1848043047, 4251180248, 2071070074, 2276676234, 415070672, 1916571476, 1114515454, 2750717267},
				A:   [7]uint32{2732362837, 498305896, 3605046214, 3848611334, 892870980, 4260617159, 3133530992},
				PC:  9112150,
				SR:  1553,
				USP: 8414034,
				SSP: 14611976,
				RAM: [][2]uint32{{9112144, 228}, {9112145, 150}, {9112146, 230}, {9112147, 212}, {9112148, 105}, {9112149, 70}},
				Cycles: 12,
			},
		},
		{
			name: "1363 ROXR.l D1, D1 e2b1",
			init: 			cpuState{
				D:   [8]uint32{3668776971, 682813756, 1641441987, 3240754074, 1933232020, 1815976895, 1416478238, 2411970995},
				A:   [7]uint32{130605435, 1571678288, 641121554, 2314023105, 233654177, 407519852, 2597945432},
				PC:  12328768,
				SR:  8468,
				USP: 7945240,
				SSP: 3021798,
				RAM: [][2]uint32{{12328764, 226}, {12328765, 177}, {12328766, 205}, {12328767, 211}, {12328768, 109}, {12328769, 81}},
			},
			want: 			cpuState{
				D:   [8]uint32{3668776971, 750407461, 1641441987, 3240754074, 1933232020, 1815976895, 1416478238, 2411970995},
				A:   [7]uint32{130605435, 1571678288, 641121554, 2314023105, 233654177, 407519852, 2597945432},
				PC:  12328770,
				SR:  8448,
				USP: 7945240,
				SSP: 3021798,
				RAM: [][2]uint32{{12328764, 226}, {12328765, 177}, {12328766, 205}, {12328767, 211}, {12328768, 109}, {12328769, 81}},
				Cycles: 128,
			},
		},
		{
			name: "1655 ROXR.l D1, D5 e2b5",
			init: 			cpuState{
				D:   [8]uint32{3018297474, 1159274476, 1500810354, 2971065934, 2171588332, 2979435099, 2616512550, 3516906760},
				A:   [7]uint32{506228677, 2310445554, 2713047185, 3017332730, 552197620, 4159338258, 4089112964},
				PC:  5989922,
				SR:  1539,
				USP: 8811842,
				SSP: 8120680,
				RAM: [][2]uint32{{5989918, 226}, {5989919, 181}, {5989920, 86}, {5989921, 130}, {5989922, 236}, {5989923, 238}},
			},
			want: 			cpuState{
				D:   [8]uint32{3018297474, 1159274476, 1500810354, 2971065934, 2171588332, 2530620114, 2616512550, 3516906760},
				A:   [7]uint32{506228677, 2310445554, 2713047185, 3017332730, 552197620, 4159338258, 4089112964},
				PC:  5989924,
				SR:  1544,
				USP: 8811842,
				SSP: 8120680,
				RAM: [][2]uint32{{5989918, 226}, {5989919, 181}, {5989920, 86}, {5989921, 130}, {5989922, 236}, {5989923, 238}},
				Cycles: 96,
			},
		},
		{
			name: "1915 ROXR.l D5, D5 eab5",
			init: 			cpuState{
				D:   [8]uint32{1262972283, 2592194478, 589785885, 2474787383, 1041491449, 196996121, 4115199683, 682021432},
				A:   [7]uint32{3336407025, 3258815203, 4229158069, 1023623948, 4254198399, 300056964, 3557346010},
				PC:  8690790,
				SR:  9486,
				USP: 14171688,
				SSP: 15679060,
				RAM: [][2]uint32{{8690786, 234}, {8690787, 181}, {8690788, 6}, {8690789, 40}, {8690790, 113}, {8690791, 197}},
			},
			want: 			cpuState{
				D:   [8]uint32{1262972283, 2592194478, 589785885, 2474787383, 1041491449, 3186366725, 4115199683, 682021432},
				A:   [7]uint32{3336407025, 3258815203, 4229158069, 1023623948, 4254198399, 300056964, 3557346010},
				PC:  8690792,
				SR:  9497,
				USP: 14171688,
				SSP: 15679060,
				RAM: [][2]uint32{{8690786, 234}, {8690787, 181}, {8690788, 6}, {8690789, 40}, {8690790, 113}, {8690791, 197}},
				Cycles: 58,
			},
		},
		{
			name: "2231 ROXR.l 1, D4 e294",
			init: 			cpuState{
				D:   [8]uint32{1333736293, 321968751, 3288294926, 4252970686, 1721951231, 2384544617, 306292957, 2613297555},
				A:   [7]uint32{3064035361, 1045474845, 3869865693, 3674212947, 3817872152, 871172718, 847371384},
				PC:  16441776,
				SR:  9758,
				USP: 11927096,
				SSP: 6546568,
				RAM: [][2]uint32{{16441772, 226}, {16441773, 148}, {16441774, 79}, {16441775, 169}, {16441776, 62}, {16441777, 133}},
			},
			want: 			cpuState{
				D:   [8]uint32{1333736293, 321968751, 3288294926, 4252970686, 3008459263, 2384544617, 306292957, 2613297555},
				A:   [7]uint32{3064035361, 1045474845, 3869865693, 3674212947, 3817872152, 871172718, 847371384},
				PC:  16441778,
				SR:  9753,
				USP: 11927096,
				SSP: 6546568,
				RAM: [][2]uint32{{16441772, 226}, {16441773, 148}, {16441774, 79}, {16441775, 169}, {16441776, 62}, {16441777, 133}},
				Cycles: 10,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}
