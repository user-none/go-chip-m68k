package m68k

import "testing"

func TestAND_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 AND.b D6, (A1) cd11",
			init: cpuState{
				D:   [8]uint32{1410882485, 2524850606, 3640704972, 3188579189, 2123281346, 2336967668, 631222683, 1838937900},
				A:   [7]uint32{3602543972, 239596797, 3487352494, 115237367, 4045880333, 2428669306, 4202824057},
				PC:  14124544,
				SR:  28,
				USP: 1363352,
				SSP: 9697978,
				RAM: [][2]uint32{{14124540, 205}, {14124541, 17}, {14124542, 69}, {14124543, 174}, {4715772, 104}, {4715773, 44}, {14124544, 216}, {14124545, 52}},
			},
			want: cpuState{
				D:   [8]uint32{1410882485, 2524850606, 3640704972, 3188579189, 2123281346, 2336967668, 631222683, 1838937900},
				A:   [7]uint32{3602543972, 239596797, 3487352494, 115237367, 4045880333, 2428669306, 4202824057},
				PC:  14124546,
				SR:  16,
				USP: 1363352,
				SSP: 9697978,
				RAM: [][2]uint32{{14124540, 205}, {14124541, 17}, {14124542, 69}, {14124543, 174}, {4715772, 104}, {4715773, 8}, {14124544, 216}, {14124545, 52}},
			},
		},
		{
			name: "500 AND.b (A7), D5 ca17",
			init: cpuState{
				D:   [8]uint32{665009293, 10341520, 1412029180, 257007063, 1471609027, 296964206, 3237549832, 512478877},
				A:   [7]uint32{3192725326, 1013870033, 1763432924, 362924035, 2110987850, 597189186, 3917093906},
				PC:  1620864,
				SR:  41734,
				USP: 10820588,
				SSP: 14636380,
				RAM: [][2]uint32{{1620860, 202}, {1620861, 23}, {1620862, 252}, {1620863, 186}, {14636380, 180}, {14636381, 236}, {1620864, 161}, {1620865, 65}},
			},
			want: cpuState{
				D:   [8]uint32{665009293, 10341520, 1412029180, 257007063, 1471609027, 296964132, 3237549832, 512478877},
				A:   [7]uint32{3192725326, 1013870033, 1763432924, 362924035, 2110987850, 597189186, 3917093906},
				PC:  1620866,
				SR:  41728,
				USP: 10820588,
				SSP: 14636380,
				RAM: [][2]uint32{{1620860, 202}, {1620861, 23}, {1620862, 252}, {1620863, 186}, {14636380, 180}, {14636381, 236}, {1620864, 161}, {1620865, 65}},
			},
		},
		{
			name: "1000 AND.b (d8, A4, Xn), D3 c634",
			init: cpuState{
				D:   [8]uint32{3864294484, 2443144357, 4195059840, 3514388992, 4246891523, 729382144, 3845878703, 88601686},
				A:   [7]uint32{3228949829, 155906899, 3992290268, 2534360503, 328515602, 2785727778, 2203154425},
				PC:  843474,
				SR:  19,
				USP: 15084840,
				SSP: 13851130,
				RAM: [][2]uint32{{843470, 198}, {843471, 52}, {843472, 225}, {843473, 214}, {843474, 56}, {843475, 53}, {9779168, 238}, {9779169, 68}, {843476, 26}, {843477, 215}},
			},
			want: cpuState{
				D:   [8]uint32{3864294484, 2443144357, 4195059840, 3514388992, 4246891523, 729382144, 3845878703, 88601686},
				A:   [7]uint32{3228949829, 155906899, 3992290268, 2534360503, 328515602, 2785727778, 2203154425},
				PC:  843478,
				SR:  20,
				USP: 15084840,
				SSP: 13851130,
				RAM: [][2]uint32{{843470, 198}, {843471, 52}, {843472, 225}, {843473, 214}, {843474, 56}, {843475, 53}, {9779168, 238}, {9779169, 68}, {843476, 26}, {843477, 215}},
			},
		},
		{
			name: "1500 AND.b D6, -(A6) cd26",
			init: cpuState{
				D:   [8]uint32{576842073, 1901360494, 3380224760, 2493141862, 2890056087, 742800212, 3710461005, 4163375625},
				A:   [7]uint32{1912586904, 1525429464, 1575157120, 1974902591, 3095954787, 2718806702, 2499010058},
				PC:  6838936,
				SR:  9751,
				USP: 14018920,
				SSP: 10153490,
				RAM: [][2]uint32{{6838932, 205}, {6838933, 38}, {6838934, 223}, {6838935, 176}, {15982088, 7}, {15982089, 101}, {6838936, 240}, {6838937, 80}},
			},
			want: cpuState{
				D:   [8]uint32{576842073, 1901360494, 3380224760, 2493141862, 2890056087, 742800212, 3710461005, 4163375625},
				A:   [7]uint32{1912586904, 1525429464, 1575157120, 1974902591, 3095954787, 2718806702, 2499010057},
				PC:  6838938,
				SR:  9744,
				USP: 14018920,
				SSP: 10153490,
				RAM: [][2]uint32{{6838932, 205}, {6838933, 38}, {6838934, 223}, {6838935, 176}, {15982088, 7}, {15982089, 69}, {6838936, 240}, {6838937, 80}},
			},
		},
		{
			name: "2000 AND.b (d16, PC), D3 c63a",
			init: cpuState{
				D:   [8]uint32{2581827329, 2155904581, 864498891, 3846916136, 2716630524, 2179358202, 2241121971, 365241658},
				A:   [7]uint32{626236893, 1636465730, 3464688346, 231481766, 260212428, 1036339533, 1943619228},
				PC:  3630660,
				SR:  27,
				USP: 7008708,
				SSP: 14823128,
				RAM: [][2]uint32{{3630656, 198}, {3630657, 58}, {3630658, 100}, {3630659, 59}, {3630660, 250}, {3630661, 152}, {3656316, 152}, {3656317, 195}, {3630662, 251}, {3630663, 34}},
			},
			want: cpuState{
				D:   [8]uint32{2581827329, 2155904581, 864498891, 3846916096, 2716630524, 2179358202, 2241121971, 365241658},
				A:   [7]uint32{626236893, 1636465730, 3464688346, 231481766, 260212428, 1036339533, 1943619228},
				PC:  3630664,
				SR:  20,
				USP: 7008708,
				SSP: 14823128,
				RAM: [][2]uint32{{3630656, 198}, {3630657, 58}, {3630658, 100}, {3630659, 59}, {3630660, 250}, {3630661, 152}, {3656316, 152}, {3656317, 195}, {3630662, 251}, {3630663, 34}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestAND_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 AND.w D7, (A5)+ cf5d",
			init: cpuState{
				D:   [8]uint32{470065230, 1049833943, 2713507205, 4027026699, 1011506597, 831025574, 534664186, 3778570442},
				A:   [7]uint32{3796506931, 4050348046, 2257111017, 4223211533, 289411888, 2630226893, 500238866},
				PC:  8783112,
				SR:  42770,
				USP: 13863642,
				SSP: 10408596,
				RAM: [][2]uint32{{8783108, 207}, {8783109, 93}, {8783110, 158}, {8783111, 200}, {12, 19}, {13, 96}, {14, 51}, {15, 72}, {6304584, 231}, {6304585, 177}, {6304586, 152}, {6304587, 148}},
			},
			want: cpuState{
				D:      [8]uint32{470065230, 1049833943, 2713507205, 4027026699, 1011506597, 831025574, 534664186, 3778570442},
				A:      [7]uint32{3796506931, 4050348046, 2257111017, 4223211533, 289411888, 2630226895, 500238866},
				PC:     325071692,
				SR:     10002,
				USP:    13863642,
				SSP:    10408582,
				RAM:    [][2]uint32{{8783108, 207}, {8783109, 93}, {8783110, 158}, {8783111, 200}, {10408594, 5}, {10408595, 6}, {10408590, 167}, {10408591, 18}, {10408592, 0}, {10408593, 134}, {10408588, 207}, {10408589, 93}, {10408586, 19}, {10408587, 205}, {10408582, 207}, {10408583, 85}, {10408584, 156}, {10408585, 198}, {12, 19}, {13, 96}, {14, 51}, {15, 72}, {6304584, 231}, {6304585, 177}, {6304586, 152}, {6304587, 148}},
				Halted: true,
			},
		},
		{
			name: "500 AND.w -(A3), D1 c263",
			init: cpuState{
				D:   [8]uint32{3237672932, 2497974499, 1011561061, 2818748472, 1093815801, 2551522671, 484787115, 2385968650},
				A:   [7]uint32{2967734522, 1937496187, 357918864, 3778251766, 2978257039, 3765229279, 3622448206},
				PC:  9275802,
				SR:  1566,
				USP: 1627640,
				SSP: 15384926,
				RAM: [][2]uint32{{9275798, 194}, {9275799, 99}, {9275800, 160}, {9275801, 60}, {3378164, 72}, {3378165, 250}, {9275802, 23}, {9275803, 20}},
			},
			want: cpuState{
				D:   [8]uint32{3237672932, 2497970402, 1011561061, 2818748472, 1093815801, 2551522671, 484787115, 2385968650},
				A:   [7]uint32{2967734522, 1937496187, 357918864, 3778251764, 2978257039, 3765229279, 3622448206},
				PC:  9275804,
				SR:  1552,
				USP: 1627640,
				SSP: 15384926,
				RAM: [][2]uint32{{9275798, 194}, {9275799, 99}, {9275800, 160}, {9275801, 60}, {3378164, 72}, {3378165, 250}, {9275802, 23}, {9275803, 20}},
			},
		},
		{
			name: "1000 AND.w D5, (xxx).l cb79",
			init: cpuState{
				D:   [8]uint32{186630710, 710298477, 2687373351, 1238606941, 3472660398, 1540823946, 3179322033, 1854781418},
				A:   [7]uint32{3142960061, 2112506775, 1711742499, 1284278902, 1597599654, 1924328042, 297792844},
				PC:  11621642,
				SR:  34064,
				USP: 10810090,
				SSP: 8886750,
				RAM: [][2]uint32{{11621638, 203}, {11621639, 121}, {11621640, 233}, {11621641, 136}, {11621642, 192}, {11621643, 202}, {11621644, 134}, {11621645, 121}, {8962250, 236}, {8962251, 232}, {11621646, 171}, {11621647, 214}},
			},
			want: cpuState{
				D:   [8]uint32{186630710, 710298477, 2687373351, 1238606941, 3472660398, 1540823946, 3179322033, 1854781418},
				A:   [7]uint32{3142960061, 2112506775, 1711742499, 1284278902, 1597599654, 1924328042, 297792844},
				PC:  11621648,
				SR:  34064,
				USP: 10810090,
				SSP: 8886750,
				RAM: [][2]uint32{{11621638, 203}, {11621639, 121}, {11621640, 233}, {11621641, 136}, {11621642, 192}, {11621643, 202}, {11621644, 134}, {11621645, 121}, {8962250, 8}, {8962251, 136}, {11621646, 171}, {11621647, 214}},
			},
		},
		{
			name: "1500 AND.w D6, (A2) cd52",
			init: cpuState{
				D:   [8]uint32{965445852, 3059477021, 384626001, 677221587, 4245617613, 3171547404, 3229343101, 1053693608},
				A:   [7]uint32{3200224482, 2965686966, 3532994587, 1664120884, 3647757899, 4033192082, 2565757293},
				PC:  3121326,
				SR:  32798,
				USP: 11771192,
				SSP: 525442,
				RAM: [][2]uint32{{3121322, 205}, {3121323, 82}, {3121324, 163}, {3121325, 121}, {12, 93}, {13, 56}, {14, 121}, {15, 14}, {3701006, 62}, {3701007, 249}, {3701008, 97}, {3701009, 164}},
			},
			want: cpuState{
				D:      [8]uint32{965445852, 3059477021, 384626001, 677221587, 4245617613, 3171547404, 3229343101, 1053693608},
				A:      [7]uint32{3200224482, 2965686966, 3532994587, 1664120884, 3647757899, 4033192082, 2565757293},
				PC:     1563982098,
				SR:     8222,
				USP:    11771192,
				SSP:    525428,
				RAM:    [][2]uint32{{3121322, 205}, {3121323, 82}, {3121324, 163}, {3121325, 121}, {525440, 160}, {525441, 172}, {525436, 128}, {525437, 30}, {525438, 0}, {525439, 47}, {525434, 205}, {525435, 82}, {525432, 56}, {525433, 27}, {525428, 205}, {525429, 81}, {525430, 210}, {525431, 149}, {12, 93}, {13, 56}, {14, 121}, {15, 14}, {3701006, 62}, {3701007, 249}, {3701008, 97}, {3701009, 164}},
				Halted: true,
			},
		},
		{
			name: "2000 AND.w D4, (d16, A4) c96c",
			init: cpuState{
				D:   [8]uint32{887504428, 601670536, 3850289262, 4007043790, 2595667755, 1227611464, 4174156296, 228656571},
				A:   [7]uint32{1682546185, 663505525, 1642568163, 23923254, 1829486994, 3945886464, 3633958038},
				PC:  15583236,
				SR:  271,
				USP: 4355428,
				SSP: 16099788,
				RAM: [][2]uint32{{15583232, 201}, {15583233, 108}, {15583234, 47}, {15583235, 136}, {15583236, 211}, {15583237, 118}, {782618, 250}, {782619, 62}, {15583238, 38}, {15583239, 230}},
			},
			want: cpuState{
				D:   [8]uint32{887504428, 601670536, 3850289262, 4007043790, 2595667755, 1227611464, 4174156296, 228656571},
				A:   [7]uint32{1682546185, 663505525, 1642568163, 23923254, 1829486994, 3945886464, 3633958038},
				PC:  15583240,
				SR:  264,
				USP: 4355428,
				SSP: 16099788,
				RAM: [][2]uint32{{15583232, 201}, {15583233, 108}, {15583234, 47}, {15583235, 136}, {15583236, 211}, {15583237, 118}, {782618, 186}, {782619, 42}, {15583238, 38}, {15583239, 230}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestAND_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 AND.l D5, (A4)+ cb9c",
			init: cpuState{
				D:   [8]uint32{922200166, 1634731057, 1384255826, 4165284375, 3986156178, 156727417, 2291521453, 2079116780},
				A:   [7]uint32{1072804380, 2242832998, 1816450483, 1691735783, 3362939947, 2127193698, 2507654371},
				PC:  478070,
				SR:  32791,
				USP: 2858110,
				SSP: 9784714,
				RAM: [][2]uint32{{478066, 203}, {478067, 156}, {478068, 134}, {478069, 182}, {12, 121}, {13, 20}, {14, 142}, {15, 24}, {1347096, 82}, {1347097, 127}, {1347098, 132}, {1347099, 50}},
			},
			want: cpuState{
				D:      [8]uint32{922200166, 1634731057, 1384255826, 4165284375, 3986156178, 156727417, 2291521453, 2079116780},
				A:      [7]uint32{1072804380, 2242832998, 1816450483, 1691735783, 3362939947, 2127193698, 2507654371},
				PC:     2031390236,
				SR:     8215,
				USP:    2858110,
				SSP:    9784700,
				RAM:    [][2]uint32{{478066, 203}, {478067, 156}, {478068, 134}, {478069, 182}, {9784712, 75}, {9784713, 116}, {9784708, 128}, {9784709, 23}, {9784710, 0}, {9784711, 7}, {9784706, 203}, {9784707, 156}, {9784704, 100}, {9784705, 43}, {9784700, 203}, {9784701, 145}, {9784702, 200}, {9784703, 114}, {12, 121}, {13, 20}, {14, 142}, {15, 24}, {1347096, 82}, {1347097, 127}, {1347098, 132}, {1347099, 50}},
				Halted: true,
			},
		},
		{
			name: "500 AND.l D2, D5 ca82",
			init: cpuState{
				D:   [8]uint32{89631080, 2591633052, 3175151427, 2089778363, 2309986153, 1124918604, 150987641, 833260207},
				A:   [7]uint32{864219277, 1774530954, 615508631, 2692222502, 51098179, 3098996461, 4031098634},
				PC:  5098258,
				SR:  1280,
				USP: 10858140,
				SSP: 8933874,
				RAM: [][2]uint32{{5098254, 202}, {5098255, 130}, {5098256, 139}, {5098257, 139}, {5098258, 216}, {5098259, 187}},
			},
			want: cpuState{
				D:   [8]uint32{89631080, 2591633052, 3175151427, 2089778363, 2309986153, 16835904, 150987641, 833260207},
				A:   [7]uint32{864219277, 1774530954, 615508631, 2692222502, 51098179, 3098996461, 4031098634},
				PC:  5098260,
				SR:  1280,
				USP: 10858140,
				SSP: 8933874,
				RAM: [][2]uint32{{5098254, 202}, {5098255, 130}, {5098256, 139}, {5098257, 139}, {5098258, 216}, {5098259, 187}},
			},
		},
		{
			name: "1000 AND.l (d8, A4, Xn), D6 ccb4",
			init: cpuState{
				D:   [8]uint32{2189815023, 3204245924, 1312679599, 3635032639, 1081541678, 1542705011, 2947695039, 4080095917},
				A:   [7]uint32{3469149985, 1260780375, 2095156553, 1370494942, 623144067, 2287133115, 251076975},
				PC:  1109872,
				SR:  34325,
				USP: 6502936,
				SSP: 6746582,
				RAM: [][2]uint32{{1109868, 204}, {1109869, 180}, {1109870, 72}, {1109871, 192}, {1109872, 198}, {1109873, 246}, {12, 95}, {13, 208}, {14, 203}, {15, 92}, {13683548, 75}, {13683549, 212}, {13683550, 147}, {13683551, 228}},
			},
			want: cpuState{
				D:      [8]uint32{2189815023, 3204245924, 1312679599, 3635032639, 1081541678, 1542705011, 2947695039, 4080095917},
				A:      [7]uint32{3469149985, 1260780375, 2095156553, 1370494942, 623144067, 2287133115, 251076975},
				PC:     1607519072,
				SR:     9749,
				USP:    6502936,
				SSP:    6746568,
				RAM:    [][2]uint32{{1109868, 204}, {1109869, 180}, {1109870, 72}, {1109871, 192}, {1109872, 198}, {1109873, 246}, {6746580, 239}, {6746581, 110}, {6746576, 134}, {6746577, 21}, {6746578, 0}, {6746579, 16}, {6746574, 204}, {6746575, 180}, {6746572, 112}, {6746573, 113}, {6746568, 204}, {6746569, 177}, {6746570, 101}, {6746571, 155}, {12, 95}, {13, 208}, {14, 203}, {15, 92}, {13683548, 75}, {13683549, 212}, {13683550, 147}, {13683551, 228}},
				Halted: true,
			},
		},
		{
			name: "1500 AND.l (A7)+, D2 c49f",
			init: cpuState{
				D:   [8]uint32{833105693, 3868083965, 3610840310, 3656255125, 929898330, 837531064, 834255254, 42179301},
				A:   [7]uint32{1429973882, 3575224595, 660706940, 427558059, 1251731896, 574864352, 288281972},
				PC:  14891870,
				SR:  524,
				USP: 8518562,
				SSP: 3781332,
				RAM: [][2]uint32{{14891866, 196}, {14891867, 159}, {14891868, 225}, {14891869, 209}, {8518562, 55}, {8518563, 66}, {8518564, 140}, {8518565, 89}, {14891870, 113}, {14891871, 135}},
			},
			want: cpuState{
				D:   [8]uint32{833105693, 3868083965, 385879120, 3656255125, 929898330, 837531064, 834255254, 42179301},
				A:   [7]uint32{1429973882, 3575224595, 660706940, 427558059, 1251731896, 574864352, 288281972},
				PC:  14891872,
				SR:  512,
				USP: 8518566,
				SSP: 3781332,
				RAM: [][2]uint32{{14891866, 196}, {14891867, 159}, {14891868, 225}, {14891869, 209}, {8518562, 55}, {8518563, 66}, {8518564, 140}, {8518565, 89}, {14891870, 113}, {14891871, 135}},
			},
		},
		{
			name: "2000 AND.l D0, (A1) c191",
			init: cpuState{
				D:   [8]uint32{3586022064, 1869811600, 2134224306, 1572504590, 1762925672, 1081431194, 3256730341, 1109104672},
				A:   [7]uint32{457868840, 117980121, 850650083, 3212723232, 4110374314, 3939455308, 3470628073},
				PC:  6446190,
				SR:  285,
				USP: 7845056,
				SSP: 7062390,
				RAM: [][2]uint32{{6446186, 193}, {6446187, 145}, {6446188, 231}, {6446189, 6}, {12, 249}, {13, 238}, {14, 203}, {15, 232}, {15649768, 37}, {15649769, 87}, {15649770, 60}, {15649771, 236}},
			},
			want: cpuState{
				D:      [8]uint32{3586022064, 1869811600, 2134224306, 1572504590, 1762925672, 1081431194, 3256730341, 1109104672},
				A:      [7]uint32{457868840, 117980121, 850650083, 3212723232, 4110374314, 3939455308, 3470628073},
				PC:     4193176556,
				SR:     8477,
				USP:    7845056,
				SSP:    7062376,
				RAM:    [][2]uint32{{6446186, 193}, {6446187, 145}, {6446188, 231}, {6446189, 6}, {7062388, 92}, {7062389, 108}, {7062384, 1}, {7062385, 29}, {7062386, 0}, {7062387, 98}, {7062382, 193}, {7062383, 145}, {7062380, 59}, {7062381, 217}, {7062376, 193}, {7062377, 145}, {7062378, 7}, {7062379, 8}, {12, 249}, {13, 238}, {14, 203}, {15, 232}, {15649768, 37}, {15649769, 87}, {15649770, 60}, {15649771, 236}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestOR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 OR.b -(A2), D0 8022",
			init: cpuState{
				D:   [8]uint32{1464886001, 422299933, 2061943005, 2014634987, 1578524256, 28073932, 3805994012, 147848747},
				A:   [7]uint32{891510178, 3370414180, 1621082086, 3960798794, 2962935417, 2540983209, 3063807864},
				PC:  16120692,
				SR:  543,
				USP: 15445762,
				SSP: 13322440,
				RAM: [][2]uint32{{16120688, 128}, {16120689, 34}, {16120690, 102}, {16120691, 213}, {10469348, 21}, {10469349, 172}, {16120692, 4}, {16120693, 149}},
			},
			want: cpuState{
				D:   [8]uint32{1464886013, 422299933, 2061943005, 2014634987, 1578524256, 28073932, 3805994012, 147848747},
				A:   [7]uint32{891510178, 3370414180, 1621082085, 3960798794, 2962935417, 2540983209, 3063807864},
				PC:  16120694,
				SR:  536,
				USP: 15445762,
				SSP: 13322440,
				RAM: [][2]uint32{{16120688, 128}, {16120689, 34}, {16120690, 102}, {16120691, 213}, {10469348, 21}, {10469349, 172}, {16120692, 4}, {16120693, 149}},
			},
		},
		{
			name: "500 OR.b #, -(A3) 0023",
			init: cpuState{
				D:   [8]uint32{2159019827, 2923809159, 2076855419, 679804200, 604735235, 3889630941, 3501335164, 1193109961},
				A:   [7]uint32{4185909881, 1227301791, 4198559042, 3451823745, 994728712, 2740826082, 3413916965},
				PC:  7262182,
				SR:  42526,
				USP: 6349288,
				SSP: 14133810,
				RAM: [][2]uint32{{7262178, 0}, {7262179, 35}, {7262180, 175}, {7262181, 143}, {7262182, 60}, {7262183, 140}, {12494464, 203}, {12494465, 78}, {7262184, 4}, {7262185, 12}},
			},
			want: cpuState{
				D:   [8]uint32{2159019827, 2923809159, 2076855419, 679804200, 604735235, 3889630941, 3501335164, 1193109961},
				A:   [7]uint32{4185909881, 1227301791, 4198559042, 3451823744, 994728712, 2740826082, 3413916965},
				PC:  7262186,
				SR:  42520,
				USP: 6349288,
				SSP: 14133810,
				RAM: [][2]uint32{{7262178, 0}, {7262179, 35}, {7262180, 175}, {7262181, 143}, {7262182, 60}, {7262183, 140}, {12494464, 207}, {12494465, 78}, {7262184, 4}, {7262185, 12}},
			},
		},
		{
			name: "1000 OR.b (d8, PC, Xn), D2 843b",
			init: cpuState{
				D:   [8]uint32{1008465004, 565654395, 3014457300, 4200457247, 3499226907, 2067109071, 1537380564, 3576729133},
				A:   [7]uint32{2954305718, 799989559, 1969384523, 585204769, 3081445438, 523659975, 2441992117},
				PC:  13571424,
				SR:  41740,
				USP: 7741646,
				SSP: 11035856,
				RAM: [][2]uint32{{13571420, 132}, {13571421, 59}, {13571422, 141}, {13571423, 149}, {13571424, 221}, {13571425, 245}, {15087016, 131}, {15087017, 191}, {13571426, 35}, {13571427, 113}},
			},
			want: cpuState{
				D:   [8]uint32{1008465004, 565654395, 3014457343, 4200457247, 3499226907, 2067109071, 1537380564, 3576729133},
				A:   [7]uint32{2954305718, 799989559, 1969384523, 585204769, 3081445438, 523659975, 2441992117},
				PC:  13571428,
				SR:  41736,
				USP: 7741646,
				SSP: 11035856,
				RAM: [][2]uint32{{13571420, 132}, {13571421, 59}, {13571422, 141}, {13571423, 149}, {13571424, 221}, {13571425, 245}, {15087016, 131}, {15087017, 191}, {13571426, 35}, {13571427, 113}},
			},
		},
		{
			name: "1500 OR.b D6, D3 8606",
			init: cpuState{
				D:   [8]uint32{3954948865, 1108348728, 1897355846, 3851781480, 443051093, 3009050904, 1015182097, 518329263},
				A:   [7]uint32{1912353017, 3013660754, 1185738472, 1515503709, 205605898, 1609494155, 401588752},
				PC:  15126554,
				SR:  9737,
				USP: 10867420,
				SSP: 5964438,
				RAM: [][2]uint32{{15126550, 134}, {15126551, 6}, {15126552, 203}, {15126553, 56}, {15126554, 156}, {15126555, 210}},
			},
			want: cpuState{
				D:   [8]uint32{3954948865, 1108348728, 1897355846, 3851781497, 443051093, 3009050904, 1015182097, 518329263},
				A:   [7]uint32{1912353017, 3013660754, 1185738472, 1515503709, 205605898, 1609494155, 401588752},
				PC:  15126556,
				SR:  9728,
				USP: 10867420,
				SSP: 5964438,
				RAM: [][2]uint32{{15126550, 134}, {15126551, 6}, {15126552, 203}, {15126553, 56}, {15126554, 156}, {15126555, 210}},
			},
		},
		{
			name: "2000 OR.b D0, (d16, A2) 812a",
			init: cpuState{
				D:   [8]uint32{4278630301, 3632017265, 3373182402, 222910286, 2512778869, 2788498895, 102558576, 935383500},
				A:   [7]uint32{4135287344, 4010487698, 3025332135, 3467473665, 1454258917, 24542654, 458674039},
				PC:  478736,
				SR:  33283,
				USP: 14716492,
				SSP: 2553602,
				RAM: [][2]uint32{{478732, 129}, {478733, 42}, {478734, 58}, {478735, 203}, {478736, 199}, {478737, 107}, {5448306, 29}, {5448307, 119}, {478738, 240}, {478739, 178}},
			},
			want: cpuState{
				D:   [8]uint32{4278630301, 3632017265, 3373182402, 222910286, 2512778869, 2788498895, 102558576, 935383500},
				A:   [7]uint32{4135287344, 4010487698, 3025332135, 3467473665, 1454258917, 24542654, 458674039},
				PC:  478740,
				SR:  33288,
				USP: 14716492,
				SSP: 2553602,
				RAM: [][2]uint32{{478732, 129}, {478733, 42}, {478734, 58}, {478735, 203}, {478736, 199}, {478737, 107}, {5448306, 157}, {5448307, 119}, {478738, 240}, {478739, 178}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestOR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 OR.w -(A4), D0 8064",
			init: cpuState{
				D:   [8]uint32{3915457295, 1721067667, 2626242074, 2408546718, 3384892705, 3381734479, 2468666473, 2881617210},
				A:   [7]uint32{1130281266, 2303216642, 1783045862, 437447299, 1203664122, 430460605, 47693689},
				PC:  10243544,
				SR:  42268,
				USP: 2483622,
				SSP: 16328982,
				RAM: [][2]uint32{{10243540, 128}, {10243541, 100}, {10243542, 116}, {10243543, 155}, {12481784, 205}, {12481785, 22}, {10243544, 117}, {10243545, 37}},
			},
			want: cpuState{
				D:   [8]uint32{3915509535, 1721067667, 2626242074, 2408546718, 3384892705, 3381734479, 2468666473, 2881617210},
				A:   [7]uint32{1130281266, 2303216642, 1783045862, 437447299, 1203664120, 430460605, 47693689},
				PC:  10243546,
				SR:  42264,
				USP: 2483622,
				SSP: 16328982,
				RAM: [][2]uint32{{10243540, 128}, {10243541, 100}, {10243542, 116}, {10243543, 155}, {12481784, 205}, {12481785, 22}, {10243544, 117}, {10243545, 37}},
			},
		},
		{
			name: "500 OR.w D2, (A7)+ 855f",
			init: cpuState{
				D:   [8]uint32{321577514, 2239320060, 754847473, 2492794913, 593799045, 1312791170, 3583763312, 3872158869},
				A:   [7]uint32{2800405726, 4172282214, 4239655050, 2524440140, 1667682329, 218138763, 2043475047},
				PC:  16650616,
				SR:  2,
				USP: 830784,
				SSP: 12842360,
				RAM: [][2]uint32{{16650612, 133}, {16650613, 95}, {16650614, 60}, {16650615, 210}, {830784, 164}, {830785, 150}, {16650616, 247}, {16650617, 254}},
			},
			want: cpuState{
				D:   [8]uint32{321577514, 2239320060, 754847473, 2492794913, 593799045, 1312791170, 3583763312, 3872158869},
				A:   [7]uint32{2800405726, 4172282214, 4239655050, 2524440140, 1667682329, 218138763, 2043475047},
				PC:  16650618,
				SR:  8,
				USP: 830786,
				SSP: 12842360,
				RAM: [][2]uint32{{16650612, 133}, {16650613, 95}, {16650614, 60}, {16650615, 210}, {830784, 174}, {830785, 247}, {16650616, 247}, {16650617, 254}},
			},
		},
		{
			name: "1000 OR.w (A2)+, D5 8a5a",
			init: cpuState{
				D:   [8]uint32{83734341, 1934129117, 2831606052, 591412242, 171901009, 2136296524, 3593942737, 560009553},
				A:   [7]uint32{3100644133, 4154625645, 2792823997, 3464296240, 1692682072, 3386279769, 1817036328},
				PC:  10075266,
				SR:  33557,
				USP: 11890692,
				SSP: 10641134,
				RAM: [][2]uint32{{10075262, 138}, {10075263, 90}, {10075264, 152}, {10075265, 65}, {12, 220}, {13, 88}, {14, 3}, {15, 188}, {5768124, 190}, {5768125, 40}, {5768126, 102}, {5768127, 168}},
			},
			want: cpuState{
				D:      [8]uint32{83734341, 1934129117, 2831606052, 591412242, 171901009, 2136296524, 3593942737, 560009553},
				A:      [7]uint32{3100644133, 4154625645, 2792823999, 3464296240, 1692682072, 3386279769, 1817036328},
				PC:     3696755648,
				SR:     8981,
				USP:    11890692,
				SSP:    10641120,
				RAM:    [][2]uint32{{10075262, 138}, {10075263, 90}, {10075264, 152}, {10075265, 65}, {10641132, 188}, {10641133, 128}, {10641128, 131}, {10641129, 21}, {10641130, 0}, {10641131, 153}, {10641126, 138}, {10641127, 90}, {10641124, 28}, {10641125, 189}, {10641120, 138}, {10641121, 81}, {10641122, 166}, {10641123, 119}, {12, 220}, {13, 88}, {14, 3}, {15, 188}, {5768124, 190}, {5768125, 40}, {5768126, 102}, {5768127, 168}},
				Halted: true,
			},
		},
		{
			name: "1500 OR.w (A0), D0 8050",
			init: cpuState{
				D:   [8]uint32{4146066535, 3236021954, 3043732966, 960678392, 181286597, 3377134363, 1335806840, 1668827300},
				A:   [7]uint32{1065728912, 2638828595, 747302996, 3416806805, 1259311796, 247224203, 3355967552},
				PC:  3847342,
				SR:  1819,
				USP: 10434968,
				SSP: 594882,
				RAM: [][2]uint32{{3847338, 128}, {3847339, 80}, {3847340, 245}, {3847341, 95}, {8764304, 31}, {8764305, 109}, {3847342, 135}, {3847343, 123}},
			},
			want: cpuState{
				D:   [8]uint32{4146069359, 3236021954, 3043732966, 960678392, 181286597, 3377134363, 1335806840, 1668827300},
				A:   [7]uint32{1065728912, 2638828595, 747302996, 3416806805, 1259311796, 247224203, 3355967552},
				PC:  3847344,
				SR:  1816,
				USP: 10434968,
				SSP: 594882,
				RAM: [][2]uint32{{3847338, 128}, {3847339, 80}, {3847340, 245}, {3847341, 95}, {8764304, 31}, {8764305, 109}, {3847342, 135}, {3847343, 123}},
			},
		},
		{
			name: "2000 OR.w -(A3), D2 8463",
			init: cpuState{
				D:   [8]uint32{1106116852, 2212416777, 2223062022, 2248171998, 3659442629, 432504354, 2282524369, 1180174114},
				A:   [7]uint32{817052675, 1326552185, 141388016, 2036882750, 1175768030, 3772885538, 3622480399},
				PC:  11385664,
				SR:  41749,
				USP: 7648,
				SSP: 15289572,
				RAM: [][2]uint32{{11385660, 132}, {11385661, 99}, {11385662, 248}, {11385663, 40}, {6839612, 179}, {6839613, 197}, {11385664, 66}, {11385665, 161}},
			},
			want: cpuState{
				D:   [8]uint32{1106116852, 2212416777, 2223095751, 2248171998, 3659442629, 432504354, 2282524369, 1180174114},
				A:   [7]uint32{817052675, 1326552185, 141388016, 2036882748, 1175768030, 3772885538, 3622480399},
				PC:  11385666,
				SR:  41752,
				USP: 7648,
				SSP: 15289572,
				RAM: [][2]uint32{{11385660, 132}, {11385661, 99}, {11385662, 248}, {11385663, 40}, {6839612, 179}, {6839613, 197}, {11385664, 66}, {11385665, 161}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestOR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 OR.l D6, (d16, A1) 8da9",
			init: cpuState{
				D:   [8]uint32{1564502885, 522926018, 1277966409, 3131410043, 4105120248, 3545769245, 1918636838, 1061832603},
				A:   [7]uint32{2368253171, 1228958648, 1411119444, 2133901995, 1073622201, 855036054, 108252896},
				PC:  5802578,
				SR:  1818,
				USP: 12460134,
				SSP: 14092348,
				RAM: [][2]uint32{{5802574, 141}, {5802575, 169}, {5802576, 36}, {5802577, 76}, {5802578, 201}, {5802579, 150}, {4231172, 100}, {4231173, 66}, {4231174, 247}, {4231175, 101}, {5802580, 237}, {5802581, 111}},
			},
			want: cpuState{
				D:   [8]uint32{1564502885, 522926018, 1277966409, 3131410043, 4105120248, 3545769245, 1918636838, 1061832603},
				A:   [7]uint32{2368253171, 1228958648, 1411119444, 2133901995, 1073622201, 855036054, 108252896},
				PC:  5802582,
				SR:  1808,
				USP: 12460134,
				SSP: 14092348,
				RAM: [][2]uint32{{5802574, 141}, {5802575, 169}, {5802576, 36}, {5802577, 76}, {5802578, 201}, {5802579, 150}, {4231172, 118}, {4231173, 94}, {4231174, 247}, {4231175, 103}, {5802580, 237}, {5802581, 111}},
			},
		},
		{
			name: "500 OR.l D4, (A6) 8996",
			init: cpuState{
				D:   [8]uint32{2634106044, 3238176658, 4055786570, 1882697531, 516048875, 673187567, 1715496973, 944537433},
				A:   [7]uint32{3070822987, 3267290900, 2814168436, 2637748765, 486365393, 3149234560, 831387210},
				PC:  10706648,
				SR:  1049,
				USP: 9163868,
				SSP: 7306020,
				RAM: [][2]uint32{{10706644, 137}, {10706645, 150}, {10706646, 81}, {10706647, 5}, {9303626, 2}, {9303627, 249}, {9303628, 91}, {9303629, 229}, {10706648, 153}, {10706649, 109}},
			},
			want: cpuState{
				D:   [8]uint32{2634106044, 3238176658, 4055786570, 1882697531, 516048875, 673187567, 1715496973, 944537433},
				A:   [7]uint32{3070822987, 3267290900, 2814168436, 2637748765, 486365393, 3149234560, 831387210},
				PC:  10706650,
				SR:  1040,
				USP: 9163868,
				SSP: 7306020,
				RAM: [][2]uint32{{10706644, 137}, {10706645, 150}, {10706646, 81}, {10706647, 5}, {9303626, 30}, {9303627, 251}, {9303628, 95}, {9303629, 239}, {10706648, 153}, {10706649, 109}},
			},
		},
		{
			name: "1000 OR.l (A0), D6 8c90",
			init: cpuState{
				D:   [8]uint32{2559127952, 397569079, 2268734089, 2113032836, 128404139, 3061897520, 2066853033, 2588400843},
				A:   [7]uint32{3228252744, 3838330075, 2433278643, 2968991629, 2795966815, 1224384411, 388670456},
				PC:  13463296,
				SR:  40965,
				USP: 1879478,
				SSP: 3257934,
				RAM: [][2]uint32{{13463292, 140}, {13463293, 144}, {13463294, 238}, {13463295, 187}, {7027272, 156}, {7027273, 86}, {7027274, 230}, {7027275, 138}, {13463296, 86}, {13463297, 51}},
			},
			want: cpuState{
				D:   [8]uint32{2559127952, 397569079, 2268734089, 2113032836, 128404139, 3061897520, 4286049963, 2588400843},
				A:   [7]uint32{3228252744, 3838330075, 2433278643, 2968991629, 2795966815, 1224384411, 388670456},
				PC:  13463298,
				SR:  40968,
				USP: 1879478,
				SSP: 3257934,
				RAM: [][2]uint32{{13463292, 140}, {13463293, 144}, {13463294, 238}, {13463295, 187}, {7027272, 156}, {7027273, 86}, {7027274, 230}, {7027275, 138}, {13463296, 86}, {13463297, 51}},
			},
		},
		{
			name: "1500 OR.l (d8, A0, Xn), D6 8cb0",
			init: cpuState{
				D:   [8]uint32{428784209, 2224703451, 841549742, 66083813, 541563657, 3274052991, 2785596487, 2933910587},
				A:   [7]uint32{3328312238, 1355926436, 2565847930, 1528518985, 3930793393, 3270877970, 4235750307},
				PC:  15179218,
				SR:  33792,
				USP: 5467056,
				SSP: 11827978,
				RAM: [][2]uint32{{15179214, 140}, {15179215, 176}, {15179216, 38}, {15179217, 182}, {15179218, 196}, {15179219, 131}, {6425362, 86}, {6425363, 180}, {6425364, 180}, {6425365, 211}, {15179220, 59}, {15179221, 48}},
			},
			want: cpuState{
				D:   [8]uint32{428784209, 2224703451, 841549742, 66083813, 541563657, 3274052991, 4139578583, 2933910587},
				A:   [7]uint32{3328312238, 1355926436, 2565847930, 1528518985, 3930793393, 3270877970, 4235750307},
				PC:  15179222,
				SR:  33800,
				USP: 5467056,
				SSP: 11827978,
				RAM: [][2]uint32{{15179214, 140}, {15179215, 176}, {15179216, 38}, {15179217, 182}, {15179218, 196}, {15179219, 131}, {6425362, 86}, {6425363, 180}, {6425364, 180}, {6425365, 211}, {15179220, 59}, {15179221, 48}},
			},
		},
		{
			name: "2000 OR.l D2, -(A3) 85a3",
			init: cpuState{
				D:   [8]uint32{2287264723, 2698719875, 3393124438, 117069084, 3255219775, 3886171928, 1113168993, 1329161553},
				A:   [7]uint32{1780419681, 1762454791, 1479354099, 3868954621, 1062544871, 1130166040, 788444851},
				PC:  281200,
				SR:  1053,
				USP: 1894772,
				SSP: 2525694,
				RAM: [][2]uint32{{281196, 133}, {281197, 163}, {281198, 154}, {281199, 148}, {12, 141}, {13, 98}, {14, 110}, {15, 192}, {6450880, 130}, {6450881, 225}, {6450882, 176}, {6450883, 3}},
			},
			want: cpuState{
				D:      [8]uint32{2287264723, 2698719875, 3393124438, 117069084, 3255219775, 3886171928, 1113168993, 1329161553},
				A:      [7]uint32{1780419681, 1762454791, 1479354099, 3868954617, 1062544871, 1130166040, 788444851},
				PC:     2372038340,
				SR:     9245,
				USP:    1894772,
				SSP:    2525680,
				RAM:    [][2]uint32{{281196, 133}, {281197, 163}, {281198, 154}, {281199, 148}, {2525692, 74}, {2525693, 110}, {2525688, 4}, {2525689, 29}, {2525690, 0}, {2525691, 4}, {2525686, 133}, {2525687, 163}, {2525684, 143}, {2525685, 249}, {2525680, 133}, {2525681, 177}, {2525682, 230}, {2525683, 155}, {12, 141}, {13, 98}, {14, 110}, {15, 192}, {6450880, 130}, {6450881, 225}, {6450882, 176}, {6450883, 3}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEOR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EOR.b D1, (d8, A0, Xn) b330",
			init: cpuState{
				D:   [8]uint32{322243750, 2165232778, 2100007715, 4237342435, 2572068118, 2875607722, 1503358159, 3668045673},
				A:   [7]uint32{295339817, 68187332, 509124303, 2875758993, 4210229374, 3978168128, 3190833285},
				PC:  14813566,
				SR:  33034,
				USP: 14749924,
				SSP: 8164118,
				RAM: [][2]uint32{{14813562, 179}, {14813563, 48}, {14813564, 162}, {14813565, 89}, {14813566, 105}, {14813567, 67}, {10102352, 41}, {10102353, 241}, {14813568, 167}, {14813569, 23}},
			},
			want: cpuState{
				D:   [8]uint32{322243750, 2165232778, 2100007715, 4237342435, 2572068118, 2875607722, 1503358159, 3668045673},
				A:   [7]uint32{295339817, 68187332, 509124303, 2875758993, 4210229374, 3978168128, 3190833285},
				PC:  14813570,
				SR:  33024,
				USP: 14749924,
				SSP: 8164118,
				RAM: [][2]uint32{{14813562, 179}, {14813563, 48}, {14813564, 162}, {14813565, 89}, {14813566, 105}, {14813567, 67}, {10102352, 41}, {10102353, 123}, {14813568, 167}, {14813569, 23}},
			},
		},
		{
			name: "500 EOR.b D1, -(A6) b326",
			init: cpuState{
				D:   [8]uint32{3689008217, 4241317280, 1793249237, 1744674556, 3559945183, 3763629746, 1567338833, 2623165809},
				A:   [7]uint32{2412182805, 4029234144, 1064661884, 3466627907, 2547062843, 3211700370, 286988422},
				PC:  10882548,
				SR:  10011,
				USP: 12534606,
				SSP: 4680362,
				RAM: [][2]uint32{{10882544, 179}, {10882545, 38}, {10882546, 140}, {10882547, 2}, {1775748, 103}, {1775749, 80}, {10882548, 230}, {10882549, 94}},
			},
			want: cpuState{
				D:   [8]uint32{3689008217, 4241317280, 1793249237, 1744674556, 3559945183, 3763629746, 1567338833, 2623165809},
				A:   [7]uint32{2412182805, 4029234144, 1064661884, 3466627907, 2547062843, 3211700370, 286988421},
				PC:  10882550,
				SR:  10008,
				USP: 12534606,
				SSP: 4680362,
				RAM: [][2]uint32{{10882544, 179}, {10882545, 38}, {10882546, 140}, {10882547, 2}, {1775748, 103}, {1775749, 240}, {10882548, 230}, {10882549, 94}},
			},
		},
		{
			name: "1000 EOR.b D5, (d8, A0, Xn) bb30",
			init: cpuState{
				D:   [8]uint32{2691012587, 4207882718, 2940771023, 591772051, 2351212467, 1031269893, 3984493838, 3913411197},
				A:   [7]uint32{2374530340, 460292557, 2445359654, 2679952575, 3703109387, 3532090278, 1960419250},
				PC:  477638,
				SR:  34050,
				USP: 10034140,
				SSP: 12768692,
				RAM: [][2]uint32{{477634, 187}, {477635, 48}, {477636, 108}, {477637, 167}, {477638, 32}, {477639, 169}, {459224, 189}, {459225, 98}, {477640, 137}, {477641, 63}},
			},
			want: cpuState{
				D:   [8]uint32{2691012587, 4207882718, 2940771023, 591772051, 2351212467, 1031269893, 3984493838, 3913411197},
				A:   [7]uint32{2374530340, 460292557, 2445359654, 2679952575, 3703109387, 3532090278, 1960419250},
				PC:  477642,
				SR:  34048,
				USP: 10034140,
				SSP: 12768692,
				RAM: [][2]uint32{{477634, 187}, {477635, 48}, {477636, 108}, {477637, 167}, {477638, 32}, {477639, 169}, {459224, 189}, {459225, 103}, {477640, 137}, {477641, 63}},
			},
		},
		{
			name: "1500 EOR.b D0, -(A4) b124",
			init: cpuState{
				D:   [8]uint32{1955633209, 3373003984, 1618176985, 1435083168, 2443017061, 2059381897, 610152313, 130079289},
				A:   [7]uint32{3435039532, 3329239339, 4036601606, 3684028338, 3129802781, 453160064, 1391627713},
				PC:  8323772,
				SR:  42498,
				USP: 7996678,
				SSP: 419740,
				RAM: [][2]uint32{{8323768, 177}, {8323769, 36}, {8323770, 124}, {8323771, 154}, {9240604, 109}, {9240605, 21}, {8323772, 244}, {8323773, 251}},
			},
			want: cpuState{
				D:   [8]uint32{1955633209, 3373003984, 1618176985, 1435083168, 2443017061, 2059381897, 610152313, 130079289},
				A:   [7]uint32{3435039532, 3329239339, 4036601606, 3684028338, 3129802780, 453160064, 1391627713},
				PC:  8323774,
				SR:  42496,
				USP: 7996678,
				SSP: 419740,
				RAM: [][2]uint32{{8323768, 177}, {8323769, 36}, {8323770, 124}, {8323771, 154}, {9240604, 84}, {9240605, 21}, {8323772, 244}, {8323773, 251}},
			},
		},
		{
			name: "2000 EOR.b #, (d16, A2) 0a2a",
			init: cpuState{
				D:   [8]uint32{869295349, 1349727603, 1179963511, 3572034944, 1598942221, 2502861199, 3054896122, 3565335401},
				A:   [7]uint32{2717661304, 3643204295, 3619196007, 2413028210, 4119000966, 1349532300, 3428324189},
				PC:  3462450,
				SR:  41743,
				USP: 176880,
				SSP: 16704212,
				RAM: [][2]uint32{{3462446, 10}, {3462447, 42}, {3462448, 32}, {3462449, 50}, {3462450, 154}, {3462451, 169}, {3462452, 176}, {3462453, 143}, {12068624, 83}, {12068625, 28}, {3462454, 29}, {3462455, 52}},
			},
			want: cpuState{
				D:   [8]uint32{869295349, 1349727603, 1179963511, 3572034944, 1598942221, 2502861199, 3054896122, 3565335401},
				A:   [7]uint32{2717661304, 3643204295, 3619196007, 2413028210, 4119000966, 1349532300, 3428324189},
				PC:  3462456,
				SR:  41728,
				USP: 176880,
				SSP: 16704212,
				RAM: [][2]uint32{{3462446, 10}, {3462447, 42}, {3462448, 32}, {3462449, 50}, {3462450, 154}, {3462451, 169}, {3462452, 176}, {3462453, 143}, {12068624, 97}, {12068625, 28}, {3462454, 29}, {3462455, 52}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEOR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EOR.w D7, (d16, A7) bf6f",
			init: cpuState{
				D:   [8]uint32{3609744020, 3243748271, 831628684, 3294858570, 1071185854, 3478528025, 3099394745, 3061239256},
				A:   [7]uint32{3164450235, 93867188, 28156141, 1247932394, 2342496308, 3240447034, 180936924},
				PC:  4034242,
				SR:  525,
				USP: 2715370,
				SSP: 1668710,
				RAM: [][2]uint32{{4034238, 191}, {4034239, 111}, {4034240, 10}, {4034241, 171}, {4034242, 106}, {4034243, 196}, {12, 150}, {13, 124}, {14, 136}, {15, 226}, {8161506, 112}, {8161507, 225}, {8161508, 27}, {8161509, 185}},
			},
			want: cpuState{
				D:      [8]uint32{3609744020, 3243748271, 831628684, 3294858570, 1071185854, 3478528025, 3099394745, 3061239256},
				A:      [7]uint32{3164450235, 93867188, 28156141, 1247932394, 2342496308, 3240447034, 180936924},
				PC:     2524743910,
				SR:     8717,
				USP:    2715370,
				SSP:    1668696,
				RAM:    [][2]uint32{{4034238, 191}, {4034239, 111}, {4034240, 10}, {4034241, 171}, {4034242, 106}, {4034243, 196}, {1668708, 142}, {1668709, 192}, {1668704, 2}, {1668705, 13}, {1668706, 0}, {1668707, 61}, {1668702, 191}, {1668703, 111}, {1668700, 121}, {1668701, 149}, {1668696, 191}, {1668697, 113}, {1668698, 0}, {1668699, 41}, {12, 150}, {13, 124}, {14, 136}, {15, 226}, {8161506, 112}, {8161507, 225}, {8161508, 27}, {8161509, 185}},
				Halted: true,
			},
		},
		{
			name: "500 EOR.w D6, (A5)+ bd5d",
			init: cpuState{
				D:   [8]uint32{3253739069, 1016237945, 1899332519, 1322283532, 3923941416, 1952334611, 282346117, 2460766521},
				A:   [7]uint32{530895866, 3610253951, 2857707890, 3860346981, 1600845410, 1324270158, 728266933},
				PC:  16563834,
				SR:  34070,
				USP: 10744442,
				SSP: 13114000,
				RAM: [][2]uint32{{16563830, 189}, {16563831, 93}, {16563832, 161}, {16563833, 64}, {15647310, 3}, {15647311, 107}, {16563834, 117}, {16563835, 184}},
			},
			want: cpuState{
				D:   [8]uint32{3253739069, 1016237945, 1899332519, 1322283532, 3923941416, 1952334611, 282346117, 2460766521},
				A:   [7]uint32{530895866, 3610253951, 2857707890, 3860346981, 1600845410, 1324270160, 728266933},
				PC:  16563836,
				SR:  34064,
				USP: 10744442,
				SSP: 13114000,
				RAM: [][2]uint32{{16563830, 189}, {16563831, 93}, {16563832, 161}, {16563833, 64}, {15647310, 65}, {15647311, 238}, {16563834, 117}, {16563835, 184}},
			},
		},
		{
			name: "1000 EOR.w D3, (A1) b751",
			init: cpuState{
				D:   [8]uint32{3483076068, 522034624, 2413393896, 3837583993, 66594823, 2467453692, 3805897304, 3594019511},
				A:   [7]uint32{3880728526, 3336101260, 592565634, 2298699075, 2757430404, 3240065136, 192394142},
				PC:  3067180,
				SR:  8474,
				USP: 2586544,
				SSP: 16509648,
				RAM: [][2]uint32{{3067176, 183}, {3067177, 81}, {3067178, 224}, {3067179, 92}, {14212492, 118}, {14212493, 51}, {3067180, 61}, {3067181, 208}},
			},
			want: cpuState{
				D:   [8]uint32{3483076068, 522034624, 2413393896, 3837583993, 66594823, 2467453692, 3805897304, 3594019511},
				A:   [7]uint32{3880728526, 3336101260, 592565634, 2298699075, 2757430404, 3240065136, 192394142},
				PC:  3067182,
				SR:  8472,
				USP: 2586544,
				SSP: 16509648,
				RAM: [][2]uint32{{3067176, 183}, {3067177, 81}, {3067178, 224}, {3067179, 92}, {14212492, 148}, {14212493, 74}, {3067180, 61}, {3067181, 208}},
			},
		},
		{
			name: "1500 EOR.w D4, (d8, A0, Xn) b970",
			init: cpuState{
				D:   [8]uint32{3486670160, 2815118054, 4098693459, 3853517730, 1236613792, 2686835090, 2980720871, 2081804604},
				A:   [7]uint32{3382448150, 980317758, 2072580157, 2427303804, 4096808058, 2638282619, 1529531342},
				PC:  1570756,
				SR:  42517,
				USP: 13184758,
				SSP: 13930674,
				RAM: [][2]uint32{{1570752, 185}, {1570753, 112}, {1570754, 30}, {1570755, 170}, {1570756, 31}, {1570757, 112}, {6773414, 209}, {6773415, 154}, {1570758, 79}, {1570759, 241}},
			},
			want: cpuState{
				D:   [8]uint32{3486670160, 2815118054, 4098693459, 3853517730, 1236613792, 2686835090, 2980720871, 2081804604},
				A:   [7]uint32{3382448150, 980317758, 2072580157, 2427303804, 4096808058, 2638282619, 1529531342},
				PC:  1570760,
				SR:  42520,
				USP: 13184758,
				SSP: 13930674,
				RAM: [][2]uint32{{1570752, 185}, {1570753, 112}, {1570754, 30}, {1570755, 170}, {1570756, 31}, {1570757, 112}, {6773414, 235}, {6773415, 58}, {1570758, 79}, {1570759, 241}},
			},
		},
		{
			name: "2000 EOR.w D3, -(A4) b764",
			init: cpuState{
				D:   [8]uint32{1450344888, 3736443276, 1094624571, 679603623, 1955856304, 1424936195, 4289738525, 3526994095},
				A:   [7]uint32{2830495985, 554052876, 1678986477, 2456165572, 1845575815, 1298528518, 3483365963},
				PC:  6602226,
				SR:  32794,
				USP: 1715314,
				SSP: 7051804,
				RAM: [][2]uint32{{6602222, 183}, {6602223, 100}, {6602224, 52}, {6602225, 22}, {12, 49}, {13, 126}, {14, 129}, {15, 82}, {8290642, 141}, {8290643, 95}, {8290644, 229}, {8290645, 62}},
			},
			want: cpuState{
				D:      [8]uint32{1450344888, 3736443276, 1094624571, 679603623, 1955856304, 1424936195, 4289738525, 3526994095},
				A:      [7]uint32{2830495985, 554052876, 1678986477, 2456165572, 1845575813, 1298528518, 3483365963},
				PC:     830374230,
				SR:     8218,
				USP:    1715314,
				SSP:    7051790,
				RAM:    [][2]uint32{{6602222, 183}, {6602223, 100}, {6602224, 52}, {6602225, 22}, {7051802, 189}, {7051803, 242}, {7051798, 128}, {7051799, 26}, {7051800, 0}, {7051801, 100}, {7051796, 183}, {7051797, 100}, {7051794, 64}, {7051795, 133}, {7051790, 183}, {7051791, 113}, {7051792, 110}, {7051793, 1}, {12, 49}, {13, 126}, {14, 129}, {15, 82}, {8290642, 141}, {8290643, 95}, {8290644, 229}, {8290645, 62}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEOR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EOR.l D2, -(A5) b5a5",
			init: cpuState{
				D:   [8]uint32{3928778808, 2079352038, 2682923295, 3223726102, 1547726049, 749941974, 823179338, 1733805970},
				A:   [7]uint32{2821932698, 1563380308, 4179801688, 281515365, 3107417165, 3951753826, 3692718667},
				PC:  10013206,
				SR:  41499,
				USP: 8503530,
				SSP: 1862828,
				RAM: [][2]uint32{{10013202, 181}, {10013203, 165}, {10013204, 164}, {10013205, 217}, {9108062, 37}, {9108063, 88}, {9108064, 33}, {9108065, 30}, {10013206, 193}, {10013207, 224}},
			},
			want: cpuState{
				D:   [8]uint32{3928778808, 2079352038, 2682923295, 3223726102, 1547726049, 749941974, 823179338, 1733805970},
				A:   [7]uint32{2821932698, 1563380308, 4179801688, 281515365, 3107417165, 3951753822, 3692718667},
				PC:  10013208,
				SR:  41496,
				USP: 8503530,
				SSP: 1862828,
				RAM: [][2]uint32{{10013202, 181}, {10013203, 165}, {10013204, 164}, {10013205, 217}, {9108062, 186}, {9108063, 178}, {9108064, 8}, {9108065, 1}, {10013206, 193}, {10013207, 224}},
			},
		},
		{
			name: "500 EOR.l D1, (d8, A0, Xn) b3b0",
			init: cpuState{
				D:   [8]uint32{659716886, 136122778, 645524876, 3302195869, 423153222, 1063463254, 902374852, 1677817927},
				A:   [7]uint32{1475122244, 1218986610, 437689720, 3708222612, 4200796830, 2935002597, 1326491355},
				PC:  10863348,
				SR:  8981,
				USP: 11230308,
				SSP: 834730,
				RAM: [][2]uint32{{10863344, 179}, {10863345, 176}, {10863346, 29}, {10863347, 217}, {10863348, 183}, {10863349, 147}, {12, 73}, {13, 36}, {14, 102}, {15, 130}, {2385538, 23}, {2385539, 176}, {2385540, 24}, {2385541, 157}},
			},
			want: cpuState{
				D:      [8]uint32{659716886, 136122778, 645524876, 3302195869, 423153222, 1063463254, 902374852, 1677817927},
				A:      [7]uint32{1475122244, 1218986610, 437689720, 3708222612, 4200796830, 2935002597, 1326491355},
				PC:     1227122310,
				SR:     8981,
				USP:    11230308,
				SSP:    834716,
				RAM:    [][2]uint32{{10863344, 179}, {10863345, 176}, {10863346, 29}, {10863347, 217}, {10863348, 183}, {10863349, 147}, {834728, 194}, {834729, 242}, {834724, 35}, {834725, 21}, {834726, 0}, {834727, 165}, {834722, 179}, {834723, 176}, {834720, 165}, {834721, 183}, {834716, 179}, {834717, 181}, {834718, 96}, {834719, 9}, {12, 73}, {13, 36}, {14, 102}, {15, 130}, {2385538, 23}, {2385539, 176}, {2385540, 24}, {2385541, 157}},
				Halted: true,
			},
		},
		{
			name: "1000 EOR.l D1, (d16, A1) b3a9",
			init: cpuState{
				D:   [8]uint32{2195654947, 3804225568, 364787453, 2480535140, 3180147124, 4198870619, 247794665, 3688136090},
				A:   [7]uint32{2303401210, 1423325149, 2566389600, 384495469, 3356354022, 1644274341, 661788344},
				PC:  2935054,
				SR:  9221,
				USP: 3402242,
				SSP: 8304836,
				RAM: [][2]uint32{{2935050, 179}, {2935051, 169}, {2935052, 90}, {2935053, 197}, {2935054, 170}, {2935055, 83}, {14062242, 53}, {14062243, 59}, {14062244, 130}, {14062245, 58}, {2935056, 15}, {2935057, 7}},
			},
			want: cpuState{
				D:   [8]uint32{2195654947, 3804225568, 364787453, 2480535140, 3180147124, 4198870619, 247794665, 3688136090},
				A:   [7]uint32{2303401210, 1423325149, 2566389600, 384495469, 3356354022, 1644274341, 661788344},
				PC:  2935058,
				SR:  9224,
				USP: 3402242,
				SSP: 8304836,
				RAM: [][2]uint32{{2935050, 179}, {2935051, 169}, {2935052, 90}, {2935053, 197}, {2935054, 170}, {2935055, 83}, {14062242, 215}, {14062243, 132}, {14062244, 98}, {14062245, 26}, {2935056, 15}, {2935057, 7}},
			},
		},
		{
			name: "1500 EOR.l D7, (A6) bf96",
			init: cpuState{
				D:   [8]uint32{1302700381, 2493106134, 3001303510, 2854441445, 1807324955, 3915834692, 473164958, 2094801345},
				A:   [7]uint32{2384158045, 871918572, 921165313, 3673428061, 1154539197, 315689983, 2332765178},
				PC:  1231530,
				SR:  42255,
				USP: 10705264,
				SSP: 1070216,
				RAM: [][2]uint32{{1231526, 191}, {1231527, 150}, {1231528, 95}, {1231529, 136}, {732154, 41}, {732155, 7}, {732156, 179}, {732157, 4}, {1231530, 9}, {1231531, 122}},
			},
			want: cpuState{
				D:   [8]uint32{1302700381, 2493106134, 3001303510, 2854441445, 1807324955, 3915834692, 473164958, 2094801345},
				A:   [7]uint32{2384158045, 871918572, 921165313, 3673428061, 1154539197, 315689983, 2332765178},
				PC:  1231532,
				SR:  42240,
				USP: 10705264,
				SSP: 1070216,
				RAM: [][2]uint32{{1231526, 191}, {1231527, 150}, {1231528, 95}, {1231529, 136}, {732154, 85}, {732155, 219}, {732156, 146}, {732157, 197}, {1231530, 9}, {1231531, 122}},
			},
		},
		{
			name: "2000 EOR.l D3, D0 b780",
			init: cpuState{
				D:   [8]uint32{4055303072, 3701969532, 4204251732, 844725002, 3579406498, 4037590824, 181872260, 198086568},
				A:   [7]uint32{566631339, 842156694, 623943014, 1912019985, 3634910238, 3860547306, 3847017145},
				PC:  10086988,
				SR:  8971,
				USP: 16483720,
				SSP: 2652128,
				RAM: [][2]uint32{{10086984, 183}, {10086985, 128}, {10086986, 75}, {10086987, 85}, {10086988, 107}, {10086989, 48}},
			},
			want: cpuState{
				D:   [8]uint32{3287185578, 3701969532, 4204251732, 844725002, 3579406498, 4037590824, 181872260, 198086568},
				A:   [7]uint32{566631339, 842156694, 623943014, 1912019985, 3634910238, 3860547306, 3847017145},
				PC:  10086990,
				SR:  8968,
				USP: 16483720,
				SSP: 2652128,
				RAM: [][2]uint32{{10086984, 183}, {10086985, 128}, {10086986, 75}, {10086987, 85}, {10086988, 107}, {10086989, 48}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNOT_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NOT.b (A7) 4617",
			init: cpuState{
				D:   [8]uint32{2559601891, 2054041401, 97028455, 910044421, 85557167, 2632298684, 1700730959, 936216423},
				A:   [7]uint32{3811871237, 148047401, 3911004127, 3742298427, 1904513757, 811544757, 2425344126},
				PC:  6107794,
				SR:  41224,
				USP: 14768512,
				SSP: 4666216,
				RAM: [][2]uint32{{6107790, 70}, {6107791, 23}, {6107792, 132}, {6107793, 172}, {4666216, 216}, {4666217, 210}, {6107794, 50}, {6107795, 150}},
			},
			want: cpuState{
				D:   [8]uint32{2559601891, 2054041401, 97028455, 910044421, 85557167, 2632298684, 1700730959, 936216423},
				A:   [7]uint32{3811871237, 148047401, 3911004127, 3742298427, 1904513757, 811544757, 2425344126},
				PC:  6107796,
				SR:  41216,
				USP: 14768512,
				SSP: 4666216,
				RAM: [][2]uint32{{6107790, 70}, {6107791, 23}, {6107792, 132}, {6107793, 172}, {4666216, 39}, {4666217, 210}, {6107794, 50}, {6107795, 150}},
			},
		},
		{
			name: "500 NOT.b D2 4602",
			init: cpuState{
				D:   [8]uint32{614397296, 1521408887, 1770091524, 1615477103, 480504239, 2079804599, 2863713853, 4113225314},
				A:   [7]uint32{2163824906, 3178835982, 3957082209, 83019313, 1704169768, 1549029593, 809412451},
				PC:  5249764,
				SR:  8706,
				USP: 10937828,
				SSP: 13234574,
				RAM: [][2]uint32{{5249760, 70}, {5249761, 2}, {5249762, 138}, {5249763, 174}, {5249764, 198}, {5249765, 73}},
			},
			want: cpuState{
				D:   [8]uint32{614397296, 1521408887, 1770091771, 1615477103, 480504239, 2079804599, 2863713853, 4113225314},
				A:   [7]uint32{2163824906, 3178835982, 3957082209, 83019313, 1704169768, 1549029593, 809412451},
				PC:  5249766,
				SR:  8712,
				USP: 10937828,
				SSP: 13234574,
				RAM: [][2]uint32{{5249760, 70}, {5249761, 2}, {5249762, 138}, {5249763, 174}, {5249764, 198}, {5249765, 73}},
			},
		},
		{
			name: "1000 NOT.b (d8, A5, Xn) 4635",
			init: cpuState{
				D:   [8]uint32{1592364749, 2683341569, 1267868757, 2389662490, 2376183540, 454447661, 4108907705, 834021319},
				A:   [7]uint32{3771783366, 3539283280, 3391083060, 3256185366, 4250647154, 730034015, 2508463719},
				PC:  10064204,
				SR:  8723,
				USP: 842864,
				SSP: 5473290,
				RAM: [][2]uint32{{10064200, 70}, {10064201, 53}, {10064202, 34}, {10064203, 40}, {10064204, 22}, {10064205, 79}, {8623068, 205}, {8623069, 245}, {10064206, 195}, {10064207, 167}},
			},
			want: cpuState{
				D:   [8]uint32{1592364749, 2683341569, 1267868757, 2389662490, 2376183540, 454447661, 4108907705, 834021319},
				A:   [7]uint32{3771783366, 3539283280, 3391083060, 3256185366, 4250647154, 730034015, 2508463719},
				PC:  10064208,
				SR:  8720,
				USP: 842864,
				SSP: 5473290,
				RAM: [][2]uint32{{10064200, 70}, {10064201, 53}, {10064202, 34}, {10064203, 40}, {10064204, 22}, {10064205, 79}, {8623068, 50}, {8623069, 245}, {10064206, 195}, {10064207, 167}},
			},
		},
		{
			name: "1500 NOT.b (d16, A4) 462c",
			init: cpuState{
				D:   [8]uint32{3104726469, 252598494, 3595659882, 3049728854, 996257110, 745342844, 3222254920, 1632674045},
				A:   [7]uint32{3615794881, 1919948253, 1025815855, 1719740259, 3004216106, 1001600716, 3298913584},
				PC:  3395134,
				SR:  1815,
				USP: 12282404,
				SSP: 2012822,
				RAM: [][2]uint32{{3395130, 70}, {3395131, 44}, {3395132, 56}, {3395133, 153}, {3395134, 157}, {3395135, 121}, {1108930, 65}, {1108931, 84}, {3395136, 99}, {3395137, 201}},
			},
			want: cpuState{
				D:   [8]uint32{3104726469, 252598494, 3595659882, 3049728854, 996257110, 745342844, 3222254920, 1632674045},
				A:   [7]uint32{3615794881, 1919948253, 1025815855, 1719740259, 3004216106, 1001600716, 3298913584},
				PC:  3395138,
				SR:  1816,
				USP: 12282404,
				SSP: 2012822,
				RAM: [][2]uint32{{3395130, 70}, {3395131, 44}, {3395132, 56}, {3395133, 153}, {3395134, 157}, {3395135, 121}, {1108930, 65}, {1108931, 171}, {3395136, 99}, {3395137, 201}},
			},
		},
		{
			name: "2000 NOT.b (d8, A4, Xn) 4634",
			init: cpuState{
				D:   [8]uint32{2232223304, 3583954217, 3176898865, 2832591899, 4242510460, 1934704136, 380321088, 2351906208},
				A:   [7]uint32{1532981860, 2746931288, 3477121466, 3417167760, 1331909220, 3634235563, 3101141982},
				PC:  7983732,
				SR:  42520,
				USP: 12594276,
				SSP: 3330858,
				RAM: [][2]uint32{{7983728, 70}, {7983729, 52}, {7983730, 36}, {7983731, 84}, {7983732, 162}, {7983733, 248}, {6484968, 201}, {6484969, 145}, {7983734, 162}, {7983735, 98}},
			},
			want: cpuState{
				D:   [8]uint32{2232223304, 3583954217, 3176898865, 2832591899, 4242510460, 1934704136, 380321088, 2351906208},
				A:   [7]uint32{1532981860, 2746931288, 3477121466, 3417167760, 1331909220, 3634235563, 3101141982},
				PC:  7983736,
				SR:  42512,
				USP: 12594276,
				SSP: 3330858,
				RAM: [][2]uint32{{7983728, 70}, {7983729, 52}, {7983730, 36}, {7983731, 84}, {7983732, 162}, {7983733, 248}, {6484968, 201}, {6484969, 110}, {7983734, 162}, {7983735, 98}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNOT_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NOT.w (d16, A3) 466b",
			init: cpuState{
				D:   [8]uint32{1430740577, 4121101999, 2402458249, 897543055, 3006047466, 1575273451, 2489879229, 3730751052},
				A:   [7]uint32{2592013990, 3065737031, 4273193, 2136333035, 2106646423, 3877979838, 3881938216},
				PC:  14585612,
				SR:  9502,
				USP: 1271544,
				SSP: 15526476,
				RAM: [][2]uint32{{14585608, 70}, {14585609, 107}, {14585610, 74}, {14585611, 101}, {14585612, 43}, {14585613, 31}, {5645648, 4}, {5645649, 214}, {14585614, 26}, {14585615, 246}},
			},
			want: cpuState{
				D:   [8]uint32{1430740577, 4121101999, 2402458249, 897543055, 3006047466, 1575273451, 2489879229, 3730751052},
				A:   [7]uint32{2592013990, 3065737031, 4273193, 2136333035, 2106646423, 3877979838, 3881938216},
				PC:  14585616,
				SR:  9496,
				USP: 1271544,
				SSP: 15526476,
				RAM: [][2]uint32{{14585608, 70}, {14585609, 107}, {14585610, 74}, {14585611, 101}, {14585612, 43}, {14585613, 31}, {5645648, 251}, {5645649, 41}, {14585614, 26}, {14585615, 246}},
			},
		},
		{
			name: "500 NOT.w (A7) 4657",
			init: cpuState{
				D:   [8]uint32{2975513371, 2033933189, 358872151, 3157097986, 3208244952, 3258146218, 3636602249, 1945313270},
				A:   [7]uint32{2555462427, 1672609932, 857233315, 1204697685, 1809710370, 2427329910, 1216296038},
				PC:  11159152,
				SR:  784,
				USP: 10681272,
				SSP: 1276750,
				RAM: [][2]uint32{{11159148, 70}, {11159149, 87}, {11159150, 235}, {11159151, 99}, {10681272, 251}, {10681273, 236}, {11159152, 187}, {11159153, 19}},
			},
			want: cpuState{
				D:   [8]uint32{2975513371, 2033933189, 358872151, 3157097986, 3208244952, 3258146218, 3636602249, 1945313270},
				A:   [7]uint32{2555462427, 1672609932, 857233315, 1204697685, 1809710370, 2427329910, 1216296038},
				PC:  11159154,
				SR:  784,
				USP: 10681272,
				SSP: 1276750,
				RAM: [][2]uint32{{11159148, 70}, {11159149, 87}, {11159150, 235}, {11159151, 99}, {10681272, 4}, {10681273, 19}, {11159152, 187}, {11159153, 19}},
			},
		},
		{
			name: "1000 NOT.w (d8, A5, Xn) 4675",
			init: cpuState{
				D:   [8]uint32{2242329005, 3010299599, 68563907, 3847555751, 3616553438, 180954621, 2478444693, 3639592330},
				A:   [7]uint32{3538526618, 1688814725, 358470144, 2274330874, 2305279033, 2211580593, 3268650126},
				PC:  12286666,
				SR:  10007,
				USP: 6005634,
				SSP: 1513176,
				RAM: [][2]uint32{{12286662, 70}, {12286663, 117}, {12286664, 141}, {12286665, 185}, {12286666, 173}, {12286667, 35}, {12299268, 13}, {12299269, 202}, {12286668, 210}, {12286669, 47}},
			},
			want: cpuState{
				D:   [8]uint32{2242329005, 3010299599, 68563907, 3847555751, 3616553438, 180954621, 2478444693, 3639592330},
				A:   [7]uint32{3538526618, 1688814725, 358470144, 2274330874, 2305279033, 2211580593, 3268650126},
				PC:  12286670,
				SR:  10008,
				USP: 6005634,
				SSP: 1513176,
				RAM: [][2]uint32{{12286662, 70}, {12286663, 117}, {12286664, 141}, {12286665, 185}, {12286666, 173}, {12286667, 35}, {12299268, 242}, {12299269, 53}, {12286668, 210}, {12286669, 47}},
			},
		},
		{
			name: "1500 NOT.w (d8, A5, Xn) 4675",
			init: cpuState{
				D:   [8]uint32{850430516, 4145376698, 900433269, 418270675, 3256449363, 3115785313, 148920985, 4145641141},
				A:   [7]uint32{2479644152, 1368040089, 2605453070, 1525968254, 3243237318, 1281377243, 169148644},
				PC:  11371618,
				SR:  8466,
				USP: 10341918,
				SSP: 4638980,
				RAM: [][2]uint32{{11371614, 70}, {11371615, 117}, {11371616, 80}, {11371617, 89}, {11371618, 52}, {11371619, 226}, {12, 45}, {13, 46}, {14, 232}, {15, 8}, {3074056, 214}, {3074057, 196}, {3074058, 19}, {3074059, 208}},
			},
			want: cpuState{
				D:      [8]uint32{850430516, 4145376698, 900433269, 418270675, 3256449363, 3115785313, 148920985, 4145641141},
				A:      [7]uint32{2479644152, 1368040089, 2605453070, 1525968254, 3243237318, 1281377243, 169148644},
				PC:     758048780,
				SR:     8466,
				USP:    10341918,
				SSP:    4638966,
				RAM:    [][2]uint32{{11371614, 70}, {11371615, 117}, {11371616, 80}, {11371617, 89}, {11371618, 52}, {11371619, 226}, {4638978, 132}, {4638979, 96}, {4638974, 33}, {4638975, 18}, {4638976, 0}, {4638977, 173}, {4638972, 70}, {4638973, 117}, {4638970, 96}, {4638971, 149}, {4638966, 70}, {4638967, 117}, {4638968, 76}, {4638969, 96}, {12, 45}, {13, 46}, {14, 232}, {15, 8}, {3074056, 214}, {3074057, 196}, {3074058, 19}, {3074059, 208}},
				Halted: true,
			},
		},
		{
			name: "2000 NOT.w (A6)+ 465e",
			init: cpuState{
				D:   [8]uint32{3859221000, 4252304118, 2859407010, 137627953, 1357080758, 2916797372, 3063376440, 2392681481},
				A:   [7]uint32{3944021602, 1263093144, 2846000954, 4078939836, 497226212, 2327033538, 3383353801},
				PC:  2802220,
				SR:  33296,
				USP: 16699528,
				SSP: 10259938,
				RAM: [][2]uint32{{2802216, 70}, {2802217, 94}, {2802218, 109}, {2802219, 137}, {12, 196}, {13, 74}, {14, 67}, {15, 164}, {4866980, 118}, {4866981, 46}, {4866982, 193}, {4866983, 76}},
			},
			want: cpuState{
				D:      [8]uint32{3859221000, 4252304118, 2859407010, 137627953, 1357080758, 2916797372, 3063376440, 2392681481},
				A:      [7]uint32{3944021602, 1263093144, 2846000954, 4078939836, 497226212, 2327033538, 3383353803},
				PC:     3293201320,
				SR:     8720,
				USP:    16699528,
				SSP:    10259924,
				RAM:    [][2]uint32{{2802216, 70}, {2802217, 94}, {2802218, 109}, {2802219, 137}, {10259936, 194}, {10259937, 42}, {10259932, 130}, {10259933, 16}, {10259934, 0}, {10259935, 42}, {10259930, 70}, {10259931, 94}, {10259928, 225}, {10259929, 201}, {10259924, 70}, {10259925, 81}, {10259926, 201}, {10259927, 169}, {12, 196}, {13, 74}, {14, 67}, {15, 164}, {4866980, 118}, {4866981, 46}, {4866982, 193}, {4866983, 76}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestNOT_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NOT.l D3 4683",
			init: cpuState{
				D:   [8]uint32{1579703622, 3647245374, 2292136252, 3363501296, 975048880, 2710219579, 2788478342, 1692537478},
				A:   [7]uint32{3842939765, 1654006570, 2299450896, 1487660210, 1492052198, 388120030, 246633220},
				PC:  12744490,
				SR:  33809,
				USP: 1691832,
				SSP: 8065156,
				RAM: [][2]uint32{{12744486, 70}, {12744487, 131}, {12744488, 184}, {12744489, 93}, {12744490, 53}, {12744491, 94}},
			},
			want: cpuState{
				D:   [8]uint32{1579703622, 3647245374, 2292136252, 931465999, 975048880, 2710219579, 2788478342, 1692537478},
				A:   [7]uint32{3842939765, 1654006570, 2299450896, 1487660210, 1492052198, 388120030, 246633220},
				PC:  12744492,
				SR:  33808,
				USP: 1691832,
				SSP: 8065156,
				RAM: [][2]uint32{{12744486, 70}, {12744487, 131}, {12744488, 184}, {12744489, 93}, {12744490, 53}, {12744491, 94}},
			},
		},
		{
			name: "500 NOT.l (A2) 4692",
			init: cpuState{
				D:   [8]uint32{192301078, 2948703445, 405392927, 3815715779, 3107947918, 1428493185, 3070425277, 1644291674},
				A:   [7]uint32{1034226651, 2786674089, 3005748791, 2962399385, 315062157, 1162953816, 2843322573},
				PC:  8577512,
				SR:  793,
				USP: 14201130,
				SSP: 7394472,
				RAM: [][2]uint32{{8577508, 70}, {8577509, 146}, {8577510, 67}, {8577511, 246}, {12, 174}, {13, 64}, {14, 92}, {15, 88}, {4217944, 197}, {4217945, 94}, {4217946, 202}, {4217947, 38}},
			},
			want: cpuState{
				D:      [8]uint32{192301078, 2948703445, 405392927, 3815715779, 3107947918, 1428493185, 3070425277, 1644291674},
				A:      [7]uint32{1034226651, 2786674089, 3005748791, 2962399385, 315062157, 1162953816, 2843322573},
				PC:     2923453532,
				SR:     8985,
				USP:    14201130,
				SSP:    7394458,
				RAM:    [][2]uint32{{8577508, 70}, {8577509, 146}, {8577510, 67}, {8577511, 246}, {7394470, 225}, {7394471, 230}, {7394466, 3}, {7394467, 25}, {7394468, 0}, {7394469, 130}, {7394464, 70}, {7394465, 146}, {7394462, 22}, {7394463, 55}, {7394458, 70}, {7394459, 145}, {7394460, 179}, {7394461, 40}, {12, 174}, {13, 64}, {14, 92}, {15, 88}, {4217944, 197}, {4217945, 94}, {4217946, 202}, {4217947, 38}},
				Halted: true,
			},
		},
		{
			name: "1000 NOT.l (d8, A7, Xn) 46b7",
			init: cpuState{
				D:   [8]uint32{4078624384, 1775144042, 569850184, 120493339, 3032376800, 588667469, 2282814542, 3888968914},
				A:   [7]uint32{3020906940, 3590003320, 2511113187, 2240151022, 11916609, 3860574581, 2149604097},
				PC:  13251496,
				SR:  9479,
				USP: 7215508,
				SSP: 11859574,
				RAM: [][2]uint32{{13251492, 70}, {13251493, 183}, {13251494, 207}, {13251495, 233}, {13251496, 20}, {13251497, 252}, {6998944, 181}, {6998945, 32}, {6998946, 54}, {6998947, 112}, {13251498, 58}, {13251499, 148}},
			},
			want: cpuState{
				D:   [8]uint32{4078624384, 1775144042, 569850184, 120493339, 3032376800, 588667469, 2282814542, 3888968914},
				A:   [7]uint32{3020906940, 3590003320, 2511113187, 2240151022, 11916609, 3860574581, 2149604097},
				PC:  13251500,
				SR:  9472,
				USP: 7215508,
				SSP: 11859574,
				RAM: [][2]uint32{{13251492, 70}, {13251493, 183}, {13251494, 207}, {13251495, 233}, {13251496, 20}, {13251497, 252}, {6998944, 74}, {6998945, 223}, {6998946, 201}, {6998947, 143}, {13251498, 58}, {13251499, 148}},
			},
		},
		{
			name: "1500 NOT.l (A6) 4696",
			init: cpuState{
				D:   [8]uint32{4081936339, 4069507926, 1874594715, 1865287255, 350619463, 161588247, 1080397321, 2517967424},
				A:   [7]uint32{3125674736, 847717005, 2155872764, 1081452602, 3603653779, 4046519233, 2881300326},
				PC:  6545778,
				SR:  34582,
				USP: 8167478,
				SSP: 4304042,
				RAM: [][2]uint32{{6545774, 70}, {6545775, 150}, {6545776, 35}, {6545777, 207}, {12396390, 68}, {12396391, 245}, {12396392, 58}, {12396393, 151}, {6545778, 165}, {6545779, 128}},
			},
			want: cpuState{
				D:   [8]uint32{4081936339, 4069507926, 1874594715, 1865287255, 350619463, 161588247, 1080397321, 2517967424},
				A:   [7]uint32{3125674736, 847717005, 2155872764, 1081452602, 3603653779, 4046519233, 2881300326},
				PC:  6545780,
				SR:  34584,
				USP: 8167478,
				SSP: 4304042,
				RAM: [][2]uint32{{6545774, 70}, {6545775, 150}, {6545776, 35}, {6545777, 207}, {12396390, 187}, {12396391, 10}, {12396392, 197}, {12396393, 104}, {6545778, 165}, {6545779, 128}},
			},
		},
		{
			name: "2000 NOT.l (d8, A2, Xn) 46b2",
			init: cpuState{
				D:   [8]uint32{381479299, 451667966, 3313824343, 347120840, 879128643, 2699068407, 481463158, 1582036580},
				A:   [7]uint32{4217085327, 3405869801, 2102970531, 2941082323, 1480740376, 2902449545, 1465970804},
				PC:  15739264,
				SR:  42011,
				USP: 665046,
				SSP: 14376736,
				RAM: [][2]uint32{{15739260, 70}, {15739261, 178}, {15739262, 38}, {15739263, 67}, {15739264, 37}, {15739265, 3}, {12, 12}, {13, 0}, {14, 173}, {15, 42}, {44330, 235}, {44331, 85}, {44332, 255}, {44333, 208}},
			},
			want: cpuState{
				D:      [8]uint32{381479299, 451667966, 3313824343, 347120840, 879128643, 2699068407, 481463158, 1582036580},
				A:      [7]uint32{4217085327, 3405869801, 2102970531, 2941082323, 1480740376, 2902449545, 1465970804},
				PC:     201370926,
				SR:     9243,
				USP:    665046,
				SSP:    14376722,
				RAM:    [][2]uint32{{15739260, 70}, {15739261, 178}, {15739262, 38}, {15739263, 67}, {15739264, 37}, {15739265, 3}, {14376734, 41}, {14376735, 126}, {14376730, 164}, {14376731, 27}, {14376732, 0}, {14376733, 240}, {14376728, 70}, {14376729, 178}, {14376726, 187}, {14376727, 61}, {14376722, 70}, {14376723, 181}, {14376724, 125}, {14376725, 88}, {12, 12}, {13, 0}, {14, 173}, {15, 42}, {44330, 235}, {44331, 85}, {44332, 255}, {44333, 208}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTST_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TST.b D5 4a05",
			init: cpuState{
				D:   [8]uint32{846714821, 646404932, 3022754438, 2410866885, 3580684883, 1697763789, 3779951095, 1665669656},
				A:   [7]uint32{3887929160, 2583917214, 2491831459, 3744447675, 462312535, 3262836416, 1146829190},
				PC:  15316282,
				SR:  8718,
				USP: 9280610,
				SSP: 3889344,
				RAM: [][2]uint32{{15316278, 74}, {15316279, 5}, {15316280, 48}, {15316281, 62}, {15316282, 118}, {15316283, 242}},
			},
			want: cpuState{
				D:   [8]uint32{846714821, 646404932, 3022754438, 2410866885, 3580684883, 1697763789, 3779951095, 1665669656},
				A:   [7]uint32{3887929160, 2583917214, 2491831459, 3744447675, 462312535, 3262836416, 1146829190},
				PC:  15316284,
				SR:  8712,
				USP: 9280610,
				SSP: 3889344,
				RAM: [][2]uint32{{15316278, 74}, {15316279, 5}, {15316280, 48}, {15316281, 62}, {15316282, 118}, {15316283, 242}},
			},
		},
		{
			name: "500 TST.b -(A6) 4a26",
			init: cpuState{
				D:   [8]uint32{2050499491, 1622638113, 237943403, 2863009495, 794908350, 3552023109, 2456849696, 4099111455},
				A:   [7]uint32{129545788, 2710872769, 1081044753, 339385425, 1059403425, 3035601736, 334115886},
				PC:  11264872,
				SR:  34055,
				USP: 125196,
				SSP: 5476072,
				RAM: [][2]uint32{{11264868, 74}, {11264869, 38}, {11264870, 59}, {11264871, 207}, {15348780, 228}, {15348781, 82}, {11264872, 105}, {11264873, 156}},
			},
			want: cpuState{
				D:   [8]uint32{2050499491, 1622638113, 237943403, 2863009495, 794908350, 3552023109, 2456849696, 4099111455},
				A:   [7]uint32{129545788, 2710872769, 1081044753, 339385425, 1059403425, 3035601736, 334115885},
				PC:  11264874,
				SR:  34048,
				USP: 125196,
				SSP: 5476072,
				RAM: [][2]uint32{{11264868, 74}, {11264869, 38}, {11264870, 59}, {11264871, 207}, {15348780, 228}, {15348781, 82}, {11264872, 105}, {11264873, 156}},
			},
		},
		{
			name: "1000 TST.b (A5)+ 4a1d",
			init: cpuState{
				D:   [8]uint32{1326270302, 138193945, 3769916709, 620890219, 2923938314, 3686239656, 2510371410, 3120738069},
				A:   [7]uint32{2076284935, 2779000921, 412437247, 2209445082, 4145007600, 1518305186, 2896579074},
				PC:  15505346,
				SR:  9742,
				USP: 3784902,
				SSP: 3788088,
				RAM: [][2]uint32{{15505342, 74}, {15505343, 29}, {15505344, 223}, {15505345, 3}, {8355746, 33}, {8355747, 244}, {15505346, 189}, {15505347, 124}},
			},
			want: cpuState{
				D:   [8]uint32{1326270302, 138193945, 3769916709, 620890219, 2923938314, 3686239656, 2510371410, 3120738069},
				A:   [7]uint32{2076284935, 2779000921, 412437247, 2209445082, 4145007600, 1518305187, 2896579074},
				PC:  15505348,
				SR:  9728,
				USP: 3784902,
				SSP: 3788088,
				RAM: [][2]uint32{{15505342, 74}, {15505343, 29}, {15505344, 223}, {15505345, 3}, {8355746, 33}, {8355747, 244}, {15505346, 189}, {15505347, 124}},
			},
		},
		{
			name: "1500 TST.b D0 4a00",
			init: cpuState{
				D:   [8]uint32{959543294, 2198274938, 921019127, 4185072736, 3645082287, 3659424624, 3093861902, 573260461},
				A:   [7]uint32{3367038132, 3293938994, 1220462862, 164509657, 1300226975, 488025081, 1212909862},
				PC:  11210204,
				SR:  41490,
				USP: 6533690,
				SSP: 15604696,
				RAM: [][2]uint32{{11210200, 74}, {11210201, 0}, {11210202, 231}, {11210203, 208}, {11210204, 123}, {11210205, 178}},
			},
			want: cpuState{
				D:   [8]uint32{959543294, 2198274938, 921019127, 4185072736, 3645082287, 3659424624, 3093861902, 573260461},
				A:   [7]uint32{3367038132, 3293938994, 1220462862, 164509657, 1300226975, 488025081, 1212909862},
				PC:  11210206,
				SR:  41496,
				USP: 6533690,
				SSP: 15604696,
				RAM: [][2]uint32{{11210200, 74}, {11210201, 0}, {11210202, 231}, {11210203, 208}, {11210204, 123}, {11210205, 178}},
			},
		},
		{
			name: "2000 TST.b -(A4) 4a24",
			init: cpuState{
				D:   [8]uint32{4012376908, 819470209, 3495364337, 178943219, 312725095, 3576633512, 2941929555, 4223042332},
				A:   [7]uint32{4146844344, 1255422383, 688730124, 2660413563, 2089104047, 1594422682, 319763238},
				PC:  7585610,
				SR:  9728,
				USP: 3224694,
				SSP: 15159150,
				RAM: [][2]uint32{{7585606, 74}, {7585607, 36}, {7585608, 176}, {7585609, 195}, {8729262, 173}, {8729263, 7}, {7585610, 44}, {7585611, 143}},
			},
			want: cpuState{
				D:   [8]uint32{4012376908, 819470209, 3495364337, 178943219, 312725095, 3576633512, 2941929555, 4223042332},
				A:   [7]uint32{4146844344, 1255422383, 688730124, 2660413563, 2089104046, 1594422682, 319763238},
				PC:  7585612,
				SR:  9736,
				USP: 3224694,
				SSP: 15159150,
				RAM: [][2]uint32{{7585606, 74}, {7585607, 36}, {7585608, 176}, {7585609, 195}, {8729262, 173}, {8729263, 7}, {7585610, 44}, {7585611, 143}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTST_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TST.w -(A3) 4a63",
			init: cpuState{
				D:   [8]uint32{2608745888, 650933816, 1727878412, 877554046, 3158028444, 1391447430, 3774481428, 3624241845},
				A:   [7]uint32{4207237481, 1039397942, 1154057725, 3728533086, 3565609677, 2848513006, 2484841022},
				PC:  2419882,
				SR:  8972,
				USP: 12356562,
				SSP: 15882620,
				RAM: [][2]uint32{{2419878, 74}, {2419879, 99}, {2419880, 238}, {2419881, 146}, {3991132, 168}, {3991133, 196}, {2419882, 123}, {2419883, 214}},
			},
			want: cpuState{
				D:   [8]uint32{2608745888, 650933816, 1727878412, 877554046, 3158028444, 1391447430, 3774481428, 3624241845},
				A:   [7]uint32{4207237481, 1039397942, 1154057725, 3728533084, 3565609677, 2848513006, 2484841022},
				PC:  2419884,
				SR:  8968,
				USP: 12356562,
				SSP: 15882620,
				RAM: [][2]uint32{{2419878, 74}, {2419879, 99}, {2419880, 238}, {2419881, 146}, {3991132, 168}, {3991133, 196}, {2419882, 123}, {2419883, 214}},
			},
		},
		{
			name: "500 TST.w (A6)+ 4a5e",
			init: cpuState{
				D:   [8]uint32{3585410267, 2512736982, 1776797516, 1232310018, 3804110970, 298421658, 1432006706, 593847971},
				A:   [7]uint32{1325917020, 2919848112, 3929573053, 2669685500, 2287110912, 548091140, 2908348528},
				PC:  15951730,
				SR:  1557,
				USP: 7349708,
				SSP: 10880578,
				RAM: [][2]uint32{{15951726, 74}, {15951727, 94}, {15951728, 188}, {15951729, 236}, {5890160, 128}, {5890161, 71}, {15951730, 198}, {15951731, 221}},
			},
			want: cpuState{
				D:   [8]uint32{3585410267, 2512736982, 1776797516, 1232310018, 3804110970, 298421658, 1432006706, 593847971},
				A:   [7]uint32{1325917020, 2919848112, 3929573053, 2669685500, 2287110912, 548091140, 2908348530},
				PC:  15951732,
				SR:  1560,
				USP: 7349708,
				SSP: 10880578,
				RAM: [][2]uint32{{15951726, 74}, {15951727, 94}, {15951728, 188}, {15951729, 236}, {5890160, 128}, {5890161, 71}, {15951730, 198}, {15951731, 221}},
			},
		},
		{
			name: "1000 TST.w D2 4a42",
			init: cpuState{
				D:   [8]uint32{3543789600, 26596668, 1391474110, 22422274, 1568422884, 3989946168, 3432712420, 130253235},
				A:   [7]uint32{2689036098, 487454869, 3054686259, 383239470, 1155513823, 3986831689, 2524704090},
				PC:  10167770,
				SR:  8987,
				USP: 16669326,
				SSP: 15841760,
				RAM: [][2]uint32{{10167766, 74}, {10167767, 66}, {10167768, 154}, {10167769, 167}, {10167770, 63}, {10167771, 246}},
			},
			want: cpuState{
				D:   [8]uint32{3543789600, 26596668, 1391474110, 22422274, 1568422884, 3989946168, 3432712420, 130253235},
				A:   [7]uint32{2689036098, 487454869, 3054686259, 383239470, 1155513823, 3986831689, 2524704090},
				PC:  10167772,
				SR:  8976,
				USP: 16669326,
				SSP: 15841760,
				RAM: [][2]uint32{{10167766, 74}, {10167767, 66}, {10167768, 154}, {10167769, 167}, {10167770, 63}, {10167771, 246}},
			},
		},
		{
			name: "1500 TST.w (A7) 4a57",
			init: cpuState{
				D:   [8]uint32{1154346775, 1873789327, 498437845, 3915551194, 556190953, 3748665294, 2324308769, 337463912},
				A:   [7]uint32{1885831679, 381864868, 2921424140, 3772375150, 3116516471, 840938876, 1724713200},
				PC:  9157224,
				SR:  42245,
				USP: 6043532,
				SSP: 13565906,
				RAM: [][2]uint32{{9157220, 74}, {9157221, 87}, {9157222, 103}, {9157223, 143}, {13565906, 232}, {13565907, 142}, {9157224, 33}, {9157225, 15}},
			},
			want: cpuState{
				D:   [8]uint32{1154346775, 1873789327, 498437845, 3915551194, 556190953, 3748665294, 2324308769, 337463912},
				A:   [7]uint32{1885831679, 381864868, 2921424140, 3772375150, 3116516471, 840938876, 1724713200},
				PC:  9157226,
				SR:  42248,
				USP: 6043532,
				SSP: 13565906,
				RAM: [][2]uint32{{9157220, 74}, {9157221, 87}, {9157222, 103}, {9157223, 143}, {13565906, 232}, {13565907, 142}, {9157224, 33}, {9157225, 15}},
			},
		},
		{
			name: "2000 TST.w D2 4a42",
			init: cpuState{
				D:   [8]uint32{3500582587, 4184572673, 499450437, 4160193178, 429999251, 591687535, 3927137846, 1412749203},
				A:   [7]uint32{3603871705, 2878136463, 755665821, 530830060, 755104194, 3568312777, 4240731294},
				PC:  14722868,
				SR:  41988,
				USP: 11828152,
				SSP: 7647792,
				RAM: [][2]uint32{{14722864, 74}, {14722865, 66}, {14722866, 103}, {14722867, 48}, {14722868, 180}, {14722869, 203}},
			},
			want: cpuState{
				D:   [8]uint32{3500582587, 4184572673, 499450437, 4160193178, 429999251, 591687535, 3927137846, 1412749203},
				A:   [7]uint32{3603871705, 2878136463, 755665821, 530830060, 755104194, 3568312777, 4240731294},
				PC:  14722870,
				SR:  41984,
				USP: 11828152,
				SSP: 7647792,
				RAM: [][2]uint32{{14722864, 74}, {14722865, 66}, {14722866, 103}, {14722867, 48}, {14722868, 180}, {14722869, 203}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTST_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TST.l (A3)+ 4a9b",
			init: cpuState{
				D:   [8]uint32{392338856, 575745694, 1285145668, 2889595002, 1934093247, 624730210, 2551632161, 128177730},
				A:   [7]uint32{3651211208, 65103521, 510446476, 2480339192, 4174934748, 34041163, 3484523032},
				PC:  538048,
				SR:  266,
				USP: 15138578,
				SSP: 16253590,
				RAM: [][2]uint32{{538044, 74}, {538045, 155}, {538046, 51}, {538047, 219}, {14088440, 216}, {14088441, 228}, {14088442, 63}, {14088443, 15}, {538048, 39}, {538049, 177}},
			},
			want: cpuState{
				D:   [8]uint32{392338856, 575745694, 1285145668, 2889595002, 1934093247, 624730210, 2551632161, 128177730},
				A:   [7]uint32{3651211208, 65103521, 510446476, 2480339196, 4174934748, 34041163, 3484523032},
				PC:  538050,
				SR:  264,
				USP: 15138578,
				SSP: 16253590,
				RAM: [][2]uint32{{538044, 74}, {538045, 155}, {538046, 51}, {538047, 219}, {14088440, 216}, {14088441, 228}, {14088442, 63}, {14088443, 15}, {538048, 39}, {538049, 177}},
			},
		},
		{
			name: "500 TST.l (A4)+ 4a9c",
			init: cpuState{
				D:   [8]uint32{1541533400, 366337260, 495035572, 1339442496, 2074111443, 3237308231, 134789519, 700881213},
				A:   [7]uint32{1170022116, 3693685539, 632105546, 2232408333, 2299379293, 2697427698, 1404834479},
				PC:  1903154,
				SR:  34314,
				USP: 51168,
				SSP: 7769490,
				RAM: [][2]uint32{{1903150, 74}, {1903151, 156}, {1903152, 77}, {1903153, 206}, {12, 204}, {13, 22}, {14, 0}, {15, 78}, {1441870, 144}, {1441871, 64}, {1441872, 97}, {1441873, 103}},
			},
			want: cpuState{
				D:      [8]uint32{1541533400, 366337260, 495035572, 1339442496, 2074111443, 3237308231, 134789519, 700881213},
				A:      [7]uint32{1170022116, 3693685539, 632105546, 2232408333, 2299379293, 2697427698, 1404834479},
				PC:     3423993938,
				SR:     9738,
				USP:    51168,
				SSP:    7769476,
				RAM:    [][2]uint32{{1903150, 74}, {1903151, 156}, {1903152, 77}, {1903153, 206}, {7769488, 10}, {7769489, 48}, {7769484, 134}, {7769485, 10}, {7769486, 0}, {7769487, 29}, {7769482, 74}, {7769483, 156}, {7769480, 190}, {7769481, 93}, {7769476, 74}, {7769477, 145}, {7769478, 137}, {7769479, 13}, {12, 204}, {13, 22}, {14, 0}, {15, 78}, {1441870, 144}, {1441871, 64}, {1441872, 97}, {1441873, 103}},
				Halted: true,
			},
		},
		{
			name: "1000 TST.l (d8, A2, Xn) 4ab2",
			init: cpuState{
				D:   [8]uint32{4028359215, 910667542, 1186374698, 1999638695, 3796833560, 3579536216, 43818076, 3380038896},
				A:   [7]uint32{3164226988, 747015698, 2050837628, 4238160995, 497279810, 808869613, 414893530},
				PC:  11603594,
				SR:  41482,
				USP: 16550424,
				SSP: 2370568,
				RAM: [][2]uint32{{11603590, 74}, {11603591, 178}, {11603592, 160}, {11603593, 131}, {11603594, 250}, {11603595, 30}, {12, 249}, {13, 92}, {14, 157}, {15, 6}, {6069510, 160}, {6069511, 60}, {6069512, 47}, {6069513, 98}},
			},
			want: cpuState{
				D:      [8]uint32{4028359215, 910667542, 1186374698, 1999638695, 3796833560, 3579536216, 43818076, 3380038896},
				A:      [7]uint32{3164226988, 747015698, 2050837628, 4238160995, 497279810, 808869613, 414893530},
				PC:     4183596298,
				SR:     8714,
				USP:    16550424,
				SSP:    2370554,
				RAM:    [][2]uint32{{11603590, 74}, {11603591, 178}, {11603592, 160}, {11603593, 131}, {11603594, 250}, {11603595, 30}, {2370566, 14}, {2370567, 136}, {2370562, 162}, {2370563, 10}, {2370564, 0}, {2370565, 177}, {2370560, 74}, {2370561, 178}, {2370558, 152}, {2370559, 123}, {2370554, 74}, {2370555, 181}, {2370556, 122}, {2370557, 61}, {12, 249}, {13, 92}, {14, 157}, {15, 6}, {6069510, 160}, {6069511, 60}, {6069512, 47}, {6069513, 98}},
				Halted: true,
			},
		},
		{
			name: "1500 TST.l (A0) 4a90",
			init: cpuState{
				D:   [8]uint32{1484345786, 1179190168, 67852079, 1708721554, 2789247177, 2361600578, 3971813293, 3141332511},
				A:   [7]uint32{1491387384, 3569545193, 4253301744, 2091682973, 2743499370, 2569068160, 1269938440},
				PC:  10853574,
				SR:  33301,
				USP: 6463968,
				SSP: 3015496,
				RAM: [][2]uint32{{10853570, 74}, {10853571, 144}, {10853572, 124}, {10853573, 31}, {14992376, 53}, {14992377, 137}, {14992378, 188}, {14992379, 97}, {10853574, 37}, {10853575, 252}},
			},
			want: cpuState{
				D:   [8]uint32{1484345786, 1179190168, 67852079, 1708721554, 2789247177, 2361600578, 3971813293, 3141332511},
				A:   [7]uint32{1491387384, 3569545193, 4253301744, 2091682973, 2743499370, 2569068160, 1269938440},
				PC:  10853576,
				SR:  33296,
				USP: 6463968,
				SSP: 3015496,
				RAM: [][2]uint32{{10853570, 74}, {10853571, 144}, {10853572, 124}, {10853573, 31}, {14992376, 53}, {14992377, 137}, {14992378, 188}, {14992379, 97}, {10853574, 37}, {10853575, 252}},
			},
		},
		{
			name: "2000 TST.l (A3) 4a93",
			init: cpuState{
				D:   [8]uint32{759308172, 1816863587, 2523437302, 2884034688, 2610667906, 1277506688, 3816107819, 3759890551},
				A:   [7]uint32{4271701043, 1575272675, 4266023303, 2323563765, 1297297449, 3754936381, 3114992177},
				PC:  6865088,
				SR:  33823,
				USP: 10892300,
				SSP: 12625086,
				RAM: [][2]uint32{{6865084, 74}, {6865085, 147}, {6865086, 19}, {6865087, 194}, {12, 192}, {13, 70}, {14, 151}, {15, 84}, {4626260, 124}, {4626261, 221}, {4626262, 183}, {4626263, 94}},
			},
			want: cpuState{
				D:      [8]uint32{759308172, 1816863587, 2523437302, 2884034688, 2610667906, 1277506688, 3816107819, 3759890551},
				A:      [7]uint32{4271701043, 1575272675, 4266023303, 2323563765, 1297297449, 3754936381, 3114992177},
				PC:     3225851736,
				SR:     9247,
				USP:    10892300,
				SSP:    12625072,
				RAM:    [][2]uint32{{6865084, 74}, {6865085, 147}, {6865086, 19}, {6865087, 194}, {12625084, 192}, {12625085, 190}, {12625080, 132}, {12625081, 31}, {12625082, 0}, {12625083, 104}, {12625078, 74}, {12625079, 147}, {12625076, 196}, {12625077, 245}, {12625072, 74}, {12625073, 145}, {12625074, 138}, {12625075, 126}, {12, 192}, {13, 70}, {14, 151}, {15, 84}, {4626260, 124}, {4626261, 221}, {4626262, 183}, {4626263, 94}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTAS(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TAS (A1) 4ad1",
			init: cpuState{
				D:   [8]uint32{977090634, 3701951921, 3445948972, 996719339, 2754339530, 3223994515, 197781903, 1390960277},
				A:   [7]uint32{2913762112, 3294663737, 3257528816, 3479158592, 1183975623, 398401328, 953502955},
				PC:  10918948,
				SR:  34054,
				USP: 10356042,
				SSP: 7233526,
				RAM: [][2]uint32{{10918944, 74}, {10918945, 209}, {10918946, 148}, {10918947, 66}, {6329400, 226}, {6329401, 222}, {10918948, 181}, {10918949, 68}},
			},
			want: cpuState{
				D:   [8]uint32{977090634, 3701951921, 3445948972, 996719339, 2754339530, 3223994515, 197781903, 1390960277},
				A:   [7]uint32{2913762112, 3294663737, 3257528816, 3479158592, 1183975623, 398401328, 953502955},
				PC:  10918950,
				SR:  34056,
				USP: 10356042,
				SSP: 7233526,
				RAM: [][2]uint32{{10918944, 74}, {10918945, 209}, {10918946, 148}, {10918947, 66}, {6329400, 226}, {6329401, 222}, {10918948, 181}, {10918949, 68}},
			},
		},
		{
			name: "500 TAS (xxx).w 4af8",
			init: cpuState{
				D:   [8]uint32{3264331379, 988200499, 46255467, 2031825539, 3813943470, 2608200143, 1948048841, 10015486},
				A:   [7]uint32{2851274113, 4176400581, 3609501432, 4225604774, 3844858849, 1286962977, 237391758},
				PC:  13367938,
				SR:  8209,
				USP: 13978038,
				SSP: 934682,
				RAM: [][2]uint32{{13367934, 74}, {13367935, 248}, {13367936, 28}, {13367937, 131}, {13367938, 200}, {13367939, 51}, {7298, 87}, {7299, 210}, {13367940, 20}, {13367941, 242}},
			},
			want: cpuState{
				D:   [8]uint32{3264331379, 988200499, 46255467, 2031825539, 3813943470, 2608200143, 1948048841, 10015486},
				A:   [7]uint32{2851274113, 4176400581, 3609501432, 4225604774, 3844858849, 1286962977, 237391758},
				PC:  13367942,
				SR:  8216,
				USP: 13978038,
				SSP: 934682,
				RAM: [][2]uint32{{13367934, 74}, {13367935, 248}, {13367936, 28}, {13367937, 131}, {13367938, 200}, {13367939, 51}, {7298, 87}, {7299, 210}, {13367940, 20}, {13367941, 242}},
			},
		},
		{
			name: "1000 TAS D1 4ac1",
			init: cpuState{
				D:   [8]uint32{2445892461, 1102641132, 2071963560, 1043659441, 1665066934, 1372284160, 2868424407, 82388987},
				A:   [7]uint32{3176606760, 52286722, 1562505406, 899996673, 3313430884, 294632420, 525916301},
				PC:  1348884,
				SR:  41987,
				USP: 728080,
				SSP: 15970852,
				RAM: [][2]uint32{{1348880, 74}, {1348881, 193}, {1348882, 66}, {1348883, 119}, {1348884, 55}, {1348885, 156}},
			},
			want: cpuState{
				D:   [8]uint32{2445892461, 1102641132, 2071963560, 1043659441, 1665066934, 1372284160, 2868424407, 82388987},
				A:   [7]uint32{3176606760, 52286722, 1562505406, 899996673, 3313430884, 294632420, 525916301},
				PC:  1348886,
				SR:  41992,
				USP: 728080,
				SSP: 15970852,
				RAM: [][2]uint32{{1348880, 74}, {1348881, 193}, {1348882, 66}, {1348883, 119}, {1348884, 55}, {1348885, 156}},
			},
		},
		{
			name: "1500 TAS (xxx).l 4af9",
			init: cpuState{
				D:   [8]uint32{4126556488, 2144218795, 2377097410, 3794780528, 3718904629, 1886831092, 2063303128, 2152114569},
				A:   [7]uint32{876504997, 668870911, 1995792002, 425146594, 917859250, 3640535218, 2617089080},
				PC:  8661832,
				SR:  42777,
				USP: 273750,
				SSP: 16287024,
				RAM: [][2]uint32{{8661828, 74}, {8661829, 249}, {8661830, 195}, {8661831, 110}, {8661832, 202}, {8661833, 235}, {8661834, 86}, {8661835, 241}, {7260906, 46}, {7260907, 254}, {8661836, 40}, {8661837, 39}},
			},
			want: cpuState{
				D:   [8]uint32{4126556488, 2144218795, 2377097410, 3794780528, 3718904629, 1886831092, 2063303128, 2152114569},
				A:   [7]uint32{876504997, 668870911, 1995792002, 425146594, 917859250, 3640535218, 2617089080},
				PC:  8661838,
				SR:  42776,
				USP: 273750,
				SSP: 16287024,
				RAM: [][2]uint32{{8661828, 74}, {8661829, 249}, {8661830, 195}, {8661831, 110}, {8661832, 202}, {8661833, 235}, {8661834, 86}, {8661835, 241}, {7260906, 46}, {7260907, 254}, {8661836, 40}, {8661837, 39}},
			},
		},
		{
			name: "2000 TAS -(A3) 4ae3",
			init: cpuState{
				D:   [8]uint32{4210547180, 2720205237, 3874562504, 1275066947, 2988877637, 426192815, 2382565168, 113434844},
				A:   [7]uint32{939167760, 3973310128, 3070898759, 990343217, 3083450047, 2502331836, 900985158},
				PC:  1438300,
				SR:  42260,
				USP: 2710416,
				SSP: 15232256,
				RAM: [][2]uint32{{1438296, 74}, {1438297, 227}, {1438298, 196}, {1438299, 160}, {487472, 60}, {487473, 196}, {1438300, 12}, {1438301, 172}},
			},
			want: cpuState{
				D:   [8]uint32{4210547180, 2720205237, 3874562504, 1275066947, 2988877637, 426192815, 2382565168, 113434844},
				A:   [7]uint32{939167760, 3973310128, 3070898759, 990343216, 3083450047, 2502331836, 900985158},
				PC:  1438302,
				SR:  42256,
				USP: 2710416,
				SSP: 15232256,
				RAM: [][2]uint32{{1438296, 74}, {1438297, 227}, {1438298, 196}, {1438299, 160}, {487472, 188}, {487473, 196}, {1438300, 12}, {1438301, 172}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASL_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASL.b 1, D2 e302",
			init: cpuState{
				D:   [8]uint32{875122622, 4111649065, 1754384516, 392181203, 3680896859, 2161660848, 3697039902, 3045704204},
				A:   [7]uint32{445143942, 1442374805, 1099806095, 1182746079, 2955049898, 1151481773, 3019223192},
				PC:  16273272,
				SR:  1792,
				USP: 11073950,
				SSP: 16297356,
				RAM: [][2]uint32{{16273268, 227}, {16273269, 2}, {16273270, 126}, {16273271, 173}, {16273272, 255}, {16273273, 135}},
			},
			want: cpuState{
				D:   [8]uint32{875122622, 4111649065, 1754384392, 392181203, 3680896859, 2161660848, 3697039902, 3045704204},
				A:   [7]uint32{445143942, 1442374805, 1099806095, 1182746079, 2955049898, 1151481773, 3019223192},
				PC:  16273274,
				SR:  1811,
				USP: 11073950,
				SSP: 16297356,
				RAM: [][2]uint32{{16273268, 227}, {16273269, 2}, {16273270, 126}, {16273271, 173}, {16273272, 255}, {16273273, 135}},
			},
		},
		{
			name: "500 ASL.b 8, D0 e100",
			init: cpuState{
				D:   [8]uint32{673363832, 1993553946, 1472174388, 472367546, 95326562, 2137670768, 2573278204, 2334569608},
				A:   [7]uint32{1976378004, 1577976583, 81391573, 3037850526, 2307021931, 3082485992, 2318219166},
				PC:  12821334,
				SR:  9495,
				USP: 13854126,
				SSP: 4728506,
				RAM: [][2]uint32{{12821330, 225}, {12821331, 0}, {12821332, 111}, {12821333, 31}, {12821334, 158}, {12821335, 165}},
			},
			want: cpuState{
				D:   [8]uint32{673363712, 1993553946, 1472174388, 472367546, 95326562, 2137670768, 2573278204, 2334569608},
				A:   [7]uint32{1976378004, 1577976583, 81391573, 3037850526, 2307021931, 3082485992, 2318219166},
				PC:  12821336,
				SR:  9478,
				USP: 13854126,
				SSP: 4728506,
				RAM: [][2]uint32{{12821330, 225}, {12821331, 0}, {12821332, 111}, {12821333, 31}, {12821334, 158}, {12821335, 165}},
			},
		},
		{
			name: "1000 ASL.b 4, D7 e907",
			init: cpuState{
				D:   [8]uint32{3150777779, 1735826715, 1532529704, 1810020561, 2118263218, 1021692324, 2005573281, 1030099778},
				A:   [7]uint32{2456376930, 70475776, 2612981882, 644034903, 1881967461, 2591800828, 2537137491},
				PC:  7070286,
				SR:  9237,
				USP: 16745226,
				SSP: 7120282,
				RAM: [][2]uint32{{7070282, 233}, {7070283, 7}, {7070284, 74}, {7070285, 171}, {7070286, 11}, {7070287, 88}},
			},
			want: cpuState{
				D:   [8]uint32{3150777779, 1735826715, 1532529704, 1810020561, 2118263218, 1021692324, 2005573281, 1030099744},
				A:   [7]uint32{2456376930, 70475776, 2612981882, 644034903, 1881967461, 2591800828, 2537137491},
				PC:  7070288,
				SR:  9218,
				USP: 16745226,
				SSP: 7120282,
				RAM: [][2]uint32{{7070282, 233}, {7070283, 7}, {7070284, 74}, {7070285, 171}, {7070286, 11}, {7070287, 88}},
			},
		},
		{
			name: "1500 ASL.b D0, D4 e124",
			init: cpuState{
				D:   [8]uint32{3038561655, 2698003617, 3922631168, 1869561148, 1939375905, 3245064430, 3189622093, 1316050872},
				A:   [7]uint32{195230606, 829271525, 1272691395, 1146993499, 2684657812, 1642100042, 3751314201},
				PC:  7153904,
				SR:  42520,
				USP: 855908,
				SSP: 4145578,
				RAM: [][2]uint32{{7153900, 225}, {7153901, 36}, {7153902, 253}, {7153903, 181}, {7153904, 35}, {7153905, 235}},
			},
			want: cpuState{
				D:   [8]uint32{3038561655, 2698003617, 3922631168, 1869561148, 1939375872, 3245064430, 3189622093, 1316050872},
				A:   [7]uint32{195230606, 829271525, 1272691395, 1146993499, 2684657812, 1642100042, 3751314201},
				PC:  7153906,
				SR:  42502,
				USP: 855908,
				SSP: 4145578,
				RAM: [][2]uint32{{7153900, 225}, {7153901, 36}, {7153902, 253}, {7153903, 181}, {7153904, 35}, {7153905, 235}},
			},
		},
		{
			name: "2000 ASL.b 4, D5 e905",
			init: cpuState{
				D:   [8]uint32{673261894, 2484618920, 754659243, 2875158429, 148509987, 554133818, 4229442805, 3057099833},
				A:   [7]uint32{3437205811, 3726691622, 2964354284, 3167931945, 3739329545, 379718803, 1068304398},
				PC:  9855416,
				SR:  8967,
				USP: 16090328,
				SSP: 12062992,
				RAM: [][2]uint32{{9855412, 233}, {9855413, 5}, {9855414, 231}, {9855415, 14}, {9855416, 149}, {9855417, 210}},
			},
			want: cpuState{
				D:   [8]uint32{673261894, 2484618920, 754659243, 2875158429, 148509987, 554133920, 4229442805, 3057099833},
				A:   [7]uint32{3437205811, 3726691622, 2964354284, 3167931945, 3739329545, 379718803, 1068304398},
				PC:  9855418,
				SR:  8987,
				USP: 16090328,
				SSP: 12062992,
				RAM: [][2]uint32{{9855412, 233}, {9855413, 5}, {9855414, 231}, {9855415, 14}, {9855416, 149}, {9855417, 210}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASL_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASL.w D5, D0 eb60",
			init: cpuState{
				D:   [8]uint32{539159205, 1202972415, 1760886831, 2020840429, 745339187, 2945258589, 3163311252, 1696235226},
				A:   [7]uint32{2902778343, 432696657, 4208285870, 3029119350, 803463438, 2960705152, 4130681196},
				PC:  5324164,
				SR:  8195,
				USP: 12337110,
				SSP: 8421566,
				RAM: [][2]uint32{{5324160, 235}, {5324161, 96}, {5324162, 134}, {5324163, 254}, {5324164, 153}, {5324165, 31}},
			},
			want: cpuState{
				D:   [8]uint32{539099136, 1202972415, 1760886831, 2020840429, 745339187, 2945258589, 3163311252, 1696235226},
				A:   [7]uint32{2902778343, 432696657, 4208285870, 3029119350, 803463438, 2960705152, 4130681196},
				PC:  5324166,
				SR:  8198,
				USP: 12337110,
				SSP: 8421566,
				RAM: [][2]uint32{{5324160, 235}, {5324161, 96}, {5324162, 134}, {5324163, 254}, {5324164, 153}, {5324165, 31}},
			},
		},
		{
			name: "500 ASL.w D2, D5 e565",
			init: cpuState{
				D:   [8]uint32{2443348151, 239698236, 2472801233, 3290802018, 1505723894, 3566917740, 3404557678, 1462880053},
				A:   [7]uint32{91578042, 3445264485, 1417601859, 2017286878, 4203496097, 3499681620, 745472717},
				PC:  7657320,
				SR:  34330,
				USP: 8456762,
				SSP: 5580446,
				RAM: [][2]uint32{{7657316, 229}, {7657317, 101}, {7657318, 144}, {7657319, 140}, {7657320, 117}, {7657321, 79}},
			},
			want: cpuState{
				D:   [8]uint32{2443348151, 239698236, 2472801233, 3290802018, 1505723894, 3566862336, 3404557678, 1462880053},
				A:   [7]uint32{91578042, 3445264485, 1417601859, 2017286878, 4203496097, 3499681620, 745472717},
				PC:  7657322,
				SR:  34310,
				USP: 8456762,
				SSP: 5580446,
				RAM: [][2]uint32{{7657316, 229}, {7657317, 101}, {7657318, 144}, {7657319, 140}, {7657320, 117}, {7657321, 79}},
			},
		},
		{
			name: "1000 ASL.w D4, D2 e962",
			init: cpuState{
				D:   [8]uint32{1400751805, 594940556, 660139233, 2688838918, 4253667950, 2729790547, 2824616381, 1101188300},
				A:   [7]uint32{1459531919, 83035182, 3936258490, 3395440469, 1475188992, 1573944542, 3976942288},
				PC:  10813322,
				SR:  42770,
				USP: 16244440,
				SSP: 4729766,
				RAM: [][2]uint32{{10813318, 233}, {10813319, 98}, {10813320, 44}, {10813321, 126}, {10813322, 113}, {10813323, 130}},
			},
			want: cpuState{
				D:   [8]uint32{1400751805, 594940556, 660078592, 2688838918, 4253667950, 2729790547, 2824616381, 1101188300},
				A:   [7]uint32{1459531919, 83035182, 3936258490, 3395440469, 1475188992, 1573944542, 3976942288},
				PC:  10813324,
				SR:  42758,
				USP: 16244440,
				SSP: 4729766,
				RAM: [][2]uint32{{10813318, 233}, {10813319, 98}, {10813320, 44}, {10813321, 126}, {10813322, 113}, {10813323, 130}},
			},
		},
		{
			name: "1500 ASL.w D1, D1 e361",
			init: cpuState{
				D:   [8]uint32{3666789643, 1226891360, 2066906508, 2430558429, 3784255303, 2960781086, 587753782, 3215490847},
				A:   [7]uint32{2420226123, 495740418, 356355805, 1799993087, 792674289, 1369516552, 3236422977},
				PC:  10609462,
				SR:  8459,
				USP: 16666626,
				SSP: 11326658,
				RAM: [][2]uint32{{10609458, 227}, {10609459, 97}, {10609460, 209}, {10609461, 24}, {10609462, 163}, {10609463, 8}},
			},
			want: cpuState{
				D:   [8]uint32{3666789643, 1226833920, 2066906508, 2430558429, 3784255303, 2960781086, 587753782, 3215490847},
				A:   [7]uint32{2420226123, 495740418, 356355805, 1799993087, 792674289, 1369516552, 3236422977},
				PC:  10609464,
				SR:  8454,
				USP: 16666626,
				SSP: 11326658,
				RAM: [][2]uint32{{10609458, 227}, {10609459, 97}, {10609460, 209}, {10609461, 24}, {10609462, 163}, {10609463, 8}},
			},
		},
		{
			name: "2000 ASL.w D3, D3 e763",
			init: cpuState{
				D:   [8]uint32{328502899, 3910851602, 568107334, 1847075312, 1497163261, 3799814321, 3040708348, 2964973670},
				A:   [7]uint32{1527148525, 1132465856, 619813685, 4144486560, 603163528, 1486687062, 2607866933},
				PC:  6044604,
				SR:  33793,
				USP: 16132034,
				SSP: 1238522,
				RAM: [][2]uint32{{6044600, 231}, {6044601, 99}, {6044602, 165}, {6044603, 203}, {6044604, 25}, {6044605, 79}},
			},
			want: cpuState{
				D:   [8]uint32{328502899, 3910851602, 568107334, 1847066624, 1497163261, 3799814321, 3040708348, 2964973670},
				A:   [7]uint32{1527148525, 1132465856, 619813685, 4144486560, 603163528, 1486687062, 2607866933},
				PC:  6044606,
				SR:  33798,
				USP: 16132034,
				SSP: 1238522,
				RAM: [][2]uint32{{6044600, 231}, {6044601, 99}, {6044602, 165}, {6044603, 203}, {6044604, 25}, {6044605, 79}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASL_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASL.l D0, D2 e1a2",
			init: cpuState{
				D:   [8]uint32{1665132295, 1860274445, 3303770356, 4143754377, 454961395, 458750985, 2367911195, 3867835807},
				A:   [7]uint32{1144095669, 1041785141, 2806714504, 3148796705, 2516974797, 2240758846, 2352976153},
				PC:  13618272,
				SR:  32771,
				USP: 6826106,
				SSP: 10380388,
				RAM: [][2]uint32{{13618268, 225}, {13618269, 162}, {13618270, 80}, {13618271, 17}, {13618272, 204}, {13618273, 14}},
			},
			want: cpuState{
				D:   [8]uint32{1665132295, 1860274445, 1975810560, 4143754377, 454961395, 458750985, 2367911195, 3867835807},
				A:   [7]uint32{1144095669, 1041785141, 2806714504, 3148796705, 2516974797, 2240758846, 2352976153},
				PC:  13618274,
				SR:  32770,
				USP: 6826106,
				SSP: 10380388,
				RAM: [][2]uint32{{13618268, 225}, {13618269, 162}, {13618270, 80}, {13618271, 17}, {13618272, 204}, {13618273, 14}},
			},
		},
		{
			name: "500 ASL.l 7, D7 ef87",
			init: cpuState{
				D:   [8]uint32{404779666, 296217818, 2704717968, 1260287972, 3176918976, 748041646, 1187834193, 2067544173},
				A:   [7]uint32{2177251666, 3727557955, 2307637815, 541344241, 1234253005, 987412938, 2856530764},
				PC:  8143236,
				SR:  42516,
				USP: 837632,
				SSP: 6186906,
				RAM: [][2]uint32{{8143232, 239}, {8143233, 135}, {8143234, 141}, {8143235, 116}, {8143236, 244}, {8143237, 229}},
			},
			want: cpuState{
				D:   [8]uint32{404779666, 296217818, 2704717968, 1260287972, 3176918976, 748041646, 1187834193, 2652649088},
				A:   [7]uint32{2177251666, 3727557955, 2307637815, 541344241, 1234253005, 987412938, 2856530764},
				PC:  8143238,
				SR:  42523,
				USP: 837632,
				SSP: 6186906,
				RAM: [][2]uint32{{8143232, 239}, {8143233, 135}, {8143234, 141}, {8143235, 116}, {8143236, 244}, {8143237, 229}},
			},
		},
		{
			name: "1000 ASL.l 7, D2 ef82",
			init: cpuState{
				D:   [8]uint32{739164447, 2686864923, 2136906476, 2522239544, 1060082978, 3486907074, 821434634, 431893418},
				A:   [7]uint32{3203843411, 1737874464, 991317726, 1054015091, 2936015421, 2553313349, 3300406635},
				PC:  147148,
				SR:  778,
				USP: 9744184,
				SSP: 211366,
				RAM: [][2]uint32{{147144, 239}, {147145, 130}, {147146, 11}, {147147, 5}, {147148, 206}, {147149, 132}},
			},
			want: cpuState{
				D:   [8]uint32{739164447, 2686864923, 2941089280, 2522239544, 1060082978, 3486907074, 821434634, 431893418},
				A:   [7]uint32{3203843411, 1737874464, 991317726, 1054015091, 2936015421, 2553313349, 3300406635},
				PC:  147150,
				SR:  795,
				USP: 9744184,
				SSP: 211366,
				RAM: [][2]uint32{{147144, 239}, {147145, 130}, {147146, 11}, {147147, 5}, {147148, 206}, {147149, 132}},
			},
		},
		{
			name: "1500 ASL.l D6, D7 eda7",
			init: cpuState{
				D:   [8]uint32{2427529023, 232044591, 3867538374, 424555813, 2200596835, 1350761448, 3669412470, 546531122},
				A:   [7]uint32{3916547678, 260721217, 2343570511, 1119419926, 1857698416, 32918402, 3068661539},
				PC:  10768186,
				SR:  271,
				USP: 11761830,
				SSP: 10642526,
				RAM: [][2]uint32{{10768182, 237}, {10768183, 167}, {10768184, 105}, {10768185, 209}, {10768186, 240}, {10768187, 243}},
			},
			want: cpuState{
				D:   [8]uint32{2427529023, 232044591, 3867538374, 424555813, 2200596835, 1350761448, 3669412470, 0},
				A:   [7]uint32{3916547678, 260721217, 2343570511, 1119419926, 1857698416, 32918402, 3068661539},
				PC:  10768188,
				SR:  262,
				USP: 11761830,
				SSP: 10642526,
				RAM: [][2]uint32{{10768182, 237}, {10768183, 167}, {10768184, 105}, {10768185, 209}, {10768186, 240}, {10768187, 243}},
			},
		},
		{
			name: "2000 ASL.l 1, D0 e380",
			init: cpuState{
				D:   [8]uint32{3597923443, 469392294, 4265791421, 208005571, 2135026273, 2680589637, 92959639, 2590558638},
				A:   [7]uint32{1870343538, 2677459105, 431819122, 2553928912, 354969791, 5499345, 1826672023},
				PC:  15432490,
				SR:  41992,
				USP: 3043598,
				SSP: 11207334,
				RAM: [][2]uint32{{15432486, 227}, {15432487, 128}, {15432488, 29}, {15432489, 62}, {15432490, 250}, {15432491, 151}},
			},
			want: cpuState{
				D:   [8]uint32{2900879590, 469392294, 4265791421, 208005571, 2135026273, 2680589637, 92959639, 2590558638},
				A:   [7]uint32{1870343538, 2677459105, 431819122, 2553928912, 354969791, 5499345, 1826672023},
				PC:  15432492,
				SR:  42009,
				USP: 3043598,
				SSP: 11207334,
				RAM: [][2]uint32{{15432486, 227}, {15432487, 128}, {15432488, 29}, {15432489, 62}, {15432490, 250}, {15432491, 151}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASR.b 6, D7 ec07",
			init: cpuState{
				D:   [8]uint32{3230747358, 2027848517, 4233688550, 3253514341, 3686450787, 1571467791, 612264886, 1909330689},
				A:   [7]uint32{49415762, 90675800, 617236057, 330260100, 4032526352, 1920135402, 3948925200},
				PC:  16129048,
				SR:  41749,
				USP: 7408808,
				SSP: 9172340,
				RAM: [][2]uint32{{16129044, 236}, {16129045, 7}, {16129046, 169}, {16129047, 8}, {16129048, 58}, {16129049, 44}},
			},
			want: cpuState{
				D:   [8]uint32{3230747358, 2027848517, 4233688550, 3253514341, 3686450787, 1571467791, 612264886, 1909330688},
				A:   [7]uint32{49415762, 90675800, 617236057, 330260100, 4032526352, 1920135402, 3948925200},
				PC:  16129050,
				SR:  41732,
				USP: 7408808,
				SSP: 9172340,
				RAM: [][2]uint32{{16129044, 236}, {16129045, 7}, {16129046, 169}, {16129047, 8}, {16129048, 58}, {16129049, 44}},
			},
		},
		{
			name: "500 ASR.b 4, D4 e804",
			init: cpuState{
				D:   [8]uint32{1739394794, 2845298601, 85805233, 1918442744, 2377569476, 4049368412, 485655956, 247881715},
				A:   [7]uint32{3890685522, 3845805654, 1727618085, 3254819017, 4148826429, 1264370799, 61654133},
				PC:  88944,
				SR:  41484,
				USP: 16235120,
				SSP: 13949624,
				RAM: [][2]uint32{{88940, 232}, {88941, 4}, {88942, 158}, {88943, 4}, {88944, 70}, {88945, 234}},
			},
			want: cpuState{
				D:   [8]uint32{1739394794, 2845298601, 85805233, 1918442744, 2377569532, 4049368412, 485655956, 247881715},
				A:   [7]uint32{3890685522, 3845805654, 1727618085, 3254819017, 4148826429, 1264370799, 61654133},
				PC:  88946,
				SR:  41480,
				USP: 16235120,
				SSP: 13949624,
				RAM: [][2]uint32{{88940, 232}, {88941, 4}, {88942, 158}, {88943, 4}, {88944, 70}, {88945, 234}},
			},
		},
		{
			name: "1000 ASR.b 8, D0 e000",
			init: cpuState{
				D:   [8]uint32{3456319252, 76271016, 3525261165, 102314857, 23377941, 3530452043, 3608600125, 767336213},
				A:   [7]uint32{2878447403, 3782187020, 3960700332, 2636577976, 1063448868, 909710570, 1956569659},
				PC:  4420898,
				SR:  9735,
				USP: 16483566,
				SSP: 6507088,
				RAM: [][2]uint32{{4420894, 224}, {4420895, 0}, {4420896, 121}, {4420897, 43}, {4420898, 61}, {4420899, 21}},
			},
			want: cpuState{
				D:   [8]uint32{3456319232, 76271016, 3525261165, 102314857, 23377941, 3530452043, 3608600125, 767336213},
				A:   [7]uint32{2878447403, 3782187020, 3960700332, 2636577976, 1063448868, 909710570, 1956569659},
				PC:  4420900,
				SR:  9732,
				USP: 16483566,
				SSP: 6507088,
				RAM: [][2]uint32{{4420894, 224}, {4420895, 0}, {4420896, 121}, {4420897, 43}, {4420898, 61}, {4420899, 21}},
			},
		},
		{
			name: "1500 ASR.b 4, D6 e806",
			init: cpuState{
				D:   [8]uint32{1871070317, 2789910106, 194646039, 4267900130, 418463314, 2013088078, 608295103, 144280806},
				A:   [7]uint32{2573704883, 2600361087, 196918259, 3700371095, 4175445721, 569156096, 2256702004},
				PC:  1441264,
				SR:  10013,
				USP: 1284738,
				SSP: 1870792,
				RAM: [][2]uint32{{1441260, 232}, {1441261, 6}, {1441262, 215}, {1441263, 17}, {1441264, 239}, {1441265, 170}},
			},
			want: cpuState{
				D:   [8]uint32{1871070317, 2789910106, 194646039, 4267900130, 418463314, 2013088078, 608295163, 144280806},
				A:   [7]uint32{2573704883, 2600361087, 196918259, 3700371095, 4175445721, 569156096, 2256702004},
				PC:  1441266,
				SR:  10009,
				USP: 1284738,
				SSP: 1870792,
				RAM: [][2]uint32{{1441260, 232}, {1441261, 6}, {1441262, 215}, {1441263, 17}, {1441264, 239}, {1441265, 170}},
			},
		},
		{
			name: "2000 ASR.b 1, D0 e200",
			init: cpuState{
				D:   [8]uint32{3589350621, 4017855110, 1006782619, 3183118594, 3848062786, 1292701905, 155709841, 1429402257},
				A:   [7]uint32{24871113, 257148562, 4164476198, 2973080348, 646841500, 2294361280, 2735332233},
				PC:  6576288,
				SR:  10001,
				USP: 4414182,
				SSP: 7004338,
				RAM: [][2]uint32{{6576284, 226}, {6576285, 0}, {6576286, 176}, {6576287, 206}, {6576288, 202}, {6576289, 87}},
			},
			want: cpuState{
				D:   [8]uint32{3589350638, 4017855110, 1006782619, 3183118594, 3848062786, 1292701905, 155709841, 1429402257},
				A:   [7]uint32{24871113, 257148562, 4164476198, 2973080348, 646841500, 2294361280, 2735332233},
				PC:  6576290,
				SR:  10009,
				USP: 4414182,
				SSP: 7004338,
				RAM: [][2]uint32{{6576284, 226}, {6576285, 0}, {6576286, 176}, {6576287, 206}, {6576288, 202}, {6576289, 87}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASR.w D7, D7 ee67",
			init: cpuState{
				D:   [8]uint32{2140892700, 2465781122, 3992243120, 1827657398, 2728141166, 384994615, 1441370795, 3538539163},
				A:   [7]uint32{3279986970, 1101559859, 845518070, 1390080585, 1491296396, 2114812570, 2889532608},
				PC:  7131636,
				SR:  42002,
				USP: 1434316,
				SSP: 14536022,
				RAM: [][2]uint32{{7131632, 238}, {7131633, 103}, {7131634, 31}, {7131635, 181}, {7131636, 38}, {7131637, 208}},
			},
			want: cpuState{
				D:   [8]uint32{2140892700, 2465781122, 3992243120, 1827657398, 2728141166, 384994615, 1441370795, 3538550783},
				A:   [7]uint32{3279986970, 1101559859, 845518070, 1390080585, 1491296396, 2114812570, 2889532608},
				PC:  7131638,
				SR:  42009,
				USP: 1434316,
				SSP: 14536022,
				RAM: [][2]uint32{{7131632, 238}, {7131633, 103}, {7131634, 31}, {7131635, 181}, {7131636, 38}, {7131637, 208}},
			},
		},
		{
			name: "500 ASR.w D1, D5 e265",
			init: cpuState{
				D:   [8]uint32{3628040184, 478971299, 891365418, 4137746025, 1778465532, 1275930550, 546062528, 3860638617},
				A:   [7]uint32{4265557415, 3389053222, 2933897914, 586041371, 723338513, 3449980425, 4176922254},
				PC:  10360414,
				SR:  34331,
				USP: 366060,
				SSP: 8402216,
				RAM: [][2]uint32{{10360410, 226}, {10360411, 101}, {10360412, 248}, {10360413, 178}, {10360414, 34}, {10360415, 35}},
			},
			want: cpuState{
				D:   [8]uint32{3628040184, 478971299, 891365418, 4137746025, 1778465532, 1275920384, 546062528, 3860638617},
				A:   [7]uint32{4265557415, 3389053222, 2933897914, 586041371, 723338513, 3449980425, 4176922254},
				PC:  10360416,
				SR:  34308,
				USP: 366060,
				SSP: 8402216,
				RAM: [][2]uint32{{10360410, 226}, {10360411, 101}, {10360412, 248}, {10360413, 178}, {10360414, 34}, {10360415, 35}},
			},
		},
		{
			name: "1000 ASR.w D7, D3 ee63",
			init: cpuState{
				D:   [8]uint32{1841096544, 3934899226, 2909584113, 38225111, 4080219181, 543749075, 2874427749, 811232789},
				A:   [7]uint32{3290079922, 392342413, 3753083047, 1488256708, 2598391886, 3851039468, 54362338},
				PC:  6174722,
				SR:  33284,
				USP: 6306686,
				SSP: 4655622,
				RAM: [][2]uint32{{6174718, 238}, {6174719, 99}, {6174720, 71}, {6174721, 116}, {6174722, 119}, {6174723, 216}},
			},
			want: cpuState{
				D:   [8]uint32{1841096544, 3934899226, 2909584113, 38207488, 4080219181, 543749075, 2874427749, 811232789},
				A:   [7]uint32{3290079922, 392342413, 3753083047, 1488256708, 2598391886, 3851039468, 54362338},
				PC:  6174724,
				SR:  33284,
				USP: 6306686,
				SSP: 4655622,
				RAM: [][2]uint32{{6174718, 238}, {6174719, 99}, {6174720, 71}, {6174721, 116}, {6174722, 119}, {6174723, 216}},
			},
		},
		{
			name: "1500 ASR.w (d8, A4, Xn) e0f4",
			init: cpuState{
				D:   [8]uint32{4193058800, 4125521749, 1893473976, 3453498458, 4210194436, 2947372099, 2907672120, 2344792134},
				A:   [7]uint32{898654184, 1515254897, 202682949, 2931605055, 3561736284, 2701201033, 1076138602},
				PC:  7837402,
				SR:  33036,
				USP: 6773530,
				SSP: 14041444,
				RAM: [][2]uint32{{7837398, 224}, {7837399, 244}, {7837400, 111}, {7837401, 182}, {7837402, 83}, {7837403, 232}, {10180170, 14}, {10180171, 250}, {7837404, 192}, {7837405, 188}},
			},
			want: cpuState{
				D:   [8]uint32{4193058800, 4125521749, 1893473976, 3453498458, 4210194436, 2947372099, 2907672120, 2344792134},
				A:   [7]uint32{898654184, 1515254897, 202682949, 2931605055, 3561736284, 2701201033, 1076138602},
				PC:  7837406,
				SR:  33024,
				USP: 6773530,
				SSP: 14041444,
				RAM: [][2]uint32{{7837398, 224}, {7837399, 244}, {7837400, 111}, {7837401, 182}, {7837402, 83}, {7837403, 232}, {10180170, 7}, {10180171, 125}, {7837404, 192}, {7837405, 188}},
			},
		},
		{
			name: "2000 ASR.w D7, D3 ee63",
			init: cpuState{
				D:   [8]uint32{1247444347, 4122154250, 3705892827, 2050874130, 1106930726, 449426586, 3191285014, 126269127},
				A:   [7]uint32{3154958178, 1564375313, 2770667061, 3900620568, 3078532999, 1782183082, 4143717858},
				PC:  56558,
				SR:  41989,
				USP: 4120630,
				SSP: 9868632,
				RAM: [][2]uint32{{56554, 238}, {56555, 99}, {56556, 55}, {56557, 193}, {56558, 14}, {56559, 144}},
			},
			want: cpuState{
				D:   [8]uint32{1247444347, 4122154250, 3705892827, 2050883510, 1106930726, 449426586, 3191285014, 126269127},
				A:   [7]uint32{3154958178, 1564375313, 2770667061, 3900620568, 3078532999, 1782183082, 4143717858},
				PC:  56560,
				SR:  41992,
				USP: 4120630,
				SSP: 9868632,
				RAM: [][2]uint32{{56554, 238}, {56555, 99}, {56556, 55}, {56557, 193}, {56558, 14}, {56559, 144}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestASR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ASR.l 1, D7 e287",
			init: cpuState{
				D:   [8]uint32{4219025827, 2540318018, 4022561933, 3988407213, 4254647945, 926753132, 1434393014, 1687202767},
				A:   [7]uint32{1049309671, 2556119619, 2951051429, 3965440634, 1865347610, 3978938027, 3432232794},
				PC:  13433298,
				SR:  33550,
				USP: 5800670,
				SSP: 10802408,
				RAM: [][2]uint32{{13433294, 226}, {13433295, 135}, {13433296, 166}, {13433297, 106}, {13433298, 141}, {13433299, 59}},
			},
			want: cpuState{
				D:   [8]uint32{4219025827, 2540318018, 4022561933, 3988407213, 4254647945, 926753132, 1434393014, 843601383},
				A:   [7]uint32{1049309671, 2556119619, 2951051429, 3965440634, 1865347610, 3978938027, 3432232794},
				PC:  13433300,
				SR:  33553,
				USP: 5800670,
				SSP: 10802408,
				RAM: [][2]uint32{{13433294, 226}, {13433295, 135}, {13433296, 166}, {13433297, 106}, {13433298, 141}, {13433299, 59}},
			},
		},
		{
			name: "500 ASR.l D0, D0 e0a0",
			init: cpuState{
				D:   [8]uint32{1778769090, 3534880010, 1620392390, 3604988374, 2575560087, 3320743651, 308633308, 1254936416},
				A:   [7]uint32{3250098204, 1587147263, 829478014, 4117733772, 126380457, 3355574569, 1784695266},
				PC:  429448,
				SR:  33281,
				USP: 3423848,
				SSP: 16050820,
				RAM: [][2]uint32{{429444, 224}, {429445, 160}, {429446, 7}, {429447, 62}, {429448, 191}, {429449, 19}},
			},
			want: cpuState{
				D:   [8]uint32{444692272, 3534880010, 1620392390, 3604988374, 2575560087, 3320743651, 308633308, 1254936416},
				A:   [7]uint32{3250098204, 1587147263, 829478014, 4117733772, 126380457, 3355574569, 1784695266},
				PC:  429450,
				SR:  33297,
				USP: 3423848,
				SSP: 16050820,
				RAM: [][2]uint32{{429444, 224}, {429445, 160}, {429446, 7}, {429447, 62}, {429448, 191}, {429449, 19}},
			},
		},
		{
			name: "1000 ASR.l D7, D7 eea7",
			init: cpuState{
				D:   [8]uint32{3819587193, 2527156390, 126344482, 3618775720, 4133270541, 2057959974, 536006216, 2923497632},
				A:   [7]uint32{643677357, 1198308408, 1636403373, 3888624782, 628188416, 2416306181, 1444390977},
				PC:  5668024,
				SR:  8961,
				USP: 1855492,
				SSP: 14944066,
				RAM: [][2]uint32{{5668020, 238}, {5668021, 167}, {5668022, 120}, {5668023, 113}, {5668024, 168}, {5668025, 59}},
			},
			want: cpuState{
				D:   [8]uint32{3819587193, 2527156390, 126344482, 3618775720, 4133270541, 2057959974, 536006216, 4294967295},
				A:   [7]uint32{643677357, 1198308408, 1636403373, 3888624782, 628188416, 2416306181, 1444390977},
				PC:  5668026,
				SR:  8985,
				USP: 1855492,
				SSP: 14944066,
				RAM: [][2]uint32{{5668020, 238}, {5668021, 167}, {5668022, 120}, {5668023, 113}, {5668024, 168}, {5668025, 59}},
			},
		},
		{
			name: "1500 ASR.l D4, D1 e8a1",
			init: cpuState{
				D:   [8]uint32{2590285325, 793582723, 3504250770, 715032601, 1584468866, 1495159, 3264501513, 3143898527},
				A:   [7]uint32{1254671539, 217048534, 764397649, 2684049050, 1109284797, 3084424878, 2202998543},
				PC:  14228066,
				SR:  41484,
				USP: 14125804,
				SSP: 11593104,
				RAM: [][2]uint32{{14228062, 232}, {14228063, 161}, {14228064, 39}, {14228065, 15}, {14228066, 228}, {14228067, 51}},
			},
			want: cpuState{
				D:   [8]uint32{2590285325, 198395680, 3504250770, 715032601, 1584468866, 1495159, 3264501513, 3143898527},
				A:   [7]uint32{1254671539, 217048534, 764397649, 2684049050, 1109284797, 3084424878, 2202998543},
				PC:  14228068,
				SR:  41489,
				USP: 14125804,
				SSP: 11593104,
				RAM: [][2]uint32{{14228062, 232}, {14228063, 161}, {14228064, 39}, {14228065, 15}, {14228066, 228}, {14228067, 51}},
			},
		},
		{
			name: "2000 ASR.l 1, D6 e286",
			init: cpuState{
				D:   [8]uint32{2909956154, 1663350213, 2459965802, 2701756675, 3785329050, 2806861648, 3229233484, 850238063},
				A:   [7]uint32{4130615276, 1538582943, 4172299191, 3139128350, 2274623705, 577855242, 3555670148},
				PC:  3558514,
				SR:  10015,
				USP: 2259380,
				SSP: 4693302,
				RAM: [][2]uint32{{3558510, 226}, {3558511, 134}, {3558512, 87}, {3558513, 196}, {3558514, 96}, {3558515, 158}},
			},
			want: cpuState{
				D:   [8]uint32{2909956154, 1663350213, 2459965802, 2701756675, 3785329050, 2806861648, 3762100390, 850238063},
				A:   [7]uint32{4130615276, 1538582943, 4172299191, 3139128350, 2274623705, 577855242, 3555670148},
				PC:  3558516,
				SR:  9992,
				USP: 2259380,
				SSP: 4693302,
				RAM: [][2]uint32{{3558510, 226}, {3558511, 134}, {3558512, 87}, {3558513, 196}, {3558514, 96}, {3558515, 158}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSL_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSL.b 6, D0 ed08",
			init: cpuState{
				D:   [8]uint32{1992387442, 3472012941, 1621034574, 3444782784, 2285654641, 2767730766, 2674935476, 2414716882},
				A:   [7]uint32{1627331514, 3980198845, 3865730721, 756098789, 297213050, 329114438, 726582774},
				PC:  1122976,
				SR:  1027,
				USP: 1189786,
				SSP: 10571966,
				RAM: [][2]uint32{{1122972, 237}, {1122973, 8}, {1122974, 21}, {1122975, 154}, {1122976, 216}, {1122977, 31}},
			},
			want: cpuState{
				D:   [8]uint32{1992387456, 3472012941, 1621034574, 3444782784, 2285654641, 2767730766, 2674935476, 2414716882},
				A:   [7]uint32{1627331514, 3980198845, 3865730721, 756098789, 297213050, 329114438, 726582774},
				PC:  1122978,
				SR:  1032,
				USP: 1189786,
				SSP: 10571966,
				RAM: [][2]uint32{{1122972, 237}, {1122973, 8}, {1122974, 21}, {1122975, 154}, {1122976, 216}, {1122977, 31}},
			},
		},
		{
			name: "500 LSL.b D6, D4 ed2c",
			init: cpuState{
				D:   [8]uint32{1599171048, 2196521805, 3054125788, 3758524881, 2235607162, 228397225, 4004784534, 687957965},
				A:   [7]uint32{1392555770, 1380745058, 4163631302, 1144419425, 3268922448, 1877058319, 1113098029},
				PC:  10731740,
				SR:  33307,
				USP: 10436290,
				SSP: 9942458,
				RAM: [][2]uint32{{10731736, 237}, {10731737, 44}, {10731738, 232}, {10731739, 114}, {10731740, 7}, {10731741, 67}},
			},
			want: cpuState{
				D:   [8]uint32{1599171048, 2196521805, 3054125788, 3758524881, 2235607040, 228397225, 4004784534, 687957965},
				A:   [7]uint32{1392555770, 1380745058, 4163631302, 1144419425, 3268922448, 1877058319, 1113098029},
				PC:  10731742,
				SR:  33284,
				USP: 10436290,
				SSP: 9942458,
				RAM: [][2]uint32{{10731736, 237}, {10731737, 44}, {10731738, 232}, {10731739, 114}, {10731740, 7}, {10731741, 67}},
			},
		},
		{
			name: "1000 LSL.b 6, D3 ed0b",
			init: cpuState{
				D:   [8]uint32{879765760, 2688131140, 3063880167, 830036689, 209309840, 1979162255, 3552322735, 898053399},
				A:   [7]uint32{1394647907, 3995225778, 1990124010, 340156957, 2018556962, 1486385078, 3072270179},
				PC:  16511144,
				SR:  34570,
				USP: 14260774,
				SSP: 13868890,
				RAM: [][2]uint32{{16511140, 237}, {16511141, 11}, {16511142, 145}, {16511143, 65}, {16511144, 67}, {16511145, 88}},
			},
			want: cpuState{
				D:   [8]uint32{879765760, 2688131140, 3063880167, 830036544, 209309840, 1979162255, 3552322735, 898053399},
				A:   [7]uint32{1394647907, 3995225778, 1990124010, 340156957, 2018556962, 1486385078, 3072270179},
				PC:  16511146,
				SR:  34560,
				USP: 14260774,
				SSP: 13868890,
				RAM: [][2]uint32{{16511140, 237}, {16511141, 11}, {16511142, 145}, {16511143, 65}, {16511144, 67}, {16511145, 88}},
			},
		},
		{
			name: "1500 LSL.b D3, D0 e728",
			init: cpuState{
				D:   [8]uint32{680672205, 4042291778, 2841054725, 889443563, 1094784177, 546459348, 112687106, 2056094918},
				A:   [7]uint32{1399532838, 3942083665, 1653516753, 1381150069, 2418165356, 1704000852, 3018141759},
				PC:  14065040,
				SR:  1033,
				USP: 1437722,
				SSP: 2613914,
				RAM: [][2]uint32{{14065036, 231}, {14065037, 40}, {14065038, 146}, {14065039, 131}, {14065040, 239}, {14065041, 212}},
			},
			want: cpuState{
				D:   [8]uint32{680672000, 4042291778, 2841054725, 889443563, 1094784177, 546459348, 112687106, 2056094918},
				A:   [7]uint32{1399532838, 3942083665, 1653516753, 1381150069, 2418165356, 1704000852, 3018141759},
				PC:  14065042,
				SR:  1028,
				USP: 1437722,
				SSP: 2613914,
				RAM: [][2]uint32{{14065036, 231}, {14065037, 40}, {14065038, 146}, {14065039, 131}, {14065040, 239}, {14065041, 212}},
			},
		},
		{
			name: "2000 LSL.b 4, D0 e908",
			init: cpuState{
				D:   [8]uint32{3111992211, 2077214563, 2576123109, 2778800239, 932863965, 452035650, 1544498353, 3161883402},
				A:   [7]uint32{1602118372, 4121717196, 479198742, 749224206, 435748988, 3469302170, 1393352494},
				PC:  8694298,
				SR:  32778,
				USP: 7444304,
				SSP: 11445272,
				RAM: [][2]uint32{{8694294, 233}, {8694295, 8}, {8694296, 160}, {8694297, 18}, {8694298, 202}, {8694299, 78}},
			},
			want: cpuState{
				D:   [8]uint32{3111992112, 2077214563, 2576123109, 2778800239, 932863965, 452035650, 1544498353, 3161883402},
				A:   [7]uint32{1602118372, 4121717196, 479198742, 749224206, 435748988, 3469302170, 1393352494},
				PC:  8694300,
				SR:  32785,
				USP: 7444304,
				SSP: 11445272,
				RAM: [][2]uint32{{8694294, 233}, {8694295, 8}, {8694296, 160}, {8694297, 18}, {8694298, 202}, {8694299, 78}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSL_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSL.w 1, D3 e34b",
			init: cpuState{
				D:   [8]uint32{1118836171, 693315389, 2991842178, 4270755532, 1362240818, 3948461450, 418543815, 3197610565},
				A:   [7]uint32{1549106042, 2223112240, 3227626001, 2278141428, 2054966790, 2989827775, 1172029541},
				PC:  7046594,
				SR:  8449,
				USP: 10416842,
				SSP: 5916144,
				RAM: [][2]uint32{{7046590, 227}, {7046591, 75}, {7046592, 217}, {7046593, 76}, {7046594, 30}, {7046595, 115}},
			},
			want: cpuState{
				D:   [8]uint32{1118836171, 693315389, 2991842178, 4270726552, 1362240818, 3948461450, 418543815, 3197610565},
				A:   [7]uint32{1549106042, 2223112240, 3227626001, 2278141428, 2054966790, 2989827775, 1172029541},
				PC:  7046596,
				SR:  8465,
				USP: 10416842,
				SSP: 5916144,
				RAM: [][2]uint32{{7046590, 227}, {7046591, 75}, {7046592, 217}, {7046593, 76}, {7046594, 30}, {7046595, 115}},
			},
		},
		{
			name: "500 LSL.w 7, D3 ef4b",
			init: cpuState{
				D:   [8]uint32{4081543179, 4034743290, 2155877271, 459227949, 1094259221, 2453950253, 3214268488, 3364883639},
				A:   [7]uint32{2553268285, 2158242607, 792752194, 1322511529, 3905473925, 1244120398, 923449562},
				PC:  12237288,
				SR:  42245,
				USP: 14812994,
				SSP: 15066884,
				RAM: [][2]uint32{{12237284, 239}, {12237285, 75}, {12237286, 221}, {12237287, 53}, {12237288, 231}, {12237289, 122}},
			},
			want: cpuState{
				D:   [8]uint32{4081543179, 4034743290, 2155877271, 459249280, 1094259221, 2453950253, 3214268488, 3364883639},
				A:   [7]uint32{2553268285, 2158242607, 792752194, 1322511529, 3905473925, 1244120398, 923449562},
				PC:  12237290,
				SR:  42265,
				USP: 14812994,
				SSP: 15066884,
				RAM: [][2]uint32{{12237284, 239}, {12237285, 75}, {12237286, 221}, {12237287, 53}, {12237288, 231}, {12237289, 122}},
			},
		},
		{
			name: "1000 LSL.w 5, D6 eb4e",
			init: cpuState{
				D:   [8]uint32{3643983838, 3800566182, 3259089509, 775353568, 408271118, 2895638549, 4241384661, 2154083113},
				A:   [7]uint32{3699425381, 1526504485, 3746583901, 3047950263, 3430722079, 3579605029, 3735105101},
				PC:  12183244,
				SR:  1552,
				USP: 15368304,
				SSP: 9214052,
				RAM: [][2]uint32{{12183240, 235}, {12183241, 78}, {12183242, 162}, {12183243, 119}, {12183244, 251}, {12183245, 157}},
			},
			want: cpuState{
				D:   [8]uint32{3643983838, 3800566182, 3259089509, 775353568, 408271118, 2895638549, 4241398432, 2154083113},
				A:   [7]uint32{3699425381, 1526504485, 3746583901, 3047950263, 3430722079, 3579605029, 3735105101},
				PC:  12183246,
				SR:  1544,
				USP: 15368304,
				SSP: 9214052,
				RAM: [][2]uint32{{12183240, 235}, {12183241, 78}, {12183242, 162}, {12183243, 119}, {12183244, 251}, {12183245, 157}},
			},
		},
		{
			name: "1500 LSL.w D7, D3 ef6b",
			init: cpuState{
				D:   [8]uint32{3917822185, 3333680672, 2063279199, 4187302206, 199517200, 1631966235, 624217394, 2751624973},
				A:   [7]uint32{881941121, 167247932, 277544136, 2412030287, 2487026024, 2576917288, 3709132532},
				PC:  8160450,
				SR:  9759,
				USP: 7419170,
				SSP: 8534914,
				RAM: [][2]uint32{{8160446, 239}, {8160447, 107}, {8160448, 41}, {8160449, 184}, {8160450, 161}, {8160451, 26}},
			},
			want: cpuState{
				D:   [8]uint32{3917822185, 3333680672, 2063279199, 4187340800, 199517200, 1631966235, 624217394, 2751624973},
				A:   [7]uint32{881941121, 167247932, 277544136, 2412030287, 2487026024, 2576917288, 3709132532},
				PC:  8160452,
				SR:  9753,
				USP: 7419170,
				SSP: 8534914,
				RAM: [][2]uint32{{8160446, 239}, {8160447, 107}, {8160448, 41}, {8160449, 184}, {8160450, 161}, {8160451, 26}},
			},
		},
		{
			name: "2000 LSL.w D3, D0 e768",
			init: cpuState{
				D:   [8]uint32{1441720186, 3027774892, 3697584072, 220988956, 1968024498, 4054318018, 2568185072, 18734346},
				A:   [7]uint32{3349678785, 822780736, 362806047, 2273777691, 1778016412, 3382496960, 697162390},
				PC:  12280310,
				SR:  1800,
				USP: 16655444,
				SSP: 11290822,
				RAM: [][2]uint32{{12280306, 231}, {12280307, 104}, {12280308, 26}, {12280309, 225}, {12280310, 90}, {12280311, 76}},
			},
			want: cpuState{
				D:   [8]uint32{1441660928, 3027774892, 3697584072, 220988956, 1968024498, 4054318018, 2568185072, 18734346},
				A:   [7]uint32{3349678785, 822780736, 362806047, 2273777691, 1778016412, 3382496960, 697162390},
				PC:  12280312,
				SR:  1796,
				USP: 16655444,
				SSP: 11290822,
				RAM: [][2]uint32{{12280306, 231}, {12280307, 104}, {12280308, 26}, {12280309, 225}, {12280310, 90}, {12280311, 76}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSL_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSL.l 8, D3 e18b",
			init: cpuState{
				D:   [8]uint32{2062035981, 1007843109, 2879661634, 75316724, 1441372217, 11302036, 3265089506, 1935558358},
				A:   [7]uint32{241915969, 3874271221, 1138071793, 3842450313, 345828183, 3944270070, 1291001525},
				PC:  16369382,
				SR:  34061,
				USP: 5880452,
				SSP: 6353640,
				RAM: [][2]uint32{{16369378, 225}, {16369379, 139}, {16369380, 125}, {16369381, 254}, {16369382, 117}, {16369383, 189}},
			},
			want: cpuState{
				D:   [8]uint32{2062035981, 1007843109, 2879661634, 2101212160, 1441372217, 11302036, 3265089506, 1935558358},
				A:   [7]uint32{241915969, 3874271221, 1138071793, 3842450313, 345828183, 3944270070, 1291001525},
				PC:  16369384,
				SR:  34048,
				USP: 5880452,
				SSP: 6353640,
				RAM: [][2]uint32{{16369378, 225}, {16369379, 139}, {16369380, 125}, {16369381, 254}, {16369382, 117}, {16369383, 189}},
			},
		},
		{
			name: "500 LSL.l D3, D3 e7ab",
			init: cpuState{
				D:   [8]uint32{183531361, 3226543135, 2693468984, 1821978543, 1932803332, 1383292087, 1907795154, 219479},
				A:   [7]uint32{756569799, 64034866, 931342248, 1585034533, 1046929544, 709898264, 3756825934},
				PC:  989060,
				SR:  268,
				USP: 2970532,
				SSP: 3359662,
				RAM: [][2]uint32{{989056, 231}, {989057, 171}, {989058, 176}, {989059, 247}, {989060, 54}, {989061, 200}},
			},
			want: cpuState{
				D:   [8]uint32{183531361, 3226543135, 2693468984, 0, 1932803332, 1383292087, 1907795154, 219479},
				A:   [7]uint32{756569799, 64034866, 931342248, 1585034533, 1046929544, 709898264, 3756825934},
				PC:  989062,
				SR:  260,
				USP: 2970532,
				SSP: 3359662,
				RAM: [][2]uint32{{989056, 231}, {989057, 171}, {989058, 176}, {989059, 247}, {989060, 54}, {989061, 200}},
			},
		},
		{
			name: "1000 LSL.l D3, D5 e7ad",
			init: cpuState{
				D:   [8]uint32{4294443838, 3913131719, 2141878934, 1040821364, 1501720541, 3714039895, 3472189310, 2781550733},
				A:   [7]uint32{1252790205, 2895946362, 2588152769, 128787016, 2960821180, 4074403020, 1376802307},
				PC:  3261002,
				SR:  279,
				USP: 13355324,
				SSP: 127548,
				RAM: [][2]uint32{{3260998, 231}, {3260999, 173}, {3261000, 89}, {3261001, 152}, {3261002, 17}, {3261003, 36}},
			},
			want: cpuState{
				D:   [8]uint32{4294443838, 3913131719, 2141878934, 1040821364, 1501720541, 0, 3472189310, 2781550733},
				A:   [7]uint32{1252790205, 2895946362, 2588152769, 128787016, 2960821180, 4074403020, 1376802307},
				PC:  3261004,
				SR:  260,
				USP: 13355324,
				SSP: 127548,
				RAM: [][2]uint32{{3260998, 231}, {3260999, 173}, {3261000, 89}, {3261001, 152}, {3261002, 17}, {3261003, 36}},
			},
		},
		{
			name: "1500 LSL.l 8, D4 e18c",
			init: cpuState{
				D:   [8]uint32{2625305891, 3192625566, 3907226004, 840457508, 2735956019, 4095158911, 3933359824, 3242301410},
				A:   [7]uint32{1269635845, 3702329561, 2871381873, 548374897, 2259333925, 1823887321, 3582750735},
				PC:  14514362,
				SR:  9747,
				USP: 5914472,
				SSP: 10827524,
				RAM: [][2]uint32{{14514358, 225}, {14514359, 140}, {14514360, 229}, {14514361, 35}, {14514362, 49}, {14514363, 92}},
			},
			want: cpuState{
				D:   [8]uint32{2625305891, 3192625566, 3907226004, 840457508, 325071616, 4095158911, 3933359824, 3242301410},
				A:   [7]uint32{1269635845, 3702329561, 2871381873, 548374897, 2259333925, 1823887321, 3582750735},
				PC:  14514364,
				SR:  9745,
				USP: 5914472,
				SSP: 10827524,
				RAM: [][2]uint32{{14514358, 225}, {14514359, 140}, {14514360, 229}, {14514361, 35}, {14514362, 49}, {14514363, 92}},
			},
		},
		{
			name: "2000 LSL.l 5, D0 eb88",
			init: cpuState{
				D:   [8]uint32{1471013739, 329203410, 1195468896, 1999214153, 3680394409, 1598410181, 4011358852, 1918365627},
				A:   [7]uint32{2760835465, 3250060056, 2972388712, 1189066888, 2027628413, 3804210184, 317121153},
				PC:  10045298,
				SR:  33295,
				USP: 16245132,
				SSP: 12804686,
				RAM: [][2]uint32{{10045294, 235}, {10045295, 136}, {10045296, 210}, {10045297, 117}, {10045298, 198}, {10045299, 131}},
			},
			want: cpuState{
				D:   [8]uint32{4122766688, 329203410, 1195468896, 1999214153, 3680394409, 1598410181, 4011358852, 1918365627},
				A:   [7]uint32{2760835465, 3250060056, 2972388712, 1189066888, 2027628413, 3804210184, 317121153},
				PC:  10045300,
				SR:  33288,
				USP: 16245132,
				SSP: 12804686,
				RAM: [][2]uint32{{10045294, 235}, {10045295, 136}, {10045296, 210}, {10045297, 117}, {10045298, 198}, {10045299, 131}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSR.b 8, D7 e00f",
			init: cpuState{
				D:   [8]uint32{1215550759, 3916236074, 1883522580, 2038950719, 3543397630, 307680705, 1867975362, 3365224368},
				A:   [7]uint32{2421187846, 2670051108, 2235160250, 3904210919, 1894245102, 3859098353, 3866968172},
				PC:  11736540,
				SR:  34060,
				USP: 8512312,
				SSP: 15678138,
				RAM: [][2]uint32{{11736536, 224}, {11736537, 15}, {11736538, 147}, {11736539, 241}, {11736540, 64}, {11736541, 130}},
			},
			want: cpuState{
				D:   [8]uint32{1215550759, 3916236074, 1883522580, 2038950719, 3543397630, 307680705, 1867975362, 3365224192},
				A:   [7]uint32{2421187846, 2670051108, 2235160250, 3904210919, 1894245102, 3859098353, 3866968172},
				PC:  11736542,
				SR:  34069,
				USP: 8512312,
				SSP: 15678138,
				RAM: [][2]uint32{{11736536, 224}, {11736537, 15}, {11736538, 147}, {11736539, 241}, {11736540, 64}, {11736541, 130}},
			},
		},
		{
			name: "500 LSR.b 3, D0 e608",
			init: cpuState{
				D:   [8]uint32{1781079828, 415377636, 438571227, 1555149959, 836396857, 2326716094, 2187815708, 524257889},
				A:   [7]uint32{3185213068, 4209788353, 574070102, 1080724607, 2154425325, 2775106800, 2409615205},
				PC:  6095266,
				SR:  797,
				USP: 7955924,
				SSP: 10012228,
				RAM: [][2]uint32{{6095262, 230}, {6095263, 8}, {6095264, 161}, {6095265, 246}, {6095266, 244}, {6095267, 191}},
			},
			want: cpuState{
				D:   [8]uint32{1781079810, 415377636, 438571227, 1555149959, 836396857, 2326716094, 2187815708, 524257889},
				A:   [7]uint32{3185213068, 4209788353, 574070102, 1080724607, 2154425325, 2775106800, 2409615205},
				PC:  6095268,
				SR:  785,
				USP: 7955924,
				SSP: 10012228,
				RAM: [][2]uint32{{6095262, 230}, {6095263, 8}, {6095264, 161}, {6095265, 246}, {6095266, 244}, {6095267, 191}},
			},
		},
		{
			name: "1000 LSR.b D4, D5 e82d",
			init: cpuState{
				D:   [8]uint32{1730205390, 1395303421, 148099880, 100490504, 3644448450, 1382560647, 2928053183, 371080323},
				A:   [7]uint32{992682164, 3911168444, 3868503994, 3041916823, 1440380477, 9266496, 264206656},
				PC:  217396,
				SR:  9740,
				USP: 3943358,
				SSP: 4260374,
				RAM: [][2]uint32{{217392, 232}, {217393, 45}, {217394, 135}, {217395, 72}, {217396, 15}, {217397, 36}},
			},
			want: cpuState{
				D:   [8]uint32{1730205390, 1395303421, 148099880, 100490504, 3644448450, 1382560545, 2928053183, 371080323},
				A:   [7]uint32{992682164, 3911168444, 3868503994, 3041916823, 1440380477, 9266496, 264206656},
				PC:  217398,
				SR:  9745,
				USP: 3943358,
				SSP: 4260374,
				RAM: [][2]uint32{{217392, 232}, {217393, 45}, {217394, 135}, {217395, 72}, {217396, 15}, {217397, 36}},
			},
		},
		{
			name: "1500 LSR.b D6, D4 ec2c",
			init: cpuState{
				D:   [8]uint32{1156755878, 268624685, 1916383032, 1590052220, 1394497727, 2185201717, 2238056528, 2518929137},
				A:   [7]uint32{3538915954, 3129259283, 2283706249, 2798089595, 3768127843, 375360350, 3104709669},
				PC:  12148438,
				SR:  41218,
				USP: 5928194,
				SSP: 9100758,
				RAM: [][2]uint32{{12148434, 236}, {12148435, 44}, {12148436, 3}, {12148437, 154}, {12148438, 89}, {12148439, 134}},
			},
			want: cpuState{
				D:   [8]uint32{1156755878, 268624685, 1916383032, 1590052220, 1394497536, 2185201717, 2238056528, 2518929137},
				A:   [7]uint32{3538915954, 3129259283, 2283706249, 2798089595, 3768127843, 375360350, 3104709669},
				PC:  12148440,
				SR:  41220,
				USP: 5928194,
				SSP: 9100758,
				RAM: [][2]uint32{{12148434, 236}, {12148435, 44}, {12148436, 3}, {12148437, 154}, {12148438, 89}, {12148439, 134}},
			},
		},
		{
			name: "2000 LSR.b D2, D5 e42d",
			init: cpuState{
				D:   [8]uint32{4002403626, 3139135878, 3113196079, 1827995190, 3032738361, 865033943, 3933335178, 2042750218},
				A:   [7]uint32{518065969, 3919425501, 7236685, 2339952591, 1554375988, 572644951, 621430416},
				PC:  4901646,
				SR:  42524,
				USP: 6389194,
				SSP: 9765292,
				RAM: [][2]uint32{{4901642, 228}, {4901643, 45}, {4901644, 177}, {4901645, 153}, {4901646, 112}, {4901647, 230}},
			},
			want: cpuState{
				D:   [8]uint32{4002403626, 3139135878, 3113196079, 1827995190, 3032738361, 865033728, 3933335178, 2042750218},
				A:   [7]uint32{518065969, 3919425501, 7236685, 2339952591, 1554375988, 572644951, 621430416},
				PC:  4901648,
				SR:  42500,
				USP: 6389194,
				SSP: 9765292,
				RAM: [][2]uint32{{4901642, 228}, {4901643, 45}, {4901644, 177}, {4901645, 153}, {4901646, 112}, {4901647, 230}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSR.w D4, D2 e86a",
			init: cpuState{
				D:   [8]uint32{3613981479, 1950888893, 1502505187, 320882185, 2422289313, 3915343000, 2255352576, 3620703378},
				A:   [7]uint32{2446806331, 836741192, 92728229, 3595702912, 2953516710, 815619293, 926650486},
				PC:  7862364,
				SR:  42264,
				USP: 11189918,
				SSP: 7477314,
				RAM: [][2]uint32{{7862360, 232}, {7862361, 106}, {7862362, 236}, {7862363, 245}, {7862364, 197}, {7862365, 174}},
			},
			want: cpuState{
				D:   [8]uint32{3613981479, 1950888893, 1502478336, 320882185, 2422289313, 3915343000, 2255352576, 3620703378},
				A:   [7]uint32{2446806331, 836741192, 92728229, 3595702912, 2953516710, 815619293, 926650486},
				PC:  7862366,
				SR:  42244,
				USP: 11189918,
				SSP: 7477314,
				RAM: [][2]uint32{{7862360, 232}, {7862361, 106}, {7862362, 236}, {7862363, 245}, {7862364, 197}, {7862365, 174}},
			},
		},
		{
			name: "500 LSR.w 2, D4 e44c",
			init: cpuState{
				D:   [8]uint32{3626228409, 800183646, 2420740966, 4065063533, 1984076026, 1826192797, 2374624536, 3134751358},
				A:   [7]uint32{2564901367, 1698864187, 650088275, 14992976, 3278824679, 2219246730, 605274396},
				PC:  314820,
				SR:  8709,
				USP: 15514916,
				SSP: 13449538,
				RAM: [][2]uint32{{314816, 228}, {314817, 76}, {314818, 253}, {314819, 107}, {314820, 185}, {314821, 31}},
			},
			want: cpuState{
				D:   [8]uint32{3626228409, 800183646, 2420740966, 4065063533, 1984046654, 1826192797, 2374624536, 3134751358},
				A:   [7]uint32{2564901367, 1698864187, 650088275, 14992976, 3278824679, 2219246730, 605274396},
				PC:  314822,
				SR:  8721,
				USP: 15514916,
				SSP: 13449538,
				RAM: [][2]uint32{{314816, 228}, {314817, 76}, {314818, 253}, {314819, 107}, {314820, 185}, {314821, 31}},
			},
		},
		{
			name: "1000 LSR.w 4, D0 e848",
			init: cpuState{
				D:   [8]uint32{3108799998, 3287431003, 2035185714, 900574117, 1896489130, 3038461123, 3282389377, 3180718924},
				A:   [7]uint32{1753632315, 3755858383, 1093143316, 2228075297, 2050368856, 738481557, 3357784066},
				PC:  309684,
				SR:  11,
				USP: 3178194,
				SSP: 6026170,
				RAM: [][2]uint32{{309680, 232}, {309681, 72}, {309682, 110}, {309683, 176}, {309684, 79}, {309685, 196}},
			},
			want: cpuState{
				D:   [8]uint32{3108767839, 3287431003, 2035185714, 900574117, 1896489130, 3038461123, 3282389377, 3180718924},
				A:   [7]uint32{1753632315, 3755858383, 1093143316, 2228075297, 2050368856, 738481557, 3357784066},
				PC:  309686,
				SR:  17,
				USP: 3178194,
				SSP: 6026170,
				RAM: [][2]uint32{{309680, 232}, {309681, 72}, {309682, 110}, {309683, 176}, {309684, 79}, {309685, 196}},
			},
		},
		{
			name: "1500 LSR.w D5, D7 ea6f",
			init: cpuState{
				D:   [8]uint32{3069735091, 3839702420, 1945437488, 536154389, 3716272982, 1649072570, 2644467355, 4226800462},
				A:   [7]uint32{352936751, 2906661667, 3954910920, 2153707351, 444983731, 401651211, 180015307},
				PC:  2550518,
				SR:  9751,
				USP: 16520150,
				SSP: 6088246,
				RAM: [][2]uint32{{2550514, 234}, {2550515, 111}, {2550516, 67}, {2550517, 27}, {2550518, 103}, {2550519, 192}},
			},
			want: cpuState{
				D:   [8]uint32{3069735091, 3839702420, 1945437488, 536154389, 3716272982, 1649072570, 2644467355, 4226744320},
				A:   [7]uint32{352936751, 2906661667, 3954910920, 2153707351, 444983731, 401651211, 180015307},
				PC:  2550520,
				SR:  9732,
				USP: 16520150,
				SSP: 6088246,
				RAM: [][2]uint32{{2550514, 234}, {2550515, 111}, {2550516, 67}, {2550517, 27}, {2550518, 103}, {2550519, 192}},
			},
		},
		{
			name: "2000 LSR.w D6, D7 ec6f",
			init: cpuState{
				D:   [8]uint32{2884176492, 597377447, 1532598747, 568317382, 2108077745, 1291344248, 870817564, 1678464314},
				A:   [7]uint32{2658105120, 4161433829, 2804699912, 2475913253, 1675486850, 986510767, 843131793},
				PC:  4630376,
				SR:  1050,
				USP: 11226530,
				SSP: 15117396,
				RAM: [][2]uint32{{4630372, 236}, {4630373, 111}, {4630374, 168}, {4630375, 116}, {4630376, 31}, {4630377, 121}},
			},
			want: cpuState{
				D:   [8]uint32{2884176492, 597377447, 1532598747, 568317382, 2108077745, 1291344248, 870817564, 1678442496},
				A:   [7]uint32{2658105120, 4161433829, 2804699912, 2475913253, 1675486850, 986510767, 843131793},
				PC:  4630378,
				SR:  1028,
				USP: 11226530,
				SSP: 15117396,
				RAM: [][2]uint32{{4630372, 236}, {4630373, 111}, {4630374, 168}, {4630375, 116}, {4630376, 31}, {4630377, 121}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLSR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LSR.l D1, D2 e2aa",
			init: cpuState{
				D:   [8]uint32{1451886717, 2451518905, 2667325714, 1214704149, 82497301, 2794953732, 2302808131, 1821088266},
				A:   [7]uint32{1561357439, 4221139185, 3522782695, 2377701524, 3678414482, 518277178, 2313370385},
				PC:  16466092,
				SR:  8982,
				USP: 6516510,
				SSP: 15752052,
				RAM: [][2]uint32{{16466088, 226}, {16466089, 170}, {16466090, 168}, {16466091, 100}, {16466092, 67}, {16466093, 8}},
			},
			want: cpuState{
				D:   [8]uint32{1451886717, 2451518905, 0, 1214704149, 82497301, 2794953732, 2302808131, 1821088266},
				A:   [7]uint32{1561357439, 4221139185, 3522782695, 2377701524, 3678414482, 518277178, 2313370385},
				PC:  16466094,
				SR:  8964,
				USP: 6516510,
				SSP: 15752052,
				RAM: [][2]uint32{{16466088, 226}, {16466089, 170}, {16466090, 168}, {16466091, 100}, {16466092, 67}, {16466093, 8}},
			},
		},
		{
			name: "500 LSR.l D5, D5 eaad",
			init: cpuState{
				D:   [8]uint32{4156057625, 967758683, 4071710206, 1255422581, 674810595, 3617005885, 3632295405, 2566082588},
				A:   [7]uint32{3196840965, 3336682156, 959928, 1656638477, 1770987066, 1097140707, 513086003},
				PC:  16024618,
				SR:  1303,
				USP: 856748,
				SSP: 3084248,
				RAM: [][2]uint32{{16024614, 234}, {16024615, 173}, {16024616, 102}, {16024617, 32}, {16024618, 37}, {16024619, 68}},
			},
			want: cpuState{
				D:   [8]uint32{4156057625, 967758683, 4071710206, 1255422581, 674810595, 0, 3632295405, 2566082588},
				A:   [7]uint32{3196840965, 3336682156, 959928, 1656638477, 1770987066, 1097140707, 513086003},
				PC:  16024620,
				SR:  1284,
				USP: 856748,
				SSP: 3084248,
				RAM: [][2]uint32{{16024614, 234}, {16024615, 173}, {16024616, 102}, {16024617, 32}, {16024618, 37}, {16024619, 68}},
			},
		},
		{
			name: "1000 LSR.l 4, D1 e889",
			init: cpuState{
				D:   [8]uint32{1104847861, 4046433863, 4277522165, 1091658418, 2146756260, 3655775547, 2109882973, 2420647124},
				A:   [7]uint32{1906636481, 303480731, 1358445353, 544785334, 277247800, 31764468, 2787922151},
				PC:  11389720,
				SR:  41495,
				USP: 8677664,
				SSP: 7308872,
				RAM: [][2]uint32{{11389716, 232}, {11389717, 137}, {11389718, 212}, {11389719, 95}, {11389720, 184}, {11389721, 68}},
			},
			want: cpuState{
				D:   [8]uint32{1104847861, 252902116, 4277522165, 1091658418, 2146756260, 3655775547, 2109882973, 2420647124},
				A:   [7]uint32{1906636481, 303480731, 1358445353, 544785334, 277247800, 31764468, 2787922151},
				PC:  11389722,
				SR:  41472,
				USP: 8677664,
				SSP: 7308872,
				RAM: [][2]uint32{{11389716, 232}, {11389717, 137}, {11389718, 212}, {11389719, 95}, {11389720, 184}, {11389721, 68}},
			},
		},
		{
			name: "1500 LSR.l D7, D5 eead",
			init: cpuState{
				D:   [8]uint32{2497586492, 339398789, 301577150, 2391772452, 56842977, 422434016, 2243648768, 1753196857},
				A:   [7]uint32{2137862612, 3364311605, 3664977143, 3973239510, 4077483256, 3560074477, 730552932},
				PC:  1360968,
				SR:  9496,
				USP: 3413340,
				SSP: 1113984,
				RAM: [][2]uint32{{1360964, 238}, {1360965, 173}, {1360966, 68}, {1360967, 49}, {1360968, 176}, {1360969, 120}},
			},
			want: cpuState{
				D:   [8]uint32{2497586492, 339398789, 301577150, 2391772452, 56842977, 0, 2243648768, 1753196857},
				A:   [7]uint32{2137862612, 3364311605, 3664977143, 3973239510, 4077483256, 3560074477, 730552932},
				PC:  1360970,
				SR:  9476,
				USP: 3413340,
				SSP: 1113984,
				RAM: [][2]uint32{{1360964, 238}, {1360965, 173}, {1360966, 68}, {1360967, 49}, {1360968, 176}, {1360969, 120}},
			},
		},
		{
			name: "2000 LSR.l 7, D7 ee8f",
			init: cpuState{
				D:   [8]uint32{809575155, 2403836666, 2644235358, 2256367370, 945101437, 3774014029, 204222569, 1096069994},
				A:   [7]uint32{144328578, 3187771959, 1355445875, 3372497391, 825212903, 2958094253, 572758074},
				PC:  11311524,
				SR:  8218,
				USP: 1476814,
				SSP: 2604486,
				RAM: [][2]uint32{{11311520, 238}, {11311521, 143}, {11311522, 12}, {11311523, 38}, {11311524, 77}, {11311525, 37}},
			},
			want: cpuState{
				D:   [8]uint32{809575155, 2403836666, 2644235358, 2256367370, 945101437, 3774014029, 204222569, 8563046},
				A:   [7]uint32{144328578, 3187771959, 1355445875, 3372497391, 825212903, 2958094253, 572758074},
				PC:  11311526,
				SR:  8209,
				USP: 1476814,
				SSP: 2604486,
				RAM: [][2]uint32{{11311520, 238}, {11311521, 143}, {11311522, 12}, {11311523, 38}, {11311524, 77}, {11311525, 37}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROL_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROL.b 5, D4 eb1c",
			init: cpuState{
				D:   [8]uint32{2517272444, 2265450936, 1004140053, 1657010017, 2442098835, 2304893628, 1293499442, 986914619},
				A:   [7]uint32{2015161358, 4086230873, 3045446721, 3003015903, 323189962, 2814893831, 3927382775},
				PC:  3138276,
				SR:  40961,
				USP: 3430384,
				SSP: 16342792,
				RAM: [][2]uint32{{3138272, 235}, {3138273, 28}, {3138274, 123}, {3138275, 149}, {3138276, 195}, {3138277, 234}},
			},
			want: cpuState{
				D:   [8]uint32{2517272444, 2265450936, 1004140053, 1657010017, 2442098802, 2304893628, 1293499442, 986914619},
				A:   [7]uint32{2015161358, 4086230873, 3045446721, 3003015903, 323189962, 2814893831, 3927382775},
				PC:  3138278,
				SR:  40960,
				USP: 3430384,
				SSP: 16342792,
				RAM: [][2]uint32{{3138272, 235}, {3138273, 28}, {3138274, 123}, {3138275, 149}, {3138276, 195}, {3138277, 234}},
			},
		},
		{
			name: "500 ROL.b 1, D6 e31e",
			init: cpuState{
				D:   [8]uint32{525198450, 983442165, 1088757446, 2239522858, 984287708, 3658178191, 2725799762, 854376006},
				A:   [7]uint32{1867906472, 1317350956, 3484231797, 1061163657, 1681532631, 401186662, 1369844739},
				PC:  1174412,
				SR:  33546,
				USP: 6665188,
				SSP: 16697410,
				RAM: [][2]uint32{{1174408, 227}, {1174409, 30}, {1174410, 79}, {1174411, 216}, {1174412, 191}, {1174413, 143}},
			},
			want: cpuState{
				D:   [8]uint32{525198450, 983442165, 1088757446, 2239522858, 984287708, 3658178191, 2725799844, 854376006},
				A:   [7]uint32{1867906472, 1317350956, 3484231797, 1061163657, 1681532631, 401186662, 1369844739},
				PC:  1174414,
				SR:  33544,
				USP: 6665188,
				SSP: 16697410,
				RAM: [][2]uint32{{1174408, 227}, {1174409, 30}, {1174410, 79}, {1174411, 216}, {1174412, 191}, {1174413, 143}},
			},
		},
		{
			name: "1000 ROL.b D4, D0 e938",
			init: cpuState{
				D:   [8]uint32{1690767015, 2911249276, 1919302455, 1196508991, 1527133813, 2375975483, 3777783378, 2944613900},
				A:   [7]uint32{573856248, 4232937307, 848021126, 4188606726, 325531161, 2983219363, 8298591},
				PC:  11559190,
				SR:  34569,
				USP: 1266586,
				SSP: 1636108,
				RAM: [][2]uint32{{11559186, 233}, {11559187, 56}, {11559188, 148}, {11559189, 53}, {11559190, 101}, {11559191, 185}},
			},
			want: cpuState{
				D:   [8]uint32{1690767092, 2911249276, 1919302455, 1196508991, 1527133813, 2375975483, 3777783378, 2944613900},
				A:   [7]uint32{573856248, 4232937307, 848021126, 4188606726, 325531161, 2983219363, 8298591},
				PC:  11559192,
				SR:  34568,
				USP: 1266586,
				SSP: 1636108,
				RAM: [][2]uint32{{11559186, 233}, {11559187, 56}, {11559188, 148}, {11559189, 53}, {11559190, 101}, {11559191, 185}},
			},
		},
		{
			name: "1500 ROL.b 8, D6 e11e",
			init: cpuState{
				D:   [8]uint32{2785518625, 3230668493, 931390908, 2212184029, 333474099, 3895950692, 2705625962, 178809708},
				A:   [7]uint32{482237976, 3232404909, 3476004405, 3443534518, 875943416, 3130493875, 3187644400},
				PC:  18086,
				SR:  34586,
				USP: 5466856,
				SSP: 15774426,
				RAM: [][2]uint32{{18082, 225}, {18083, 30}, {18084, 97}, {18085, 135}, {18086, 125}, {18087, 156}},
			},
			want: cpuState{
				D:   [8]uint32{2785518625, 3230668493, 931390908, 2212184029, 333474099, 3895950692, 2705625962, 178809708},
				A:   [7]uint32{482237976, 3232404909, 3476004405, 3443534518, 875943416, 3130493875, 3187644400},
				PC:  18088,
				SR:  34576,
				USP: 5466856,
				SSP: 15774426,
				RAM: [][2]uint32{{18082, 225}, {18083, 30}, {18084, 97}, {18085, 135}, {18086, 125}, {18087, 156}},
			},
		},
		{
			name: "2000 ROL.b D3, D1 e739",
			init: cpuState{
				D:   [8]uint32{388038370, 3162153770, 2555931228, 290815116, 3877127290, 2365245123, 1036471570, 3858586854},
				A:   [7]uint32{3452052381, 4017547708, 3000879294, 26585159, 3674026563, 2521375970, 601292067},
				PC:  6273300,
				SR:  782,
				USP: 45738,
				SSP: 8276770,
				RAM: [][2]uint32{{6273296, 231}, {6273297, 57}, {6273298, 12}, {6273299, 98}, {6273300, 242}, {6273301, 45}},
			},
			want: cpuState{
				D:   [8]uint32{388038370, 3162153890, 2555931228, 290815116, 3877127290, 2365245123, 1036471570, 3858586854},
				A:   [7]uint32{3452052381, 4017547708, 3000879294, 26585159, 3674026563, 2521375970, 601292067},
				PC:  6273302,
				SR:  776,
				USP: 45738,
				SSP: 8276770,
				RAM: [][2]uint32{{6273296, 231}, {6273297, 57}, {6273298, 12}, {6273299, 98}, {6273300, 242}, {6273301, 45}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROL_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROL.w D5, D4 eb7c",
			init: cpuState{
				D:   [8]uint32{2505882384, 685705009, 3030064830, 3675247218, 1432694544, 4114921107, 1343220142, 3055279028},
				A:   [7]uint32{4027503539, 2731282429, 3534683800, 4009763471, 2776129223, 933891404, 1092129691},
				PC:  13341400,
				SR:  10002,
				USP: 14763484,
				SSP: 12832426,
				RAM: [][2]uint32{{13341396, 235}, {13341397, 124}, {13341398, 147}, {13341399, 10}, {13341400, 17}, {13341401, 214}},
			},
			want: cpuState{
				D:   [8]uint32{2505882384, 685705009, 3030064830, 3675247218, 1432713345, 4114921107, 1343220142, 3055279028},
				A:   [7]uint32{4027503539, 2731282429, 3534683800, 4009763471, 2776129223, 933891404, 1092129691},
				PC:  13341402,
				SR:  10001,
				USP: 14763484,
				SSP: 12832426,
				RAM: [][2]uint32{{13341396, 235}, {13341397, 124}, {13341398, 147}, {13341399, 10}, {13341400, 17}, {13341401, 214}},
			},
		},
		{
			name: "500 ROL.w 6, D3 ed5b",
			init: cpuState{
				D:   [8]uint32{655770968, 3691991410, 1627668811, 2054292670, 3244930468, 1832754842, 1782672908, 433969253},
				A:   [7]uint32{2054802838, 3268739599, 3113985221, 910846268, 650712069, 3430120178, 2429837566},
				PC:  13664038,
				SR:  8462,
				USP: 8378588,
				SSP: 11773974,
				RAM: [][2]uint32{{13664034, 237}, {13664035, 91}, {13664036, 134}, {13664037, 54}, {13664038, 14}, {13664039, 158}},
			},
			want: cpuState{
				D:   [8]uint32{655770968, 3691991410, 1627668811, 2054303617, 3244930468, 1832754842, 1782672908, 433969253},
				A:   [7]uint32{2054802838, 3268739599, 3113985221, 910846268, 650712069, 3430120178, 2429837566},
				PC:  13664040,
				SR:  8449,
				USP: 8378588,
				SSP: 11773974,
				RAM: [][2]uint32{{13664034, 237}, {13664035, 91}, {13664036, 134}, {13664037, 54}, {13664038, 14}, {13664039, 158}},
			},
		},
		{
			name: "1000 ROL.w 5, D2 eb5a",
			init: cpuState{
				D:   [8]uint32{4100750327, 217295128, 1624159517, 3744133661, 1815349090, 2329705411, 3263645590, 3958144869},
				A:   [7]uint32{4279370027, 3498919482, 3410734175, 1670676982, 1309440120, 1474374107, 2826690182},
				PC:  12729982,
				SR:  9244,
				USP: 14180484,
				SSP: 9091024,
				RAM: [][2]uint32{{12729978, 235}, {12729979, 90}, {12729980, 173}, {12729981, 69}, {12729982, 4}, {12729983, 123}},
			},
			want: cpuState{
				D:   [8]uint32{4100750327, 217295128, 1624155062, 3744133661, 1815349090, 2329705411, 3263645590, 3958144869},
				A:   [7]uint32{4279370027, 3498919482, 3410734175, 1670676982, 1309440120, 1474374107, 2826690182},
				PC:  12729984,
				SR:  9240,
				USP: 14180484,
				SSP: 9091024,
				RAM: [][2]uint32{{12729978, 235}, {12729979, 90}, {12729980, 173}, {12729981, 69}, {12729982, 4}, {12729983, 123}},
			},
		},
		{
			name: "1500 ROL.w D7, D2 ef7a",
			init: cpuState{
				D:   [8]uint32{1851922317, 2694208766, 392342241, 2203627858, 1767964058, 2664414603, 838653975, 2087067338},
				A:   [7]uint32{1837770238, 2368650546, 3704307740, 2171328217, 4012510328, 486012234, 1407683769},
				PC:  11226004,
				SR:  33303,
				USP: 2185988,
				SSP: 2430476,
				RAM: [][2]uint32{{11226000, 239}, {11226001, 122}, {11226002, 27}, {11226003, 141}, {11226004, 114}, {11226005, 42}},
			},
			want: cpuState{
				D:   [8]uint32{1851922317, 2694208766, 392332971, 2203627858, 1767964058, 2664414603, 838653975, 2087067338},
				A:   [7]uint32{1837770238, 2368650546, 3704307740, 2171328217, 4012510328, 486012234, 1407683769},
				PC:  11226006,
				SR:  33305,
				USP: 2185988,
				SSP: 2430476,
				RAM: [][2]uint32{{11226000, 239}, {11226001, 122}, {11226002, 27}, {11226003, 141}, {11226004, 114}, {11226005, 42}},
			},
		},
		{
			name: "2000 ROL.w D7, D2 ef7a",
			init: cpuState{
				D:   [8]uint32{3555407885, 1814430557, 861345995, 1676874006, 3396918028, 184878603, 3301044309, 3140299004},
				A:   [7]uint32{3014189570, 888327233, 3786983369, 439758804, 4152198053, 2291577213, 4144415127},
				PC:  16281574,
				SR:  41236,
				USP: 13250876,
				SSP: 6391296,
				RAM: [][2]uint32{{16281570, 239}, {16281571, 122}, {16281572, 37}, {16281573, 245}, {16281574, 25}, {16281575, 234}},
			},
			want: cpuState{
				D:   [8]uint32{3555407885, 1814430557, 861385100, 1676874006, 3396918028, 184878603, 3301044309, 3140299004},
				A:   [7]uint32{3014189570, 888327233, 3786983369, 439758804, 4152198053, 2291577213, 4144415127},
				PC:  16281576,
				SR:  41240,
				USP: 13250876,
				SSP: 6391296,
				RAM: [][2]uint32{{16281570, 239}, {16281571, 122}, {16281572, 37}, {16281573, 245}, {16281574, 25}, {16281575, 234}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROL_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROL.l D7, D0 efb8",
			init: cpuState{
				D:   [8]uint32{295350685, 1290224561, 202247791, 2997091738, 2379467381, 951256509, 3876128624, 3840337621},
				A:   [7]uint32{1396228345, 1200069987, 3443579832, 2560296284, 2988992071, 2661556390, 1342203178},
				PC:  13780572,
				SR:  42514,
				USP: 10556802,
				SSP: 53978,
				RAM: [][2]uint32{{13780568, 239}, {13780569, 184}, {13780570, 249}, {13780571, 30}, {13780572, 248}, {13780573, 151}},
			},
			want: cpuState{
				D:   [8]uint32{866267990, 1290224561, 202247791, 2997091738, 2379467381, 951256509, 3876128624, 3840337621},
				A:   [7]uint32{1396228345, 1200069987, 3443579832, 2560296284, 2988992071, 2661556390, 1342203178},
				PC:  13780574,
				SR:  42512,
				USP: 10556802,
				SSP: 53978,
				RAM: [][2]uint32{{13780568, 239}, {13780569, 184}, {13780570, 249}, {13780571, 30}, {13780572, 248}, {13780573, 151}},
			},
		},
		{
			name: "500 ROL.l D3, D5 e7bd",
			init: cpuState{
				D:   [8]uint32{2483332442, 3766313178, 1178828620, 348440065, 380403517, 3957867825, 2741980313, 3127404373},
				A:   [7]uint32{1573219485, 1320143408, 3368563101, 2022700411, 4134067902, 3167194623, 3132289933},
				PC:  6467162,
				SR:  9752,
				USP: 8971192,
				SSP: 78060,
				RAM: [][2]uint32{{6467158, 231}, {6467159, 189}, {6467160, 59}, {6467161, 141}, {6467162, 29}, {6467163, 182}},
			},
			want: cpuState{
				D:   [8]uint32{2483332442, 3766313178, 1178828620, 348440065, 380403517, 3620768355, 2741980313, 3127404373},
				A:   [7]uint32{1573219485, 1320143408, 3368563101, 2022700411, 4134067902, 3167194623, 3132289933},
				PC:  6467164,
				SR:  9753,
				USP: 8971192,
				SSP: 78060,
				RAM: [][2]uint32{{6467158, 231}, {6467159, 189}, {6467160, 59}, {6467161, 141}, {6467162, 29}, {6467163, 182}},
			},
		},
		{
			name: "1000 ROL.l 8, D3 e19b",
			init: cpuState{
				D:   [8]uint32{3029220882, 2110876063, 2873439725, 1403579860, 2167148551, 225598169, 3726276757, 408639079},
				A:   [7]uint32{3861147860, 2639339833, 2874631903, 3323855726, 1381324249, 167261836, 1874674619},
				PC:  8628888,
				SR:  41225,
				USP: 15606080,
				SSP: 16713252,
				RAM: [][2]uint32{{8628884, 225}, {8628885, 155}, {8628886, 89}, {8628887, 225}, {8628888, 29}, {8628889, 59}},
			},
			want: cpuState{
				D:   [8]uint32{3029220882, 2110876063, 2873439725, 2834158675, 2167148551, 225598169, 3726276757, 408639079},
				A:   [7]uint32{3861147860, 2639339833, 2874631903, 3323855726, 1381324249, 167261836, 1874674619},
				PC:  8628890,
				SR:  41225,
				USP: 15606080,
				SSP: 16713252,
				RAM: [][2]uint32{{8628884, 225}, {8628885, 155}, {8628886, 89}, {8628887, 225}, {8628888, 29}, {8628889, 59}},
			},
		},
		{
			name: "1500 ROL.l D2, D7 e5bf",
			init: cpuState{
				D:   [8]uint32{2253782106, 737149875, 4273674890, 865167825, 4015861447, 4027163114, 1662341325, 2885132462},
				A:   [7]uint32{3638012439, 277237113, 867479731, 972908219, 1455078264, 2419495580, 2971085724},
				PC:  15553196,
				SR:  41991,
				USP: 7602458,
				SSP: 7797492,
				RAM: [][2]uint32{{15553192, 229}, {15553193, 191}, {15553194, 164}, {15553195, 201}, {15553196, 219}, {15553197, 161}},
			},
			want: cpuState{
				D:   [8]uint32{2253782106, 737149875, 4273674890, 865167825, 4015861447, 4027163114, 1662341325, 3733109423},
				A:   [7]uint32{3638012439, 277237113, 867479731, 972908219, 1455078264, 2419495580, 2971085724},
				PC:  15553198,
				SR:  41993,
				USP: 7602458,
				SSP: 7797492,
				RAM: [][2]uint32{{15553192, 229}, {15553193, 191}, {15553194, 164}, {15553195, 201}, {15553196, 219}, {15553197, 161}},
			},
		},
		{
			name: "2000 ROL.l D5, D6 ebbe",
			init: cpuState{
				D:   [8]uint32{1412189718, 69201572, 1425279619, 3272022042, 1412924640, 2201067626, 511401459, 2713412758},
				A:   [7]uint32{1626344863, 2613110879, 3370085688, 3020014427, 1523863605, 1901878954, 1095374341},
				PC:  3211150,
				SR:  1303,
				USP: 15172950,
				SSP: 10775196,
				RAM: [][2]uint32{{3211146, 235}, {3211147, 190}, {3211148, 149}, {3211149, 103}, {3211150, 165}, {3211151, 138}},
			},
			want: cpuState{
				D:   [8]uint32{1412189718, 69201572, 1425279619, 3272022042, 1412924640, 2201067626, 3984051321, 2713412758},
				A:   [7]uint32{1626344863, 2613110879, 3370085688, 3020014427, 1523863605, 1901878954, 1095374341},
				PC:  3211152,
				SR:  1305,
				USP: 15172950,
				SSP: 10775196,
				RAM: [][2]uint32{{3211146, 235}, {3211147, 190}, {3211148, 149}, {3211149, 103}, {3211150, 165}, {3211151, 138}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROR.b D2, D7 e43f",
			init: cpuState{
				D:   [8]uint32{938820907, 1515088277, 3708817845, 2506402469, 1004564263, 2756647632, 2415828783, 960861207},
				A:   [7]uint32{714598688, 64111565, 2830271819, 4221314877, 656614737, 2026516189, 469208339},
				PC:  5496490,
				SR:  768,
				USP: 1115320,
				SSP: 8119602,
				RAM: [][2]uint32{{5496486, 228}, {5496487, 63}, {5496488, 39}, {5496489, 60}, {5496490, 165}, {5496491, 194}},
			},
			want: cpuState{
				D:   [8]uint32{938820907, 1515088277, 3708817845, 2506402469, 1004564263, 2756647632, 2415828783, 960861368},
				A:   [7]uint32{714598688, 64111565, 2830271819, 4221314877, 656614737, 2026516189, 469208339},
				PC:  5496492,
				SR:  777,
				USP: 1115320,
				SSP: 8119602,
				RAM: [][2]uint32{{5496486, 228}, {5496487, 63}, {5496488, 39}, {5496489, 60}, {5496490, 165}, {5496491, 194}},
			},
		},
		{
			name: "500 ROR.b D3, D4 e63c",
			init: cpuState{
				D:   [8]uint32{158705526, 673412537, 2485851177, 192535299, 801442153, 3168844387, 968758883, 3519451289},
				A:   [7]uint32{149563298, 4025417913, 211509840, 3921793794, 434416538, 3740045938, 3857974199},
				PC:  13348262,
				SR:  33031,
				USP: 11521540,
				SSP: 8584574,
				RAM: [][2]uint32{{13348258, 230}, {13348259, 60}, {13348260, 127}, {13348261, 73}, {13348262, 120}, {13348263, 20}},
			},
			want: cpuState{
				D:   [8]uint32{158705526, 673412537, 2485851177, 192535299, 801442093, 3168844387, 968758883, 3519451289},
				A:   [7]uint32{149563298, 4025417913, 211509840, 3921793794, 434416538, 3740045938, 3857974199},
				PC:  13348264,
				SR:  33024,
				USP: 11521540,
				SSP: 8584574,
				RAM: [][2]uint32{{13348258, 230}, {13348259, 60}, {13348260, 127}, {13348261, 73}, {13348262, 120}, {13348263, 20}},
			},
		},
		{
			name: "1000 ROR.b 3, D1 e619",
			init: cpuState{
				D:   [8]uint32{3635670563, 313263290, 3021912349, 1879008252, 4148491839, 3278672074, 3815483119, 812757996},
				A:   [7]uint32{1837332243, 3294154776, 414310313, 2020808964, 542759741, 844171455, 3218797941},
				PC:  13884740,
				SR:  9745,
				USP: 12497318,
				SSP: 12721830,
				RAM: [][2]uint32{{13884736, 230}, {13884737, 25}, {13884738, 100}, {13884739, 174}, {13884740, 136}, {13884741, 210}},
			},
			want: cpuState{
				D:   [8]uint32{3635670563, 313263191, 3021912349, 1879008252, 4148491839, 3278672074, 3815483119, 812757996},
				A:   [7]uint32{1837332243, 3294154776, 414310313, 2020808964, 542759741, 844171455, 3218797941},
				PC:  13884742,
				SR:  9744,
				USP: 12497318,
				SSP: 12721830,
				RAM: [][2]uint32{{13884736, 230}, {13884737, 25}, {13884738, 100}, {13884739, 174}, {13884740, 136}, {13884741, 210}},
			},
		},
		{
			name: "1500 ROR.b D6, D0 ec38",
			init: cpuState{
				D:   [8]uint32{3835500300, 3338531280, 158715761, 1182820410, 338908788, 3299353751, 1775356906, 2629496226},
				A:   [7]uint32{455855848, 2150862286, 3182415973, 337689196, 809226083, 3066454891, 1544438416},
				PC:  11342784,
				SR:  41752,
				USP: 15840816,
				SSP: 9436760,
				RAM: [][2]uint32{{11342780, 236}, {11342781, 56}, {11342782, 185}, {11342783, 245}, {11342784, 13}, {11342785, 101}},
			},
			want: cpuState{
				D:   [8]uint32{3835500291, 3338531280, 158715761, 1182820410, 338908788, 3299353751, 1775356906, 2629496226},
				A:   [7]uint32{455855848, 2150862286, 3182415973, 337689196, 809226083, 3066454891, 1544438416},
				PC:  11342786,
				SR:  41744,
				USP: 15840816,
				SSP: 9436760,
				RAM: [][2]uint32{{11342780, 236}, {11342781, 56}, {11342782, 185}, {11342783, 245}, {11342784, 13}, {11342785, 101}},
			},
		},
		{
			name: "2000 ROR.b 3, D4 e61c",
			init: cpuState{
				D:   [8]uint32{1673305482, 1959110684, 1430928225, 1296818593, 4063627594, 802635157, 1440580303, 72206861},
				A:   [7]uint32{474560963, 1828693886, 1012533870, 1991186618, 689526980, 2555260458, 2326555890},
				PC:  4523742,
				SR:  33052,
				USP: 11262972,
				SSP: 16654836,
				RAM: [][2]uint32{{4523738, 230}, {4523739, 28}, {4523740, 214}, {4523741, 73}, {4523742, 161}, {4523743, 43}},
			},
			want: cpuState{
				D:   [8]uint32{1673305482, 1959110684, 1430928225, 1296818593, 4063627593, 802635157, 1440580303, 72206861},
				A:   [7]uint32{474560963, 1828693886, 1012533870, 1991186618, 689526980, 2555260458, 2326555890},
				PC:  4523744,
				SR:  33040,
				USP: 11262972,
				SSP: 16654836,
				RAM: [][2]uint32{{4523738, 230}, {4523739, 28}, {4523740, 214}, {4523741, 73}, {4523742, 161}, {4523743, 43}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROR.w D4, D6 e87e",
			init: cpuState{
				D:   [8]uint32{690734105, 3676892, 941802545, 3235355852, 1423857177, 4279984995, 1253406463, 2433452530},
				A:   [7]uint32{3980864387, 2078453306, 3800170397, 260413823, 1210905091, 2630032364, 1471294024},
				PC:  8242006,
				SR:  40990,
				USP: 5724128,
				SSP: 13347118,
				RAM: [][2]uint32{{8242002, 232}, {8242003, 126}, {8242004, 29}, {8242005, 69}, {8242006, 144}, {8242007, 228}},
			},
			want: cpuState{
				D:   [8]uint32{690734105, 3676892, 941802545, 3235355852, 1423857177, 4279984995, 1253408699, 2433452530},
				A:   [7]uint32{3980864387, 2078453306, 3800170397, 260413823, 1210905091, 2630032364, 1471294024},
				PC:  8242008,
				SR:  40976,
				USP: 5724128,
				SSP: 13347118,
				RAM: [][2]uint32{{8242002, 232}, {8242003, 126}, {8242004, 29}, {8242005, 69}, {8242006, 144}, {8242007, 228}},
			},
		},
		{
			name: "500 ROR.w (xxx).l e6f9",
			init: cpuState{
				D:   [8]uint32{3602999141, 1013506157, 3738862774, 2427179377, 1001795172, 249234494, 1776984716, 3582429919},
				A:   [7]uint32{3621550820, 3746844677, 3469563172, 159910209, 2738470571, 2798836640, 3313564004},
				PC:  9657224,
				SR:  8221,
				USP: 9338140,
				SSP: 10729056,
				RAM: [][2]uint32{{9657220, 230}, {9657221, 249}, {9657222, 242}, {9657223, 10}, {9657224, 100}, {9657225, 80}, {9657226, 44}, {9657227, 90}, {681040, 25}, {681041, 134}, {9657228, 169}, {9657229, 252}},
			},
			want: cpuState{
				D:   [8]uint32{3602999141, 1013506157, 3738862774, 2427179377, 1001795172, 249234494, 1776984716, 3582429919},
				A:   [7]uint32{3621550820, 3746844677, 3469563172, 159910209, 2738470571, 2798836640, 3313564004},
				PC:  9657230,
				SR:  8208,
				USP: 9338140,
				SSP: 10729056,
				RAM: [][2]uint32{{9657220, 230}, {9657221, 249}, {9657222, 242}, {9657223, 10}, {9657224, 100}, {9657225, 80}, {9657226, 44}, {9657227, 90}, {681040, 12}, {681041, 195}, {9657228, 169}, {9657229, 252}},
			},
		},
		{
			name: "1000 ROR.w (d16, A2) e6ea",
			init: cpuState{
				D:   [8]uint32{1141107441, 1159196379, 1995006020, 2794193312, 688857601, 3622909966, 3463014773, 836898000},
				A:   [7]uint32{3114858915, 2481882052, 3296829709, 3071014225, 732749813, 3034296127, 1421080772},
				PC:  11352242,
				SR:  41991,
				USP: 11188848,
				SSP: 2598132,
				RAM: [][2]uint32{{11352238, 230}, {11352239, 234}, {11352240, 46}, {11352241, 69}, {11352242, 188}, {11352243, 129}, {8507218, 116}, {8507219, 2}, {11352244, 245}, {11352245, 83}},
			},
			want: cpuState{
				D:   [8]uint32{1141107441, 1159196379, 1995006020, 2794193312, 688857601, 3622909966, 3463014773, 836898000},
				A:   [7]uint32{3114858915, 2481882052, 3296829709, 3071014225, 732749813, 3034296127, 1421080772},
				PC:  11352246,
				SR:  41984,
				USP: 11188848,
				SSP: 2598132,
				RAM: [][2]uint32{{11352238, 230}, {11352239, 234}, {11352240, 46}, {11352241, 69}, {11352242, 188}, {11352243, 129}, {8507218, 58}, {8507219, 1}, {11352244, 245}, {11352245, 83}},
			},
		},
		{
			name: "1500 ROR.w 3, D7 e65f",
			init: cpuState{
				D:   [8]uint32{3877799049, 3269076379, 2930298438, 4129024050, 849393361, 1431161624, 1650364373, 224287479},
				A:   [7]uint32{3493043077, 267073808, 4125856047, 3166877361, 3630676677, 2498800809, 3564650071},
				PC:  5813912,
				SR:  8467,
				USP: 1443116,
				SSP: 15069912,
				RAM: [][2]uint32{{5813908, 230}, {5813909, 95}, {5813910, 37}, {5813911, 148}, {5813912, 130}, {5813913, 212}},
			},
			want: cpuState{
				D:   [8]uint32{3877799049, 3269076379, 2930298438, 4129024050, 849393361, 1431161624, 1650364373, 224324446},
				A:   [7]uint32{3493043077, 267073808, 4125856047, 3166877361, 3630676677, 2498800809, 3564650071},
				PC:  5813914,
				SR:  8473,
				USP: 1443116,
				SSP: 15069912,
				RAM: [][2]uint32{{5813908, 230}, {5813909, 95}, {5813910, 37}, {5813911, 148}, {5813912, 130}, {5813913, 212}},
			},
		},
		{
			name: "2000 ROR.w (d16, A6) e6ee",
			init: cpuState{
				D:   [8]uint32{1806189905, 1936544932, 2253819075, 4166975612, 290533509, 2710853715, 933643528, 1667977469},
				A:   [7]uint32{4248998968, 1659104091, 3211346819, 4058757946, 1593762188, 179400713, 3850348527},
				PC:  1573604,
				SR:  9231,
				USP: 11739050,
				SSP: 4381460,
				RAM: [][2]uint32{{1573600, 230}, {1573601, 238}, {1573602, 183}, {1573603, 127}, {1573604, 16}, {1573605, 249}, {8347502, 126}, {8347503, 82}, {1573606, 186}, {1573607, 201}},
			},
			want: cpuState{
				D:   [8]uint32{1806189905, 1936544932, 2253819075, 4166975612, 290533509, 2710853715, 933643528, 1667977469},
				A:   [7]uint32{4248998968, 1659104091, 3211346819, 4058757946, 1593762188, 179400713, 3850348527},
				PC:  1573608,
				SR:  9216,
				USP: 11739050,
				SSP: 4381460,
				RAM: [][2]uint32{{1573600, 230}, {1573601, 238}, {1573602, 183}, {1573603, 127}, {1573604, 16}, {1573605, 249}, {8347502, 63}, {8347503, 41}, {1573606, 186}, {1573607, 201}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROR.l 8, D7 e09f",
			init: cpuState{
				D:   [8]uint32{2524685064, 4113957086, 995541485, 52428502, 2827781911, 1326447816, 612819895, 4034337311},
				A:   [7]uint32{2655973454, 223370409, 333792192, 3637965723, 1602637634, 1216760314, 369516563},
				PC:  11946118,
				SR:  34078,
				USP: 9798282,
				SSP: 6026594,
				RAM: [][2]uint32{{11946114, 224}, {11946115, 159}, {11946116, 246}, {11946117, 250}, {11946118, 16}, {11946119, 110}},
			},
			want: cpuState{
				D:   [8]uint32{2524685064, 4113957086, 995541485, 52428502, 2827781911, 1326447816, 612819895, 535852826},
				A:   [7]uint32{2655973454, 223370409, 333792192, 3637965723, 1602637634, 1216760314, 369516563},
				PC:  11946120,
				SR:  34064,
				USP: 9798282,
				SSP: 6026594,
				RAM: [][2]uint32{{11946114, 224}, {11946115, 159}, {11946116, 246}, {11946117, 250}, {11946118, 16}, {11946119, 110}},
			},
		},
		{
			name: "500 ROR.l 1, D1 e299",
			init: cpuState{
				D:   [8]uint32{2922202245, 2041759849, 833896723, 1926105083, 3088400848, 4208246586, 537450674, 911140969},
				A:   [7]uint32{3491104020, 1546681717, 1726213927, 1408250068, 1643205213, 3700841183, 2903764632},
				PC:  1362668,
				SR:  41733,
				USP: 10495604,
				SSP: 7549260,
				RAM: [][2]uint32{{1362664, 226}, {1362665, 153}, {1362666, 208}, {1362667, 103}, {1362668, 181}, {1362669, 229}},
			},
			want: cpuState{
				D:   [8]uint32{2922202245, 3168363572, 833896723, 1926105083, 3088400848, 4208246586, 537450674, 911140969},
				A:   [7]uint32{3491104020, 1546681717, 1726213927, 1408250068, 1643205213, 3700841183, 2903764632},
				PC:  1362670,
				SR:  41737,
				USP: 10495604,
				SSP: 7549260,
				RAM: [][2]uint32{{1362664, 226}, {1362665, 153}, {1362666, 208}, {1362667, 103}, {1362668, 181}, {1362669, 229}},
			},
		},
		{
			name: "1000 ROR.l 3, D2 e69a",
			init: cpuState{
				D:   [8]uint32{763511447, 3988262877, 1407121522, 205477119, 1109150702, 501704758, 4049494661, 2596061461},
				A:   [7]uint32{413640780, 3331076188, 419745247, 1598349660, 2983642162, 4013909675, 1306642915},
				PC:  13668146,
				SR:  42767,
				USP: 4872634,
				SSP: 5118912,
				RAM: [][2]uint32{{13668142, 230}, {13668143, 154}, {13668144, 95}, {13668145, 85}, {13668146, 238}, {13668147, 229}},
			},
			want: cpuState{
				D:   [8]uint32{763511447, 3988262877, 1249632014, 205477119, 1109150702, 501704758, 4049494661, 2596061461},
				A:   [7]uint32{413640780, 3331076188, 419745247, 1598349660, 2983642162, 4013909675, 1306642915},
				PC:  13668148,
				SR:  42752,
				USP: 4872634,
				SSP: 5118912,
				RAM: [][2]uint32{{13668142, 230}, {13668143, 154}, {13668144, 95}, {13668145, 85}, {13668146, 238}, {13668147, 229}},
			},
		},
		{
			name: "1500 ROR.l 2, D2 e49a",
			init: cpuState{
				D:   [8]uint32{1979296610, 3423980325, 587024736, 3736041091, 3267289120, 346030452, 186326304, 530726175},
				A:   [7]uint32{1603290857, 2369078138, 697625453, 3181513537, 1048071802, 1399810329, 2169235999},
				PC:  10218442,
				SR:  9234,
				USP: 13969986,
				SSP: 9025556,
				RAM: [][2]uint32{{10218438, 228}, {10218439, 154}, {10218440, 209}, {10218441, 128}, {10218442, 41}, {10218443, 110}},
			},
			want: cpuState{
				D:   [8]uint32{1979296610, 3423980325, 146756184, 3736041091, 3267289120, 346030452, 186326304, 530726175},
				A:   [7]uint32{1603290857, 2369078138, 697625453, 3181513537, 1048071802, 1399810329, 2169235999},
				PC:  10218444,
				SR:  9232,
				USP: 13969986,
				SSP: 9025556,
				RAM: [][2]uint32{{10218438, 228}, {10218439, 154}, {10218440, 209}, {10218441, 128}, {10218442, 41}, {10218443, 110}},
			},
		},
		{
			name: "2000 ROR.l 4, D1 e899",
			init: cpuState{
				D:   [8]uint32{341284151, 2736211504, 4290097651, 191216060, 324597591, 1322998442, 215262125, 2420262599},
				A:   [7]uint32{372862239, 1948490673, 1421139240, 3107214702, 442165390, 930365179, 3432634207},
				PC:  8002744,
				SR:  31,
				USP: 1094964,
				SSP: 12448046,
				RAM: [][2]uint32{{8002740, 232}, {8002741, 153}, {8002742, 107}, {8002743, 53}, {8002744, 92}, {8002745, 23}},
			},
			want: cpuState{
				D:   [8]uint32{341284151, 171013219, 4290097651, 191216060, 324597591, 1322998442, 215262125, 2420262599},
				A:   [7]uint32{372862239, 1948490673, 1421139240, 3107214702, 442165390, 930365179, 3432634207},
				PC:  8002746,
				SR:  16,
				USP: 1094964,
				SSP: 12448046,
				RAM: [][2]uint32{{8002740, 232}, {8002741, 153}, {8002742, 107}, {8002743, 53}, {8002744, 92}, {8002745, 23}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXL_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXL.b 1, D0 e310",
			init: cpuState{
				D:   [8]uint32{3924855748, 194293367, 1650562615, 2093518686, 1819219859, 654038519, 115088476, 3329632326},
				A:   [7]uint32{1771164836, 2447407622, 3787725742, 1026487977, 4013075012, 1506547656, 3160114949},
				PC:  13305274,
				SR:  8201,
				USP: 7631224,
				SSP: 4506738,
				RAM: [][2]uint32{{13305270, 227}, {13305271, 16}, {13305272, 81}, {13305273, 83}, {13305274, 49}, {13305275, 195}},
			},
			want: cpuState{
				D:   [8]uint32{3924855688, 194293367, 1650562615, 2093518686, 1819219859, 654038519, 115088476, 3329632326},
				A:   [7]uint32{1771164836, 2447407622, 3787725742, 1026487977, 4013075012, 1506547656, 3160114949},
				PC:  13305276,
				SR:  8217,
				USP: 7631224,
				SSP: 4506738,
				RAM: [][2]uint32{{13305270, 227}, {13305271, 16}, {13305272, 81}, {13305273, 83}, {13305274, 49}, {13305275, 195}},
			},
		},
		{
			name: "500 ROXL.b 5, D1 eb11",
			init: cpuState{
				D:   [8]uint32{1888913356, 2221789377, 1994609211, 2706971263, 4031419226, 811450499, 2669375959, 2778654981},
				A:   [7]uint32{863748674, 2680153590, 381536844, 4168985368, 4126297276, 916121738, 3526149034},
				PC:  11694872,
				SR:  33542,
				USP: 13859128,
				SSP: 82244,
				RAM: [][2]uint32{{11694868, 235}, {11694869, 17}, {11694870, 35}, {11694871, 13}, {11694872, 66}, {11694873, 3}},
			},
			want: cpuState{
				D:   [8]uint32{1888913356, 2221789228, 1994609211, 2706971263, 4031419226, 811450499, 2669375959, 2778654981},
				A:   [7]uint32{863748674, 2680153590, 381536844, 4168985368, 4126297276, 916121738, 3526149034},
				PC:  11694874,
				SR:  33536,
				USP: 13859128,
				SSP: 82244,
				RAM: [][2]uint32{{11694868, 235}, {11694869, 17}, {11694870, 35}, {11694871, 13}, {11694872, 66}, {11694873, 3}},
			},
		},
		{
			name: "1000 ROXL.b 5, D2 eb12",
			init: cpuState{
				D:   [8]uint32{2846753559, 2219512329, 86505047, 4180304900, 3690120655, 2215221751, 24298556, 3577033584},
				A:   [7]uint32{4128795416, 2307917395, 133049003, 1553218119, 1950099045, 1147531985, 746993516},
				PC:  7765160,
				SR:  8214,
				USP: 7158886,
				SSP: 3075208,
				RAM: [][2]uint32{{7765156, 235}, {7765157, 18}, {7765158, 164}, {7765159, 72}, {7765160, 57}, {7765161, 192}},
			},
			want: cpuState{
				D:   [8]uint32{2846753559, 2219512329, 86505205, 4180304900, 3690120655, 2215221751, 24298556, 3577033584},
				A:   [7]uint32{4128795416, 2307917395, 133049003, 1553218119, 1950099045, 1147531985, 746993516},
				PC:  7765162,
				SR:  8200,
				USP: 7158886,
				SSP: 3075208,
				RAM: [][2]uint32{{7765156, 235}, {7765157, 18}, {7765158, 164}, {7765159, 72}, {7765160, 57}, {7765161, 192}},
			},
		},
		{
			name: "1500 ROXL.b 3, D4 e714",
			init: cpuState{
				D:   [8]uint32{2250556733, 1108186524, 136058335, 149028049, 2397235179, 1494275585, 3376126119, 3381913241},
				A:   [7]uint32{3967767348, 2556901511, 2012171021, 3051736555, 175789468, 758678020, 1992090082},
				PC:  3743484,
				SR:  1801,
				USP: 10316696,
				SSP: 8784560,
				RAM: [][2]uint32{{3743480, 231}, {3743481, 20}, {3743482, 26}, {3743483, 62}, {3743484, 156}, {3743485, 228}},
			},
			want: cpuState{
				D:   [8]uint32{2250556733, 1108186524, 136058335, 149028049, 2397235035, 1494275585, 3376126119, 3381913241},
				A:   [7]uint32{3967767348, 2556901511, 2012171021, 3051736555, 175789468, 758678020, 1992090082},
				PC:  3743486,
				SR:  1809,
				USP: 10316696,
				SSP: 8784560,
				RAM: [][2]uint32{{3743480, 231}, {3743481, 20}, {3743482, 26}, {3743483, 62}, {3743484, 156}, {3743485, 228}},
			},
		},
		{
			name: "2000 ROXL.b D2, D4 e534",
			init: cpuState{
				D:   [8]uint32{966613784, 807093539, 2092037604, 3669418517, 294050891, 4251739016, 247392496, 3746769542},
				A:   [7]uint32{2045043652, 718564768, 3858617924, 796278877, 2031918634, 1289925528, 606721971},
				PC:  8498152,
				SR:  42014,
				USP: 13622492,
				SSP: 14624870,
				RAM: [][2]uint32{{8498148, 229}, {8498149, 52}, {8498150, 17}, {8498151, 180}, {8498152, 60}, {8498153, 228}},
			},
			want: cpuState{
				D:   [8]uint32{966613784, 807093539, 2092037604, 3669418517, 294050891, 4251739016, 247392496, 3746769542},
				A:   [7]uint32{2045043652, 718564768, 3858617924, 796278877, 2031918634, 1289925528, 606721971},
				PC:  8498154,
				SR:  42001,
				USP: 13622492,
				SSP: 14624870,
				RAM: [][2]uint32{{8498148, 229}, {8498149, 52}, {8498150, 17}, {8498151, 180}, {8498152, 60}, {8498153, 228}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXL_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXL.w (d8, A2, Xn) e5f2",
			init: cpuState{
				D:   [8]uint32{2260854261, 341931546, 4203190097, 1774206491, 2532021109, 3422268167, 1197923652, 1256044278},
				A:   [7]uint32{3905986971, 1208596659, 2938361544, 2566779843, 2038703801, 3313804409, 2021619634},
				PC:  9117226,
				SR:  33804,
				USP: 12746910,
				SSP: 6791436,
				RAM: [][2]uint32{{9117222, 229}, {9117223, 242}, {9117224, 50}, {9117225, 197}, {9117226, 140}, {9117227, 98}, {2364584, 113}, {2364585, 127}, {9117228, 80}, {9117229, 11}},
			},
			want: cpuState{
				D:   [8]uint32{2260854261, 341931546, 4203190097, 1774206491, 2532021109, 3422268167, 1197923652, 1256044278},
				A:   [7]uint32{3905986971, 1208596659, 2938361544, 2566779843, 2038703801, 3313804409, 2021619634},
				PC:  9117230,
				SR:  33800,
				USP: 12746910,
				SSP: 6791436,
				RAM: [][2]uint32{{9117222, 229}, {9117223, 242}, {9117224, 50}, {9117225, 197}, {9117226, 140}, {9117227, 98}, {2364584, 226}, {2364585, 254}, {9117228, 80}, {9117229, 11}},
			},
		},
		{
			name: "500 ROXL.w 1, D2 e352",
			init: cpuState{
				D:   [8]uint32{19006894, 139792824, 2639858346, 2479695353, 1169619254, 3202944219, 662638222, 314117980},
				A:   [7]uint32{2872338218, 2634855286, 4270673978, 3703050614, 1189006450, 2260499704, 1478739966},
				PC:  7707504,
				SR:  41222,
				USP: 10774420,
				SSP: 625222,
				RAM: [][2]uint32{{7707500, 227}, {7707501, 82}, {7707502, 141}, {7707503, 126}, {7707504, 146}, {7707505, 248}},
			},
			want: cpuState{
				D:   [8]uint32{19006894, 139792824, 2639861076, 2479695353, 1169619254, 3202944219, 662638222, 314117980},
				A:   [7]uint32{2872338218, 2634855286, 4270673978, 3703050614, 1189006450, 2260499704, 1478739966},
				PC:  7707506,
				SR:  41216,
				USP: 10774420,
				SSP: 625222,
				RAM: [][2]uint32{{7707500, 227}, {7707501, 82}, {7707502, 141}, {7707503, 126}, {7707504, 146}, {7707505, 248}},
			},
		},
		{
			name: "1000 ROXL.w (A1)+ e5d9",
			init: cpuState{
				D:   [8]uint32{2176612331, 96201356, 1534010296, 4246056514, 2620412292, 1417509671, 4187354789, 4245779424},
				A:   [7]uint32{3841498265, 832564752, 329220317, 3699958165, 67276528, 1912995784, 1611943523},
				PC:  2648216,
				SR:  42524,
				USP: 3842098,
				SSP: 10442976,
				RAM: [][2]uint32{{2648212, 229}, {2648213, 217}, {2648214, 34}, {2648215, 197}, {10481168, 159}, {10481169, 173}, {2648216, 20}, {2648217, 104}},
			},
			want: cpuState{
				D:   [8]uint32{2176612331, 96201356, 1534010296, 4246056514, 2620412292, 1417509671, 4187354789, 4245779424},
				A:   [7]uint32{3841498265, 832564754, 329220317, 3699958165, 67276528, 1912995784, 1611943523},
				PC:  2648218,
				SR:  42513,
				USP: 3842098,
				SSP: 10442976,
				RAM: [][2]uint32{{2648212, 229}, {2648213, 217}, {2648214, 34}, {2648215, 197}, {10481168, 63}, {10481169, 91}, {2648216, 20}, {2648217, 104}},
			},
		},
		{
			name: "1500 ROXL.w (A5)+ e5dd",
			init: cpuState{
				D:   [8]uint32{1043140595, 4099151639, 783687567, 3892952963, 3313054071, 3905970271, 1787457655, 1272970525},
				A:   [7]uint32{463727686, 908548641, 2316848092, 1003663432, 3807411628, 3703170354, 3743949034},
				PC:  280788,
				SR:  799,
				USP: 2235886,
				SSP: 2692210,
				RAM: [][2]uint32{{280784, 229}, {280785, 221}, {280786, 20}, {280787, 47}, {12182834, 25}, {12182835, 196}, {280788, 244}, {280789, 102}},
			},
			want: cpuState{
				D:   [8]uint32{1043140595, 4099151639, 783687567, 3892952963, 3313054071, 3905970271, 1787457655, 1272970525},
				A:   [7]uint32{463727686, 908548641, 2316848092, 1003663432, 3807411628, 3703170356, 3743949034},
				PC:  280790,
				SR:  768,
				USP: 2235886,
				SSP: 2692210,
				RAM: [][2]uint32{{280784, 229}, {280785, 221}, {280786, 20}, {280787, 47}, {12182834, 51}, {12182835, 137}, {280788, 244}, {280789, 102}},
			},
		},
		{
			name: "2000 ROXL.w 7, D6 ef56",
			init: cpuState{
				D:   [8]uint32{2167312407, 221674835, 3222412609, 2031339348, 1936825596, 3673488182, 2366085503, 2450349549},
				A:   [7]uint32{2932800989, 3885046712, 245947825, 1776056193, 4098679327, 1994461401, 658971659},
				PC:  1129394,
				SR:  34056,
				USP: 5318992,
				SSP: 6132604,
				RAM: [][2]uint32{{1129390, 239}, {1129391, 86}, {1129392, 67}, {1129393, 66}, {1129394, 251}, {1129395, 55}},
			},
			want: cpuState{
				D:   [8]uint32{2167312407, 221674835, 3222412609, 2031339348, 1936825596, 3673488182, 2366095270, 2450349549},
				A:   [7]uint32{2932800989, 3885046712, 245947825, 1776056193, 4098679327, 1994461401, 658971659},
				PC:  1129396,
				SR:  34056,
				USP: 5318992,
				SSP: 6132604,
				RAM: [][2]uint32{{1129390, 239}, {1129391, 86}, {1129392, 67}, {1129393, 66}, {1129394, 251}, {1129395, 55}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXL_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXL.l 3, D1 e791",
			init: cpuState{
				D:   [8]uint32{250172579, 1789076768, 773868069, 3443113245, 3317264784, 3546499369, 4130257380, 2442970974},
				A:   [7]uint32{1162712535, 1665159052, 3523798496, 3831773315, 2096837057, 2638812258, 654807390},
				PC:  8523922,
				SR:  10004,
				USP: 14666150,
				SSP: 16038206,
				RAM: [][2]uint32{{8523918, 231}, {8523919, 145}, {8523920, 102}, {8523921, 24}, {8523922, 150}, {8523923, 164}},
			},
			want: cpuState{
				D:   [8]uint32{250172579, 1427712261, 773868069, 3443113245, 3317264784, 3546499369, 4130257380, 2442970974},
				A:   [7]uint32{1162712535, 1665159052, 3523798496, 3831773315, 2096837057, 2638812258, 654807390},
				PC:  8523924,
				SR:  10001,
				USP: 14666150,
				SSP: 16038206,
				RAM: [][2]uint32{{8523918, 231}, {8523919, 145}, {8523920, 102}, {8523921, 24}, {8523922, 150}, {8523923, 164}},
			},
		},
		{
			name: "500 ROXL.l 4, D2 e992",
			init: cpuState{
				D:   [8]uint32{1973857222, 971621610, 483869836, 1833573508, 4114988816, 1441797307, 2160162247, 522922289},
				A:   [7]uint32{2837252878, 1790166901, 2116562903, 1885083660, 1243697417, 3034285637, 839381724},
				PC:  13117498,
				SR:  9739,
				USP: 12486540,
				SSP: 434550,
				RAM: [][2]uint32{{13117494, 233}, {13117495, 146}, {13117496, 22}, {13117497, 156}, {13117498, 131}, {13117499, 182}},
			},
			want: cpuState{
				D:   [8]uint32{1973857222, 971621610, 3446950080, 1833573508, 4114988816, 1441797307, 2160162247, 522922289},
				A:   [7]uint32{2837252878, 1790166901, 2116562903, 1885083660, 1243697417, 3034285637, 839381724},
				PC:  13117500,
				SR:  9753,
				USP: 12486540,
				SSP: 434550,
				RAM: [][2]uint32{{13117494, 233}, {13117495, 146}, {13117496, 22}, {13117497, 156}, {13117498, 131}, {13117499, 182}},
			},
		},
		{
			name: "1000 ROXL.l D2, D1 e5b1",
			init: cpuState{
				D:   [8]uint32{3771006633, 2695932164, 25762246, 652820173, 390127260, 3053138718, 2426087494, 1270238972},
				A:   [7]uint32{2391973038, 2838542898, 1964762418, 1821933371, 1967725165, 3220987633, 2102752118},
				PC:  8625472,
				SR:  1041,
				USP: 2290916,
				SSP: 8648726,
				RAM: [][2]uint32{{8625468, 229}, {8625469, 177}, {8625470, 138}, {8625471, 3}, {8625472, 11}, {8625473, 32}},
			},
			want: cpuState{
				D:   [8]uint32{3771006633, 740966708, 25762246, 652820173, 390127260, 3053138718, 2426087494, 1270238972},
				A:   [7]uint32{2391973038, 2838542898, 1964762418, 1821933371, 1967725165, 3220987633, 2102752118},
				PC:  8625474,
				SR:  1024,
				USP: 2290916,
				SSP: 8648726,
				RAM: [][2]uint32{{8625468, 229}, {8625469, 177}, {8625470, 138}, {8625471, 3}, {8625472, 11}, {8625473, 32}},
			},
		},
		{
			name: "1500 ROXL.l 2, D1 e591",
			init: cpuState{
				D:   [8]uint32{1043996094, 2582379947, 976545337, 1343690714, 3160670234, 4179755843, 88441740, 3384814374},
				A:   [7]uint32{1490861505, 4216224005, 2744127276, 2437567382, 1022677313, 1769890373, 2622470028},
				PC:  11377020,
				SR:  1540,
				USP: 16058410,
				SSP: 4366278,
				RAM: [][2]uint32{{11377016, 229}, {11377017, 145}, {11377018, 86}, {11377019, 252}, {11377020, 165}, {11377021, 177}},
			},
			want: cpuState{
				D:   [8]uint32{1043996094, 1739585197, 976545337, 1343690714, 3160670234, 4179755843, 88441740, 3384814374},
				A:   [7]uint32{1490861505, 4216224005, 2744127276, 2437567382, 1022677313, 1769890373, 2622470028},
				PC:  11377022,
				SR:  1536,
				USP: 16058410,
				SSP: 4366278,
				RAM: [][2]uint32{{11377016, 229}, {11377017, 145}, {11377018, 86}, {11377019, 252}, {11377020, 165}, {11377021, 177}},
			},
		},
		{
			name: "2000 ROXL.l 6, D1 ed91",
			init: cpuState{
				D:   [8]uint32{3727087683, 1666963230, 189962920, 1909390621, 4261032401, 858137925, 2379929508, 3062294540},
				A:   [7]uint32{4244197686, 2455071432, 2390974171, 1517016648, 3380750288, 1506926545, 329034429},
				PC:  8054890,
				SR:  8730,
				USP: 16544290,
				SSP: 6557420,
				RAM: [][2]uint32{{8054886, 237}, {8054887, 145}, {8054888, 239}, {8054889, 233}, {8054890, 206}, {8054891, 204}},
			},
			want: cpuState{
				D:   [8]uint32{3727087683, 3606431660, 189962920, 1909390621, 4261032401, 858137925, 2379929508, 3062294540},
				A:   [7]uint32{4244197686, 2455071432, 2390974171, 1517016648, 3380750288, 1506926545, 329034429},
				PC:  8054892,
				SR:  8712,
				USP: 16544290,
				SSP: 6557420,
				RAM: [][2]uint32{{8054886, 237}, {8054887, 145}, {8054888, 239}, {8054889, 233}, {8054890, 206}, {8054891, 204}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXR_B(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXR.b D6, D1 ec31",
			init: cpuState{
				D:   [8]uint32{3623841440, 3198346320, 3386104119, 552690540, 4112752369, 2557529842, 1599728174, 1542238217},
				A:   [7]uint32{2158505195, 4052486220, 3152230173, 3850791191, 2370211014, 797637923, 2900650829},
				PC:  2163592,
				SR:  34306,
				USP: 4168450,
				SSP: 5012426,
				RAM: [][2]uint32{{2163588, 236}, {2163589, 49}, {2163590, 3}, {2163591, 63}, {2163592, 235}, {2163593, 177}},
			},
			want: cpuState{
				D:   [8]uint32{3623841440, 3198346280, 3386104119, 552690540, 4112752369, 2557529842, 1599728174, 1542238217},
				A:   [7]uint32{2158505195, 4052486220, 3152230173, 3850791191, 2370211014, 797637923, 2900650829},
				PC:  2163594,
				SR:  34304,
				USP: 4168450,
				SSP: 5012426,
				RAM: [][2]uint32{{2163588, 236}, {2163589, 49}, {2163590, 3}, {2163591, 63}, {2163592, 235}, {2163593, 177}},
			},
		},
		{
			name: "500 ROXR.b D4, D2 e832",
			init: cpuState{
				D:   [8]uint32{2782092444, 1222931083, 125472372, 3740530196, 796986648, 1634791739, 295085813, 1755345360},
				A:   [7]uint32{3303530064, 1926887908, 1304377090, 3398061506, 1165681538, 202488961, 2184507226},
				PC:  12746844,
				SR:  32798,
				USP: 474720,
				SSP: 16441932,
				RAM: [][2]uint32{{12746840, 232}, {12746841, 50}, {12746842, 223}, {12746843, 137}, {12746844, 14}, {12746845, 51}},
			},
			want: cpuState{
				D:   [8]uint32{2782092444, 1222931083, 125472421, 3740530196, 796986648, 1634791739, 295085813, 1755345360},
				A:   [7]uint32{3303530064, 1926887908, 1304377090, 3398061506, 1165681538, 202488961, 2184507226},
				PC:  12746846,
				SR:  32793,
				USP: 474720,
				SSP: 16441932,
				RAM: [][2]uint32{{12746840, 232}, {12746841, 50}, {12746842, 223}, {12746843, 137}, {12746844, 14}, {12746845, 51}},
			},
		},
		{
			name: "1000 ROXR.b D3, D7 e637",
			init: cpuState{
				D:   [8]uint32{1572493933, 1242746703, 2481842060, 3635134446, 3657187483, 2695904608, 3549775083, 1170509925},
				A:   [7]uint32{4176440638, 3632635470, 4214317626, 3987812813, 2698570862, 2071806792, 1048228260},
				PC:  2424474,
				SR:  34571,
				USP: 4322576,
				SSP: 13112656,
				RAM: [][2]uint32{{2424470, 230}, {2424471, 55}, {2424472, 241}, {2424473, 61}, {2424474, 212}, {2424475, 159}},
			},
			want: cpuState{
				D:   [8]uint32{1572493933, 1242746703, 2481842060, 3635134446, 3657187483, 2695904608, 3549775083, 1170509874},
				A:   [7]uint32{4176440638, 3632635470, 4214317626, 3987812813, 2698570862, 2071806792, 1048228260},
				PC:  2424476,
				SR:  34577,
				USP: 4322576,
				SSP: 13112656,
				RAM: [][2]uint32{{2424470, 230}, {2424471, 55}, {2424472, 241}, {2424473, 61}, {2424474, 212}, {2424475, 159}},
			},
		},
		{
			name: "1500 ROXR.b D2, D1 e431",
			init: cpuState{
				D:   [8]uint32{486877269, 1002087558, 990918967, 1468297591, 3375810292, 819847288, 2050381166, 2566453348},
				A:   [7]uint32{1406802376, 1635752358, 3352650593, 739460476, 3377594360, 4245348546, 185546116},
				PC:  561178,
				SR:  41244,
				USP: 9307870,
				SSP: 16508086,
				RAM: [][2]uint32{{561174, 228}, {561175, 49}, {561176, 181}, {561177, 146}, {561178, 185}, {561179, 71}},
			},
			want: cpuState{
				D:   [8]uint32{486877269, 1002087619, 990918967, 1468297591, 3375810292, 819847288, 2050381166, 2566453348},
				A:   [7]uint32{1406802376, 1635752358, 3352650593, 739460476, 3377594360, 4245348546, 185546116},
				PC:  561180,
				SR:  41224,
				USP: 9307870,
				SSP: 16508086,
				RAM: [][2]uint32{{561174, 228}, {561175, 49}, {561176, 181}, {561177, 146}, {561178, 185}, {561179, 71}},
			},
		},
		{
			name: "2000 ROXR.b 5, D2 ea12",
			init: cpuState{
				D:   [8]uint32{223056407, 860353106, 817485484, 444827187, 151254182, 1042365128, 4029887310, 2561820017},
				A:   [7]uint32{3428979474, 93286879, 2969653725, 321160559, 3099129752, 3281280617, 3496227334},
				PC:  4480148,
				SR:  33554,
				USP: 14648108,
				SSP: 4027144,
				RAM: [][2]uint32{{4480144, 234}, {4480145, 18}, {4480146, 51}, {4480147, 75}, {4480148, 120}, {4480149, 247}},
			},
			want: cpuState{
				D:   [8]uint32{223056407, 860353106, 817485517, 444827187, 151254182, 1042365128, 4029887310, 2561820017},
				A:   [7]uint32{3428979474, 93286879, 2969653725, 321160559, 3099129752, 3281280617, 3496227334},
				PC:  4480150,
				SR:  33544,
				USP: 14648108,
				SSP: 4027144,
				RAM: [][2]uint32{{4480144, 234}, {4480145, 18}, {4480146, 51}, {4480147, 75}, {4480148, 120}, {4480149, 247}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXR_W(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXR.w D5, D3 ea73",
			init: cpuState{
				D:   [8]uint32{1329190401, 4074480233, 2494030275, 1192897080, 2067964349, 803052390, 3116563677, 2507272080},
				A:   [7]uint32{1200746960, 452131595, 1074516939, 2457237458, 1042184640, 606830823, 2499500178},
				PC:  14299874,
				SR:  33040,
				USP: 3748690,
				SSP: 1797242,
				RAM: [][2]uint32{{14299870, 234}, {14299871, 115}, {14299872, 89}, {14299873, 132}, {14299874, 215}, {14299875, 61}},
			},
			want: cpuState{
				D:   [8]uint32{1329190401, 4074480233, 2494030275, 1192891043, 2067964349, 803052390, 3116563677, 2507272080},
				A:   [7]uint32{1200746960, 452131595, 1074516939, 2457237458, 1042184640, 606830823, 2499500178},
				PC:  14299876,
				SR:  33041,
				USP: 3748690,
				SSP: 1797242,
				RAM: [][2]uint32{{14299870, 234}, {14299871, 115}, {14299872, 89}, {14299873, 132}, {14299874, 215}, {14299875, 61}},
			},
		},
		{
			name: "500 ROXR.w 1, D0 e250",
			init: cpuState{
				D:   [8]uint32{2739142725, 551171465, 1640601694, 2138938118, 2295062151, 4264828930, 628095856, 3851909396},
				A:   [7]uint32{4186578439, 2820120422, 2363731840, 1542132239, 1305989900, 3525764322, 2389130332},
				PC:  8803538,
				SR:  9240,
				USP: 13059780,
				SSP: 1519332,
				RAM: [][2]uint32{{8803534, 226}, {8803535, 80}, {8803536, 218}, {8803537, 104}, {8803538, 243}, {8803539, 201}},
			},
			want: cpuState{
				D:   [8]uint32{2739175458, 551171465, 1640601694, 2138938118, 2295062151, 4264828930, 628095856, 3851909396},
				A:   [7]uint32{4186578439, 2820120422, 2363731840, 1542132239, 1305989900, 3525764322, 2389130332},
				PC:  8803540,
				SR:  9241,
				USP: 13059780,
				SSP: 1519332,
				RAM: [][2]uint32{{8803534, 226}, {8803535, 80}, {8803536, 218}, {8803537, 104}, {8803538, 243}, {8803539, 201}},
			},
		},
		{
			name: "1000 ROXR.w D3, D5 e675",
			init: cpuState{
				D:   [8]uint32{2700543425, 1982586405, 1448541508, 2033317950, 2978989195, 3856332278, 1339320691, 3288724805},
				A:   [7]uint32{945415922, 3370685326, 2355392031, 2511591159, 255544016, 3969967034, 932609138},
				PC:  15223484,
				SR:  32786,
				USP: 15018920,
				SSP: 16311494,
				RAM: [][2]uint32{{15223480, 230}, {15223481, 117}, {15223482, 40}, {15223483, 77}, {15223484, 22}, {15223485, 209}},
			},
			want: cpuState{
				D:   [8]uint32{2700543425, 1982586405, 1448541508, 2033317950, 2978989195, 3856301502, 1339320691, 3288724805},
				A:   [7]uint32{945415922, 3370685326, 2355392031, 2511591159, 255544016, 3969967034, 932609138},
				PC:  15223486,
				SR:  32785,
				USP: 15018920,
				SSP: 16311494,
				RAM: [][2]uint32{{15223480, 230}, {15223481, 117}, {15223482, 40}, {15223483, 77}, {15223484, 22}, {15223485, 209}},
			},
		},
		{
			name: "1500 ROXR.w -(A4) e4e4",
			init: cpuState{
				D:   [8]uint32{2947562698, 187237743, 3648254640, 919608884, 676476048, 3993767519, 4220853451, 2535512199},
				A:   [7]uint32{762023324, 3083915446, 3200088376, 364639124, 2437462145, 1723522478, 785132740},
				PC:  15975640,
				SR:  1555,
				USP: 12443036,
				SSP: 8106004,
				RAM: [][2]uint32{{15975636, 228}, {15975637, 228}, {15975638, 140}, {15975639, 149}, {12, 147}, {13, 90}, {14, 43}, {15, 172}, {5909420, 134}, {5909421, 103}, {5909422, 34}, {5909423, 243}},
			},
			want: cpuState{
				D:      [8]uint32{2947562698, 187237743, 3648254640, 919608884, 676476048, 3993767519, 4220853451, 2535512199},
				A:      [7]uint32{762023324, 3083915446, 3200088376, 364639124, 2437462143, 1723522478, 785132740},
				PC:     2472160176,
				SR:     9747,
				USP:    12443036,
				SSP:    8105990,
				RAM:    [][2]uint32{{15975636, 228}, {15975637, 228}, {15975638, 140}, {15975639, 149}, {8106002, 196}, {8106003, 216}, {8105998, 6}, {8105999, 19}, {8106000, 0}, {8106001, 243}, {8105996, 228}, {8105997, 228}, {8105994, 184}, {8105995, 127}, {8105990, 228}, {8105991, 241}, {8105992, 145}, {8105993, 72}, {12, 147}, {13, 90}, {14, 43}, {15, 172}, {5909420, 134}, {5909421, 103}, {5909422, 34}, {5909423, 243}},
				Halted: true,
			},
		},
		{
			name: "2000 ROXR.w (d8, A7, Xn) e4f7",
			init: cpuState{
				D:   [8]uint32{2221296205, 3249843068, 1099897860, 1255220298, 1013862620, 2157686022, 1556306772, 1186902100},
				A:   [7]uint32{1866948341, 3244963754, 889163861, 1299200919, 375758170, 4292992949, 3641432100},
				PC:  14017340,
				SR:  9234,
				USP: 1060988,
				SSP: 9879920,
				RAM: [][2]uint32{{14017336, 228}, {14017337, 247}, {14017338, 42}, {14017339, 55}, {14017340, 149}, {14017341, 49}, {12, 101}, {13, 162}, {14, 57}, {15, 64}, {10631488, 66}, {10631489, 61}, {10631490, 170}, {10631491, 20}},
			},
			want: cpuState{
				D:      [8]uint32{2221296205, 3249843068, 1099897860, 1255220298, 1013862620, 2157686022, 1556306772, 1186902100},
				A:      [7]uint32{1866948341, 3244963754, 889163861, 1299200919, 375758170, 4292992949, 3641432100},
				PC:     1705130308,
				SR:     9234,
				USP:    1060988,
				SSP:    9879906,
				RAM:    [][2]uint32{{14017336, 228}, {14017337, 247}, {14017338, 42}, {14017339, 55}, {14017340, 149}, {14017341, 49}, {9879918, 227}, {9879919, 58}, {9879914, 36}, {9879915, 18}, {9879916, 0}, {9879917, 213}, {9879912, 228}, {9879913, 247}, {9879910, 221}, {9879911, 171}, {9879906, 228}, {9879907, 245}, {9879908, 66}, {9879909, 37}, {12, 101}, {13, 162}, {14, 57}, {15, 64}, {10631488, 66}, {10631489, 61}, {10631490, 170}, {10631491, 20}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestROXR_L(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ROXR.l 2, D1 e491",
			init: cpuState{
				D:   [8]uint32{1626499950, 147021276, 1251612528, 1479115659, 2737996838, 2942975442, 1416156362, 3304479545},
				A:   [7]uint32{2914351705, 3084561235, 1112006070, 2808150222, 1688000459, 2420340494, 654370242},
				PC:  15965060,
				SR:  42251,
				USP: 8418114,
				SSP: 5936636,
				RAM: [][2]uint32{{15965056, 228}, {15965057, 145}, {15965058, 12}, {15965059, 33}, {15965060, 96}, {15965061, 120}},
			},
			want: cpuState{
				D:   [8]uint32{1626499950, 36755319, 1251612528, 1479115659, 2737996838, 2942975442, 1416156362, 3304479545},
				A:   [7]uint32{2914351705, 3084561235, 1112006070, 2808150222, 1688000459, 2420340494, 654370242},
				PC:  15965062,
				SR:  42240,
				USP: 8418114,
				SSP: 5936636,
				RAM: [][2]uint32{{15965056, 228}, {15965057, 145}, {15965058, 12}, {15965059, 33}, {15965060, 96}, {15965061, 120}},
			},
		},
		{
			name: "500 ROXR.l 5, D1 ea91",
			init: cpuState{
				D:   [8]uint32{217673091, 2047086554, 2827715803, 1397985621, 1082040501, 558223305, 3036396724, 2405679841},
				A:   [7]uint32{2426885075, 37792388, 3902575069, 1375239182, 2304328674, 1937238032, 2572089972},
				PC:  4088386,
				SR:  41987,
				USP: 3272914,
				SSP: 2540066,
				RAM: [][2]uint32{{4088382, 234}, {4088383, 145}, {4088384, 230}, {4088385, 87}, {4088386, 153}, {4088387, 95}},
			},
			want: cpuState{
				D:   [8]uint32{217673091, 2748326014, 2827715803, 1397985621, 1082040501, 558223305, 3036396724, 2405679841},
				A:   [7]uint32{2426885075, 37792388, 3902575069, 1375239182, 2304328674, 1937238032, 2572089972},
				PC:  4088388,
				SR:  42009,
				USP: 3272914,
				SSP: 2540066,
				RAM: [][2]uint32{{4088382, 234}, {4088383, 145}, {4088384, 230}, {4088385, 87}, {4088386, 153}, {4088387, 95}},
			},
		},
		{
			name: "1000 ROXR.l 3, D0 e690",
			init: cpuState{
				D:   [8]uint32{4258016937, 1686888417, 4064370312, 1905504411, 1811354974, 2448860787, 1961686684, 1985519408},
				A:   [7]uint32{383240575, 3188816768, 4101467563, 1054626229, 2018142216, 3923168104, 1373523313},
				PC:  13993818,
				SR:  10,
				USP: 6478126,
				SSP: 3343322,
				RAM: [][2]uint32{{13993814, 230}, {13993815, 144}, {13993816, 240}, {13993817, 18}, {13993818, 246}, {13993819, 73}},
			},
			want: cpuState{
				D:   [8]uint32{1605993941, 1686888417, 4064370312, 1905504411, 1811354974, 2448860787, 1961686684, 1985519408},
				A:   [7]uint32{383240575, 3188816768, 4101467563, 1054626229, 2018142216, 3923168104, 1373523313},
				PC:  13993820,
				SR:  0,
				USP: 6478126,
				SSP: 3343322,
				RAM: [][2]uint32{{13993814, 230}, {13993815, 144}, {13993816, 240}, {13993817, 18}, {13993818, 246}, {13993819, 73}},
			},
		},
		{
			name: "1500 ROXR.l 2, D3 e493",
			init: cpuState{
				D:   [8]uint32{2626493885, 3872568981, 2488597080, 3135332512, 3977031352, 76448100, 2531278970, 1131219027},
				A:   [7]uint32{2465585106, 3877281634, 1436145199, 1621472570, 1369017753, 1373026260, 3271330019},
				PC:  2358614,
				SR:  787,
				USP: 13678936,
				SSP: 3770536,
				RAM: [][2]uint32{{2358610, 228}, {2358611, 147}, {2358612, 116}, {2358613, 179}, {2358614, 50}, {2358615, 49}},
			},
			want: cpuState{
				D:   [8]uint32{2626493885, 3872568981, 2488597080, 1857574952, 3977031352, 76448100, 2531278970, 1131219027},
				A:   [7]uint32{2465585106, 3877281634, 1436145199, 1621472570, 1369017753, 1373026260, 3271330019},
				PC:  2358616,
				SR:  768,
				USP: 13678936,
				SSP: 3770536,
				RAM: [][2]uint32{{2358610, 228}, {2358611, 147}, {2358612, 116}, {2358613, 179}, {2358614, 50}, {2358615, 49}},
			},
		},
		{
			name: "2000 ROXR.l 6, D3 ec93",
			init: cpuState{
				D:   [8]uint32{4076003842, 444913946, 3551417328, 765155946, 676891064, 1824174519, 588451248, 2399082426},
				A:   [7]uint32{103345324, 2155767227, 2914944031, 2530526688, 3764854858, 1041764143, 1170845206},
				PC:  4074050,
				SR:  24,
				USP: 13157768,
				SSP: 12140022,
				RAM: [][2]uint32{{4074046, 236}, {4074047, 147}, {4074048, 118}, {4074049, 57}, {4074050, 209}, {4074051, 252}},
			},
			want: cpuState{
				D:   [8]uint32{4076003842, 444913946, 3551417328, 1421241705, 676891064, 1824174519, 588451248, 2399082426},
				A:   [7]uint32{103345324, 2155767227, 2914944031, 2530526688, 3764854858, 1041764143, 1170845206},
				PC:  4074052,
				SR:  17,
				USP: 13157768,
				SSP: 12140022,
				RAM: [][2]uint32{{4074046, 236}, {4074047, 147}, {4074048, 118}, {4074049, 57}, {4074050, 209}, {4074051, 252}},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}
