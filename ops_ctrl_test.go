package m68k

import "testing"

func TestNOP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{3852648315, 2469214665, 2500578360, 1291102260, 2316984846, 1285845352, 636284809, 3518498312},
				A:   [7]uint32{572706894, 3955165096, 2355699420, 1579637945, 2322612306, 3835716544, 1363046691},
				PC:  911852,
				SR:  777,
				USP: 7532898,
				SSP: 2766466,
				RAM: [][2]uint32{{911848, 78}, {911849, 113}, {911850, 216}, {911851, 176}, {911852, 50}, {911853, 107}},
			},
			want: cpuState{
				D:   [8]uint32{3852648315, 2469214665, 2500578360, 1291102260, 2316984846, 1285845352, 636284809, 3518498312},
				A:   [7]uint32{572706894, 3955165096, 2355699420, 1579637945, 2322612306, 3835716544, 1363046691},
				PC:  911854,
				SR:  777,
				USP: 7532898,
				SSP: 2766466,
				RAM: [][2]uint32{{911848, 78}, {911849, 113}, {911850, 216}, {911851, 176}, {911852, 50}, {911853, 107}},
				Cycles: 4,
			},
		},
		{
			name: "500 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{1336455012, 2302714532, 3681818393, 1720950761, 1367566374, 3193636926, 2978403133, 1741363449},
				A:   [7]uint32{3191439818, 3159619623, 152826693, 4266326721, 4196655592, 4235835338, 563791152},
				PC:  12486314,
				SR:  41239,
				USP: 13726848,
				SSP: 1860426,
				RAM: [][2]uint32{{12486310, 78}, {12486311, 113}, {12486312, 7}, {12486313, 6}, {12486314, 253}, {12486315, 18}},
			},
			want: cpuState{
				D:   [8]uint32{1336455012, 2302714532, 3681818393, 1720950761, 1367566374, 3193636926, 2978403133, 1741363449},
				A:   [7]uint32{3191439818, 3159619623, 152826693, 4266326721, 4196655592, 4235835338, 563791152},
				PC:  12486316,
				SR:  41239,
				USP: 13726848,
				SSP: 1860426,
				RAM: [][2]uint32{{12486310, 78}, {12486311, 113}, {12486312, 7}, {12486313, 6}, {12486314, 253}, {12486315, 18}},
				Cycles: 4,
			},
		},
		{
			name: "1000 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{3006569406, 2232358076, 2726035704, 2876765372, 2315095877, 3411150333, 1161860592, 339229040},
				A:   [7]uint32{2810486888, 4272451012, 2169616790, 1966267773, 2810133219, 1029785266, 2554366975},
				PC:  11986204,
				SR:  41241,
				USP: 9640712,
				SSP: 5212704,
				RAM: [][2]uint32{{11986200, 78}, {11986201, 113}, {11986202, 143}, {11986203, 101}, {11986204, 171}, {11986205, 211}},
			},
			want: cpuState{
				D:   [8]uint32{3006569406, 2232358076, 2726035704, 2876765372, 2315095877, 3411150333, 1161860592, 339229040},
				A:   [7]uint32{2810486888, 4272451012, 2169616790, 1966267773, 2810133219, 1029785266, 2554366975},
				PC:  11986206,
				SR:  41241,
				USP: 9640712,
				SSP: 5212704,
				RAM: [][2]uint32{{11986200, 78}, {11986201, 113}, {11986202, 143}, {11986203, 101}, {11986204, 171}, {11986205, 211}},
				Cycles: 4,
			},
		},
		{
			name: "1500 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{847813040, 1842730397, 228953195, 1141002121, 4024913238, 3810996081, 1430982421, 3218670678},
				A:   [7]uint32{320962809, 1899590097, 1193472526, 4039917568, 4004340175, 4078302743, 1644730669},
				PC:  7802208,
				SR:  42262,
				USP: 15477618,
				SSP: 6204940,
				RAM: [][2]uint32{{7802204, 78}, {7802205, 113}, {7802206, 74}, {7802207, 21}, {7802208, 84}, {7802209, 19}},
			},
			want: cpuState{
				D:   [8]uint32{847813040, 1842730397, 228953195, 1141002121, 4024913238, 3810996081, 1430982421, 3218670678},
				A:   [7]uint32{320962809, 1899590097, 1193472526, 4039917568, 4004340175, 4078302743, 1644730669},
				PC:  7802210,
				SR:  42262,
				USP: 15477618,
				SSP: 6204940,
				RAM: [][2]uint32{{7802204, 78}, {7802205, 113}, {7802206, 74}, {7802207, 21}, {7802208, 84}, {7802209, 19}},
				Cycles: 4,
			},
		},
		{
			name: "2000 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{4162527581, 3632244014, 998295343, 3181753239, 3133752483, 2790191184, 438977060, 2392276731},
				A:   [7]uint32{12214623, 1628527616, 3430659164, 324523237, 899492061, 1648972444, 4277930460},
				PC:  1602062,
				SR:  34583,
				USP: 8955260,
				SSP: 1393366,
				RAM: [][2]uint32{{1602058, 78}, {1602059, 113}, {1602060, 112}, {1602061, 3}, {1602062, 98}, {1602063, 164}},
			},
			want: cpuState{
				D:   [8]uint32{4162527581, 3632244014, 998295343, 3181753239, 3133752483, 2790191184, 438977060, 2392276731},
				A:   [7]uint32{12214623, 1628527616, 3430659164, 324523237, 899492061, 1648972444, 4277930460},
				PC:  1602064,
				SR:  34583,
				USP: 8955260,
				SSP: 1393366,
				RAM: [][2]uint32{{1602058, 78}, {1602059, 113}, {1602060, 112}, {1602061, 3}, {1602062, 98}, {1602063, 164}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSTOP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{2431338843, 1097904765, 2362176531, 2327491436, 738827858, 357731005, 2389080449, 2189612291},
				A:   [7]uint32{862186975, 1774396471, 3921212015, 584200441, 2740188619, 2431828463, 3150012923},
				PC:  15476508,
				SR:  34330,
				USP: 15728486,
				SSP: 3475004,
				RAM: [][2]uint32{{15476504, 78}, {15476505, 114}, {15476506, 64}, {15476507, 221}, {32, 246}, {33, 112}, {34, 176}, {35, 142}, {7385230, 113}, {7385231, 198}, {7385232, 106}, {7385233, 255}},
			},
			want: cpuState{
				D:   [8]uint32{2431338843, 1097904765, 2362176531, 2327491436, 738827858, 357731005, 2389080449, 2189612291},
				A:   [7]uint32{862186975, 1774396471, 3921212015, 584200441, 2740188619, 2431828463, 3150012923},
				PC:  4134580370,
				SR:  9754,
				USP: 15728486,
				SSP: 3474998,
				RAM: [][2]uint32{{15476504, 78}, {15476505, 114}, {15476506, 64}, {15476507, 221}, {3475002, 39}, {3475003, 24}, {3474998, 134}, {3474999, 26}, {3475000, 0}, {3475001, 236}, {32, 246}, {33, 112}, {34, 176}, {35, 142}, {7385230, 113}, {7385231, 198}, {7385232, 106}, {7385233, 255}},
				Cycles: 34,
			},
		},
		{
			name: "500 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{2293300723, 2293068375, 2219980699, 4134010048, 383926791, 336724185, 418174564, 2114976917},
				A:   [7]uint32{2519497349, 1033191247, 3962394934, 3277458397, 1795799622, 845262492, 1501317824},
				PC:  15926360,
				SR:  790,
				USP: 3227632,
				SSP: 3468940,
				RAM: [][2]uint32{{15926356, 78}, {15926357, 114}, {15926358, 195}, {15926359, 212}, {32, 223}, {33, 186}, {34, 59}, {35, 178}, {12204978, 201}, {12204979, 239}, {12204980, 38}, {12204981, 250}},
			},
			want: cpuState{
				D:   [8]uint32{2293300723, 2293068375, 2219980699, 4134010048, 383926791, 336724185, 418174564, 2114976917},
				A:   [7]uint32{2519497349, 1033191247, 3962394934, 3277458397, 1795799622, 845262492, 1501317824},
				PC:  3753524150,
				SR:  8982,
				USP: 3227632,
				SSP: 3468934,
				RAM: [][2]uint32{{15926356, 78}, {15926357, 114}, {15926358, 195}, {15926359, 212}, {3468938, 4}, {3468939, 84}, {3468934, 3}, {3468935, 22}, {3468936, 0}, {3468937, 243}, {32, 223}, {33, 186}, {34, 59}, {35, 178}, {12204978, 201}, {12204979, 239}, {12204980, 38}, {12204981, 250}},
				Cycles: 34,
			},
		},
		{
			name: "1000 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{4161490072, 2967035680, 4139398029, 1127778676, 931204473, 1638110565, 1307304841, 1695066405},
				A:   [7]uint32{1737925960, 264566957, 281403227, 2402577482, 555132621, 2038459281, 828420632},
				PC:  9500256,
				SR:  8732,
				USP: 4804292,
				SSP: 3968200,
				RAM: [][2]uint32{{9500252, 78}, {9500253, 114}, {9500254, 234}, {9500255, 226}},
			},
			want: cpuState{
				D:   [8]uint32{4161490072, 2967035680, 4139398029, 1127778676, 931204473, 1638110565, 1307304841, 1695066405},
				A:   [7]uint32{1737925960, 264566957, 281403227, 2402577482, 555132621, 2038459281, 828420632},
				PC:  9500256,
				SR:  41474,
				USP: 4804292,
				SSP: 3968200,
				RAM: [][2]uint32{{9500252, 78}, {9500253, 114}, {9500254, 234}, {9500255, 226}},
				Cycles: 4,
			},
		},
		{
			name: "1500 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{1118180056, 2665338183, 55072498, 2398139131, 2352297035, 1765471972, 3228607513, 1182551844},
				A:   [7]uint32{2059358690, 999278382, 380133883, 3247485375, 2336817838, 4258663509, 4294216192},
				PC:  8679948,
				SR:  9223,
				USP: 7451700,
				SSP: 2649760,
				RAM: [][2]uint32{{8679944, 78}, {8679945, 114}, {8679946, 17}, {8679947, 10}},
			},
			want: cpuState{
				D:   [8]uint32{1118180056, 2665338183, 55072498, 2398139131, 2352297035, 1765471972, 3228607513, 1182551844},
				A:   [7]uint32{2059358690, 999278382, 380133883, 3247485375, 2336817838, 4258663509, 4294216192},
				PC:  8679948,
				SR:  266,
				USP: 7451700,
				SSP: 2649760,
				RAM: [][2]uint32{{8679944, 78}, {8679945, 114}, {8679946, 17}, {8679947, 10}},
				Cycles: 4,
			},
		},
		{
			name: "2000 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{1869158809, 687611147, 1224139848, 578913751, 705175900, 1836570089, 2644151546, 405895282},
				A:   [7]uint32{3475827128, 983110730, 577110460, 3163451074, 231332277, 1164652995, 2470373850},
				PC:  9191230,
				SR:  33025,
				USP: 5609678,
				SSP: 11757382,
				RAM: [][2]uint32{{9191226, 78}, {9191227, 114}, {9191228, 97}, {9191229, 189}, {32, 17}, {33, 40}, {34, 16}, {35, 174}, {2625710, 185}, {2625711, 171}, {2625712, 38}, {2625713, 72}},
			},
			want: cpuState{
				D:   [8]uint32{1869158809, 687611147, 1224139848, 578913751, 705175900, 1836570089, 2644151546, 405895282},
				A:   [7]uint32{3475827128, 983110730, 577110460, 3163451074, 231332277, 1164652995, 2470373850},
				PC:  287838386,
				SR:  8449,
				USP: 5609678,
				SSP: 11757376,
				RAM: [][2]uint32{{9191226, 78}, {9191227, 114}, {9191228, 97}, {9191229, 189}, {11757380, 63}, {11757381, 58}, {11757376, 129}, {11757377, 1}, {11757378, 0}, {11757379, 140}, {32, 17}, {33, 40}, {34, 16}, {35, 174}, {2625710, 185}, {2625711, 171}, {2625712, 38}, {2625713, 72}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestRESET(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{1689175132, 835547661, 2786586489, 2380291742, 2111070254, 293396557, 930421946, 1136885942},
				A:   [7]uint32{2570742412, 3746892549, 3454825972, 899140581, 394677129, 4290643341, 2216700769},
				PC:  84888,
				SR:  1567,
				USP: 15076452,
				SSP: 3180312,
				RAM: [][2]uint32{{84884, 78}, {84885, 112}, {84886, 178}, {84887, 159}, {32, 91}, {33, 194}, {34, 61}, {35, 26}, {12729626, 242}, {12729627, 25}, {12729628, 230}, {12729629, 144}},
			},
			want: cpuState{
				D:   [8]uint32{1689175132, 835547661, 2786586489, 2380291742, 2111070254, 293396557, 930421946, 1136885942},
				A:   [7]uint32{2570742412, 3746892549, 3454825972, 899140581, 394677129, 4290643341, 2216700769},
				PC:  1539456286,
				SR:  9759,
				USP: 15076452,
				SSP: 3180306,
				RAM: [][2]uint32{{84884, 78}, {84885, 112}, {84886, 178}, {84887, 159}, {3180310, 75}, {3180311, 148}, {3180306, 6}, {3180307, 31}, {3180308, 0}, {3180309, 1}, {32, 91}, {33, 194}, {34, 61}, {35, 26}, {12729626, 242}, {12729627, 25}, {12729628, 230}, {12729629, 144}},
				Cycles: 34,
			},
		},
		{
			name: "500 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{28487665, 2050734023, 2354768233, 1642984892, 940369173, 1542833811, 2157741359, 474360759},
				A:   [7]uint32{3004361879, 208496331, 3494848221, 1888259145, 3392049140, 3780682710, 128899296},
				PC:  5406440,
				SR:  33289,
				USP: 14163960,
				SSP: 12514956,
				RAM: [][2]uint32{{5406436, 78}, {5406437, 112}, {5406438, 223}, {5406439, 13}, {32, 60}, {33, 76}, {34, 101}, {35, 18}, {5006610, 251}, {5006611, 2}, {5006612, 236}, {5006613, 218}},
			},
			want: cpuState{
				D:   [8]uint32{28487665, 2050734023, 2354768233, 1642984892, 940369173, 1542833811, 2157741359, 474360759},
				A:   [7]uint32{3004361879, 208496331, 3494848221, 1888259145, 3392049140, 3780682710, 128899296},
				PC:  1011639574,
				SR:  8713,
				USP: 14163960,
				SSP: 12514950,
				RAM: [][2]uint32{{5406436, 78}, {5406437, 112}, {5406438, 223}, {5406439, 13}, {12514954, 126}, {12514955, 228}, {12514950, 130}, {12514951, 9}, {12514952, 0}, {12514953, 82}, {32, 60}, {33, 76}, {34, 101}, {35, 18}, {5006610, 251}, {5006611, 2}, {5006612, 236}, {5006613, 218}},
				Cycles: 34,
			},
		},
		{
			name: "1000 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{2265348804, 1596147637, 383048715, 37277271, 1437798982, 980935211, 2007675570, 620801442},
				A:   [7]uint32{595937128, 460744551, 2096861165, 120349356, 4017536328, 1771932188, 1527964789},
				PC:  11314768,
				SR:  33310,
				USP: 14513030,
				SSP: 9533918,
				RAM: [][2]uint32{{11314764, 78}, {11314765, 112}, {11314766, 225}, {11314767, 176}, {32, 246}, {33, 236}, {34, 54}, {35, 112}, {15480432, 142}, {15480433, 242}, {15480434, 172}, {15480435, 142}},
			},
			want: cpuState{
				D:   [8]uint32{2265348804, 1596147637, 383048715, 37277271, 1437798982, 980935211, 2007675570, 620801442},
				A:   [7]uint32{595937128, 460744551, 2096861165, 120349356, 4017536328, 1771932188, 1527964789},
				PC:  4142675572,
				SR:  8734,
				USP: 14513030,
				SSP: 9533912,
				RAM: [][2]uint32{{11314764, 78}, {11314765, 112}, {11314766, 225}, {11314767, 176}, {9533916, 166}, {9533917, 76}, {9533912, 130}, {9533913, 30}, {9533914, 0}, {9533915, 172}, {32, 246}, {33, 236}, {34, 54}, {35, 112}, {15480432, 142}, {15480433, 242}, {15480434, 172}, {15480435, 142}},
				Cycles: 34,
			},
		},
		{
			name: "1500 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{3341308448, 2576302347, 1907515448, 3901988102, 2770749136, 845184847, 2850197657, 2605769444},
				A:   [7]uint32{2523543807, 2274872486, 3837892829, 3471926591, 1188673552, 4068495178, 2604623378},
				PC:  4425260,
				SR:  1032,
				USP: 1394764,
				SSP: 7870852,
				RAM: [][2]uint32{{4425256, 78}, {4425257, 112}, {4425258, 85}, {4425259, 102}, {32, 122}, {33, 86}, {34, 71}, {35, 226}, {5654498, 114}, {5654499, 90}, {5654500, 165}, {5654501, 70}},
			},
			want: cpuState{
				D:   [8]uint32{3341308448, 2576302347, 1907515448, 3901988102, 2770749136, 845184847, 2850197657, 2605769444},
				A:   [7]uint32{2523543807, 2274872486, 3837892829, 3471926591, 1188673552, 4068495178, 2604623378},
				PC:  2052474854,
				SR:  9224,
				USP: 1394764,
				SSP: 7870846,
				RAM: [][2]uint32{{4425256, 78}, {4425257, 112}, {4425258, 85}, {4425259, 102}, {7870850, 134}, {7870851, 40}, {7870846, 4}, {7870847, 8}, {7870848, 0}, {7870849, 67}, {32, 122}, {33, 86}, {34, 71}, {35, 226}, {5654498, 114}, {5654499, 90}, {5654500, 165}, {5654501, 70}},
				Cycles: 34,
			},
		},
		{
			name: "2000 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{628537874, 3900881044, 3289808271, 793024783, 1704272646, 1381844294, 1236944637, 4271301022},
				A:   [7]uint32{1094226903, 2032861992, 4017181522, 2291738218, 477098048, 3999832087, 603902054},
				PC:  5845866,
				SR:  34050,
				USP: 4222710,
				SSP: 11433686,
				RAM: [][2]uint32{{5845862, 78}, {5845863, 112}, {5845864, 232}, {5845865, 101}, {32, 255}, {33, 22}, {34, 254}, {35, 248}, {1507064, 214}, {1507065, 109}, {1507066, 189}, {1507067, 208}},
			},
			want: cpuState{
				D:   [8]uint32{628537874, 3900881044, 3289808271, 793024783, 1704272646, 1381844294, 1236944637, 4271301022},
				A:   [7]uint32{1094226903, 2032861992, 4017181522, 2291738218, 477098048, 3999832087, 603902054},
				PC:  4279697148,
				SR:  9474,
				USP: 4222710,
				SSP: 11433680,
				RAM: [][2]uint32{{5845862, 78}, {5845863, 112}, {5845864, 232}, {5845865, 101}, {11433684, 51}, {11433685, 102}, {11433680, 133}, {11433681, 2}, {11433682, 0}, {11433683, 89}, {32, 255}, {33, 22}, {34, 254}, {35, 248}, {1507064, 214}, {1507065, 109}, {1507066, 189}, {1507067, 208}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTRAP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TRAP 8 4e48",
			init: cpuState{
				D:   [8]uint32{3400333495, 711917462, 730326889, 2934301075, 1530823477, 3055452475, 2560220869, 2227894313},
				A:   [7]uint32{926492777, 3219346398, 2157483417, 2220865159, 4261461242, 2400926708, 826610775},
				PC:  8064466,
				SR:  8974,
				USP: 14898600,
				SSP: 3008530,
				RAM: [][2]uint32{{8064462, 78}, {8064463, 72}, {8064464, 152}, {8064465, 127}, {160, 166}, {161, 4}, {162, 10}, {163, 66}, {264770, 17}, {264771, 89}, {264772, 215}, {264773, 187}},
			},
			want: cpuState{
				D:   [8]uint32{3400333495, 711917462, 730326889, 2934301075, 1530823477, 3055452475, 2560220869, 2227894313},
				A:   [7]uint32{926492777, 3219346398, 2157483417, 2220865159, 4261461242, 2400926708, 826610775},
				PC:  2785282630,
				SR:  8974,
				USP: 14898600,
				SSP: 3008524,
				RAM: [][2]uint32{{8064462, 78}, {8064463, 72}, {8064464, 152}, {8064465, 127}, {3008528, 13}, {3008529, 208}, {3008524, 35}, {3008525, 14}, {3008526, 0}, {3008527, 123}, {160, 166}, {161, 4}, {162, 10}, {163, 66}, {264770, 17}, {264771, 89}, {264772, 215}, {264773, 187}},
				Cycles: 34,
			},
		},
		{
			name: "500 TRAP 2 4e42",
			init: cpuState{
				D:   [8]uint32{1679614333, 2359782989, 3219251868, 1063543416, 1992279873, 3717036528, 1549251524, 3495036937},
				A:   [7]uint32{2433740168, 1568520618, 2986272204, 4253341984, 2021032386, 2561418641, 1228501344},
				PC:  7768868,
				SR:  9478,
				USP: 1473424,
				SSP: 12778400,
				RAM: [][2]uint32{{7768864, 78}, {7768865, 66}, {7768866, 54}, {7768867, 83}, {136, 235}, {137, 40}, {138, 140}, {139, 56}, {2657336, 153}, {2657337, 203}, {2657338, 108}, {2657339, 115}},
			},
			want: cpuState{
				D:   [8]uint32{1679614333, 2359782989, 3219251868, 1063543416, 1992279873, 3717036528, 1549251524, 3495036937},
				A:   [7]uint32{2433740168, 1568520618, 2986272204, 4253341984, 2021032386, 2561418641, 1228501344},
				PC:  3945303100,
				SR:  9478,
				USP: 1473424,
				SSP: 12778394,
				RAM: [][2]uint32{{7768864, 78}, {7768865, 66}, {7768866, 54}, {7768867, 83}, {12778398, 139}, {12778399, 34}, {12778394, 37}, {12778395, 6}, {12778396, 0}, {12778397, 118}, {136, 235}, {137, 40}, {138, 140}, {139, 56}, {2657336, 153}, {2657337, 203}, {2657338, 108}, {2657339, 115}},
				Cycles: 34,
			},
		},
		{
			name: "1000 TRAP 8 4e48",
			init: cpuState{
				D:   [8]uint32{3446961099, 193540034, 159924918, 2696007030, 3342571856, 3903517070, 2274516600, 1205340482},
				A:   [7]uint32{3424574180, 1823725248, 2609013569, 1296030557, 1220596114, 2309768079, 3704290502},
				PC:  11051542,
				SR:  42759,
				USP: 14660814,
				SSP: 9306784,
				RAM: [][2]uint32{{11051538, 78}, {11051539, 72}, {11051540, 196}, {11051541, 91}, {160, 128}, {161, 106}, {162, 255}, {163, 130}, {7012226, 39}, {7012227, 219}, {7012228, 204}, {7012229, 180}},
			},
			want: cpuState{
				D:   [8]uint32{3446961099, 193540034, 159924918, 2696007030, 3342571856, 3903517070, 2274516600, 1205340482},
				A:   [7]uint32{3424574180, 1823725248, 2609013569, 1296030557, 1220596114, 2309768079, 3704290502},
				PC:  2154495878,
				SR:  9991,
				USP: 14660814,
				SSP: 9306778,
				RAM: [][2]uint32{{11051538, 78}, {11051539, 72}, {11051540, 196}, {11051541, 91}, {9306782, 162}, {9306783, 20}, {9306778, 167}, {9306779, 7}, {9306780, 0}, {9306781, 168}, {160, 128}, {161, 106}, {162, 255}, {163, 130}, {7012226, 39}, {7012227, 219}, {7012228, 204}, {7012229, 180}},
				Cycles: 34,
			},
		},
		{
			name: "1500 TRAP 3 4e43",
			init: cpuState{
				D:   [8]uint32{896511014, 704384683, 3910157805, 2443727979, 603959670, 305947599, 1621730639, 1562038905},
				A:   [7]uint32{2786417136, 152283042, 1757314785, 362943200, 547065631, 2226077757, 2031870671},
				PC:  13907832,
				SR:  9501,
				USP: 6288736,
				SSP: 9374604,
				RAM: [][2]uint32{{13907828, 78}, {13907829, 67}, {13907830, 177}, {13907831, 44}, {140, 209}, {141, 146}, {142, 163}, {143, 130}, {9610114, 201}, {9610115, 208}, {9610116, 98}, {9610117, 57}},
			},
			want: cpuState{
				D:   [8]uint32{896511014, 704384683, 3910157805, 2443727979, 603959670, 305947599, 1621730639, 1562038905},
				A:   [7]uint32{2786417136, 152283042, 1757314785, 362943200, 547065631, 2226077757, 2031870671},
				PC:  3516048262,
				SR:  9501,
				USP: 6288736,
				SSP: 9374598,
				RAM: [][2]uint32{{13907828, 78}, {13907829, 67}, {13907830, 177}, {13907831, 44}, {9374602, 55}, {9374603, 118}, {9374598, 37}, {9374599, 29}, {9374600, 0}, {9374601, 212}, {140, 209}, {141, 146}, {142, 163}, {143, 130}, {9610114, 201}, {9610115, 208}, {9610116, 98}, {9610117, 57}},
				Cycles: 34,
			},
		},
		{
			name: "2000 TRAP 12 4e4c",
			init: cpuState{
				D:   [8]uint32{288500413, 2526453671, 1977368341, 2039397001, 676870710, 3112685511, 3952460997, 1861251198},
				A:   [7]uint32{2898323078, 4024296936, 1437627507, 3921317273, 305478651, 3223067646, 658626944},
				PC:  5071936,
				SR:  9757,
				USP: 7732984,
				SSP: 5308328,
				RAM: [][2]uint32{{5071932, 78}, {5071933, 76}, {5071934, 30}, {5071935, 97}, {176, 34}, {177, 218}, {178, 56}, {179, 146}, {14301330, 96}, {14301331, 0}, {14301332, 244}, {14301333, 201}},
			},
			want: cpuState{
				D:   [8]uint32{288500413, 2526453671, 1977368341, 2039397001, 676870710, 3112685511, 3952460997, 1861251198},
				A:   [7]uint32{2898323078, 4024296936, 1437627507, 3921317273, 305478651, 3223067646, 658626944},
				PC:  584726678,
				SR:  9757,
				USP: 7732984,
				SSP: 5308322,
				RAM: [][2]uint32{{5071932, 78}, {5071933, 76}, {5071934, 30}, {5071935, 97}, {5308326, 100}, {5308327, 62}, {5308322, 38}, {5308323, 29}, {5308324, 0}, {5308325, 77}, {176, 34}, {177, 218}, {178, 56}, {179, 146}, {14301330, 96}, {14301331, 0}, {14301332, 244}, {14301333, 201}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTRAPV(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{2592244591, 2787002533, 2642938220, 675103923, 2036456728, 3857080593, 110809242, 1802466737},
				A:   [7]uint32{4011914877, 2392146937, 2696781674, 2817160690, 1741577525, 3997636369, 955999827},
				PC:  12168452,
				SR:  1809,
				USP: 13193320,
				SSP: 16059230,
				RAM: [][2]uint32{{12168448, 78}, {12168449, 118}, {12168450, 240}, {12168451, 76}, {12168452, 60}, {12168453, 105}},
			},
			want: cpuState{
				D:   [8]uint32{2592244591, 2787002533, 2642938220, 675103923, 2036456728, 3857080593, 110809242, 1802466737},
				A:   [7]uint32{4011914877, 2392146937, 2696781674, 2817160690, 1741577525, 3997636369, 955999827},
				PC:  12168454,
				SR:  1809,
				USP: 13193320,
				SSP: 16059230,
				RAM: [][2]uint32{{12168448, 78}, {12168449, 118}, {12168450, 240}, {12168451, 76}, {12168452, 60}, {12168453, 105}},
				Cycles: 4,
			},
		},
		{
			name: "500 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{3062082596, 2404544466, 749350697, 1261614751, 3726798915, 2954900631, 1129584900, 2973822202},
				A:   [7]uint32{3949685775, 1022946272, 785713899, 2645274977, 2629961095, 2600597155, 4257909367},
				PC:  7278010,
				SR:  42766,
				USP: 10730560,
				SSP: 15981542,
				RAM: [][2]uint32{{7278006, 78}, {7278007, 118}, {7278008, 43}, {7278009, 144}, {7278010, 198}, {7278011, 95}, {28, 245}, {29, 128}, {30, 199}, {31, 56}, {8439608, 107}, {8439609, 184}, {8439610, 93}, {8439611, 27}},
			},
			want: cpuState{
				D:   [8]uint32{3062082596, 2404544466, 749350697, 1261614751, 3726798915, 2954900631, 1129584900, 2973822202},
				A:   [7]uint32{3949685775, 1022946272, 785713899, 2645274977, 2629961095, 2600597155, 4257909367},
				PC:  4118857532,
				SR:  9998,
				USP: 10730560,
				SSP: 15981536,
				RAM: [][2]uint32{{7278006, 78}, {7278007, 118}, {7278008, 43}, {7278009, 144}, {7278010, 198}, {7278011, 95}, {15981540, 13}, {15981541, 184}, {15981536, 167}, {15981537, 14}, {15981538, 0}, {15981539, 111}, {28, 245}, {29, 128}, {30, 199}, {31, 56}, {8439608, 107}, {8439609, 184}, {8439610, 93}, {8439611, 27}},
				Cycles: 34,
			},
		},
		{
			name: "1000 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{3100455719, 1023783056, 562803095, 806254233, 822568218, 3626572926, 255141507, 2073000651},
				A:   [7]uint32{997810819, 400821689, 1243148692, 2702450349, 2064365616, 4069627746, 3258122378},
				PC:  3031768,
				SR:  1290,
				USP: 525090,
				SSP: 13895078,
				RAM: [][2]uint32{{3031764, 78}, {3031765, 118}, {3031766, 94}, {3031767, 12}, {3031768, 69}, {3031769, 207}, {28, 24}, {29, 128}, {30, 194}, {31, 116}, {8438388, 6}, {8438389, 190}, {8438390, 145}, {8438391, 75}},
			},
			want: cpuState{
				D:   [8]uint32{3100455719, 1023783056, 562803095, 806254233, 822568218, 3626572926, 255141507, 2073000651},
				A:   [7]uint32{997810819, 400821689, 1243148692, 2702450349, 2064365616, 4069627746, 3258122378},
				PC:  411091576,
				SR:  9482,
				USP: 525090,
				SSP: 13895072,
				RAM: [][2]uint32{{3031764, 78}, {3031765, 118}, {3031766, 94}, {3031767, 12}, {3031768, 69}, {3031769, 207}, {13895076, 66}, {13895077, 214}, {13895072, 5}, {13895073, 10}, {13895074, 0}, {13895075, 46}, {28, 24}, {29, 128}, {30, 194}, {31, 116}, {8438388, 6}, {8438389, 190}, {8438390, 145}, {8438391, 75}},
				Cycles: 34,
			},
		},
		{
			name: "1500 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{2673964343, 2582140889, 709118635, 4180805742, 3105572487, 3048620871, 4149115966, 1976372684},
				A:   [7]uint32{915249755, 3796907194, 2081771776, 2429936304, 2656589147, 1955074663, 2087735529},
				PC:  13697928,
				SR:  8479,
				USP: 1503450,
				SSP: 8898192,
				RAM: [][2]uint32{{13697924, 78}, {13697925, 118}, {13697926, 185}, {13697927, 11}, {13697928, 14}, {13697929, 215}, {28, 234}, {29, 218}, {30, 154}, {31, 242}, {14326514, 6}, {14326515, 50}, {14326516, 222}, {14326517, 52}},
			},
			want: cpuState{
				D:   [8]uint32{2673964343, 2582140889, 709118635, 4180805742, 3105572487, 3048620871, 4149115966, 1976372684},
				A:   [7]uint32{915249755, 3796907194, 2081771776, 2429936304, 2656589147, 1955074663, 2087735529},
				PC:  3940195062,
				SR:  8479,
				USP: 1503450,
				SSP: 8898186,
				RAM: [][2]uint32{{13697924, 78}, {13697925, 118}, {13697926, 185}, {13697927, 11}, {13697928, 14}, {13697929, 215}, {8898190, 3}, {8898191, 134}, {8898186, 33}, {8898187, 31}, {8898188, 0}, {8898189, 209}, {28, 234}, {29, 218}, {30, 154}, {31, 242}, {14326514, 6}, {14326515, 50}, {14326516, 222}, {14326517, 52}},
				Cycles: 34,
			},
		},
		{
			name: "2000 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{1833439350, 3527021555, 3205786603, 177120317, 2766186662, 2535381078, 2228216839, 2555826855},
				A:   [7]uint32{2257055653, 3221374203, 59790653, 4004508242, 1192202828, 849310650, 392870113},
				PC:  11554178,
				SR:  1043,
				USP: 13796710,
				SSP: 9895634,
				RAM: [][2]uint32{{11554174, 78}, {11554175, 118}, {11554176, 52}, {11554177, 89}, {11554178, 31}, {11554179, 58}, {28, 151}, {29, 22}, {30, 114}, {31, 20}, {1470996, 7}, {1470997, 157}, {1470998, 78}, {1470999, 235}},
			},
			want: cpuState{
				D:   [8]uint32{1833439350, 3527021555, 3205786603, 177120317, 2766186662, 2535381078, 2228216839, 2555826855},
				A:   [7]uint32{2257055653, 3221374203, 59790653, 4004508242, 1192202828, 849310650, 392870113},
				PC:  2534830616,
				SR:  9235,
				USP: 13796710,
				SSP: 9895628,
				RAM: [][2]uint32{{11554174, 78}, {11554175, 118}, {11554176, 52}, {11554177, 89}, {11554178, 31}, {11554179, 58}, {9895632, 77}, {9895633, 128}, {9895628, 4}, {9895629, 19}, {9895630, 0}, {9895631, 176}, {28, 151}, {29, 22}, {30, 114}, {31, 20}, {1470996, 7}, {1470997, 157}, {1470998, 78}, {1470999, 235}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLINK(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LINK A1, # 4e51",
			init: cpuState{
				D:   [8]uint32{1549680510, 3529549349, 402953891, 2836331597, 3505705563, 595564642, 2848265625, 2797936031},
				A:   [7]uint32{918023106, 2344368855, 3956781094, 1306461531, 2621107024, 522755042, 756702087},
				PC:  5926566,
				SR:  34077,
				USP: 2919422,
				SSP: 6008204,
				RAM: [][2]uint32{{5926562, 78}, {5926563, 81}, {5926564, 83}, {5926565, 221}, {5926566, 68}, {5926567, 77}, {5926568, 169}, {5926569, 58}},
			},
			want: cpuState{
				D:   [8]uint32{1549680510, 3529549349, 402953891, 2836331597, 3505705563, 595564642, 2848265625, 2797936031},
				A:   [7]uint32{918023106, 2919418, 3956781094, 1306461531, 2621107024, 522755042, 756702087},
				PC:  5926570,
				SR:  34077,
				USP: 2940887,
				SSP: 6008204,
				RAM: [][2]uint32{{5926562, 78}, {5926563, 81}, {5926564, 83}, {5926565, 221}, {5926566, 68}, {5926567, 77}, {2919418, 139}, {2919419, 188}, {2919420, 58}, {2919421, 215}, {5926568, 169}, {5926569, 58}},
				Cycles: 16,
			},
		},
		{
			name: "500 LINK A4, # 4e54",
			init: cpuState{
				D:   [8]uint32{425574540, 3394153340, 1882153756, 2376007096, 563181920, 2075860518, 1961805986, 3463876948},
				A:   [7]uint32{2101983761, 945460092, 140914489, 754763411, 3756096696, 3357398082, 583855179},
				PC:  451202,
				SR:  1049,
				USP: 9043786,
				SSP: 4556886,
				RAM: [][2]uint32{{451198, 78}, {451199, 84}, {451200, 145}, {451201, 75}, {451202, 48}, {451203, 48}, {451204, 112}, {451205, 90}},
			},
			want: cpuState{
				D:   [8]uint32{425574540, 3394153340, 1882153756, 2376007096, 563181920, 2075860518, 1961805986, 3463876948},
				A:   [7]uint32{2101983761, 945460092, 140914489, 754763411, 9043782, 3357398082, 583855179},
				PC:  451206,
				SR:  1049,
				USP: 9015441,
				SSP: 4556886,
				RAM: [][2]uint32{{451198, 78}, {451199, 84}, {451200, 145}, {451201, 75}, {451202, 48}, {451203, 48}, {9043782, 223}, {9043783, 225}, {9043784, 124}, {9043785, 184}, {451204, 112}, {451205, 90}},
				Cycles: 16,
			},
		},
		{
			name: "1000 LINK A3, # 4e53",
			init: cpuState{
				D:   [8]uint32{3596344682, 3621151121, 673324668, 1405083803, 556958545, 1119164912, 2877934472, 901397832},
				A:   [7]uint32{3608327268, 2427977602, 829658807, 1808028003, 2126515835, 491324719, 3331753124},
				PC:  7332626,
				SR:  1307,
				USP: 2700044,
				SSP: 4668742,
				RAM: [][2]uint32{{7332622, 78}, {7332623, 83}, {7332624, 124}, {7332625, 227}, {7332626, 166}, {7332627, 195}, {7332628, 152}, {7332629, 121}},
			},
			want: cpuState{
				D:   [8]uint32{3596344682, 3621151121, 673324668, 1405083803, 556958545, 1119164912, 2877934472, 901397832},
				A:   [7]uint32{3608327268, 2427977602, 829658807, 2700040, 2126515835, 491324719, 3331753124},
				PC:  7332630,
				SR:  1307,
				USP: 2732011,
				SSP: 4668742,
				RAM: [][2]uint32{{7332622, 78}, {7332623, 83}, {7332624, 124}, {7332625, 227}, {7332626, 166}, {7332627, 195}, {2700040, 107}, {2700041, 196}, {2700042, 81}, {2700043, 99}, {7332628, 152}, {7332629, 121}},
				Cycles: 16,
			},
		},
		{
			name: "1500 LINK A7, # 4e57",
			init: cpuState{
				D:   [8]uint32{3174832005, 1094241102, 2674456733, 3491116444, 1667553478, 4207860644, 1033506416, 669993730},
				A:   [7]uint32{1125938807, 4241410451, 436183217, 879100864, 3954590369, 1436114044, 4138346227},
				PC:  11463846,
				SR:  10009,
				USP: 862092,
				SSP: 16400608,
				RAM: [][2]uint32{{11463842, 78}, {11463843, 87}, {11463844, 102}, {11463845, 196}, {11463846, 89}, {11463847, 82}, {11463848, 198}, {11463849, 62}},
			},
			want: cpuState{
				D:   [8]uint32{3174832005, 1094241102, 2674456733, 3491116444, 1667553478, 4207860644, 1033506416, 669993730},
				A:   [7]uint32{1125938807, 4241410451, 436183217, 879100864, 3954590369, 1436114044, 4138346227},
				PC:  11463850,
				SR:  10009,
				USP: 862092,
				SSP: 16426912,
				RAM: [][2]uint32{{11463842, 78}, {11463843, 87}, {11463844, 102}, {11463845, 196}, {11463846, 89}, {11463847, 82}, {16400604, 0}, {16400605, 250}, {16400606, 64}, {16400607, 224}, {11463848, 198}, {11463849, 62}},
				Cycles: 16,
			},
		},
		{
			name: "2000 LINK A2, # 4e52",
			init: cpuState{
				D:   [8]uint32{999210835, 1470772316, 3534935607, 2546260387, 1291102159, 1549634259, 3896567636, 4283766997},
				A:   [7]uint32{1881380479, 2377301367, 1273064968, 1261108501, 347052799, 532912268, 3667933894},
				PC:  5132286,
				SR:  33813,
				USP: 4003452,
				SSP: 4389592,
				RAM: [][2]uint32{{5132282, 78}, {5132283, 82}, {5132284, 228}, {5132285, 197}, {5132286, 192}, {5132287, 46}, {5132288, 57}, {5132289, 45}},
			},
			want: cpuState{
				D:   [8]uint32{999210835, 1470772316, 3534935607, 2546260387, 1291102159, 1549634259, 3896567636, 4283766997},
				A:   [7]uint32{1881380479, 2377301367, 4003448, 1261108501, 347052799, 532912268, 3667933894},
				PC:  5132290,
				SR:  33813,
				USP: 3996477,
				SSP: 4389592,
				RAM: [][2]uint32{{5132282, 78}, {5132283, 82}, {5132284, 228}, {5132285, 197}, {5132286, 192}, {5132287, 46}, {4003448, 75}, {4003449, 225}, {4003450, 110}, {4003451, 8}, {5132288, 57}, {5132289, 45}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestUNLINK(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 UNLINK A4 4e5c",
			init: cpuState{
				D:   [8]uint32{4188436590, 403533247, 615474429, 3747526936, 3825585159, 2489378293, 1133655991, 4128972051},
				A:   [7]uint32{1694106958, 3493144052, 581047800, 4261867541, 3129588871, 1826850257, 3304415370},
				PC:  6891992,
				SR:  9233,
				USP: 10090944,
				SSP: 16089654,
				RAM: [][2]uint32{{6891988, 78}, {6891989, 92}, {6891990, 11}, {6891991, 27}, {12, 24}, {13, 20}, {14, 95}, {15, 122}, {1335162, 95}, {1335163, 242}, {1335164, 106}, {1335165, 199}},
			},
			want: cpuState{
				D:      [8]uint32{4188436590, 403533247, 615474429, 3747526936, 3825585159, 2489378293, 1133655991, 4128972051},
				A:      [7]uint32{1694106958, 3493144052, 581047800, 4261867541, 3129588871, 1826850257, 3304415370},
				PC:     403988350,
				SR:     9233,
				USP:    10090944,
				SSP:    16089640,
				RAM:    [][2]uint32{{6891988, 78}, {6891989, 92}, {6891990, 11}, {6891991, 27}, {16089652, 41}, {16089653, 216}, {16089648, 36}, {16089649, 17}, {16089650, 0}, {16089651, 105}, {16089646, 78}, {16089647, 92}, {16089644, 188}, {16089645, 135}, {16089640, 78}, {16089641, 85}, {16089642, 186}, {16089643, 137}, {12, 24}, {13, 20}, {14, 95}, {15, 122}, {1335162, 95}, {1335163, 242}, {1335164, 106}, {1335165, 199}},
				Halted: true,
			},
		},
		{
			name: "500 UNLINK A5 4e5d",
			init: cpuState{
				D:   [8]uint32{955354634, 1897319442, 2677659853, 3085044942, 101662574, 3577764799, 1234795614, 2978866406},
				A:   [7]uint32{1570383649, 2830363942, 2675505303, 2520931905, 2219935067, 3662507190, 377364581},
				PC:  12708572,
				SR:  5,
				USP: 15909844,
				SSP: 9651358,
				RAM: [][2]uint32{{12708568, 78}, {12708569, 93}, {12708570, 127}, {12708571, 72}, {5074102, 196}, {5074103, 25}, {5074104, 134}, {5074105, 137}, {12708572, 226}, {12708573, 124}},
			},
			want: cpuState{
				D:   [8]uint32{955354634, 1897319442, 2677659853, 3085044942, 101662574, 3577764799, 1234795614, 2978866406},
				A:   [7]uint32{1570383649, 2830363942, 2675505303, 2520931905, 2219935067, 3290007177, 377364581},
				PC:  12708574,
				SR:  5,
				USP: 3662507194,
				SSP: 9651358,
				RAM: [][2]uint32{{12708568, 78}, {12708569, 93}, {12708570, 127}, {12708571, 72}, {5074102, 196}, {5074103, 25}, {5074104, 134}, {5074105, 137}, {12708572, 226}, {12708573, 124}},
				Cycles: 12,
			},
		},
		{
			name: "1000 UNLINK A4 4e5c",
			init: cpuState{
				D:   [8]uint32{1715425790, 3776789943, 216486791, 1664131033, 4290017278, 1405198863, 3654345789, 3611134267},
				A:   [7]uint32{4152736271, 3832597824, 1256201469, 2897977011, 3908002215, 2955164549, 3181401823},
				PC:  10600234,
				SR:  33300,
				USP: 3624920,
				SSP: 6393318,
				RAM: [][2]uint32{{10600230, 78}, {10600231, 92}, {10600232, 83}, {10600233, 115}, {12, 153}, {13, 146}, {14, 104}, {15, 228}, {9595108, 235}, {9595109, 6}, {9595110, 63}, {9595111, 3}},
			},
			want: cpuState{
				D:      [8]uint32{1715425790, 3776789943, 216486791, 1664131033, 4290017278, 1405198863, 3654345789, 3611134267},
				A:      [7]uint32{4152736271, 3832597824, 1256201469, 2897977011, 3908002215, 2955164549, 3181401823},
				PC:     2576509160,
				SR:     8724,
				USP:    3624920,
				SSP:    6393304,
				RAM:    [][2]uint32{{10600230, 78}, {10600231, 92}, {10600232, 83}, {10600233, 115}, {6393316, 191}, {6393317, 42}, {6393312, 130}, {6393313, 20}, {6393314, 0}, {6393315, 161}, {6393310, 78}, {6393311, 92}, {6393308, 97}, {6393309, 167}, {6393304, 78}, {6393305, 81}, {6393306, 232}, {6393307, 239}, {12, 153}, {13, 146}, {14, 104}, {15, 228}, {9595108, 235}, {9595109, 6}, {9595110, 63}, {9595111, 3}},
				Halted: true,
			},
		},
		{
			name: "1500 UNLINK A3 4e5b",
			init: cpuState{
				D:   [8]uint32{986356251, 903404750, 597611831, 1574852755, 3231521343, 1390701803, 4074842356, 767866649},
				A:   [7]uint32{512514642, 738865342, 3551273134, 3406394854, 1125202022, 4237332447, 3019944613},
				PC:  5600006,
				SR:  42776,
				USP: 15617210,
				SSP: 13299080,
				RAM: [][2]uint32{{5600002, 78}, {5600003, 91}, {5600004, 77}, {5600005, 216}, {620006, 200}, {620007, 116}, {620008, 99}, {620009, 222}, {5600006, 197}, {5600007, 222}},
			},
			want: cpuState{
				D:   [8]uint32{986356251, 903404750, 597611831, 1574852755, 3231521343, 1390701803, 4074842356, 767866649},
				A:   [7]uint32{512514642, 738865342, 3551273134, 3363070942, 1125202022, 4237332447, 3019944613},
				PC:  5600008,
				SR:  42776,
				USP: 15617210,
				SSP: 3406394858,
				RAM: [][2]uint32{{5600002, 78}, {5600003, 91}, {5600004, 77}, {5600005, 216}, {620006, 200}, {620007, 116}, {620008, 99}, {620009, 222}, {5600006, 197}, {5600007, 222}},
				Cycles: 12,
			},
		},
		{
			name: "2000 UNLINK A2 4e5a",
			init: cpuState{
				D:   [8]uint32{3477829563, 658420195, 1763503059, 990799756, 2791921992, 3097682834, 744330401, 2652426465},
				A:   [7]uint32{764463701, 3340263618, 2334053929, 514531639, 944792472, 3497479675, 887733273},
				PC:  8613462,
				SR:  41993,
				USP: 11613240,
				SSP: 6846608,
				RAM: [][2]uint32{{8613458, 78}, {8613459, 90}, {8613460, 122}, {8613461, 112}, {12, 218}, {13, 96}, {14, 196}, {15, 26}, {6341658, 101}, {6341659, 0}, {6341660, 47}, {6341661, 209}},
			},
			want: cpuState{
				D:      [8]uint32{3477829563, 658420195, 1763503059, 990799756, 2791921992, 3097682834, 744330401, 2652426465},
				A:      [7]uint32{764463701, 3340263618, 2334053929, 514531639, 944792472, 3497479675, 887733273},
				PC:     3663774750,
				SR:     9225,
				USP:    11613240,
				SSP:    6846594,
				RAM:    [][2]uint32{{8613458, 78}, {8613459, 90}, {8613460, 122}, {8613461, 112}, {6846606, 110}, {6846607, 86}, {6846602, 164}, {6846603, 9}, {6846604, 0}, {6846605, 131}, {6846600, 78}, {6846601, 90}, {6846598, 214}, {6846599, 41}, {6846594, 78}, {6846595, 85}, {6846596, 139}, {6846597, 30}, {12, 218}, {13, 96}, {14, 196}, {15, 26}, {6341658, 101}, {6341659, 0}, {6341660, 47}, {6341661, 209}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEtoCCR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEtoCCR (A7) 44d7",
			init: cpuState{
				D:   [8]uint32{4270573421, 873307202, 2060108381, 423129026, 1188449628, 1593341122, 3805548495, 3652755872},
				A:   [7]uint32{1113316608, 1471957673, 2603170087, 1756381978, 210391634, 92032902, 3645782566},
				PC:  790748,
				SR:  41742,
				USP: 11124156,
				SSP: 10012702,
				RAM: [][2]uint32{{790744, 68}, {790745, 215}, {790746, 166}, {790747, 184}, {10012702, 181}, {10012703, 204}, {790748, 148}, {790749, 65}},
			},
			want: cpuState{
				D:   [8]uint32{4270573421, 873307202, 2060108381, 423129026, 1188449628, 1593341122, 3805548495, 3652755872},
				A:   [7]uint32{1113316608, 1471957673, 2603170087, 1756381978, 210391634, 92032902, 3645782566},
				PC:  790750,
				SR:  41740,
				USP: 11124156,
				SSP: 10012702,
				RAM: [][2]uint32{{790744, 68}, {790745, 215}, {790746, 166}, {790747, 184}, {10012702, 181}, {10012703, 204}, {790748, 148}, {790749, 65}},
				Cycles: 16,
			},
		},
		{
			name: "500 MOVEtoCCR (A0)+ 44d8",
			init: cpuState{
				D:   [8]uint32{3004163013, 520453350, 1665239044, 784654326, 3724403018, 2464868295, 1819010595, 1513838663},
				A:   [7]uint32{2732787038, 399071319, 2473853894, 244281061, 767986525, 2083250763, 4118414929},
				PC:  1074622,
				SR:  33537,
				USP: 9510274,
				SSP: 16763824,
				RAM: [][2]uint32{{1074618, 68}, {1074619, 216}, {1074620, 106}, {1074621, 223}, {14878046, 248}, {14878047, 244}, {1074622, 202}, {1074623, 218}},
			},
			want: cpuState{
				D:   [8]uint32{3004163013, 520453350, 1665239044, 784654326, 3724403018, 2464868295, 1819010595, 1513838663},
				A:   [7]uint32{2732787040, 399071319, 2473853894, 244281061, 767986525, 2083250763, 4118414929},
				PC:  1074624,
				SR:  33556,
				USP: 9510274,
				SSP: 16763824,
				RAM: [][2]uint32{{1074618, 68}, {1074619, 216}, {1074620, 106}, {1074621, 223}, {14878046, 248}, {14878047, 244}, {1074622, 202}, {1074623, 218}},
				Cycles: 16,
			},
		},
		{
			name: "1000 MOVEtoCCR D6 44c6",
			init: cpuState{
				D:   [8]uint32{1062174228, 4277796943, 3678280340, 2953657901, 1369937534, 607046054, 1025009999, 1256671144},
				A:   [7]uint32{3477862065, 1110162641, 388031723, 3224192529, 766817666, 1737130810, 2678090511},
				PC:  12340010,
				SR:  8704,
				USP: 1023522,
				SSP: 9169932,
				RAM: [][2]uint32{{12340006, 68}, {12340007, 198}, {12340008, 50}, {12340009, 7}, {12340010, 89}, {12340011, 147}},
			},
			want: cpuState{
				D:   [8]uint32{1062174228, 4277796943, 3678280340, 2953657901, 1369937534, 607046054, 1025009999, 1256671144},
				A:   [7]uint32{3477862065, 1110162641, 388031723, 3224192529, 766817666, 1737130810, 2678090511},
				PC:  12340012,
				SR:  8719,
				USP: 1023522,
				SSP: 9169932,
				RAM: [][2]uint32{{12340006, 68}, {12340007, 198}, {12340008, 50}, {12340009, 7}, {12340010, 89}, {12340011, 147}},
				Cycles: 12,
			},
		},
		{
			name: "1500 MOVEtoCCR (A0) 44d0",
			init: cpuState{
				D:   [8]uint32{465883211, 3087343920, 2688559184, 1752985379, 3090264613, 678695379, 665757163, 2794283382},
				A:   [7]uint32{3279323300, 1017193464, 1864601352, 490259197, 4162662288, 2245680818, 2263519760},
				PC:  9352324,
				SR:  1286,
				USP: 568284,
				SSP: 2142362,
				RAM: [][2]uint32{{9352320, 68}, {9352321, 208}, {9352322, 192}, {9352323, 127}, {7766180, 88}, {7766181, 76}, {9352324, 222}, {9352325, 28}},
			},
			want: cpuState{
				D:   [8]uint32{465883211, 3087343920, 2688559184, 1752985379, 3090264613, 678695379, 665757163, 2794283382},
				A:   [7]uint32{3279323300, 1017193464, 1864601352, 490259197, 4162662288, 2245680818, 2263519760},
				PC:  9352326,
				SR:  1292,
				USP: 568284,
				SSP: 2142362,
				RAM: [][2]uint32{{9352320, 68}, {9352321, 208}, {9352322, 192}, {9352323, 127}, {7766180, 88}, {7766181, 76}, {9352324, 222}, {9352325, 28}},
				Cycles: 16,
			},
		},
		{
			name: "2000 MOVEtoCCR (d16, A4) 44ec",
			init: cpuState{
				D:   [8]uint32{788192078, 1250959520, 4051970713, 2769674552, 418192740, 1377804564, 2670827572, 4048077299},
				A:   [7]uint32{2803945173, 3200741387, 637590458, 776142276, 466116355, 1644891918, 82803457},
				PC:  8402982,
				SR:  42006,
				USP: 10454214,
				SSP: 13533164,
				RAM: [][2]uint32{{8402978, 68}, {8402979, 236}, {8402980, 249}, {8402981, 230}, {8402982, 72}, {8402983, 43}, {12, 75}, {13, 2}, {14, 137}, {15, 48}, {166192, 1}, {166193, 81}, {166194, 223}, {166195, 239}},
			},
			want: cpuState{
				D:      [8]uint32{788192078, 1250959520, 4051970713, 2769674552, 418192740, 1377804564, 2670827572, 4048077299},
				A:      [7]uint32{2803945173, 3200741387, 637590458, 776142276, 466116355, 1644891918, 82803457},
				PC:     1258457396,
				SR:     9238,
				USP:    10454214,
				SSP:    13533150,
				RAM:    [][2]uint32{{8402978, 68}, {8402979, 236}, {8402980, 249}, {8402981, 230}, {8402982, 72}, {8402983, 43}, {13533162, 56}, {13533163, 36}, {13533158, 164}, {13533159, 22}, {13533160, 0}, {13533161, 128}, {13533156, 68}, {13533157, 236}, {13533154, 88}, {13533155, 233}, {13533150, 68}, {13533151, 245}, {13533152, 27}, {13533153, 200}, {12, 75}, {13, 2}, {14, 137}, {15, 48}, {166192, 1}, {166193, 81}, {166194, 223}, {166195, 239}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEtoSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEtoSR (A4) 46d4",
			init: cpuState{
				D:   [8]uint32{211823858, 143714222, 3296759660, 2630777996, 2230986041, 2148579648, 1986958079, 1386104649},
				A:   [7]uint32{3329473789, 3895785386, 531857046, 3126950053, 1236592031, 1020035923, 3169828815},
				PC:  7693556,
				SR:  528,
				USP: 2855122,
				SSP: 12941094,
				RAM: [][2]uint32{{7693552, 70}, {7693553, 212}, {7693554, 60}, {7693555, 42}, {32, 214}, {33, 76}, {34, 53}, {35, 204}, {4994508, 141}, {4994509, 140}, {4994510, 186}, {4994511, 47}},
			},
			want: cpuState{
				D:   [8]uint32{211823858, 143714222, 3296759660, 2630777996, 2230986041, 2148579648, 1986958079, 1386104649},
				A:   [7]uint32{3329473789, 3895785386, 531857046, 3126950053, 1236592031, 1020035923, 3169828815},
				PC:  3595318736,
				SR:  8720,
				USP: 2855122,
				SSP: 12941088,
				RAM: [][2]uint32{{7693552, 70}, {7693553, 212}, {7693554, 60}, {7693555, 42}, {12941092, 100}, {12941093, 240}, {12941088, 2}, {12941089, 16}, {12941090, 0}, {12941091, 117}, {32, 214}, {33, 76}, {34, 53}, {35, 204}, {4994508, 141}, {4994509, 140}, {4994510, 186}, {4994511, 47}},
				Cycles: 34,
			},
		},
		{
			name: "500 MOVEtoSR -(A5) 46e5",
			init: cpuState{
				D:   [8]uint32{2185921795, 3034907988, 1924980292, 490022128, 599066172, 4099736981, 1281249388, 4054340185},
				A:   [7]uint32{1196549866, 2317138228, 4132388699, 352694448, 3567992490, 1838020895, 411824783},
				PC:  7862148,
				SR:  33031,
				USP: 6229460,
				SSP: 7536744,
				RAM: [][2]uint32{{7862144, 70}, {7862145, 229}, {7862146, 85}, {7862147, 161}, {32, 227}, {33, 68}, {34, 84}, {35, 10}, {4477962, 56}, {4477963, 165}, {4477964, 143}, {4477965, 174}},
			},
			want: cpuState{
				D:   [8]uint32{2185921795, 3034907988, 1924980292, 490022128, 599066172, 4099736981, 1281249388, 4054340185},
				A:   [7]uint32{1196549866, 2317138228, 4132388699, 352694448, 3567992490, 1838020895, 411824783},
				PC:  3812905998,
				SR:  8455,
				USP: 6229460,
				SSP: 7536738,
				RAM: [][2]uint32{{7862144, 70}, {7862145, 229}, {7862146, 85}, {7862147, 161}, {7536742, 247}, {7536743, 128}, {7536738, 129}, {7536739, 7}, {7536740, 0}, {7536741, 119}, {32, 227}, {33, 68}, {34, 84}, {35, 10}, {4477962, 56}, {4477963, 165}, {4477964, 143}, {4477965, 174}},
				Cycles: 34,
			},
		},
		{
			name: "1000 MOVEtoSR (d8, A5, Xn) 46f5",
			init: cpuState{
				D:   [8]uint32{3952314096, 788468355, 1030333420, 1023986158, 2957870970, 1946342889, 983517413, 2227907290},
				A:   [7]uint32{2584369980, 33206410, 994513456, 1188759060, 1450973416, 3848480019, 3052829127},
				PC:  7977928,
				SR:  42001,
				USP: 15643716,
				SSP: 5421678,
				RAM: [][2]uint32{{7977924, 70}, {7977925, 245}, {7977926, 177}, {7977927, 32}, {7977928, 24}, {7977929, 249}, {12, 6}, {13, 126}, {14, 123}, {15, 244}, {8289268, 16}, {8289269, 179}, {8289270, 180}, {8289271, 141}},
			},
			want: cpuState{
				D:      [8]uint32{3952314096, 788468355, 1030333420, 1023986158, 2957870970, 1946342889, 983517413, 2227907290},
				A:      [7]uint32{2584369980, 33206410, 994513456, 1188759060, 1450973416, 3848480019, 3052829127},
				PC:     108952568,
				SR:     9233,
				USP:    15643716,
				SSP:    5421664,
				RAM:    [][2]uint32{{7977924, 70}, {7977925, 245}, {7977926, 177}, {7977927, 32}, {7977928, 24}, {7977929, 249}, {5421676, 187}, {5421677, 198}, {5421672, 164}, {5421673, 17}, {5421674, 0}, {5421675, 121}, {5421670, 70}, {5421671, 245}, {5421668, 43}, {5421669, 71}, {5421664, 70}, {5421665, 245}, {5421666, 229}, {5421667, 99}, {12, 6}, {13, 126}, {14, 123}, {15, 244}, {8289268, 16}, {8289269, 179}, {8289270, 180}, {8289271, 141}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVEtoSR (d16, A7) 46ef",
			init: cpuState{
				D:   [8]uint32{1395318051, 1781170151, 988621212, 1040148351, 447376275, 515558757, 2832254203, 477483571},
				A:   [7]uint32{3283532092, 2352982042, 580168180, 2088823459, 3479490460, 3884130311, 2135641708},
				PC:  12130878,
				SR:  42758,
				USP: 12966034,
				SSP: 1032888,
				RAM: [][2]uint32{{12130874, 70}, {12130875, 239}, {12130876, 236}, {12130877, 175}, {12130878, 13}, {12130879, 252}, {12, 214}, {13, 138}, {14, 220}, {15, 194}, {9100482, 113}, {9100483, 14}, {9100484, 173}, {9100485, 220}},
			},
			want: cpuState{
				D:      [8]uint32{1395318051, 1781170151, 988621212, 1040148351, 447376275, 515558757, 2832254203, 477483571},
				A:      [7]uint32{3283532092, 2352982042, 580168180, 2088823459, 3479490460, 3884130311, 2135641708},
				PC:     3599424710,
				SR:     9990,
				USP:    12966034,
				SSP:    1032874,
				RAM:    [][2]uint32{{12130874, 70}, {12130875, 239}, {12130876, 236}, {12130877, 175}, {12130878, 13}, {12130879, 252}, {1032886, 26}, {1032887, 60}, {1032882, 167}, {1032883, 6}, {1032884, 0}, {1032885, 185}, {1032880, 70}, {1032881, 239}, {1032878, 175}, {1032879, 103}, {1032874, 70}, {1032875, 245}, {1032876, 0}, {1032877, 15}, {12, 214}, {13, 138}, {14, 220}, {15, 194}, {9100482, 113}, {9100483, 14}, {9100484, 173}, {9100485, 220}},
				Halted: true,
			},
		},
		{
			name: "2000 MOVEtoSR (d16, PC) 46fa",
			init: cpuState{
				D:   [8]uint32{2291184308, 2799811410, 257168639, 2266209033, 3779806961, 4261602911, 1424412806, 3966576518},
				A:   [7]uint32{517026946, 3161917534, 3116170840, 2531344535, 3965768398, 2126172432, 1089404355},
				PC:  9302354,
				SR:  530,
				USP: 15174282,
				SSP: 11083894,
				RAM: [][2]uint32{{9302350, 70}, {9302351, 250}, {9302352, 245}, {9302353, 222}, {32, 96}, {33, 242}, {34, 232}, {35, 60}, {15919164, 67}, {15919165, 194}, {15919166, 171}, {15919167, 122}},
			},
			want: cpuState{
				D:   [8]uint32{2291184308, 2799811410, 257168639, 2266209033, 3779806961, 4261602911, 1424412806, 3966576518},
				A:   [7]uint32{517026946, 3161917534, 3116170840, 2531344535, 3965768398, 2126172432, 1089404355},
				PC:  1626531904,
				SR:  8722,
				USP: 15174282,
				SSP: 11083888,
				RAM: [][2]uint32{{9302350, 70}, {9302351, 250}, {9302352, 245}, {9302353, 222}, {11083892, 241}, {11083893, 78}, {11083888, 2}, {11083889, 18}, {11083890, 0}, {11083891, 141}, {32, 96}, {33, 242}, {34, 232}, {35, 60}, {15919164, 67}, {15919165, 194}, {15919166, 171}, {15919167, 122}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEfromSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEfromSR -(A6) 40e6",
			init: cpuState{
				D:   [8]uint32{1539487470, 88414920, 3761114870, 1442749669, 1076942791, 2275119325, 263127465, 1787787047},
				A:   [7]uint32{2373554379, 3120242247, 3654480073, 195491783, 2461167633, 3346612883, 2917650809},
				PC:  919442,
				SR:  33803,
				USP: 15951390,
				SSP: 9033344,
				RAM: [][2]uint32{{919438, 64}, {919439, 230}, {919440, 92}, {919441, 208}, {12, 39}, {13, 242}, {14, 64}, {15, 232}, {15876328, 220}, {15876329, 4}, {15876330, 210}, {15876331, 136}},
			},
			want: cpuState{
				D:      [8]uint32{1539487470, 88414920, 3761114870, 1442749669, 1076942791, 2275119325, 263127465, 1787787047},
				A:      [7]uint32{2373554379, 3120242247, 3654480073, 195491783, 2461167633, 3346612883, 2917650807},
				PC:     670187756,
				SR:     9227,
				USP:    15951390,
				SSP:    9033330,
				RAM:    [][2]uint32{{919438, 64}, {919439, 230}, {919440, 92}, {919441, 208}, {9033342, 7}, {9033343, 146}, {9033338, 132}, {9033339, 11}, {9033340, 0}, {9033341, 14}, {9033336, 64}, {9033337, 230}, {9033334, 209}, {9033335, 119}, {9033330, 64}, {9033331, 241}, {9033332, 173}, {9033333, 231}, {12, 39}, {13, 242}, {14, 64}, {15, 232}, {15876328, 220}, {15876329, 4}, {15876330, 210}, {15876331, 136}},
				Halted: true,
			},
		},
		{
			name: "500 MOVEfromSR (d8, A6, Xn) 40f6",
			init: cpuState{
				D:   [8]uint32{1980334010, 3167605853, 310030401, 1553449489, 436945333, 718770126, 119453367, 2523342529},
				A:   [7]uint32{1831867579, 2198748582, 2913131245, 3718313342, 3609801955, 37363688, 1293960239},
				PC:  15657772,
				SR:  34311,
				USP: 2572960,
				SSP: 7161372,
				RAM: [][2]uint32{{15657768, 64}, {15657769, 246}, {15657770, 71}, {15657771, 169}, {15657772, 159}, {15657773, 228}, {12, 108}, {13, 84}, {14, 65}, {15, 84}, {5521748, 22}, {5521749, 194}, {5521750, 182}, {5521751, 62}},
			},
			want: cpuState{
				D:      [8]uint32{1980334010, 3167605853, 310030401, 1553449489, 436945333, 718770126, 119453367, 2523342529},
				A:      [7]uint32{1831867579, 2198748582, 2913131245, 3718313342, 3609801955, 37363688, 1293960239},
				PC:     1817461080,
				SR:     9735,
				USP:    2572960,
				SSP:    7161358,
				RAM:    [][2]uint32{{15657768, 64}, {15657769, 246}, {15657770, 71}, {15657771, 169}, {15657772, 159}, {15657773, 228}, {7161370, 235}, {7161371, 42}, {7161366, 134}, {7161367, 7}, {7161368, 0}, {7161369, 238}, {7161364, 64}, {7161365, 246}, {7161362, 133}, {7161363, 141}, {7161358, 64}, {7161359, 241}, {7161360, 77}, {7161361, 32}, {12, 108}, {13, 84}, {14, 65}, {15, 84}, {5521748, 22}, {5521749, 194}, {5521750, 182}, {5521751, 62}},
				Halted: true,
			},
		},
		{
			name: "1000 MOVEfromSR (A2) 40d2",
			init: cpuState{
				D:   [8]uint32{98469251, 473840520, 3879971513, 4166988453, 362607423, 58945386, 688833156, 1167423996},
				A:   [7]uint32{834608744, 942064560, 427940119, 4134744377, 1186207509, 2401505492, 3586707323},
				PC:  11265760,
				SR:  33549,
				USP: 11514810,
				SSP: 8831470,
				RAM: [][2]uint32{{11265756, 64}, {11265757, 210}, {11265758, 240}, {11265759, 139}, {12, 186}, {13, 210}, {14, 9}, {15, 210}, {13765074, 241}, {13765075, 121}, {13765076, 125}, {13765077, 83}},
			},
			want: cpuState{
				D:      [8]uint32{98469251, 473840520, 3879971513, 4166988453, 362607423, 58945386, 688833156, 1167423996},
				A:      [7]uint32{834608744, 942064560, 427940119, 4134744377, 1186207509, 2401505492, 3586707323},
				PC:     3134327254,
				SR:     8973,
				USP:    11514810,
				SSP:    8831456,
				RAM:    [][2]uint32{{11265756, 64}, {11265757, 210}, {11265758, 240}, {11265759, 139}, {8831468, 230}, {8831469, 222}, {8831464, 131}, {8831465, 13}, {8831466, 0}, {8831467, 171}, {8831462, 64}, {8831463, 210}, {8831460, 217}, {8831461, 23}, {8831456, 64}, {8831457, 209}, {8831458, 25}, {8831459, 129}, {12, 186}, {13, 210}, {14, 9}, {15, 210}, {13765074, 241}, {13765075, 121}, {13765076, 125}, {13765077, 83}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVEfromSR (d8, A0, Xn) 40f0",
			init: cpuState{
				D:   [8]uint32{3046772129, 1389579770, 1087990752, 3305219991, 828447682, 2444772200, 3935847689, 3084679514},
				A:   [7]uint32{3179139866, 542934256, 1857311351, 2363547443, 778896843, 4024116766, 1851445596},
				PC:  15568202,
				SR:  9218,
				USP: 5790386,
				SSP: 1332810,
				RAM: [][2]uint32{{15568198, 64}, {15568199, 240}, {15568200, 160}, {15568201, 219}, {15568202, 83}, {15568203, 93}, {8267116, 223}, {8267117, 126}, {15568204, 100}, {15568205, 76}},
			},
			want: cpuState{
				D:   [8]uint32{3046772129, 1389579770, 1087990752, 3305219991, 828447682, 2444772200, 3935847689, 3084679514},
				A:   [7]uint32{3179139866, 542934256, 1857311351, 2363547443, 778896843, 4024116766, 1851445596},
				PC:  15568206,
				SR:  9218,
				USP: 5790386,
				SSP: 1332810,
				RAM: [][2]uint32{{15568198, 64}, {15568199, 240}, {15568200, 160}, {15568201, 219}, {15568202, 83}, {15568203, 93}, {8267116, 36}, {8267117, 2}, {15568204, 100}, {15568205, 76}},
				Cycles: 18,
			},
		},
		{
			name: "2000 MOVEfromSR (A6) 40d6",
			init: cpuState{
				D:   [8]uint32{941711418, 1083543694, 290919008, 1479329756, 3282090353, 3345666486, 975061923, 1958797117},
				A:   [7]uint32{3171876673, 367244463, 1683808489, 2356136594, 2978114804, 119352526, 2320065517},
				PC:  6024900,
				SR:  771,
				USP: 7838578,
				SSP: 5290344,
				RAM: [][2]uint32{{6024896, 64}, {6024897, 214}, {6024898, 184}, {6024899, 182}, {12, 105}, {13, 36}, {14, 101}, {15, 194}, {2385346, 118}, {2385347, 132}, {2385348, 34}, {2385349, 59}},
			},
			want: cpuState{
				D:      [8]uint32{941711418, 1083543694, 290919008, 1479329756, 3282090353, 3345666486, 975061923, 1958797117},
				A:      [7]uint32{3171876673, 367244463, 1683808489, 2356136594, 2978114804, 119352526, 2320065517},
				PC:     1763993030,
				SR:     8963,
				USP:    7838578,
				SSP:    5290330,
				RAM:    [][2]uint32{{6024896, 64}, {6024897, 214}, {6024898, 184}, {6024899, 182}, {5290342, 238}, {5290343, 194}, {5290338, 3}, {5290339, 3}, {5290340, 0}, {5290341, 91}, {5290336, 64}, {5290337, 214}, {5290334, 99}, {5290335, 237}, {5290330, 64}, {5290331, 209}, {5290332, 138}, {5290333, 73}, {12, 105}, {13, 36}, {14, 101}, {15, 194}, {2385346, 118}, {2385347, 132}, {2385348, 34}, {2385349, 59}},
				Halted: true,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEtoUSP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEtoUSP A0 4e60",
			init: cpuState{
				D:   [8]uint32{2692887478, 1280383817, 2144670232, 3019371263, 1560465517, 1582093765, 2709448005, 1152394757},
				A:   [7]uint32{481269603, 1731379481, 1707162888, 1164091097, 2335275678, 3795186, 2816624664},
				PC:  12467038,
				SR:  33295,
				USP: 7632622,
				SSP: 12359498,
				RAM: [][2]uint32{{12467034, 78}, {12467035, 96}, {12467036, 77}, {12467037, 210}, {32, 144}, {33, 240}, {34, 140}, {35, 50}, {15764530, 151}, {15764531, 44}, {15764532, 247}, {15764533, 34}},
			},
			want: cpuState{
				D:   [8]uint32{2692887478, 1280383817, 2144670232, 3019371263, 1560465517, 1582093765, 2709448005, 1152394757},
				A:   [7]uint32{481269603, 1731379481, 1707162888, 1164091097, 2335275678, 3795186, 2816624664},
				PC:  2431683638,
				SR:  8719,
				USP: 7632622,
				SSP: 12359492,
				RAM: [][2]uint32{{12467034, 78}, {12467035, 96}, {12467036, 77}, {12467037, 210}, {12359496, 59}, {12359497, 90}, {12359492, 130}, {12359493, 15}, {12359494, 0}, {12359495, 190}, {32, 144}, {33, 240}, {34, 140}, {35, 50}, {15764530, 151}, {15764531, 44}, {15764532, 247}, {15764533, 34}},
				Cycles: 34,
			},
		},
		{
			name: "500 MOVEtoUSP A6 4e66",
			init: cpuState{
				D:   [8]uint32{912812780, 3386566610, 1086521279, 3311217772, 3327004687, 3459362308, 1880994954, 1970017772},
				A:   [7]uint32{3350879370, 257734140, 3607925952, 3613369214, 1415032015, 920663977, 1682355851},
				PC:  1218290,
				SR:  10004,
				USP: 13540520,
				SSP: 6172494,
				RAM: [][2]uint32{{1218286, 78}, {1218287, 102}, {1218288, 59}, {1218289, 28}, {1218290, 244}, {1218291, 156}},
			},
			want: cpuState{
				D:   [8]uint32{912812780, 3386566610, 1086521279, 3311217772, 3327004687, 3459362308, 1880994954, 1970017772},
				A:   [7]uint32{3350879370, 257734140, 3607925952, 3613369214, 1415032015, 920663977, 1682355851},
				PC:  1218292,
				SR:  10004,
				USP: 1682355851,
				SSP: 6172494,
				RAM: [][2]uint32{{1218286, 78}, {1218287, 102}, {1218288, 59}, {1218289, 28}, {1218290, 244}, {1218291, 156}},
				Cycles: 4,
			},
		},
		{
			name: "1000 MOVEtoUSP A0 4e60",
			init: cpuState{
				D:   [8]uint32{2594548936, 2037726791, 1928706930, 1744591507, 3055210563, 3300802918, 1599975080, 2855931147},
				A:   [7]uint32{2319306297, 3942468084, 3801921084, 4196418685, 2714132150, 1192234638, 4133456507},
				PC:  2430042,
				SR:  9750,
				USP: 9024166,
				SSP: 9991812,
				RAM: [][2]uint32{{2430038, 78}, {2430039, 96}, {2430040, 16}, {2430041, 165}, {2430042, 98}, {2430043, 55}},
			},
			want: cpuState{
				D:   [8]uint32{2594548936, 2037726791, 1928706930, 1744591507, 3055210563, 3300802918, 1599975080, 2855931147},
				A:   [7]uint32{2319306297, 3942468084, 3801921084, 4196418685, 2714132150, 1192234638, 4133456507},
				PC:  2430044,
				SR:  9750,
				USP: 2319306297,
				SSP: 9991812,
				RAM: [][2]uint32{{2430038, 78}, {2430039, 96}, {2430040, 16}, {2430041, 165}, {2430042, 98}, {2430043, 55}},
				Cycles: 4,
			},
		},
		{
			name: "1500 MOVEtoUSP A6 4e66",
			init: cpuState{
				D:   [8]uint32{3809900723, 495766190, 3076949713, 3952646349, 1248345641, 282042239, 4121261915, 3946795161},
				A:   [7]uint32{1657997161, 2260855301, 2136337854, 2935999328, 1094659268, 1457702800, 2366959569},
				PC:  7497250,
				SR:  9482,
				USP: 6244100,
				SSP: 15020918,
				RAM: [][2]uint32{{7497246, 78}, {7497247, 102}, {7497248, 134}, {7497249, 22}, {7497250, 243}, {7497251, 65}},
			},
			want: cpuState{
				D:   [8]uint32{3809900723, 495766190, 3076949713, 3952646349, 1248345641, 282042239, 4121261915, 3946795161},
				A:   [7]uint32{1657997161, 2260855301, 2136337854, 2935999328, 1094659268, 1457702800, 2366959569},
				PC:  7497252,
				SR:  9482,
				USP: 2366959569,
				SSP: 15020918,
				RAM: [][2]uint32{{7497246, 78}, {7497247, 102}, {7497248, 134}, {7497249, 22}, {7497250, 243}, {7497251, 65}},
				Cycles: 4,
			},
		},
		{
			name: "2000 MOVEtoUSP A3 4e63",
			init: cpuState{
				D:   [8]uint32{2500080291, 1338084160, 2702400891, 2599218920, 1441366654, 1629096673, 3868511571, 3211028740},
				A:   [7]uint32{2132947446, 2963103044, 3451915881, 3687177431, 1478447923, 2218346974, 1028731983},
				PC:  806796,
				SR:  773,
				USP: 5952566,
				SSP: 15600738,
				RAM: [][2]uint32{{806792, 78}, {806793, 99}, {806794, 50}, {806795, 168}, {32, 144}, {33, 192}, {34, 90}, {35, 116}, {12606068, 16}, {12606069, 94}, {12606070, 244}, {12606071, 125}},
			},
			want: cpuState{
				D:   [8]uint32{2500080291, 1338084160, 2702400891, 2599218920, 1441366654, 1629096673, 3868511571, 3211028740},
				A:   [7]uint32{2132947446, 2963103044, 3451915881, 3687177431, 1478447923, 2218346974, 1028731983},
				PC:  2428525176,
				SR:  8965,
				USP: 5952566,
				SSP: 15600732,
				RAM: [][2]uint32{{806792, 78}, {806793, 99}, {806794, 50}, {806795, 168}, {15600736, 79}, {15600737, 136}, {15600732, 3}, {15600733, 5}, {15600734, 0}, {15600735, 12}, {32, 144}, {33, 192}, {34, 90}, {35, 116}, {12606068, 16}, {12606069, 94}, {12606070, 244}, {12606071, 125}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEfromUSP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEfromUSP A7 4e6f",
			init: cpuState{
				D:   [8]uint32{587428628, 685730099, 90308950, 4241487395, 444553911, 2499854212, 1607600214, 129444812},
				A:   [7]uint32{2923414324, 3969042471, 285980870, 2419145562, 3765786936, 475346137, 3518790682},
				PC:  3488622,
				SR:  18,
				USP: 13503518,
				SSP: 10888206,
				RAM: [][2]uint32{{3488618, 78}, {3488619, 111}, {3488620, 68}, {3488621, 186}, {32, 199}, {33, 100}, {34, 45}, {35, 172}, {6565292, 42}, {6565293, 42}, {6565294, 45}, {6565295, 141}},
			},
			want: cpuState{
				D:   [8]uint32{587428628, 685730099, 90308950, 4241487395, 444553911, 2499854212, 1607600214, 129444812},
				A:   [7]uint32{2923414324, 3969042471, 285980870, 2419145562, 3765786936, 475346137, 3518790682},
				PC:  3345231280,
				SR:  8210,
				USP: 13503518,
				SSP: 10888200,
				RAM: [][2]uint32{{3488618, 78}, {3488619, 111}, {3488620, 68}, {3488621, 186}, {10888204, 59}, {10888205, 106}, {10888200, 0}, {10888201, 18}, {10888202, 0}, {10888203, 53}, {32, 199}, {33, 100}, {34, 45}, {35, 172}, {6565292, 42}, {6565293, 42}, {6565294, 45}, {6565295, 141}},
				Cycles: 34,
			},
		},
		{
			name: "500 MOVEfromUSP A6 4e6e",
			init: cpuState{
				D:   [8]uint32{3826281324, 2946529264, 2007100753, 723984599, 1704072126, 2363332405, 329250907, 3055575341},
				A:   [7]uint32{2886894871, 516501273, 1026832995, 71980587, 630227634, 2722813337, 3077281546},
				PC:  7388786,
				SR:  42515,
				USP: 8454188,
				SSP: 6465672,
				RAM: [][2]uint32{{7388782, 78}, {7388783, 110}, {7388784, 60}, {7388785, 82}, {7388786, 133}, {7388787, 218}},
			},
			want: cpuState{
				D:   [8]uint32{3826281324, 2946529264, 2007100753, 723984599, 1704072126, 2363332405, 329250907, 3055575341},
				A:   [7]uint32{2886894871, 516501273, 1026832995, 71980587, 630227634, 2722813337, 8454188},
				PC:  7388788,
				SR:  42515,
				USP: 8454188,
				SSP: 6465672,
				RAM: [][2]uint32{{7388782, 78}, {7388783, 110}, {7388784, 60}, {7388785, 82}, {7388786, 133}, {7388787, 218}},
				Cycles: 4,
			},
		},
		{
			name: "1000 MOVEfromUSP A7 4e6f",
			init: cpuState{
				D:   [8]uint32{818672653, 4199621782, 1582621795, 403136911, 1762018485, 551181275, 2803053628, 1986953272},
				A:   [7]uint32{2102150527, 3954196631, 1732554384, 2216712939, 1591630585, 2586251494, 315569742},
				PC:  9177826,
				SR:  1794,
				USP: 5625360,
				SSP: 277096,
				RAM: [][2]uint32{{9177822, 78}, {9177823, 111}, {9177824, 103}, {9177825, 62}, {32, 0}, {33, 78}, {34, 61}, {35, 70}, {5127494, 193}, {5127495, 17}, {5127496, 130}, {5127497, 183}},
			},
			want: cpuState{
				D:   [8]uint32{818672653, 4199621782, 1582621795, 403136911, 1762018485, 551181275, 2803053628, 1986953272},
				A:   [7]uint32{2102150527, 3954196631, 1732554384, 2216712939, 1591630585, 2586251494, 315569742},
				PC:  5127498,
				SR:  9986,
				USP: 5625360,
				SSP: 277090,
				RAM: [][2]uint32{{9177822, 78}, {9177823, 111}, {9177824, 103}, {9177825, 62}, {277094, 10}, {277095, 222}, {277090, 7}, {277091, 2}, {277092, 0}, {277093, 140}, {32, 0}, {33, 78}, {34, 61}, {35, 70}, {5127494, 193}, {5127495, 17}, {5127496, 130}, {5127497, 183}},
				Cycles: 34,
			},
		},
		{
			name: "1500 MOVEfromUSP A3 4e6b",
			init: cpuState{
				D:   [8]uint32{3402571310, 2818552838, 984013013, 1640487251, 3339644150, 3755871362, 1068948948, 1572190467},
				A:   [7]uint32{1694200701, 3227222914, 2097103787, 246391037, 2823830304, 3217022803, 3251440079},
				PC:  6898936,
				SR:  271,
				USP: 12106936,
				SSP: 12532204,
				RAM: [][2]uint32{{6898932, 78}, {6898933, 107}, {6898934, 17}, {6898935, 56}, {32, 28}, {33, 74}, {34, 58}, {35, 200}, {4864712, 251}, {4864713, 203}, {4864714, 68}, {4864715, 82}},
			},
			want: cpuState{
				D:   [8]uint32{3402571310, 2818552838, 984013013, 1640487251, 3339644150, 3755871362, 1068948948, 1572190467},
				A:   [7]uint32{1694200701, 3227222914, 2097103787, 246391037, 2823830304, 3217022803, 3251440079},
				PC:  474626764,
				SR:  8463,
				USP: 12106936,
				SSP: 12532198,
				RAM: [][2]uint32{{6898932, 78}, {6898933, 107}, {6898934, 17}, {6898935, 56}, {12532202, 68}, {12532203, 244}, {12532198, 1}, {12532199, 15}, {12532200, 0}, {12532201, 105}, {32, 28}, {33, 74}, {34, 58}, {35, 200}, {4864712, 251}, {4864713, 203}, {4864714, 68}, {4864715, 82}},
				Cycles: 34,
			},
		},
		{
			name: "2000 MOVEfromUSP A2 4e6a",
			init: cpuState{
				D:   [8]uint32{3063103495, 2486360044, 394238960, 3263907749, 336478317, 515594171, 3952962111, 2334295731},
				A:   [7]uint32{485080491, 226607006, 1026567199, 4204229654, 3826354844, 3068290717, 4133896587},
				PC:  10411656,
				SR:  9503,
				USP: 15738226,
				SSP: 8883474,
				RAM: [][2]uint32{{10411652, 78}, {10411653, 106}, {10411654, 250}, {10411655, 178}, {10411656, 95}, {10411657, 130}},
			},
			want: cpuState{
				D:   [8]uint32{3063103495, 2486360044, 394238960, 3263907749, 336478317, 515594171, 3952962111, 2334295731},
				A:   [7]uint32{485080491, 226607006, 15738226, 4204229654, 3826354844, 3068290717, 4133896587},
				PC:  10411658,
				SR:  9503,
				USP: 15738226,
				SSP: 8883474,
				RAM: [][2]uint32{{10411652, 78}, {10411653, 106}, {10411654, 250}, {10411655, 178}, {10411656, 95}, {10411657, 130}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestANDItoCCR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{1060220431, 3074622659, 3310109027, 1492945680, 2937026319, 3365500644, 3226290044, 145279005},
				A:   [7]uint32{3425173512, 1099825197, 3647762628, 3212943688, 433229394, 4135778562, 1342687670},
				PC:  11025688,
				SR:  41986,
				USP: 6003532,
				SSP: 9785742,
				RAM: [][2]uint32{{11025684, 2}, {11025685, 60}, {11025686, 49}, {11025687, 11}, {11025688, 72}, {11025689, 153}, {11025690, 108}, {11025691, 60}},
			},
			want: cpuState{
				D:   [8]uint32{1060220431, 3074622659, 3310109027, 1492945680, 2937026319, 3365500644, 3226290044, 145279005},
				A:   [7]uint32{3425173512, 1099825197, 3647762628, 3212943688, 433229394, 4135778562, 1342687670},
				PC:  11025692,
				SR:  41986,
				USP: 6003532,
				SSP: 9785742,
				RAM: [][2]uint32{{11025684, 2}, {11025685, 60}, {11025686, 49}, {11025687, 11}, {11025688, 72}, {11025689, 153}, {11025690, 108}, {11025691, 60}},
				Cycles: 20,
			},
		},
		{
			name: "500 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{2798591680, 2585790523, 256795648, 1944254009, 488338651, 895714591, 1778868225, 2483660720},
				A:   [7]uint32{4282162620, 235714245, 863562750, 3602177833, 2540637272, 1179480474, 738383557},
				PC:  5233844,
				SR:  33815,
				USP: 7606410,
				SSP: 6610904,
				RAM: [][2]uint32{{5233840, 2}, {5233841, 60}, {5233842, 54}, {5233843, 59}, {5233844, 57}, {5233845, 13}, {5233846, 127}, {5233847, 72}},
			},
			want: cpuState{
				D:   [8]uint32{2798591680, 2585790523, 256795648, 1944254009, 488338651, 895714591, 1778868225, 2483660720},
				A:   [7]uint32{4282162620, 235714245, 863562750, 3602177833, 2540637272, 1179480474, 738383557},
				PC:  5233848,
				SR:  33811,
				USP: 7606410,
				SSP: 6610904,
				RAM: [][2]uint32{{5233840, 2}, {5233841, 60}, {5233842, 54}, {5233843, 59}, {5233844, 57}, {5233845, 13}, {5233846, 127}, {5233847, 72}},
				Cycles: 20,
			},
		},
		{
			name: "1000 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{1775799822, 3989534912, 2821754111, 1297038457, 3566260420, 2709344996, 4092573831, 1921932936},
				A:   [7]uint32{1474311331, 738194302, 3856173952, 806405960, 1312624547, 3458197139, 365241768},
				PC:  10732816,
				SR:  777,
				USP: 3022586,
				SSP: 14776046,
				RAM: [][2]uint32{{10732812, 2}, {10732813, 60}, {10732814, 247}, {10732815, 4}, {10732816, 243}, {10732817, 88}, {10732818, 108}, {10732819, 163}},
			},
			want: cpuState{
				D:   [8]uint32{1775799822, 3989534912, 2821754111, 1297038457, 3566260420, 2709344996, 4092573831, 1921932936},
				A:   [7]uint32{1474311331, 738194302, 3856173952, 806405960, 1312624547, 3458197139, 365241768},
				PC:  10732820,
				SR:  768,
				USP: 3022586,
				SSP: 14776046,
				RAM: [][2]uint32{{10732812, 2}, {10732813, 60}, {10732814, 247}, {10732815, 4}, {10732816, 243}, {10732817, 88}, {10732818, 108}, {10732819, 163}},
				Cycles: 20,
			},
		},
		{
			name: "1500 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{1754205427, 4046007490, 3612996268, 1558972893, 2939616551, 1651951889, 2267801621, 1075918861},
				A:   [7]uint32{1309566184, 2431019489, 3295697609, 1635506180, 2688937581, 2055280930, 716133361},
				PC:  5151114,
				SR:  8199,
				USP: 1391726,
				SSP: 16714508,
				RAM: [][2]uint32{{5151110, 2}, {5151111, 60}, {5151112, 171}, {5151113, 151}, {5151114, 30}, {5151115, 139}, {5151116, 177}, {5151117, 192}},
			},
			want: cpuState{
				D:   [8]uint32{1754205427, 4046007490, 3612996268, 1558972893, 2939616551, 1651951889, 2267801621, 1075918861},
				A:   [7]uint32{1309566184, 2431019489, 3295697609, 1635506180, 2688937581, 2055280930, 716133361},
				PC:  5151118,
				SR:  8199,
				USP: 1391726,
				SSP: 16714508,
				RAM: [][2]uint32{{5151110, 2}, {5151111, 60}, {5151112, 171}, {5151113, 151}, {5151114, 30}, {5151115, 139}, {5151116, 177}, {5151117, 192}},
				Cycles: 20,
			},
		},
		{
			name: "2000 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{1099300018, 940426629, 3869948766, 527128038, 855977274, 4743712, 234477681, 2725936368},
				A:   [7]uint32{1995931642, 2538435678, 3561222761, 4202367902, 2739305189, 523105487, 3316047297},
				PC:  10886248,
				SR:  541,
				USP: 10476768,
				SSP: 13506134,
				RAM: [][2]uint32{{10886244, 2}, {10886245, 60}, {10886246, 77}, {10886247, 182}, {10886248, 41}, {10886249, 40}, {10886250, 41}, {10886251, 194}},
			},
			want: cpuState{
				D:   [8]uint32{1099300018, 940426629, 3869948766, 527128038, 855977274, 4743712, 234477681, 2725936368},
				A:   [7]uint32{1995931642, 2538435678, 3561222761, 4202367902, 2739305189, 523105487, 3316047297},
				PC:  10886252,
				SR:  532,
				USP: 10476768,
				SSP: 13506134,
				RAM: [][2]uint32{{10886244, 2}, {10886245, 60}, {10886246, 77}, {10886247, 182}, {10886248, 41}, {10886249, 40}, {10886250, 41}, {10886251, 194}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestANDItoSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{3459640781, 2161107310, 3673851381, 3966350034, 2658482892, 1746938383, 2698685285, 2763380764},
				A:   [7]uint32{2711838278, 4003804690, 3679479255, 3317997971, 1284187404, 4227771087, 3303715211},
				PC:  12215154,
				SR:  8217,
				USP: 13069110,
				SSP: 14468942,
				RAM: [][2]uint32{{12215150, 2}, {12215151, 124}, {12215152, 150}, {12215153, 135}, {12215154, 112}, {12215155, 55}, {12215156, 13}, {12215157, 212}},
			},
			want: cpuState{
				D:   [8]uint32{3459640781, 2161107310, 3673851381, 3966350034, 2658482892, 1746938383, 2698685285, 2763380764},
				A:   [7]uint32{2711838278, 4003804690, 3679479255, 3317997971, 1284187404, 4227771087, 3303715211},
				PC:  12215158,
				SR:  1,
				USP: 13069110,
				SSP: 14468942,
				RAM: [][2]uint32{{12215150, 2}, {12215151, 124}, {12215152, 150}, {12215153, 135}, {12215154, 112}, {12215155, 55}, {12215156, 13}, {12215157, 212}},
				Cycles: 20,
			},
		},
		{
			name: "500 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{714014076, 1382126148, 111899679, 444189039, 1612236006, 1401559108, 2974421732, 1685058078},
				A:   [7]uint32{3529313924, 4294150406, 3920337185, 414327992, 1389913282, 1298950257, 2560960595},
				PC:  4216426,
				SR:  8730,
				USP: 14117970,
				SSP: 5236638,
				RAM: [][2]uint32{{4216422, 2}, {4216423, 124}, {4216424, 91}, {4216425, 221}, {4216426, 219}, {4216427, 253}, {4216428, 60}, {4216429, 159}},
			},
			want: cpuState{
				D:   [8]uint32{714014076, 1382126148, 111899679, 444189039, 1612236006, 1401559108, 2974421732, 1685058078},
				A:   [7]uint32{3529313924, 4294150406, 3920337185, 414327992, 1389913282, 1298950257, 2560960595},
				PC:  4216430,
				SR:  536,
				USP: 14117970,
				SSP: 5236638,
				RAM: [][2]uint32{{4216422, 2}, {4216423, 124}, {4216424, 91}, {4216425, 221}, {4216426, 219}, {4216427, 253}, {4216428, 60}, {4216429, 159}},
				Cycles: 20,
			},
		},
		{
			name: "1000 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{3935066449, 3872404793, 2790397436, 3562431692, 2104790016, 198821825, 2371777081, 3133272606},
				A:   [7]uint32{1959783231, 3170665128, 1412868837, 3992449638, 91722344, 616347876, 837839017},
				PC:  10430008,
				SR:  42250,
				USP: 12437892,
				SSP: 3859694,
				RAM: [][2]uint32{{10430004, 2}, {10430005, 124}, {10430006, 95}, {10430007, 106}, {10430008, 49}, {10430009, 105}, {10430010, 220}, {10430011, 118}},
			},
			want: cpuState{
				D:   [8]uint32{3935066449, 3872404793, 2790397436, 3562431692, 2104790016, 198821825, 2371777081, 3133272606},
				A:   [7]uint32{1959783231, 3170665128, 1412868837, 3992449638, 91722344, 616347876, 837839017},
				PC:  10430012,
				SR:  1290,
				USP: 12437892,
				SSP: 3859694,
				RAM: [][2]uint32{{10430004, 2}, {10430005, 124}, {10430006, 95}, {10430007, 106}, {10430008, 49}, {10430009, 105}, {10430010, 220}, {10430011, 118}},
				Cycles: 20,
			},
		},
		{
			name: "1500 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{3094463805, 3686981744, 2965928281, 1683623908, 1546971795, 867516037, 1299473818, 1953913437},
				A:   [7]uint32{2682908306, 2636861669, 3248581234, 2057777741, 2142976044, 3292800176, 4185573784},
				PC:  2964658,
				SR:  41987,
				USP: 5027152,
				SSP: 9762996,
				RAM: [][2]uint32{{2964654, 2}, {2964655, 124}, {2964656, 113}, {2964657, 251}, {2964658, 200}, {2964659, 208}, {2964660, 147}, {2964661, 190}},
			},
			want: cpuState{
				D:   [8]uint32{3094463805, 3686981744, 2965928281, 1683623908, 1546971795, 867516037, 1299473818, 1953913437},
				A:   [7]uint32{2682908306, 2636861669, 3248581234, 2057777741, 2142976044, 3292800176, 4185573784},
				PC:  2964662,
				SR:  8195,
				USP: 5027152,
				SSP: 9762996,
				RAM: [][2]uint32{{2964654, 2}, {2964655, 124}, {2964656, 113}, {2964657, 251}, {2964658, 200}, {2964659, 208}, {2964660, 147}, {2964661, 190}},
				Cycles: 20,
			},
		},
		{
			name: "2000 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{1324839251, 33861968, 1149944653, 171477786, 662778086, 511730785, 4079270999, 1319458689},
				A:   [7]uint32{2509047096, 709529370, 714699047, 3078534255, 4069622478, 3131152765, 2527322859},
				PC:  4865010,
				SR:  42765,
				USP: 14276454,
				SSP: 7954590,
				RAM: [][2]uint32{{4865006, 2}, {4865007, 124}, {4865008, 214}, {4865009, 55}, {4865010, 70}, {4865011, 17}, {4865012, 37}, {4865013, 138}},
			},
			want: cpuState{
				D:   [8]uint32{1324839251, 33861968, 1149944653, 171477786, 662778086, 511730785, 4079270999, 1319458689},
				A:   [7]uint32{2509047096, 709529370, 714699047, 3078534255, 4069622478, 3131152765, 2527322859},
				PC:  4865014,
				SR:  34309,
				USP: 14276454,
				SSP: 7954590,
				RAM: [][2]uint32{{4865006, 2}, {4865007, 124}, {4865008, 214}, {4865009, 55}, {4865010, 70}, {4865011, 17}, {4865012, 37}, {4865013, 138}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestORItoCCR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{3542872148, 544413609, 1317562079, 551499346, 950627486, 3896915218, 3436502336, 2530072704},
				A:   [7]uint32{571182691, 4072612502, 2302579413, 778573855, 3676664038, 1509906265, 3985785766},
				PC:  3404298,
				SR:  34304,
				USP: 15915922,
				SSP: 13564828,
				RAM: [][2]uint32{{3404294, 0}, {3404295, 60}, {3404296, 84}, {3404297, 131}, {3404298, 83}, {3404299, 198}, {3404300, 59}, {3404301, 70}},
			},
			want: cpuState{
				D:   [8]uint32{3542872148, 544413609, 1317562079, 551499346, 950627486, 3896915218, 3436502336, 2530072704},
				A:   [7]uint32{571182691, 4072612502, 2302579413, 778573855, 3676664038, 1509906265, 3985785766},
				PC:  3404302,
				SR:  34307,
				USP: 15915922,
				SSP: 13564828,
				RAM: [][2]uint32{{3404294, 0}, {3404295, 60}, {3404296, 84}, {3404297, 131}, {3404298, 83}, {3404299, 198}, {3404300, 59}, {3404301, 70}},
				Cycles: 20,
			},
		},
		{
			name: "500 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{884058314, 973040952, 1601427688, 2254056162, 3885609021, 1072937697, 2619293114, 1621708156},
				A:   [7]uint32{3053862269, 1895877093, 1985797422, 3190960611, 2201878251, 3755800734, 1811674399},
				PC:  3039204,
				SR:  15,
				USP: 5550852,
				SSP: 8264636,
				RAM: [][2]uint32{{3039200, 0}, {3039201, 60}, {3039202, 60}, {3039203, 161}, {3039204, 224}, {3039205, 245}, {3039206, 223}, {3039207, 199}},
			},
			want: cpuState{
				D:   [8]uint32{884058314, 973040952, 1601427688, 2254056162, 3885609021, 1072937697, 2619293114, 1621708156},
				A:   [7]uint32{3053862269, 1895877093, 1985797422, 3190960611, 2201878251, 3755800734, 1811674399},
				PC:  3039208,
				SR:  15,
				USP: 5550852,
				SSP: 8264636,
				RAM: [][2]uint32{{3039200, 0}, {3039201, 60}, {3039202, 60}, {3039203, 161}, {3039204, 224}, {3039205, 245}, {3039206, 223}, {3039207, 199}},
				Cycles: 20,
			},
		},
		{
			name: "1000 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{2797498413, 2066311242, 2303955841, 1562167423, 3362563945, 4181131441, 1532713819, 3352466183},
				A:   [7]uint32{3145313735, 3587802102, 4229171104, 1395740882, 2771540999, 971998958, 3846782843},
				PC:  1920400,
				SR:  8717,
				USP: 14150354,
				SSP: 13228146,
				RAM: [][2]uint32{{1920396, 0}, {1920397, 60}, {1920398, 126}, {1920399, 151}, {1920400, 103}, {1920401, 159}, {1920402, 188}, {1920403, 157}},
			},
			want: cpuState{
				D:   [8]uint32{2797498413, 2066311242, 2303955841, 1562167423, 3362563945, 4181131441, 1532713819, 3352466183},
				A:   [7]uint32{3145313735, 3587802102, 4229171104, 1395740882, 2771540999, 971998958, 3846782843},
				PC:  1920404,
				SR:  8735,
				USP: 14150354,
				SSP: 13228146,
				RAM: [][2]uint32{{1920396, 0}, {1920397, 60}, {1920398, 126}, {1920399, 151}, {1920400, 103}, {1920401, 159}, {1920402, 188}, {1920403, 157}},
				Cycles: 20,
			},
		},
		{
			name: "1500 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{1360090052, 2083171423, 454538824, 1790806911, 606402259, 3278317315, 2539857203, 1013968003},
				A:   [7]uint32{2448902965, 2417918143, 2852608161, 1515876372, 3309719249, 2709563702, 1798203392},
				PC:  1680946,
				SR:  42260,
				USP: 8665760,
				SSP: 15454702,
				RAM: [][2]uint32{{1680942, 0}, {1680943, 60}, {1680944, 216}, {1680945, 159}, {1680946, 181}, {1680947, 34}, {1680948, 94}, {1680949, 10}},
			},
			want: cpuState{
				D:   [8]uint32{1360090052, 2083171423, 454538824, 1790806911, 606402259, 3278317315, 2539857203, 1013968003},
				A:   [7]uint32{2448902965, 2417918143, 2852608161, 1515876372, 3309719249, 2709563702, 1798203392},
				PC:  1680950,
				SR:  42271,
				USP: 8665760,
				SSP: 15454702,
				RAM: [][2]uint32{{1680942, 0}, {1680943, 60}, {1680944, 216}, {1680945, 159}, {1680946, 181}, {1680947, 34}, {1680948, 94}, {1680949, 10}},
				Cycles: 20,
			},
		},
		{
			name: "2000 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{2617415649, 2954850949, 4173116780, 3010631063, 1295423765, 2693460691, 1329508826, 2358737820},
				A:   [7]uint32{1166943799, 274410818, 376070139, 593733769, 4282115851, 2419780594, 1611158113},
				PC:  9557374,
				SR:  8717,
				USP: 2280478,
				SSP: 13465180,
				RAM: [][2]uint32{{9557370, 0}, {9557371, 60}, {9557372, 39}, {9557373, 92}, {9557374, 84}, {9557375, 41}, {9557376, 158}, {9557377, 171}},
			},
			want: cpuState{
				D:   [8]uint32{2617415649, 2954850949, 4173116780, 3010631063, 1295423765, 2693460691, 1329508826, 2358737820},
				A:   [7]uint32{1166943799, 274410818, 376070139, 593733769, 4282115851, 2419780594, 1611158113},
				PC:  9557378,
				SR:  8733,
				USP: 2280478,
				SSP: 13465180,
				RAM: [][2]uint32{{9557370, 0}, {9557371, 60}, {9557372, 39}, {9557373, 92}, {9557374, 84}, {9557375, 41}, {9557376, 158}, {9557377, 171}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestORItoSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{734462758, 866766591, 979291018, 1700308395, 2488217381, 688903976, 2773834445, 1178555761},
				A:   [7]uint32{4087024662, 134204255, 4033315928, 3616179702, 2973769467, 4102457109, 1254878508},
				PC:  5187698,
				SR:  1565,
				USP: 14675700,
				SSP: 4285128,
				RAM: [][2]uint32{{5187694, 0}, {5187695, 124}, {5187696, 185}, {5187697, 179}, {32, 77}, {33, 80}, {34, 100}, {35, 102}, {5268582, 11}, {5268583, 117}, {5268584, 163}, {5268585, 91}},
			},
			want: cpuState{
				D:   [8]uint32{734462758, 866766591, 979291018, 1700308395, 2488217381, 688903976, 2773834445, 1178555761},
				A:   [7]uint32{4087024662, 134204255, 4033315928, 3616179702, 2973769467, 4102457109, 1254878508},
				PC:  1297114218,
				SR:  9757,
				USP: 14675700,
				SSP: 4285122,
				RAM: [][2]uint32{{5187694, 0}, {5187695, 124}, {5187696, 185}, {5187697, 179}, {4285126, 40}, {4285127, 110}, {4285122, 6}, {4285123, 29}, {4285124, 0}, {4285125, 79}, {32, 77}, {33, 80}, {34, 100}, {35, 102}, {5268582, 11}, {5268583, 117}, {5268584, 163}, {5268585, 91}},
				Cycles: 34,
			},
		},
		{
			name: "500 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{3965599243, 3103488195, 141927582, 2269521656, 475542698, 1835345101, 3900303931, 3815758383},
				A:   [7]uint32{3865371475, 1939172057, 3700522716, 2850206247, 3412917320, 819214616, 2061186289},
				PC:  3623754,
				SR:  41220,
				USP: 13741046,
				SSP: 1439618,
				RAM: [][2]uint32{{3623750, 0}, {3623751, 124}, {3623752, 5}, {3623753, 91}, {3623754, 225}, {3623755, 162}, {3623756, 68}, {3623757, 127}},
			},
			want: cpuState{
				D:   [8]uint32{3965599243, 3103488195, 141927582, 2269521656, 475542698, 1835345101, 3900303931, 3815758383},
				A:   [7]uint32{3865371475, 1939172057, 3700522716, 2850206247, 3412917320, 819214616, 2061186289},
				PC:  3623758,
				SR:  42271,
				USP: 13741046,
				SSP: 1439618,
				RAM: [][2]uint32{{3623750, 0}, {3623751, 124}, {3623752, 5}, {3623753, 91}, {3623754, 225}, {3623755, 162}, {3623756, 68}, {3623757, 127}},
				Cycles: 20,
			},
		},
		{
			name: "1000 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{959100987, 647370043, 3682450805, 128411110, 276021068, 3047512134, 1702415021, 1698967366},
				A:   [7]uint32{167930879, 1853232461, 3862213266, 2864820735, 32055627, 2620160318, 945599985},
				PC:  13391478,
				SR:  34053,
				USP: 8376144,
				SSP: 14192004,
				RAM: [][2]uint32{{13391474, 0}, {13391475, 124}, {13391476, 193}, {13391477, 81}, {32, 201}, {33, 96}, {34, 247}, {35, 108}, {6354796, 209}, {6354797, 58}, {6354798, 16}, {6354799, 201}},
			},
			want: cpuState{
				D:   [8]uint32{959100987, 647370043, 3682450805, 128411110, 276021068, 3047512134, 1702415021, 1698967366},
				A:   [7]uint32{167930879, 1853232461, 3862213266, 2864820735, 32055627, 2620160318, 945599985},
				PC:  3378575216,
				SR:  9477,
				USP: 8376144,
				SSP: 14191998,
				RAM: [][2]uint32{{13391474, 0}, {13391475, 124}, {13391476, 193}, {13391477, 81}, {14192002, 86}, {14192003, 114}, {14191998, 133}, {14191999, 5}, {14192000, 0}, {14192001, 204}, {32, 201}, {33, 96}, {34, 247}, {35, 108}, {6354796, 209}, {6354797, 58}, {6354798, 16}, {6354799, 201}},
				Cycles: 34,
			},
		},
		{
			name: "1500 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{2081353747, 606498031, 2003530278, 1632046300, 2782269871, 511044656, 3340906696, 854384314},
				A:   [7]uint32{4042654061, 3123222309, 502632494, 3145476526, 2902495861, 253237620, 2219024668},
				PC:  7962198,
				SR:  22,
				USP: 10066682,
				SSP: 8294804,
				RAM: [][2]uint32{{7962194, 0}, {7962195, 124}, {7962196, 228}, {7962197, 148}, {32, 225}, {33, 232}, {34, 233}, {35, 18}, {15264018, 29}, {15264019, 85}, {15264020, 193}, {15264021, 235}},
			},
			want: cpuState{
				D:   [8]uint32{2081353747, 606498031, 2003530278, 1632046300, 2782269871, 511044656, 3340906696, 854384314},
				A:   [7]uint32{4042654061, 3123222309, 502632494, 3145476526, 2902495861, 253237620, 2219024668},
				PC:  3790137622,
				SR:  8214,
				USP: 10066682,
				SSP: 8294798,
				RAM: [][2]uint32{{7962194, 0}, {7962195, 124}, {7962196, 228}, {7962197, 148}, {8294802, 126}, {8294803, 82}, {8294798, 0}, {8294799, 22}, {8294800, 0}, {8294801, 121}, {32, 225}, {33, 232}, {34, 233}, {35, 18}, {15264018, 29}, {15264019, 85}, {15264020, 193}, {15264021, 235}},
				Cycles: 34,
			},
		},
		{
			name: "2000 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{1515364952, 1808989505, 3360149659, 4106425325, 2277043743, 3687217787, 1581562198, 3827847434},
				A:   [7]uint32{658122125, 1337067040, 1316107772, 2964357717, 2039227919, 1865919042, 421570542},
				PC:  8895478,
				SR:  33296,
				USP: 16560642,
				SSP: 15793234,
				RAM: [][2]uint32{{8895474, 0}, {8895475, 124}, {8895476, 185}, {8895477, 110}, {32, 129}, {33, 56}, {34, 154}, {35, 246}, {3709686, 47}, {3709687, 232}, {3709688, 162}, {3709689, 206}},
			},
			want: cpuState{
				D:   [8]uint32{1515364952, 1808989505, 3360149659, 4106425325, 2277043743, 3687217787, 1581562198, 3827847434},
				A:   [7]uint32{658122125, 1337067040, 1316107772, 2964357717, 2039227919, 1865919042, 421570542},
				PC:  2167970554,
				SR:  8720,
				USP: 16560642,
				SSP: 15793228,
				RAM: [][2]uint32{{8895474, 0}, {8895475, 124}, {8895476, 185}, {8895477, 110}, {15793232, 187}, {15793233, 242}, {15793228, 130}, {15793229, 16}, {15793230, 0}, {15793231, 135}, {32, 129}, {33, 56}, {34, 154}, {35, 246}, {3709686, 47}, {3709687, 232}, {3709688, 162}, {3709689, 206}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEORItoCCR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{1868907750, 709266115, 2704618461, 1932055206, 2138770018, 989869050, 3757548310, 992156990},
				A:   [7]uint32{3296999902, 1011317068, 2768009615, 1314656404, 521203327, 552644832, 4209516611},
				PC:  6354384,
				SR:  41233,
				USP: 1839076,
				SSP: 12755256,
				RAM: [][2]uint32{{6354380, 10}, {6354381, 60}, {6354382, 63}, {6354383, 21}, {6354384, 33}, {6354385, 164}, {6354386, 123}, {6354387, 9}},
			},
			want: cpuState{
				D:   [8]uint32{1868907750, 709266115, 2704618461, 1932055206, 2138770018, 989869050, 3757548310, 992156990},
				A:   [7]uint32{3296999902, 1011317068, 2768009615, 1314656404, 521203327, 552644832, 4209516611},
				PC:  6354388,
				SR:  41220,
				USP: 1839076,
				SSP: 12755256,
				RAM: [][2]uint32{{6354380, 10}, {6354381, 60}, {6354382, 63}, {6354383, 21}, {6354384, 33}, {6354385, 164}, {6354386, 123}, {6354387, 9}},
				Cycles: 20,
			},
		},
		{
			name: "500 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{1856053249, 2746474562, 496256537, 1207437040, 728287027, 2628046923, 1318105493, 1153055414},
				A:   [7]uint32{3561936910, 4277101086, 700863900, 1540290946, 2542697188, 154319561, 2768004356},
				PC:  13838814,
				SR:  42009,
				USP: 6981556,
				SSP: 12519522,
				RAM: [][2]uint32{{13838810, 10}, {13838811, 60}, {13838812, 13}, {13838813, 62}, {13838814, 50}, {13838815, 31}, {13838816, 195}, {13838817, 50}},
			},
			want: cpuState{
				D:   [8]uint32{1856053249, 2746474562, 496256537, 1207437040, 728287027, 2628046923, 1318105493, 1153055414},
				A:   [7]uint32{3561936910, 4277101086, 700863900, 1540290946, 2542697188, 154319561, 2768004356},
				PC:  13838818,
				SR:  41991,
				USP: 6981556,
				SSP: 12519522,
				RAM: [][2]uint32{{13838810, 10}, {13838811, 60}, {13838812, 13}, {13838813, 62}, {13838814, 50}, {13838815, 31}, {13838816, 195}, {13838817, 50}},
				Cycles: 20,
			},
		},
		{
			name: "1000 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{2280714596, 2924719375, 2586354702, 3806494595, 3451950454, 750559815, 2741061343, 2684021488},
				A:   [7]uint32{4277589726, 4202747865, 2112193502, 269709997, 3733571038, 3996061132, 2278032047},
				PC:  9890772,
				SR:  42241,
				USP: 6167144,
				SSP: 5566098,
				RAM: [][2]uint32{{9890768, 10}, {9890769, 60}, {9890770, 171}, {9890771, 61}, {9890772, 53}, {9890773, 75}, {9890774, 190}, {9890775, 61}},
			},
			want: cpuState{
				D:   [8]uint32{2280714596, 2924719375, 2586354702, 3806494595, 3451950454, 750559815, 2741061343, 2684021488},
				A:   [7]uint32{4277589726, 4202747865, 2112193502, 269709997, 3733571038, 3996061132, 2278032047},
				PC:  9890776,
				SR:  42268,
				USP: 6167144,
				SSP: 5566098,
				RAM: [][2]uint32{{9890768, 10}, {9890769, 60}, {9890770, 171}, {9890771, 61}, {9890772, 53}, {9890773, 75}, {9890774, 190}, {9890775, 61}},
				Cycles: 20,
			},
		},
		{
			name: "1500 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{3459851696, 3571004347, 2957111029, 2144688765, 4187815854, 1250707856, 375704960, 838359100},
				A:   [7]uint32{4124681873, 1070955796, 2045518755, 1246377620, 1979500972, 173959096, 4002867008},
				PC:  1731474,
				SR:  1543,
				USP: 10316944,
				SSP: 6130934,
				RAM: [][2]uint32{{1731470, 10}, {1731471, 60}, {1731472, 154}, {1731473, 172}, {1731474, 1}, {1731475, 217}, {1731476, 36}, {1731477, 217}},
			},
			want: cpuState{
				D:   [8]uint32{3459851696, 3571004347, 2957111029, 2144688765, 4187815854, 1250707856, 375704960, 838359100},
				A:   [7]uint32{4124681873, 1070955796, 2045518755, 1246377620, 1979500972, 173959096, 4002867008},
				PC:  1731478,
				SR:  1547,
				USP: 10316944,
				SSP: 6130934,
				RAM: [][2]uint32{{1731470, 10}, {1731471, 60}, {1731472, 154}, {1731473, 172}, {1731474, 1}, {1731475, 217}, {1731476, 36}, {1731477, 217}},
				Cycles: 20,
			},
		},
		{
			name: "2000 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{35761447, 690031813, 3594965879, 2666791947, 1454953287, 982352235, 2536586741, 3970384421},
				A:   [7]uint32{164513601, 3378154448, 1944313648, 1771893011, 3010287422, 167419578, 2061810012},
				PC:  12547242,
				SR:  8455,
				USP: 6478890,
				SSP: 15233036,
				RAM: [][2]uint32{{12547238, 10}, {12547239, 60}, {12547240, 243}, {12547241, 167}, {12547242, 156}, {12547243, 113}, {12547244, 91}, {12547245, 143}},
			},
			want: cpuState{
				D:   [8]uint32{35761447, 690031813, 3594965879, 2666791947, 1454953287, 982352235, 2536586741, 3970384421},
				A:   [7]uint32{164513601, 3378154448, 1944313648, 1771893011, 3010287422, 167419578, 2061810012},
				PC:  12547246,
				SR:  8448,
				USP: 6478890,
				SSP: 15233036,
				RAM: [][2]uint32{{12547238, 10}, {12547239, 60}, {12547240, 243}, {12547241, 167}, {12547242, 156}, {12547243, 113}, {12547244, 91}, {12547245, 143}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEORItoSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{1293837843, 1637587384, 1520147821, 4147878201, 4265273769, 2590716670, 1334787273, 1614203674},
				A:   [7]uint32{3303257199, 1139246236, 27863902, 2388846274, 3765859255, 3160100158, 1336615608},
				PC:  1285236,
				SR:  41995,
				USP: 821502,
				SSP: 12825168,
				RAM: [][2]uint32{{1285232, 10}, {1285233, 124}, {1285234, 170}, {1285235, 48}, {1285236, 143}, {1285237, 133}, {1285238, 21}, {1285239, 78}},
			},
			want: cpuState{
				D:   [8]uint32{1293837843, 1637587384, 1520147821, 4147878201, 4265273769, 2590716670, 1334787273, 1614203674},
				A:   [7]uint32{3303257199, 1139246236, 27863902, 2388846274, 3765859255, 3160100158, 1336615608},
				PC:  1285240,
				SR:  1563,
				USP: 821502,
				SSP: 12825168,
				RAM: [][2]uint32{{1285232, 10}, {1285233, 124}, {1285234, 170}, {1285235, 48}, {1285236, 143}, {1285237, 133}, {1285238, 21}, {1285239, 78}},
				Cycles: 20,
			},
		},
		{
			name: "500 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{922788254, 1938174579, 4037914579, 3852611098, 1607190208, 3995423588, 2895770495, 1549782587},
				A:   [7]uint32{2823439270, 4087894379, 128116920, 2848877944, 1462312717, 3543802921, 3030944344},
				PC:  6464582,
				SR:  275,
				USP: 343380,
				SSP: 9508550,
				RAM: [][2]uint32{{6464578, 10}, {6464579, 124}, {6464580, 87}, {6464581, 52}, {32, 3}, {33, 6}, {34, 95}, {35, 218}, {417754, 181}, {417755, 146}, {417756, 64}, {417757, 9}},
			},
			want: cpuState{
				D:   [8]uint32{922788254, 1938174579, 4037914579, 3852611098, 1607190208, 3995423588, 2895770495, 1549782587},
				A:   [7]uint32{2823439270, 4087894379, 128116920, 2848877944, 1462312717, 3543802921, 3030944344},
				PC:  50749406,
				SR:  8467,
				USP: 343380,
				SSP: 9508544,
				RAM: [][2]uint32{{6464578, 10}, {6464579, 124}, {6464580, 87}, {6464581, 52}, {9508548, 164}, {9508549, 66}, {9508544, 1}, {9508545, 19}, {9508546, 0}, {9508547, 98}, {32, 3}, {33, 6}, {34, 95}, {35, 218}, {417754, 181}, {417755, 146}, {417756, 64}, {417757, 9}},
				Cycles: 34,
			},
		},
		{
			name: "1000 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{4049693525, 1090011299, 2299937968, 2374597623, 666122521, 2264451151, 3237538528, 3509457271},
				A:   [7]uint32{3303677318, 616356545, 2174941577, 1314441383, 2596872042, 4222730540, 2147809187},
				PC:  1046258,
				SR:  9738,
				USP: 4878182,
				SSP: 9301494,
				RAM: [][2]uint32{{1046254, 10}, {1046255, 124}, {1046256, 79}, {1046257, 191}, {1046258, 36}, {1046259, 69}, {1046260, 205}, {1046261, 41}},
			},
			want: cpuState{
				D:   [8]uint32{4049693525, 1090011299, 2299937968, 2374597623, 666122521, 2264451151, 3237538528, 3509457271},
				A:   [7]uint32{3303677318, 616356545, 2174941577, 1314441383, 2596872042, 4222730540, 2147809187},
				PC:  1046262,
				SR:  8469,
				USP: 4878182,
				SSP: 9301494,
				RAM: [][2]uint32{{1046254, 10}, {1046255, 124}, {1046256, 79}, {1046257, 191}, {1046258, 36}, {1046259, 69}, {1046260, 205}, {1046261, 41}},
				Cycles: 20,
			},
		},
		{
			name: "1500 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{2311250540, 4144552559, 994616553, 324540390, 3479460874, 3955002106, 1970689559, 2270560657},
				A:   [7]uint32{553924943, 1943644148, 2513271543, 2175646757, 2934542004, 3714557792, 4026886972},
				PC:  16316154,
				SR:  1050,
				USP: 13349218,
				SSP: 7936814,
				RAM: [][2]uint32{{16316150, 10}, {16316151, 124}, {16316152, 67}, {16316153, 9}, {32, 75}, {33, 58}, {34, 97}, {35, 108}, {3826028, 178}, {3826029, 110}, {3826030, 247}, {3826031, 159}},
			},
			want: cpuState{
				D:   [8]uint32{2311250540, 4144552559, 994616553, 324540390, 3479460874, 3955002106, 1970689559, 2270560657},
				A:   [7]uint32{553924943, 1943644148, 2513271543, 2175646757, 2934542004, 3714557792, 4026886972},
				PC:  1262117232,
				SR:  9242,
				USP: 13349218,
				SSP: 7936808,
				RAM: [][2]uint32{{16316150, 10}, {16316151, 124}, {16316152, 67}, {16316153, 9}, {7936812, 246}, {7936813, 246}, {7936808, 4}, {7936809, 26}, {7936810, 0}, {7936811, 248}, {32, 75}, {33, 58}, {34, 97}, {35, 108}, {3826028, 178}, {3826029, 110}, {3826030, 247}, {3826031, 159}},
				Cycles: 34,
			},
		},
		{
			name: "2000 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{3872350169, 1544425329, 2806066907, 1368784909, 2592332215, 2954225763, 1295627581, 3900973319},
				A:   [7]uint32{3461219992, 3995678330, 3908737328, 342147372, 2173076479, 531492373, 3687999209},
				PC:  1593770,
				SR:  8209,
				USP: 15534840,
				SSP: 10523364,
				RAM: [][2]uint32{{1593766, 10}, {1593767, 124}, {1593768, 150}, {1593769, 254}, {1593770, 165}, {1593771, 216}, {1593772, 37}, {1593773, 245}},
			},
			want: cpuState{
				D:   [8]uint32{3872350169, 1544425329, 2806066907, 1368784909, 2592332215, 2954225763, 1295627581, 3900973319},
				A:   [7]uint32{3461219992, 3995678330, 3908737328, 342147372, 2173076479, 531492373, 3687999209},
				PC:  1593774,
				SR:  42511,
				USP: 15534840,
				SSP: 10523364,
				RAM: [][2]uint32{{1593766, 10}, {1593767, 124}, {1593768, 150}, {1593769, 254}, {1593770, 165}, {1593771, 216}, {1593772, 37}, {1593773, 245}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}
