package m68k

import "testing"

func TestNOP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{3852648315, 2469214665, 2500578360, 1291102260, 2316984846, 1285845352, 636284809, 3518498312},
				A:   [7]uint32{572706894, 3955165096, 2355699420, 1579637945, 2322612306, 3835716544, 1363046691},
				PC:  911852,
				SR:  777,
				USP: 7532898,
				SSP: 2766466,
				RAM: [][2]uint32{{911848, 78}, {911849, 113}, {911850, 216}, {911851, 176}, {911852, 50}, {911853, 107}},
			},
			want: cpuState{
				D:   [8]uint32{3852648315, 2469214665, 2500578360, 1291102260, 2316984846, 1285845352, 636284809, 3518498312},
				A:   [7]uint32{572706894, 3955165096, 2355699420, 1579637945, 2322612306, 3835716544, 1363046691},
				PC:  911854,
				SR:  777,
				USP: 7532898,
				SSP: 2766466,
				RAM: [][2]uint32{{911848, 78}, {911849, 113}, {911850, 216}, {911851, 176}, {911852, 50}, {911853, 107}},
				Cycles: 4,
			},
		},
		{
			name: "500 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{1336455012, 2302714532, 3681818393, 1720950761, 1367566374, 3193636926, 2978403133, 1741363449},
				A:   [7]uint32{3191439818, 3159619623, 152826693, 4266326721, 4196655592, 4235835338, 563791152},
				PC:  12486314,
				SR:  41239,
				USP: 13726848,
				SSP: 1860426,
				RAM: [][2]uint32{{12486310, 78}, {12486311, 113}, {12486312, 7}, {12486313, 6}, {12486314, 253}, {12486315, 18}},
			},
			want: cpuState{
				D:   [8]uint32{1336455012, 2302714532, 3681818393, 1720950761, 1367566374, 3193636926, 2978403133, 1741363449},
				A:   [7]uint32{3191439818, 3159619623, 152826693, 4266326721, 4196655592, 4235835338, 563791152},
				PC:  12486316,
				SR:  41239,
				USP: 13726848,
				SSP: 1860426,
				RAM: [][2]uint32{{12486310, 78}, {12486311, 113}, {12486312, 7}, {12486313, 6}, {12486314, 253}, {12486315, 18}},
				Cycles: 4,
			},
		},
		{
			name: "1000 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{3006569406, 2232358076, 2726035704, 2876765372, 2315095877, 3411150333, 1161860592, 339229040},
				A:   [7]uint32{2810486888, 4272451012, 2169616790, 1966267773, 2810133219, 1029785266, 2554366975},
				PC:  11986204,
				SR:  41241,
				USP: 9640712,
				SSP: 5212704,
				RAM: [][2]uint32{{11986200, 78}, {11986201, 113}, {11986202, 143}, {11986203, 101}, {11986204, 171}, {11986205, 211}},
			},
			want: cpuState{
				D:   [8]uint32{3006569406, 2232358076, 2726035704, 2876765372, 2315095877, 3411150333, 1161860592, 339229040},
				A:   [7]uint32{2810486888, 4272451012, 2169616790, 1966267773, 2810133219, 1029785266, 2554366975},
				PC:  11986206,
				SR:  41241,
				USP: 9640712,
				SSP: 5212704,
				RAM: [][2]uint32{{11986200, 78}, {11986201, 113}, {11986202, 143}, {11986203, 101}, {11986204, 171}, {11986205, 211}},
				Cycles: 4,
			},
		},
		{
			name: "1500 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{847813040, 1842730397, 228953195, 1141002121, 4024913238, 3810996081, 1430982421, 3218670678},
				A:   [7]uint32{320962809, 1899590097, 1193472526, 4039917568, 4004340175, 4078302743, 1644730669},
				PC:  7802208,
				SR:  42262,
				USP: 15477618,
				SSP: 6204940,
				RAM: [][2]uint32{{7802204, 78}, {7802205, 113}, {7802206, 74}, {7802207, 21}, {7802208, 84}, {7802209, 19}},
			},
			want: cpuState{
				D:   [8]uint32{847813040, 1842730397, 228953195, 1141002121, 4024913238, 3810996081, 1430982421, 3218670678},
				A:   [7]uint32{320962809, 1899590097, 1193472526, 4039917568, 4004340175, 4078302743, 1644730669},
				PC:  7802210,
				SR:  42262,
				USP: 15477618,
				SSP: 6204940,
				RAM: [][2]uint32{{7802204, 78}, {7802205, 113}, {7802206, 74}, {7802207, 21}, {7802208, 84}, {7802209, 19}},
				Cycles: 4,
			},
		},
		{
			name: "2000 NOP 4e71",
			init: cpuState{
				D:   [8]uint32{4162527581, 3632244014, 998295343, 3181753239, 3133752483, 2790191184, 438977060, 2392276731},
				A:   [7]uint32{12214623, 1628527616, 3430659164, 324523237, 899492061, 1648972444, 4277930460},
				PC:  1602062,
				SR:  34583,
				USP: 8955260,
				SSP: 1393366,
				RAM: [][2]uint32{{1602058, 78}, {1602059, 113}, {1602060, 112}, {1602061, 3}, {1602062, 98}, {1602063, 164}},
			},
			want: cpuState{
				D:   [8]uint32{4162527581, 3632244014, 998295343, 3181753239, 3133752483, 2790191184, 438977060, 2392276731},
				A:   [7]uint32{12214623, 1628527616, 3430659164, 324523237, 899492061, 1648972444, 4277930460},
				PC:  1602064,
				SR:  34583,
				USP: 8955260,
				SSP: 1393366,
				RAM: [][2]uint32{{1602058, 78}, {1602059, 113}, {1602060, 112}, {1602061, 3}, {1602062, 98}, {1602063, 164}},
				Cycles: 4,
			},
		},
		{
			name: "001 NOP 4e71",
			init: 			cpuState{
				D:   [8]uint32{130039335, 3652843156, 239465659, 3216061182, 291528425, 1956953881, 776552213, 2552657501},
				A:   [7]uint32{3411674231, 1674074947, 2040393186, 607946587, 1771838298, 3933828155, 3187790330},
				PC:  15690342,
				SR:  8192,
				USP: 6268688,
				SSP: 6149432,
				RAM: [][2]uint32{{15690338, 78}, {15690339, 113}, {15690340, 163}, {15690341, 182}, {15690342, 220}, {15690343, 237}},
			},
			want: 			cpuState{
				D:   [8]uint32{130039335, 3652843156, 239465659, 3216061182, 291528425, 1956953881, 776552213, 2552657501},
				A:   [7]uint32{3411674231, 1674074947, 2040393186, 607946587, 1771838298, 3933828155, 3187790330},
				PC:  15690344,
				SR:  8192,
				USP: 6268688,
				SSP: 6149432,
				RAM: [][2]uint32{{15690338, 78}, {15690339, 113}, {15690340, 163}, {15690341, 182}, {15690342, 220}, {15690343, 237}},
				Cycles: 4,
			},
		},
		{
			name: "290 NOP 4e71",
			init: 			cpuState{
				D:   [8]uint32{2081933674, 1389349536, 98521203, 264018986, 400068046, 1386217286, 403878092, 2938825168},
				A:   [7]uint32{1848192416, 207368327, 550508063, 1653211131, 3998020484, 3858455794, 3718008074},
				PC:  2205690,
				SR:  260,
				USP: 13696610,
				SSP: 7413020,
				RAM: [][2]uint32{{2205686, 78}, {2205687, 113}, {2205688, 95}, {2205689, 39}, {2205690, 253}, {2205691, 195}},
			},
			want: 			cpuState{
				D:   [8]uint32{2081933674, 1389349536, 98521203, 264018986, 400068046, 1386217286, 403878092, 2938825168},
				A:   [7]uint32{1848192416, 207368327, 550508063, 1653211131, 3998020484, 3858455794, 3718008074},
				PC:  2205692,
				SR:  260,
				USP: 13696610,
				SSP: 7413020,
				RAM: [][2]uint32{{2205686, 78}, {2205687, 113}, {2205688, 95}, {2205689, 39}, {2205690, 253}, {2205691, 195}},
				Cycles: 4,
			},
		},
		{
			name: "564 NOP 4e71",
			init: 			cpuState{
				D:   [8]uint32{37727547, 1753694164, 4230975149, 3105420330, 894658944, 3201704370, 2220650633, 644924303},
				A:   [7]uint32{4132674880, 848989229, 3101881272, 179336570, 3066129575, 1153996350, 3766842930},
				PC:  11855808,
				SR:  534,
				USP: 10416022,
				SSP: 2427206,
				RAM: [][2]uint32{{11855804, 78}, {11855805, 113}, {11855806, 31}, {11855807, 146}, {11855808, 67}, {11855809, 153}},
			},
			want: 			cpuState{
				D:   [8]uint32{37727547, 1753694164, 4230975149, 3105420330, 894658944, 3201704370, 2220650633, 644924303},
				A:   [7]uint32{4132674880, 848989229, 3101881272, 179336570, 3066129575, 1153996350, 3766842930},
				PC:  11855810,
				SR:  534,
				USP: 10416022,
				SSP: 2427206,
				RAM: [][2]uint32{{11855804, 78}, {11855805, 113}, {11855806, 31}, {11855807, 146}, {11855808, 67}, {11855809, 153}},
				Cycles: 4,
			},
		},
		{
			name: "822 NOP 4e71",
			init: 			cpuState{
				D:   [8]uint32{245624528, 1557216396, 1527077180, 3254141209, 2258485553, 97976962, 1862540457, 2369691499},
				A:   [7]uint32{2849037476, 3449471909, 1329233878, 2993620988, 2748393889, 458380700, 1901781166},
				PC:  12330866,
				SR:  9226,
				USP: 3417952,
				SSP: 15337942,
				RAM: [][2]uint32{{12330862, 78}, {12330863, 113}, {12330864, 160}, {12330865, 202}, {12330866, 123}, {12330867, 237}},
			},
			want: 			cpuState{
				D:   [8]uint32{245624528, 1557216396, 1527077180, 3254141209, 2258485553, 97976962, 1862540457, 2369691499},
				A:   [7]uint32{2849037476, 3449471909, 1329233878, 2993620988, 2748393889, 458380700, 1901781166},
				PC:  12330868,
				SR:  9226,
				USP: 3417952,
				SSP: 15337942,
				RAM: [][2]uint32{{12330862, 78}, {12330863, 113}, {12330864, 160}, {12330865, 202}, {12330866, 123}, {12330867, 237}},
				Cycles: 4,
			},
		},
		{
			name: "1109 NOP 4e71",
			init: 			cpuState{
				D:   [8]uint32{1944444118, 3543780302, 1185199943, 3406867712, 2010288145, 793481748, 2171335861, 2330474972},
				A:   [7]uint32{1551808083, 996221661, 1640490974, 389444860, 1570008262, 2445147902, 3723404410},
				PC:  8006440,
				SR:  8450,
				USP: 7606886,
				SSP: 1697916,
				RAM: [][2]uint32{{8006436, 78}, {8006437, 113}, {8006438, 215}, {8006439, 95}, {8006440, 226}, {8006441, 44}},
			},
			want: 			cpuState{
				D:   [8]uint32{1944444118, 3543780302, 1185199943, 3406867712, 2010288145, 793481748, 2171335861, 2330474972},
				A:   [7]uint32{1551808083, 996221661, 1640490974, 389444860, 1570008262, 2445147902, 3723404410},
				PC:  8006442,
				SR:  8450,
				USP: 7606886,
				SSP: 1697916,
				RAM: [][2]uint32{{8006436, 78}, {8006437, 113}, {8006438, 215}, {8006439, 95}, {8006440, 226}, {8006441, 44}},
				Cycles: 4,
			},
		},
		{
			name: "1392 NOP 4e71",
			init: 			cpuState{
				D:   [8]uint32{2919445988, 932415887, 2869935869, 3681298503, 4029230052, 3861011488, 2916740770, 2032863513},
				A:   [7]uint32{837867088, 2635238814, 287344323, 1018595404, 3671348095, 298917608, 2987382100},
				PC:  8433084,
				SR:  541,
				USP: 14920922,
				SSP: 13746072,
				RAM: [][2]uint32{{8433080, 78}, {8433081, 113}, {8433082, 231}, {8433083, 140}, {8433084, 235}, {8433085, 103}},
			},
			want: 			cpuState{
				D:   [8]uint32{2919445988, 932415887, 2869935869, 3681298503, 4029230052, 3861011488, 2916740770, 2032863513},
				A:   [7]uint32{837867088, 2635238814, 287344323, 1018595404, 3671348095, 298917608, 2987382100},
				PC:  8433086,
				SR:  541,
				USP: 14920922,
				SSP: 13746072,
				RAM: [][2]uint32{{8433080, 78}, {8433081, 113}, {8433082, 231}, {8433083, 140}, {8433084, 235}, {8433085, 103}},
				Cycles: 4,
			},
		},
		{
			name: "1664 NOP 4e71",
			init: 			cpuState{
				D:   [8]uint32{85264372, 4292327628, 1688013894, 3746907274, 4216188595, 3625697398, 35853402, 1356944512},
				A:   [7]uint32{3749590824, 4114018765, 3183490859, 2542458613, 4174650771, 1991462491, 1276642617},
				PC:  15504468,
				SR:  20,
				USP: 6660604,
				SSP: 9280304,
				RAM: [][2]uint32{{15504464, 78}, {15504465, 113}, {15504466, 108}, {15504467, 163}, {15504468, 63}, {15504469, 40}},
			},
			want: 			cpuState{
				D:   [8]uint32{85264372, 4292327628, 1688013894, 3746907274, 4216188595, 3625697398, 35853402, 1356944512},
				A:   [7]uint32{3749590824, 4114018765, 3183490859, 2542458613, 4174650771, 1991462491, 1276642617},
				PC:  15504470,
				SR:  20,
				USP: 6660604,
				SSP: 9280304,
				RAM: [][2]uint32{{15504464, 78}, {15504465, 113}, {15504466, 108}, {15504467, 163}, {15504468, 63}, {15504469, 40}},
				Cycles: 4,
			},
		},
		{
			name: "1958 NOP 4e71",
			init: 			cpuState{
				D:   [8]uint32{851793898, 642886907, 4023785586, 4223823689, 2018910772, 36176382, 3831286648, 2595993709},
				A:   [7]uint32{335575291, 3441965380, 429317434, 1884300299, 2719298408, 1102530675, 1741255642},
				PC:  10769430,
				SR:  17,
				USP: 8461322,
				SSP: 10951526,
				RAM: [][2]uint32{{10769426, 78}, {10769427, 113}, {10769428, 213}, {10769429, 55}, {10769430, 64}, {10769431, 46}},
			},
			want: 			cpuState{
				D:   [8]uint32{851793898, 642886907, 4023785586, 4223823689, 2018910772, 36176382, 3831286648, 2595993709},
				A:   [7]uint32{335575291, 3441965380, 429317434, 1884300299, 2719298408, 1102530675, 1741255642},
				PC:  10769432,
				SR:  17,
				USP: 8461322,
				SSP: 10951526,
				RAM: [][2]uint32{{10769426, 78}, {10769427, 113}, {10769428, 213}, {10769429, 55}, {10769430, 64}, {10769431, 46}},
				Cycles: 4,
			},
		},
		{
			name: "2205 NOP 4e71",
			init: 			cpuState{
				D:   [8]uint32{3135812601, 2299826586, 3807638947, 2252697884, 2153433497, 4055387309, 1854903589, 2476944776},
				A:   [7]uint32{1350357897, 3503268072, 1806061621, 1567809937, 807499122, 3346274014, 752591981},
				PC:  5136558,
				SR:  9232,
				USP: 11965870,
				SSP: 7203176,
				RAM: [][2]uint32{{5136554, 78}, {5136555, 113}, {5136556, 219}, {5136557, 110}, {5136558, 32}, {5136559, 200}},
			},
			want: 			cpuState{
				D:   [8]uint32{3135812601, 2299826586, 3807638947, 2252697884, 2153433497, 4055387309, 1854903589, 2476944776},
				A:   [7]uint32{1350357897, 3503268072, 1806061621, 1567809937, 807499122, 3346274014, 752591981},
				PC:  5136560,
				SR:  9232,
				USP: 11965870,
				SSP: 7203176,
				RAM: [][2]uint32{{5136554, 78}, {5136555, 113}, {5136556, 219}, {5136557, 110}, {5136558, 32}, {5136559, 200}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestSTOP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{2431338843, 1097904765, 2362176531, 2327491436, 738827858, 357731005, 2389080449, 2189612291},
				A:   [7]uint32{862186975, 1774396471, 3921212015, 584200441, 2740188619, 2431828463, 3150012923},
				PC:  15476508,
				SR:  34330,
				USP: 15728486,
				SSP: 3475004,
				RAM: [][2]uint32{{15476504, 78}, {15476505, 114}, {15476506, 64}, {15476507, 221}, {32, 246}, {33, 112}, {34, 176}, {35, 142}, {7385230, 113}, {7385231, 198}, {7385232, 106}, {7385233, 255}},
			},
			want: cpuState{
				D:   [8]uint32{2431338843, 1097904765, 2362176531, 2327491436, 738827858, 357731005, 2389080449, 2189612291},
				A:   [7]uint32{862186975, 1774396471, 3921212015, 584200441, 2740188619, 2431828463, 3150012923},
				PC:  4134580370,
				SR:  9754,
				USP: 15728486,
				SSP: 3474998,
				RAM: [][2]uint32{{15476504, 78}, {15476505, 114}, {15476506, 64}, {15476507, 221}, {3475002, 39}, {3475003, 24}, {3474998, 134}, {3474999, 26}, {3475000, 0}, {3475001, 236}, {32, 246}, {33, 112}, {34, 176}, {35, 142}, {7385230, 113}, {7385231, 198}, {7385232, 106}, {7385233, 255}},
				Cycles: 34,
			},
		},
		{
			name: "500 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{2293300723, 2293068375, 2219980699, 4134010048, 383926791, 336724185, 418174564, 2114976917},
				A:   [7]uint32{2519497349, 1033191247, 3962394934, 3277458397, 1795799622, 845262492, 1501317824},
				PC:  15926360,
				SR:  790,
				USP: 3227632,
				SSP: 3468940,
				RAM: [][2]uint32{{15926356, 78}, {15926357, 114}, {15926358, 195}, {15926359, 212}, {32, 223}, {33, 186}, {34, 59}, {35, 178}, {12204978, 201}, {12204979, 239}, {12204980, 38}, {12204981, 250}},
			},
			want: cpuState{
				D:   [8]uint32{2293300723, 2293068375, 2219980699, 4134010048, 383926791, 336724185, 418174564, 2114976917},
				A:   [7]uint32{2519497349, 1033191247, 3962394934, 3277458397, 1795799622, 845262492, 1501317824},
				PC:  3753524150,
				SR:  8982,
				USP: 3227632,
				SSP: 3468934,
				RAM: [][2]uint32{{15926356, 78}, {15926357, 114}, {15926358, 195}, {15926359, 212}, {3468938, 4}, {3468939, 84}, {3468934, 3}, {3468935, 22}, {3468936, 0}, {3468937, 243}, {32, 223}, {33, 186}, {34, 59}, {35, 178}, {12204978, 201}, {12204979, 239}, {12204980, 38}, {12204981, 250}},
				Cycles: 34,
			},
		},
		{
			name: "1000 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{4161490072, 2967035680, 4139398029, 1127778676, 931204473, 1638110565, 1307304841, 1695066405},
				A:   [7]uint32{1737925960, 264566957, 281403227, 2402577482, 555132621, 2038459281, 828420632},
				PC:  9500256,
				SR:  8732,
				USP: 4804292,
				SSP: 3968200,
				RAM: [][2]uint32{{9500252, 78}, {9500253, 114}, {9500254, 234}, {9500255, 226}},
			},
			want: cpuState{
				D:   [8]uint32{4161490072, 2967035680, 4139398029, 1127778676, 931204473, 1638110565, 1307304841, 1695066405},
				A:   [7]uint32{1737925960, 264566957, 281403227, 2402577482, 555132621, 2038459281, 828420632},
				PC:  9500256,
				SR:  41474,
				USP: 4804292,
				SSP: 3968200,
				RAM: [][2]uint32{{9500252, 78}, {9500253, 114}, {9500254, 234}, {9500255, 226}},
				Cycles: 4,
			},
		},
		{
			name: "1500 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{1118180056, 2665338183, 55072498, 2398139131, 2352297035, 1765471972, 3228607513, 1182551844},
				A:   [7]uint32{2059358690, 999278382, 380133883, 3247485375, 2336817838, 4258663509, 4294216192},
				PC:  8679948,
				SR:  9223,
				USP: 7451700,
				SSP: 2649760,
				RAM: [][2]uint32{{8679944, 78}, {8679945, 114}, {8679946, 17}, {8679947, 10}},
			},
			want: cpuState{
				D:   [8]uint32{1118180056, 2665338183, 55072498, 2398139131, 2352297035, 1765471972, 3228607513, 1182551844},
				A:   [7]uint32{2059358690, 999278382, 380133883, 3247485375, 2336817838, 4258663509, 4294216192},
				PC:  8679948,
				SR:  266,
				USP: 7451700,
				SSP: 2649760,
				RAM: [][2]uint32{{8679944, 78}, {8679945, 114}, {8679946, 17}, {8679947, 10}},
				Cycles: 4,
			},
		},
		{
			name: "2000 STOP # 4e72",
			init: cpuState{
				D:   [8]uint32{1869158809, 687611147, 1224139848, 578913751, 705175900, 1836570089, 2644151546, 405895282},
				A:   [7]uint32{3475827128, 983110730, 577110460, 3163451074, 231332277, 1164652995, 2470373850},
				PC:  9191230,
				SR:  33025,
				USP: 5609678,
				SSP: 11757382,
				RAM: [][2]uint32{{9191226, 78}, {9191227, 114}, {9191228, 97}, {9191229, 189}, {32, 17}, {33, 40}, {34, 16}, {35, 174}, {2625710, 185}, {2625711, 171}, {2625712, 38}, {2625713, 72}},
			},
			want: cpuState{
				D:   [8]uint32{1869158809, 687611147, 1224139848, 578913751, 705175900, 1836570089, 2644151546, 405895282},
				A:   [7]uint32{3475827128, 983110730, 577110460, 3163451074, 231332277, 1164652995, 2470373850},
				PC:  287838386,
				SR:  8449,
				USP: 5609678,
				SSP: 11757376,
				RAM: [][2]uint32{{9191226, 78}, {9191227, 114}, {9191228, 97}, {9191229, 189}, {11757380, 63}, {11757381, 58}, {11757376, 129}, {11757377, 1}, {11757378, 0}, {11757379, 140}, {32, 17}, {33, 40}, {34, 16}, {35, 174}, {2625710, 185}, {2625711, 171}, {2625712, 38}, {2625713, 72}},
				Cycles: 34,
			},
		},
		{
			name: "002 STOP # 4e72",
			init: 			cpuState{
				D:   [8]uint32{4023860081, 327262317, 1051201999, 2910610824, 1709880656, 1904636818, 2363058444, 237522409},
				A:   [7]uint32{1367495768, 2286247723, 3095378784, 1658415053, 2266917389, 3174395133, 4158560963},
				PC:  5026014,
				SR:  1043,
				USP: 3023936,
				SSP: 13027302,
				RAM: [][2]uint32{{5026010, 78}, {5026011, 114}, {5026012, 82}, {5026013, 242}, {32, 154}, {33, 168}, {34, 111}, {35, 32}, {11038496, 147}, {11038497, 72}, {11038498, 93}, {11038499, 96}},
			},
			want: 			cpuState{
				D:   [8]uint32{4023860081, 327262317, 1051201999, 2910610824, 1709880656, 1904636818, 2363058444, 237522409},
				A:   [7]uint32{1367495768, 2286247723, 3095378784, 1658415053, 2266917389, 3174395133, 4158560963},
				PC:  2594729764,
				SR:  9235,
				USP: 3023936,
				SSP: 13027296,
				RAM: [][2]uint32{{5026010, 78}, {5026011, 114}, {5026012, 82}, {5026013, 242}, {13027300, 176}, {13027301, 218}, {13027296, 4}, {13027297, 19}, {13027298, 0}, {13027299, 76}, {32, 154}, {33, 168}, {34, 111}, {35, 32}, {11038496, 147}, {11038497, 72}, {11038498, 93}, {11038499, 96}},
				Cycles: 34,
			},
		},
		{
			name: "288 STOP # 4e72",
			init: 			cpuState{
				D:   [8]uint32{2750407669, 3752334743, 3340849472, 1096959715, 1438171711, 3010889028, 826123149, 3611635962},
				A:   [7]uint32{826659061, 2987642860, 666956837, 1247118207, 4952698, 3898432023, 1090968369},
				PC:  10991634,
				SR:  8720,
				USP: 12438562,
				SSP: 3261294,
				RAM: [][2]uint32{{10991630, 78}, {10991631, 114}, {10991632, 114}, {10991633, 138}},
			},
			want: 			cpuState{
				D:   [8]uint32{2750407669, 3752334743, 3340849472, 1096959715, 1438171711, 3010889028, 826123149, 3611635962},
				A:   [7]uint32{826659061, 2987642860, 666956837, 1247118207, 4952698, 3898432023, 1090968369},
				PC:  10991634,
				SR:  8714,
				USP: 12438562,
				SSP: 3261294,
				RAM: [][2]uint32{{10991630, 78}, {10991631, 114}, {10991632, 114}, {10991633, 138}},
				Cycles: 4,
			},
		},
		{
			name: "571 STOP # 4e72",
			init: 			cpuState{
				D:   [8]uint32{3991503040, 3220784813, 3586723435, 1918431996, 306061109, 1186572613, 122188825, 108547406},
				A:   [7]uint32{511777497, 3237939123, 2173019616, 1404963984, 2228106658, 3019243890, 4254096951},
				PC:  7666932,
				SR:  21,
				USP: 3844102,
				SSP: 5408280,
				RAM: [][2]uint32{{7666928, 78}, {7666929, 114}, {7666930, 92}, {7666931, 205}, {32, 70}, {33, 164}, {34, 215}, {35, 18}, {10802962, 45}, {10802963, 135}, {10802964, 159}, {10802965, 132}},
			},
			want: 			cpuState{
				D:   [8]uint32{3991503040, 3220784813, 3586723435, 1918431996, 306061109, 1186572613, 122188825, 108547406},
				A:   [7]uint32{511777497, 3237939123, 2173019616, 1404963984, 2228106658, 3019243890, 4254096951},
				PC:  1185208086,
				SR:  8213,
				USP: 3844102,
				SSP: 5408274,
				RAM: [][2]uint32{{7666928, 78}, {7666929, 114}, {7666930, 92}, {7666931, 205}, {5408278, 252}, {5408279, 240}, {5408274, 0}, {5408275, 21}, {5408276, 0}, {5408277, 116}, {32, 70}, {33, 164}, {34, 215}, {35, 18}, {10802962, 45}, {10802963, 135}, {10802964, 159}, {10802965, 132}},
				Cycles: 34,
			},
		},
		{
			name: "848 STOP # 4e72",
			init: 			cpuState{
				D:   [8]uint32{2198114968, 1500265010, 1652276324, 3754364170, 3354256475, 180249524, 3626038509, 3888044197},
				A:   [7]uint32{3583418851, 3385168868, 878217502, 3719306347, 3029993492, 165615174, 839740391},
				PC:  6576872,
				SR:  1817,
				USP: 4371046,
				SSP: 7523990,
				RAM: [][2]uint32{{6576868, 78}, {6576869, 114}, {6576870, 213}, {6576871, 84}, {32, 175}, {33, 110}, {34, 5}, {35, 192}, {7210432, 178}, {7210433, 245}, {7210434, 44}, {7210435, 184}},
			},
			want: 			cpuState{
				D:   [8]uint32{2198114968, 1500265010, 1652276324, 3754364170, 3354256475, 180249524, 3626038509, 3888044197},
				A:   [7]uint32{3583418851, 3385168868, 878217502, 3719306347, 3029993492, 165615174, 839740391},
				PC:  2943223236,
				SR:  10009,
				USP: 4371046,
				SSP: 7523984,
				RAM: [][2]uint32{{6576868, 78}, {6576869, 114}, {6576870, 213}, {6576871, 84}, {7523988, 90}, {7523989, 228}, {7523984, 7}, {7523985, 25}, {7523986, 0}, {7523987, 100}, {32, 175}, {33, 110}, {34, 5}, {35, 192}, {7210432, 178}, {7210433, 245}, {7210434, 44}, {7210435, 184}},
				Cycles: 34,
			},
		},
		{
			name: "1111 STOP # 4e72",
			init: 			cpuState{
				D:   [8]uint32{94622053, 4288510431, 821563251, 1074128188, 2699351347, 1207896398, 3716002752, 3797681798},
				A:   [7]uint32{3812966270, 330681887, 841540619, 1245958617, 2718299282, 3434854784, 2752091331},
				PC:  15510308,
				SR:  7,
				USP: 10771180,
				SSP: 3412358,
				RAM: [][2]uint32{{15510304, 78}, {15510305, 114}, {15510306, 245}, {15510307, 22}, {32, 215}, {33, 94}, {34, 165}, {35, 192}, {6202816, 187}, {6202817, 195}, {6202818, 87}, {6202819, 213}},
			},
			want: 			cpuState{
				D:   [8]uint32{94622053, 4288510431, 821563251, 1074128188, 2699351347, 1207896398, 3716002752, 3797681798},
				A:   [7]uint32{3812966270, 330681887, 841540619, 1245958617, 2718299282, 3434854784, 2752091331},
				PC:  3613304260,
				SR:  8199,
				USP: 10771180,
				SSP: 3412352,
				RAM: [][2]uint32{{15510304, 78}, {15510305, 114}, {15510306, 245}, {15510307, 22}, {3412356, 171}, {3412357, 32}, {3412352, 0}, {3412353, 7}, {3412354, 0}, {3412355, 236}, {32, 215}, {33, 94}, {34, 165}, {35, 192}, {6202816, 187}, {6202817, 195}, {6202818, 87}, {6202819, 213}},
				Cycles: 34,
			},
		},
		{
			name: "1404 STOP # 4e72",
			init: 			cpuState{
				D:   [8]uint32{229969895, 2348868589, 1035951723, 1774604789, 2442220872, 2705014459, 2476434676, 2999687071},
				A:   [7]uint32{602294037, 3886517904, 2978055266, 2441927852, 206304729, 2949449927, 2505277876},
				PC:  16018012,
				SR:  8710,
				USP: 14685954,
				SSP: 1366132,
				RAM: [][2]uint32{{16018008, 78}, {16018009, 114}, {16018010, 143}, {16018011, 87}},
			},
			want: 			cpuState{
				D:   [8]uint32{229969895, 2348868589, 1035951723, 1774604789, 2442220872, 2705014459, 2476434676, 2999687071},
				A:   [7]uint32{602294037, 3886517904, 2978055266, 2441927852, 206304729, 2949449927, 2505277876},
				PC:  16018012,
				SR:  34583,
				USP: 14685954,
				SSP: 1366132,
				RAM: [][2]uint32{{16018008, 78}, {16018009, 114}, {16018010, 143}, {16018011, 87}},
				Cycles: 4,
			},
		},
		{
			name: "1682 STOP # 4e72",
			init: 			cpuState{
				D:   [8]uint32{1135174857, 1290702988, 1017550694, 2552583183, 2119132892, 238514884, 4032403121, 399985254},
				A:   [7]uint32{3091804346, 3108857078, 127083727, 758491208, 2681146053, 2255327850, 1739384947},
				PC:  13777340,
				SR:  798,
				USP: 1650730,
				SSP: 10275966,
				RAM: [][2]uint32{{13777336, 78}, {13777337, 114}, {13777338, 239}, {13777339, 183}, {32, 52}, {33, 132}, {34, 53}, {35, 182}, {8664502, 7}, {8664503, 200}, {8664504, 142}, {8664505, 130}},
			},
			want: 			cpuState{
				D:   [8]uint32{1135174857, 1290702988, 1017550694, 2552583183, 2119132892, 238514884, 4032403121, 399985254},
				A:   [7]uint32{3091804346, 3108857078, 127083727, 758491208, 2681146053, 2255327850, 1739384947},
				PC:  881079738,
				SR:  8990,
				USP: 1650730,
				SSP: 10275960,
				RAM: [][2]uint32{{13777336, 78}, {13777337, 114}, {13777338, 239}, {13777339, 183}, {10275964, 57}, {10275965, 184}, {10275960, 3}, {10275961, 30}, {10275962, 0}, {10275963, 210}, {32, 52}, {33, 132}, {34, 53}, {35, 182}, {8664502, 7}, {8664503, 200}, {8664504, 142}, {8664505, 130}},
				Cycles: 34,
			},
		},
		{
			name: "1960 STOP # 4e72",
			init: 			cpuState{
				D:   [8]uint32{1402226510, 2138621638, 2574602684, 1156045014, 2252479763, 1699416877, 3400799781, 2700646268},
				A:   [7]uint32{3979433444, 2399956725, 706489230, 1637435190, 1089199720, 3994431416, 949750375},
				PC:  13809398,
				SR:  280,
				USP: 5110428,
				SSP: 14206856,
				RAM: [][2]uint32{{13809394, 78}, {13809395, 114}, {13809396, 30}, {13809397, 192}, {32, 124}, {33, 202}, {34, 248}, {35, 130}, {13301890, 101}, {13301891, 245}, {13301892, 19}, {13301893, 78}},
			},
			want: 			cpuState{
				D:   [8]uint32{1402226510, 2138621638, 2574602684, 1156045014, 2252479763, 1699416877, 3400799781, 2700646268},
				A:   [7]uint32{3979433444, 2399956725, 706489230, 1637435190, 1089199720, 3994431416, 949750375},
				PC:  2093676678,
				SR:  8472,
				USP: 5110428,
				SSP: 14206850,
				RAM: [][2]uint32{{13809394, 78}, {13809395, 114}, {13809396, 30}, {13809397, 192}, {14206854, 182}, {14206855, 242}, {14206850, 1}, {14206851, 24}, {14206852, 0}, {14206853, 210}, {32, 124}, {33, 202}, {34, 248}, {35, 130}, {13301890, 101}, {13301891, 245}, {13301892, 19}, {13301893, 78}},
				Cycles: 34,
			},
		},
		{
			name: "2233 STOP # 4e72",
			init: 			cpuState{
				D:   [8]uint32{1225659770, 3695047147, 774919356, 3511912326, 2805028526, 1731673419, 2409962866, 4217772571},
				A:   [7]uint32{3762634420, 2099872111, 456843836, 773690415, 3482119270, 1835990960, 3734468264},
				PC:  4796336,
				SR:  1821,
				USP: 11454890,
				SSP: 6689720,
				RAM: [][2]uint32{{4796332, 78}, {4796333, 114}, {4796334, 134}, {4796335, 196}, {32, 85}, {33, 166}, {34, 110}, {35, 84}, {10907220, 182}, {10907221, 187}, {10907222, 206}, {10907223, 220}},
			},
			want: 			cpuState{
				D:   [8]uint32{1225659770, 3695047147, 774919356, 3511912326, 2805028526, 1731673419, 2409962866, 4217772571},
				A:   [7]uint32{3762634420, 2099872111, 456843836, 773690415, 3482119270, 1835990960, 3734468264},
				PC:  1436970584,
				SR:  10013,
				USP: 11454890,
				SSP: 6689714,
				RAM: [][2]uint32{{4796332, 78}, {4796333, 114}, {4796334, 134}, {4796335, 196}, {6689718, 47}, {6689719, 172}, {6689714, 7}, {6689715, 29}, {6689716, 0}, {6689717, 73}, {32, 85}, {33, 166}, {34, 110}, {35, 84}, {10907220, 182}, {10907221, 187}, {10907222, 206}, {10907223, 220}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestRESET(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{1689175132, 835547661, 2786586489, 2380291742, 2111070254, 293396557, 930421946, 1136885942},
				A:   [7]uint32{2570742412, 3746892549, 3454825972, 899140581, 394677129, 4290643341, 2216700769},
				PC:  84888,
				SR:  1567,
				USP: 15076452,
				SSP: 3180312,
				RAM: [][2]uint32{{84884, 78}, {84885, 112}, {84886, 178}, {84887, 159}, {32, 91}, {33, 194}, {34, 61}, {35, 26}, {12729626, 242}, {12729627, 25}, {12729628, 230}, {12729629, 144}},
			},
			want: cpuState{
				D:   [8]uint32{1689175132, 835547661, 2786586489, 2380291742, 2111070254, 293396557, 930421946, 1136885942},
				A:   [7]uint32{2570742412, 3746892549, 3454825972, 899140581, 394677129, 4290643341, 2216700769},
				PC:  1539456286,
				SR:  9759,
				USP: 15076452,
				SSP: 3180306,
				RAM: [][2]uint32{{84884, 78}, {84885, 112}, {84886, 178}, {84887, 159}, {3180310, 75}, {3180311, 148}, {3180306, 6}, {3180307, 31}, {3180308, 0}, {3180309, 1}, {32, 91}, {33, 194}, {34, 61}, {35, 26}, {12729626, 242}, {12729627, 25}, {12729628, 230}, {12729629, 144}},
				Cycles: 34,
			},
		},
		{
			name: "500 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{28487665, 2050734023, 2354768233, 1642984892, 940369173, 1542833811, 2157741359, 474360759},
				A:   [7]uint32{3004361879, 208496331, 3494848221, 1888259145, 3392049140, 3780682710, 128899296},
				PC:  5406440,
				SR:  33289,
				USP: 14163960,
				SSP: 12514956,
				RAM: [][2]uint32{{5406436, 78}, {5406437, 112}, {5406438, 223}, {5406439, 13}, {32, 60}, {33, 76}, {34, 101}, {35, 18}, {5006610, 251}, {5006611, 2}, {5006612, 236}, {5006613, 218}},
			},
			want: cpuState{
				D:   [8]uint32{28487665, 2050734023, 2354768233, 1642984892, 940369173, 1542833811, 2157741359, 474360759},
				A:   [7]uint32{3004361879, 208496331, 3494848221, 1888259145, 3392049140, 3780682710, 128899296},
				PC:  1011639574,
				SR:  8713,
				USP: 14163960,
				SSP: 12514950,
				RAM: [][2]uint32{{5406436, 78}, {5406437, 112}, {5406438, 223}, {5406439, 13}, {12514954, 126}, {12514955, 228}, {12514950, 130}, {12514951, 9}, {12514952, 0}, {12514953, 82}, {32, 60}, {33, 76}, {34, 101}, {35, 18}, {5006610, 251}, {5006611, 2}, {5006612, 236}, {5006613, 218}},
				Cycles: 34,
			},
		},
		{
			name: "1000 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{2265348804, 1596147637, 383048715, 37277271, 1437798982, 980935211, 2007675570, 620801442},
				A:   [7]uint32{595937128, 460744551, 2096861165, 120349356, 4017536328, 1771932188, 1527964789},
				PC:  11314768,
				SR:  33310,
				USP: 14513030,
				SSP: 9533918,
				RAM: [][2]uint32{{11314764, 78}, {11314765, 112}, {11314766, 225}, {11314767, 176}, {32, 246}, {33, 236}, {34, 54}, {35, 112}, {15480432, 142}, {15480433, 242}, {15480434, 172}, {15480435, 142}},
			},
			want: cpuState{
				D:   [8]uint32{2265348804, 1596147637, 383048715, 37277271, 1437798982, 980935211, 2007675570, 620801442},
				A:   [7]uint32{595937128, 460744551, 2096861165, 120349356, 4017536328, 1771932188, 1527964789},
				PC:  4142675572,
				SR:  8734,
				USP: 14513030,
				SSP: 9533912,
				RAM: [][2]uint32{{11314764, 78}, {11314765, 112}, {11314766, 225}, {11314767, 176}, {9533916, 166}, {9533917, 76}, {9533912, 130}, {9533913, 30}, {9533914, 0}, {9533915, 172}, {32, 246}, {33, 236}, {34, 54}, {35, 112}, {15480432, 142}, {15480433, 242}, {15480434, 172}, {15480435, 142}},
				Cycles: 34,
			},
		},
		{
			name: "1500 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{3341308448, 2576302347, 1907515448, 3901988102, 2770749136, 845184847, 2850197657, 2605769444},
				A:   [7]uint32{2523543807, 2274872486, 3837892829, 3471926591, 1188673552, 4068495178, 2604623378},
				PC:  4425260,
				SR:  1032,
				USP: 1394764,
				SSP: 7870852,
				RAM: [][2]uint32{{4425256, 78}, {4425257, 112}, {4425258, 85}, {4425259, 102}, {32, 122}, {33, 86}, {34, 71}, {35, 226}, {5654498, 114}, {5654499, 90}, {5654500, 165}, {5654501, 70}},
			},
			want: cpuState{
				D:   [8]uint32{3341308448, 2576302347, 1907515448, 3901988102, 2770749136, 845184847, 2850197657, 2605769444},
				A:   [7]uint32{2523543807, 2274872486, 3837892829, 3471926591, 1188673552, 4068495178, 2604623378},
				PC:  2052474854,
				SR:  9224,
				USP: 1394764,
				SSP: 7870846,
				RAM: [][2]uint32{{4425256, 78}, {4425257, 112}, {4425258, 85}, {4425259, 102}, {7870850, 134}, {7870851, 40}, {7870846, 4}, {7870847, 8}, {7870848, 0}, {7870849, 67}, {32, 122}, {33, 86}, {34, 71}, {35, 226}, {5654498, 114}, {5654499, 90}, {5654500, 165}, {5654501, 70}},
				Cycles: 34,
			},
		},
		{
			name: "2000 RESET 4e70",
			init: cpuState{
				D:   [8]uint32{628537874, 3900881044, 3289808271, 793024783, 1704272646, 1381844294, 1236944637, 4271301022},
				A:   [7]uint32{1094226903, 2032861992, 4017181522, 2291738218, 477098048, 3999832087, 603902054},
				PC:  5845866,
				SR:  34050,
				USP: 4222710,
				SSP: 11433686,
				RAM: [][2]uint32{{5845862, 78}, {5845863, 112}, {5845864, 232}, {5845865, 101}, {32, 255}, {33, 22}, {34, 254}, {35, 248}, {1507064, 214}, {1507065, 109}, {1507066, 189}, {1507067, 208}},
			},
			want: cpuState{
				D:   [8]uint32{628537874, 3900881044, 3289808271, 793024783, 1704272646, 1381844294, 1236944637, 4271301022},
				A:   [7]uint32{1094226903, 2032861992, 4017181522, 2291738218, 477098048, 3999832087, 603902054},
				PC:  4279697148,
				SR:  9474,
				USP: 4222710,
				SSP: 11433680,
				RAM: [][2]uint32{{5845862, 78}, {5845863, 112}, {5845864, 232}, {5845865, 101}, {11433684, 51}, {11433685, 102}, {11433680, 133}, {11433681, 2}, {11433682, 0}, {11433683, 89}, {32, 255}, {33, 22}, {34, 254}, {35, 248}, {1507064, 214}, {1507065, 109}, {1507066, 189}, {1507067, 208}},
				Cycles: 34,
			},
		},
		{
			name: "001 RESET 4e70",
			init: 			cpuState{
				D:   [8]uint32{576812424, 3239183407, 2451457146, 963698368, 2726071555, 3313815971, 4181998132, 206348474},
				A:   [7]uint32{1389338090, 2947428658, 98090692, 4254552137, 1128749159, 2199201150, 2623532347},
				PC:  16679908,
				SR:  8714,
				USP: 11488368,
				SSP: 13248146,
				RAM: [][2]uint32{{16679904, 78}, {16679905, 112}, {16679906, 8}, {16679907, 225}, {16679908, 230}, {16679909, 55}},
			},
			want: 			cpuState{
				D:   [8]uint32{576812424, 3239183407, 2451457146, 963698368, 2726071555, 3313815971, 4181998132, 206348474},
				A:   [7]uint32{1389338090, 2947428658, 98090692, 4254552137, 1128749159, 2199201150, 2623532347},
				PC:  16679910,
				SR:  8714,
				USP: 11488368,
				SSP: 13248146,
				RAM: [][2]uint32{{16679904, 78}, {16679905, 112}, {16679906, 8}, {16679907, 225}, {16679908, 230}, {16679909, 55}},
				Cycles: 132,
			},
		},
		{
			name: "298 RESET 4e70",
			init: 			cpuState{
				D:   [8]uint32{2728651419, 1032243515, 1146014947, 2499333275, 2192472710, 3077874504, 1314134198, 2312037197},
				A:   [7]uint32{2102977940, 1257364772, 1950854375, 388593529, 409049243, 1200038323, 4037999480},
				PC:  8817476,
				SR:  8219,
				USP: 8544718,
				SSP: 5572844,
				RAM: [][2]uint32{{8817472, 78}, {8817473, 112}, {8817474, 250}, {8817475, 121}, {8817476, 28}, {8817477, 30}},
			},
			want: 			cpuState{
				D:   [8]uint32{2728651419, 1032243515, 1146014947, 2499333275, 2192472710, 3077874504, 1314134198, 2312037197},
				A:   [7]uint32{2102977940, 1257364772, 1950854375, 388593529, 409049243, 1200038323, 4037999480},
				PC:  8817478,
				SR:  8219,
				USP: 8544718,
				SSP: 5572844,
				RAM: [][2]uint32{{8817472, 78}, {8817473, 112}, {8817474, 250}, {8817475, 121}, {8817476, 28}, {8817477, 30}},
				Cycles: 132,
			},
		},
		{
			name: "555 RESET 4e70",
			init: 			cpuState{
				D:   [8]uint32{92427548, 4023063766, 1400752707, 200141635, 1945548939, 178913888, 969625566, 1306836369},
				A:   [7]uint32{2306681597, 3693015696, 2567290544, 236229296, 1835288829, 4034549362, 4259047},
				PC:  5655848,
				SR:  538,
				USP: 13741784,
				SSP: 11547056,
				RAM: [][2]uint32{{5655844, 78}, {5655845, 112}, {5655846, 205}, {5655847, 211}, {32, 102}, {33, 120}, {34, 137}, {35, 244}, {7899636, 110}, {7899637, 251}, {7899638, 105}, {7899639, 97}},
			},
			want: 			cpuState{
				D:   [8]uint32{92427548, 4023063766, 1400752707, 200141635, 1945548939, 178913888, 969625566, 1306836369},
				A:   [7]uint32{2306681597, 3693015696, 2567290544, 236229296, 1835288829, 4034549362, 4259047},
				PC:  1719175672,
				SR:  8730,
				USP: 13741784,
				SSP: 11547050,
				RAM: [][2]uint32{{5655844, 78}, {5655845, 112}, {5655846, 205}, {5655847, 211}, {11547054, 77}, {11547055, 36}, {11547050, 2}, {11547051, 26}, {11547052, 0}, {11547053, 86}, {32, 102}, {33, 120}, {34, 137}, {35, 244}, {7899636, 110}, {7899637, 251}, {7899638, 105}, {7899639, 97}},
				Cycles: 34,
			},
		},
		{
			name: "878 RESET 4e70",
			init: 			cpuState{
				D:   [8]uint32{3904525927, 1599974470, 3607754365, 1677262348, 2841758300, 928196800, 3489201779, 400132748},
				A:   [7]uint32{781406017, 918399810, 2486603381, 3636993829, 2290945839, 1674475261, 3585913454},
				PC:  4571860,
				SR:  1296,
				USP: 6589748,
				SSP: 10054866,
				RAM: [][2]uint32{{4571856, 78}, {4571857, 112}, {4571858, 165}, {4571859, 144}, {32, 75}, {33, 248}, {34, 43}, {35, 148}, {16264084, 239}, {16264085, 121}, {16264086, 123}, {16264087, 152}},
			},
			want: 			cpuState{
				D:   [8]uint32{3904525927, 1599974470, 3607754365, 1677262348, 2841758300, 928196800, 3489201779, 400132748},
				A:   [7]uint32{781406017, 918399810, 2486603381, 3636993829, 2290945839, 1674475261, 3585913454},
				PC:  1274555288,
				SR:  9488,
				USP: 6589748,
				SSP: 10054860,
				RAM: [][2]uint32{{4571856, 78}, {4571857, 112}, {4571858, 165}, {4571859, 144}, {10054864, 194}, {10054865, 208}, {10054860, 5}, {10054861, 16}, {10054862, 0}, {10054863, 69}, {32, 75}, {33, 248}, {34, 43}, {35, 148}, {16264084, 239}, {16264085, 121}, {16264086, 123}, {16264087, 152}},
				Cycles: 34,
			},
		},
		{
			name: "1142 RESET 4e70",
			init: 			cpuState{
				D:   [8]uint32{2446268859, 1674590094, 1005428491, 819103392, 3035834804, 895084417, 3790347077, 666615506},
				A:   [7]uint32{3596616331, 3352673999, 2006758500, 1658769416, 3848049554, 4145935452, 140938745},
				PC:  6140536,
				SR:  8469,
				USP: 1862792,
				SSP: 10626514,
				RAM: [][2]uint32{{6140532, 78}, {6140533, 112}, {6140534, 252}, {6140535, 33}, {6140536, 253}, {6140537, 104}},
			},
			want: 			cpuState{
				D:   [8]uint32{2446268859, 1674590094, 1005428491, 819103392, 3035834804, 895084417, 3790347077, 666615506},
				A:   [7]uint32{3596616331, 3352673999, 2006758500, 1658769416, 3848049554, 4145935452, 140938745},
				PC:  6140538,
				SR:  8469,
				USP: 1862792,
				SSP: 10626514,
				RAM: [][2]uint32{{6140532, 78}, {6140533, 112}, {6140534, 252}, {6140535, 33}, {6140536, 253}, {6140537, 104}},
				Cycles: 132,
			},
		},
		{
			name: "1415 RESET 4e70",
			init: 			cpuState{
				D:   [8]uint32{1390102055, 1964926719, 3827945327, 2394416704, 1355810467, 883936279, 3729194794, 2600873456},
				A:   [7]uint32{2621391554, 2013436857, 3098921597, 2172834402, 4239282430, 135393259, 1383392548},
				PC:  1162252,
				SR:  8218,
				USP: 11097684,
				SSP: 2864342,
				RAM: [][2]uint32{{1162248, 78}, {1162249, 112}, {1162250, 204}, {1162251, 89}, {1162252, 181}, {1162253, 224}},
			},
			want: 			cpuState{
				D:   [8]uint32{1390102055, 1964926719, 3827945327, 2394416704, 1355810467, 883936279, 3729194794, 2600873456},
				A:   [7]uint32{2621391554, 2013436857, 3098921597, 2172834402, 4239282430, 135393259, 1383392548},
				PC:  1162254,
				SR:  8218,
				USP: 11097684,
				SSP: 2864342,
				RAM: [][2]uint32{{1162248, 78}, {1162249, 112}, {1162250, 204}, {1162251, 89}, {1162252, 181}, {1162253, 224}},
				Cycles: 132,
			},
		},
		{
			name: "1697 RESET 4e70",
			init: 			cpuState{
				D:   [8]uint32{3938929723, 2925882431, 203642879, 2521959681, 2802652395, 3953408242, 731288341, 3130490754},
				A:   [7]uint32{752448879, 2465680155, 1988786386, 3483656610, 1095374801, 776716745, 3271113343},
				PC:  2395366,
				SR:  9730,
				USP: 3702682,
				SSP: 3771078,
				RAM: [][2]uint32{{2395362, 78}, {2395363, 112}, {2395364, 115}, {2395365, 7}, {2395366, 1}, {2395367, 205}},
			},
			want: 			cpuState{
				D:   [8]uint32{3938929723, 2925882431, 203642879, 2521959681, 2802652395, 3953408242, 731288341, 3130490754},
				A:   [7]uint32{752448879, 2465680155, 1988786386, 3483656610, 1095374801, 776716745, 3271113343},
				PC:  2395368,
				SR:  9730,
				USP: 3702682,
				SSP: 3771078,
				RAM: [][2]uint32{{2395362, 78}, {2395363, 112}, {2395364, 115}, {2395365, 7}, {2395366, 1}, {2395367, 205}},
				Cycles: 132,
			},
		},
		{
			name: "1967 RESET 4e70",
			init: 			cpuState{
				D:   [8]uint32{1254073167, 16782678, 2063210470, 3309863940, 2739799486, 3588699225, 3471418688, 1678369340},
				A:   [7]uint32{2997456736, 1264443186, 3315193924, 2463861382, 2500514447, 4214615753, 3967593549},
				PC:  6611000,
				SR:  8979,
				USP: 5712114,
				SSP: 4087012,
				RAM: [][2]uint32{{6610996, 78}, {6610997, 112}, {6610998, 210}, {6610999, 221}, {6611000, 223}, {6611001, 51}},
			},
			want: 			cpuState{
				D:   [8]uint32{1254073167, 16782678, 2063210470, 3309863940, 2739799486, 3588699225, 3471418688, 1678369340},
				A:   [7]uint32{2997456736, 1264443186, 3315193924, 2463861382, 2500514447, 4214615753, 3967593549},
				PC:  6611002,
				SR:  8979,
				USP: 5712114,
				SSP: 4087012,
				RAM: [][2]uint32{{6610996, 78}, {6610997, 112}, {6610998, 210}, {6610999, 221}, {6611000, 223}, {6611001, 51}},
				Cycles: 132,
			},
		},
		{
			name: "2220 RESET 4e70",
			init: 			cpuState{
				D:   [8]uint32{3920364180, 560369658, 1258395930, 3674774643, 1273292829, 3845251746, 850931861, 4118671886},
				A:   [7]uint32{1078745008, 3369232453, 4096286022, 1455791006, 200436587, 2614484359, 3559718775},
				PC:  13818762,
				SR:  256,
				USP: 15996246,
				SSP: 12832140,
				RAM: [][2]uint32{{13818758, 78}, {13818759, 112}, {13818760, 172}, {13818761, 136}, {32, 7}, {33, 170}, {34, 136}, {35, 122}, {11176058, 62}, {11176059, 138}, {11176060, 216}, {11176061, 196}},
			},
			want: 			cpuState{
				D:   [8]uint32{3920364180, 560369658, 1258395930, 3674774643, 1273292829, 3845251746, 850931861, 4118671886},
				A:   [7]uint32{1078745008, 3369232453, 4096286022, 1455791006, 200436587, 2614484359, 3559718775},
				PC:  128616574,
				SR:  8448,
				USP: 15996246,
				SSP: 12832134,
				RAM: [][2]uint32{{13818758, 78}, {13818759, 112}, {13818760, 172}, {13818761, 136}, {12832138, 219}, {12832139, 134}, {12832134, 1}, {12832135, 0}, {12832136, 0}, {12832137, 210}, {32, 7}, {33, 170}, {34, 136}, {35, 122}, {11176058, 62}, {11176059, 138}, {11176060, 216}, {11176061, 196}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTRAP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TRAP 8 4e48",
			init: cpuState{
				D:   [8]uint32{3400333495, 711917462, 730326889, 2934301075, 1530823477, 3055452475, 2560220869, 2227894313},
				A:   [7]uint32{926492777, 3219346398, 2157483417, 2220865159, 4261461242, 2400926708, 826610775},
				PC:  8064466,
				SR:  8974,
				USP: 14898600,
				SSP: 3008530,
				RAM: [][2]uint32{{8064462, 78}, {8064463, 72}, {8064464, 152}, {8064465, 127}, {160, 166}, {161, 4}, {162, 10}, {163, 66}, {264770, 17}, {264771, 89}, {264772, 215}, {264773, 187}},
			},
			want: cpuState{
				D:   [8]uint32{3400333495, 711917462, 730326889, 2934301075, 1530823477, 3055452475, 2560220869, 2227894313},
				A:   [7]uint32{926492777, 3219346398, 2157483417, 2220865159, 4261461242, 2400926708, 826610775},
				PC:  2785282630,
				SR:  8974,
				USP: 14898600,
				SSP: 3008524,
				RAM: [][2]uint32{{8064462, 78}, {8064463, 72}, {8064464, 152}, {8064465, 127}, {3008528, 13}, {3008529, 208}, {3008524, 35}, {3008525, 14}, {3008526, 0}, {3008527, 123}, {160, 166}, {161, 4}, {162, 10}, {163, 66}, {264770, 17}, {264771, 89}, {264772, 215}, {264773, 187}},
				Cycles: 34,
			},
		},
		{
			name: "500 TRAP 2 4e42",
			init: cpuState{
				D:   [8]uint32{1679614333, 2359782989, 3219251868, 1063543416, 1992279873, 3717036528, 1549251524, 3495036937},
				A:   [7]uint32{2433740168, 1568520618, 2986272204, 4253341984, 2021032386, 2561418641, 1228501344},
				PC:  7768868,
				SR:  9478,
				USP: 1473424,
				SSP: 12778400,
				RAM: [][2]uint32{{7768864, 78}, {7768865, 66}, {7768866, 54}, {7768867, 83}, {136, 235}, {137, 40}, {138, 140}, {139, 56}, {2657336, 153}, {2657337, 203}, {2657338, 108}, {2657339, 115}},
			},
			want: cpuState{
				D:   [8]uint32{1679614333, 2359782989, 3219251868, 1063543416, 1992279873, 3717036528, 1549251524, 3495036937},
				A:   [7]uint32{2433740168, 1568520618, 2986272204, 4253341984, 2021032386, 2561418641, 1228501344},
				PC:  3945303100,
				SR:  9478,
				USP: 1473424,
				SSP: 12778394,
				RAM: [][2]uint32{{7768864, 78}, {7768865, 66}, {7768866, 54}, {7768867, 83}, {12778398, 139}, {12778399, 34}, {12778394, 37}, {12778395, 6}, {12778396, 0}, {12778397, 118}, {136, 235}, {137, 40}, {138, 140}, {139, 56}, {2657336, 153}, {2657337, 203}, {2657338, 108}, {2657339, 115}},
				Cycles: 34,
			},
		},
		{
			name: "1000 TRAP 8 4e48",
			init: cpuState{
				D:   [8]uint32{3446961099, 193540034, 159924918, 2696007030, 3342571856, 3903517070, 2274516600, 1205340482},
				A:   [7]uint32{3424574180, 1823725248, 2609013569, 1296030557, 1220596114, 2309768079, 3704290502},
				PC:  11051542,
				SR:  42759,
				USP: 14660814,
				SSP: 9306784,
				RAM: [][2]uint32{{11051538, 78}, {11051539, 72}, {11051540, 196}, {11051541, 91}, {160, 128}, {161, 106}, {162, 255}, {163, 130}, {7012226, 39}, {7012227, 219}, {7012228, 204}, {7012229, 180}},
			},
			want: cpuState{
				D:   [8]uint32{3446961099, 193540034, 159924918, 2696007030, 3342571856, 3903517070, 2274516600, 1205340482},
				A:   [7]uint32{3424574180, 1823725248, 2609013569, 1296030557, 1220596114, 2309768079, 3704290502},
				PC:  2154495878,
				SR:  9991,
				USP: 14660814,
				SSP: 9306778,
				RAM: [][2]uint32{{11051538, 78}, {11051539, 72}, {11051540, 196}, {11051541, 91}, {9306782, 162}, {9306783, 20}, {9306778, 167}, {9306779, 7}, {9306780, 0}, {9306781, 168}, {160, 128}, {161, 106}, {162, 255}, {163, 130}, {7012226, 39}, {7012227, 219}, {7012228, 204}, {7012229, 180}},
				Cycles: 34,
			},
		},
		{
			name: "1500 TRAP 3 4e43",
			init: cpuState{
				D:   [8]uint32{896511014, 704384683, 3910157805, 2443727979, 603959670, 305947599, 1621730639, 1562038905},
				A:   [7]uint32{2786417136, 152283042, 1757314785, 362943200, 547065631, 2226077757, 2031870671},
				PC:  13907832,
				SR:  9501,
				USP: 6288736,
				SSP: 9374604,
				RAM: [][2]uint32{{13907828, 78}, {13907829, 67}, {13907830, 177}, {13907831, 44}, {140, 209}, {141, 146}, {142, 163}, {143, 130}, {9610114, 201}, {9610115, 208}, {9610116, 98}, {9610117, 57}},
			},
			want: cpuState{
				D:   [8]uint32{896511014, 704384683, 3910157805, 2443727979, 603959670, 305947599, 1621730639, 1562038905},
				A:   [7]uint32{2786417136, 152283042, 1757314785, 362943200, 547065631, 2226077757, 2031870671},
				PC:  3516048262,
				SR:  9501,
				USP: 6288736,
				SSP: 9374598,
				RAM: [][2]uint32{{13907828, 78}, {13907829, 67}, {13907830, 177}, {13907831, 44}, {9374602, 55}, {9374603, 118}, {9374598, 37}, {9374599, 29}, {9374600, 0}, {9374601, 212}, {140, 209}, {141, 146}, {142, 163}, {143, 130}, {9610114, 201}, {9610115, 208}, {9610116, 98}, {9610117, 57}},
				Cycles: 34,
			},
		},
		{
			name: "2000 TRAP 12 4e4c",
			init: cpuState{
				D:   [8]uint32{288500413, 2526453671, 1977368341, 2039397001, 676870710, 3112685511, 3952460997, 1861251198},
				A:   [7]uint32{2898323078, 4024296936, 1437627507, 3921317273, 305478651, 3223067646, 658626944},
				PC:  5071936,
				SR:  9757,
				USP: 7732984,
				SSP: 5308328,
				RAM: [][2]uint32{{5071932, 78}, {5071933, 76}, {5071934, 30}, {5071935, 97}, {176, 34}, {177, 218}, {178, 56}, {179, 146}, {14301330, 96}, {14301331, 0}, {14301332, 244}, {14301333, 201}},
			},
			want: cpuState{
				D:   [8]uint32{288500413, 2526453671, 1977368341, 2039397001, 676870710, 3112685511, 3952460997, 1861251198},
				A:   [7]uint32{2898323078, 4024296936, 1437627507, 3921317273, 305478651, 3223067646, 658626944},
				PC:  584726678,
				SR:  9757,
				USP: 7732984,
				SSP: 5308322,
				RAM: [][2]uint32{{5071932, 78}, {5071933, 76}, {5071934, 30}, {5071935, 97}, {5308326, 100}, {5308327, 62}, {5308322, 38}, {5308323, 29}, {5308324, 0}, {5308325, 77}, {176, 34}, {177, 218}, {178, 56}, {179, 146}, {14301330, 96}, {14301331, 0}, {14301332, 244}, {14301333, 201}},
				Cycles: 34,
			},
		},
		{
			name: "001 TRAP 15 4e4f",
			init: 			cpuState{
				D:   [8]uint32{3395954614, 1471409660, 1373017538, 1534167816, 4276930513, 3240177857, 1604849918, 3016248870},
				A:   [7]uint32{1076901025, 3514820044, 284776625, 1656377493, 2136841296, 3197195282, 3634970693},
				PC:  15732654,
				SR:  8716,
				USP: 5918438,
				SSP: 3359064,
				RAM: [][2]uint32{{15732650, 78}, {15732651, 79}, {15732652, 158}, {15732653, 101}, {188, 79}, {189, 88}, {190, 215}, {191, 140}, {5822348, 127}, {5822349, 83}, {5822350, 238}, {5822351, 33}},
			},
			want: 			cpuState{
				D:   [8]uint32{3395954614, 1471409660, 1373017538, 1534167816, 4276930513, 3240177857, 1604849918, 3016248870},
				A:   [7]uint32{1076901025, 3514820044, 284776625, 1656377493, 2136841296, 3197195282, 3634970693},
				PC:  1331222416,
				SR:  8716,
				USP: 5918438,
				SSP: 3359058,
				RAM: [][2]uint32{{15732650, 78}, {15732651, 79}, {15732652, 158}, {15732653, 101}, {3359062, 15}, {3359063, 172}, {3359058, 34}, {3359059, 12}, {3359060, 0}, {3359061, 240}, {188, 79}, {189, 88}, {190, 215}, {191, 140}, {5822348, 127}, {5822349, 83}, {5822350, 238}, {5822351, 33}},
				Cycles: 34,
			},
		},
		{
			name: "289 TRAP 9 4e49",
			init: 			cpuState{
				D:   [8]uint32{4130683368, 3771964726, 2196044241, 97770167, 2174509878, 1412732300, 957404249, 2295740267},
				A:   [7]uint32{545886078, 3424185557, 976976619, 2022981708, 2682580249, 804331575, 2891251681},
				PC:  1573010,
				SR:  1560,
				USP: 3143800,
				SSP: 492536,
				RAM: [][2]uint32{{1573006, 78}, {1573007, 73}, {1573008, 47}, {1573009, 178}, {164, 208}, {165, 168}, {166, 104}, {167, 94}, {11036766, 111}, {11036767, 154}, {11036768, 17}, {11036769, 215}},
			},
			want: 			cpuState{
				D:   [8]uint32{4130683368, 3771964726, 2196044241, 97770167, 2174509878, 1412732300, 957404249, 2295740267},
				A:   [7]uint32{545886078, 3424185557, 976976619, 2022981708, 2682580249, 804331575, 2891251681},
				PC:  3500697698,
				SR:  9752,
				USP: 3143800,
				SSP: 492530,
				RAM: [][2]uint32{{1573006, 78}, {1573007, 73}, {1573008, 47}, {1573009, 178}, {492534, 0}, {492535, 144}, {492530, 6}, {492531, 24}, {492532, 0}, {492533, 24}, {164, 208}, {165, 168}, {166, 104}, {167, 94}, {11036766, 111}, {11036767, 154}, {11036768, 17}, {11036769, 215}},
				Cycles: 34,
			},
		},
		{
			name: "572 TRAP 8 4e48",
			init: 			cpuState{
				D:   [8]uint32{2660385474, 3285468160, 2562056032, 1336566292, 2729374184, 624941858, 1150328802, 4269692635},
				A:   [7]uint32{3273105709, 3684664936, 3936783391, 2791276214, 2179781939, 1734746651, 3442083254},
				PC:  9385780,
				SR:  8460,
				USP: 9517682,
				SSP: 15748820,
				RAM: [][2]uint32{{9385776, 78}, {9385777, 72}, {9385778, 86}, {9385779, 105}, {160, 35}, {161, 50}, {162, 82}, {163, 32}, {3297824, 23}, {3297825, 213}, {3297826, 70}, {3297827, 165}},
			},
			want: 			cpuState{
				D:   [8]uint32{2660385474, 3285468160, 2562056032, 1336566292, 2729374184, 624941858, 1150328802, 4269692635},
				A:   [7]uint32{3273105709, 3684664936, 3936783391, 2791276214, 2179781939, 1734746651, 3442083254},
				PC:  590500388,
				SR:  8460,
				USP: 9517682,
				SSP: 15748814,
				RAM: [][2]uint32{{9385776, 78}, {9385777, 72}, {9385778, 86}, {9385779, 105}, {15748818, 55}, {15748819, 50}, {15748814, 33}, {15748815, 12}, {15748816, 0}, {15748817, 143}, {160, 35}, {161, 50}, {162, 82}, {163, 32}, {3297824, 23}, {3297825, 213}, {3297826, 70}, {3297827, 165}},
				Cycles: 34,
			},
		},
		{
			name: "836 TRAP 5 4e45",
			init: 			cpuState{
				D:   [8]uint32{2576342351, 571124557, 2870521704, 3027903176, 1797455405, 608926835, 270572536, 1520945274},
				A:   [7]uint32{3166510323, 2265116574, 2499063555, 2741070289, 3930929478, 162869388, 3561254101},
				PC:  6858108,
				SR:  8987,
				USP: 14261830,
				SSP: 15880328,
				RAM: [][2]uint32{{6858104, 78}, {6858105, 69}, {6858106, 94}, {6858107, 162}, {148, 68}, {149, 156}, {150, 146}, {151, 184}, {10261176, 21}, {10261177, 101}, {10261178, 161}, {10261179, 62}},
			},
			want: 			cpuState{
				D:   [8]uint32{2576342351, 571124557, 2870521704, 3027903176, 1797455405, 608926835, 270572536, 1520945274},
				A:   [7]uint32{3166510323, 2265116574, 2499063555, 2741070289, 3930929478, 162869388, 3561254101},
				PC:  1151111868,
				SR:  8987,
				USP: 14261830,
				SSP: 15880322,
				RAM: [][2]uint32{{6858104, 78}, {6858105, 69}, {6858106, 94}, {6858107, 162}, {15880326, 165}, {15880327, 122}, {15880322, 35}, {15880323, 27}, {15880324, 0}, {15880325, 104}, {148, 68}, {149, 156}, {150, 146}, {151, 184}, {10261176, 21}, {10261177, 101}, {10261178, 161}, {10261179, 62}},
				Cycles: 34,
			},
		},
		{
			name: "1111 TRAP 4 4e44",
			init: 			cpuState{
				D:   [8]uint32{1384400478, 838707656, 3105565715, 3606438914, 55190400, 1866046559, 3500267281, 2370896024},
				A:   [7]uint32{631504238, 3234967033, 141254639, 3124819721, 3814362774, 3792334785, 2732058268},
				PC:  2164924,
				SR:  787,
				USP: 4077350,
				SSP: 14450474,
				RAM: [][2]uint32{{2164920, 78}, {2164921, 68}, {2164922, 96}, {2164923, 165}, {144, 185}, {145, 102}, {146, 10}, {147, 78}, {6687310, 8}, {6687311, 86}, {6687312, 12}, {6687313, 65}},
			},
			want: 			cpuState{
				D:   [8]uint32{1384400478, 838707656, 3105565715, 3606438914, 55190400, 1866046559, 3500267281, 2370896024},
				A:   [7]uint32{631504238, 3234967033, 141254639, 3124819721, 3814362774, 3792334785, 2732058268},
				PC:  3110472274,
				SR:  8979,
				USP: 4077350,
				SSP: 14450468,
				RAM: [][2]uint32{{2164920, 78}, {2164921, 68}, {2164922, 96}, {2164923, 165}, {14450472, 8}, {14450473, 186}, {14450468, 3}, {14450469, 19}, {14450470, 0}, {14450471, 33}, {144, 185}, {145, 102}, {146, 10}, {147, 78}, {6687310, 8}, {6687311, 86}, {6687312, 12}, {6687313, 65}},
				Cycles: 34,
			},
		},
		{
			name: "1399 TRAP 1 4e41",
			init: 			cpuState{
				D:   [8]uint32{850378991, 476126168, 362536581, 2328173456, 1965973727, 324952470, 1088094183, 2797572694},
				A:   [7]uint32{678692407, 462725090, 4171201153, 120215210, 2992781010, 1285491358, 2119024847},
				PC:  10096090,
				SR:  8982,
				USP: 2252068,
				SSP: 12654524,
				RAM: [][2]uint32{{10096086, 78}, {10096087, 65}, {10096088, 248}, {10096089, 231}, {132, 50}, {133, 244}, {134, 212}, {135, 210}, {16045266, 172}, {16045267, 206}, {16045268, 228}, {16045269, 1}},
			},
			want: 			cpuState{
				D:   [8]uint32{850378991, 476126168, 362536581, 2328173456, 1965973727, 324952470, 1088094183, 2797572694},
				A:   [7]uint32{678692407, 462725090, 4171201153, 120215210, 2992781010, 1285491358, 2119024847},
				PC:  854906070,
				SR:  8982,
				USP: 2252068,
				SSP: 12654518,
				RAM: [][2]uint32{{10096086, 78}, {10096087, 65}, {10096088, 248}, {10096089, 231}, {12654522, 13}, {12654523, 216}, {12654518, 35}, {12654519, 22}, {12654520, 0}, {12654521, 154}, {132, 50}, {133, 244}, {134, 212}, {135, 210}, {16045266, 172}, {16045267, 206}, {16045268, 228}, {16045269, 1}},
				Cycles: 34,
			},
		},
		{
			name: "1687 TRAP 6 4e46",
			init: 			cpuState{
				D:   [8]uint32{2475678921, 1998635033, 3226187629, 2192849224, 225256223, 4152581032, 4254607042, 2736837624},
				A:   [7]uint32{253340470, 3329753713, 1382456209, 3122621477, 2700248361, 1103602444, 4203667641},
				PC:  7751954,
				SR:  9229,
				USP: 7457140,
				SSP: 6003628,
				RAM: [][2]uint32{{7751950, 78}, {7751951, 70}, {7751952, 103}, {7751953, 1}, {152, 90}, {153, 212}, {154, 225}, {155, 114}, {13951346, 247}, {13951347, 225}, {13951348, 130}, {13951349, 228}},
			},
			want: 			cpuState{
				D:   [8]uint32{2475678921, 1998635033, 3226187629, 2192849224, 225256223, 4152581032, 4254607042, 2736837624},
				A:   [7]uint32{253340470, 3329753713, 1382456209, 3122621477, 2700248361, 1103602444, 4203667641},
				PC:  1523900790,
				SR:  9229,
				USP: 7457140,
				SSP: 6003622,
				RAM: [][2]uint32{{7751950, 78}, {7751951, 70}, {7751952, 103}, {7751953, 1}, {6003626, 73}, {6003627, 16}, {6003622, 36}, {6003623, 13}, {6003624, 0}, {6003625, 118}, {152, 90}, {153, 212}, {154, 225}, {155, 114}, {13951346, 247}, {13951347, 225}, {13951348, 130}, {13951349, 228}},
				Cycles: 34,
			},
		},
		{
			name: "1961 TRAP 13 4e4d",
			init: 			cpuState{
				D:   [8]uint32{3003357315, 1185307609, 993580028, 8441617, 1007622510, 1339657858, 3715623911, 1022476747},
				A:   [7]uint32{2289932112, 4254319751, 4037907950, 3298036739, 4232259607, 797086199, 2564005154},
				PC:  2347438,
				SR:  527,
				USP: 16605952,
				SSP: 5361204,
				RAM: [][2]uint32{{2347434, 78}, {2347435, 77}, {2347436, 170}, {2347437, 193}, {180, 175}, {181, 226}, {182, 242}, {183, 2}, {14873090, 70}, {14873091, 241}, {14873092, 50}, {14873093, 181}},
			},
			want: 			cpuState{
				D:   [8]uint32{3003357315, 1185307609, 993580028, 8441617, 1007622510, 1339657858, 3715623911, 1022476747},
				A:   [7]uint32{2289932112, 4254319751, 4037907950, 3298036739, 4232259607, 797086199, 2564005154},
				PC:  2950885894,
				SR:  8719,
				USP: 16605952,
				SSP: 5361198,
				RAM: [][2]uint32{{2347434, 78}, {2347435, 77}, {2347436, 170}, {2347437, 193}, {5361202, 209}, {5361203, 172}, {5361198, 2}, {5361199, 15}, {5361200, 0}, {5361201, 35}, {180, 175}, {181, 226}, {182, 242}, {183, 2}, {14873090, 70}, {14873091, 241}, {14873092, 50}, {14873093, 181}},
				Cycles: 34,
			},
		},
		{
			name: "2228 TRAP 3 4e43",
			init: 			cpuState{
				D:   [8]uint32{1647102278, 334986944, 3503875236, 3926553751, 450874595, 4033242470, 3297785535, 1161307006},
				A:   [7]uint32{3045856371, 1524727284, 4188960904, 1737715542, 2137230941, 3729636141, 3215683737},
				PC:  1471016,
				SR:  8987,
				USP: 9321616,
				SSP: 14706510,
				RAM: [][2]uint32{{1471012, 78}, {1471013, 67}, {1471014, 152}, {1471015, 49}, {140, 9}, {141, 230}, {142, 188}, {143, 206}, {15121614, 126}, {15121615, 39}, {15121616, 172}, {15121617, 193}},
			},
			want: 			cpuState{
				D:   [8]uint32{1647102278, 334986944, 3503875236, 3926553751, 450874595, 4033242470, 3297785535, 1161307006},
				A:   [7]uint32{3045856371, 1524727284, 4188960904, 1737715542, 2137230941, 3729636141, 3215683737},
				PC:  166116562,
				SR:  8987,
				USP: 9321616,
				SSP: 14706504,
				RAM: [][2]uint32{{1471012, 78}, {1471013, 67}, {1471014, 152}, {1471015, 49}, {14706508, 114}, {14706509, 38}, {14706504, 35}, {14706505, 27}, {14706506, 0}, {14706507, 22}, {140, 9}, {141, 230}, {142, 188}, {143, 206}, {15121614, 126}, {15121615, 39}, {15121616, 172}, {15121617, 193}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestTRAPV(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{2592244591, 2787002533, 2642938220, 675103923, 2036456728, 3857080593, 110809242, 1802466737},
				A:   [7]uint32{4011914877, 2392146937, 2696781674, 2817160690, 1741577525, 3997636369, 955999827},
				PC:  12168452,
				SR:  1809,
				USP: 13193320,
				SSP: 16059230,
				RAM: [][2]uint32{{12168448, 78}, {12168449, 118}, {12168450, 240}, {12168451, 76}, {12168452, 60}, {12168453, 105}},
			},
			want: cpuState{
				D:   [8]uint32{2592244591, 2787002533, 2642938220, 675103923, 2036456728, 3857080593, 110809242, 1802466737},
				A:   [7]uint32{4011914877, 2392146937, 2696781674, 2817160690, 1741577525, 3997636369, 955999827},
				PC:  12168454,
				SR:  1809,
				USP: 13193320,
				SSP: 16059230,
				RAM: [][2]uint32{{12168448, 78}, {12168449, 118}, {12168450, 240}, {12168451, 76}, {12168452, 60}, {12168453, 105}},
				Cycles: 4,
			},
		},
		{
			name: "500 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{3062082596, 2404544466, 749350697, 1261614751, 3726798915, 2954900631, 1129584900, 2973822202},
				A:   [7]uint32{3949685775, 1022946272, 785713899, 2645274977, 2629961095, 2600597155, 4257909367},
				PC:  7278010,
				SR:  42766,
				USP: 10730560,
				SSP: 15981542,
				RAM: [][2]uint32{{7278006, 78}, {7278007, 118}, {7278008, 43}, {7278009, 144}, {7278010, 198}, {7278011, 95}, {28, 245}, {29, 128}, {30, 199}, {31, 56}, {8439608, 107}, {8439609, 184}, {8439610, 93}, {8439611, 27}},
			},
			want: cpuState{
				D:   [8]uint32{3062082596, 2404544466, 749350697, 1261614751, 3726798915, 2954900631, 1129584900, 2973822202},
				A:   [7]uint32{3949685775, 1022946272, 785713899, 2645274977, 2629961095, 2600597155, 4257909367},
				PC:  4118857532,
				SR:  9998,
				USP: 10730560,
				SSP: 15981536,
				RAM: [][2]uint32{{7278006, 78}, {7278007, 118}, {7278008, 43}, {7278009, 144}, {7278010, 198}, {7278011, 95}, {15981540, 13}, {15981541, 184}, {15981536, 167}, {15981537, 14}, {15981538, 0}, {15981539, 111}, {28, 245}, {29, 128}, {30, 199}, {31, 56}, {8439608, 107}, {8439609, 184}, {8439610, 93}, {8439611, 27}},
				Cycles: 34,
			},
		},
		{
			name: "1000 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{3100455719, 1023783056, 562803095, 806254233, 822568218, 3626572926, 255141507, 2073000651},
				A:   [7]uint32{997810819, 400821689, 1243148692, 2702450349, 2064365616, 4069627746, 3258122378},
				PC:  3031768,
				SR:  1290,
				USP: 525090,
				SSP: 13895078,
				RAM: [][2]uint32{{3031764, 78}, {3031765, 118}, {3031766, 94}, {3031767, 12}, {3031768, 69}, {3031769, 207}, {28, 24}, {29, 128}, {30, 194}, {31, 116}, {8438388, 6}, {8438389, 190}, {8438390, 145}, {8438391, 75}},
			},
			want: cpuState{
				D:   [8]uint32{3100455719, 1023783056, 562803095, 806254233, 822568218, 3626572926, 255141507, 2073000651},
				A:   [7]uint32{997810819, 400821689, 1243148692, 2702450349, 2064365616, 4069627746, 3258122378},
				PC:  411091576,
				SR:  9482,
				USP: 525090,
				SSP: 13895072,
				RAM: [][2]uint32{{3031764, 78}, {3031765, 118}, {3031766, 94}, {3031767, 12}, {3031768, 69}, {3031769, 207}, {13895076, 66}, {13895077, 214}, {13895072, 5}, {13895073, 10}, {13895074, 0}, {13895075, 46}, {28, 24}, {29, 128}, {30, 194}, {31, 116}, {8438388, 6}, {8438389, 190}, {8438390, 145}, {8438391, 75}},
				Cycles: 34,
			},
		},
		{
			name: "1500 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{2673964343, 2582140889, 709118635, 4180805742, 3105572487, 3048620871, 4149115966, 1976372684},
				A:   [7]uint32{915249755, 3796907194, 2081771776, 2429936304, 2656589147, 1955074663, 2087735529},
				PC:  13697928,
				SR:  8479,
				USP: 1503450,
				SSP: 8898192,
				RAM: [][2]uint32{{13697924, 78}, {13697925, 118}, {13697926, 185}, {13697927, 11}, {13697928, 14}, {13697929, 215}, {28, 234}, {29, 218}, {30, 154}, {31, 242}, {14326514, 6}, {14326515, 50}, {14326516, 222}, {14326517, 52}},
			},
			want: cpuState{
				D:   [8]uint32{2673964343, 2582140889, 709118635, 4180805742, 3105572487, 3048620871, 4149115966, 1976372684},
				A:   [7]uint32{915249755, 3796907194, 2081771776, 2429936304, 2656589147, 1955074663, 2087735529},
				PC:  3940195062,
				SR:  8479,
				USP: 1503450,
				SSP: 8898186,
				RAM: [][2]uint32{{13697924, 78}, {13697925, 118}, {13697926, 185}, {13697927, 11}, {13697928, 14}, {13697929, 215}, {8898190, 3}, {8898191, 134}, {8898186, 33}, {8898187, 31}, {8898188, 0}, {8898189, 209}, {28, 234}, {29, 218}, {30, 154}, {31, 242}, {14326514, 6}, {14326515, 50}, {14326516, 222}, {14326517, 52}},
				Cycles: 34,
			},
		},
		{
			name: "2000 TRAPV 4e76",
			init: cpuState{
				D:   [8]uint32{1833439350, 3527021555, 3205786603, 177120317, 2766186662, 2535381078, 2228216839, 2555826855},
				A:   [7]uint32{2257055653, 3221374203, 59790653, 4004508242, 1192202828, 849310650, 392870113},
				PC:  11554178,
				SR:  1043,
				USP: 13796710,
				SSP: 9895634,
				RAM: [][2]uint32{{11554174, 78}, {11554175, 118}, {11554176, 52}, {11554177, 89}, {11554178, 31}, {11554179, 58}, {28, 151}, {29, 22}, {30, 114}, {31, 20}, {1470996, 7}, {1470997, 157}, {1470998, 78}, {1470999, 235}},
			},
			want: cpuState{
				D:   [8]uint32{1833439350, 3527021555, 3205786603, 177120317, 2766186662, 2535381078, 2228216839, 2555826855},
				A:   [7]uint32{2257055653, 3221374203, 59790653, 4004508242, 1192202828, 849310650, 392870113},
				PC:  2534830616,
				SR:  9235,
				USP: 13796710,
				SSP: 9895628,
				RAM: [][2]uint32{{11554174, 78}, {11554175, 118}, {11554176, 52}, {11554177, 89}, {11554178, 31}, {11554179, 58}, {9895632, 77}, {9895633, 128}, {9895628, 4}, {9895629, 19}, {9895630, 0}, {9895631, 176}, {28, 151}, {29, 22}, {30, 114}, {31, 20}, {1470996, 7}, {1470997, 157}, {1470998, 78}, {1470999, 235}},
				Cycles: 34,
			},
		},
		{
			name: "003 TRAPV 4e76",
			init: 			cpuState{
				D:   [8]uint32{3752428211, 912288959, 2903969473, 1583480747, 71863144, 2571229724, 1159223100, 1721293862},
				A:   [7]uint32{3439014240, 27743885, 3130978960, 1051801930, 1117206940, 989783621, 1643034712},
				PC:  1452722,
				SR:  8214,
				USP: 12476790,
				SSP: 14834566,
				RAM: [][2]uint32{{1452718, 78}, {1452719, 118}, {1452720, 11}, {1452721, 144}, {1452722, 189}, {1452723, 186}, {28, 219}, {29, 102}, {30, 90}, {31, 18}, {6707730, 64}, {6707731, 179}, {6707732, 101}, {6707733, 199}},
			},
			want: 			cpuState{
				D:   [8]uint32{3752428211, 912288959, 2903969473, 1583480747, 71863144, 2571229724, 1159223100, 1721293862},
				A:   [7]uint32{3439014240, 27743885, 3130978960, 1051801930, 1117206940, 989783621, 1643034712},
				PC:  3680918038,
				SR:  8214,
				USP: 12476790,
				SSP: 14834560,
				RAM: [][2]uint32{{1452718, 78}, {1452719, 118}, {1452720, 11}, {1452721, 144}, {1452722, 189}, {1452723, 186}, {14834564, 42}, {14834565, 176}, {14834560, 32}, {14834561, 22}, {14834562, 0}, {14834563, 22}, {28, 219}, {29, 102}, {30, 90}, {31, 18}, {6707730, 64}, {6707731, 179}, {6707732, 101}, {6707733, 199}},
				Cycles: 34,
			},
		},
		{
			name: "247 TRAPV 4e76",
			init: 			cpuState{
				D:   [8]uint32{2503019293, 2236441715, 2143752968, 951587434, 4175915635, 1091789953, 449740308, 1307114624},
				A:   [7]uint32{722116397, 412483259, 740861745, 3113514081, 1666703179, 4194185542, 1426981444},
				PC:  13403404,
				SR:  8714,
				USP: 3105198,
				SSP: 10953608,
				RAM: [][2]uint32{{13403400, 78}, {13403401, 118}, {13403402, 158}, {13403403, 148}, {13403404, 31}, {13403405, 200}, {28, 27}, {29, 98}, {30, 181}, {31, 236}, {6469100, 33}, {6469101, 204}, {6469102, 60}, {6469103, 126}},
			},
			want: 			cpuState{
				D:   [8]uint32{2503019293, 2236441715, 2143752968, 951587434, 4175915635, 1091789953, 449740308, 1307114624},
				A:   [7]uint32{722116397, 412483259, 740861745, 3113514081, 1666703179, 4194185542, 1426981444},
				PC:  459453936,
				SR:  8714,
				USP: 3105198,
				SSP: 10953602,
				RAM: [][2]uint32{{13403400, 78}, {13403401, 118}, {13403402, 158}, {13403403, 148}, {13403404, 31}, {13403405, 200}, {10953606, 133}, {10953607, 10}, {10953602, 34}, {10953603, 10}, {10953604, 0}, {10953605, 204}, {28, 27}, {29, 98}, {30, 181}, {31, 236}, {6469100, 33}, {6469101, 204}, {6469102, 60}, {6469103, 126}},
				Cycles: 34,
			},
		},
		{
			name: "547 TRAPV 4e76",
			init: 			cpuState{
				D:   [8]uint32{335316988, 4252905911, 1550892850, 2058363274, 1069308005, 3454256529, 126080772, 3901671002},
				A:   [7]uint32{1878012664, 2021911001, 847059393, 86467126, 2539834005, 1626122506, 1907231810},
				PC:  228268,
				SR:  519,
				USP: 341228,
				SSP: 2683732,
				RAM: [][2]uint32{{228264, 78}, {228265, 118}, {228266, 217}, {228267, 175}, {228268, 69}, {228269, 72}, {28, 249}, {29, 56}, {30, 57}, {31, 174}, {3684782, 189}, {3684783, 75}, {3684784, 224}, {3684785, 2}},
			},
			want: 			cpuState{
				D:   [8]uint32{335316988, 4252905911, 1550892850, 2058363274, 1069308005, 3454256529, 126080772, 3901671002},
				A:   [7]uint32{1878012664, 2021911001, 847059393, 86467126, 2539834005, 1626122506, 1907231810},
				PC:  4181211570,
				SR:  8711,
				USP: 341228,
				SSP: 2683726,
				RAM: [][2]uint32{{228264, 78}, {228265, 118}, {228266, 217}, {228267, 175}, {228268, 69}, {228269, 72}, {2683730, 123}, {2683731, 170}, {2683726, 2}, {2683727, 7}, {2683728, 0}, {2683729, 3}, {28, 249}, {29, 56}, {30, 57}, {31, 174}, {3684782, 189}, {3684783, 75}, {3684784, 224}, {3684785, 2}},
				Cycles: 34,
			},
		},
		{
			name: "839 TRAPV 4e76",
			init: 			cpuState{
				D:   [8]uint32{285172689, 1710235146, 270654911, 3332640866, 2902918166, 1813982194, 2180119505, 3070456011},
				A:   [7]uint32{4069295161, 1458566099, 1757077141, 2227894709, 901387205, 3861489207, 3843977662},
				PC:  2254906,
				SR:  1565,
				USP: 2196132,
				SSP: 5348410,
				RAM: [][2]uint32{{2254902, 78}, {2254903, 118}, {2254904, 116}, {2254905, 34}, {2254906, 61}, {2254907, 245}},
			},
			want: 			cpuState{
				D:   [8]uint32{285172689, 1710235146, 270654911, 3332640866, 2902918166, 1813982194, 2180119505, 3070456011},
				A:   [7]uint32{4069295161, 1458566099, 1757077141, 2227894709, 901387205, 3861489207, 3843977662},
				PC:  2254908,
				SR:  1565,
				USP: 2196132,
				SSP: 5348410,
				RAM: [][2]uint32{{2254902, 78}, {2254903, 118}, {2254904, 116}, {2254905, 34}, {2254906, 61}, {2254907, 245}},
				Cycles: 4,
			},
		},
		{
			name: "1115 TRAPV 4e76",
			init: 			cpuState{
				D:   [8]uint32{3128814649, 1056773900, 3022361770, 2497395664, 3189140460, 1510263159, 2709506668, 619719211},
				A:   [7]uint32{3195024119, 3460133565, 1857161394, 2346500627, 1763824080, 1296087396, 2668308706},
				PC:  3961226,
				SR:  27,
				USP: 2004822,
				SSP: 236246,
				RAM: [][2]uint32{{3961222, 78}, {3961223, 118}, {3961224, 106}, {3961225, 116}, {3961226, 148}, {3961227, 0}, {28, 101}, {29, 254}, {30, 234}, {31, 60}, {16706108, 247}, {16706109, 215}, {16706110, 140}, {16706111, 37}},
			},
			want: 			cpuState{
				D:   [8]uint32{3128814649, 1056773900, 3022361770, 2497395664, 3189140460, 1510263159, 2709506668, 619719211},
				A:   [7]uint32{3195024119, 3460133565, 1857161394, 2346500627, 1763824080, 1296087396, 2668308706},
				PC:  1711204928,
				SR:  8219,
				USP: 2004822,
				SSP: 236240,
				RAM: [][2]uint32{{3961222, 78}, {3961223, 118}, {3961224, 106}, {3961225, 116}, {3961226, 148}, {3961227, 0}, {236244, 113}, {236245, 136}, {236240, 0}, {236241, 27}, {236242, 0}, {236243, 60}, {28, 101}, {29, 254}, {30, 234}, {31, 60}, {16706108, 247}, {16706109, 215}, {16706110, 140}, {16706111, 37}},
				Cycles: 34,
			},
		},
		{
			name: "1405 TRAPV 4e76",
			init: 			cpuState{
				D:   [8]uint32{1505949981, 3069513656, 1562648657, 196508306, 1948710513, 3602431822, 3584998604, 1125250669},
				A:   [7]uint32{462157562, 890391178, 3553271564, 4118511359, 62709761, 528694152, 2599280367},
				PC:  6559710,
				SR:  9988,
				USP: 11038292,
				SSP: 2880448,
				RAM: [][2]uint32{{6559706, 78}, {6559707, 118}, {6559708, 102}, {6559709, 3}, {6559710, 93}, {6559711, 89}},
			},
			want: 			cpuState{
				D:   [8]uint32{1505949981, 3069513656, 1562648657, 196508306, 1948710513, 3602431822, 3584998604, 1125250669},
				A:   [7]uint32{462157562, 890391178, 3553271564, 4118511359, 62709761, 528694152, 2599280367},
				PC:  6559712,
				SR:  9988,
				USP: 11038292,
				SSP: 2880448,
				RAM: [][2]uint32{{6559706, 78}, {6559707, 118}, {6559708, 102}, {6559709, 3}, {6559710, 93}, {6559711, 89}},
				Cycles: 4,
			},
		},
		{
			name: "1674 TRAPV 4e76",
			init: 			cpuState{
				D:   [8]uint32{1632823852, 572739438, 2434914716, 816277175, 440293797, 3707822507, 3733325759, 2959710592},
				A:   [7]uint32{3526007218, 1701938214, 2104601078, 2801322027, 1432592744, 2351517305, 2874349018},
				PC:  15534676,
				SR:  1821,
				USP: 5016166,
				SSP: 13881752,
				RAM: [][2]uint32{{15534672, 78}, {15534673, 118}, {15534674, 119}, {15534675, 239}, {15534676, 22}, {15534677, 218}},
			},
			want: 			cpuState{
				D:   [8]uint32{1632823852, 572739438, 2434914716, 816277175, 440293797, 3707822507, 3733325759, 2959710592},
				A:   [7]uint32{3526007218, 1701938214, 2104601078, 2801322027, 1432592744, 2351517305, 2874349018},
				PC:  15534678,
				SR:  1821,
				USP: 5016166,
				SSP: 13881752,
				RAM: [][2]uint32{{15534672, 78}, {15534673, 118}, {15534674, 119}, {15534675, 239}, {15534676, 22}, {15534677, 218}},
				Cycles: 4,
			},
		},
		{
			name: "1949 TRAPV 4e76",
			init: 			cpuState{
				D:   [8]uint32{1246367903, 1885647776, 3975909925, 3275354856, 3111213395, 3716488702, 2402617943, 1572595177},
				A:   [7]uint32{564454343, 1010519216, 3873777274, 4239354226, 1332530249, 1670315851, 3155366820},
				PC:  2449604,
				SR:  270,
				USP: 4900746,
				SSP: 2612770,
				RAM: [][2]uint32{{2449600, 78}, {2449601, 118}, {2449602, 8}, {2449603, 239}, {2449604, 222}, {2449605, 244}, {28, 10}, {29, 120}, {30, 14}, {31, 182}, {7868086, 189}, {7868087, 34}, {7868088, 8}, {7868089, 224}},
			},
			want: 			cpuState{
				D:   [8]uint32{1246367903, 1885647776, 3975909925, 3275354856, 3111213395, 3716488702, 2402617943, 1572595177},
				A:   [7]uint32{564454343, 1010519216, 3873777274, 4239354226, 1332530249, 1670315851, 3155366820},
				PC:  175640250,
				SR:  8462,
				USP: 4900746,
				SSP: 2612764,
				RAM: [][2]uint32{{2449600, 78}, {2449601, 118}, {2449602, 8}, {2449603, 239}, {2449604, 222}, {2449605, 244}, {2612768, 96}, {2612769, 194}, {2612764, 1}, {2612765, 14}, {2612766, 0}, {2612767, 37}, {28, 10}, {29, 120}, {30, 14}, {31, 182}, {7868086, 189}, {7868087, 34}, {7868088, 8}, {7868089, 224}},
				Cycles: 34,
			},
		},
		{
			name: "2227 TRAPV 4e76",
			init: 			cpuState{
				D:   [8]uint32{987681876, 1997102720, 541151842, 4243231911, 3924690503, 2794318791, 3040703238, 1237445979},
				A:   [7]uint32{3262244877, 821761462, 660296613, 3252555728, 3086414166, 2742700410, 3478758278},
				PC:  8274876,
				SR:  521,
				USP: 14595238,
				SSP: 188848,
				RAM: [][2]uint32{{8274872, 78}, {8274873, 118}, {8274874, 94}, {8274875, 101}, {8274876, 55}, {8274877, 200}},
			},
			want: 			cpuState{
				D:   [8]uint32{987681876, 1997102720, 541151842, 4243231911, 3924690503, 2794318791, 3040703238, 1237445979},
				A:   [7]uint32{3262244877, 821761462, 660296613, 3252555728, 3086414166, 2742700410, 3478758278},
				PC:  8274878,
				SR:  521,
				USP: 14595238,
				SSP: 188848,
				RAM: [][2]uint32{{8274872, 78}, {8274873, 118}, {8274874, 94}, {8274875, 101}, {8274876, 55}, {8274877, 200}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestLINK(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 LINK A1, # 4e51",
			init: cpuState{
				D:   [8]uint32{1549680510, 3529549349, 402953891, 2836331597, 3505705563, 595564642, 2848265625, 2797936031},
				A:   [7]uint32{918023106, 2344368855, 3956781094, 1306461531, 2621107024, 522755042, 756702087},
				PC:  5926566,
				SR:  34077,
				USP: 2919422,
				SSP: 6008204,
				RAM: [][2]uint32{{5926562, 78}, {5926563, 81}, {5926564, 83}, {5926565, 221}, {5926566, 68}, {5926567, 77}, {5926568, 169}, {5926569, 58}},
			},
			want: cpuState{
				D:   [8]uint32{1549680510, 3529549349, 402953891, 2836331597, 3505705563, 595564642, 2848265625, 2797936031},
				A:   [7]uint32{918023106, 2919418, 3956781094, 1306461531, 2621107024, 522755042, 756702087},
				PC:  5926570,
				SR:  34077,
				USP: 2940887,
				SSP: 6008204,
				RAM: [][2]uint32{{5926562, 78}, {5926563, 81}, {5926564, 83}, {5926565, 221}, {5926566, 68}, {5926567, 77}, {2919418, 139}, {2919419, 188}, {2919420, 58}, {2919421, 215}, {5926568, 169}, {5926569, 58}},
				Cycles: 16,
			},
		},
		{
			name: "500 LINK A4, # 4e54",
			init: cpuState{
				D:   [8]uint32{425574540, 3394153340, 1882153756, 2376007096, 563181920, 2075860518, 1961805986, 3463876948},
				A:   [7]uint32{2101983761, 945460092, 140914489, 754763411, 3756096696, 3357398082, 583855179},
				PC:  451202,
				SR:  1049,
				USP: 9043786,
				SSP: 4556886,
				RAM: [][2]uint32{{451198, 78}, {451199, 84}, {451200, 145}, {451201, 75}, {451202, 48}, {451203, 48}, {451204, 112}, {451205, 90}},
			},
			want: cpuState{
				D:   [8]uint32{425574540, 3394153340, 1882153756, 2376007096, 563181920, 2075860518, 1961805986, 3463876948},
				A:   [7]uint32{2101983761, 945460092, 140914489, 754763411, 9043782, 3357398082, 583855179},
				PC:  451206,
				SR:  1049,
				USP: 9015441,
				SSP: 4556886,
				RAM: [][2]uint32{{451198, 78}, {451199, 84}, {451200, 145}, {451201, 75}, {451202, 48}, {451203, 48}, {9043782, 223}, {9043783, 225}, {9043784, 124}, {9043785, 184}, {451204, 112}, {451205, 90}},
				Cycles: 16,
			},
		},
		{
			name: "1000 LINK A3, # 4e53",
			init: cpuState{
				D:   [8]uint32{3596344682, 3621151121, 673324668, 1405083803, 556958545, 1119164912, 2877934472, 901397832},
				A:   [7]uint32{3608327268, 2427977602, 829658807, 1808028003, 2126515835, 491324719, 3331753124},
				PC:  7332626,
				SR:  1307,
				USP: 2700044,
				SSP: 4668742,
				RAM: [][2]uint32{{7332622, 78}, {7332623, 83}, {7332624, 124}, {7332625, 227}, {7332626, 166}, {7332627, 195}, {7332628, 152}, {7332629, 121}},
			},
			want: cpuState{
				D:   [8]uint32{3596344682, 3621151121, 673324668, 1405083803, 556958545, 1119164912, 2877934472, 901397832},
				A:   [7]uint32{3608327268, 2427977602, 829658807, 2700040, 2126515835, 491324719, 3331753124},
				PC:  7332630,
				SR:  1307,
				USP: 2732011,
				SSP: 4668742,
				RAM: [][2]uint32{{7332622, 78}, {7332623, 83}, {7332624, 124}, {7332625, 227}, {7332626, 166}, {7332627, 195}, {2700040, 107}, {2700041, 196}, {2700042, 81}, {2700043, 99}, {7332628, 152}, {7332629, 121}},
				Cycles: 16,
			},
		},
		{
			name: "1500 LINK A7, # 4e57",
			init: cpuState{
				D:   [8]uint32{3174832005, 1094241102, 2674456733, 3491116444, 1667553478, 4207860644, 1033506416, 669993730},
				A:   [7]uint32{1125938807, 4241410451, 436183217, 879100864, 3954590369, 1436114044, 4138346227},
				PC:  11463846,
				SR:  10009,
				USP: 862092,
				SSP: 16400608,
				RAM: [][2]uint32{{11463842, 78}, {11463843, 87}, {11463844, 102}, {11463845, 196}, {11463846, 89}, {11463847, 82}, {11463848, 198}, {11463849, 62}},
			},
			want: cpuState{
				D:   [8]uint32{3174832005, 1094241102, 2674456733, 3491116444, 1667553478, 4207860644, 1033506416, 669993730},
				A:   [7]uint32{1125938807, 4241410451, 436183217, 879100864, 3954590369, 1436114044, 4138346227},
				PC:  11463850,
				SR:  10009,
				USP: 862092,
				SSP: 16426912,
				RAM: [][2]uint32{{11463842, 78}, {11463843, 87}, {11463844, 102}, {11463845, 196}, {11463846, 89}, {11463847, 82}, {16400604, 0}, {16400605, 250}, {16400606, 64}, {16400607, 224}, {11463848, 198}, {11463849, 62}},
				Cycles: 16,
			},
		},
		{
			name: "2000 LINK A2, # 4e52",
			init: cpuState{
				D:   [8]uint32{999210835, 1470772316, 3534935607, 2546260387, 1291102159, 1549634259, 3896567636, 4283766997},
				A:   [7]uint32{1881380479, 2377301367, 1273064968, 1261108501, 347052799, 532912268, 3667933894},
				PC:  5132286,
				SR:  33813,
				USP: 4003452,
				SSP: 4389592,
				RAM: [][2]uint32{{5132282, 78}, {5132283, 82}, {5132284, 228}, {5132285, 197}, {5132286, 192}, {5132287, 46}, {5132288, 57}, {5132289, 45}},
			},
			want: cpuState{
				D:   [8]uint32{999210835, 1470772316, 3534935607, 2546260387, 1291102159, 1549634259, 3896567636, 4283766997},
				A:   [7]uint32{1881380479, 2377301367, 4003448, 1261108501, 347052799, 532912268, 3667933894},
				PC:  5132290,
				SR:  33813,
				USP: 3996477,
				SSP: 4389592,
				RAM: [][2]uint32{{5132282, 78}, {5132283, 82}, {5132284, 228}, {5132285, 197}, {5132286, 192}, {5132287, 46}, {4003448, 75}, {4003449, 225}, {4003450, 110}, {4003451, 8}, {5132288, 57}, {5132289, 45}},
				Cycles: 16,
			},
		},
		{
			name: "002 LINK A3, # 4e53",
			init: 			cpuState{
				D:   [8]uint32{2667183812, 3399638647, 4014732477, 695003667, 1763891362, 1595715932, 4214313363, 705659706},
				A:   [7]uint32{3470612388, 1301243456, 3274127731, 1424254422, 3189289549, 1436625593, 4094502481},
				PC:  4186352,
				SR:  8965,
				USP: 2669740,
				SSP: 3509484,
				RAM: [][2]uint32{{4186348, 78}, {4186349, 83}, {4186350, 187}, {4186351, 101}, {4186352, 211}, {4186353, 142}, {4186354, 226}, {4186355, 252}},
			},
			want: 			cpuState{
				D:   [8]uint32{2667183812, 3399638647, 4014732477, 695003667, 1763891362, 1595715932, 4214313363, 705659706},
				A:   [7]uint32{3470612388, 1301243456, 3274127731, 3509480, 3189289549, 1436625593, 4094502481},
				PC:  4186356,
				SR:  8965,
				USP: 2669740,
				SSP: 3491917,
				RAM: [][2]uint32{{4186348, 78}, {4186349, 83}, {4186350, 187}, {4186351, 101}, {4186352, 211}, {4186353, 142}, {3509480, 84}, {3509481, 228}, {3509482, 101}, {3509483, 214}, {4186354, 226}, {4186355, 252}},
				Cycles: 16,
			},
		},
		{
			name: "266 LINK A3, # 4e53",
			init: 			cpuState{
				D:   [8]uint32{2180761029, 2464240707, 2180097031, 3060685337, 1442422483, 2721494804, 958885930, 161927270},
				A:   [7]uint32{768477688, 2304428463, 1773043058, 2198080613, 3263139871, 1654542707, 3520674958},
				PC:  13723282,
				SR:  1821,
				USP: 14372316,
				SSP: 11624436,
				RAM: [][2]uint32{{13723278, 78}, {13723279, 83}, {13723280, 185}, {13723281, 111}, {13723282, 236}, {13723283, 115}, {13723284, 123}, {13723285, 228}},
			},
			want: 			cpuState{
				D:   [8]uint32{2180761029, 2464240707, 2180097031, 3060685337, 1442422483, 2721494804, 958885930, 161927270},
				A:   [7]uint32{768477688, 2304428463, 1773043058, 14372312, 3263139871, 1654542707, 3520674958},
				PC:  13723286,
				SR:  1821,
				USP: 14354247,
				SSP: 11624436,
				RAM: [][2]uint32{{13723278, 78}, {13723279, 83}, {13723280, 185}, {13723281, 111}, {13723282, 236}, {13723283, 115}, {14372312, 131}, {14372313, 4}, {14372314, 12}, {14372315, 101}, {13723284, 123}, {13723285, 228}},
				Cycles: 16,
			},
		},
		{
			name: "535 LINK A6, # 4e56",
			init: 			cpuState{
				D:   [8]uint32{2242426364, 4179579859, 1286148077, 1110519462, 112918484, 3172590572, 3149467362, 2402513521},
				A:   [7]uint32{3646643622, 3388742731, 2439626140, 599373454, 2136606841, 3659925953, 3373921309},
				PC:  4843564,
				SR:  1544,
				USP: 6589790,
				SSP: 3777376,
				RAM: [][2]uint32{{4843560, 78}, {4843561, 86}, {4843562, 136}, {4843563, 61}, {4843564, 177}, {4843565, 69}, {4843566, 131}, {4843567, 132}},
			},
			want: 			cpuState{
				D:   [8]uint32{2242426364, 4179579859, 1286148077, 1110519462, 112918484, 3172590572, 3149467362, 2402513521},
				A:   [7]uint32{3646643622, 3388742731, 2439626140, 599373454, 2136606841, 3659925953, 6589786},
				PC:  4843568,
				SR:  1544,
				USP: 6559127,
				SSP: 3777376,
				RAM: [][2]uint32{{4843560, 78}, {4843561, 86}, {4843562, 136}, {4843563, 61}, {4843564, 177}, {4843565, 69}, {6589786, 201}, {6589787, 25}, {6589788, 244}, {6589789, 29}, {4843566, 131}, {4843567, 132}},
				Cycles: 16,
			},
		},
		{
			name: "802 LINK A0, # 4e50",
			init: 			cpuState{
				D:   [8]uint32{1593132518, 305652219, 1390937829, 1896989324, 601970853, 178075302, 3672185293, 2245148324},
				A:   [7]uint32{588097031, 1634539125, 1586168103, 3501568184, 1114358200, 112567804, 2235629555},
				PC:  5089426,
				SR:  1296,
				USP: 4399774,
				SSP: 10215594,
				RAM: [][2]uint32{{5089422, 78}, {5089423, 80}, {5089424, 48}, {5089425, 130}, {5089426, 23}, {5089427, 44}, {5089428, 99}, {5089429, 22}},
			},
			want: 			cpuState{
				D:   [8]uint32{1593132518, 305652219, 1390937829, 1896989324, 601970853, 178075302, 3672185293, 2245148324},
				A:   [7]uint32{4399770, 1634539125, 1586168103, 3501568184, 1114358200, 112567804, 2235629555},
				PC:  5089430,
				SR:  1296,
				USP: 4412188,
				SSP: 10215594,
				RAM: [][2]uint32{{5089422, 78}, {5089423, 80}, {5089424, 48}, {5089425, 130}, {5089426, 23}, {5089427, 44}, {4399770, 35}, {4399771, 13}, {4399772, 166}, {4399773, 7}, {5089428, 99}, {5089429, 22}},
				Cycles: 16,
			},
		},
		{
			name: "1065 LINK A7, # 4e57",
			init: 			cpuState{
				D:   [8]uint32{459257314, 4173014008, 4268371212, 768788469, 1757638236, 3936871313, 3105201391, 2713557060},
				A:   [7]uint32{3832962661, 460574766, 386868389, 3218266785, 1366749694, 687074006, 4228816167},
				PC:  8226768,
				SR:  1546,
				USP: 12208640,
				SSP: 5821178,
				RAM: [][2]uint32{{8226764, 78}, {8226765, 87}, {8226766, 88}, {8226767, 208}, {8226768, 184}, {8226769, 22}, {8226770, 215}, {8226771, 138}},
			},
			want: 			cpuState{
				D:   [8]uint32{459257314, 4173014008, 4268371212, 768788469, 1757638236, 3936871313, 3105201391, 2713557060},
				A:   [7]uint32{3832962661, 460574766, 386868389, 3218266785, 1366749694, 687074006, 4228816167},
				PC:  8226772,
				SR:  1546,
				USP: 12231372,
				SSP: 5821178,
				RAM: [][2]uint32{{8226764, 78}, {8226765, 87}, {8226766, 88}, {8226767, 208}, {8226768, 184}, {8226769, 22}, {12208636, 0}, {12208637, 186}, {12208638, 74}, {12208639, 0}, {8226770, 215}, {8226771, 138}},
				Cycles: 16,
			},
		},
		{
			name: "1361 LINK A6, # 4e56",
			init: 			cpuState{
				D:   [8]uint32{3993523881, 4237100939, 705691607, 1007695341, 3370174882, 662560828, 1746901631, 46041391},
				A:   [7]uint32{4159079208, 1111949572, 3507096661, 1791045481, 120146011, 812214597, 1617985578},
				PC:  5749562,
				SR:  9756,
				USP: 12569992,
				SSP: 10503676,
				RAM: [][2]uint32{{5749558, 78}, {5749559, 86}, {5749560, 219}, {5749561, 3}, {5749562, 12}, {5749563, 121}, {5749564, 37}, {5749565, 220}},
			},
			want: 			cpuState{
				D:   [8]uint32{3993523881, 4237100939, 705691607, 1007695341, 3370174882, 662560828, 1746901631, 46041391},
				A:   [7]uint32{4159079208, 1111949572, 3507096661, 1791045481, 120146011, 812214597, 10503672},
				PC:  5749566,
				SR:  9756,
				USP: 12569992,
				SSP: 10494203,
				RAM: [][2]uint32{{5749558, 78}, {5749559, 86}, {5749560, 219}, {5749561, 3}, {5749562, 12}, {5749563, 121}, {10503672, 96}, {10503673, 112}, {10503674, 128}, {10503675, 42}, {5749564, 37}, {5749565, 220}},
				Cycles: 16,
			},
		},
		{
			name: "1654 LINK A7, # 4e57",
			init: 			cpuState{
				D:   [8]uint32{2574661630, 585602257, 1355705483, 649490351, 3624735912, 2564711888, 3793951166, 1858836086},
				A:   [7]uint32{881941004, 4083926485, 1200394041, 4266731071, 3522704752, 918767035, 179502257},
				PC:  412452,
				SR:  774,
				USP: 3569890,
				SSP: 11682196,
				RAM: [][2]uint32{{412448, 78}, {412449, 87}, {412450, 142}, {412451, 247}, {412452, 255}, {412453, 9}, {412454, 59}, {412455, 98}},
			},
			want: 			cpuState{
				D:   [8]uint32{2574661630, 585602257, 1355705483, 649490351, 3624735912, 2564711888, 3793951166, 1858836086},
				A:   [7]uint32{881941004, 4083926485, 1200394041, 4266731071, 3522704752, 918767035, 179502257},
				PC:  412456,
				SR:  774,
				USP: 3540949,
				SSP: 11682196,
				RAM: [][2]uint32{{412448, 78}, {412449, 87}, {412450, 142}, {412451, 247}, {412452, 255}, {412453, 9}, {3569886, 0}, {3569887, 54}, {3569888, 120}, {3569889, 226}, {412454, 59}, {412455, 98}},
				Cycles: 16,
			},
		},
		{
			name: "1952 LINK A6, # 4e56",
			init: 			cpuState{
				D:   [8]uint32{2065682740, 2359905184, 229225621, 2788993620, 471852943, 166613913, 3611060310, 3105444576},
				A:   [7]uint32{1246913197, 1111743611, 1754852467, 2869755771, 859306338, 3817389209, 1465035066},
				PC:  7980380,
				SR:  533,
				USP: 3534982,
				SSP: 14801162,
				RAM: [][2]uint32{{7980376, 78}, {7980377, 86}, {7980378, 162}, {7980379, 126}, {7980380, 253}, {7980381, 52}, {7980382, 145}, {7980383, 150}},
			},
			want: 			cpuState{
				D:   [8]uint32{2065682740, 2359905184, 229225621, 2788993620, 471852943, 166613913, 3611060310, 3105444576},
				A:   [7]uint32{1246913197, 1111743611, 1754852467, 2869755771, 859306338, 3817389209, 3534978},
				PC:  7980384,
				SR:  533,
				USP: 3511040,
				SSP: 14801162,
				RAM: [][2]uint32{{7980376, 78}, {7980377, 86}, {7980378, 162}, {7980379, 126}, {7980380, 253}, {7980381, 52}, {3534978, 87}, {3534979, 82}, {3534980, 169}, {3534981, 58}, {7980382, 145}, {7980383, 150}},
				Cycles: 16,
			},
		},
		{
			name: "2231 LINK A1, # 4e51",
			init: 			cpuState{
				D:   [8]uint32{327892521, 3936858751, 818298396, 74745526, 253949857, 3410464388, 3093442626, 3147148927},
				A:   [7]uint32{2303365645, 130735570, 3514699901, 48652788, 3614360860, 745161539, 4279973783},
				PC:  9777238,
				SR:  8223,
				USP: 588500,
				SSP: 13869976,
				RAM: [][2]uint32{{9777234, 78}, {9777235, 81}, {9777236, 237}, {9777237, 37}, {9777238, 52}, {9777239, 168}, {9777240, 249}, {9777241, 219}},
			},
			want: 			cpuState{
				D:   [8]uint32{327892521, 3936858751, 818298396, 74745526, 253949857, 3410464388, 3093442626, 3147148927},
				A:   [7]uint32{2303365645, 13869972, 3514699901, 48652788, 3614360860, 745161539, 4279973783},
				PC:  9777242,
				SR:  8223,
				USP: 588500,
				SSP: 13865145,
				RAM: [][2]uint32{{9777234, 78}, {9777235, 81}, {9777236, 237}, {9777237, 37}, {9777238, 52}, {9777239, 168}, {13869972, 7}, {13869973, 202}, {13869974, 221}, {13869975, 210}, {9777240, 249}, {9777241, 219}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestUNLINK(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 UNLINK A4 4e5c",
			init: cpuState{
				D:   [8]uint32{4188436590, 403533247, 615474429, 3747526936, 3825585159, 2489378293, 1133655991, 4128972051},
				A:   [7]uint32{1694106958, 3493144052, 581047800, 4261867541, 3129588871, 1826850257, 3304415370},
				PC:  6891992,
				SR:  9233,
				USP: 10090944,
				SSP: 16089654,
				RAM: [][2]uint32{{6891988, 78}, {6891989, 92}, {6891990, 11}, {6891991, 27}, {12, 24}, {13, 20}, {14, 95}, {15, 122}, {1335162, 95}, {1335163, 242}, {1335164, 106}, {1335165, 199}},
			},
			want: cpuState{
				D:      [8]uint32{4188436590, 403533247, 615474429, 3747526936, 3825585159, 2489378293, 1133655991, 4128972051},
				A:      [7]uint32{1694106958, 3493144052, 581047800, 4261867541, 3129588871, 1826850257, 3304415370},
				PC:     403988350,
				SR:     9233,
				USP:    10090944,
				SSP:    16089640,
				RAM:    [][2]uint32{{6891988, 78}, {6891989, 92}, {6891990, 11}, {6891991, 27}, {16089652, 41}, {16089653, 216}, {16089648, 36}, {16089649, 17}, {16089650, 0}, {16089651, 105}, {16089646, 78}, {16089647, 92}, {16089644, 188}, {16089645, 135}, {16089640, 78}, {16089641, 85}, {16089642, 186}, {16089643, 137}, {12, 24}, {13, 20}, {14, 95}, {15, 122}, {1335162, 95}, {1335163, 242}, {1335164, 106}, {1335165, 199}},
				Halted: true,
			},
		},
		{
			name: "500 UNLINK A5 4e5d",
			init: cpuState{
				D:   [8]uint32{955354634, 1897319442, 2677659853, 3085044942, 101662574, 3577764799, 1234795614, 2978866406},
				A:   [7]uint32{1570383649, 2830363942, 2675505303, 2520931905, 2219935067, 3662507190, 377364581},
				PC:  12708572,
				SR:  5,
				USP: 15909844,
				SSP: 9651358,
				RAM: [][2]uint32{{12708568, 78}, {12708569, 93}, {12708570, 127}, {12708571, 72}, {5074102, 196}, {5074103, 25}, {5074104, 134}, {5074105, 137}, {12708572, 226}, {12708573, 124}},
			},
			want: cpuState{
				D:   [8]uint32{955354634, 1897319442, 2677659853, 3085044942, 101662574, 3577764799, 1234795614, 2978866406},
				A:   [7]uint32{1570383649, 2830363942, 2675505303, 2520931905, 2219935067, 3290007177, 377364581},
				PC:  12708574,
				SR:  5,
				USP: 3662507194,
				SSP: 9651358,
				RAM: [][2]uint32{{12708568, 78}, {12708569, 93}, {12708570, 127}, {12708571, 72}, {5074102, 196}, {5074103, 25}, {5074104, 134}, {5074105, 137}, {12708572, 226}, {12708573, 124}},
				Cycles: 12,
			},
		},
		{
			name: "1000 UNLINK A4 4e5c",
			init: cpuState{
				D:   [8]uint32{1715425790, 3776789943, 216486791, 1664131033, 4290017278, 1405198863, 3654345789, 3611134267},
				A:   [7]uint32{4152736271, 3832597824, 1256201469, 2897977011, 3908002215, 2955164549, 3181401823},
				PC:  10600234,
				SR:  33300,
				USP: 3624920,
				SSP: 6393318,
				RAM: [][2]uint32{{10600230, 78}, {10600231, 92}, {10600232, 83}, {10600233, 115}, {12, 153}, {13, 146}, {14, 104}, {15, 228}, {9595108, 235}, {9595109, 6}, {9595110, 63}, {9595111, 3}},
			},
			want: cpuState{
				D:      [8]uint32{1715425790, 3776789943, 216486791, 1664131033, 4290017278, 1405198863, 3654345789, 3611134267},
				A:      [7]uint32{4152736271, 3832597824, 1256201469, 2897977011, 3908002215, 2955164549, 3181401823},
				PC:     2576509160,
				SR:     8724,
				USP:    3624920,
				SSP:    6393304,
				RAM:    [][2]uint32{{10600230, 78}, {10600231, 92}, {10600232, 83}, {10600233, 115}, {6393316, 191}, {6393317, 42}, {6393312, 130}, {6393313, 20}, {6393314, 0}, {6393315, 161}, {6393310, 78}, {6393311, 92}, {6393308, 97}, {6393309, 167}, {6393304, 78}, {6393305, 81}, {6393306, 232}, {6393307, 239}, {12, 153}, {13, 146}, {14, 104}, {15, 228}, {9595108, 235}, {9595109, 6}, {9595110, 63}, {9595111, 3}},
				Halted: true,
			},
		},
		{
			name: "1500 UNLINK A3 4e5b",
			init: cpuState{
				D:   [8]uint32{986356251, 903404750, 597611831, 1574852755, 3231521343, 1390701803, 4074842356, 767866649},
				A:   [7]uint32{512514642, 738865342, 3551273134, 3406394854, 1125202022, 4237332447, 3019944613},
				PC:  5600006,
				SR:  42776,
				USP: 15617210,
				SSP: 13299080,
				RAM: [][2]uint32{{5600002, 78}, {5600003, 91}, {5600004, 77}, {5600005, 216}, {620006, 200}, {620007, 116}, {620008, 99}, {620009, 222}, {5600006, 197}, {5600007, 222}},
			},
			want: cpuState{
				D:   [8]uint32{986356251, 903404750, 597611831, 1574852755, 3231521343, 1390701803, 4074842356, 767866649},
				A:   [7]uint32{512514642, 738865342, 3551273134, 3363070942, 1125202022, 4237332447, 3019944613},
				PC:  5600008,
				SR:  42776,
				USP: 15617210,
				SSP: 3406394858,
				RAM: [][2]uint32{{5600002, 78}, {5600003, 91}, {5600004, 77}, {5600005, 216}, {620006, 200}, {620007, 116}, {620008, 99}, {620009, 222}, {5600006, 197}, {5600007, 222}},
				Cycles: 12,
			},
		},
		{
			name: "2000 UNLINK A2 4e5a",
			init: cpuState{
				D:   [8]uint32{3477829563, 658420195, 1763503059, 990799756, 2791921992, 3097682834, 744330401, 2652426465},
				A:   [7]uint32{764463701, 3340263618, 2334053929, 514531639, 944792472, 3497479675, 887733273},
				PC:  8613462,
				SR:  41993,
				USP: 11613240,
				SSP: 6846608,
				RAM: [][2]uint32{{8613458, 78}, {8613459, 90}, {8613460, 122}, {8613461, 112}, {12, 218}, {13, 96}, {14, 196}, {15, 26}, {6341658, 101}, {6341659, 0}, {6341660, 47}, {6341661, 209}},
			},
			want: cpuState{
				D:      [8]uint32{3477829563, 658420195, 1763503059, 990799756, 2791921992, 3097682834, 744330401, 2652426465},
				A:      [7]uint32{764463701, 3340263618, 2334053929, 514531639, 944792472, 3497479675, 887733273},
				PC:     3663774750,
				SR:     9225,
				USP:    11613240,
				SSP:    6846594,
				RAM:    [][2]uint32{{8613458, 78}, {8613459, 90}, {8613460, 122}, {8613461, 112}, {6846606, 110}, {6846607, 86}, {6846602, 164}, {6846603, 9}, {6846604, 0}, {6846605, 131}, {6846600, 78}, {6846601, 90}, {6846598, 214}, {6846599, 41}, {6846594, 78}, {6846595, 85}, {6846596, 139}, {6846597, 30}, {12, 218}, {13, 96}, {14, 196}, {15, 26}, {6341658, 101}, {6341659, 0}, {6341660, 47}, {6341661, 209}},
				Halted: true,
			},
		},
		{
			name: "001 UNLINK A2 4e5a",
			init: 			cpuState{
				D:   [8]uint32{2916556167, 428099635, 118450567, 2077910253, 2330782894, 3217358451, 1502496035, 1434474488},
				A:   [7]uint32{2781200437, 2029487232, 1127418144, 1656483408, 988249728, 2986607512, 3983882045},
				PC:  1058370,
				SR:  9733,
				USP: 3802566,
				SSP: 1720518,
				RAM: [][2]uint32{{1058366, 78}, {1058367, 90}, {1058368, 45}, {1058369, 169}, {3344672, 89}, {3344673, 234}, {3344674, 110}, {3344675, 29}, {1058370, 196}, {1058371, 149}},
			},
			want: 			cpuState{
				D:   [8]uint32{2916556167, 428099635, 118450567, 2077910253, 2330782894, 3217358451, 1502496035, 1434474488},
				A:   [7]uint32{2781200437, 2029487232, 1508535837, 1656483408, 988249728, 2986607512, 3983882045},
				PC:  1058372,
				SR:  9733,
				USP: 3802566,
				SSP: 1127418148,
				RAM: [][2]uint32{{1058366, 78}, {1058367, 90}, {1058368, 45}, {1058369, 169}, {3344672, 89}, {3344673, 234}, {3344674, 110}, {3344675, 29}, {1058370, 196}, {1058371, 149}},
				Cycles: 12,
			},
		},
		{
			name: "229 UNLINK A1 4e59",
			init: 			cpuState{
				D:   [8]uint32{3919006327, 3495165857, 670008604, 1493153988, 1270022083, 2006727210, 1672049723, 3926150040},
				A:   [7]uint32{138586590, 1431270532, 2166534320, 3548141857, 531445470, 115724566, 3228664471},
				PC:  13975124,
				SR:  8451,
				USP: 14056562,
				SSP: 14410608,
				RAM: [][2]uint32{{13975120, 78}, {13975121, 89}, {13975122, 161}, {13975123, 166}, {5207172, 139}, {5207173, 79}, {5207174, 237}, {5207175, 61}, {13975124, 45}, {13975125, 246}},
			},
			want: 			cpuState{
				D:   [8]uint32{3919006327, 3495165857, 670008604, 1493153988, 1270022083, 2006727210, 1672049723, 3926150040},
				A:   [7]uint32{138586590, 2337271101, 2166534320, 3548141857, 531445470, 115724566, 3228664471},
				PC:  13975126,
				SR:  8451,
				USP: 14056562,
				SSP: 1431270536,
				RAM: [][2]uint32{{13975120, 78}, {13975121, 89}, {13975122, 161}, {13975123, 166}, {5207172, 139}, {5207173, 79}, {5207174, 237}, {5207175, 61}, {13975124, 45}, {13975125, 246}},
				Cycles: 12,
			},
		},
		{
			name: "478 UNLINK A1 4e59",
			init: 			cpuState{
				D:   [8]uint32{1163218554, 3286000137, 2052173472, 1571738277, 3734104865, 2170230764, 3131809650, 2660876719},
				A:   [7]uint32{1624070422, 685050384, 3871895952, 1750707081, 2820310584, 143901750, 2706240238},
				PC:  6701168,
				SR:  543,
				USP: 4217748,
				SSP: 8403722,
				RAM: [][2]uint32{{6701164, 78}, {6701165, 89}, {6701166, 98}, {6701167, 144}, {13961744, 217}, {13961745, 37}, {13961746, 44}, {13961747, 71}, {6701168, 0}, {6701169, 171}},
			},
			want: 			cpuState{
				D:   [8]uint32{1163218554, 3286000137, 2052173472, 1571738277, 3734104865, 2170230764, 3131809650, 2660876719},
				A:   [7]uint32{1624070422, 3643092039, 3871895952, 1750707081, 2820310584, 143901750, 2706240238},
				PC:  6701170,
				SR:  543,
				USP: 685050388,
				SSP: 8403722,
				RAM: [][2]uint32{{6701164, 78}, {6701165, 89}, {6701166, 98}, {6701167, 144}, {13961744, 217}, {13961745, 37}, {13961746, 44}, {13961747, 71}, {6701168, 0}, {6701169, 171}},
				Cycles: 12,
			},
		},
		{
			name: "718 UNLINK A7 4e5f",
			init: 			cpuState{
				D:   [8]uint32{1884601286, 118471379, 3805320682, 3928830851, 1909938666, 2289917767, 890974010, 390151686},
				A:   [7]uint32{539195769, 2564407796, 1344793786, 2240008114, 1317595157, 3167653319, 3044276370},
				PC:  12604560,
				SR:  1552,
				USP: 3158588,
				SSP: 12317462,
				RAM: [][2]uint32{{12604556, 78}, {12604557, 95}, {12604558, 70}, {12604559, 246}, {3158588, 218}, {3158589, 182}, {3158590, 202}, {3158591, 206}, {12604560, 85}, {12604561, 194}},
			},
			want: 			cpuState{
				D:   [8]uint32{1884601286, 118471379, 3805320682, 3928830851, 1909938666, 2289917767, 890974010, 390151686},
				A:   [7]uint32{539195769, 2564407796, 1344793786, 2240008114, 1317595157, 3167653319, 3044276370},
				PC:  12604562,
				SR:  1552,
				USP: 3669412558,
				SSP: 12317462,
				RAM: [][2]uint32{{12604556, 78}, {12604557, 95}, {12604558, 70}, {12604559, 246}, {3158588, 218}, {3158589, 182}, {3158590, 202}, {3158591, 206}, {12604560, 85}, {12604561, 194}},
				Cycles: 12,
			},
		},
		{
			name: "1005 UNLINK A3 4e5b",
			init: 			cpuState{
				D:   [8]uint32{936740844, 2868042270, 1777171542, 5849443, 1406034094, 3023634406, 1361565691, 163934172},
				A:   [7]uint32{1299460946, 843375096, 1130015509, 1661509510, 2324904752, 3431590237, 3666589283},
				PC:  14270922,
				SR:  9503,
				USP: 15452892,
				SSP: 5211348,
				RAM: [][2]uint32{{14270918, 78}, {14270919, 91}, {14270920, 195}, {14270921, 83}, {565126, 236}, {565127, 209}, {565128, 181}, {565129, 152}, {14270922, 63}, {14270923, 114}},
			},
			want: 			cpuState{
				D:   [8]uint32{936740844, 2868042270, 1777171542, 5849443, 1406034094, 3023634406, 1361565691, 163934172},
				A:   [7]uint32{1299460946, 843375096, 1130015509, 3973166488, 2324904752, 3431590237, 3666589283},
				PC:  14270924,
				SR:  9503,
				USP: 15452892,
				SSP: 1661509514,
				RAM: [][2]uint32{{14270918, 78}, {14270919, 91}, {14270920, 195}, {14270921, 83}, {565126, 236}, {565127, 209}, {565128, 181}, {565129, 152}, {14270922, 63}, {14270923, 114}},
				Cycles: 12,
			},
		},
		{
			name: "1334 UNLINK A5 4e5d",
			init: 			cpuState{
				D:   [8]uint32{3020622501, 1365522482, 4113781162, 1752429937, 1760984844, 684046646, 474403383, 197998590},
				A:   [7]uint32{1788756167, 1419818385, 3299872636, 347906007, 1723626527, 4065220502, 1258776744},
				PC:  3942818,
				SR:  1308,
				USP: 2701612,
				SSP: 11029770,
				RAM: [][2]uint32{{3942814, 78}, {3942815, 93}, {3942816, 124}, {3942817, 42}, {5134230, 86}, {5134231, 108}, {5134232, 85}, {5134233, 158}, {3942818, 180}, {3942819, 175}},
			},
			want: 			cpuState{
				D:   [8]uint32{3020622501, 1365522482, 4113781162, 1752429937, 1760984844, 684046646, 474403383, 197998590},
				A:   [7]uint32{1788756167, 1419818385, 3299872636, 347906007, 1723626527, 1449940382, 1258776744},
				PC:  3942820,
				SR:  1308,
				USP: 4065220506,
				SSP: 11029770,
				RAM: [][2]uint32{{3942814, 78}, {3942815, 93}, {3942816, 124}, {3942817, 42}, {5134230, 86}, {5134231, 108}, {5134232, 85}, {5134233, 158}, {3942818, 180}, {3942819, 175}},
				Cycles: 12,
			},
		},
		{
			name: "1628 UNLINK A2 4e5a",
			init: 			cpuState{
				D:   [8]uint32{90000811, 39001908, 1949143436, 1850589915, 718259423, 3392880912, 3608216360, 3443077403},
				A:   [7]uint32{976172422, 659409921, 1617006278, 4249844450, 130876355, 2214677918, 1427107499},
				PC:  6714582,
				SR:  8968,
				USP: 9623764,
				SSP: 6379204,
				RAM: [][2]uint32{{6714578, 78}, {6714579, 90}, {6714580, 154}, {6714581, 8}, {6393542, 153}, {6393543, 220}, {6393544, 19}, {6393545, 183}, {6714582, 24}, {6714583, 159}},
			},
			want: 			cpuState{
				D:   [8]uint32{90000811, 39001908, 1949143436, 1850589915, 718259423, 3392880912, 3608216360, 3443077403},
				A:   [7]uint32{976172422, 659409921, 2581337015, 4249844450, 130876355, 2214677918, 1427107499},
				PC:  6714584,
				SR:  8968,
				USP: 9623764,
				SSP: 1617006282,
				RAM: [][2]uint32{{6714578, 78}, {6714579, 90}, {6714580, 154}, {6714581, 8}, {6393542, 153}, {6393543, 220}, {6393544, 19}, {6393545, 183}, {6714582, 24}, {6714583, 159}},
				Cycles: 12,
			},
		},
		{
			name: "1881 UNLINK A5 4e5d",
			init: 			cpuState{
				D:   [8]uint32{1401366584, 1604385063, 3796107433, 3310915445, 775018422, 478733916, 3360269996, 2982917692},
				A:   [7]uint32{2931450662, 377050098, 2827673373, 3342251657, 2811898291, 514371634, 1591793008},
				PC:  10710432,
				SR:  8710,
				USP: 14142826,
				SSP: 2903612,
				RAM: [][2]uint32{{10710428, 78}, {10710429, 93}, {10710430, 104}, {10710431, 255}, {11055154, 209}, {11055155, 173}, {11055156, 37}, {11055157, 103}, {10710432, 253}, {10710433, 151}},
			},
			want: 			cpuState{
				D:   [8]uint32{1401366584, 1604385063, 3796107433, 3310915445, 775018422, 478733916, 3360269996, 2982917692},
				A:   [7]uint32{2931450662, 377050098, 2827673373, 3342251657, 2811898291, 3517785447, 1591793008},
				PC:  10710434,
				SR:  8710,
				USP: 14142826,
				SSP: 514371638,
				RAM: [][2]uint32{{10710428, 78}, {10710429, 93}, {10710430, 104}, {10710431, 255}, {11055154, 209}, {11055155, 173}, {11055156, 37}, {11055157, 103}, {10710432, 253}, {10710433, 151}},
				Cycles: 12,
			},
		},
		{
			name: "2149 UNLINK A3 4e5b",
			init: 			cpuState{
				D:   [8]uint32{3549829902, 1864724603, 3462386207, 3882859015, 3571131266, 3012884490, 3717575313, 3403401862},
				A:   [7]uint32{4253049327, 1796319128, 690970141, 2150010562, 2942867833, 2598469046, 1516759667},
				PC:  15160740,
				SR:  8448,
				USP: 11105750,
				SSP: 5443022,
				RAM: [][2]uint32{{15160736, 78}, {15160737, 91}, {15160738, 193}, {15160739, 19}, {2526914, 168}, {2526915, 92}, {2526916, 197}, {2526917, 96}, {15160740, 3}, {15160741, 35}},
			},
			want: 			cpuState{
				D:   [8]uint32{3549829902, 1864724603, 3462386207, 3882859015, 3571131266, 3012884490, 3717575313, 3403401862},
				A:   [7]uint32{4253049327, 1796319128, 690970141, 2824652128, 2942867833, 2598469046, 1516759667},
				PC:  15160742,
				SR:  8448,
				USP: 11105750,
				SSP: 2150010566,
				RAM: [][2]uint32{{15160736, 78}, {15160737, 91}, {15160738, 193}, {15160739, 19}, {2526914, 168}, {2526915, 92}, {2526916, 197}, {2526917, 96}, {15160740, 3}, {15160741, 35}},
				Cycles: 12,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEtoCCR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEtoCCR (A7) 44d7",
			init: cpuState{
				D:   [8]uint32{4270573421, 873307202, 2060108381, 423129026, 1188449628, 1593341122, 3805548495, 3652755872},
				A:   [7]uint32{1113316608, 1471957673, 2603170087, 1756381978, 210391634, 92032902, 3645782566},
				PC:  790748,
				SR:  41742,
				USP: 11124156,
				SSP: 10012702,
				RAM: [][2]uint32{{790744, 68}, {790745, 215}, {790746, 166}, {790747, 184}, {10012702, 181}, {10012703, 204}, {790748, 148}, {790749, 65}},
			},
			want: cpuState{
				D:   [8]uint32{4270573421, 873307202, 2060108381, 423129026, 1188449628, 1593341122, 3805548495, 3652755872},
				A:   [7]uint32{1113316608, 1471957673, 2603170087, 1756381978, 210391634, 92032902, 3645782566},
				PC:  790750,
				SR:  41740,
				USP: 11124156,
				SSP: 10012702,
				RAM: [][2]uint32{{790744, 68}, {790745, 215}, {790746, 166}, {790747, 184}, {10012702, 181}, {10012703, 204}, {790748, 148}, {790749, 65}},
				Cycles: 16,
			},
		},
		{
			name: "500 MOVEtoCCR (A0)+ 44d8",
			init: cpuState{
				D:   [8]uint32{3004163013, 520453350, 1665239044, 784654326, 3724403018, 2464868295, 1819010595, 1513838663},
				A:   [7]uint32{2732787038, 399071319, 2473853894, 244281061, 767986525, 2083250763, 4118414929},
				PC:  1074622,
				SR:  33537,
				USP: 9510274,
				SSP: 16763824,
				RAM: [][2]uint32{{1074618, 68}, {1074619, 216}, {1074620, 106}, {1074621, 223}, {14878046, 248}, {14878047, 244}, {1074622, 202}, {1074623, 218}},
			},
			want: cpuState{
				D:   [8]uint32{3004163013, 520453350, 1665239044, 784654326, 3724403018, 2464868295, 1819010595, 1513838663},
				A:   [7]uint32{2732787040, 399071319, 2473853894, 244281061, 767986525, 2083250763, 4118414929},
				PC:  1074624,
				SR:  33556,
				USP: 9510274,
				SSP: 16763824,
				RAM: [][2]uint32{{1074618, 68}, {1074619, 216}, {1074620, 106}, {1074621, 223}, {14878046, 248}, {14878047, 244}, {1074622, 202}, {1074623, 218}},
				Cycles: 16,
			},
		},
		{
			name: "1000 MOVEtoCCR D6 44c6",
			init: cpuState{
				D:   [8]uint32{1062174228, 4277796943, 3678280340, 2953657901, 1369937534, 607046054, 1025009999, 1256671144},
				A:   [7]uint32{3477862065, 1110162641, 388031723, 3224192529, 766817666, 1737130810, 2678090511},
				PC:  12340010,
				SR:  8704,
				USP: 1023522,
				SSP: 9169932,
				RAM: [][2]uint32{{12340006, 68}, {12340007, 198}, {12340008, 50}, {12340009, 7}, {12340010, 89}, {12340011, 147}},
			},
			want: cpuState{
				D:   [8]uint32{1062174228, 4277796943, 3678280340, 2953657901, 1369937534, 607046054, 1025009999, 1256671144},
				A:   [7]uint32{3477862065, 1110162641, 388031723, 3224192529, 766817666, 1737130810, 2678090511},
				PC:  12340012,
				SR:  8719,
				USP: 1023522,
				SSP: 9169932,
				RAM: [][2]uint32{{12340006, 68}, {12340007, 198}, {12340008, 50}, {12340009, 7}, {12340010, 89}, {12340011, 147}},
				Cycles: 12,
			},
		},
		{
			name: "1500 MOVEtoCCR (A0) 44d0",
			init: cpuState{
				D:   [8]uint32{465883211, 3087343920, 2688559184, 1752985379, 3090264613, 678695379, 665757163, 2794283382},
				A:   [7]uint32{3279323300, 1017193464, 1864601352, 490259197, 4162662288, 2245680818, 2263519760},
				PC:  9352324,
				SR:  1286,
				USP: 568284,
				SSP: 2142362,
				RAM: [][2]uint32{{9352320, 68}, {9352321, 208}, {9352322, 192}, {9352323, 127}, {7766180, 88}, {7766181, 76}, {9352324, 222}, {9352325, 28}},
			},
			want: cpuState{
				D:   [8]uint32{465883211, 3087343920, 2688559184, 1752985379, 3090264613, 678695379, 665757163, 2794283382},
				A:   [7]uint32{3279323300, 1017193464, 1864601352, 490259197, 4162662288, 2245680818, 2263519760},
				PC:  9352326,
				SR:  1292,
				USP: 568284,
				SSP: 2142362,
				RAM: [][2]uint32{{9352320, 68}, {9352321, 208}, {9352322, 192}, {9352323, 127}, {7766180, 88}, {7766181, 76}, {9352324, 222}, {9352325, 28}},
				Cycles: 16,
			},
		},
		{
			name: "2000 MOVEtoCCR (d16, A4) 44ec",
			init: cpuState{
				D:   [8]uint32{788192078, 1250959520, 4051970713, 2769674552, 418192740, 1377804564, 2670827572, 4048077299},
				A:   [7]uint32{2803945173, 3200741387, 637590458, 776142276, 466116355, 1644891918, 82803457},
				PC:  8402982,
				SR:  42006,
				USP: 10454214,
				SSP: 13533164,
				RAM: [][2]uint32{{8402978, 68}, {8402979, 236}, {8402980, 249}, {8402981, 230}, {8402982, 72}, {8402983, 43}, {12, 75}, {13, 2}, {14, 137}, {15, 48}, {166192, 1}, {166193, 81}, {166194, 223}, {166195, 239}},
			},
			want: cpuState{
				D:      [8]uint32{788192078, 1250959520, 4051970713, 2769674552, 418192740, 1377804564, 2670827572, 4048077299},
				A:      [7]uint32{2803945173, 3200741387, 637590458, 776142276, 466116355, 1644891918, 82803457},
				PC:     1258457396,
				SR:     9238,
				USP:    10454214,
				SSP:    13533150,
				RAM:    [][2]uint32{{8402978, 68}, {8402979, 236}, {8402980, 249}, {8402981, 230}, {8402982, 72}, {8402983, 43}, {13533162, 56}, {13533163, 36}, {13533158, 164}, {13533159, 22}, {13533160, 0}, {13533161, 128}, {13533156, 68}, {13533157, 236}, {13533154, 88}, {13533155, 233}, {13533150, 68}, {13533151, 245}, {13533152, 27}, {13533153, 200}, {12, 75}, {13, 2}, {14, 137}, {15, 48}, {166192, 1}, {166193, 81}, {166194, 223}, {166195, 239}},
				Halted: true,
			},
		},
		{
			name: "004 MOVEtoCCR (d8, A3, Xn) 44f3",
			init: 			cpuState{
				D:   [8]uint32{436561080, 1764819217, 2630838894, 2129653696, 2596664191, 2795854187, 2646100614, 3159667554},
				A:   [7]uint32{1636304541, 3567263449, 1276836491, 407877269, 1583169743, 4111278114, 987327890},
				PC:  9681914,
				SR:  6,
				USP: 3430964,
				SSP: 16454378,
				RAM: [][2]uint32{{9681910, 68}, {9681911, 243}, {9681912, 39}, {9681913, 81}, {9681914, 188}, {9681915, 99}, {5251412, 13}, {5251413, 75}, {9681916, 13}, {9681917, 228}},
			},
			want: 			cpuState{
				D:   [8]uint32{436561080, 1764819217, 2630838894, 2129653696, 2596664191, 2795854187, 2646100614, 3159667554},
				A:   [7]uint32{1636304541, 3567263449, 1276836491, 407877269, 1583169743, 4111278114, 987327890},
				PC:  9681918,
				SR:  11,
				USP: 3430964,
				SSP: 16454378,
				RAM: [][2]uint32{{9681910, 68}, {9681911, 243}, {9681912, 39}, {9681913, 81}, {9681914, 188}, {9681915, 99}, {5251412, 13}, {5251413, 75}, {9681916, 13}, {9681917, 228}},
				Cycles: 22,
			},
		},
		{
			name: "305 MOVEtoCCR (d16, A3) 44eb",
			init: 			cpuState{
				D:   [8]uint32{4198348255, 4175938304, 712050496, 1718769870, 3016399828, 2572936176, 3402636005, 4227521882},
				A:   [7]uint32{863427186, 3164190825, 3145341672, 439440096, 115042585, 3709216079, 1800530594},
				PC:  16267656,
				SR:  9995,
				USP: 12786148,
				SSP: 11278102,
				RAM: [][2]uint32{{16267652, 68}, {16267653, 235}, {16267654, 111}, {16267655, 206}, {16267656, 254}, {16267657, 15}, {3261102, 19}, {3261103, 244}, {16267658, 74}, {16267659, 75}},
			},
			want: 			cpuState{
				D:   [8]uint32{4198348255, 4175938304, 712050496, 1718769870, 3016399828, 2572936176, 3402636005, 4227521882},
				A:   [7]uint32{863427186, 3164190825, 3145341672, 439440096, 115042585, 3709216079, 1800530594},
				PC:  16267660,
				SR:  10004,
				USP: 12786148,
				SSP: 11278102,
				RAM: [][2]uint32{{16267652, 68}, {16267653, 235}, {16267654, 111}, {16267655, 206}, {16267656, 254}, {16267657, 15}, {3261102, 19}, {3261103, 244}, {16267658, 74}, {16267659, 75}},
				Cycles: 20,
			},
		},
		{
			name: "553 MOVEtoCCR (d8, A0, Xn) 44f0",
			init: 			cpuState{
				D:   [8]uint32{2902428008, 2798275389, 3237412113, 2197184125, 2422438785, 3446951675, 1763837304, 1015137101},
				A:   [7]uint32{1933208214, 489999205, 2702332538, 1647091012, 3030019213, 923314482, 3399132618},
				PC:  4683170,
				SR:  1543,
				USP: 8188928,
				SSP: 8502256,
				RAM: [][2]uint32{{4683166, 68}, {4683167, 240}, {4683168, 233}, {4683169, 18}, {4683170, 89}, {4683171, 44}, {13963378, 128}, {13963379, 225}, {4683172, 12}, {4683173, 210}},
			},
			want: 			cpuState{
				D:   [8]uint32{2902428008, 2798275389, 3237412113, 2197184125, 2422438785, 3446951675, 1763837304, 1015137101},
				A:   [7]uint32{1933208214, 489999205, 2702332538, 1647091012, 3030019213, 923314482, 3399132618},
				PC:  4683174,
				SR:  1537,
				USP: 8188928,
				SSP: 8502256,
				RAM: [][2]uint32{{4683166, 68}, {4683167, 240}, {4683168, 233}, {4683169, 18}, {4683170, 89}, {4683171, 44}, {13963378, 128}, {13963379, 225}, {4683172, 12}, {4683173, 210}},
				Cycles: 22,
			},
		},
		{
			name: "807 MOVEtoCCR (d16, A0) 44e8",
			init: 			cpuState{
				D:   [8]uint32{4292199132, 1335968711, 3255145026, 2707103331, 1646916500, 2429746487, 3943819844, 1444250389},
				A:   [7]uint32{1198532613, 3024239647, 1567935159, 1194004690, 1146385739, 3156011698, 3978481968},
				PC:  4895282,
				SR:  773,
				USP: 1460296,
				SSP: 5609830,
				RAM: [][2]uint32{{4895278, 68}, {4895279, 232}, {4895280, 45}, {4895281, 103}, {4895282, 98}, {4895283, 176}, {7361900, 169}, {7361901, 146}, {4895284, 198}, {4895285, 82}},
			},
			want: 			cpuState{
				D:   [8]uint32{4292199132, 1335968711, 3255145026, 2707103331, 1646916500, 2429746487, 3943819844, 1444250389},
				A:   [7]uint32{1198532613, 3024239647, 1567935159, 1194004690, 1146385739, 3156011698, 3978481968},
				PC:  4895286,
				SR:  786,
				USP: 1460296,
				SSP: 5609830,
				RAM: [][2]uint32{{4895278, 68}, {4895279, 232}, {4895280, 45}, {4895281, 103}, {4895282, 98}, {4895283, 176}, {7361900, 169}, {7361901, 146}, {4895284, 198}, {4895285, 82}},
				Cycles: 20,
			},
		},
		{
			name: "1092 MOVEtoCCR -(A1) 44e1",
			init: 			cpuState{
				D:   [8]uint32{1084721549, 1024059008, 2024103052, 3867202609, 3605125254, 348222563, 1317787087, 29085344},
				A:   [7]uint32{1689328313, 1532880242, 3057060110, 3826578882, 2314720665, 1324455240, 1540240190},
				PC:  431896,
				SR:  8967,
				USP: 1078612,
				SSP: 10753814,
				RAM: [][2]uint32{{431892, 68}, {431893, 225}, {431894, 96}, {431895, 70}, {6153584, 49}, {6153585, 202}, {431896, 233}, {431897, 59}},
			},
			want: 			cpuState{
				D:   [8]uint32{1084721549, 1024059008, 2024103052, 3867202609, 3605125254, 348222563, 1317787087, 29085344},
				A:   [7]uint32{1689328313, 1532880240, 3057060110, 3826578882, 2314720665, 1324455240, 1540240190},
				PC:  431898,
				SR:  8970,
				USP: 1078612,
				SSP: 10753814,
				RAM: [][2]uint32{{431892, 68}, {431893, 225}, {431894, 96}, {431895, 70}, {6153584, 49}, {6153585, 202}, {431896, 233}, {431897, 59}},
				Cycles: 18,
			},
		},
		{
			name: "1373 MOVEtoCCR D4 44c4",
			init: 			cpuState{
				D:   [8]uint32{3576407759, 2272233818, 3916429822, 3849296973, 3697975332, 688206147, 2074158243, 3666476187},
				A:   [7]uint32{1864376362, 3821118127, 363213558, 160094834, 46831767, 2343550516, 4196556851},
				PC:  8919238,
				SR:  8194,
				USP: 16125142,
				SSP: 15265458,
				RAM: [][2]uint32{{8919234, 68}, {8919235, 196}, {8919236, 210}, {8919237, 240}, {8919238, 16}, {8919239, 56}},
			},
			want: 			cpuState{
				D:   [8]uint32{3576407759, 2272233818, 3916429822, 3849296973, 3697975332, 688206147, 2074158243, 3666476187},
				A:   [7]uint32{1864376362, 3821118127, 363213558, 160094834, 46831767, 2343550516, 4196556851},
				PC:  8919240,
				SR:  8196,
				USP: 16125142,
				SSP: 15265458,
				RAM: [][2]uint32{{8919234, 68}, {8919235, 196}, {8919236, 210}, {8919237, 240}, {8919238, 16}, {8919239, 56}},
				Cycles: 12,
			},
		},
		{
			name: "1641 MOVEtoCCR (A6)+ 44de",
			init: 			cpuState{
				D:   [8]uint32{1145866199, 1436784565, 3079493394, 3651082748, 852686789, 1519752189, 743144757, 1312661913},
				A:   [7]uint32{3015228787, 108415392, 1161065062, 2327915877, 2910243609, 3707234863, 1002548962},
				PC:  1772692,
				SR:  1544,
				USP: 11179222,
				SSP: 6831230,
				RAM: [][2]uint32{{1772688, 68}, {1772689, 222}, {1772690, 12}, {1772691, 68}, {12693218, 131}, {12693219, 207}, {1772692, 179}, {1772693, 246}},
			},
			want: 			cpuState{
				D:   [8]uint32{1145866199, 1436784565, 3079493394, 3651082748, 852686789, 1519752189, 743144757, 1312661913},
				A:   [7]uint32{3015228787, 108415392, 1161065062, 2327915877, 2910243609, 3707234863, 1002548964},
				PC:  1772694,
				SR:  1551,
				USP: 11179222,
				SSP: 6831230,
				RAM: [][2]uint32{{1772688, 68}, {1772689, 222}, {1772690, 12}, {1772691, 68}, {12693218, 131}, {12693219, 207}, {1772692, 179}, {1772693, 246}},
				Cycles: 16,
			},
		},
		{
			name: "1943 MOVEtoCCR D2 44c2",
			init: 			cpuState{
				D:   [8]uint32{696807312, 1382088265, 578359649, 2213977547, 2954782093, 1385865288, 2772005070, 2178565918},
				A:   [7]uint32{1703276513, 1656131587, 2528671145, 3507428062, 2559635184, 2657275901, 681829431},
				PC:  5984558,
				SR:  9477,
				USP: 4768304,
				SSP: 5678070,
				RAM: [][2]uint32{{5984554, 68}, {5984555, 194}, {5984556, 19}, {5984557, 249}, {5984558, 40}, {5984559, 249}},
			},
			want: 			cpuState{
				D:   [8]uint32{696807312, 1382088265, 578359649, 2213977547, 2954782093, 1385865288, 2772005070, 2178565918},
				A:   [7]uint32{1703276513, 1656131587, 2528671145, 3507428062, 2559635184, 2657275901, 681829431},
				PC:  5984560,
				SR:  9473,
				USP: 4768304,
				SSP: 5678070,
				RAM: [][2]uint32{{5984554, 68}, {5984555, 194}, {5984556, 19}, {5984557, 249}, {5984558, 40}, {5984559, 249}},
				Cycles: 12,
			},
		},
		{
			name: "2181 MOVEtoCCR (A5) 44d5",
			init: 			cpuState{
				D:   [8]uint32{1340339179, 1080459055, 537707077, 1641335938, 194398625, 2981643959, 3350607306, 3377463920},
				A:   [7]uint32{3077951010, 3081045686, 1489305959, 1935304412, 441013592, 4144692082, 874165937},
				PC:  3053762,
				SR:  8216,
				USP: 3232604,
				SSP: 257626,
				RAM: [][2]uint32{{3053758, 68}, {3053759, 213}, {3053760, 88}, {3053761, 222}, {719730, 244}, {719731, 3}, {3053762, 213}, {3053763, 109}},
			},
			want: 			cpuState{
				D:   [8]uint32{1340339179, 1080459055, 537707077, 1641335938, 194398625, 2981643959, 3350607306, 3377463920},
				A:   [7]uint32{3077951010, 3081045686, 1489305959, 1935304412, 441013592, 4144692082, 874165937},
				PC:  3053764,
				SR:  8195,
				USP: 3232604,
				SSP: 257626,
				RAM: [][2]uint32{{3053758, 68}, {3053759, 213}, {3053760, 88}, {3053761, 222}, {719730, 244}, {719731, 3}, {3053762, 213}, {3053763, 109}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEtoSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEtoSR (A4) 46d4",
			init: cpuState{
				D:   [8]uint32{211823858, 143714222, 3296759660, 2630777996, 2230986041, 2148579648, 1986958079, 1386104649},
				A:   [7]uint32{3329473789, 3895785386, 531857046, 3126950053, 1236592031, 1020035923, 3169828815},
				PC:  7693556,
				SR:  528,
				USP: 2855122,
				SSP: 12941094,
				RAM: [][2]uint32{{7693552, 70}, {7693553, 212}, {7693554, 60}, {7693555, 42}, {32, 214}, {33, 76}, {34, 53}, {35, 204}, {4994508, 141}, {4994509, 140}, {4994510, 186}, {4994511, 47}},
			},
			want: cpuState{
				D:   [8]uint32{211823858, 143714222, 3296759660, 2630777996, 2230986041, 2148579648, 1986958079, 1386104649},
				A:   [7]uint32{3329473789, 3895785386, 531857046, 3126950053, 1236592031, 1020035923, 3169828815},
				PC:  3595318736,
				SR:  8720,
				USP: 2855122,
				SSP: 12941088,
				RAM: [][2]uint32{{7693552, 70}, {7693553, 212}, {7693554, 60}, {7693555, 42}, {12941092, 100}, {12941093, 240}, {12941088, 2}, {12941089, 16}, {12941090, 0}, {12941091, 117}, {32, 214}, {33, 76}, {34, 53}, {35, 204}, {4994508, 141}, {4994509, 140}, {4994510, 186}, {4994511, 47}},
				Cycles: 34,
			},
		},
		{
			name: "500 MOVEtoSR -(A5) 46e5",
			init: cpuState{
				D:   [8]uint32{2185921795, 3034907988, 1924980292, 490022128, 599066172, 4099736981, 1281249388, 4054340185},
				A:   [7]uint32{1196549866, 2317138228, 4132388699, 352694448, 3567992490, 1838020895, 411824783},
				PC:  7862148,
				SR:  33031,
				USP: 6229460,
				SSP: 7536744,
				RAM: [][2]uint32{{7862144, 70}, {7862145, 229}, {7862146, 85}, {7862147, 161}, {32, 227}, {33, 68}, {34, 84}, {35, 10}, {4477962, 56}, {4477963, 165}, {4477964, 143}, {4477965, 174}},
			},
			want: cpuState{
				D:   [8]uint32{2185921795, 3034907988, 1924980292, 490022128, 599066172, 4099736981, 1281249388, 4054340185},
				A:   [7]uint32{1196549866, 2317138228, 4132388699, 352694448, 3567992490, 1838020895, 411824783},
				PC:  3812905998,
				SR:  8455,
				USP: 6229460,
				SSP: 7536738,
				RAM: [][2]uint32{{7862144, 70}, {7862145, 229}, {7862146, 85}, {7862147, 161}, {7536742, 247}, {7536743, 128}, {7536738, 129}, {7536739, 7}, {7536740, 0}, {7536741, 119}, {32, 227}, {33, 68}, {34, 84}, {35, 10}, {4477962, 56}, {4477963, 165}, {4477964, 143}, {4477965, 174}},
				Cycles: 34,
			},
		},
		{
			name: "1000 MOVEtoSR (d8, A5, Xn) 46f5",
			init: cpuState{
				D:   [8]uint32{3952314096, 788468355, 1030333420, 1023986158, 2957870970, 1946342889, 983517413, 2227907290},
				A:   [7]uint32{2584369980, 33206410, 994513456, 1188759060, 1450973416, 3848480019, 3052829127},
				PC:  7977928,
				SR:  42001,
				USP: 15643716,
				SSP: 5421678,
				RAM: [][2]uint32{{7977924, 70}, {7977925, 245}, {7977926, 177}, {7977927, 32}, {7977928, 24}, {7977929, 249}, {12, 6}, {13, 126}, {14, 123}, {15, 244}, {8289268, 16}, {8289269, 179}, {8289270, 180}, {8289271, 141}},
			},
			want: cpuState{
				D:      [8]uint32{3952314096, 788468355, 1030333420, 1023986158, 2957870970, 1946342889, 983517413, 2227907290},
				A:      [7]uint32{2584369980, 33206410, 994513456, 1188759060, 1450973416, 3848480019, 3052829127},
				PC:     108952568,
				SR:     9233,
				USP:    15643716,
				SSP:    5421664,
				RAM:    [][2]uint32{{7977924, 70}, {7977925, 245}, {7977926, 177}, {7977927, 32}, {7977928, 24}, {7977929, 249}, {5421676, 187}, {5421677, 198}, {5421672, 164}, {5421673, 17}, {5421674, 0}, {5421675, 121}, {5421670, 70}, {5421671, 245}, {5421668, 43}, {5421669, 71}, {5421664, 70}, {5421665, 245}, {5421666, 229}, {5421667, 99}, {12, 6}, {13, 126}, {14, 123}, {15, 244}, {8289268, 16}, {8289269, 179}, {8289270, 180}, {8289271, 141}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVEtoSR (d16, A7) 46ef",
			init: cpuState{
				D:   [8]uint32{1395318051, 1781170151, 988621212, 1040148351, 447376275, 515558757, 2832254203, 477483571},
				A:   [7]uint32{3283532092, 2352982042, 580168180, 2088823459, 3479490460, 3884130311, 2135641708},
				PC:  12130878,
				SR:  42758,
				USP: 12966034,
				SSP: 1032888,
				RAM: [][2]uint32{{12130874, 70}, {12130875, 239}, {12130876, 236}, {12130877, 175}, {12130878, 13}, {12130879, 252}, {12, 214}, {13, 138}, {14, 220}, {15, 194}, {9100482, 113}, {9100483, 14}, {9100484, 173}, {9100485, 220}},
			},
			want: cpuState{
				D:      [8]uint32{1395318051, 1781170151, 988621212, 1040148351, 447376275, 515558757, 2832254203, 477483571},
				A:      [7]uint32{3283532092, 2352982042, 580168180, 2088823459, 3479490460, 3884130311, 2135641708},
				PC:     3599424710,
				SR:     9990,
				USP:    12966034,
				SSP:    1032874,
				RAM:    [][2]uint32{{12130874, 70}, {12130875, 239}, {12130876, 236}, {12130877, 175}, {12130878, 13}, {12130879, 252}, {1032886, 26}, {1032887, 60}, {1032882, 167}, {1032883, 6}, {1032884, 0}, {1032885, 185}, {1032880, 70}, {1032881, 239}, {1032878, 175}, {1032879, 103}, {1032874, 70}, {1032875, 245}, {1032876, 0}, {1032877, 15}, {12, 214}, {13, 138}, {14, 220}, {15, 194}, {9100482, 113}, {9100483, 14}, {9100484, 173}, {9100485, 220}},
				Halted: true,
			},
		},
		{
			name: "2000 MOVEtoSR (d16, PC) 46fa",
			init: cpuState{
				D:   [8]uint32{2291184308, 2799811410, 257168639, 2266209033, 3779806961, 4261602911, 1424412806, 3966576518},
				A:   [7]uint32{517026946, 3161917534, 3116170840, 2531344535, 3965768398, 2126172432, 1089404355},
				PC:  9302354,
				SR:  530,
				USP: 15174282,
				SSP: 11083894,
				RAM: [][2]uint32{{9302350, 70}, {9302351, 250}, {9302352, 245}, {9302353, 222}, {32, 96}, {33, 242}, {34, 232}, {35, 60}, {15919164, 67}, {15919165, 194}, {15919166, 171}, {15919167, 122}},
			},
			want: cpuState{
				D:   [8]uint32{2291184308, 2799811410, 257168639, 2266209033, 3779806961, 4261602911, 1424412806, 3966576518},
				A:   [7]uint32{517026946, 3161917534, 3116170840, 2531344535, 3965768398, 2126172432, 1089404355},
				PC:  1626531904,
				SR:  8722,
				USP: 15174282,
				SSP: 11083888,
				RAM: [][2]uint32{{9302350, 70}, {9302351, 250}, {9302352, 245}, {9302353, 222}, {11083892, 241}, {11083893, 78}, {11083888, 2}, {11083889, 18}, {11083890, 0}, {11083891, 141}, {32, 96}, {33, 242}, {34, 232}, {35, 60}, {15919164, 67}, {15919165, 194}, {15919166, 171}, {15919167, 122}},
				Cycles: 34,
			},
		},
		{
			name: "001 MOVEtoSR (d16, A2) 46ea",
			init: 			cpuState{
				D:   [8]uint32{3500561826, 662025718, 3192525500, 486309793, 2457660888, 538253165, 2244332029, 868561912},
				A:   [7]uint32{2227734054, 3668847140, 824330718, 4055884001, 2056046395, 704783755, 3608638171},
				PC:  6522212,
				SR:  4,
				USP: 5486890,
				SSP: 1876508,
				RAM: [][2]uint32{{6522208, 70}, {6522209, 234}, {6522210, 117}, {6522211, 196}, {32, 218}, {33, 52}, {34, 0}, {35, 222}, {3408094, 22}, {3408095, 179}, {3408096, 160}, {3408097, 170}},
			},
			want: 			cpuState{
				D:   [8]uint32{3500561826, 662025718, 3192525500, 486309793, 2457660888, 538253165, 2244332029, 868561912},
				A:   [7]uint32{2227734054, 3668847140, 824330718, 4055884001, 2056046395, 704783755, 3608638171},
				PC:  3660841186,
				SR:  8196,
				USP: 5486890,
				SSP: 1876502,
				RAM: [][2]uint32{{6522208, 70}, {6522209, 234}, {6522210, 117}, {6522211, 196}, {1876506, 133}, {1876507, 96}, {1876502, 0}, {1876503, 4}, {1876504, 0}, {1876505, 99}, {32, 218}, {33, 52}, {34, 0}, {35, 222}, {3408094, 22}, {3408095, 179}, {3408096, 160}, {3408097, 170}},
				Cycles: 34,
			},
		},
		{
			name: "282 MOVEtoSR (A6)+ 46de",
			init: 			cpuState{
				D:   [8]uint32{3166864925, 1253677699, 3143747592, 3537176413, 3800495718, 1595031609, 3714864728, 227676755},
				A:   [7]uint32{1098199353, 3618652440, 2342915724, 165722479, 37134984, 2501677883, 1018889909},
				PC:  10882390,
				SR:  1028,
				USP: 5021240,
				SSP: 5703600,
				RAM: [][2]uint32{{10882386, 70}, {10882387, 222}, {10882388, 255}, {10882389, 31}, {32, 18}, {33, 42}, {34, 65}, {35, 212}, {2769364, 60}, {2769365, 88}, {2769366, 89}, {2769367, 52}},
			},
			want: 			cpuState{
				D:   [8]uint32{3166864925, 1253677699, 3143747592, 3537176413, 3800495718, 1595031609, 3714864728, 227676755},
				A:   [7]uint32{1098199353, 3618652440, 2342915724, 165722479, 37134984, 2501677883, 1018889909},
				PC:  304759256,
				SR:  9220,
				USP: 5021240,
				SSP: 5703594,
				RAM: [][2]uint32{{10882386, 70}, {10882387, 222}, {10882388, 255}, {10882389, 31}, {5703598, 13}, {5703599, 82}, {5703594, 4}, {5703595, 4}, {5703596, 0}, {5703597, 166}, {32, 18}, {33, 42}, {34, 65}, {35, 212}, {2769364, 60}, {2769365, 88}, {2769366, 89}, {2769367, 52}},
				Cycles: 34,
			},
		},
		{
			name: "523 MOVEtoSR (d8, A4, Xn) 46f4",
			init: 			cpuState{
				D:   [8]uint32{4209591651, 2190129660, 1455796241, 931412177, 3102309191, 153047384, 3191548090, 867775200},
				A:   [7]uint32{3100190987, 31054046, 1233334031, 3650979025, 888572931, 571696486, 1593225954},
				PC:  15696072,
				SR:  10004,
				USP: 16676378,
				SSP: 7446602,
				RAM: [][2]uint32{{15696068, 70}, {15696069, 244}, {15696070, 15}, {15696071, 46}, {15696072, 19}, {15696073, 220}, {14668180, 46}, {14668181, 225}, {15696074, 6}, {15696075, 171}},
			},
			want: 			cpuState{
				D:   [8]uint32{4209591651, 2190129660, 1455796241, 931412177, 3102309191, 153047384, 3191548090, 867775200},
				A:   [7]uint32{3100190987, 31054046, 1233334031, 3650979025, 888572931, 571696486, 1593225954},
				PC:  15696076,
				SR:  9729,
				USP: 16676378,
				SSP: 7446602,
				RAM: [][2]uint32{{15696068, 70}, {15696069, 244}, {15696070, 15}, {15696071, 46}, {15696072, 19}, {15696073, 220}, {14668180, 46}, {14668181, 225}, {15696074, 6}, {15696075, 171}},
				Cycles: 22,
			},
		},
		{
			name: "825 MOVEtoSR -(A6) 46e6",
			init: 			cpuState{
				D:   [8]uint32{648159774, 827418940, 4090527235, 3893281977, 1023140310, 2762050980, 3443212486, 3886088732},
				A:   [7]uint32{1687911471, 2099121518, 3186420194, 2467708173, 547130564, 1637762720, 28217255},
				PC:  2182736,
				SR:  1554,
				USP: 1865090,
				SSP: 4471714,
				RAM: [][2]uint32{{2182732, 70}, {2182733, 230}, {2182734, 106}, {2182735, 110}, {32, 251}, {33, 204}, {34, 1}, {35, 214}, {13369814, 155}, {13369815, 253}, {13369816, 59}, {13369817, 190}},
			},
			want: 			cpuState{
				D:   [8]uint32{648159774, 827418940, 4090527235, 3893281977, 1023140310, 2762050980, 3443212486, 3886088732},
				A:   [7]uint32{1687911471, 2099121518, 3186420194, 2467708173, 547130564, 1637762720, 28217255},
				PC:  4224451034,
				SR:  9746,
				USP: 1865090,
				SSP: 4471708,
				RAM: [][2]uint32{{2182732, 70}, {2182733, 230}, {2182734, 106}, {2182735, 110}, {4471712, 78}, {4471713, 76}, {4471708, 6}, {4471709, 18}, {4471710, 0}, {4471711, 33}, {32, 251}, {33, 204}, {34, 1}, {35, 214}, {13369814, 155}, {13369815, 253}, {13369816, 59}, {13369817, 190}},
				Cycles: 34,
			},
		},
		{
			name: "1095 MOVEtoSR D0 46c0",
			init: 			cpuState{
				D:   [8]uint32{1735685815, 290447196, 3460608564, 102498460, 1423353135, 958101411, 1263407226, 1240420677},
				A:   [7]uint32{3177790993, 1602729542, 3455335190, 2631729902, 2989611590, 634166169, 593119638},
				PC:  14012152,
				SR:  266,
				USP: 12407220,
				SSP: 4172198,
				RAM: [][2]uint32{{14012148, 70}, {14012149, 192}, {14012150, 145}, {14012151, 99}, {32, 202}, {33, 192}, {34, 212}, {35, 180}, {12637364, 66}, {12637365, 58}, {12637366, 188}, {12637367, 215}},
			},
			want: 			cpuState{
				D:   [8]uint32{1735685815, 290447196, 3460608564, 102498460, 1423353135, 958101411, 1263407226, 1240420677},
				A:   [7]uint32{3177790993, 1602729542, 3455335190, 2631729902, 2989611590, 634166169, 593119638},
				PC:  3401635000,
				SR:  8458,
				USP: 12407220,
				SSP: 4172192,
				RAM: [][2]uint32{{14012148, 70}, {14012149, 192}, {14012150, 145}, {14012151, 99}, {4172196, 206}, {4172197, 244}, {4172192, 1}, {4172193, 10}, {4172194, 0}, {4172195, 213}, {32, 202}, {33, 192}, {34, 212}, {35, 180}, {12637364, 66}, {12637365, 58}, {12637366, 188}, {12637367, 215}},
				Cycles: 34,
			},
		},
		{
			name: "1381 MOVEtoSR -(A1) 46e1",
			init: 			cpuState{
				D:   [8]uint32{3821886911, 2347854020, 3601472991, 3527348759, 3846310585, 2357669856, 2781174568, 3819979404},
				A:   [7]uint32{3602077871, 4132149496, 4061899732, 359295599, 1270082131, 1131540306, 1359802116},
				PC:  7519224,
				SR:  10004,
				USP: 13324850,
				SSP: 11103208,
				RAM: [][2]uint32{{7519220, 70}, {7519221, 225}, {7519222, 227}, {7519223, 219}, {4954358, 212}, {4954359, 88}, {7519224, 240}, {7519225, 142}},
			},
			want: 			cpuState{
				D:   [8]uint32{3821886911, 2347854020, 3601472991, 3527348759, 3846310585, 2357669856, 2781174568, 3819979404},
				A:   [7]uint32{3602077871, 4132149494, 4061899732, 359295599, 1270082131, 1131540306, 1359802116},
				PC:  7519226,
				SR:  33816,
				USP: 13324850,
				SSP: 11103208,
				RAM: [][2]uint32{{7519220, 70}, {7519221, 225}, {7519222, 227}, {7519223, 219}, {4954358, 212}, {4954359, 88}, {7519224, 240}, {7519225, 142}},
				Cycles: 18,
			},
		},
		{
			name: "1683 MOVEtoSR -(A3) 46e3",
			init: 			cpuState{
				D:   [8]uint32{273545020, 1106440803, 3039163786, 4053314493, 3377283545, 3420901133, 2228188709, 991894155},
				A:   [7]uint32{2424843946, 2163432609, 2328449297, 1360652918, 1079400614, 3142953307, 4207684748},
				PC:  2845584,
				SR:  9474,
				USP: 485460,
				SSP: 9756620,
				RAM: [][2]uint32{{2845580, 70}, {2845581, 227}, {2845582, 119}, {2845583, 8}, {1698420, 209}, {1698421, 252}, {2845584, 6}, {2845585, 102}},
			},
			want: 			cpuState{
				D:   [8]uint32{273545020, 1106440803, 3039163786, 4053314493, 3377283545, 3420901133, 2228188709, 991894155},
				A:   [7]uint32{2424843946, 2163432609, 2328449297, 1360652916, 1079400614, 3142953307, 4207684748},
				PC:  2845586,
				SR:  33052,
				USP: 485460,
				SSP: 9756620,
				RAM: [][2]uint32{{2845580, 70}, {2845581, 227}, {2845582, 119}, {2845583, 8}, {1698420, 209}, {1698421, 252}, {2845584, 6}, {2845585, 102}},
				Cycles: 18,
			},
		},
		{
			name: "1964 MOVEtoSR (d16, PC) 46fa",
			init: 			cpuState{
				D:   [8]uint32{1999954051, 2549474351, 1672079100, 3475302950, 1763309016, 3802939835, 3788633274, 654282403},
				A:   [7]uint32{3124579117, 2962306334, 3142962314, 3847793190, 1824060815, 1471676577, 4235140002},
				PC:  13691006,
				SR:  257,
				USP: 10758706,
				SSP: 3899872,
				RAM: [][2]uint32{{13691002, 70}, {13691003, 250}, {13691004, 180}, {13691005, 91}, {32, 185}, {33, 206}, {34, 206}, {35, 158}, {13553310, 0}, {13553311, 207}, {13553312, 96}, {13553313, 133}},
			},
			want: 			cpuState{
				D:   [8]uint32{1999954051, 2549474351, 1672079100, 3475302950, 1763309016, 3802939835, 3788633274, 654282403},
				A:   [7]uint32{3124579117, 2962306334, 3142962314, 3847793190, 1824060815, 1471676577, 4235140002},
				PC:  3117338274,
				SR:  8449,
				USP: 10758706,
				SSP: 3899866,
				RAM: [][2]uint32{{13691002, 70}, {13691003, 250}, {13691004, 180}, {13691005, 91}, {3899870, 232}, {3899871, 122}, {3899866, 1}, {3899867, 1}, {3899868, 0}, {3899869, 208}, {32, 185}, {33, 206}, {34, 206}, {35, 158}, {13553310, 0}, {13553311, 207}, {13553312, 96}, {13553313, 133}},
				Cycles: 34,
			},
		},
		{
			name: "2246 MOVEtoSR (A7) 46d7",
			init: 			cpuState{
				D:   [8]uint32{3248722031, 325257908, 44602592, 4024318932, 782492242, 2862787251, 2109598014, 3617219695},
				A:   [7]uint32{87561173, 2228718368, 819797043, 914097740, 1790453685, 892159160, 4035883057},
				PC:  10308060,
				SR:  1298,
				USP: 14927040,
				SSP: 11746120,
				RAM: [][2]uint32{{10308056, 70}, {10308057, 215}, {10308058, 158}, {10308059, 109}, {32, 213}, {33, 10}, {34, 175}, {35, 246}, {700406, 106}, {700407, 149}, {700408, 220}, {700409, 45}},
			},
			want: 			cpuState{
				D:   [8]uint32{3248722031, 325257908, 44602592, 4024318932, 782492242, 2862787251, 2109598014, 3617219695},
				A:   [7]uint32{87561173, 2228718368, 819797043, 914097740, 1790453685, 892159160, 4035883057},
				PC:  3574247418,
				SR:  9490,
				USP: 14927040,
				SSP: 11746114,
				RAM: [][2]uint32{{10308056, 70}, {10308057, 215}, {10308058, 158}, {10308059, 109}, {11746118, 73}, {11746119, 216}, {11746114, 5}, {11746115, 18}, {11746116, 0}, {11746117, 157}, {32, 213}, {33, 10}, {34, 175}, {35, 246}, {700406, 106}, {700407, 149}, {700408, 220}, {700409, 45}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEfromSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEfromSR -(A6) 40e6",
			init: cpuState{
				D:   [8]uint32{1539487470, 88414920, 3761114870, 1442749669, 1076942791, 2275119325, 263127465, 1787787047},
				A:   [7]uint32{2373554379, 3120242247, 3654480073, 195491783, 2461167633, 3346612883, 2917650809},
				PC:  919442,
				SR:  33803,
				USP: 15951390,
				SSP: 9033344,
				RAM: [][2]uint32{{919438, 64}, {919439, 230}, {919440, 92}, {919441, 208}, {12, 39}, {13, 242}, {14, 64}, {15, 232}, {15876328, 220}, {15876329, 4}, {15876330, 210}, {15876331, 136}},
			},
			want: cpuState{
				D:      [8]uint32{1539487470, 88414920, 3761114870, 1442749669, 1076942791, 2275119325, 263127465, 1787787047},
				A:      [7]uint32{2373554379, 3120242247, 3654480073, 195491783, 2461167633, 3346612883, 2917650807},
				PC:     670187756,
				SR:     9227,
				USP:    15951390,
				SSP:    9033330,
				RAM:    [][2]uint32{{919438, 64}, {919439, 230}, {919440, 92}, {919441, 208}, {9033342, 7}, {9033343, 146}, {9033338, 132}, {9033339, 11}, {9033340, 0}, {9033341, 14}, {9033336, 64}, {9033337, 230}, {9033334, 209}, {9033335, 119}, {9033330, 64}, {9033331, 241}, {9033332, 173}, {9033333, 231}, {12, 39}, {13, 242}, {14, 64}, {15, 232}, {15876328, 220}, {15876329, 4}, {15876330, 210}, {15876331, 136}},
				Halted: true,
			},
		},
		{
			name: "500 MOVEfromSR (d8, A6, Xn) 40f6",
			init: cpuState{
				D:   [8]uint32{1980334010, 3167605853, 310030401, 1553449489, 436945333, 718770126, 119453367, 2523342529},
				A:   [7]uint32{1831867579, 2198748582, 2913131245, 3718313342, 3609801955, 37363688, 1293960239},
				PC:  15657772,
				SR:  34311,
				USP: 2572960,
				SSP: 7161372,
				RAM: [][2]uint32{{15657768, 64}, {15657769, 246}, {15657770, 71}, {15657771, 169}, {15657772, 159}, {15657773, 228}, {12, 108}, {13, 84}, {14, 65}, {15, 84}, {5521748, 22}, {5521749, 194}, {5521750, 182}, {5521751, 62}},
			},
			want: cpuState{
				D:      [8]uint32{1980334010, 3167605853, 310030401, 1553449489, 436945333, 718770126, 119453367, 2523342529},
				A:      [7]uint32{1831867579, 2198748582, 2913131245, 3718313342, 3609801955, 37363688, 1293960239},
				PC:     1817461080,
				SR:     9735,
				USP:    2572960,
				SSP:    7161358,
				RAM:    [][2]uint32{{15657768, 64}, {15657769, 246}, {15657770, 71}, {15657771, 169}, {15657772, 159}, {15657773, 228}, {7161370, 235}, {7161371, 42}, {7161366, 134}, {7161367, 7}, {7161368, 0}, {7161369, 238}, {7161364, 64}, {7161365, 246}, {7161362, 133}, {7161363, 141}, {7161358, 64}, {7161359, 241}, {7161360, 77}, {7161361, 32}, {12, 108}, {13, 84}, {14, 65}, {15, 84}, {5521748, 22}, {5521749, 194}, {5521750, 182}, {5521751, 62}},
				Halted: true,
			},
		},
		{
			name: "1000 MOVEfromSR (A2) 40d2",
			init: cpuState{
				D:   [8]uint32{98469251, 473840520, 3879971513, 4166988453, 362607423, 58945386, 688833156, 1167423996},
				A:   [7]uint32{834608744, 942064560, 427940119, 4134744377, 1186207509, 2401505492, 3586707323},
				PC:  11265760,
				SR:  33549,
				USP: 11514810,
				SSP: 8831470,
				RAM: [][2]uint32{{11265756, 64}, {11265757, 210}, {11265758, 240}, {11265759, 139}, {12, 186}, {13, 210}, {14, 9}, {15, 210}, {13765074, 241}, {13765075, 121}, {13765076, 125}, {13765077, 83}},
			},
			want: cpuState{
				D:      [8]uint32{98469251, 473840520, 3879971513, 4166988453, 362607423, 58945386, 688833156, 1167423996},
				A:      [7]uint32{834608744, 942064560, 427940119, 4134744377, 1186207509, 2401505492, 3586707323},
				PC:     3134327254,
				SR:     8973,
				USP:    11514810,
				SSP:    8831456,
				RAM:    [][2]uint32{{11265756, 64}, {11265757, 210}, {11265758, 240}, {11265759, 139}, {8831468, 230}, {8831469, 222}, {8831464, 131}, {8831465, 13}, {8831466, 0}, {8831467, 171}, {8831462, 64}, {8831463, 210}, {8831460, 217}, {8831461, 23}, {8831456, 64}, {8831457, 209}, {8831458, 25}, {8831459, 129}, {12, 186}, {13, 210}, {14, 9}, {15, 210}, {13765074, 241}, {13765075, 121}, {13765076, 125}, {13765077, 83}},
				Halted: true,
			},
		},
		{
			name: "1500 MOVEfromSR (d8, A0, Xn) 40f0",
			init: cpuState{
				D:   [8]uint32{3046772129, 1389579770, 1087990752, 3305219991, 828447682, 2444772200, 3935847689, 3084679514},
				A:   [7]uint32{3179139866, 542934256, 1857311351, 2363547443, 778896843, 4024116766, 1851445596},
				PC:  15568202,
				SR:  9218,
				USP: 5790386,
				SSP: 1332810,
				RAM: [][2]uint32{{15568198, 64}, {15568199, 240}, {15568200, 160}, {15568201, 219}, {15568202, 83}, {15568203, 93}, {8267116, 223}, {8267117, 126}, {15568204, 100}, {15568205, 76}},
			},
			want: cpuState{
				D:   [8]uint32{3046772129, 1389579770, 1087990752, 3305219991, 828447682, 2444772200, 3935847689, 3084679514},
				A:   [7]uint32{3179139866, 542934256, 1857311351, 2363547443, 778896843, 4024116766, 1851445596},
				PC:  15568206,
				SR:  9218,
				USP: 5790386,
				SSP: 1332810,
				RAM: [][2]uint32{{15568198, 64}, {15568199, 240}, {15568200, 160}, {15568201, 219}, {15568202, 83}, {15568203, 93}, {8267116, 36}, {8267117, 2}, {15568204, 100}, {15568205, 76}},
				Cycles: 18,
			},
		},
		{
			name: "2000 MOVEfromSR (A6) 40d6",
			init: cpuState{
				D:   [8]uint32{941711418, 1083543694, 290919008, 1479329756, 3282090353, 3345666486, 975061923, 1958797117},
				A:   [7]uint32{3171876673, 367244463, 1683808489, 2356136594, 2978114804, 119352526, 2320065517},
				PC:  6024900,
				SR:  771,
				USP: 7838578,
				SSP: 5290344,
				RAM: [][2]uint32{{6024896, 64}, {6024897, 214}, {6024898, 184}, {6024899, 182}, {12, 105}, {13, 36}, {14, 101}, {15, 194}, {2385346, 118}, {2385347, 132}, {2385348, 34}, {2385349, 59}},
			},
			want: cpuState{
				D:      [8]uint32{941711418, 1083543694, 290919008, 1479329756, 3282090353, 3345666486, 975061923, 1958797117},
				A:      [7]uint32{3171876673, 367244463, 1683808489, 2356136594, 2978114804, 119352526, 2320065517},
				PC:     1763993030,
				SR:     8963,
				USP:    7838578,
				SSP:    5290330,
				RAM:    [][2]uint32{{6024896, 64}, {6024897, 214}, {6024898, 184}, {6024899, 182}, {5290342, 238}, {5290343, 194}, {5290338, 3}, {5290339, 3}, {5290340, 0}, {5290341, 91}, {5290336, 64}, {5290337, 214}, {5290334, 99}, {5290335, 237}, {5290330, 64}, {5290331, 209}, {5290332, 138}, {5290333, 73}, {12, 105}, {13, 36}, {14, 101}, {15, 194}, {2385346, 118}, {2385347, 132}, {2385348, 34}, {2385349, 59}},
				Halted: true,
			},
		},
		{
			name: "001 MOVEfromSR (A6)+ 40de",
			init: 			cpuState{
				D:   [8]uint32{3452256979, 506156139, 2181983742, 4178245195, 2958894208, 2973521428, 1960845161, 1079181229},
				A:   [7]uint32{3151518575, 2813940309, 2863939364, 939455445, 1299116206, 3977621151, 2367811020},
				PC:  14391258,
				SR:  8966,
				USP: 3001320,
				SSP: 871890,
				RAM: [][2]uint32{{14391254, 64}, {14391255, 222}, {14391256, 148}, {14391257, 3}, {2223564, 166}, {2223565, 73}, {14391258, 87}, {14391259, 60}},
			},
			want: 			cpuState{
				D:   [8]uint32{3452256979, 506156139, 2181983742, 4178245195, 2958894208, 2973521428, 1960845161, 1079181229},
				A:   [7]uint32{3151518575, 2813940309, 2863939364, 939455445, 1299116206, 3977621151, 2367811022},
				PC:  14391260,
				SR:  8966,
				USP: 3001320,
				SSP: 871890,
				RAM: [][2]uint32{{14391254, 64}, {14391255, 222}, {14391256, 148}, {14391257, 3}, {2223564, 35}, {2223565, 6}, {14391258, 87}, {14391259, 60}},
				Cycles: 12,
			},
		},
		{
			name: "246 MOVEfromSR (xxx).w 40f8",
			init: 			cpuState{
				D:   [8]uint32{1653225557, 1295036375, 1693020653, 3666182599, 625908925, 3707588958, 2694551831, 3418946819},
				A:   [7]uint32{788002947, 287742997, 2044513776, 3816748006, 1601981902, 2944374440, 1165243092},
				PC:  7825318,
				SR:  1817,
				USP: 7921870,
				SSP: 10545236,
				RAM: [][2]uint32{{7825314, 64}, {7825315, 248}, {7825316, 107}, {7825317, 218}, {7825318, 123}, {7825319, 220}, {27610, 227}, {27611, 254}, {7825320, 193}, {7825321, 95}},
			},
			want: 			cpuState{
				D:   [8]uint32{1653225557, 1295036375, 1693020653, 3666182599, 625908925, 3707588958, 2694551831, 3418946819},
				A:   [7]uint32{788002947, 287742997, 2044513776, 3816748006, 1601981902, 2944374440, 1165243092},
				PC:  7825322,
				SR:  1817,
				USP: 7921870,
				SSP: 10545236,
				RAM: [][2]uint32{{7825314, 64}, {7825315, 248}, {7825316, 107}, {7825317, 218}, {7825318, 123}, {7825319, 220}, {27610, 7}, {27611, 25}, {7825320, 193}, {7825321, 95}},
				Cycles: 16,
			},
		},
		{
			name: "515 MOVEfromSR (d8, A1, Xn) 40f1",
			init: 			cpuState{
				D:   [8]uint32{1328413385, 3091057892, 3184163686, 768124940, 2301060632, 2911426317, 612113730, 3837380877},
				A:   [7]uint32{1140259752, 354153685, 1351746447, 3399676335, 3709596736, 1692788028, 2897685002},
				PC:  12233702,
				SR:  771,
				USP: 1647152,
				SSP: 14594016,
				RAM: [][2]uint32{{12233698, 64}, {12233699, 241}, {12233700, 189}, {12233701, 178}, {12233702, 170}, {12233703, 236}, {12510774, 237}, {12510775, 4}, {12233704, 8}, {12233705, 189}},
			},
			want: 			cpuState{
				D:   [8]uint32{1328413385, 3091057892, 3184163686, 768124940, 2301060632, 2911426317, 612113730, 3837380877},
				A:   [7]uint32{1140259752, 354153685, 1351746447, 3399676335, 3709596736, 1692788028, 2897685002},
				PC:  12233706,
				SR:  771,
				USP: 1647152,
				SSP: 14594016,
				RAM: [][2]uint32{{12233698, 64}, {12233699, 241}, {12233700, 189}, {12233701, 178}, {12233702, 170}, {12233703, 236}, {12510774, 3}, {12510775, 3}, {12233704, 8}, {12233705, 189}},
				Cycles: 18,
			},
		},
		{
			name: "769 MOVEfromSR (A7)+ 40df",
			init: 			cpuState{
				D:   [8]uint32{1243650333, 464859434, 3793541579, 949768229, 4120534682, 2567898735, 3161257316, 1386338901},
				A:   [7]uint32{1966882448, 3705499886, 3567558844, 318871606, 160677438, 960196512, 2038700065},
				PC:  256276,
				SR:  8967,
				USP: 7294898,
				SSP: 10164720,
				RAM: [][2]uint32{{256272, 64}, {256273, 223}, {256274, 155}, {256275, 152}, {10164720, 73}, {10164721, 91}, {256276, 248}, {256277, 249}},
			},
			want: 			cpuState{
				D:   [8]uint32{1243650333, 464859434, 3793541579, 949768229, 4120534682, 2567898735, 3161257316, 1386338901},
				A:   [7]uint32{1966882448, 3705499886, 3567558844, 318871606, 160677438, 960196512, 2038700065},
				PC:  256278,
				SR:  8967,
				USP: 7294898,
				SSP: 10164722,
				RAM: [][2]uint32{{256272, 64}, {256273, 223}, {256274, 155}, {256275, 152}, {10164720, 35}, {10164721, 7}, {256276, 248}, {256277, 249}},
				Cycles: 12,
			},
		},
		{
			name: "1114 MOVEfromSR -(A6) 40e6",
			init: 			cpuState{
				D:   [8]uint32{558699592, 2762462883, 4176901850, 3666581158, 3946289208, 4166545130, 233302386, 2903378730},
				A:   [7]uint32{606175753, 3492930985, 900678482, 2383664806, 1343422068, 2120580283, 3612771828},
				PC:  11673800,
				SR:  8205,
				USP: 2318900,
				SSP: 6279278,
				RAM: [][2]uint32{{11673796, 64}, {11673797, 230}, {11673798, 18}, {11673799, 210}, {5670386, 204}, {5670387, 22}, {11673800, 247}, {11673801, 224}},
			},
			want: 			cpuState{
				D:   [8]uint32{558699592, 2762462883, 4176901850, 3666581158, 3946289208, 4166545130, 233302386, 2903378730},
				A:   [7]uint32{606175753, 3492930985, 900678482, 2383664806, 1343422068, 2120580283, 3612771826},
				PC:  11673802,
				SR:  8205,
				USP: 2318900,
				SSP: 6279278,
				RAM: [][2]uint32{{11673796, 64}, {11673797, 230}, {11673798, 18}, {11673799, 210}, {5670386, 32}, {5670387, 13}, {11673800, 247}, {11673801, 224}},
				Cycles: 14,
			},
		},
		{
			name: "1384 MOVEfromSR (d8, A0, Xn) 40f0",
			init: 			cpuState{
				D:   [8]uint32{705144580, 1204036003, 1367394723, 4107640484, 3984053311, 2743228618, 1349213403, 1402495475},
				A:   [7]uint32{4231844626, 3744805575, 3081892222, 2721882917, 3196132254, 2670763017, 581844290},
				PC:  5150074,
				SR:  799,
				USP: 1324228,
				SSP: 6353410,
				RAM: [][2]uint32{{5150070, 64}, {5150071, 240}, {5150072, 65}, {5150073, 167}, {5150074, 173}, {5150075, 53}, {3974904, 217}, {3974905, 192}, {5150076, 37}, {5150077, 9}},
			},
			want: 			cpuState{
				D:   [8]uint32{705144580, 1204036003, 1367394723, 4107640484, 3984053311, 2743228618, 1349213403, 1402495475},
				A:   [7]uint32{4231844626, 3744805575, 3081892222, 2721882917, 3196132254, 2670763017, 581844290},
				PC:  5150078,
				SR:  799,
				USP: 1324228,
				SSP: 6353410,
				RAM: [][2]uint32{{5150070, 64}, {5150071, 240}, {5150072, 65}, {5150073, 167}, {5150074, 173}, {5150075, 53}, {3974904, 3}, {3974905, 31}, {5150076, 37}, {5150077, 9}},
				Cycles: 18,
			},
		},
		{
			name: "1631 MOVEfromSR (d8, A7, Xn) 40f7",
			init: 			cpuState{
				D:   [8]uint32{2305485935, 1539337878, 3340892346, 330504108, 2348477254, 472758742, 1897979056, 336543975},
				A:   [7]uint32{602243801, 2564143205, 3891854230, 564680215, 2588383263, 4208816657, 1232835687},
				PC:  11702996,
				SR:  10007,
				USP: 15702112,
				SSP: 10019550,
				RAM: [][2]uint32{{11702992, 64}, {11702993, 247}, {11702994, 56}, {11702995, 54}, {11702996, 21}, {11702997, 129}, {4979392, 175}, {4979393, 34}, {11702998, 0}, {11702999, 61}},
			},
			want: 			cpuState{
				D:   [8]uint32{2305485935, 1539337878, 3340892346, 330504108, 2348477254, 472758742, 1897979056, 336543975},
				A:   [7]uint32{602243801, 2564143205, 3891854230, 564680215, 2588383263, 4208816657, 1232835687},
				PC:  11703000,
				SR:  10007,
				USP: 15702112,
				SSP: 10019550,
				RAM: [][2]uint32{{11702992, 64}, {11702993, 247}, {11702994, 56}, {11702995, 54}, {11702996, 21}, {11702997, 129}, {4979392, 39}, {4979393, 23}, {11702998, 0}, {11702999, 61}},
				Cycles: 18,
			},
		},
		{
			name: "1886 MOVEfromSR (A6)+ 40de",
			init: 			cpuState{
				D:   [8]uint32{3866729400, 3940598769, 611250101, 1383472144, 1171596151, 78382769, 2979646440, 3909096430},
				A:   [7]uint32{1372046974, 3448030219, 905276585, 163165243, 2366009558, 2206952852, 2830123088},
				PC:  4352714,
				SR:  8970,
				USP: 9770850,
				SSP: 23860,
				RAM: [][2]uint32{{4352710, 64}, {4352711, 222}, {4352712, 212}, {4352713, 33}, {11550800, 100}, {11550801, 164}, {4352714, 95}, {4352715, 11}},
			},
			want: 			cpuState{
				D:   [8]uint32{3866729400, 3940598769, 611250101, 1383472144, 1171596151, 78382769, 2979646440, 3909096430},
				A:   [7]uint32{1372046974, 3448030219, 905276585, 163165243, 2366009558, 2206952852, 2830123090},
				PC:  4352716,
				SR:  8970,
				USP: 9770850,
				SSP: 23860,
				RAM: [][2]uint32{{4352710, 64}, {4352711, 222}, {4352712, 212}, {4352713, 33}, {11550800, 35}, {11550801, 10}, {4352714, 95}, {4352715, 11}},
				Cycles: 12,
			},
		},
		{
			name: "2201 MOVEfromSR (d16, A7) 40ef",
			init: 			cpuState{
				D:   [8]uint32{3443043561, 1475344530, 1695332797, 2316328549, 2499787182, 3035485383, 2378105942, 3136484363},
				A:   [7]uint32{2687008188, 3441279355, 2543618204, 2782689872, 29316633, 4014479201, 819086244},
				PC:  2133062,
				SR:  1037,
				USP: 834802,
				SSP: 16199882,
				RAM: [][2]uint32{{2133058, 64}, {2133059, 239}, {2133060, 245}, {2133061, 244}, {2133062, 206}, {2133063, 248}, {832230, 246}, {832231, 254}, {2133064, 148}, {2133065, 73}},
			},
			want: 			cpuState{
				D:   [8]uint32{3443043561, 1475344530, 1695332797, 2316328549, 2499787182, 3035485383, 2378105942, 3136484363},
				A:   [7]uint32{2687008188, 3441279355, 2543618204, 2782689872, 29316633, 4014479201, 819086244},
				PC:  2133066,
				SR:  1037,
				USP: 834802,
				SSP: 16199882,
				RAM: [][2]uint32{{2133058, 64}, {2133059, 239}, {2133060, 245}, {2133061, 244}, {2133062, 206}, {2133063, 248}, {832230, 4}, {832231, 13}, {2133064, 148}, {2133065, 73}},
				Cycles: 16,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEtoUSP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEtoUSP A0 4e60",
			init: cpuState{
				D:   [8]uint32{2692887478, 1280383817, 2144670232, 3019371263, 1560465517, 1582093765, 2709448005, 1152394757},
				A:   [7]uint32{481269603, 1731379481, 1707162888, 1164091097, 2335275678, 3795186, 2816624664},
				PC:  12467038,
				SR:  33295,
				USP: 7632622,
				SSP: 12359498,
				RAM: [][2]uint32{{12467034, 78}, {12467035, 96}, {12467036, 77}, {12467037, 210}, {32, 144}, {33, 240}, {34, 140}, {35, 50}, {15764530, 151}, {15764531, 44}, {15764532, 247}, {15764533, 34}},
			},
			want: cpuState{
				D:   [8]uint32{2692887478, 1280383817, 2144670232, 3019371263, 1560465517, 1582093765, 2709448005, 1152394757},
				A:   [7]uint32{481269603, 1731379481, 1707162888, 1164091097, 2335275678, 3795186, 2816624664},
				PC:  2431683638,
				SR:  8719,
				USP: 7632622,
				SSP: 12359492,
				RAM: [][2]uint32{{12467034, 78}, {12467035, 96}, {12467036, 77}, {12467037, 210}, {12359496, 59}, {12359497, 90}, {12359492, 130}, {12359493, 15}, {12359494, 0}, {12359495, 190}, {32, 144}, {33, 240}, {34, 140}, {35, 50}, {15764530, 151}, {15764531, 44}, {15764532, 247}, {15764533, 34}},
				Cycles: 34,
			},
		},
		{
			name: "500 MOVEtoUSP A6 4e66",
			init: cpuState{
				D:   [8]uint32{912812780, 3386566610, 1086521279, 3311217772, 3327004687, 3459362308, 1880994954, 1970017772},
				A:   [7]uint32{3350879370, 257734140, 3607925952, 3613369214, 1415032015, 920663977, 1682355851},
				PC:  1218290,
				SR:  10004,
				USP: 13540520,
				SSP: 6172494,
				RAM: [][2]uint32{{1218286, 78}, {1218287, 102}, {1218288, 59}, {1218289, 28}, {1218290, 244}, {1218291, 156}},
			},
			want: cpuState{
				D:   [8]uint32{912812780, 3386566610, 1086521279, 3311217772, 3327004687, 3459362308, 1880994954, 1970017772},
				A:   [7]uint32{3350879370, 257734140, 3607925952, 3613369214, 1415032015, 920663977, 1682355851},
				PC:  1218292,
				SR:  10004,
				USP: 1682355851,
				SSP: 6172494,
				RAM: [][2]uint32{{1218286, 78}, {1218287, 102}, {1218288, 59}, {1218289, 28}, {1218290, 244}, {1218291, 156}},
				Cycles: 4,
			},
		},
		{
			name: "1000 MOVEtoUSP A0 4e60",
			init: cpuState{
				D:   [8]uint32{2594548936, 2037726791, 1928706930, 1744591507, 3055210563, 3300802918, 1599975080, 2855931147},
				A:   [7]uint32{2319306297, 3942468084, 3801921084, 4196418685, 2714132150, 1192234638, 4133456507},
				PC:  2430042,
				SR:  9750,
				USP: 9024166,
				SSP: 9991812,
				RAM: [][2]uint32{{2430038, 78}, {2430039, 96}, {2430040, 16}, {2430041, 165}, {2430042, 98}, {2430043, 55}},
			},
			want: cpuState{
				D:   [8]uint32{2594548936, 2037726791, 1928706930, 1744591507, 3055210563, 3300802918, 1599975080, 2855931147},
				A:   [7]uint32{2319306297, 3942468084, 3801921084, 4196418685, 2714132150, 1192234638, 4133456507},
				PC:  2430044,
				SR:  9750,
				USP: 2319306297,
				SSP: 9991812,
				RAM: [][2]uint32{{2430038, 78}, {2430039, 96}, {2430040, 16}, {2430041, 165}, {2430042, 98}, {2430043, 55}},
				Cycles: 4,
			},
		},
		{
			name: "1500 MOVEtoUSP A6 4e66",
			init: cpuState{
				D:   [8]uint32{3809900723, 495766190, 3076949713, 3952646349, 1248345641, 282042239, 4121261915, 3946795161},
				A:   [7]uint32{1657997161, 2260855301, 2136337854, 2935999328, 1094659268, 1457702800, 2366959569},
				PC:  7497250,
				SR:  9482,
				USP: 6244100,
				SSP: 15020918,
				RAM: [][2]uint32{{7497246, 78}, {7497247, 102}, {7497248, 134}, {7497249, 22}, {7497250, 243}, {7497251, 65}},
			},
			want: cpuState{
				D:   [8]uint32{3809900723, 495766190, 3076949713, 3952646349, 1248345641, 282042239, 4121261915, 3946795161},
				A:   [7]uint32{1657997161, 2260855301, 2136337854, 2935999328, 1094659268, 1457702800, 2366959569},
				PC:  7497252,
				SR:  9482,
				USP: 2366959569,
				SSP: 15020918,
				RAM: [][2]uint32{{7497246, 78}, {7497247, 102}, {7497248, 134}, {7497249, 22}, {7497250, 243}, {7497251, 65}},
				Cycles: 4,
			},
		},
		{
			name: "2000 MOVEtoUSP A3 4e63",
			init: cpuState{
				D:   [8]uint32{2500080291, 1338084160, 2702400891, 2599218920, 1441366654, 1629096673, 3868511571, 3211028740},
				A:   [7]uint32{2132947446, 2963103044, 3451915881, 3687177431, 1478447923, 2218346974, 1028731983},
				PC:  806796,
				SR:  773,
				USP: 5952566,
				SSP: 15600738,
				RAM: [][2]uint32{{806792, 78}, {806793, 99}, {806794, 50}, {806795, 168}, {32, 144}, {33, 192}, {34, 90}, {35, 116}, {12606068, 16}, {12606069, 94}, {12606070, 244}, {12606071, 125}},
			},
			want: cpuState{
				D:   [8]uint32{2500080291, 1338084160, 2702400891, 2599218920, 1441366654, 1629096673, 3868511571, 3211028740},
				A:   [7]uint32{2132947446, 2963103044, 3451915881, 3687177431, 1478447923, 2218346974, 1028731983},
				PC:  2428525176,
				SR:  8965,
				USP: 5952566,
				SSP: 15600732,
				RAM: [][2]uint32{{806792, 78}, {806793, 99}, {806794, 50}, {806795, 168}, {15600736, 79}, {15600737, 136}, {15600732, 3}, {15600733, 5}, {15600734, 0}, {15600735, 12}, {32, 144}, {33, 192}, {34, 90}, {35, 116}, {12606068, 16}, {12606069, 94}, {12606070, 244}, {12606071, 125}},
				Cycles: 34,
			},
		},
		{
			name: "002 MOVEtoUSP A6 4e66",
			init: 			cpuState{
				D:   [8]uint32{4278355914, 2673633423, 3668443666, 534480024, 2694591428, 1032025629, 2203659605, 3213892371},
				A:   [7]uint32{259733908, 2358054238, 1687766432, 4281165561, 3834844621, 78241800, 2441121356},
				PC:  917274,
				SR:  8967,
				USP: 5850798,
				SSP: 3479364,
				RAM: [][2]uint32{{917270, 78}, {917271, 102}, {917272, 209}, {917273, 204}, {917274, 200}, {917275, 114}},
			},
			want: 			cpuState{
				D:   [8]uint32{4278355914, 2673633423, 3668443666, 534480024, 2694591428, 1032025629, 2203659605, 3213892371},
				A:   [7]uint32{259733908, 2358054238, 1687766432, 4281165561, 3834844621, 78241800, 2441121356},
				PC:  917276,
				SR:  8967,
				USP: 2441121356,
				SSP: 3479364,
				RAM: [][2]uint32{{917270, 78}, {917271, 102}, {917272, 209}, {917273, 204}, {917274, 200}, {917275, 114}},
				Cycles: 4,
			},
		},
		{
			name: "288 MOVEtoUSP A4 4e64",
			init: 			cpuState{
				D:   [8]uint32{4097129281, 1256861761, 3398095571, 3429311002, 2805590819, 3708911713, 550771604, 1279149483},
				A:   [7]uint32{4281265670, 1411081280, 435262710, 3237595156, 1112977908, 3607027476, 632768395},
				PC:  2564590,
				SR:  1797,
				USP: 14088782,
				SSP: 1057224,
				RAM: [][2]uint32{{2564586, 78}, {2564587, 100}, {2564588, 186}, {2564589, 176}, {32, 246}, {33, 48}, {34, 113}, {35, 134}, {3174790, 57}, {3174791, 74}, {3174792, 163}, {3174793, 207}},
			},
			want: 			cpuState{
				D:   [8]uint32{4097129281, 1256861761, 3398095571, 3429311002, 2805590819, 3708911713, 550771604, 1279149483},
				A:   [7]uint32{4281265670, 1411081280, 435262710, 3237595156, 1112977908, 3607027476, 632768395},
				PC:  4130369930,
				SR:  9989,
				USP: 14088782,
				SSP: 1057218,
				RAM: [][2]uint32{{2564586, 78}, {2564587, 100}, {2564588, 186}, {2564589, 176}, {1057222, 33}, {1057223, 234}, {1057218, 7}, {1057219, 5}, {1057220, 0}, {1057221, 39}, {32, 246}, {33, 48}, {34, 113}, {35, 134}, {3174790, 57}, {3174791, 74}, {3174792, 163}, {3174793, 207}},
				Cycles: 34,
			},
		},
		{
			name: "587 MOVEtoUSP A3 4e63",
			init: 			cpuState{
				D:   [8]uint32{530059552, 681190326, 2546726496, 2419828393, 1002620621, 1237405701, 3449192790, 4032922380},
				A:   [7]uint32{515395119, 1623482330, 2539691788, 2084161273, 4134281219, 4126909141, 4156721371},
				PC:  11482438,
				SR:  8217,
				USP: 12885298,
				SSP: 9784204,
				RAM: [][2]uint32{{11482434, 78}, {11482435, 99}, {11482436, 42}, {11482437, 128}, {11482438, 35}, {11482439, 119}},
			},
			want: 			cpuState{
				D:   [8]uint32{530059552, 681190326, 2546726496, 2419828393, 1002620621, 1237405701, 3449192790, 4032922380},
				A:   [7]uint32{515395119, 1623482330, 2539691788, 2084161273, 4134281219, 4126909141, 4156721371},
				PC:  11482440,
				SR:  8217,
				USP: 2084161273,
				SSP: 9784204,
				RAM: [][2]uint32{{11482434, 78}, {11482435, 99}, {11482436, 42}, {11482437, 128}, {11482438, 35}, {11482439, 119}},
				Cycles: 4,
			},
		},
		{
			name: "848 MOVEtoUSP A1 4e61",
			init: 			cpuState{
				D:   [8]uint32{2651033609, 835581701, 3127572246, 483147454, 3146805315, 956578732, 3504225017, 3156284064},
				A:   [7]uint32{3906811220, 1268001908, 1239960256, 3866415704, 1055479062, 3033096819, 632922117},
				PC:  604188,
				SR:  8196,
				USP: 7428418,
				SSP: 12267940,
				RAM: [][2]uint32{{604184, 78}, {604185, 97}, {604186, 41}, {604187, 136}, {604188, 162}, {604189, 237}},
			},
			want: 			cpuState{
				D:   [8]uint32{2651033609, 835581701, 3127572246, 483147454, 3146805315, 956578732, 3504225017, 3156284064},
				A:   [7]uint32{3906811220, 1268001908, 1239960256, 3866415704, 1055479062, 3033096819, 632922117},
				PC:  604190,
				SR:  8196,
				USP: 1268001908,
				SSP: 12267940,
				RAM: [][2]uint32{{604184, 78}, {604185, 97}, {604186, 41}, {604187, 136}, {604188, 162}, {604189, 237}},
				Cycles: 4,
			},
		},
		{
			name: "1099 MOVEtoUSP A6 4e66",
			init: 			cpuState{
				D:   [8]uint32{3067028996, 253464873, 3270525747, 514516619, 22040813, 2170102731, 3033230465, 3594958677},
				A:   [7]uint32{1930141679, 3678919080, 3823811811, 2212974669, 2625819789, 3425676801, 3776819847},
				PC:  6320086,
				SR:  9242,
				USP: 10654804,
				SSP: 11645078,
				RAM: [][2]uint32{{6320082, 78}, {6320083, 102}, {6320084, 100}, {6320085, 245}, {6320086, 9}, {6320087, 110}},
			},
			want: 			cpuState{
				D:   [8]uint32{3067028996, 253464873, 3270525747, 514516619, 22040813, 2170102731, 3033230465, 3594958677},
				A:   [7]uint32{1930141679, 3678919080, 3823811811, 2212974669, 2625819789, 3425676801, 3776819847},
				PC:  6320088,
				SR:  9242,
				USP: 3776819847,
				SSP: 11645078,
				RAM: [][2]uint32{{6320082, 78}, {6320083, 102}, {6320084, 100}, {6320085, 245}, {6320086, 9}, {6320087, 110}},
				Cycles: 4,
			},
		},
		{
			name: "1389 MOVEtoUSP A1 4e61",
			init: 			cpuState{
				D:   [8]uint32{4022181930, 1095767239, 279332651, 324609880, 23883702, 4292145084, 2360721901, 2207670231},
				A:   [7]uint32{1823566702, 3816543328, 3777510946, 3160382435, 1311006955, 2440025907, 1257899401},
				PC:  2906670,
				SR:  8732,
				USP: 6219056,
				SSP: 8626286,
				RAM: [][2]uint32{{2906666, 78}, {2906667, 97}, {2906668, 122}, {2906669, 53}, {2906670, 50}, {2906671, 248}},
			},
			want: 			cpuState{
				D:   [8]uint32{4022181930, 1095767239, 279332651, 324609880, 23883702, 4292145084, 2360721901, 2207670231},
				A:   [7]uint32{1823566702, 3816543328, 3777510946, 3160382435, 1311006955, 2440025907, 1257899401},
				PC:  2906672,
				SR:  8732,
				USP: 3816543328,
				SSP: 8626286,
				RAM: [][2]uint32{{2906666, 78}, {2906667, 97}, {2906668, 122}, {2906669, 53}, {2906670, 50}, {2906671, 248}},
				Cycles: 4,
			},
		},
		{
			name: "1692 MOVEtoUSP A1 4e61",
			init: 			cpuState{
				D:   [8]uint32{3227760902, 3402920152, 1715637227, 2119889852, 2830389725, 2635212899, 199442376, 2491798912},
				A:   [7]uint32{4071918194, 477220445, 727682543, 2225072938, 3286741810, 1141916770, 5660588},
				PC:  1794706,
				SR:  1810,
				USP: 15091392,
				SSP: 6171016,
				RAM: [][2]uint32{{1794702, 78}, {1794703, 97}, {1794704, 214}, {1794705, 176}, {32, 29}, {33, 166}, {34, 175}, {35, 150}, {10923926, 67}, {10923927, 199}, {10923928, 109}, {10923929, 116}},
			},
			want: 			cpuState{
				D:   [8]uint32{3227760902, 3402920152, 1715637227, 2119889852, 2830389725, 2635212899, 199442376, 2491798912},
				A:   [7]uint32{4071918194, 477220445, 727682543, 2225072938, 3286741810, 1141916770, 5660588},
				PC:  497463194,
				SR:  10002,
				USP: 15091392,
				SSP: 6171010,
				RAM: [][2]uint32{{1794702, 78}, {1794703, 97}, {1794704, 214}, {1794705, 176}, {6171014, 98}, {6171015, 142}, {6171010, 7}, {6171011, 18}, {6171012, 0}, {6171013, 27}, {32, 29}, {33, 166}, {34, 175}, {35, 150}, {10923926, 67}, {10923927, 199}, {10923928, 109}, {10923929, 116}},
				Cycles: 34,
			},
		},
		{
			name: "1970 MOVEtoUSP A0 4e60",
			init: 			cpuState{
				D:   [8]uint32{1613928881, 3516506710, 4068821400, 3875858142, 3249304092, 1035100203, 1415732652, 2383751337},
				A:   [7]uint32{1112554748, 1109366949, 3484880375, 3645544872, 1587075116, 2106262707, 4225792414},
				PC:  7256158,
				SR:  9472,
				USP: 602578,
				SSP: 15839002,
				RAM: [][2]uint32{{7256154, 78}, {7256155, 96}, {7256156, 189}, {7256157, 42}, {7256158, 214}, {7256159, 33}},
			},
			want: 			cpuState{
				D:   [8]uint32{1613928881, 3516506710, 4068821400, 3875858142, 3249304092, 1035100203, 1415732652, 2383751337},
				A:   [7]uint32{1112554748, 1109366949, 3484880375, 3645544872, 1587075116, 2106262707, 4225792414},
				PC:  7256160,
				SR:  9472,
				USP: 1112554748,
				SSP: 15839002,
				RAM: [][2]uint32{{7256154, 78}, {7256155, 96}, {7256156, 189}, {7256157, 42}, {7256158, 214}, {7256159, 33}},
				Cycles: 4,
			},
		},
		{
			name: "2216 MOVEtoUSP A0 4e60",
			init: 			cpuState{
				D:   [8]uint32{1158800410, 390612973, 1536296373, 2525100940, 2687605920, 2339042388, 858677864, 1633177021},
				A:   [7]uint32{1001267779, 2238529824, 2602911939, 250402597, 2774079475, 3844366507, 2072479094},
				PC:  16161494,
				SR:  1290,
				USP: 1521972,
				SSP: 12470676,
				RAM: [][2]uint32{{16161490, 78}, {16161491, 96}, {16161492, 15}, {16161493, 145}, {32, 0}, {33, 2}, {34, 3}, {35, 116}, {131956, 230}, {131957, 231}, {131958, 244}, {131959, 241}},
			},
			want: 			cpuState{
				D:   [8]uint32{1158800410, 390612973, 1536296373, 2525100940, 2687605920, 2339042388, 858677864, 1633177021},
				A:   [7]uint32{1001267779, 2238529824, 2602911939, 250402597, 2774079475, 3844366507, 2072479094},
				PC:  131960,
				SR:  9482,
				USP: 1521972,
				SSP: 12470670,
				RAM: [][2]uint32{{16161490, 78}, {16161491, 96}, {16161492, 15}, {16161493, 145}, {12470674, 154}, {12470675, 210}, {12470670, 5}, {12470671, 10}, {12470672, 0}, {12470673, 246}, {32, 0}, {33, 2}, {34, 3}, {35, 116}, {131956, 230}, {131957, 231}, {131958, 244}, {131959, 241}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestMOVEfromUSP(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 MOVEfromUSP A7 4e6f",
			init: cpuState{
				D:   [8]uint32{587428628, 685730099, 90308950, 4241487395, 444553911, 2499854212, 1607600214, 129444812},
				A:   [7]uint32{2923414324, 3969042471, 285980870, 2419145562, 3765786936, 475346137, 3518790682},
				PC:  3488622,
				SR:  18,
				USP: 13503518,
				SSP: 10888206,
				RAM: [][2]uint32{{3488618, 78}, {3488619, 111}, {3488620, 68}, {3488621, 186}, {32, 199}, {33, 100}, {34, 45}, {35, 172}, {6565292, 42}, {6565293, 42}, {6565294, 45}, {6565295, 141}},
			},
			want: cpuState{
				D:   [8]uint32{587428628, 685730099, 90308950, 4241487395, 444553911, 2499854212, 1607600214, 129444812},
				A:   [7]uint32{2923414324, 3969042471, 285980870, 2419145562, 3765786936, 475346137, 3518790682},
				PC:  3345231280,
				SR:  8210,
				USP: 13503518,
				SSP: 10888200,
				RAM: [][2]uint32{{3488618, 78}, {3488619, 111}, {3488620, 68}, {3488621, 186}, {10888204, 59}, {10888205, 106}, {10888200, 0}, {10888201, 18}, {10888202, 0}, {10888203, 53}, {32, 199}, {33, 100}, {34, 45}, {35, 172}, {6565292, 42}, {6565293, 42}, {6565294, 45}, {6565295, 141}},
				Cycles: 34,
			},
		},
		{
			name: "500 MOVEfromUSP A6 4e6e",
			init: cpuState{
				D:   [8]uint32{3826281324, 2946529264, 2007100753, 723984599, 1704072126, 2363332405, 329250907, 3055575341},
				A:   [7]uint32{2886894871, 516501273, 1026832995, 71980587, 630227634, 2722813337, 3077281546},
				PC:  7388786,
				SR:  42515,
				USP: 8454188,
				SSP: 6465672,
				RAM: [][2]uint32{{7388782, 78}, {7388783, 110}, {7388784, 60}, {7388785, 82}, {7388786, 133}, {7388787, 218}},
			},
			want: cpuState{
				D:   [8]uint32{3826281324, 2946529264, 2007100753, 723984599, 1704072126, 2363332405, 329250907, 3055575341},
				A:   [7]uint32{2886894871, 516501273, 1026832995, 71980587, 630227634, 2722813337, 8454188},
				PC:  7388788,
				SR:  42515,
				USP: 8454188,
				SSP: 6465672,
				RAM: [][2]uint32{{7388782, 78}, {7388783, 110}, {7388784, 60}, {7388785, 82}, {7388786, 133}, {7388787, 218}},
				Cycles: 4,
			},
		},
		{
			name: "1000 MOVEfromUSP A7 4e6f",
			init: cpuState{
				D:   [8]uint32{818672653, 4199621782, 1582621795, 403136911, 1762018485, 551181275, 2803053628, 1986953272},
				A:   [7]uint32{2102150527, 3954196631, 1732554384, 2216712939, 1591630585, 2586251494, 315569742},
				PC:  9177826,
				SR:  1794,
				USP: 5625360,
				SSP: 277096,
				RAM: [][2]uint32{{9177822, 78}, {9177823, 111}, {9177824, 103}, {9177825, 62}, {32, 0}, {33, 78}, {34, 61}, {35, 70}, {5127494, 193}, {5127495, 17}, {5127496, 130}, {5127497, 183}},
			},
			want: cpuState{
				D:   [8]uint32{818672653, 4199621782, 1582621795, 403136911, 1762018485, 551181275, 2803053628, 1986953272},
				A:   [7]uint32{2102150527, 3954196631, 1732554384, 2216712939, 1591630585, 2586251494, 315569742},
				PC:  5127498,
				SR:  9986,
				USP: 5625360,
				SSP: 277090,
				RAM: [][2]uint32{{9177822, 78}, {9177823, 111}, {9177824, 103}, {9177825, 62}, {277094, 10}, {277095, 222}, {277090, 7}, {277091, 2}, {277092, 0}, {277093, 140}, {32, 0}, {33, 78}, {34, 61}, {35, 70}, {5127494, 193}, {5127495, 17}, {5127496, 130}, {5127497, 183}},
				Cycles: 34,
			},
		},
		{
			name: "1500 MOVEfromUSP A3 4e6b",
			init: cpuState{
				D:   [8]uint32{3402571310, 2818552838, 984013013, 1640487251, 3339644150, 3755871362, 1068948948, 1572190467},
				A:   [7]uint32{1694200701, 3227222914, 2097103787, 246391037, 2823830304, 3217022803, 3251440079},
				PC:  6898936,
				SR:  271,
				USP: 12106936,
				SSP: 12532204,
				RAM: [][2]uint32{{6898932, 78}, {6898933, 107}, {6898934, 17}, {6898935, 56}, {32, 28}, {33, 74}, {34, 58}, {35, 200}, {4864712, 251}, {4864713, 203}, {4864714, 68}, {4864715, 82}},
			},
			want: cpuState{
				D:   [8]uint32{3402571310, 2818552838, 984013013, 1640487251, 3339644150, 3755871362, 1068948948, 1572190467},
				A:   [7]uint32{1694200701, 3227222914, 2097103787, 246391037, 2823830304, 3217022803, 3251440079},
				PC:  474626764,
				SR:  8463,
				USP: 12106936,
				SSP: 12532198,
				RAM: [][2]uint32{{6898932, 78}, {6898933, 107}, {6898934, 17}, {6898935, 56}, {12532202, 68}, {12532203, 244}, {12532198, 1}, {12532199, 15}, {12532200, 0}, {12532201, 105}, {32, 28}, {33, 74}, {34, 58}, {35, 200}, {4864712, 251}, {4864713, 203}, {4864714, 68}, {4864715, 82}},
				Cycles: 34,
			},
		},
		{
			name: "2000 MOVEfromUSP A2 4e6a",
			init: cpuState{
				D:   [8]uint32{3063103495, 2486360044, 394238960, 3263907749, 336478317, 515594171, 3952962111, 2334295731},
				A:   [7]uint32{485080491, 226607006, 1026567199, 4204229654, 3826354844, 3068290717, 4133896587},
				PC:  10411656,
				SR:  9503,
				USP: 15738226,
				SSP: 8883474,
				RAM: [][2]uint32{{10411652, 78}, {10411653, 106}, {10411654, 250}, {10411655, 178}, {10411656, 95}, {10411657, 130}},
			},
			want: cpuState{
				D:   [8]uint32{3063103495, 2486360044, 394238960, 3263907749, 336478317, 515594171, 3952962111, 2334295731},
				A:   [7]uint32{485080491, 226607006, 15738226, 4204229654, 3826354844, 3068290717, 4133896587},
				PC:  10411658,
				SR:  9503,
				USP: 15738226,
				SSP: 8883474,
				RAM: [][2]uint32{{10411652, 78}, {10411653, 106}, {10411654, 250}, {10411655, 178}, {10411656, 95}, {10411657, 130}},
				Cycles: 4,
			},
		},
		{
			name: "004 MOVEfromUSP A0 4e68",
			init: 			cpuState{
				D:   [8]uint32{1698688951, 3346095077, 425649537, 287799069, 2819867214, 3117948697, 3088426901, 207511285},
				A:   [7]uint32{3036076563, 3320880500, 3725301999, 4204225310, 239600282, 1646835921, 1361574455},
				PC:  4181812,
				SR:  1299,
				USP: 8348964,
				SSP: 9323428,
				RAM: [][2]uint32{{4181808, 78}, {4181809, 104}, {4181810, 145}, {4181811, 247}, {32, 180}, {33, 4}, {34, 29}, {35, 36}, {269604, 240}, {269605, 147}, {269606, 119}, {269607, 159}},
			},
			want: 			cpuState{
				D:   [8]uint32{1698688951, 3346095077, 425649537, 287799069, 2819867214, 3117948697, 3088426901, 207511285},
				A:   [7]uint32{3036076563, 3320880500, 3725301999, 4204225310, 239600282, 1646835921, 1361574455},
				PC:  3020168488,
				SR:  9491,
				USP: 8348964,
				SSP: 9323422,
				RAM: [][2]uint32{{4181808, 78}, {4181809, 104}, {4181810, 145}, {4181811, 247}, {9323426, 207}, {9323427, 48}, {9323422, 5}, {9323423, 19}, {9323424, 0}, {9323425, 63}, {32, 180}, {33, 4}, {34, 29}, {35, 36}, {269604, 240}, {269605, 147}, {269606, 119}, {269607, 159}},
				Cycles: 34,
			},
		},
		{
			name: "265 MOVEfromUSP A0 4e68",
			init: 			cpuState{
				D:   [8]uint32{2224207111, 3145676374, 2651552951, 3122063565, 3514559284, 2819668337, 2323861303, 2680911556},
				A:   [7]uint32{940521853, 7140454, 1544828969, 2766098894, 3496349744, 3392597759, 99166030},
				PC:  14146206,
				SR:  8985,
				USP: 13086386,
				SSP: 15246746,
				RAM: [][2]uint32{{14146202, 78}, {14146203, 104}, {14146204, 113}, {14146205, 250}, {14146206, 131}, {14146207, 220}},
			},
			want: 			cpuState{
				D:   [8]uint32{2224207111, 3145676374, 2651552951, 3122063565, 3514559284, 2819668337, 2323861303, 2680911556},
				A:   [7]uint32{13086386, 7140454, 1544828969, 2766098894, 3496349744, 3392597759, 99166030},
				PC:  14146208,
				SR:  8985,
				USP: 13086386,
				SSP: 15246746,
				RAM: [][2]uint32{{14146202, 78}, {14146203, 104}, {14146204, 113}, {14146205, 250}, {14146206, 131}, {14146207, 220}},
				Cycles: 4,
			},
		},
		{
			name: "544 MOVEfromUSP A4 4e6c",
			init: 			cpuState{
				D:   [8]uint32{3018401034, 1783464970, 3480203498, 2304047968, 1553241339, 3358522265, 4043906697, 2188339144},
				A:   [7]uint32{4177748109, 4078819258, 2841019047, 2256429738, 2966460372, 2084042502, 4241253720},
				PC:  11479200,
				SR:  783,
				USP: 5156686,
				SSP: 738508,
				RAM: [][2]uint32{{11479196, 78}, {11479197, 108}, {11479198, 213}, {11479199, 59}, {32, 212}, {33, 238}, {34, 51}, {35, 248}, {15610872, 139}, {15610873, 148}, {15610874, 115}, {15610875, 33}},
			},
			want: 			cpuState{
				D:   [8]uint32{3018401034, 1783464970, 3480203498, 2304047968, 1553241339, 3358522265, 4043906697, 2188339144},
				A:   [7]uint32{4177748109, 4078819258, 2841019047, 2256429738, 2966460372, 2084042502, 4241253720},
				PC:  3572380668,
				SR:  8975,
				USP: 5156686,
				SSP: 738502,
				RAM: [][2]uint32{{11479196, 78}, {11479197, 108}, {11479198, 213}, {11479199, 59}, {738506, 40}, {738507, 156}, {738502, 3}, {738503, 15}, {738504, 0}, {738505, 175}, {32, 212}, {33, 238}, {34, 51}, {35, 248}, {15610872, 139}, {15610873, 148}, {15610874, 115}, {15610875, 33}},
				Cycles: 34,
			},
		},
		{
			name: "837 MOVEfromUSP A2 4e6a",
			init: 			cpuState{
				D:   [8]uint32{4290747252, 1270760954, 721179608, 2597039968, 889929491, 1772671748, 1330743800, 3561876480},
				A:   [7]uint32{1510458507, 874900288, 770312835, 4192567032, 1500973588, 646658654, 591285355},
				PC:  9072900,
				SR:  1540,
				USP: 9148536,
				SSP: 4898492,
				RAM: [][2]uint32{{9072896, 78}, {9072897, 106}, {9072898, 166}, {9072899, 224}, {32, 147}, {33, 154}, {34, 164}, {35, 4}, {10134532, 225}, {10134533, 18}, {10134534, 21}, {10134535, 252}},
			},
			want: 			cpuState{
				D:   [8]uint32{4290747252, 1270760954, 721179608, 2597039968, 889929491, 1772671748, 1330743800, 3561876480},
				A:   [7]uint32{1510458507, 874900288, 770312835, 4192567032, 1500973588, 646658654, 591285355},
				PC:  2476385288,
				SR:  9732,
				USP: 9148536,
				SSP: 4898486,
				RAM: [][2]uint32{{9072896, 78}, {9072897, 106}, {9072898, 166}, {9072899, 224}, {4898490, 113}, {4898491, 0}, {4898486, 6}, {4898487, 4}, {4898488, 0}, {4898489, 138}, {32, 147}, {33, 154}, {34, 164}, {35, 4}, {10134532, 225}, {10134533, 18}, {10134534, 21}, {10134535, 252}},
				Cycles: 34,
			},
		},
		{
			name: "1108 MOVEfromUSP A0 4e68",
			init: 			cpuState{
				D:   [8]uint32{206473972, 997574972, 3742985152, 2992479255, 2256721188, 3006839162, 551615161, 14174145},
				A:   [7]uint32{3239336884, 2917620841, 1014299492, 948989121, 1662472114, 837966840, 782329632},
				PC:  13558644,
				SR:  1296,
				USP: 5537484,
				SSP: 7598262,
				RAM: [][2]uint32{{13558640, 78}, {13558641, 104}, {13558642, 2}, {13558643, 230}, {32, 222}, {33, 84}, {34, 206}, {35, 20}, {5557780, 42}, {5557781, 73}, {5557782, 141}, {5557783, 239}},
			},
			want: 			cpuState{
				D:   [8]uint32{206473972, 997574972, 3742985152, 2992479255, 2256721188, 3006839162, 551615161, 14174145},
				A:   [7]uint32{3239336884, 2917620841, 1014299492, 948989121, 1662472114, 837966840, 782329632},
				PC:  3730099736,
				SR:  9488,
				USP: 5537484,
				SSP: 7598256,
				RAM: [][2]uint32{{13558640, 78}, {13558641, 104}, {13558642, 2}, {13558643, 230}, {7598260, 227}, {7598261, 112}, {7598256, 5}, {7598257, 16}, {7598258, 0}, {7598259, 206}, {32, 222}, {33, 84}, {34, 206}, {35, 20}, {5557780, 42}, {5557781, 73}, {5557782, 141}, {5557783, 239}},
				Cycles: 34,
			},
		},
		{
			name: "1405 MOVEfromUSP A5 4e6d",
			init: 			cpuState{
				D:   [8]uint32{772513601, 1562932109, 1077682141, 4254547058, 2062224921, 1336776269, 3283420912, 3223423631},
				A:   [7]uint32{2492058949, 3818001270, 417108477, 2124808946, 3492843298, 2432236880, 3937361394},
				PC:  4110506,
				SR:  785,
				USP: 2518108,
				SSP: 11748186,
				RAM: [][2]uint32{{4110502, 78}, {4110503, 109}, {4110504, 31}, {4110505, 131}, {32, 123}, {33, 180}, {34, 54}, {35, 176}, {11810480, 174}, {11810481, 86}, {11810482, 170}, {11810483, 36}},
			},
			want: 			cpuState{
				D:   [8]uint32{772513601, 1562932109, 1077682141, 4254547058, 2062224921, 1336776269, 3283420912, 3223423631},
				A:   [7]uint32{2492058949, 3818001270, 417108477, 2124808946, 3492843298, 2432236880, 3937361394},
				PC:  2075408052,
				SR:  8977,
				USP: 2518108,
				SSP: 11748180,
				RAM: [][2]uint32{{4110502, 78}, {4110503, 109}, {4110504, 31}, {4110505, 131}, {11748184, 184}, {11748185, 166}, {11748180, 3}, {11748181, 17}, {11748182, 0}, {11748183, 62}, {32, 123}, {33, 180}, {34, 54}, {35, 176}, {11810480, 174}, {11810481, 86}, {11810482, 170}, {11810483, 36}},
				Cycles: 34,
			},
		},
		{
			name: "1649 MOVEfromUSP A3 4e6b",
			init: 			cpuState{
				D:   [8]uint32{1310682246, 955731894, 2859825153, 3094366408, 520508363, 3126899024, 3194203754, 3747488427},
				A:   [7]uint32{1356594351, 4073051011, 2511614401, 1755945581, 2310520421, 1945622856, 422221790},
				PC:  12564438,
				SR:  1563,
				USP: 16723762,
				SSP: 10862820,
				RAM: [][2]uint32{{12564434, 78}, {12564435, 107}, {12564436, 32}, {12564437, 248}, {32, 122}, {33, 158}, {34, 56}, {35, 100}, {10369124, 188}, {10369125, 19}, {10369126, 166}, {10369127, 76}},
			},
			want: 			cpuState{
				D:   [8]uint32{1310682246, 955731894, 2859825153, 3094366408, 520508363, 3126899024, 3194203754, 3747488427},
				A:   [7]uint32{1356594351, 4073051011, 2511614401, 1755945581, 2310520421, 1945622856, 422221790},
				PC:  2057189480,
				SR:  9755,
				USP: 16723762,
				SSP: 10862814,
				RAM: [][2]uint32{{12564434, 78}, {12564435, 107}, {12564436, 32}, {12564437, 248}, {10862818, 183}, {10862819, 210}, {10862814, 6}, {10862815, 27}, {10862816, 0}, {10862817, 191}, {32, 122}, {33, 158}, {34, 56}, {35, 100}, {10369124, 188}, {10369125, 19}, {10369126, 166}, {10369127, 76}},
				Cycles: 34,
			},
		},
		{
			name: "1951 MOVEfromUSP A2 4e6a",
			init: 			cpuState{
				D:   [8]uint32{2522621038, 1322382587, 3083201781, 2447028044, 3942588489, 129842288, 1908224912, 1139063697},
				A:   [7]uint32{574133655, 196268061, 100129555, 4145038283, 1579570624, 1928576332, 2054662049},
				PC:  2114172,
				SR:  1546,
				USP: 11800394,
				SSP: 2116140,
				RAM: [][2]uint32{{2114168, 78}, {2114169, 106}, {2114170, 175}, {2114171, 132}, {32, 218}, {33, 164}, {34, 140}, {35, 200}, {10783944, 119}, {10783945, 32}, {10783946, 131}, {10783947, 183}},
			},
			want: 			cpuState{
				D:   [8]uint32{2522621038, 1322382587, 3083201781, 2447028044, 3942588489, 129842288, 1908224912, 1139063697},
				A:   [7]uint32{574133655, 196268061, 100129555, 4145038283, 1579570624, 1928576332, 2054662049},
				PC:  3668217036,
				SR:  9738,
				USP: 11800394,
				SSP: 2116134,
				RAM: [][2]uint32{{2114168, 78}, {2114169, 106}, {2114170, 175}, {2114171, 132}, {2116138, 66}, {2116139, 120}, {2116134, 6}, {2116135, 10}, {2116136, 0}, {2116137, 32}, {32, 218}, {33, 164}, {34, 140}, {35, 200}, {10783944, 119}, {10783945, 32}, {10783946, 131}, {10783947, 183}},
				Cycles: 34,
			},
		},
		{
			name: "2250 MOVEfromUSP A7 4e6f",
			init: 			cpuState{
				D:   [8]uint32{2185804952, 174102236, 4233307077, 4018418431, 3478931250, 671299805, 3485658505, 4290287705},
				A:   [7]uint32{1805712215, 881728936, 3378985946, 2371511825, 1652411160, 392366789, 4125387097},
				PC:  9875804,
				SR:  8472,
				USP: 859906,
				SSP: 7623658,
				RAM: [][2]uint32{{9875800, 78}, {9875801, 111}, {9875802, 29}, {9875803, 96}, {9875804, 150}, {9875805, 217}},
			},
			want: 			cpuState{
				D:   [8]uint32{2185804952, 174102236, 4233307077, 4018418431, 3478931250, 671299805, 3485658505, 4290287705},
				A:   [7]uint32{1805712215, 881728936, 3378985946, 2371511825, 1652411160, 392366789, 4125387097},
				PC:  9875806,
				SR:  8472,
				USP: 859906,
				SSP: 859906,
				RAM: [][2]uint32{{9875800, 78}, {9875801, 111}, {9875802, 29}, {9875803, 96}, {9875804, 150}, {9875805, 217}},
				Cycles: 4,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestANDItoCCR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{1060220431, 3074622659, 3310109027, 1492945680, 2937026319, 3365500644, 3226290044, 145279005},
				A:   [7]uint32{3425173512, 1099825197, 3647762628, 3212943688, 433229394, 4135778562, 1342687670},
				PC:  11025688,
				SR:  41986,
				USP: 6003532,
				SSP: 9785742,
				RAM: [][2]uint32{{11025684, 2}, {11025685, 60}, {11025686, 49}, {11025687, 11}, {11025688, 72}, {11025689, 153}, {11025690, 108}, {11025691, 60}},
			},
			want: cpuState{
				D:   [8]uint32{1060220431, 3074622659, 3310109027, 1492945680, 2937026319, 3365500644, 3226290044, 145279005},
				A:   [7]uint32{3425173512, 1099825197, 3647762628, 3212943688, 433229394, 4135778562, 1342687670},
				PC:  11025692,
				SR:  41986,
				USP: 6003532,
				SSP: 9785742,
				RAM: [][2]uint32{{11025684, 2}, {11025685, 60}, {11025686, 49}, {11025687, 11}, {11025688, 72}, {11025689, 153}, {11025690, 108}, {11025691, 60}},
				Cycles: 20,
			},
		},
		{
			name: "500 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{2798591680, 2585790523, 256795648, 1944254009, 488338651, 895714591, 1778868225, 2483660720},
				A:   [7]uint32{4282162620, 235714245, 863562750, 3602177833, 2540637272, 1179480474, 738383557},
				PC:  5233844,
				SR:  33815,
				USP: 7606410,
				SSP: 6610904,
				RAM: [][2]uint32{{5233840, 2}, {5233841, 60}, {5233842, 54}, {5233843, 59}, {5233844, 57}, {5233845, 13}, {5233846, 127}, {5233847, 72}},
			},
			want: cpuState{
				D:   [8]uint32{2798591680, 2585790523, 256795648, 1944254009, 488338651, 895714591, 1778868225, 2483660720},
				A:   [7]uint32{4282162620, 235714245, 863562750, 3602177833, 2540637272, 1179480474, 738383557},
				PC:  5233848,
				SR:  33811,
				USP: 7606410,
				SSP: 6610904,
				RAM: [][2]uint32{{5233840, 2}, {5233841, 60}, {5233842, 54}, {5233843, 59}, {5233844, 57}, {5233845, 13}, {5233846, 127}, {5233847, 72}},
				Cycles: 20,
			},
		},
		{
			name: "1000 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{1775799822, 3989534912, 2821754111, 1297038457, 3566260420, 2709344996, 4092573831, 1921932936},
				A:   [7]uint32{1474311331, 738194302, 3856173952, 806405960, 1312624547, 3458197139, 365241768},
				PC:  10732816,
				SR:  777,
				USP: 3022586,
				SSP: 14776046,
				RAM: [][2]uint32{{10732812, 2}, {10732813, 60}, {10732814, 247}, {10732815, 4}, {10732816, 243}, {10732817, 88}, {10732818, 108}, {10732819, 163}},
			},
			want: cpuState{
				D:   [8]uint32{1775799822, 3989534912, 2821754111, 1297038457, 3566260420, 2709344996, 4092573831, 1921932936},
				A:   [7]uint32{1474311331, 738194302, 3856173952, 806405960, 1312624547, 3458197139, 365241768},
				PC:  10732820,
				SR:  768,
				USP: 3022586,
				SSP: 14776046,
				RAM: [][2]uint32{{10732812, 2}, {10732813, 60}, {10732814, 247}, {10732815, 4}, {10732816, 243}, {10732817, 88}, {10732818, 108}, {10732819, 163}},
				Cycles: 20,
			},
		},
		{
			name: "1500 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{1754205427, 4046007490, 3612996268, 1558972893, 2939616551, 1651951889, 2267801621, 1075918861},
				A:   [7]uint32{1309566184, 2431019489, 3295697609, 1635506180, 2688937581, 2055280930, 716133361},
				PC:  5151114,
				SR:  8199,
				USP: 1391726,
				SSP: 16714508,
				RAM: [][2]uint32{{5151110, 2}, {5151111, 60}, {5151112, 171}, {5151113, 151}, {5151114, 30}, {5151115, 139}, {5151116, 177}, {5151117, 192}},
			},
			want: cpuState{
				D:   [8]uint32{1754205427, 4046007490, 3612996268, 1558972893, 2939616551, 1651951889, 2267801621, 1075918861},
				A:   [7]uint32{1309566184, 2431019489, 3295697609, 1635506180, 2688937581, 2055280930, 716133361},
				PC:  5151118,
				SR:  8199,
				USP: 1391726,
				SSP: 16714508,
				RAM: [][2]uint32{{5151110, 2}, {5151111, 60}, {5151112, 171}, {5151113, 151}, {5151114, 30}, {5151115, 139}, {5151116, 177}, {5151117, 192}},
				Cycles: 20,
			},
		},
		{
			name: "2000 ANDItoCCR # 023c",
			init: cpuState{
				D:   [8]uint32{1099300018, 940426629, 3869948766, 527128038, 855977274, 4743712, 234477681, 2725936368},
				A:   [7]uint32{1995931642, 2538435678, 3561222761, 4202367902, 2739305189, 523105487, 3316047297},
				PC:  10886248,
				SR:  541,
				USP: 10476768,
				SSP: 13506134,
				RAM: [][2]uint32{{10886244, 2}, {10886245, 60}, {10886246, 77}, {10886247, 182}, {10886248, 41}, {10886249, 40}, {10886250, 41}, {10886251, 194}},
			},
			want: cpuState{
				D:   [8]uint32{1099300018, 940426629, 3869948766, 527128038, 855977274, 4743712, 234477681, 2725936368},
				A:   [7]uint32{1995931642, 2538435678, 3561222761, 4202367902, 2739305189, 523105487, 3316047297},
				PC:  10886252,
				SR:  532,
				USP: 10476768,
				SSP: 13506134,
				RAM: [][2]uint32{{10886244, 2}, {10886245, 60}, {10886246, 77}, {10886247, 182}, {10886248, 41}, {10886249, 40}, {10886250, 41}, {10886251, 194}},
				Cycles: 20,
			},
		},
		{
			name: "001 ANDItoCCR # 023c",
			init: 			cpuState{
				D:   [8]uint32{2772550690, 158205114, 3566278722, 487629187, 4168049958, 27290188, 3349297067, 1076961738},
				A:   [7]uint32{966781622, 315318033, 1121067207, 3164610474, 1810490946, 774294562, 2165264346},
				PC:  3955234,
				SR:  9751,
				USP: 6487616,
				SSP: 13358216,
				RAM: [][2]uint32{{3955230, 2}, {3955231, 60}, {3955232, 117}, {3955233, 187}, {3955234, 142}, {3955235, 112}, {3955236, 11}, {3955237, 223}},
			},
			want: 			cpuState{
				D:   [8]uint32{2772550690, 158205114, 3566278722, 487629187, 4168049958, 27290188, 3349297067, 1076961738},
				A:   [7]uint32{966781622, 315318033, 1121067207, 3164610474, 1810490946, 774294562, 2165264346},
				PC:  3955238,
				SR:  9747,
				USP: 6487616,
				SSP: 13358216,
				RAM: [][2]uint32{{3955230, 2}, {3955231, 60}, {3955232, 117}, {3955233, 187}, {3955234, 142}, {3955235, 112}, {3955236, 11}, {3955237, 223}},
				Cycles: 20,
			},
		},
		{
			name: "316 ANDItoCCR # 023c",
			init: 			cpuState{
				D:   [8]uint32{2051837172, 3524635489, 3704108708, 836378535, 1189258569, 3499966129, 1508813406, 3957664108},
				A:   [7]uint32{1934061258, 2385545806, 1309564751, 1455923617, 2379990428, 3099881913, 1683168168},
				PC:  4454780,
				SR:  8196,
				USP: 10773596,
				SSP: 3376496,
				RAM: [][2]uint32{{4454776, 2}, {4454777, 60}, {4454778, 112}, {4454779, 237}, {4454780, 254}, {4454781, 196}, {4454782, 116}, {4454783, 146}},
			},
			want: 			cpuState{
				D:   [8]uint32{2051837172, 3524635489, 3704108708, 836378535, 1189258569, 3499966129, 1508813406, 3957664108},
				A:   [7]uint32{1934061258, 2385545806, 1309564751, 1455923617, 2379990428, 3099881913, 1683168168},
				PC:  4454784,
				SR:  8196,
				USP: 10773596,
				SSP: 3376496,
				RAM: [][2]uint32{{4454776, 2}, {4454777, 60}, {4454778, 112}, {4454779, 237}, {4454780, 254}, {4454781, 196}, {4454782, 116}, {4454783, 146}},
				Cycles: 20,
			},
		},
		{
			name: "588 ANDItoCCR # 023c",
			init: 			cpuState{
				D:   [8]uint32{2880956303, 4233071790, 488517564, 2705365264, 122582420, 3009170185, 1614360343, 1503343936},
				A:   [7]uint32{4219890995, 1239712380, 2439044574, 3074411711, 4153663000, 127192578, 2579770304},
				PC:  734934,
				SR:  1796,
				USP: 4366662,
				SSP: 11790992,
				RAM: [][2]uint32{{734930, 2}, {734931, 60}, {734932, 163}, {734933, 10}, {734934, 209}, {734935, 113}, {734936, 190}, {734937, 185}},
			},
			want: 			cpuState{
				D:   [8]uint32{2880956303, 4233071790, 488517564, 2705365264, 122582420, 3009170185, 1614360343, 1503343936},
				A:   [7]uint32{4219890995, 1239712380, 2439044574, 3074411711, 4153663000, 127192578, 2579770304},
				PC:  734938,
				SR:  1792,
				USP: 4366662,
				SSP: 11790992,
				RAM: [][2]uint32{{734930, 2}, {734931, 60}, {734932, 163}, {734933, 10}, {734934, 209}, {734935, 113}, {734936, 190}, {734937, 185}},
				Cycles: 20,
			},
		},
		{
			name: "839 ANDItoCCR # 023c",
			init: 			cpuState{
				D:   [8]uint32{3936100089, 2031708784, 1108881291, 3825558639, 1720287392, 3262456688, 3715436075, 2769144584},
				A:   [7]uint32{1609084801, 3871991427, 193723348, 516997790, 1227651859, 1486364886, 2790783741},
				PC:  14100014,
				SR:  8713,
				USP: 10089946,
				SSP: 5234616,
				RAM: [][2]uint32{{14100010, 2}, {14100011, 60}, {14100012, 224}, {14100013, 70}, {14100014, 249}, {14100015, 59}, {14100016, 120}, {14100017, 194}},
			},
			want: 			cpuState{
				D:   [8]uint32{3936100089, 2031708784, 1108881291, 3825558639, 1720287392, 3262456688, 3715436075, 2769144584},
				A:   [7]uint32{1609084801, 3871991427, 193723348, 516997790, 1227651859, 1486364886, 2790783741},
				PC:  14100018,
				SR:  8704,
				USP: 10089946,
				SSP: 5234616,
				RAM: [][2]uint32{{14100010, 2}, {14100011, 60}, {14100012, 224}, {14100013, 70}, {14100014, 249}, {14100015, 59}, {14100016, 120}, {14100017, 194}},
				Cycles: 20,
			},
		},
		{
			name: "1134 ANDItoCCR # 023c",
			init: 			cpuState{
				D:   [8]uint32{3148907991, 2559803519, 315195332, 364490772, 3165014981, 814807719, 1785517700, 1232684535},
				A:   [7]uint32{3970745834, 3773663531, 3906204698, 1589180834, 3140495199, 105851764, 205234442},
				PC:  3327084,
				SR:  8971,
				USP: 1120084,
				SSP: 6057378,
				RAM: [][2]uint32{{3327080, 2}, {3327081, 60}, {3327082, 93}, {3327083, 123}, {3327084, 136}, {3327085, 128}, {3327086, 155}, {3327087, 72}},
			},
			want: 			cpuState{
				D:   [8]uint32{3148907991, 2559803519, 315195332, 364490772, 3165014981, 814807719, 1785517700, 1232684535},
				A:   [7]uint32{3970745834, 3773663531, 3906204698, 1589180834, 3140495199, 105851764, 205234442},
				PC:  3327088,
				SR:  8971,
				USP: 1120084,
				SSP: 6057378,
				RAM: [][2]uint32{{3327080, 2}, {3327081, 60}, {3327082, 93}, {3327083, 123}, {3327084, 136}, {3327085, 128}, {3327086, 155}, {3327087, 72}},
				Cycles: 20,
			},
		},
		{
			name: "1411 ANDItoCCR # 023c",
			init: 			cpuState{
				D:   [8]uint32{939952841, 2725281553, 2670270117, 2753982521, 4129884021, 469578558, 2986847014, 1599040218},
				A:   [7]uint32{936871350, 4068797195, 1903829822, 1992992481, 3681747066, 3234370763, 1018972228},
				PC:  12014236,
				SR:  9244,
				USP: 11745604,
				SSP: 12171828,
				RAM: [][2]uint32{{12014232, 2}, {12014233, 60}, {12014234, 91}, {12014235, 130}, {12014236, 249}, {12014237, 46}, {12014238, 231}, {12014239, 190}},
			},
			want: 			cpuState{
				D:   [8]uint32{939952841, 2725281553, 2670270117, 2753982521, 4129884021, 469578558, 2986847014, 1599040218},
				A:   [7]uint32{936871350, 4068797195, 1903829822, 1992992481, 3681747066, 3234370763, 1018972228},
				PC:  12014240,
				SR:  9216,
				USP: 11745604,
				SSP: 12171828,
				RAM: [][2]uint32{{12014232, 2}, {12014233, 60}, {12014234, 91}, {12014235, 130}, {12014236, 249}, {12014237, 46}, {12014238, 231}, {12014239, 190}},
				Cycles: 20,
			},
		},
		{
			name: "1657 ANDItoCCR # 023c",
			init: 			cpuState{
				D:   [8]uint32{197927907, 1574883078, 4143872839, 3880524397, 3565612293, 2901292362, 1373091268, 21422283},
				A:   [7]uint32{947151764, 1631140820, 3963396654, 2843713077, 3324790222, 2528241921, 1999062031},
				PC:  12177430,
				SR:  8198,
				USP: 9771498,
				SSP: 9274724,
				RAM: [][2]uint32{{12177426, 2}, {12177427, 60}, {12177428, 19}, {12177429, 63}, {12177430, 238}, {12177431, 126}, {12177432, 42}, {12177433, 230}},
			},
			want: 			cpuState{
				D:   [8]uint32{197927907, 1574883078, 4143872839, 3880524397, 3565612293, 2901292362, 1373091268, 21422283},
				A:   [7]uint32{947151764, 1631140820, 3963396654, 2843713077, 3324790222, 2528241921, 1999062031},
				PC:  12177434,
				SR:  8198,
				USP: 9771498,
				SSP: 9274724,
				RAM: [][2]uint32{{12177426, 2}, {12177427, 60}, {12177428, 19}, {12177429, 63}, {12177430, 238}, {12177431, 126}, {12177432, 42}, {12177433, 230}},
				Cycles: 20,
			},
		},
		{
			name: "1925 ANDItoCCR # 023c",
			init: 			cpuState{
				D:   [8]uint32{1777306591, 1667965262, 3980071424, 511397295, 1992303777, 411471319, 2456675962, 64544833},
				A:   [7]uint32{487105397, 3348621420, 3532834198, 284645953, 3347781602, 3111226749, 946715009},
				PC:  2946228,
				SR:  9495,
				USP: 9679274,
				SSP: 6162930,
				RAM: [][2]uint32{{2946224, 2}, {2946225, 60}, {2946226, 38}, {2946227, 160}, {2946228, 100}, {2946229, 53}, {2946230, 233}, {2946231, 207}},
			},
			want: 			cpuState{
				D:   [8]uint32{1777306591, 1667965262, 3980071424, 511397295, 1992303777, 411471319, 2456675962, 64544833},
				A:   [7]uint32{487105397, 3348621420, 3532834198, 284645953, 3347781602, 3111226749, 946715009},
				PC:  2946232,
				SR:  9472,
				USP: 9679274,
				SSP: 6162930,
				RAM: [][2]uint32{{2946224, 2}, {2946225, 60}, {2946226, 38}, {2946227, 160}, {2946228, 100}, {2946229, 53}, {2946230, 233}, {2946231, 207}},
				Cycles: 20,
			},
		},
		{
			name: "2235 ANDItoCCR # 023c",
			init: 			cpuState{
				D:   [8]uint32{2775268089, 1371598679, 2492417003, 2340838193, 3791828591, 2636300370, 3863959427, 1979164098},
				A:   [7]uint32{701402585, 2168120710, 347555158, 1825367655, 2254739412, 2729293278, 3171851759},
				PC:  14396770,
				SR:  9744,
				USP: 4921430,
				SSP: 8614070,
				RAM: [][2]uint32{{14396766, 2}, {14396767, 60}, {14396768, 227}, {14396769, 170}, {14396770, 203}, {14396771, 45}, {14396772, 208}, {14396773, 116}},
			},
			want: 			cpuState{
				D:   [8]uint32{2775268089, 1371598679, 2492417003, 2340838193, 3791828591, 2636300370, 3863959427, 1979164098},
				A:   [7]uint32{701402585, 2168120710, 347555158, 1825367655, 2254739412, 2729293278, 3171851759},
				PC:  14396774,
				SR:  9728,
				USP: 4921430,
				SSP: 8614070,
				RAM: [][2]uint32{{14396766, 2}, {14396767, 60}, {14396768, 227}, {14396769, 170}, {14396770, 203}, {14396771, 45}, {14396772, 208}, {14396773, 116}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestANDItoSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{3459640781, 2161107310, 3673851381, 3966350034, 2658482892, 1746938383, 2698685285, 2763380764},
				A:   [7]uint32{2711838278, 4003804690, 3679479255, 3317997971, 1284187404, 4227771087, 3303715211},
				PC:  12215154,
				SR:  8217,
				USP: 13069110,
				SSP: 14468942,
				RAM: [][2]uint32{{12215150, 2}, {12215151, 124}, {12215152, 150}, {12215153, 135}, {12215154, 112}, {12215155, 55}, {12215156, 13}, {12215157, 212}},
			},
			want: cpuState{
				D:   [8]uint32{3459640781, 2161107310, 3673851381, 3966350034, 2658482892, 1746938383, 2698685285, 2763380764},
				A:   [7]uint32{2711838278, 4003804690, 3679479255, 3317997971, 1284187404, 4227771087, 3303715211},
				PC:  12215158,
				SR:  1,
				USP: 13069110,
				SSP: 14468942,
				RAM: [][2]uint32{{12215150, 2}, {12215151, 124}, {12215152, 150}, {12215153, 135}, {12215154, 112}, {12215155, 55}, {12215156, 13}, {12215157, 212}},
				Cycles: 20,
			},
		},
		{
			name: "500 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{714014076, 1382126148, 111899679, 444189039, 1612236006, 1401559108, 2974421732, 1685058078},
				A:   [7]uint32{3529313924, 4294150406, 3920337185, 414327992, 1389913282, 1298950257, 2560960595},
				PC:  4216426,
				SR:  8730,
				USP: 14117970,
				SSP: 5236638,
				RAM: [][2]uint32{{4216422, 2}, {4216423, 124}, {4216424, 91}, {4216425, 221}, {4216426, 219}, {4216427, 253}, {4216428, 60}, {4216429, 159}},
			},
			want: cpuState{
				D:   [8]uint32{714014076, 1382126148, 111899679, 444189039, 1612236006, 1401559108, 2974421732, 1685058078},
				A:   [7]uint32{3529313924, 4294150406, 3920337185, 414327992, 1389913282, 1298950257, 2560960595},
				PC:  4216430,
				SR:  536,
				USP: 14117970,
				SSP: 5236638,
				RAM: [][2]uint32{{4216422, 2}, {4216423, 124}, {4216424, 91}, {4216425, 221}, {4216426, 219}, {4216427, 253}, {4216428, 60}, {4216429, 159}},
				Cycles: 20,
			},
		},
		{
			name: "1000 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{3935066449, 3872404793, 2790397436, 3562431692, 2104790016, 198821825, 2371777081, 3133272606},
				A:   [7]uint32{1959783231, 3170665128, 1412868837, 3992449638, 91722344, 616347876, 837839017},
				PC:  10430008,
				SR:  42250,
				USP: 12437892,
				SSP: 3859694,
				RAM: [][2]uint32{{10430004, 2}, {10430005, 124}, {10430006, 95}, {10430007, 106}, {10430008, 49}, {10430009, 105}, {10430010, 220}, {10430011, 118}},
			},
			want: cpuState{
				D:   [8]uint32{3935066449, 3872404793, 2790397436, 3562431692, 2104790016, 198821825, 2371777081, 3133272606},
				A:   [7]uint32{1959783231, 3170665128, 1412868837, 3992449638, 91722344, 616347876, 837839017},
				PC:  10430012,
				SR:  1290,
				USP: 12437892,
				SSP: 3859694,
				RAM: [][2]uint32{{10430004, 2}, {10430005, 124}, {10430006, 95}, {10430007, 106}, {10430008, 49}, {10430009, 105}, {10430010, 220}, {10430011, 118}},
				Cycles: 20,
			},
		},
		{
			name: "1500 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{3094463805, 3686981744, 2965928281, 1683623908, 1546971795, 867516037, 1299473818, 1953913437},
				A:   [7]uint32{2682908306, 2636861669, 3248581234, 2057777741, 2142976044, 3292800176, 4185573784},
				PC:  2964658,
				SR:  41987,
				USP: 5027152,
				SSP: 9762996,
				RAM: [][2]uint32{{2964654, 2}, {2964655, 124}, {2964656, 113}, {2964657, 251}, {2964658, 200}, {2964659, 208}, {2964660, 147}, {2964661, 190}},
			},
			want: cpuState{
				D:   [8]uint32{3094463805, 3686981744, 2965928281, 1683623908, 1546971795, 867516037, 1299473818, 1953913437},
				A:   [7]uint32{2682908306, 2636861669, 3248581234, 2057777741, 2142976044, 3292800176, 4185573784},
				PC:  2964662,
				SR:  8195,
				USP: 5027152,
				SSP: 9762996,
				RAM: [][2]uint32{{2964654, 2}, {2964655, 124}, {2964656, 113}, {2964657, 251}, {2964658, 200}, {2964659, 208}, {2964660, 147}, {2964661, 190}},
				Cycles: 20,
			},
		},
		{
			name: "2000 ANDItoSR # 027c",
			init: cpuState{
				D:   [8]uint32{1324839251, 33861968, 1149944653, 171477786, 662778086, 511730785, 4079270999, 1319458689},
				A:   [7]uint32{2509047096, 709529370, 714699047, 3078534255, 4069622478, 3131152765, 2527322859},
				PC:  4865010,
				SR:  42765,
				USP: 14276454,
				SSP: 7954590,
				RAM: [][2]uint32{{4865006, 2}, {4865007, 124}, {4865008, 214}, {4865009, 55}, {4865010, 70}, {4865011, 17}, {4865012, 37}, {4865013, 138}},
			},
			want: cpuState{
				D:   [8]uint32{1324839251, 33861968, 1149944653, 171477786, 662778086, 511730785, 4079270999, 1319458689},
				A:   [7]uint32{2509047096, 709529370, 714699047, 3078534255, 4069622478, 3131152765, 2527322859},
				PC:  4865014,
				SR:  34309,
				USP: 14276454,
				SSP: 7954590,
				RAM: [][2]uint32{{4865006, 2}, {4865007, 124}, {4865008, 214}, {4865009, 55}, {4865010, 70}, {4865011, 17}, {4865012, 37}, {4865013, 138}},
				Cycles: 20,
			},
		},
		{
			name: "001 ANDItoSR # 027c",
			init: 			cpuState{
				D:   [8]uint32{2262758750, 474327750, 511225610, 3637859866, 2996867376, 250036444, 1831497707, 2437193853},
				A:   [7]uint32{2138481075, 3609010918, 578441222, 3303413807, 881544620, 3300536641, 343910898},
				PC:  8276314,
				SR:  8199,
				USP: 11455624,
				SSP: 3757920,
				RAM: [][2]uint32{{8276310, 2}, {8276311, 124}, {8276312, 31}, {8276313, 33}, {8276314, 95}, {8276315, 102}, {8276316, 193}, {8276317, 132}},
			},
			want: 			cpuState{
				D:   [8]uint32{2262758750, 474327750, 511225610, 3637859866, 2996867376, 250036444, 1831497707, 2437193853},
				A:   [7]uint32{2138481075, 3609010918, 578441222, 3303413807, 881544620, 3300536641, 343910898},
				PC:  8276318,
				SR:  1,
				USP: 11455624,
				SSP: 3757920,
				RAM: [][2]uint32{{8276310, 2}, {8276311, 124}, {8276312, 31}, {8276313, 33}, {8276314, 95}, {8276315, 102}, {8276316, 193}, {8276317, 132}},
				Cycles: 20,
			},
		},
		{
			name: "277 ANDItoSR # 027c",
			init: 			cpuState{
				D:   [8]uint32{4208241962, 2968487196, 1184618416, 3890926525, 3317906426, 764076583, 1411118180, 299081239},
				A:   [7]uint32{1605231045, 4110941283, 863028022, 2941104473, 2846371092, 290109849, 824230822},
				PC:  1903272,
				SR:  522,
				USP: 16028258,
				SSP: 3937936,
				RAM: [][2]uint32{{1903268, 2}, {1903269, 124}, {1903270, 77}, {1903271, 249}, {32, 34}, {33, 84}, {34, 124}, {35, 96}, {5536864, 136}, {5536865, 171}, {5536866, 238}, {5536867, 169}},
			},
			want: 			cpuState{
				D:   [8]uint32{4208241962, 2968487196, 1184618416, 3890926525, 3317906426, 764076583, 1411118180, 299081239},
				A:   [7]uint32{1605231045, 4110941283, 863028022, 2941104473, 2846371092, 290109849, 824230822},
				PC:  575962212,
				SR:  8714,
				USP: 16028258,
				SSP: 3937930,
				RAM: [][2]uint32{{1903268, 2}, {1903269, 124}, {1903270, 77}, {1903271, 249}, {3937934, 10}, {3937935, 164}, {3937930, 2}, {3937931, 10}, {3937932, 0}, {3937933, 29}, {32, 34}, {33, 84}, {34, 124}, {35, 96}, {5536864, 136}, {5536865, 171}, {5536866, 238}, {5536867, 169}},
				Cycles: 34,
			},
		},
		{
			name: "543 ANDItoSR # 027c",
			init: 			cpuState{
				D:   [8]uint32{2446495887, 3910589892, 2656015522, 3469003998, 2688023241, 2091478044, 4128734186, 4189819861},
				A:   [7]uint32{458117179, 3520851320, 1286080359, 3433416361, 1378046755, 4138882668, 231272077},
				PC:  11047274,
				SR:  9478,
				USP: 5124682,
				SSP: 10381416,
				RAM: [][2]uint32{{11047270, 2}, {11047271, 124}, {11047272, 23}, {11047273, 78}, {11047274, 81}, {11047275, 171}, {11047276, 188}, {11047277, 37}},
			},
			want: 			cpuState{
				D:   [8]uint32{2446495887, 3910589892, 2656015522, 3469003998, 2688023241, 2091478044, 4128734186, 4189819861},
				A:   [7]uint32{458117179, 3520851320, 1286080359, 3433416361, 1378046755, 4138882668, 231272077},
				PC:  11047278,
				SR:  1286,
				USP: 5124682,
				SSP: 10381416,
				RAM: [][2]uint32{{11047270, 2}, {11047271, 124}, {11047272, 23}, {11047273, 78}, {11047274, 81}, {11047275, 171}, {11047276, 188}, {11047277, 37}},
				Cycles: 20,
			},
		},
		{
			name: "805 ANDItoSR # 027c",
			init: 			cpuState{
				D:   [8]uint32{1207453894, 1775755070, 2272392529, 2625988976, 1531651579, 2499703127, 2071310793, 3065115247},
				A:   [7]uint32{1364844701, 680800403, 1384725035, 3909762877, 2968291753, 1703992291, 2591475405},
				PC:  6480990,
				SR:  536,
				USP: 16712258,
				SSP: 8405952,
				RAM: [][2]uint32{{6480986, 2}, {6480987, 124}, {6480988, 208}, {6480989, 108}, {32, 251}, {33, 174}, {34, 16}, {35, 142}, {11407502, 187}, {11407503, 191}, {11407504, 157}, {11407505, 20}},
			},
			want: 			cpuState{
				D:   [8]uint32{1207453894, 1775755070, 2272392529, 2625988976, 1531651579, 2499703127, 2071310793, 3065115247},
				A:   [7]uint32{1364844701, 680800403, 1384725035, 3909762877, 2968291753, 1703992291, 2591475405},
				PC:  4222488722,
				SR:  8728,
				USP: 16712258,
				SSP: 8405946,
				RAM: [][2]uint32{{6480986, 2}, {6480987, 124}, {6480988, 208}, {6480989, 108}, {8405950, 228}, {8405951, 90}, {8405946, 2}, {8405947, 24}, {8405948, 0}, {8405949, 98}, {32, 251}, {33, 174}, {34, 16}, {35, 142}, {11407502, 187}, {11407503, 191}, {11407504, 157}, {11407505, 20}},
				Cycles: 34,
			},
		},
		{
			name: "1092 ANDItoSR # 027c",
			init: 			cpuState{
				D:   [8]uint32{3704175802, 3377237531, 1386812939, 825651900, 633298999, 1177208659, 1628890386, 3280030452},
				A:   [7]uint32{3086080317, 3483992065, 1614529533, 2016016399, 975327203, 1310816816, 18567944},
				PC:  15745862,
				SR:  8199,
				USP: 505384,
				SSP: 11717450,
				RAM: [][2]uint32{{15745858, 2}, {15745859, 124}, {15745860, 151}, {15745861, 229}, {15745862, 79}, {15745863, 178}, {15745864, 133}, {15745865, 107}},
			},
			want: 			cpuState{
				D:   [8]uint32{3704175802, 3377237531, 1386812939, 825651900, 633298999, 1177208659, 1628890386, 3280030452},
				A:   [7]uint32{3086080317, 3483992065, 1614529533, 2016016399, 975327203, 1310816816, 18567944},
				PC:  15745866,
				SR:  5,
				USP: 505384,
				SSP: 11717450,
				RAM: [][2]uint32{{15745858, 2}, {15745859, 124}, {15745860, 151}, {15745861, 229}, {15745862, 79}, {15745863, 178}, {15745864, 133}, {15745865, 107}},
				Cycles: 20,
			},
		},
		{
			name: "1381 ANDItoSR # 027c",
			init: 			cpuState{
				D:   [8]uint32{3512990843, 1492303619, 2080808692, 2118627443, 2886667377, 1399101260, 3393635079, 1211969296},
				A:   [7]uint32{1873141170, 1455613985, 901515886, 2174565724, 202400695, 3741847189, 2215366169},
				PC:  10449594,
				SR:  9478,
				USP: 15992976,
				SSP: 999072,
				RAM: [][2]uint32{{10449590, 2}, {10449591, 124}, {10449592, 200}, {10449593, 62}, {10449594, 59}, {10449595, 247}, {10449596, 218}, {10449597, 73}},
			},
			want: 			cpuState{
				D:   [8]uint32{3512990843, 1492303619, 2080808692, 2118627443, 2886667377, 1399101260, 3393635079, 1211969296},
				A:   [7]uint32{1873141170, 1455613985, 901515886, 2174565724, 202400695, 3741847189, 2215366169},
				PC:  10449598,
				SR:  6,
				USP: 15992976,
				SSP: 999072,
				RAM: [][2]uint32{{10449590, 2}, {10449591, 124}, {10449592, 200}, {10449593, 62}, {10449594, 59}, {10449595, 247}, {10449596, 218}, {10449597, 73}},
				Cycles: 20,
			},
		},
		{
			name: "1674 ANDItoSR # 027c",
			init: 			cpuState{
				D:   [8]uint32{2685161220, 3233497893, 2467618681, 4229662824, 3621489489, 1620336438, 1877003573, 1620942044},
				A:   [7]uint32{501814957, 2965500687, 4143283879, 4210662108, 2062627021, 3686585168, 4070321237},
				PC:  10667152,
				SR:  793,
				USP: 4891770,
				SSP: 8348840,
				RAM: [][2]uint32{{10667148, 2}, {10667149, 124}, {10667150, 65}, {10667151, 254}, {32, 95}, {33, 52}, {34, 121}, {35, 252}, {3439100, 46}, {3439101, 10}, {3439102, 103}, {3439103, 192}},
			},
			want: 			cpuState{
				D:   [8]uint32{2685161220, 3233497893, 2467618681, 4229662824, 3621489489, 1620336438, 1877003573, 1620942044},
				A:   [7]uint32{501814957, 2965500687, 4143283879, 4210662108, 2062627021, 3686585168, 4070321237},
				PC:  1597274624,
				SR:  8985,
				USP: 4891770,
				SSP: 8348834,
				RAM: [][2]uint32{{10667148, 2}, {10667149, 124}, {10667150, 65}, {10667151, 254}, {8348838, 196}, {8348839, 140}, {8348834, 3}, {8348835, 25}, {8348836, 0}, {8348837, 162}, {32, 95}, {33, 52}, {34, 121}, {35, 252}, {3439100, 46}, {3439101, 10}, {3439102, 103}, {3439103, 192}},
				Cycles: 34,
			},
		},
		{
			name: "1925 ANDItoSR # 027c",
			init: 			cpuState{
				D:   [8]uint32{1749551400, 1726326501, 2097096186, 687406350, 1711304109, 3463023964, 312748172, 1183690949},
				A:   [7]uint32{2335493649, 682811817, 3276926620, 3890974876, 1282776408, 2964798259, 927595516},
				PC:  1525930,
				SR:  1561,
				USP: 15728536,
				SSP: 12047458,
				RAM: [][2]uint32{{1525926, 2}, {1525927, 124}, {1525928, 222}, {1525929, 154}, {32, 96}, {33, 62}, {34, 132}, {35, 150}, {4097174, 126}, {4097175, 78}, {4097176, 94}, {4097177, 130}},
			},
			want: 			cpuState{
				D:   [8]uint32{1749551400, 1726326501, 2097096186, 687406350, 1711304109, 3463023964, 312748172, 1183690949},
				A:   [7]uint32{2335493649, 682811817, 3276926620, 3890974876, 1282776408, 2964798259, 927595516},
				PC:  1614709914,
				SR:  9753,
				USP: 15728536,
				SSP: 12047452,
				RAM: [][2]uint32{{1525926, 2}, {1525927, 124}, {1525928, 222}, {1525929, 154}, {12047456, 72}, {12047457, 166}, {12047452, 6}, {12047453, 25}, {12047454, 0}, {12047455, 23}, {32, 96}, {33, 62}, {34, 132}, {35, 150}, {4097174, 126}, {4097175, 78}, {4097176, 94}, {4097177, 130}},
				Cycles: 34,
			},
		},
		{
			name: "2196 ANDItoSR # 027c",
			init: 			cpuState{
				D:   [8]uint32{1331649075, 4180312958, 3110059492, 347379060, 525193426, 1691791738, 2391129943, 885466728},
				A:   [7]uint32{2484209072, 3407773022, 3312254709, 192109229, 1933526807, 3515661594, 3267598169},
				PC:  10129114,
				SR:  9217,
				USP: 4431886,
				SSP: 409048,
				RAM: [][2]uint32{{10129110, 2}, {10129111, 124}, {10129112, 3}, {10129113, 235}, {10129114, 77}, {10129115, 126}, {10129116, 61}, {10129117, 24}},
			},
			want: 			cpuState{
				D:   [8]uint32{1331649075, 4180312958, 3110059492, 347379060, 525193426, 1691791738, 2391129943, 885466728},
				A:   [7]uint32{2484209072, 3407773022, 3312254709, 192109229, 1933526807, 3515661594, 3267598169},
				PC:  10129118,
				SR:  1,
				USP: 4431886,
				SSP: 409048,
				RAM: [][2]uint32{{10129110, 2}, {10129111, 124}, {10129112, 3}, {10129113, 235}, {10129114, 77}, {10129115, 126}, {10129116, 61}, {10129117, 24}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestORItoCCR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{3542872148, 544413609, 1317562079, 551499346, 950627486, 3896915218, 3436502336, 2530072704},
				A:   [7]uint32{571182691, 4072612502, 2302579413, 778573855, 3676664038, 1509906265, 3985785766},
				PC:  3404298,
				SR:  34304,
				USP: 15915922,
				SSP: 13564828,
				RAM: [][2]uint32{{3404294, 0}, {3404295, 60}, {3404296, 84}, {3404297, 131}, {3404298, 83}, {3404299, 198}, {3404300, 59}, {3404301, 70}},
			},
			want: cpuState{
				D:   [8]uint32{3542872148, 544413609, 1317562079, 551499346, 950627486, 3896915218, 3436502336, 2530072704},
				A:   [7]uint32{571182691, 4072612502, 2302579413, 778573855, 3676664038, 1509906265, 3985785766},
				PC:  3404302,
				SR:  34307,
				USP: 15915922,
				SSP: 13564828,
				RAM: [][2]uint32{{3404294, 0}, {3404295, 60}, {3404296, 84}, {3404297, 131}, {3404298, 83}, {3404299, 198}, {3404300, 59}, {3404301, 70}},
				Cycles: 20,
			},
		},
		{
			name: "500 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{884058314, 973040952, 1601427688, 2254056162, 3885609021, 1072937697, 2619293114, 1621708156},
				A:   [7]uint32{3053862269, 1895877093, 1985797422, 3190960611, 2201878251, 3755800734, 1811674399},
				PC:  3039204,
				SR:  15,
				USP: 5550852,
				SSP: 8264636,
				RAM: [][2]uint32{{3039200, 0}, {3039201, 60}, {3039202, 60}, {3039203, 161}, {3039204, 224}, {3039205, 245}, {3039206, 223}, {3039207, 199}},
			},
			want: cpuState{
				D:   [8]uint32{884058314, 973040952, 1601427688, 2254056162, 3885609021, 1072937697, 2619293114, 1621708156},
				A:   [7]uint32{3053862269, 1895877093, 1985797422, 3190960611, 2201878251, 3755800734, 1811674399},
				PC:  3039208,
				SR:  15,
				USP: 5550852,
				SSP: 8264636,
				RAM: [][2]uint32{{3039200, 0}, {3039201, 60}, {3039202, 60}, {3039203, 161}, {3039204, 224}, {3039205, 245}, {3039206, 223}, {3039207, 199}},
				Cycles: 20,
			},
		},
		{
			name: "1000 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{2797498413, 2066311242, 2303955841, 1562167423, 3362563945, 4181131441, 1532713819, 3352466183},
				A:   [7]uint32{3145313735, 3587802102, 4229171104, 1395740882, 2771540999, 971998958, 3846782843},
				PC:  1920400,
				SR:  8717,
				USP: 14150354,
				SSP: 13228146,
				RAM: [][2]uint32{{1920396, 0}, {1920397, 60}, {1920398, 126}, {1920399, 151}, {1920400, 103}, {1920401, 159}, {1920402, 188}, {1920403, 157}},
			},
			want: cpuState{
				D:   [8]uint32{2797498413, 2066311242, 2303955841, 1562167423, 3362563945, 4181131441, 1532713819, 3352466183},
				A:   [7]uint32{3145313735, 3587802102, 4229171104, 1395740882, 2771540999, 971998958, 3846782843},
				PC:  1920404,
				SR:  8735,
				USP: 14150354,
				SSP: 13228146,
				RAM: [][2]uint32{{1920396, 0}, {1920397, 60}, {1920398, 126}, {1920399, 151}, {1920400, 103}, {1920401, 159}, {1920402, 188}, {1920403, 157}},
				Cycles: 20,
			},
		},
		{
			name: "1500 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{1360090052, 2083171423, 454538824, 1790806911, 606402259, 3278317315, 2539857203, 1013968003},
				A:   [7]uint32{2448902965, 2417918143, 2852608161, 1515876372, 3309719249, 2709563702, 1798203392},
				PC:  1680946,
				SR:  42260,
				USP: 8665760,
				SSP: 15454702,
				RAM: [][2]uint32{{1680942, 0}, {1680943, 60}, {1680944, 216}, {1680945, 159}, {1680946, 181}, {1680947, 34}, {1680948, 94}, {1680949, 10}},
			},
			want: cpuState{
				D:   [8]uint32{1360090052, 2083171423, 454538824, 1790806911, 606402259, 3278317315, 2539857203, 1013968003},
				A:   [7]uint32{2448902965, 2417918143, 2852608161, 1515876372, 3309719249, 2709563702, 1798203392},
				PC:  1680950,
				SR:  42271,
				USP: 8665760,
				SSP: 15454702,
				RAM: [][2]uint32{{1680942, 0}, {1680943, 60}, {1680944, 216}, {1680945, 159}, {1680946, 181}, {1680947, 34}, {1680948, 94}, {1680949, 10}},
				Cycles: 20,
			},
		},
		{
			name: "2000 ORItoCCR # 003c",
			init: cpuState{
				D:   [8]uint32{2617415649, 2954850949, 4173116780, 3010631063, 1295423765, 2693460691, 1329508826, 2358737820},
				A:   [7]uint32{1166943799, 274410818, 376070139, 593733769, 4282115851, 2419780594, 1611158113},
				PC:  9557374,
				SR:  8717,
				USP: 2280478,
				SSP: 13465180,
				RAM: [][2]uint32{{9557370, 0}, {9557371, 60}, {9557372, 39}, {9557373, 92}, {9557374, 84}, {9557375, 41}, {9557376, 158}, {9557377, 171}},
			},
			want: cpuState{
				D:   [8]uint32{2617415649, 2954850949, 4173116780, 3010631063, 1295423765, 2693460691, 1329508826, 2358737820},
				A:   [7]uint32{1166943799, 274410818, 376070139, 593733769, 4282115851, 2419780594, 1611158113},
				PC:  9557378,
				SR:  8733,
				USP: 2280478,
				SSP: 13465180,
				RAM: [][2]uint32{{9557370, 0}, {9557371, 60}, {9557372, 39}, {9557373, 92}, {9557374, 84}, {9557375, 41}, {9557376, 158}, {9557377, 171}},
				Cycles: 20,
			},
		},
		{
			name: "001 ORItoCCR # 003c",
			init: 			cpuState{
				D:   [8]uint32{813989529, 1922121599, 3892094965, 3908130884, 1270938756, 2411381201, 1836644543, 185857402},
				A:   [7]uint32{2859511906, 2139800136, 3385765143, 2672520553, 2436461521, 424441813, 523502208},
				PC:  12651572,
				SR:  781,
				USP: 8175780,
				SSP: 14613290,
				RAM: [][2]uint32{{12651568, 0}, {12651569, 60}, {12651570, 18}, {12651571, 45}, {12651572, 35}, {12651573, 36}, {12651574, 197}, {12651575, 199}},
			},
			want: 			cpuState{
				D:   [8]uint32{813989529, 1922121599, 3892094965, 3908130884, 1270938756, 2411381201, 1836644543, 185857402},
				A:   [7]uint32{2859511906, 2139800136, 3385765143, 2672520553, 2436461521, 424441813, 523502208},
				PC:  12651576,
				SR:  781,
				USP: 8175780,
				SSP: 14613290,
				RAM: [][2]uint32{{12651568, 0}, {12651569, 60}, {12651570, 18}, {12651571, 45}, {12651572, 35}, {12651573, 36}, {12651574, 197}, {12651575, 199}},
				Cycles: 20,
			},
		},
		{
			name: "276 ORItoCCR # 003c",
			init: 			cpuState{
				D:   [8]uint32{3773679736, 2322010752, 436313511, 1884879574, 1285090336, 1348875643, 207443608, 2391499962},
				A:   [7]uint32{1091775421, 1989543835, 3767571966, 595590287, 3969688256, 1533077671, 2708489885},
				PC:  13094516,
				SR:  265,
				USP: 1200320,
				SSP: 4998120,
				RAM: [][2]uint32{{13094512, 0}, {13094513, 60}, {13094514, 18}, {13094515, 162}, {13094516, 220}, {13094517, 249}, {13094518, 180}, {13094519, 153}},
			},
			want: 			cpuState{
				D:   [8]uint32{3773679736, 2322010752, 436313511, 1884879574, 1285090336, 1348875643, 207443608, 2391499962},
				A:   [7]uint32{1091775421, 1989543835, 3767571966, 595590287, 3969688256, 1533077671, 2708489885},
				PC:  13094520,
				SR:  267,
				USP: 1200320,
				SSP: 4998120,
				RAM: [][2]uint32{{13094512, 0}, {13094513, 60}, {13094514, 18}, {13094515, 162}, {13094516, 220}, {13094517, 249}, {13094518, 180}, {13094519, 153}},
				Cycles: 20,
			},
		},
		{
			name: "568 ORItoCCR # 003c",
			init: 			cpuState{
				D:   [8]uint32{4209178535, 2018888966, 511473015, 1622213270, 954700540, 564804064, 3019155331, 2498806482},
				A:   [7]uint32{3715458486, 1384806397, 2475468201, 4109641594, 523212170, 1423165126, 2620062191},
				PC:  7640832,
				SR:  8728,
				USP: 13272966,
				SSP: 5972668,
				RAM: [][2]uint32{{7640828, 0}, {7640829, 60}, {7640830, 13}, {7640831, 157}, {7640832, 100}, {7640833, 158}, {7640834, 72}, {7640835, 116}},
			},
			want: 			cpuState{
				D:   [8]uint32{4209178535, 2018888966, 511473015, 1622213270, 954700540, 564804064, 3019155331, 2498806482},
				A:   [7]uint32{3715458486, 1384806397, 2475468201, 4109641594, 523212170, 1423165126, 2620062191},
				PC:  7640836,
				SR:  8733,
				USP: 13272966,
				SSP: 5972668,
				RAM: [][2]uint32{{7640828, 0}, {7640829, 60}, {7640830, 13}, {7640831, 157}, {7640832, 100}, {7640833, 158}, {7640834, 72}, {7640835, 116}},
				Cycles: 20,
			},
		},
		{
			name: "860 ORItoCCR # 003c",
			init: 			cpuState{
				D:   [8]uint32{3940552889, 413226812, 1197171635, 1578859340, 4238851721, 4142356003, 2093826728, 1213636393},
				A:   [7]uint32{3278115855, 2884251896, 2802699049, 1102264388, 1498415876, 1555241866, 737557595},
				PC:  4976782,
				SR:  1033,
				USP: 3780244,
				SSP: 8443840,
				RAM: [][2]uint32{{4976778, 0}, {4976779, 60}, {4976780, 127}, {4976781, 245}, {4976782, 30}, {4976783, 218}, {4976784, 6}, {4976785, 162}},
			},
			want: 			cpuState{
				D:   [8]uint32{3940552889, 413226812, 1197171635, 1578859340, 4238851721, 4142356003, 2093826728, 1213636393},
				A:   [7]uint32{3278115855, 2884251896, 2802699049, 1102264388, 1498415876, 1555241866, 737557595},
				PC:  4976786,
				SR:  1053,
				USP: 3780244,
				SSP: 8443840,
				RAM: [][2]uint32{{4976778, 0}, {4976779, 60}, {4976780, 127}, {4976781, 245}, {4976782, 30}, {4976783, 218}, {4976784, 6}, {4976785, 162}},
				Cycles: 20,
			},
		},
		{
			name: "1136 ORItoCCR # 003c",
			init: 			cpuState{
				D:   [8]uint32{64554124, 2907800405, 909490335, 377216446, 4055262286, 735385295, 3435320492, 2010274124},
				A:   [7]uint32{96769156, 2610152015, 3842087687, 532469125, 939940751, 4144069635, 4291031821},
				PC:  5651878,
				SR:  9728,
				USP: 10871480,
				SSP: 8513320,
				RAM: [][2]uint32{{5651874, 0}, {5651875, 60}, {5651876, 205}, {5651877, 83}, {5651878, 101}, {5651879, 188}, {5651880, 128}, {5651881, 43}},
			},
			want: 			cpuState{
				D:   [8]uint32{64554124, 2907800405, 909490335, 377216446, 4055262286, 735385295, 3435320492, 2010274124},
				A:   [7]uint32{96769156, 2610152015, 3842087687, 532469125, 939940751, 4144069635, 4291031821},
				PC:  5651882,
				SR:  9747,
				USP: 10871480,
				SSP: 8513320,
				RAM: [][2]uint32{{5651874, 0}, {5651875, 60}, {5651876, 205}, {5651877, 83}, {5651878, 101}, {5651879, 188}, {5651880, 128}, {5651881, 43}},
				Cycles: 20,
			},
		},
		{
			name: "1417 ORItoCCR # 003c",
			init: 			cpuState{
				D:   [8]uint32{303444445, 3728044040, 2597023530, 3099950785, 4110201182, 1181137165, 4041099222, 499519390},
				A:   [7]uint32{1739732232, 3407601042, 1637664729, 978425729, 2933264505, 812306033, 2417887294},
				PC:  7694860,
				SR:  8449,
				USP: 11119576,
				SSP: 3366176,
				RAM: [][2]uint32{{7694856, 0}, {7694857, 60}, {7694858, 190}, {7694859, 120}, {7694860, 239}, {7694861, 199}, {7694862, 122}, {7694863, 194}},
			},
			want: 			cpuState{
				D:   [8]uint32{303444445, 3728044040, 2597023530, 3099950785, 4110201182, 1181137165, 4041099222, 499519390},
				A:   [7]uint32{1739732232, 3407601042, 1637664729, 978425729, 2933264505, 812306033, 2417887294},
				PC:  7694864,
				SR:  8473,
				USP: 11119576,
				SSP: 3366176,
				RAM: [][2]uint32{{7694856, 0}, {7694857, 60}, {7694858, 190}, {7694859, 120}, {7694860, 239}, {7694861, 199}, {7694862, 122}, {7694863, 194}},
				Cycles: 20,
			},
		},
		{
			name: "1678 ORItoCCR # 003c",
			init: 			cpuState{
				D:   [8]uint32{929287357, 127120477, 4268466481, 1924285265, 3243264238, 2949741707, 1593073679, 3265571508},
				A:   [7]uint32{1941704986, 1752464851, 193766079, 855659821, 4008385129, 422890769, 4238645862},
				PC:  9809056,
				SR:  1801,
				USP: 15115940,
				SSP: 12619192,
				RAM: [][2]uint32{{9809052, 0}, {9809053, 60}, {9809054, 130}, {9809055, 166}, {9809056, 138}, {9809057, 75}, {9809058, 131}, {9809059, 180}},
			},
			want: 			cpuState{
				D:   [8]uint32{929287357, 127120477, 4268466481, 1924285265, 3243264238, 2949741707, 1593073679, 3265571508},
				A:   [7]uint32{1941704986, 1752464851, 193766079, 855659821, 4008385129, 422890769, 4238645862},
				PC:  9809060,
				SR:  1807,
				USP: 15115940,
				SSP: 12619192,
				RAM: [][2]uint32{{9809052, 0}, {9809053, 60}, {9809054, 130}, {9809055, 166}, {9809056, 138}, {9809057, 75}, {9809058, 131}, {9809059, 180}},
				Cycles: 20,
			},
		},
		{
			name: "1953 ORItoCCR # 003c",
			init: 			cpuState{
				D:   [8]uint32{3148903795, 453459449, 1492912924, 2226266159, 249160206, 1324465491, 13485087, 2102918814},
				A:   [7]uint32{828335915, 2124221912, 1726118067, 2000800771, 3473641846, 1490578786, 2723539269},
				PC:  4262718,
				SR:  8201,
				USP: 1044732,
				SSP: 15501198,
				RAM: [][2]uint32{{4262714, 0}, {4262715, 60}, {4262716, 28}, {4262717, 247}, {4262718, 235}, {4262719, 245}, {4262720, 92}, {4262721, 221}},
			},
			want: 			cpuState{
				D:   [8]uint32{3148903795, 453459449, 1492912924, 2226266159, 249160206, 1324465491, 13485087, 2102918814},
				A:   [7]uint32{828335915, 2124221912, 1726118067, 2000800771, 3473641846, 1490578786, 2723539269},
				PC:  4262722,
				SR:  8223,
				USP: 1044732,
				SSP: 15501198,
				RAM: [][2]uint32{{4262714, 0}, {4262715, 60}, {4262716, 28}, {4262717, 247}, {4262718, 235}, {4262719, 245}, {4262720, 92}, {4262721, 221}},
				Cycles: 20,
			},
		},
		{
			name: "2214 ORItoCCR # 003c",
			init: 			cpuState{
				D:   [8]uint32{2370716752, 1118665524, 1900169312, 825563474, 3407651948, 3746332956, 4160426490, 2648525291},
				A:   [7]uint32{3665252450, 2259868572, 2680775662, 1453252321, 866076910, 3543490127, 3124469760},
				PC:  876628,
				SR:  9495,
				USP: 1724080,
				SSP: 13569888,
				RAM: [][2]uint32{{876624, 0}, {876625, 60}, {876626, 65}, {876627, 38}, {876628, 101}, {876629, 29}, {876630, 128}, {876631, 104}},
			},
			want: 			cpuState{
				D:   [8]uint32{2370716752, 1118665524, 1900169312, 825563474, 3407651948, 3746332956, 4160426490, 2648525291},
				A:   [7]uint32{3665252450, 2259868572, 2680775662, 1453252321, 866076910, 3543490127, 3124469760},
				PC:  876632,
				SR:  9495,
				USP: 1724080,
				SSP: 13569888,
				RAM: [][2]uint32{{876624, 0}, {876625, 60}, {876626, 65}, {876627, 38}, {876628, 101}, {876629, 29}, {876630, 128}, {876631, 104}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestORItoSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{734462758, 866766591, 979291018, 1700308395, 2488217381, 688903976, 2773834445, 1178555761},
				A:   [7]uint32{4087024662, 134204255, 4033315928, 3616179702, 2973769467, 4102457109, 1254878508},
				PC:  5187698,
				SR:  1565,
				USP: 14675700,
				SSP: 4285128,
				RAM: [][2]uint32{{5187694, 0}, {5187695, 124}, {5187696, 185}, {5187697, 179}, {32, 77}, {33, 80}, {34, 100}, {35, 102}, {5268582, 11}, {5268583, 117}, {5268584, 163}, {5268585, 91}},
			},
			want: cpuState{
				D:   [8]uint32{734462758, 866766591, 979291018, 1700308395, 2488217381, 688903976, 2773834445, 1178555761},
				A:   [7]uint32{4087024662, 134204255, 4033315928, 3616179702, 2973769467, 4102457109, 1254878508},
				PC:  1297114218,
				SR:  9757,
				USP: 14675700,
				SSP: 4285122,
				RAM: [][2]uint32{{5187694, 0}, {5187695, 124}, {5187696, 185}, {5187697, 179}, {4285126, 40}, {4285127, 110}, {4285122, 6}, {4285123, 29}, {4285124, 0}, {4285125, 79}, {32, 77}, {33, 80}, {34, 100}, {35, 102}, {5268582, 11}, {5268583, 117}, {5268584, 163}, {5268585, 91}},
				Cycles: 34,
			},
		},
		{
			name: "500 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{3965599243, 3103488195, 141927582, 2269521656, 475542698, 1835345101, 3900303931, 3815758383},
				A:   [7]uint32{3865371475, 1939172057, 3700522716, 2850206247, 3412917320, 819214616, 2061186289},
				PC:  3623754,
				SR:  41220,
				USP: 13741046,
				SSP: 1439618,
				RAM: [][2]uint32{{3623750, 0}, {3623751, 124}, {3623752, 5}, {3623753, 91}, {3623754, 225}, {3623755, 162}, {3623756, 68}, {3623757, 127}},
			},
			want: cpuState{
				D:   [8]uint32{3965599243, 3103488195, 141927582, 2269521656, 475542698, 1835345101, 3900303931, 3815758383},
				A:   [7]uint32{3865371475, 1939172057, 3700522716, 2850206247, 3412917320, 819214616, 2061186289},
				PC:  3623758,
				SR:  42271,
				USP: 13741046,
				SSP: 1439618,
				RAM: [][2]uint32{{3623750, 0}, {3623751, 124}, {3623752, 5}, {3623753, 91}, {3623754, 225}, {3623755, 162}, {3623756, 68}, {3623757, 127}},
				Cycles: 20,
			},
		},
		{
			name: "1000 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{959100987, 647370043, 3682450805, 128411110, 276021068, 3047512134, 1702415021, 1698967366},
				A:   [7]uint32{167930879, 1853232461, 3862213266, 2864820735, 32055627, 2620160318, 945599985},
				PC:  13391478,
				SR:  34053,
				USP: 8376144,
				SSP: 14192004,
				RAM: [][2]uint32{{13391474, 0}, {13391475, 124}, {13391476, 193}, {13391477, 81}, {32, 201}, {33, 96}, {34, 247}, {35, 108}, {6354796, 209}, {6354797, 58}, {6354798, 16}, {6354799, 201}},
			},
			want: cpuState{
				D:   [8]uint32{959100987, 647370043, 3682450805, 128411110, 276021068, 3047512134, 1702415021, 1698967366},
				A:   [7]uint32{167930879, 1853232461, 3862213266, 2864820735, 32055627, 2620160318, 945599985},
				PC:  3378575216,
				SR:  9477,
				USP: 8376144,
				SSP: 14191998,
				RAM: [][2]uint32{{13391474, 0}, {13391475, 124}, {13391476, 193}, {13391477, 81}, {14192002, 86}, {14192003, 114}, {14191998, 133}, {14191999, 5}, {14192000, 0}, {14192001, 204}, {32, 201}, {33, 96}, {34, 247}, {35, 108}, {6354796, 209}, {6354797, 58}, {6354798, 16}, {6354799, 201}},
				Cycles: 34,
			},
		},
		{
			name: "1500 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{2081353747, 606498031, 2003530278, 1632046300, 2782269871, 511044656, 3340906696, 854384314},
				A:   [7]uint32{4042654061, 3123222309, 502632494, 3145476526, 2902495861, 253237620, 2219024668},
				PC:  7962198,
				SR:  22,
				USP: 10066682,
				SSP: 8294804,
				RAM: [][2]uint32{{7962194, 0}, {7962195, 124}, {7962196, 228}, {7962197, 148}, {32, 225}, {33, 232}, {34, 233}, {35, 18}, {15264018, 29}, {15264019, 85}, {15264020, 193}, {15264021, 235}},
			},
			want: cpuState{
				D:   [8]uint32{2081353747, 606498031, 2003530278, 1632046300, 2782269871, 511044656, 3340906696, 854384314},
				A:   [7]uint32{4042654061, 3123222309, 502632494, 3145476526, 2902495861, 253237620, 2219024668},
				PC:  3790137622,
				SR:  8214,
				USP: 10066682,
				SSP: 8294798,
				RAM: [][2]uint32{{7962194, 0}, {7962195, 124}, {7962196, 228}, {7962197, 148}, {8294802, 126}, {8294803, 82}, {8294798, 0}, {8294799, 22}, {8294800, 0}, {8294801, 121}, {32, 225}, {33, 232}, {34, 233}, {35, 18}, {15264018, 29}, {15264019, 85}, {15264020, 193}, {15264021, 235}},
				Cycles: 34,
			},
		},
		{
			name: "2000 ORItoSR # 007c",
			init: cpuState{
				D:   [8]uint32{1515364952, 1808989505, 3360149659, 4106425325, 2277043743, 3687217787, 1581562198, 3827847434},
				A:   [7]uint32{658122125, 1337067040, 1316107772, 2964357717, 2039227919, 1865919042, 421570542},
				PC:  8895478,
				SR:  33296,
				USP: 16560642,
				SSP: 15793234,
				RAM: [][2]uint32{{8895474, 0}, {8895475, 124}, {8895476, 185}, {8895477, 110}, {32, 129}, {33, 56}, {34, 154}, {35, 246}, {3709686, 47}, {3709687, 232}, {3709688, 162}, {3709689, 206}},
			},
			want: cpuState{
				D:   [8]uint32{1515364952, 1808989505, 3360149659, 4106425325, 2277043743, 3687217787, 1581562198, 3827847434},
				A:   [7]uint32{658122125, 1337067040, 1316107772, 2964357717, 2039227919, 1865919042, 421570542},
				PC:  2167970554,
				SR:  8720,
				USP: 16560642,
				SSP: 15793228,
				RAM: [][2]uint32{{8895474, 0}, {8895475, 124}, {8895476, 185}, {8895477, 110}, {15793232, 187}, {15793233, 242}, {15793228, 130}, {15793229, 16}, {15793230, 0}, {15793231, 135}, {32, 129}, {33, 56}, {34, 154}, {35, 246}, {3709686, 47}, {3709687, 232}, {3709688, 162}, {3709689, 206}},
				Cycles: 34,
			},
		},
		{
			name: "001 ORItoSR # 007c",
			init: 			cpuState{
				D:   [8]uint32{2596515650, 3746345793, 2704143354, 2816523184, 523907896, 265956644, 2043718355, 2155365508},
				A:   [7]uint32{1267914327, 1702794160, 1385454204, 1640154811, 2377516141, 3086191410, 2935968185},
				PC:  14625086,
				SR:  286,
				USP: 1477204,
				SSP: 11587866,
				RAM: [][2]uint32{{14625082, 0}, {14625083, 124}, {14625084, 168}, {14625085, 145}, {32, 1}, {33, 164}, {34, 156}, {35, 34}, {10787874, 212}, {10787875, 37}, {10787876, 148}, {10787877, 65}},
			},
			want: 			cpuState{
				D:   [8]uint32{2596515650, 3746345793, 2704143354, 2816523184, 523907896, 265956644, 2043718355, 2155365508},
				A:   [7]uint32{1267914327, 1702794160, 1385454204, 1640154811, 2377516141, 3086191410, 2935968185},
				PC:  27565094,
				SR:  8478,
				USP: 1477204,
				SSP: 11587860,
				RAM: [][2]uint32{{14625082, 0}, {14625083, 124}, {14625084, 168}, {14625085, 145}, {11587864, 41}, {11587865, 58}, {11587860, 1}, {11587861, 30}, {11587862, 0}, {11587863, 223}, {32, 1}, {33, 164}, {34, 156}, {35, 34}, {10787874, 212}, {10787875, 37}, {10787876, 148}, {10787877, 65}},
				Cycles: 34,
			},
		},
		{
			name: "276 ORItoSR # 007c",
			init: 			cpuState{
				D:   [8]uint32{4073465790, 1568934015, 592972846, 1461279611, 2056917450, 130459707, 832817720, 3754146312},
				A:   [7]uint32{663112107, 3576230169, 2391493716, 2141689288, 2936998482, 469176865, 2446975734},
				PC:  9266166,
				SR:  1293,
				USP: 9605186,
				SSP: 5273884,
				RAM: [][2]uint32{{9266162, 0}, {9266163, 124}, {9266164, 215}, {9266165, 210}, {32, 160}, {33, 68}, {34, 195}, {35, 72}, {4506440, 114}, {4506441, 137}, {4506442, 248}, {4506443, 151}},
			},
			want: 			cpuState{
				D:   [8]uint32{4073465790, 1568934015, 592972846, 1461279611, 2056917450, 130459707, 832817720, 3754146312},
				A:   [7]uint32{663112107, 3576230169, 2391493716, 2141689288, 2936998482, 469176865, 2446975734},
				PC:  2688861004,
				SR:  9485,
				USP: 9605186,
				SSP: 5273878,
				RAM: [][2]uint32{{9266162, 0}, {9266163, 124}, {9266164, 215}, {9266165, 210}, {5273882, 99}, {5273883, 242}, {5273878, 5}, {5273879, 13}, {5273880, 0}, {5273881, 141}, {32, 160}, {33, 68}, {34, 195}, {35, 72}, {4506440, 114}, {4506441, 137}, {4506442, 248}, {4506443, 151}},
				Cycles: 34,
			},
		},
		{
			name: "558 ORItoSR # 007c",
			init: 			cpuState{
				D:   [8]uint32{2053151990, 932974492, 3538874024, 2001632587, 2721562615, 3801928384, 2735655367, 662542225},
				A:   [7]uint32{853333369, 711948644, 1120217023, 3214472745, 1283996797, 1155332141, 2354363426},
				PC:  13098984,
				SR:  10014,
				USP: 8083820,
				SSP: 980620,
				RAM: [][2]uint32{{13098980, 0}, {13098981, 124}, {13098982, 13}, {13098983, 38}, {13098984, 109}, {13098985, 127}, {13098986, 50}, {13098987, 127}},
			},
			want: 			cpuState{
				D:   [8]uint32{2053151990, 932974492, 3538874024, 2001632587, 2721562615, 3801928384, 2735655367, 662542225},
				A:   [7]uint32{853333369, 711948644, 1120217023, 3214472745, 1283996797, 1155332141, 2354363426},
				PC:  13098988,
				SR:  10014,
				USP: 8083820,
				SSP: 980620,
				RAM: [][2]uint32{{13098980, 0}, {13098981, 124}, {13098982, 13}, {13098983, 38}, {13098984, 109}, {13098985, 127}, {13098986, 50}, {13098987, 127}},
				Cycles: 20,
			},
		},
		{
			name: "836 ORItoSR # 007c",
			init: 			cpuState{
				D:   [8]uint32{1657798843, 4172729729, 3480359357, 2735507088, 491296779, 2619470702, 855995261, 1613169478},
				A:   [7]uint32{165728764, 251024908, 2911357575, 1401731823, 216726875, 2201810703, 1831006412},
				PC:  1526256,
				SR:  522,
				USP: 6536554,
				SSP: 13764800,
				RAM: [][2]uint32{{1526252, 0}, {1526253, 124}, {1526254, 156}, {1526255, 249}, {32, 115}, {33, 246}, {34, 19}, {35, 202}, {16126922, 155}, {16126923, 243}, {16126924, 18}, {16126925, 209}},
			},
			want: 			cpuState{
				D:   [8]uint32{1657798843, 4172729729, 3480359357, 2735507088, 491296779, 2619470702, 855995261, 1613169478},
				A:   [7]uint32{165728764, 251024908, 2911357575, 1401731823, 216726875, 2201810703, 1831006412},
				PC:  1945506766,
				SR:  8714,
				USP: 6536554,
				SSP: 13764794,
				RAM: [][2]uint32{{1526252, 0}, {1526253, 124}, {1526254, 156}, {1526255, 249}, {13764798, 73}, {13764799, 236}, {13764794, 2}, {13764795, 10}, {13764796, 0}, {13764797, 23}, {32, 115}, {33, 246}, {34, 19}, {35, 202}, {16126922, 155}, {16126923, 243}, {16126924, 18}, {16126925, 209}},
				Cycles: 34,
			},
		},
		{
			name: "1116 ORItoSR # 007c",
			init: 			cpuState{
				D:   [8]uint32{2888720970, 295673911, 3248244249, 3377075059, 2135653672, 2629058727, 1985413135, 1343748747},
				A:   [7]uint32{234417526, 1225117713, 1557821302, 3882817052, 2047428201, 3350596822, 443567095},
				PC:  5851972,
				SR:  9759,
				USP: 16225208,
				SSP: 8253012,
				RAM: [][2]uint32{{5851968, 0}, {5851969, 124}, {5851970, 22}, {5851971, 254}, {5851972, 101}, {5851973, 40}, {5851974, 111}, {5851975, 114}},
			},
			want: 			cpuState{
				D:   [8]uint32{2888720970, 295673911, 3248244249, 3377075059, 2135653672, 2629058727, 1985413135, 1343748747},
				A:   [7]uint32{234417526, 1225117713, 1557821302, 3882817052, 2047428201, 3350596822, 443567095},
				PC:  5851976,
				SR:  9759,
				USP: 16225208,
				SSP: 8253012,
				RAM: [][2]uint32{{5851968, 0}, {5851969, 124}, {5851970, 22}, {5851971, 254}, {5851972, 101}, {5851973, 40}, {5851974, 111}, {5851975, 114}},
				Cycles: 20,
			},
		},
		{
			name: "1361 ORItoSR # 007c",
			init: 			cpuState{
				D:   [8]uint32{2537976512, 2312224089, 3196759548, 2552912610, 3372798288, 2438144064, 3054743521, 1248379493},
				A:   [7]uint32{2127362728, 3598078134, 1386655985, 3907370773, 4136848244, 2739255588, 684603520},
				PC:  5414222,
				SR:  1034,
				USP: 7240566,
				SSP: 1891970,
				RAM: [][2]uint32{{5414218, 0}, {5414219, 124}, {5414220, 207}, {5414221, 12}, {32, 101}, {33, 70}, {34, 195}, {35, 194}, {4637634, 14}, {4637635, 43}, {4637636, 186}, {4637637, 236}},
			},
			want: 			cpuState{
				D:   [8]uint32{2537976512, 2312224089, 3196759548, 2552912610, 3372798288, 2438144064, 3054743521, 1248379493},
				A:   [7]uint32{2127362728, 3598078134, 1386655985, 3907370773, 4136848244, 2739255588, 684603520},
				PC:  1699136454,
				SR:  9226,
				USP: 7240566,
				SSP: 1891964,
				RAM: [][2]uint32{{5414218, 0}, {5414219, 124}, {5414220, 207}, {5414221, 12}, {1891968, 157}, {1891969, 74}, {1891964, 4}, {1891965, 10}, {1891966, 0}, {1891967, 82}, {32, 101}, {33, 70}, {34, 195}, {35, 194}, {4637634, 14}, {4637635, 43}, {4637636, 186}, {4637637, 236}},
				Cycles: 34,
			},
		},
		{
			name: "1648 ORItoSR # 007c",
			init: 			cpuState{
				D:   [8]uint32{611386415, 3043356864, 2478348485, 2388894164, 1336624194, 3469519379, 648969569, 2955959492},
				A:   [7]uint32{2640824457, 1428032429, 3459000449, 3582710296, 3231988533, 2288384383, 1832479166},
				PC:  4645392,
				SR:  9236,
				USP: 5717596,
				SSP: 7349450,
				RAM: [][2]uint32{{4645388, 0}, {4645389, 124}, {4645390, 30}, {4645391, 60}, {4645392, 101}, {4645393, 104}, {4645394, 153}, {4645395, 212}},
			},
			want: 			cpuState{
				D:   [8]uint32{611386415, 3043356864, 2478348485, 2388894164, 1336624194, 3469519379, 648969569, 2955959492},
				A:   [7]uint32{2640824457, 1428032429, 3459000449, 3582710296, 3231988533, 2288384383, 1832479166},
				PC:  4645396,
				SR:  9756,
				USP: 5717596,
				SSP: 7349450,
				RAM: [][2]uint32{{4645388, 0}, {4645389, 124}, {4645390, 30}, {4645391, 60}, {4645392, 101}, {4645393, 104}, {4645394, 153}, {4645395, 212}},
				Cycles: 20,
			},
		},
		{
			name: "1950 ORItoSR # 007c",
			init: 			cpuState{
				D:   [8]uint32{900481447, 3548939903, 2515335112, 1576850534, 3802906535, 1434837817, 2423621398, 1533844601},
				A:   [7]uint32{562512279, 1892171077, 745912657, 2221117912, 451136580, 54470960, 2815984099},
				PC:  1558694,
				SR:  9996,
				USP: 14301362,
				SSP: 6805956,
				RAM: [][2]uint32{{1558690, 0}, {1558691, 124}, {1558692, 213}, {1558693, 138}, {1558694, 68}, {1558695, 111}, {1558696, 96}, {1558697, 249}},
			},
			want: 			cpuState{
				D:   [8]uint32{900481447, 3548939903, 2515335112, 1576850534, 3802906535, 1434837817, 2423621398, 1533844601},
				A:   [7]uint32{562512279, 1892171077, 745912657, 2221117912, 451136580, 54470960, 2815984099},
				PC:  1558698,
				SR:  42766,
				USP: 14301362,
				SSP: 6805956,
				RAM: [][2]uint32{{1558690, 0}, {1558691, 124}, {1558692, 213}, {1558693, 138}, {1558694, 68}, {1558695, 111}, {1558696, 96}, {1558697, 249}},
				Cycles: 20,
			},
		},
		{
			name: "2215 ORItoSR # 007c",
			init: 			cpuState{
				D:   [8]uint32{3853378306, 3487079608, 1410698348, 2658334286, 1491485620, 3099586417, 3580418447, 664480995},
				A:   [7]uint32{3244830594, 900494321, 3441571522, 2883210346, 3174582584, 802911660, 3148968302},
				PC:  10601882,
				SR:  261,
				USP: 1909974,
				SSP: 15623692,
				RAM: [][2]uint32{{10601878, 0}, {10601879, 124}, {10601880, 234}, {10601881, 229}, {32, 210}, {33, 70}, {34, 234}, {35, 172}, {4647596, 83}, {4647597, 254}, {4647598, 167}, {4647599, 170}},
			},
			want: 			cpuState{
				D:   [8]uint32{3853378306, 3487079608, 1410698348, 2658334286, 1491485620, 3099586417, 3580418447, 664480995},
				A:   [7]uint32{3244830594, 900494321, 3441571522, 2883210346, 3174582584, 802911660, 3148968302},
				PC:  3527862960,
				SR:  8453,
				USP: 1909974,
				SSP: 15623686,
				RAM: [][2]uint32{{10601878, 0}, {10601879, 124}, {10601880, 234}, {10601881, 229}, {15623690, 197}, {15623691, 150}, {15623686, 1}, {15623687, 5}, {15623688, 0}, {15623689, 161}, {32, 210}, {33, 70}, {34, 234}, {35, 172}, {4647596, 83}, {4647597, 254}, {4647598, 167}, {4647599, 170}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEORItoCCR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{1868907750, 709266115, 2704618461, 1932055206, 2138770018, 989869050, 3757548310, 992156990},
				A:   [7]uint32{3296999902, 1011317068, 2768009615, 1314656404, 521203327, 552644832, 4209516611},
				PC:  6354384,
				SR:  41233,
				USP: 1839076,
				SSP: 12755256,
				RAM: [][2]uint32{{6354380, 10}, {6354381, 60}, {6354382, 63}, {6354383, 21}, {6354384, 33}, {6354385, 164}, {6354386, 123}, {6354387, 9}},
			},
			want: cpuState{
				D:   [8]uint32{1868907750, 709266115, 2704618461, 1932055206, 2138770018, 989869050, 3757548310, 992156990},
				A:   [7]uint32{3296999902, 1011317068, 2768009615, 1314656404, 521203327, 552644832, 4209516611},
				PC:  6354388,
				SR:  41220,
				USP: 1839076,
				SSP: 12755256,
				RAM: [][2]uint32{{6354380, 10}, {6354381, 60}, {6354382, 63}, {6354383, 21}, {6354384, 33}, {6354385, 164}, {6354386, 123}, {6354387, 9}},
				Cycles: 20,
			},
		},
		{
			name: "500 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{1856053249, 2746474562, 496256537, 1207437040, 728287027, 2628046923, 1318105493, 1153055414},
				A:   [7]uint32{3561936910, 4277101086, 700863900, 1540290946, 2542697188, 154319561, 2768004356},
				PC:  13838814,
				SR:  42009,
				USP: 6981556,
				SSP: 12519522,
				RAM: [][2]uint32{{13838810, 10}, {13838811, 60}, {13838812, 13}, {13838813, 62}, {13838814, 50}, {13838815, 31}, {13838816, 195}, {13838817, 50}},
			},
			want: cpuState{
				D:   [8]uint32{1856053249, 2746474562, 496256537, 1207437040, 728287027, 2628046923, 1318105493, 1153055414},
				A:   [7]uint32{3561936910, 4277101086, 700863900, 1540290946, 2542697188, 154319561, 2768004356},
				PC:  13838818,
				SR:  41991,
				USP: 6981556,
				SSP: 12519522,
				RAM: [][2]uint32{{13838810, 10}, {13838811, 60}, {13838812, 13}, {13838813, 62}, {13838814, 50}, {13838815, 31}, {13838816, 195}, {13838817, 50}},
				Cycles: 20,
			},
		},
		{
			name: "1000 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{2280714596, 2924719375, 2586354702, 3806494595, 3451950454, 750559815, 2741061343, 2684021488},
				A:   [7]uint32{4277589726, 4202747865, 2112193502, 269709997, 3733571038, 3996061132, 2278032047},
				PC:  9890772,
				SR:  42241,
				USP: 6167144,
				SSP: 5566098,
				RAM: [][2]uint32{{9890768, 10}, {9890769, 60}, {9890770, 171}, {9890771, 61}, {9890772, 53}, {9890773, 75}, {9890774, 190}, {9890775, 61}},
			},
			want: cpuState{
				D:   [8]uint32{2280714596, 2924719375, 2586354702, 3806494595, 3451950454, 750559815, 2741061343, 2684021488},
				A:   [7]uint32{4277589726, 4202747865, 2112193502, 269709997, 3733571038, 3996061132, 2278032047},
				PC:  9890776,
				SR:  42268,
				USP: 6167144,
				SSP: 5566098,
				RAM: [][2]uint32{{9890768, 10}, {9890769, 60}, {9890770, 171}, {9890771, 61}, {9890772, 53}, {9890773, 75}, {9890774, 190}, {9890775, 61}},
				Cycles: 20,
			},
		},
		{
			name: "1500 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{3459851696, 3571004347, 2957111029, 2144688765, 4187815854, 1250707856, 375704960, 838359100},
				A:   [7]uint32{4124681873, 1070955796, 2045518755, 1246377620, 1979500972, 173959096, 4002867008},
				PC:  1731474,
				SR:  1543,
				USP: 10316944,
				SSP: 6130934,
				RAM: [][2]uint32{{1731470, 10}, {1731471, 60}, {1731472, 154}, {1731473, 172}, {1731474, 1}, {1731475, 217}, {1731476, 36}, {1731477, 217}},
			},
			want: cpuState{
				D:   [8]uint32{3459851696, 3571004347, 2957111029, 2144688765, 4187815854, 1250707856, 375704960, 838359100},
				A:   [7]uint32{4124681873, 1070955796, 2045518755, 1246377620, 1979500972, 173959096, 4002867008},
				PC:  1731478,
				SR:  1547,
				USP: 10316944,
				SSP: 6130934,
				RAM: [][2]uint32{{1731470, 10}, {1731471, 60}, {1731472, 154}, {1731473, 172}, {1731474, 1}, {1731475, 217}, {1731476, 36}, {1731477, 217}},
				Cycles: 20,
			},
		},
		{
			name: "2000 EORItoCCR # 0a3c",
			init: cpuState{
				D:   [8]uint32{35761447, 690031813, 3594965879, 2666791947, 1454953287, 982352235, 2536586741, 3970384421},
				A:   [7]uint32{164513601, 3378154448, 1944313648, 1771893011, 3010287422, 167419578, 2061810012},
				PC:  12547242,
				SR:  8455,
				USP: 6478890,
				SSP: 15233036,
				RAM: [][2]uint32{{12547238, 10}, {12547239, 60}, {12547240, 243}, {12547241, 167}, {12547242, 156}, {12547243, 113}, {12547244, 91}, {12547245, 143}},
			},
			want: cpuState{
				D:   [8]uint32{35761447, 690031813, 3594965879, 2666791947, 1454953287, 982352235, 2536586741, 3970384421},
				A:   [7]uint32{164513601, 3378154448, 1944313648, 1771893011, 3010287422, 167419578, 2061810012},
				PC:  12547246,
				SR:  8448,
				USP: 6478890,
				SSP: 15233036,
				RAM: [][2]uint32{{12547238, 10}, {12547239, 60}, {12547240, 243}, {12547241, 167}, {12547242, 156}, {12547243, 113}, {12547244, 91}, {12547245, 143}},
				Cycles: 20,
			},
		},
		{
			name: "002 EORItoCCR # 0a3c",
			init: 			cpuState{
				D:   [8]uint32{4154356503, 1931541459, 3280510849, 2293530238, 1305674864, 2334735970, 2264492984, 779077562},
				A:   [7]uint32{1292313770, 2328411783, 3765899805, 1331862666, 2731762729, 2552556641, 3369197292},
				PC:  12388420,
				SR:  9733,
				USP: 220276,
				SSP: 11003234,
				RAM: [][2]uint32{{12388416, 10}, {12388417, 60}, {12388418, 3}, {12388419, 29}, {12388420, 4}, {12388421, 241}, {12388422, 54}, {12388423, 236}},
			},
			want: 			cpuState{
				D:   [8]uint32{4154356503, 1931541459, 3280510849, 2293530238, 1305674864, 2334735970, 2264492984, 779077562},
				A:   [7]uint32{1292313770, 2328411783, 3765899805, 1331862666, 2731762729, 2552556641, 3369197292},
				PC:  12388424,
				SR:  9752,
				USP: 220276,
				SSP: 11003234,
				RAM: [][2]uint32{{12388416, 10}, {12388417, 60}, {12388418, 3}, {12388419, 29}, {12388420, 4}, {12388421, 241}, {12388422, 54}, {12388423, 236}},
				Cycles: 20,
			},
		},
		{
			name: "263 EORItoCCR # 0a3c",
			init: 			cpuState{
				D:   [8]uint32{3679871700, 2011389439, 1281038255, 1938392330, 3359269362, 2250897573, 4107997053, 696279464},
				A:   [7]uint32{1357487507, 1923389008, 3563452810, 3756138813, 1391999538, 1177534881, 3208520969},
				PC:  126044,
				SR:  9989,
				USP: 6493932,
				SSP: 2330396,
				RAM: [][2]uint32{{126040, 10}, {126041, 60}, {126042, 194}, {126043, 89}, {126044, 181}, {126045, 160}, {126046, 248}, {126047, 80}},
			},
			want: 			cpuState{
				D:   [8]uint32{3679871700, 2011389439, 1281038255, 1938392330, 3359269362, 2250897573, 4107997053, 696279464},
				A:   [7]uint32{1357487507, 1923389008, 3563452810, 3756138813, 1391999538, 1177534881, 3208520969},
				PC:  126048,
				SR:  10012,
				USP: 6493932,
				SSP: 2330396,
				RAM: [][2]uint32{{126040, 10}, {126041, 60}, {126042, 194}, {126043, 89}, {126044, 181}, {126045, 160}, {126046, 248}, {126047, 80}},
				Cycles: 20,
			},
		},
		{
			name: "541 EORItoCCR # 0a3c",
			init: 			cpuState{
				D:   [8]uint32{2314791698, 339899119, 2983401751, 641052474, 2241985178, 2175375296, 696464814, 4085143455},
				A:   [7]uint32{795198767, 3332714991, 3011091821, 1618439131, 1204948049, 3901541502, 2055486603},
				PC:  8810424,
				SR:  8961,
				USP: 7436038,
				SSP: 418978,
				RAM: [][2]uint32{{8810420, 10}, {8810421, 60}, {8810422, 10}, {8810423, 227}, {8810424, 158}, {8810425, 180}, {8810426, 158}, {8810427, 165}},
			},
			want: 			cpuState{
				D:   [8]uint32{2314791698, 339899119, 2983401751, 641052474, 2241985178, 2175375296, 696464814, 4085143455},
				A:   [7]uint32{795198767, 3332714991, 3011091821, 1618439131, 1204948049, 3901541502, 2055486603},
				PC:  8810428,
				SR:  8962,
				USP: 7436038,
				SSP: 418978,
				RAM: [][2]uint32{{8810420, 10}, {8810421, 60}, {8810422, 10}, {8810423, 227}, {8810424, 158}, {8810425, 180}, {8810426, 158}, {8810427, 165}},
				Cycles: 20,
			},
		},
		{
			name: "830 EORItoCCR # 0a3c",
			init: 			cpuState{
				D:   [8]uint32{2860276054, 3791086638, 847244097, 1173858797, 1760959289, 399247939, 1941132810, 1217927844},
				A:   [7]uint32{3573877988, 2884662045, 2515108012, 762801136, 539410052, 365944115, 793183984},
				PC:  9549756,
				SR:  1309,
				USP: 9159640,
				SSP: 11233460,
				RAM: [][2]uint32{{9549752, 10}, {9549753, 60}, {9549754, 30}, {9549755, 159}, {9549756, 176}, {9549757, 129}, {9549758, 203}, {9549759, 94}},
			},
			want: 			cpuState{
				D:   [8]uint32{2860276054, 3791086638, 847244097, 1173858797, 1760959289, 399247939, 1941132810, 1217927844},
				A:   [7]uint32{3573877988, 2884662045, 2515108012, 762801136, 539410052, 365944115, 793183984},
				PC:  9549760,
				SR:  1282,
				USP: 9159640,
				SSP: 11233460,
				RAM: [][2]uint32{{9549752, 10}, {9549753, 60}, {9549754, 30}, {9549755, 159}, {9549756, 176}, {9549757, 129}, {9549758, 203}, {9549759, 94}},
				Cycles: 20,
			},
		},
		{
			name: "1141 EORItoCCR # 0a3c",
			init: 			cpuState{
				D:   [8]uint32{1374294879, 1807606268, 3863586955, 125436483, 2974465963, 2872575527, 536574361, 3267551390},
				A:   [7]uint32{2811867253, 1700264574, 288168724, 3648553913, 3398872909, 397796268, 224502771},
				PC:  9522166,
				SR:  1815,
				USP: 12094754,
				SSP: 7867466,
				RAM: [][2]uint32{{9522162, 10}, {9522163, 60}, {9522164, 152}, {9522165, 253}, {9522166, 214}, {9522167, 61}, {9522168, 119}, {9522169, 247}},
			},
			want: 			cpuState{
				D:   [8]uint32{1374294879, 1807606268, 3863586955, 125436483, 2974465963, 2872575527, 536574361, 3267551390},
				A:   [7]uint32{2811867253, 1700264574, 288168724, 3648553913, 3398872909, 397796268, 224502771},
				PC:  9522170,
				SR:  1802,
				USP: 12094754,
				SSP: 7867466,
				RAM: [][2]uint32{{9522162, 10}, {9522163, 60}, {9522164, 152}, {9522165, 253}, {9522166, 214}, {9522167, 61}, {9522168, 119}, {9522169, 247}},
				Cycles: 20,
			},
		},
		{
			name: "1403 EORItoCCR # 0a3c",
			init: 			cpuState{
				D:   [8]uint32{2350362459, 2950882872, 3422609203, 3473893705, 2805281814, 3058295485, 2674139487, 798592385},
				A:   [7]uint32{2650879328, 1842767935, 2002404863, 924852124, 573198583, 2992845632, 785065968},
				PC:  1040642,
				SR:  9728,
				USP: 1665930,
				SSP: 15962566,
				RAM: [][2]uint32{{1040638, 10}, {1040639, 60}, {1040640, 252}, {1040641, 4}, {1040642, 149}, {1040643, 23}, {1040644, 112}, {1040645, 174}},
			},
			want: 			cpuState{
				D:   [8]uint32{2350362459, 2950882872, 3422609203, 3473893705, 2805281814, 3058295485, 2674139487, 798592385},
				A:   [7]uint32{2650879328, 1842767935, 2002404863, 924852124, 573198583, 2992845632, 785065968},
				PC:  1040646,
				SR:  9732,
				USP: 1665930,
				SSP: 15962566,
				RAM: [][2]uint32{{1040638, 10}, {1040639, 60}, {1040640, 252}, {1040641, 4}, {1040642, 149}, {1040643, 23}, {1040644, 112}, {1040645, 174}},
				Cycles: 20,
			},
		},
		{
			name: "1708 EORItoCCR # 0a3c",
			init: 			cpuState{
				D:   [8]uint32{543433281, 183984281, 318308402, 1955884464, 3419043198, 3148934544, 3625812327, 1869871399},
				A:   [7]uint32{1859941637, 3422835653, 2975317643, 719013470, 505566133, 3864381413, 3857655678},
				PC:  9261894,
				SR:  8970,
				USP: 11002096,
				SSP: 11434208,
				RAM: [][2]uint32{{9261890, 10}, {9261891, 60}, {9261892, 194}, {9261893, 205}, {9261894, 68}, {9261895, 93}, {9261896, 72}, {9261897, 200}},
			},
			want: 			cpuState{
				D:   [8]uint32{543433281, 183984281, 318308402, 1955884464, 3419043198, 3148934544, 3625812327, 1869871399},
				A:   [7]uint32{1859941637, 3422835653, 2975317643, 719013470, 505566133, 3864381413, 3857655678},
				PC:  9261898,
				SR:  8967,
				USP: 11002096,
				SSP: 11434208,
				RAM: [][2]uint32{{9261890, 10}, {9261891, 60}, {9261892, 194}, {9261893, 205}, {9261894, 68}, {9261895, 93}, {9261896, 72}, {9261897, 200}},
				Cycles: 20,
			},
		},
		{
			name: "1976 EORItoCCR # 0a3c",
			init: 			cpuState{
				D:   [8]uint32{832533439, 524519542, 2984350765, 2162825143, 3897748883, 2860887330, 4149496858, 2374596827},
				A:   [7]uint32{798145793, 4208813717, 2136358516, 914713753, 923047956, 2455718348, 1356222503},
				PC:  13609114,
				SR:  1290,
				USP: 9577594,
				SSP: 3201672,
				RAM: [][2]uint32{{13609110, 10}, {13609111, 60}, {13609112, 96}, {13609113, 124}, {13609114, 6}, {13609115, 42}, {13609116, 131}, {13609117, 254}},
			},
			want: 			cpuState{
				D:   [8]uint32{832533439, 524519542, 2984350765, 2162825143, 3897748883, 2860887330, 4149496858, 2374596827},
				A:   [7]uint32{798145793, 4208813717, 2136358516, 914713753, 923047956, 2455718348, 1356222503},
				PC:  13609118,
				SR:  1302,
				USP: 9577594,
				SSP: 3201672,
				RAM: [][2]uint32{{13609110, 10}, {13609111, 60}, {13609112, 96}, {13609113, 124}, {13609114, 6}, {13609115, 42}, {13609116, 131}, {13609117, 254}},
				Cycles: 20,
			},
		},
		{
			name: "2231 EORItoCCR # 0a3c",
			init: 			cpuState{
				D:   [8]uint32{3660475936, 1435369913, 3533819592, 573969737, 814402068, 3421052376, 2484106685, 236578480},
				A:   [7]uint32{2697192885, 2551007885, 2960808261, 1562190154, 1405394348, 1794454193, 2582208153},
				PC:  14260434,
				SR:  11,
				USP: 6332966,
				SSP: 775182,
				RAM: [][2]uint32{{14260430, 10}, {14260431, 60}, {14260432, 129}, {14260433, 151}, {14260434, 16}, {14260435, 175}, {14260436, 198}, {14260437, 136}},
			},
			want: 			cpuState{
				D:   [8]uint32{3660475936, 1435369913, 3533819592, 573969737, 814402068, 3421052376, 2484106685, 236578480},
				A:   [7]uint32{2697192885, 2551007885, 2960808261, 1562190154, 1405394348, 1794454193, 2582208153},
				PC:  14260438,
				SR:  28,
				USP: 6332966,
				SSP: 775182,
				RAM: [][2]uint32{{14260430, 10}, {14260431, 60}, {14260432, 129}, {14260433, 151}, {14260434, 16}, {14260435, 175}, {14260436, 198}, {14260437, 136}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestEORItoSR(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "000 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{1293837843, 1637587384, 1520147821, 4147878201, 4265273769, 2590716670, 1334787273, 1614203674},
				A:   [7]uint32{3303257199, 1139246236, 27863902, 2388846274, 3765859255, 3160100158, 1336615608},
				PC:  1285236,
				SR:  41995,
				USP: 821502,
				SSP: 12825168,
				RAM: [][2]uint32{{1285232, 10}, {1285233, 124}, {1285234, 170}, {1285235, 48}, {1285236, 143}, {1285237, 133}, {1285238, 21}, {1285239, 78}},
			},
			want: cpuState{
				D:   [8]uint32{1293837843, 1637587384, 1520147821, 4147878201, 4265273769, 2590716670, 1334787273, 1614203674},
				A:   [7]uint32{3303257199, 1139246236, 27863902, 2388846274, 3765859255, 3160100158, 1336615608},
				PC:  1285240,
				SR:  1563,
				USP: 821502,
				SSP: 12825168,
				RAM: [][2]uint32{{1285232, 10}, {1285233, 124}, {1285234, 170}, {1285235, 48}, {1285236, 143}, {1285237, 133}, {1285238, 21}, {1285239, 78}},
				Cycles: 20,
			},
		},
		{
			name: "500 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{922788254, 1938174579, 4037914579, 3852611098, 1607190208, 3995423588, 2895770495, 1549782587},
				A:   [7]uint32{2823439270, 4087894379, 128116920, 2848877944, 1462312717, 3543802921, 3030944344},
				PC:  6464582,
				SR:  275,
				USP: 343380,
				SSP: 9508550,
				RAM: [][2]uint32{{6464578, 10}, {6464579, 124}, {6464580, 87}, {6464581, 52}, {32, 3}, {33, 6}, {34, 95}, {35, 218}, {417754, 181}, {417755, 146}, {417756, 64}, {417757, 9}},
			},
			want: cpuState{
				D:   [8]uint32{922788254, 1938174579, 4037914579, 3852611098, 1607190208, 3995423588, 2895770495, 1549782587},
				A:   [7]uint32{2823439270, 4087894379, 128116920, 2848877944, 1462312717, 3543802921, 3030944344},
				PC:  50749406,
				SR:  8467,
				USP: 343380,
				SSP: 9508544,
				RAM: [][2]uint32{{6464578, 10}, {6464579, 124}, {6464580, 87}, {6464581, 52}, {9508548, 164}, {9508549, 66}, {9508544, 1}, {9508545, 19}, {9508546, 0}, {9508547, 98}, {32, 3}, {33, 6}, {34, 95}, {35, 218}, {417754, 181}, {417755, 146}, {417756, 64}, {417757, 9}},
				Cycles: 34,
			},
		},
		{
			name: "1000 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{4049693525, 1090011299, 2299937968, 2374597623, 666122521, 2264451151, 3237538528, 3509457271},
				A:   [7]uint32{3303677318, 616356545, 2174941577, 1314441383, 2596872042, 4222730540, 2147809187},
				PC:  1046258,
				SR:  9738,
				USP: 4878182,
				SSP: 9301494,
				RAM: [][2]uint32{{1046254, 10}, {1046255, 124}, {1046256, 79}, {1046257, 191}, {1046258, 36}, {1046259, 69}, {1046260, 205}, {1046261, 41}},
			},
			want: cpuState{
				D:   [8]uint32{4049693525, 1090011299, 2299937968, 2374597623, 666122521, 2264451151, 3237538528, 3509457271},
				A:   [7]uint32{3303677318, 616356545, 2174941577, 1314441383, 2596872042, 4222730540, 2147809187},
				PC:  1046262,
				SR:  8469,
				USP: 4878182,
				SSP: 9301494,
				RAM: [][2]uint32{{1046254, 10}, {1046255, 124}, {1046256, 79}, {1046257, 191}, {1046258, 36}, {1046259, 69}, {1046260, 205}, {1046261, 41}},
				Cycles: 20,
			},
		},
		{
			name: "1500 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{2311250540, 4144552559, 994616553, 324540390, 3479460874, 3955002106, 1970689559, 2270560657},
				A:   [7]uint32{553924943, 1943644148, 2513271543, 2175646757, 2934542004, 3714557792, 4026886972},
				PC:  16316154,
				SR:  1050,
				USP: 13349218,
				SSP: 7936814,
				RAM: [][2]uint32{{16316150, 10}, {16316151, 124}, {16316152, 67}, {16316153, 9}, {32, 75}, {33, 58}, {34, 97}, {35, 108}, {3826028, 178}, {3826029, 110}, {3826030, 247}, {3826031, 159}},
			},
			want: cpuState{
				D:   [8]uint32{2311250540, 4144552559, 994616553, 324540390, 3479460874, 3955002106, 1970689559, 2270560657},
				A:   [7]uint32{553924943, 1943644148, 2513271543, 2175646757, 2934542004, 3714557792, 4026886972},
				PC:  1262117232,
				SR:  9242,
				USP: 13349218,
				SSP: 7936808,
				RAM: [][2]uint32{{16316150, 10}, {16316151, 124}, {16316152, 67}, {16316153, 9}, {7936812, 246}, {7936813, 246}, {7936808, 4}, {7936809, 26}, {7936810, 0}, {7936811, 248}, {32, 75}, {33, 58}, {34, 97}, {35, 108}, {3826028, 178}, {3826029, 110}, {3826030, 247}, {3826031, 159}},
				Cycles: 34,
			},
		},
		{
			name: "2000 EORItoSR # 0a7c",
			init: cpuState{
				D:   [8]uint32{3872350169, 1544425329, 2806066907, 1368784909, 2592332215, 2954225763, 1295627581, 3900973319},
				A:   [7]uint32{3461219992, 3995678330, 3908737328, 342147372, 2173076479, 531492373, 3687999209},
				PC:  1593770,
				SR:  8209,
				USP: 15534840,
				SSP: 10523364,
				RAM: [][2]uint32{{1593766, 10}, {1593767, 124}, {1593768, 150}, {1593769, 254}, {1593770, 165}, {1593771, 216}, {1593772, 37}, {1593773, 245}},
			},
			want: cpuState{
				D:   [8]uint32{3872350169, 1544425329, 2806066907, 1368784909, 2592332215, 2954225763, 1295627581, 3900973319},
				A:   [7]uint32{3461219992, 3995678330, 3908737328, 342147372, 2173076479, 531492373, 3687999209},
				PC:  1593774,
				SR:  42511,
				USP: 15534840,
				SSP: 10523364,
				RAM: [][2]uint32{{1593766, 10}, {1593767, 124}, {1593768, 150}, {1593769, 254}, {1593770, 165}, {1593771, 216}, {1593772, 37}, {1593773, 245}},
				Cycles: 20,
			},
		},
		{
			name: "001 EORItoSR # 0a7c",
			init: 			cpuState{
				D:   [8]uint32{1131070454, 478556402, 1989721963, 1753683333, 3083357651, 3774660810, 1538364855, 4290790439},
				A:   [7]uint32{63354232, 426873511, 3772677117, 1039569645, 3236716174, 3622495037, 2631297700},
				PC:  777650,
				SR:  1030,
				USP: 9081542,
				SSP: 11577048,
				RAM: [][2]uint32{{777646, 10}, {777647, 124}, {777648, 231}, {777649, 193}, {32, 139}, {33, 106}, {34, 254}, {35, 14}, {7011854, 19}, {7011855, 200}, {7011856, 82}, {7011857, 176}},
			},
			want: 			cpuState{
				D:   [8]uint32{1131070454, 478556402, 1989721963, 1753683333, 3083357651, 3774660810, 1538364855, 4290790439},
				A:   [7]uint32{63354232, 426873511, 3772677117, 1039569645, 3236716174, 3622495037, 2631297700},
				PC:  2339044882,
				SR:  9222,
				USP: 9081542,
				SSP: 11577042,
				RAM: [][2]uint32{{777646, 10}, {777647, 124}, {777648, 231}, {777649, 193}, {11577046, 221}, {11577047, 174}, {11577042, 4}, {11577043, 6}, {11577044, 0}, {11577045, 11}, {32, 139}, {33, 106}, {34, 254}, {35, 14}, {7011854, 19}, {7011855, 200}, {7011856, 82}, {7011857, 176}},
				Cycles: 34,
			},
		},
		{
			name: "283 EORItoSR # 0a7c",
			init: 			cpuState{
				D:   [8]uint32{1186472375, 3427500067, 4224270371, 3666953298, 2137671823, 2005910364, 2160374772, 781345619},
				A:   [7]uint32{4022704771, 305016691, 796792177, 253095766, 1311162685, 939756880, 1910495764},
				PC:  14561802,
				SR:  776,
				USP: 11789668,
				SSP: 15090728,
				RAM: [][2]uint32{{14561798, 10}, {14561799, 124}, {14561800, 100}, {14561801, 70}, {32, 51}, {33, 188}, {34, 141}, {35, 244}, {12357108, 218}, {12357109, 225}, {12357110, 228}, {12357111, 89}},
			},
			want: 			cpuState{
				D:   [8]uint32{1186472375, 3427500067, 4224270371, 3666953298, 2137671823, 2005910364, 2160374772, 781345619},
				A:   [7]uint32{4022704771, 305016691, 796792177, 253095766, 1311162685, 939756880, 1910495764},
				PC:  867995128,
				SR:  8968,
				USP: 11789668,
				SSP: 15090722,
				RAM: [][2]uint32{{14561798, 10}, {14561799, 124}, {14561800, 100}, {14561801, 70}, {15090726, 50}, {15090727, 6}, {15090722, 3}, {15090723, 8}, {15090724, 0}, {15090725, 222}, {32, 51}, {33, 188}, {34, 141}, {35, 244}, {12357108, 218}, {12357109, 225}, {12357110, 228}, {12357111, 89}},
				Cycles: 34,
			},
		},
		{
			name: "582 EORItoSR # 0a7c",
			init: 			cpuState{
				D:   [8]uint32{2164906169, 1230284346, 260427620, 325487477, 1412474508, 2132875421, 1328751060, 2699995861},
				A:   [7]uint32{1421557191, 3918603249, 3922834922, 3569592415, 1393680834, 256522838, 2823585464},
				PC:  6685372,
				SR:  1822,
				USP: 15460328,
				SSP: 15143680,
				RAM: [][2]uint32{{6685368, 10}, {6685369, 124}, {6685370, 120}, {6685371, 86}, {32, 73}, {33, 104}, {34, 252}, {35, 106}, {6880362, 151}, {6880363, 71}, {6880364, 118}, {6880365, 4}},
			},
			want: 			cpuState{
				D:   [8]uint32{2164906169, 1230284346, 260427620, 325487477, 1412474508, 2132875421, 1328751060, 2699995861},
				A:   [7]uint32{1421557191, 3918603249, 3922834922, 3569592415, 1393680834, 256522838, 2823585464},
				PC:  1231617134,
				SR:  10014,
				USP: 15460328,
				SSP: 15143674,
				RAM: [][2]uint32{{6685368, 10}, {6685369, 124}, {6685370, 120}, {6685371, 86}, {15143678, 2}, {15143679, 184}, {15143674, 7}, {15143675, 30}, {15143676, 0}, {15143677, 102}, {32, 73}, {33, 104}, {34, 252}, {35, 106}, {6880362, 151}, {6880363, 71}, {6880364, 118}, {6880365, 4}},
				Cycles: 34,
			},
		},
		{
			name: "844 EORItoSR # 0a7c",
			init: 			cpuState{
				D:   [8]uint32{1029380695, 24409035, 2093434554, 865349059, 3498903057, 452548074, 2152128917, 4115025843},
				A:   [7]uint32{1375808853, 805335301, 169861502, 3674662842, 2885326281, 959818766, 2797532497},
				PC:  479310,
				SR:  8,
				USP: 6081252,
				SSP: 7949544,
				RAM: [][2]uint32{{479306, 10}, {479307, 124}, {479308, 149}, {479309, 107}, {32, 102}, {33, 54}, {34, 132}, {35, 36}, {3572772, 170}, {3572773, 46}, {3572774, 144}, {3572775, 118}},
			},
			want: 			cpuState{
				D:   [8]uint32{1029380695, 24409035, 2093434554, 865349059, 3498903057, 452548074, 2152128917, 4115025843},
				A:   [7]uint32{1375808853, 805335301, 169861502, 3674662842, 2885326281, 959818766, 2797532497},
				PC:  1714848808,
				SR:  8200,
				USP: 6081252,
				SSP: 7949538,
				RAM: [][2]uint32{{479306, 10}, {479307, 124}, {479308, 149}, {479309, 107}, {7949542, 80}, {7949543, 74}, {7949538, 0}, {7949539, 8}, {7949540, 0}, {7949541, 7}, {32, 102}, {33, 54}, {34, 132}, {35, 36}, {3572772, 170}, {3572773, 46}, {3572774, 144}, {3572775, 118}},
				Cycles: 34,
			},
		},
		{
			name: "1127 EORItoSR # 0a7c",
			init: 			cpuState{
				D:   [8]uint32{861460773, 2410102584, 3168908310, 3247810763, 1970659806, 3014562974, 685006997, 2607774989},
				A:   [7]uint32{3810220385, 601488054, 2874729852, 4045914393, 1437913830, 289408022, 1896615244},
				PC:  15609172,
				SR:  8717,
				USP: 8458792,
				SSP: 2605758,
				RAM: [][2]uint32{{15609168, 10}, {15609169, 124}, {15609170, 170}, {15609171, 152}, {15609172, 191}, {15609173, 237}, {15609174, 83}, {15609175, 192}},
			},
			want: 			cpuState{
				D:   [8]uint32{861460773, 2410102584, 3168908310, 3247810763, 1970659806, 3014562974, 685006997, 2607774989},
				A:   [7]uint32{3810220385, 601488054, 2874729852, 4045914393, 1437913830, 289408022, 1896615244},
				PC:  15609176,
				SR:  32789,
				USP: 8458792,
				SSP: 2605758,
				RAM: [][2]uint32{{15609168, 10}, {15609169, 124}, {15609170, 170}, {15609171, 152}, {15609172, 191}, {15609173, 237}, {15609174, 83}, {15609175, 192}},
				Cycles: 20,
			},
		},
		{
			name: "1405 EORItoSR # 0a7c",
			init: 			cpuState{
				D:   [8]uint32{4190802826, 1677981542, 3694619736, 443989255, 1714014013, 3120737156, 969538632, 596161397},
				A:   [7]uint32{3742237176, 3604711015, 2626799530, 3702238340, 2558029073, 2107532740, 2533095764},
				PC:  10637152,
				SR:  1539,
				USP: 11081192,
				SSP: 15090754,
				RAM: [][2]uint32{{10637148, 10}, {10637149, 124}, {10637150, 42}, {10637151, 229}, {32, 116}, {33, 192}, {34, 175}, {35, 228}, {12627940, 215}, {12627941, 72}, {12627942, 232}, {12627943, 192}},
			},
			want: 			cpuState{
				D:   [8]uint32{4190802826, 1677981542, 3694619736, 443989255, 1714014013, 3120737156, 969538632, 596161397},
				A:   [7]uint32{3742237176, 3604711015, 2626799530, 3702238340, 2558029073, 2107532740, 2533095764},
				PC:  1958785000,
				SR:  9731,
				USP: 11081192,
				SSP: 15090748,
				RAM: [][2]uint32{{10637148, 10}, {10637149, 124}, {10637150, 42}, {10637151, 229}, {15090752, 79}, {15090753, 92}, {15090748, 6}, {15090749, 3}, {15090750, 0}, {15090751, 162}, {32, 116}, {33, 192}, {34, 175}, {35, 228}, {12627940, 215}, {12627941, 72}, {12627942, 232}, {12627943, 192}},
				Cycles: 34,
			},
		},
		{
			name: "1680 EORItoSR # 0a7c",
			init: 			cpuState{
				D:   [8]uint32{1403634658, 2827047168, 4253604679, 3009256054, 4161875786, 2293438828, 3318407772, 3021734114},
				A:   [7]uint32{918472828, 3577114875, 1512592444, 2200239637, 722753010, 656989896, 937164756},
				PC:  14056534,
				SR:  1559,
				USP: 5456430,
				SSP: 5507696,
				RAM: [][2]uint32{{14056530, 10}, {14056531, 124}, {14056532, 127}, {14056533, 145}, {32, 172}, {33, 202}, {34, 232}, {35, 92}, {13297756, 105}, {13297757, 246}, {13297758, 213}, {13297759, 189}},
			},
			want: 			cpuState{
				D:   [8]uint32{1403634658, 2827047168, 4253604679, 3009256054, 4161875786, 2293438828, 3318407772, 3021734114},
				A:   [7]uint32{918472828, 3577114875, 1512592444, 2200239637, 722753010, 656989896, 937164756},
				PC:  2898978912,
				SR:  9751,
				USP: 5456430,
				SSP: 5507690,
				RAM: [][2]uint32{{14056530, 10}, {14056531, 124}, {14056532, 127}, {14056533, 145}, {5507694, 124}, {5507695, 82}, {5507690, 6}, {5507691, 23}, {5507692, 0}, {5507693, 214}, {32, 172}, {33, 202}, {34, 232}, {35, 92}, {13297756, 105}, {13297757, 246}, {13297758, 213}, {13297759, 189}},
				Cycles: 34,
			},
		},
		{
			name: "1947 EORItoSR # 0a7c",
			init: 			cpuState{
				D:   [8]uint32{772074014, 3529913555, 3839395668, 3578872686, 3315159740, 2630610366, 1010439647, 1526024817},
				A:   [7]uint32{4080914420, 2358528311, 1966253447, 1415687187, 938441256, 1328026832, 426910010},
				PC:  879834,
				SR:  9989,
				USP: 455156,
				SSP: 9427284,
				RAM: [][2]uint32{{879830, 10}, {879831, 124}, {879832, 177}, {879833, 29}, {879834, 252}, {879835, 69}, {879836, 36}, {879837, 126}},
			},
			want: 			cpuState{
				D:   [8]uint32{772074014, 3529913555, 3839395668, 3578872686, 3315159740, 2630610366, 1010439647, 1526024817},
				A:   [7]uint32{4080914420, 2358528311, 1966253447, 1415687187, 938441256, 1328026832, 426910010},
				PC:  879838,
				SR:  34328,
				USP: 455156,
				SSP: 9427284,
				RAM: [][2]uint32{{879830, 10}, {879831, 124}, {879832, 177}, {879833, 29}, {879834, 252}, {879835, 69}, {879836, 36}, {879837, 126}},
				Cycles: 20,
			},
		},
		{
			name: "2214 EORItoSR # 0a7c",
			init: 			cpuState{
				D:   [8]uint32{2451349597, 193641972, 3289341329, 3481780229, 1815185000, 1155558870, 3452615446, 3777619138},
				A:   [7]uint32{42719089, 550622812, 3853944954, 534351080, 2020026326, 269290476, 2126543769},
				PC:  11344578,
				SR:  8971,
				USP: 13205152,
				SSP: 14128734,
				RAM: [][2]uint32{{11344574, 10}, {11344575, 124}, {11344576, 42}, {11344577, 24}, {11344578, 96}, {11344579, 211}, {11344580, 91}, {11344581, 80}},
			},
			want: 			cpuState{
				D:   [8]uint32{2451349597, 193641972, 3289341329, 3481780229, 1815185000, 1155558870, 3452615446, 3777619138},
				A:   [7]uint32{42719089, 550622812, 3853944954, 534351080, 2020026326, 269290476, 2126543769},
				PC:  11344582,
				SR:  275,
				USP: 13205152,
				SSP: 14128734,
				RAM: [][2]uint32{{11344574, 10}, {11344575, 124}, {11344576, 42}, {11344577, 24}, {11344578, 96}, {11344579, 211}, {11344580, 91}, {11344581, 80}},
				Cycles: 20,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

func TestILLEGAL_LINEA(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "002 ILLEGAL_LINEA a036",
			init: 			cpuState{
				D:   [8]uint32{2489560578, 761484846, 162716100, 811107877, 73225226, 3627558023, 1035143982, 1023959231},
				A:   [7]uint32{3923183684, 2259797161, 2420191878, 3176727162, 2139761795, 1362129668, 2042361807},
				PC:  11340256,
				SR:  9235,
				USP: 7950666,
				SSP: 14726132,
				RAM: [][2]uint32{{11340252, 160}, {11340253, 54}, {11340254, 20}, {11340255, 61}, {40, 92}, {41, 120}, {42, 144}, {43, 176}, {7901360, 106}, {7901361, 232}, {7901362, 44}, {7901363, 247}},
			},
			want: 			cpuState{
				D:   [8]uint32{2489560578, 761484846, 162716100, 811107877, 73225226, 3627558023, 1035143982, 1023959231},
				A:   [7]uint32{3923183684, 2259797161, 2420191878, 3176727162, 2139761795, 1362129668, 2042361807},
				PC:  1551405236,
				SR:  9235,
				USP: 7950666,
				SSP: 14726126,
				RAM: [][2]uint32{{11340252, 160}, {11340253, 54}, {11340254, 20}, {11340255, 61}, {14726130, 9}, {14726131, 220}, {14726126, 36}, {14726127, 19}, {14726128, 0}, {14726129, 173}, {40, 92}, {41, 120}, {42, 144}, {43, 176}, {7901360, 106}, {7901361, 232}, {7901362, 44}, {7901363, 247}},
				Cycles: 34,
			},
		},
		{
			name: "300 ILLEGAL_LINEA a1cf",
			init: 			cpuState{
				D:   [8]uint32{3362733012, 2727970232, 1638903084, 3886973394, 3880296171, 2329278634, 2447067688, 2529128651},
				A:   [7]uint32{4117845106, 2062687177, 1239940656, 1818089872, 2541128845, 207776605, 201038497},
				PC:  10787774,
				SR:  797,
				USP: 5657652,
				SSP: 12319150,
				RAM: [][2]uint32{{10787770, 161}, {10787771, 207}, {10787772, 127}, {10787773, 247}, {40, 128}, {41, 198}, {42, 169}, {43, 114}, {13019506, 18}, {13019507, 128}, {13019508, 122}, {13019509, 182}},
			},
			want: 			cpuState{
				D:   [8]uint32{3362733012, 2727970232, 1638903084, 3886973394, 3880296171, 2329278634, 2447067688, 2529128651},
				A:   [7]uint32{4117845106, 2062687177, 1239940656, 1818089872, 2541128845, 207776605, 201038497},
				PC:  2160503158,
				SR:  8989,
				USP: 5657652,
				SSP: 12319144,
				RAM: [][2]uint32{{10787770, 161}, {10787771, 207}, {10787772, 127}, {10787773, 247}, {12319148, 155}, {12319149, 186}, {12319144, 3}, {12319145, 29}, {12319146, 0}, {12319147, 164}, {40, 128}, {41, 198}, {42, 169}, {43, 114}, {13019506, 18}, {13019507, 128}, {13019508, 122}, {13019509, 182}},
				Cycles: 34,
			},
		},
		{
			name: "563 ILLEGAL_LINEA a3af",
			init: 			cpuState{
				D:   [8]uint32{4102031842, 1095953665, 288087882, 1681687410, 332378287, 1512293307, 2357239556, 653797835},
				A:   [7]uint32{2182770883, 1768557258, 1381663839, 3778614886, 2948262071, 4259863010, 4116733586},
				PC:  9484670,
				SR:  9994,
				USP: 28158,
				SSP: 14869322,
				RAM: [][2]uint32{{9484666, 163}, {9484667, 175}, {9484668, 92}, {9484669, 19}, {40, 207}, {41, 42}, {42, 6}, {43, 96}, {2754144, 139}, {2754145, 100}, {2754146, 139}, {2754147, 80}},
			},
			want: 			cpuState{
				D:   [8]uint32{4102031842, 1095953665, 288087882, 1681687410, 332378287, 1512293307, 2357239556, 653797835},
				A:   [7]uint32{2182770883, 1768557258, 1381663839, 3778614886, 2948262071, 4259863010, 4116733586},
				PC:  3475637860,
				SR:  9994,
				USP: 28158,
				SSP: 14869316,
				RAM: [][2]uint32{{9484666, 163}, {9484667, 175}, {9484668, 92}, {9484669, 19}, {14869320, 185}, {14869321, 122}, {14869316, 39}, {14869317, 10}, {14869318, 0}, {14869319, 144}, {40, 207}, {41, 42}, {42, 6}, {43, 96}, {2754144, 139}, {2754145, 100}, {2754146, 139}, {2754147, 80}},
				Cycles: 34,
			},
		},
		{
			name: "814 ILLEGAL_LINEA a5c4",
			init: 			cpuState{
				D:   [8]uint32{440648359, 1145984416, 1952518567, 2976327230, 1761185029, 815983966, 3440128784, 852890780},
				A:   [7]uint32{600053738, 2506062347, 3674709224, 338537016, 3076414841, 2982961242, 1310243268},
				PC:  10401814,
				SR:  9483,
				USP: 231952,
				SSP: 6975136,
				RAM: [][2]uint32{{10401810, 165}, {10401811, 196}, {10401812, 103}, {10401813, 51}, {40, 197}, {41, 164}, {42, 29}, {43, 66}, {10755394, 125}, {10755395, 135}, {10755396, 10}, {10755397, 46}},
			},
			want: 			cpuState{
				D:   [8]uint32{440648359, 1145984416, 1952518567, 2976327230, 1761185029, 815983966, 3440128784, 852890780},
				A:   [7]uint32{600053738, 2506062347, 3674709224, 338537016, 3076414841, 2982961242, 1310243268},
				PC:  3315866950,
				SR:  9483,
				USP: 231952,
				SSP: 6975130,
				RAM: [][2]uint32{{10401810, 165}, {10401811, 196}, {10401812, 103}, {10401813, 51}, {6975134, 184}, {6975135, 18}, {6975130, 37}, {6975131, 11}, {6975132, 0}, {6975133, 158}, {40, 197}, {41, 164}, {42, 29}, {43, 66}, {10755394, 125}, {10755395, 135}, {10755396, 10}, {10755397, 46}},
				Cycles: 34,
			},
		},
		{
			name: "1103 ILLEGAL_LINEA ad46",
			init: 			cpuState{
				D:   [8]uint32{1131087541, 4125569454, 1912131228, 3058186506, 1507318390, 3401997545, 1623358401, 2162782053},
				A:   [7]uint32{2353794450, 1059577104, 508324118, 280903558, 1025930015, 216153253, 3586700314},
				PC:  15682738,
				SR:  1563,
				USP: 15377980,
				SSP: 6860928,
				RAM: [][2]uint32{{15682734, 173}, {15682735, 70}, {15682736, 218}, {15682737, 143}, {40, 49}, {41, 76}, {42, 196}, {43, 162}, {5031074, 213}, {5031075, 166}, {5031076, 234}, {5031077, 65}},
			},
			want: 			cpuState{
				D:   [8]uint32{1131087541, 4125569454, 1912131228, 3058186506, 1507318390, 3401997545, 1623358401, 2162782053},
				A:   [7]uint32{2353794450, 1059577104, 508324118, 280903558, 1025930015, 216153253, 3586700314},
				PC:  827114662,
				SR:  9755,
				USP: 15377980,
				SSP: 6860922,
				RAM: [][2]uint32{{15682734, 173}, {15682735, 70}, {15682736, 218}, {15682737, 143}, {6860926, 76}, {6860927, 174}, {6860922, 6}, {6860923, 27}, {6860924, 0}, {6860925, 239}, {40, 49}, {41, 76}, {42, 196}, {43, 162}, {5031074, 213}, {5031075, 166}, {5031076, 234}, {5031077, 65}},
				Cycles: 34,
			},
		},
		{
			name: "1418 ILLEGAL_LINEA aaef",
			init: 			cpuState{
				D:   [8]uint32{2319888302, 4237690561, 3855994191, 768256977, 175467619, 1830170462, 4279039600, 1097948188},
				A:   [7]uint32{332556246, 3813787808, 1707485314, 585586524, 1905602213, 3893165565, 4087462284},
				PC:  15843128,
				SR:  8975,
				USP: 4359112,
				SSP: 8482018,
				RAM: [][2]uint32{{15843124, 170}, {15843125, 239}, {15843126, 97}, {15843127, 65}, {40, 157}, {41, 188}, {42, 79}, {43, 62}, {12341054, 17}, {12341055, 237}, {12341056, 235}, {12341057, 99}},
			},
			want: 			cpuState{
				D:   [8]uint32{2319888302, 4237690561, 3855994191, 768256977, 175467619, 1830170462, 4279039600, 1097948188},
				A:   [7]uint32{332556246, 3813787808, 1707485314, 585586524, 1905602213, 3893165565, 4087462284},
				PC:  2646363970,
				SR:  8975,
				USP: 4359112,
				SSP: 8482012,
				RAM: [][2]uint32{{15843124, 170}, {15843125, 239}, {15843126, 97}, {15843127, 65}, {8482016, 191}, {8482017, 52}, {8482012, 35}, {8482013, 15}, {8482014, 0}, {8482015, 241}, {40, 157}, {41, 188}, {42, 79}, {43, 62}, {12341054, 17}, {12341055, 237}, {12341056, 235}, {12341057, 99}},
				Cycles: 34,
			},
		},
		{
			name: "1706 ILLEGAL_LINEA a003",
			init: 			cpuState{
				D:   [8]uint32{1863366875, 1215288295, 2299839846, 4201735930, 2611130269, 1963896225, 267581665, 3475922415},
				A:   [7]uint32{3940304049, 3992212350, 1154691586, 2513496043, 1361895841, 1714439735, 3558966675},
				PC:  3911140,
				SR:  1305,
				USP: 10468412,
				SSP: 12811004,
				RAM: [][2]uint32{{3911136, 160}, {3911137, 3}, {3911138, 21}, {3911139, 127}, {40, 195}, {41, 234}, {42, 215}, {43, 220}, {15390684, 239}, {15390685, 250}, {15390686, 130}, {15390687, 248}},
			},
			want: 			cpuState{
				D:   [8]uint32{1863366875, 1215288295, 2299839846, 4201735930, 2611130269, 1963896225, 267581665, 3475922415},
				A:   [7]uint32{3940304049, 3992212350, 1154691586, 2513496043, 1361895841, 1714439735, 3558966675},
				PC:  3286947808,
				SR:  9497,
				USP: 10468412,
				SSP: 12810998,
				RAM: [][2]uint32{{3911136, 160}, {3911137, 3}, {3911138, 21}, {3911139, 127}, {12811002, 173}, {12811003, 224}, {12810998, 5}, {12810999, 25}, {12811000, 0}, {12811001, 59}, {40, 195}, {41, 234}, {42, 215}, {43, 220}, {15390684, 239}, {15390685, 250}, {15390686, 130}, {15390687, 248}},
				Cycles: 34,
			},
		},
		{
			name: "1950 ILLEGAL_LINEA aa2e",
			init: 			cpuState{
				D:   [8]uint32{4097101501, 3026260622, 4238623551, 906511148, 440632897, 653319053, 397117704, 1412984126},
				A:   [7]uint32{2678382831, 3192954503, 810235319, 2913985034, 1039430639, 1220371199, 2823396052},
				PC:  3657092,
				SR:  1813,
				USP: 2759958,
				SSP: 9618450,
				RAM: [][2]uint32{{3657088, 170}, {3657089, 46}, {3657090, 189}, {3657091, 203}, {40, 2}, {41, 216}, {42, 66}, {43, 12}, {14172684, 31}, {14172685, 137}, {14172686, 184}, {14172687, 129}},
			},
			want: 			cpuState{
				D:   [8]uint32{4097101501, 3026260622, 4238623551, 906511148, 440632897, 653319053, 397117704, 1412984126},
				A:   [7]uint32{2678382831, 3192954503, 810235319, 2913985034, 1039430639, 1220371199, 2823396052},
				PC:  47727120,
				SR:  10005,
				USP: 2759958,
				SSP: 9618444,
				RAM: [][2]uint32{{3657088, 170}, {3657089, 46}, {3657090, 189}, {3657091, 203}, {9618448, 205}, {9618449, 128}, {9618444, 7}, {9618445, 21}, {9618446, 0}, {9618447, 55}, {40, 2}, {41, 216}, {42, 66}, {43, 12}, {14172684, 31}, {14172685, 137}, {14172686, 184}, {14172687, 129}},
				Cycles: 34,
			},
		},
		{
			name: "2228 ILLEGAL_LINEA aa8e",
			init: 			cpuState{
				D:   [8]uint32{2570307721, 3289698132, 780636022, 3128259059, 4191727864, 1621486672, 3756846753, 1806231711},
				A:   [7]uint32{1972276463, 2400815346, 2573144058, 1543655015, 3073827175, 2532569054, 2259314933},
				PC:  3130830,
				SR:  8205,
				USP: 16585416,
				SSP: 4900798,
				RAM: [][2]uint32{{3130826, 170}, {3130827, 142}, {3130828, 9}, {3130829, 135}, {40, 4}, {41, 2}, {42, 146}, {43, 204}, {168652, 114}, {168653, 197}, {168654, 170}, {168655, 85}},
			},
			want: 			cpuState{
				D:   [8]uint32{2570307721, 3289698132, 780636022, 3128259059, 4191727864, 1621486672, 3756846753, 1806231711},
				A:   [7]uint32{1972276463, 2400815346, 2573144058, 1543655015, 3073827175, 2532569054, 2259314933},
				PC:  67277520,
				SR:  8205,
				USP: 16585416,
				SSP: 4900792,
				RAM: [][2]uint32{{3130826, 170}, {3130827, 142}, {3130828, 9}, {3130829, 135}, {4900796, 197}, {4900797, 202}, {4900792, 32}, {4900793, 13}, {4900794, 0}, {4900795, 47}, {40, 4}, {41, 2}, {42, 146}, {43, 204}, {168652, 114}, {168653, 197}, {168654, 170}, {168655, 85}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}


func TestILLEGAL_LINEF(t *testing.T) {
	tests := []struct {
		name string
		init cpuState
		want cpuState
	}{
		{
			name: "001 ILLEGAL_LINEF f9dc",
			init: 			cpuState{
				D:   [8]uint32{752141540, 1147652864, 272194845, 508653606, 313887789, 839121927, 873010792, 1253188054},
				A:   [7]uint32{453939036, 2588038915, 1222825811, 3444651129, 2180477900, 67758438, 159342703},
				PC:  2544066,
				SR:  1558,
				USP: 6620768,
				SSP: 6032390,
				RAM: [][2]uint32{{2544062, 249}, {2544063, 220}, {2544064, 90}, {2544065, 165}, {44, 65}, {45, 212}, {46, 255}, {47, 226}, {13959138, 56}, {13959139, 142}, {13959140, 230}, {13959141, 179}},
			},
			want: 			cpuState{
				D:   [8]uint32{752141540, 1147652864, 272194845, 508653606, 313887789, 839121927, 873010792, 1253188054},
				A:   [7]uint32{453939036, 2588038915, 1222825811, 3444651129, 2180477900, 67758438, 159342703},
				PC:  1104478182,
				SR:  9750,
				USP: 6620768,
				SSP: 6032384,
				RAM: [][2]uint32{{2544062, 249}, {2544063, 220}, {2544064, 90}, {2544065, 165}, {6032388, 209}, {6032389, 190}, {6032384, 6}, {6032385, 22}, {6032386, 0}, {6032387, 38}, {44, 65}, {45, 212}, {46, 255}, {47, 226}, {13959138, 56}, {13959139, 142}, {13959140, 230}, {13959141, 179}},
				Cycles: 34,
			},
		},
		{
			name: "274 ILLEGAL_LINEF f07b",
			init: 			cpuState{
				D:   [8]uint32{2292830544, 3086570148, 533874310, 3018275138, 3221733760, 1784983924, 1840228256, 4021506917},
				A:   [7]uint32{1409292023, 2781499839, 1184675322, 676105427, 196801877, 1444549636, 646340840},
				PC:  9649012,
				SR:  9498,
				USP: 4929466,
				SSP: 5141382,
				RAM: [][2]uint32{{9649008, 240}, {9649009, 123}, {9649010, 132}, {9649011, 205}, {44, 214}, {45, 252}, {46, 212}, {47, 162}, {16569506, 195}, {16569507, 69}, {16569508, 239}, {16569509, 48}},
			},
			want: 			cpuState{
				D:   [8]uint32{2292830544, 3086570148, 533874310, 3018275138, 3221733760, 1784983924, 1840228256, 4021506917},
				A:   [7]uint32{1409292023, 2781499839, 1184675322, 676105427, 196801877, 1444549636, 646340840},
				PC:  3606893734,
				SR:  9498,
				USP: 4929466,
				SSP: 5141376,
				RAM: [][2]uint32{{9649008, 240}, {9649009, 123}, {9649010, 132}, {9649011, 205}, {5141380, 59}, {5141381, 112}, {5141376, 37}, {5141377, 26}, {5141378, 0}, {5141379, 147}, {44, 214}, {45, 252}, {46, 212}, {47, 162}, {16569506, 195}, {16569507, 69}, {16569508, 239}, {16569509, 48}},
				Cycles: 34,
			},
		},
		{
			name: "551 ILLEGAL_LINEF f2a1",
			init: 			cpuState{
				D:   [8]uint32{1210736241, 2109897412, 4151146628, 1882117129, 1324994634, 2832744308, 2664777129, 1342916026},
				A:   [7]uint32{823543925, 221247150, 2297356566, 934644174, 1926900195, 3183916553, 644037712},
				PC:  15866668,
				SR:  1810,
				USP: 16144850,
				SSP: 1811096,
				RAM: [][2]uint32{{15866664, 242}, {15866665, 161}, {15866666, 129}, {15866667, 0}, {44, 96}, {45, 216}, {46, 242}, {47, 112}, {14217840, 187}, {14217841, 139}, {14217842, 0}, {14217843, 255}},
			},
			want: 			cpuState{
				D:   [8]uint32{1210736241, 2109897412, 4151146628, 1882117129, 1324994634, 2832744308, 2664777129, 1342916026},
				A:   [7]uint32{823543925, 221247150, 2297356566, 934644174, 1926900195, 3183916553, 644037712},
				PC:  1624830580,
				SR:  10002,
				USP: 16144850,
				SSP: 1811090,
				RAM: [][2]uint32{{15866664, 242}, {15866665, 161}, {15866666, 129}, {15866667, 0}, {1811094, 27}, {1811095, 40}, {1811090, 7}, {1811091, 18}, {1811092, 0}, {1811093, 242}, {44, 96}, {45, 216}, {46, 242}, {47, 112}, {14217840, 187}, {14217841, 139}, {14217842, 0}, {14217843, 255}},
				Cycles: 34,
			},
		},
		{
			name: "839 ILLEGAL_LINEF f01a",
			init: 			cpuState{
				D:   [8]uint32{2618017029, 2321689249, 1807074038, 1508905036, 206571035, 3836927235, 3094971120, 1502623878},
				A:   [7]uint32{1247653398, 1988292335, 1899190367, 4277138420, 2004238260, 286515229, 2266297979},
				PC:  16532252,
				SR:  1300,
				USP: 10645834,
				SSP: 12060864,
				RAM: [][2]uint32{{16532248, 240}, {16532249, 26}, {16532250, 1}, {16532251, 136}, {44, 76}, {45, 82}, {46, 187}, {47, 220}, {5422044, 218}, {5422045, 25}, {5422046, 57}, {5422047, 252}},
			},
			want: 			cpuState{
				D:   [8]uint32{2618017029, 2321689249, 1807074038, 1508905036, 206571035, 3836927235, 3094971120, 1502623878},
				A:   [7]uint32{1247653398, 1988292335, 1899190367, 4277138420, 2004238260, 286515229, 2266297979},
				PC:  1280490464,
				SR:  9492,
				USP: 10645834,
				SSP: 12060858,
				RAM: [][2]uint32{{16532248, 240}, {16532249, 26}, {16532250, 1}, {16532251, 136}, {12060862, 67}, {12060863, 24}, {12060858, 5}, {12060859, 20}, {12060860, 0}, {12060861, 252}, {44, 76}, {45, 82}, {46, 187}, {47, 220}, {5422044, 218}, {5422045, 25}, {5422046, 57}, {5422047, 252}},
				Cycles: 34,
			},
		},
		{
			name: "1126 ILLEGAL_LINEF f7a5",
			init: 			cpuState{
				D:   [8]uint32{1046734965, 3083839701, 197119827, 4037804576, 259122768, 2918915672, 1762444191, 2893251551},
				A:   [7]uint32{1264001079, 3403435107, 2064234072, 3798058462, 1292564515, 1573747124, 394734442},
				PC:  2258932,
				SR:  524,
				USP: 3961194,
				SSP: 2447834,
				RAM: [][2]uint32{{2258928, 247}, {2258929, 165}, {2258930, 72}, {2258931, 137}, {44, 137}, {45, 4}, {46, 179}, {47, 104}, {308072, 207}, {308073, 176}, {308074, 239}, {308075, 183}},
			},
			want: 			cpuState{
				D:   [8]uint32{1046734965, 3083839701, 197119827, 4037804576, 259122768, 2918915672, 1762444191, 2893251551},
				A:   [7]uint32{1264001079, 3403435107, 2064234072, 3798058462, 1292564515, 1573747124, 394734442},
				PC:  2298786668,
				SR:  8716,
				USP: 3961194,
				SSP: 2447828,
				RAM: [][2]uint32{{2258928, 247}, {2258929, 165}, {2258930, 72}, {2258931, 137}, {2447832, 119}, {2447833, 240}, {2447828, 2}, {2447829, 12}, {2447830, 0}, {2447831, 34}, {44, 137}, {45, 4}, {46, 179}, {47, 104}, {308072, 207}, {308073, 176}, {308074, 239}, {308075, 183}},
				Cycles: 34,
			},
		},
		{
			name: "1406 ILLEGAL_LINEF f846",
			init: 			cpuState{
				D:   [8]uint32{3426324320, 1702810843, 1696302293, 715081293, 3866530077, 829630175, 4088959672, 2484426957},
				A:   [7]uint32{2920837122, 1421863042, 2369047072, 2776666395, 2972768774, 2267567353, 2788291964},
				PC:  152390,
				SR:  1282,
				USP: 15420032,
				SSP: 16057766,
				RAM: [][2]uint32{{152386, 248}, {152387, 70}, {152388, 76}, {152389, 213}, {44, 133}, {45, 160}, {46, 146}, {47, 170}, {10523306, 49}, {10523307, 209}, {10523308, 213}, {10523309, 39}},
			},
			want: 			cpuState{
				D:   [8]uint32{3426324320, 1702810843, 1696302293, 715081293, 3866530077, 829630175, 4088959672, 2484426957},
				A:   [7]uint32{2920837122, 1421863042, 2369047072, 2776666395, 2972768774, 2267567353, 2788291964},
				PC:  2241893038,
				SR:  9474,
				USP: 15420032,
				SSP: 16057760,
				RAM: [][2]uint32{{152386, 248}, {152387, 70}, {152388, 76}, {152389, 213}, {16057764, 83}, {16057765, 66}, {16057760, 5}, {16057761, 2}, {16057762, 0}, {16057763, 2}, {44, 133}, {45, 160}, {46, 146}, {47, 170}, {10523306, 49}, {10523307, 209}, {10523308, 213}, {10523309, 39}},
				Cycles: 34,
			},
		},
		{
			name: "1663 ILLEGAL_LINEF fe69",
			init: 			cpuState{
				D:   [8]uint32{3480240091, 3655040464, 2644377024, 1033986425, 1254630042, 4116170230, 2993255501, 1659249350},
				A:   [7]uint32{1932427676, 937876149, 1587838237, 1065859939, 1856465191, 910875648, 3915119402},
				PC:  12776572,
				SR:  9736,
				USP: 13326910,
				SSP: 7898682,
				RAM: [][2]uint32{{12776568, 254}, {12776569, 105}, {12776570, 85}, {12776571, 203}, {44, 171}, {45, 72}, {46, 58}, {47, 34}, {4733474, 28}, {4733475, 106}, {4733476, 236}, {4733477, 156}},
			},
			want: 			cpuState{
				D:   [8]uint32{3480240091, 3655040464, 2644377024, 1033986425, 1254630042, 4116170230, 2993255501, 1659249350},
				A:   [7]uint32{1932427676, 937876149, 1587838237, 1065859939, 1856465191, 910875648, 3915119402},
				PC:  2873637414,
				SR:  9736,
				USP: 13326910,
				SSP: 7898676,
				RAM: [][2]uint32{{12776568, 254}, {12776569, 105}, {12776570, 85}, {12776571, 203}, {7898680, 244}, {7898681, 120}, {7898676, 38}, {7898677, 8}, {7898678, 0}, {7898679, 194}, {44, 171}, {45, 72}, {46, 58}, {47, 34}, {4733474, 28}, {4733475, 106}, {4733476, 236}, {4733477, 156}},
				Cycles: 34,
			},
		},
		{
			name: "1931 ILLEGAL_LINEF ff5b",
			init: 			cpuState{
				D:   [8]uint32{495201476, 2958837421, 1801655298, 514566254, 4294187919, 195742086, 2167927521, 2466368238},
				A:   [7]uint32{4030433137, 1332255649, 1130035019, 3086475248, 2506901124, 700815458, 4216818422},
				PC:  1735398,
				SR:  9474,
				USP: 14547290,
				SSP: 13237290,
				RAM: [][2]uint32{{1735394, 255}, {1735395, 91}, {1735396, 112}, {1735397, 235}, {44, 178}, {45, 176}, {46, 202}, {47, 254}, {11586302, 132}, {11586303, 229}, {11586304, 48}, {11586305, 17}},
			},
			want: 			cpuState{
				D:   [8]uint32{495201476, 2958837421, 1801655298, 514566254, 4294187919, 195742086, 2167927521, 2466368238},
				A:   [7]uint32{4030433137, 1332255649, 1130035019, 3086475248, 2506901124, 700815458, 4216818422},
				PC:  2997930754,
				SR:  9474,
				USP: 14547290,
				SSP: 13237284,
				RAM: [][2]uint32{{1735394, 255}, {1735395, 91}, {1735396, 112}, {1735397, 235}, {13237288, 122}, {13237289, 226}, {13237284, 37}, {13237285, 2}, {13237286, 0}, {13237287, 26}, {44, 178}, {45, 176}, {46, 202}, {47, 254}, {11586302, 132}, {11586303, 229}, {11586304, 48}, {11586305, 17}},
				Cycles: 34,
			},
		},
		{
			name: "2244 ILLEGAL_LINEF f8c9",
			init: 			cpuState{
				D:   [8]uint32{1250822288, 880529784, 2996848930, 440565902, 3574454901, 3442448438, 1101521830, 1959254179},
				A:   [7]uint32{1267694078, 1112964589, 616191727, 2801251014, 1767754109, 3707190648, 3522076044},
				PC:  5251422,
				SR:  8463,
				USP: 9655770,
				SSP: 16290068,
				RAM: [][2]uint32{{5251418, 248}, {5251419, 201}, {5251420, 247}, {5251421, 122}, {44, 57}, {45, 94}, {46, 124}, {47, 160}, {6192288, 153}, {6192289, 220}, {6192290, 69}, {6192291, 42}},
			},
			want: 			cpuState{
				D:   [8]uint32{1250822288, 880529784, 2996848930, 440565902, 3574454901, 3442448438, 1101521830, 1959254179},
				A:   [7]uint32{1267694078, 1112964589, 616191727, 2801251014, 1767754109, 3707190648, 3522076044},
				PC:  962493604,
				SR:  8463,
				USP: 9655770,
				SSP: 16290062,
				RAM: [][2]uint32{{5251418, 248}, {5251419, 201}, {5251420, 247}, {5251421, 122}, {16290066, 33}, {16290067, 90}, {16290062, 33}, {16290063, 15}, {16290064, 0}, {16290065, 80}, {44, 57}, {45, 94}, {46, 124}, {47, 160}, {6192288, 153}, {6192289, 220}, {6192290, 69}, {6192291, 42}},
				Cycles: 34,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			runTest(t, tt.init, tt.want)
		})
	}
}

